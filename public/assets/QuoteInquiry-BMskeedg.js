import{j as e}from"./vendor-data-DG_4MGb7.js";import{r as d}from"./vendor-react-D-r2Cqeg.js";import{a as n,z as x}from"./index-Dgd7wCS1.js";import{p as h}from"./vendor-date-9Cl9d1sr.js";import{T as v,x as g,y as b,z as w,G as R,H as M}from"./vendor-ui-DTwhhNuH.js";const S=()=>{const[r,c]=d.useState([]),[a,i]=d.useState(null),[f,o]=d.useState(!1);d.useEffect(()=>{p()},[]);const p=async()=>{try{r.length===0&&o(!0);const s=await n.get("/quote-inquiries");c(s.data)}catch(s){console.error("Failed to load inquiries:",s),x.error("견적문의를 불러오는데 실패했습니다")}finally{o(!1)}},j=async s=>{try{await n.put(`/quote-inquiries/${s}/read`),c(t=>t.map(l=>l.id===s?{...l,isRead:!0}:l)),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(t){console.error("Failed to mark as read:",t)}},u=s=>{i(s),s.isRead||j(s.id)},y=async(s,t)=>{if(t.stopPropagation(),!!confirm("이 견적문의를 삭제하시겠습니까?"))try{await n.delete(`/quote-inquiries/${s}`),c(l=>l.filter(N=>N.id!==s)),(a==null?void 0:a.id)===s&&i(null),x.success("견적문의가 삭제되었습니다")}catch(l){console.error("Failed to delete inquiry:",l),x.error("견적문의 삭제에 실패했습니다")}},m=r.filter(s=>!s.isRead).length;return f?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-gray-500",children:"로딩 중..."})}):e.jsxs("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[e.jsxs("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${a?"hidden md:flex":"flex"}`,children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["견적문의 목록",m>0&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:m})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"접수된 견적문의가 없습니다"}):e.jsx("div",{className:"divide-y",children:r.map(s=>e.jsx("div",{className:`relative group ${(a==null?void 0:a.id)===s.id?"bg-blue-50 border-l-4 border-blue-500":""} ${s.isRead?"":"bg-yellow-50"}`,children:e.jsxs("button",{onClick:()=>u(s),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.name}),!s.isRead&&e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:h(new Date(s.createdAt),"MM/dd HH:mm")}),e.jsx("button",{onClick:t=>y(s.id,t),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"삭제",children:e.jsx(v,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[e.jsx(g,{className:"w-3 h-3"}),s.phone]}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.message})]})},s.id))})})]}),e.jsx("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${a?"flex flex-col":"hidden md:flex md:flex-col"}`,children:a?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:a.name}),e.jsx("button",{onClick:()=>i(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:"목록으로"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:h(new Date(a.createdAt),"yyyy년 MM월 dd일 HH:mm")})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"연락처 정보"]}),e.jsxs("div",{className:"pl-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(g,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:a.phone})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(w,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:a.email})]}),a.address&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(R,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:a.address})]})]})]}),(a.projectType||a.budget)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"프로젝트 정보"]}),e.jsxs("div",{className:"pl-6 space-y-2",children:[a.projectType&&e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"text-gray-500",children:"공사 종류: "}),a.projectType]}),a.budget&&e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"text-gray-500",children:"예산: "}),a.budget]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"문의 내용"}),e.jsx("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:a.message})]})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"견적문의를 선택해주세요"})})]})};export{S as default};
