const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-ClhJlrd2.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-q8M7ISXV.js","assets/AfterService-C4CNHUsZ.js","assets/AdditionalWork-DKprSW_-.js","assets/additionalWorkService-D2Razqx_.js","assets/ConstructionPayment-UWlBjwkv.js","assets/WorkRequest-BfjAqprG.js","assets/Specbook-D3Y5sy-V.js","assets/EstimatePreview-D_UZn09Z.js","assets/ExecutionHistory-BznxYysR.js"])))=>i.map(i=>d[i]);
var mN=Object.defineProperty;var dN=(s,e,t)=>e in s?mN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Vd=(s,e,t)=>dN(s,typeof e!="symbol"?e+"":e,t);import{r as A,b as fN,u as $p,d as pN,N as Wp,e as wc,O as hN,R as lt,f as ma,B as gN,h as yN,i as Vs}from"./vendor-react-DN7YJcfR.js";import{a as bN,c as Wu,Q as NN,b as xN}from"./vendor-data-DrLf5NIQ.js";import{B as Sc,X as vs,C as zp,T as ii,a as vN,b as Kp,W as _N,c as DN,d as _n,P as $i,R as kN,e as AN,S as Qp,f as EN,g as CN,h as Yp,i as VN,U as tu,I as Io,j as su,k as wd,l as Sd,m as Td,n as wN,M as SN,o as TN,p as LN,L as IN}from"./vendor-ui-D8A9iq7X.js";import{k as Tc,l as yo,m as bo,n as PN,o as jN,p as Ft,q as RN,r as Ld,s as BN,t as ot}from"./vendor-date-DbWJ9m7c.js";import{c as UN,p as Gp,l as Hl,s as Dn,i as HN,h as MN,q as zu,a as Ku,m as Qu,b as ON,d as Ml,o as gl,e as FN,f as yl,r as Yu,g as Gu,j as Xu,k as Ju,n as Zu,t as Xp,u as Jp,v as Zp,w as eh,x as th,y as sh,z as nh,A as rh,B as ih,C as oh,D as ah,E as lh,F as qN,G as $N,H as WN,I as zN,J as KN,K as QN,L as YN}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var ch={exports:{}},nu={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var s=A,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),V=Symbol.iterator,_="@@iterator";function w(y){if(y===null||typeof y!="object")return null;var R=V&&y[V]||y[_];return typeof R=="function"?R:null}var B=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function I(y){{for(var R=arguments.length,T=new Array(R>1?R-1:0),$=1;$<R;$++)T[$-1]=arguments[$];F("error",y,T)}}function F(y,R,T){{var $=B.ReactDebugCurrentFrame,Z=$.getStackAddendum();Z!==""&&(R+="%s",T=T.concat([Z]));var z=T.map(function(G){return String(G)});z.unshift("Warning: "+R),Function.prototype.apply.call(console[y],console,z)}}var oe=!1,se=!1,M=!1,C=!1,x=!1,E;E=Symbol.for("react.module.reference");function j(y){return!!(typeof y=="string"||typeof y=="function"||y===n||y===i||x||y===r||y===m||y===d||C||y===b||oe||se||M||typeof y=="object"&&y!==null&&(y.$$typeof===h||y.$$typeof===f||y.$$typeof===o||y.$$typeof===l||y.$$typeof===u||y.$$typeof===E||y.getModuleId!==void 0))}function L(y,R,T){var $=y.displayName;if($)return $;var Z=R.displayName||R.name||"";return Z!==""?T+"("+Z+")":T}function S(y){return y.displayName||"Context"}function k(y){if(y==null)return null;if(typeof y.tag=="number"&&I("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case n:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case l:var R=y;return S(R)+".Consumer";case o:var T=y;return S(T._context)+".Provider";case u:return L(y,y.render,"ForwardRef");case f:var $=y.displayName||null;return $!==null?$:k(y.type)||"Memo";case h:{var Z=y,z=Z._payload,G=Z._init;try{return k(G(z))}catch{return null}}}return null}var _e=Object.assign,Ue=0,pe,je,ft,qt,Ht,ae,He;function de(){}de.__reactDisabledLog=!0;function Le(){{if(Ue===0){pe=console.log,je=console.info,ft=console.warn,qt=console.error,Ht=console.group,ae=console.groupCollapsed,He=console.groupEnd;var y={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:y,log:y,warn:y,error:y,group:y,groupCollapsed:y,groupEnd:y})}Ue++}}function ze(){{if(Ue--,Ue===0){var y={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:_e({},y,{value:pe}),info:_e({},y,{value:je}),warn:_e({},y,{value:ft}),error:_e({},y,{value:qt}),group:_e({},y,{value:Ht}),groupCollapsed:_e({},y,{value:ae}),groupEnd:_e({},y,{value:He})})}Ue<0&&I("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=B.ReactCurrentDispatcher,it;function St(y,R,T){{if(it===void 0)try{throw Error()}catch(Z){var $=Z.stack.trim().match(/\n( *(at )?)/);it=$&&$[1]||""}return`
`+it+y}}var st=!1,ut;{var ms=typeof WeakMap=="function"?WeakMap:Map;ut=new ms}function Q(y,R){if(!y||st)return"";{var T=ut.get(y);if(T!==void 0)return T}var $;st=!0;var Z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var z;z=bt.current,bt.current=null,Le();try{if(R){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(Dt){$=Dt}Reflect.construct(y,[],G)}else{try{G.call()}catch(Dt){$=Dt}y.call(G.prototype)}}else{try{throw Error()}catch(Dt){$=Dt}y()}}catch(Dt){if(Dt&&$&&typeof Dt.stack=="string"){for(var te=Dt.stack.split(`
`),Oe=$.stack.split(`
`),Ke=te.length-1,Fe=Oe.length-1;Ke>=1&&Fe>=0&&te[Ke]!==Oe[Fe];)Fe--;for(;Ke>=1&&Fe>=0;Ke--,Fe--)if(te[Ke]!==Oe[Fe]){if(Ke!==1||Fe!==1)do if(Ke--,Fe--,Fe<0||te[Ke]!==Oe[Fe]){var Ne=`
`+te[Ke].replace(" at new "," at ");return y.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",y.displayName)),typeof y=="function"&&ut.set(y,Ne),Ne}while(Ke>=1&&Fe>=0);break}}}finally{st=!1,bt.current=z,ze(),Error.prepareStackTrace=Z}var Ze=y?y.displayName||y.name:"",Yt=Ze?St(Ze):"";return typeof y=="function"&&ut.set(y,Yt),Yt}function Te(y,R,T){return Q(y,!1)}function Re(y){var R=y.prototype;return!!(R&&R.isReactComponent)}function we(y,R,T){if(y==null)return"";if(typeof y=="function")return Q(y,Re(y));if(typeof y=="string")return St(y);switch(y){case m:return St("Suspense");case d:return St("SuspenseList")}if(typeof y=="object")switch(y.$$typeof){case u:return Te(y.render);case f:return we(y.type,R,T);case h:{var $=y,Z=$._payload,z=$._init;try{return we(z(Z),R,T)}catch{}}}return""}var Ye=Object.prototype.hasOwnProperty,Tt={},$t=B.ReactDebugCurrentFrame;function ct(y){if(y){var R=y._owner,T=we(y.type,y._source,R?R.type:null);$t.setExtraStackFrame(T)}else $t.setExtraStackFrame(null)}function P(y,R,T,$,Z){{var z=Function.call.bind(Ye);for(var G in y)if(z(y,G)){var te=void 0;try{if(typeof y[G]!="function"){var Oe=Error(($||"React class")+": "+T+" type `"+G+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof y[G]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Oe.name="Invariant Violation",Oe}te=y[G](R,G,$,T,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Ke){te=Ke}te&&!(te instanceof Error)&&(ct(Z),I("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",$||"React class",T,G,typeof te),ct(null)),te instanceof Error&&!(te.message in Tt)&&(Tt[te.message]=!0,ct(Z),I("Failed %s type: %s",T,te.message),ct(null))}}}var O=Array.isArray;function J(y){return O(y)}function ye(y){{var R=typeof Symbol=="function"&&Symbol.toStringTag,T=R&&y[Symbol.toStringTag]||y.constructor.name||"Object";return T}}function ue(y){try{return fe(y),!1}catch{return!0}}function fe(y){return""+y}function Ce(y){if(ue(y))return I("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ye(y)),fe(y)}var Me=B.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0},Ae,Rs,jt;jt={};function ee(y){if(Ye.call(y,"ref")){var R=Object.getOwnPropertyDescriptor(y,"ref").get;if(R&&R.isReactWarning)return!1}return y.ref!==void 0}function Ge(y){if(Ye.call(y,"key")){var R=Object.getOwnPropertyDescriptor(y,"key").get;if(R&&R.isReactWarning)return!1}return y.key!==void 0}function H(y,R){if(typeof y.ref=="string"&&Me.current&&R&&Me.current.stateNode!==R){var T=k(Me.current.type);jt[T]||(I('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Me.current.type),y.ref),jt[T]=!0)}}function be(y,R){{var T=function(){Ae||(Ae=!0,I("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};T.isReactWarning=!0,Object.defineProperty(y,"key",{get:T,configurable:!0})}}function De(y,R){{var T=function(){Rs||(Rs=!0,I("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};T.isReactWarning=!0,Object.defineProperty(y,"ref",{get:T,configurable:!0})}}var Ie=function(y,R,T,$,Z,z,G){var te={$$typeof:e,type:y,key:R,ref:T,props:G,_owner:z};return te._store={},Object.defineProperty(te._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(te,"_self",{configurable:!1,enumerable:!1,writable:!1,value:$}),Object.defineProperty(te,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Z}),Object.freeze&&(Object.freeze(te.props),Object.freeze(te)),te};function me(y,R,T,$,Z){{var z,G={},te=null,Oe=null;T!==void 0&&(Ce(T),te=""+T),Ge(R)&&(Ce(R.key),te=""+R.key),ee(R)&&(Oe=R.ref,H(R,Z));for(z in R)Ye.call(R,z)&&!et.hasOwnProperty(z)&&(G[z]=R[z]);if(y&&y.defaultProps){var Ke=y.defaultProps;for(z in Ke)G[z]===void 0&&(G[z]=Ke[z])}if(te||Oe){var Fe=typeof y=="function"?y.displayName||y.name||"Unknown":y;te&&be(G,Fe),Oe&&De(G,Fe)}return Ie(y,te,Oe,Z,$,Me.current,G)}}var Mt=B.ReactCurrentOwner,mt=B.ReactDebugCurrentFrame;function Wt(y){if(y){var R=y._owner,T=we(y.type,y._source,R?R.type:null);mt.setExtraStackFrame(T)}else mt.setExtraStackFrame(null)}var At;At=!1;function ds(y){return typeof y=="object"&&y!==null&&y.$$typeof===e}function ss(){{if(Mt.current){var y=k(Mt.current.type);if(y)return`

Check the render method of \``+y+"`."}return""}}function Ts(y){{if(y!==void 0){var R=y.fileName.replace(/^.*[\\\/]/,""),T=y.lineNumber;return`

Check your code at `+R+":"+T+"."}return""}}var fn={};function Ks(y){{var R=ss();if(!R){var T=typeof y=="string"?y:y.displayName||y.name;T&&(R=`

Check the top-level render call using <`+T+">.")}return R}}function pn(y,R){{if(!y._store||y._store.validated||y.key!=null)return;y._store.validated=!0;var T=Ks(R);if(fn[T])return;fn[T]=!0;var $="";y&&y._owner&&y._owner!==Mt.current&&($=" It was passed a child from "+k(y._owner.type)+"."),Wt(y),I('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',T,$),Wt(null)}}function Kr(y,R){{if(typeof y!="object")return;if(J(y))for(var T=0;T<y.length;T++){var $=y[T];ds($)&&pn($,R)}else if(ds(y))y._store&&(y._store.validated=!0);else if(y){var Z=w(y);if(typeof Z=="function"&&Z!==y.entries)for(var z=Z.call(y),G;!(G=z.next()).done;)ds(G.value)&&pn(G.value,R)}}}function Sn(y){{var R=y.type;if(R==null||typeof R=="string")return;var T;if(typeof R=="function")T=R.propTypes;else if(typeof R=="object"&&(R.$$typeof===u||R.$$typeof===f))T=R.propTypes;else return;if(T){var $=k(R);P(T,y.props,"prop",$,y)}else if(R.PropTypes!==void 0&&!At){At=!0;var Z=k(R);I("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Z||"Unknown")}typeof R.getDefaultProps=="function"&&!R.getDefaultProps.isReactClassApproved&&I("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function en(y){{for(var R=Object.keys(y.props),T=0;T<R.length;T++){var $=R[T];if($!=="children"&&$!=="key"){Wt(y),I("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",$),Wt(null);break}}y.ref!==null&&(Wt(y),I("Invalid attribute `ref` supplied to `React.Fragment`."),Wt(null))}}var Tn={};function v(y,R,T,$,Z,z){{var G=j(y);if(!G){var te="";(y===void 0||typeof y=="object"&&y!==null&&Object.keys(y).length===0)&&(te+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Oe=Ts(Z);Oe?te+=Oe:te+=ss();var Ke;y===null?Ke="null":J(y)?Ke="array":y!==void 0&&y.$$typeof===e?(Ke="<"+(k(y.type)||"Unknown")+" />",te=" Did you accidentally export a JSX literal instead of a component?"):Ke=typeof y,I("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ke,te)}var Fe=me(y,R,T,Z,z);if(Fe==null)return Fe;if(G){var Ne=R.children;if(Ne!==void 0)if($)if(J(Ne)){for(var Ze=0;Ze<Ne.length;Ze++)Kr(Ne[Ze],y);Object.freeze&&Object.freeze(Ne)}else I("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Kr(Ne,y)}if(Ye.call(R,"key")){var Yt=k(y),Dt=Object.keys(R).filter(function(Qs){return Qs!=="key"}),fs=Dt.length>0?"{key: someKey, "+Dt.join(": ..., ")+": ...}":"{key: someKey}";if(!Tn[Yt+fs]){var Gt=Dt.length>0?"{"+Dt.join(": ..., ")+": ...}":"{}";I(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,fs,Yt,Gt,Yt),Tn[Yt+fs]=!0}}return y===n?en(Fe):Sn(Fe),Fe}}var q=v;nu.Fragment=n,nu.jsxDEV=q})();ch.exports=nu;var a=ch.exports,uh,Id=fN;{var Pd=Id.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;uh=function(s,e){Pd.usingClientEntryPoint=!0;try{return Id.createRoot(s,e)}finally{Pd.usingClientEntryPoint=!1}}}const GN="modulepreload",XN=function(s){return"/"+s},jd={},Qn=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=XN(u),u in jd)return;jd[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":GN,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,b)=>{f.addEventListener("load",h),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let JN={data:""},ZN=s=>{if(typeof window=="object"){let e=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(s||document.head).appendChild(e),e.firstChild}return s||JN},e0=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,t0=/\/\*[^]*?\*\/|  +/g,Rd=/\n+/g,Nr=(s,e)=>{let t="",n="",r="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?Nr(o,i):i+"{"+Nr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=Nr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Nr.p?Nr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+n},Yn={},mh=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+mh(s[t]);return e}return s},s0=(s,e,t,n,r)=>{let i=mh(s),o=Yn[i]||(Yn[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Yn[o]){let u=i!==s?s:(m=>{let d,f,h=[{}];for(;d=e0.exec(m.replace(t0,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Rd," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Rd," ").trim();return h[0]})(s);Yn[o]=Nr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Yn.g?Yn.g:null;return t&&(Yn.g=Yn[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Yn[o],e,n,l),o},n0=(s,e,t)=>s.reduce((n,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Nr(l,""):l===!1?"":l}return n+r+(o??"")},"");function Ol(s){let e=this||{},t=s.call?s(e.p):s;return s0(t.unshift?t.raw?n0(t,[].slice.call(arguments,1),e.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):t,ZN(e.target),e.g,e.o,e.k)}let dh,ru,iu;Ol.bind({g:1});let sr=Ol.bind({k:1});function r0(s,e,t,n){Nr.p=e,dh=s,ru=t,iu=n}function Rr(s,e){let t=this||{};return function(){let n=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:ru&&ru()},l),t.o=/ *go\d+/.test(u),l.className=Ol.apply(t,n)+(u?" "+u:"");let m=s;return s[0]&&(m=l.as||s,delete l.as),iu&&m[0]&&iu(l),dh(m,l)}return r}}var i0=s=>typeof s=="function",bl=(s,e)=>i0(s)?s(e):s,o0=(()=>{let s=0;return()=>(++s).toString()})(),fh=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),a0=20,em="default",ph=(s,e)=>{let{toastLimit:t}=s.settings;switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:n}=e;return ph(s,{type:s.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...s,toasts:s.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let i=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},sl=[],hh={toasts:[],pausedAt:void 0,settings:{toastLimit:a0}},Un={},gh=(s,e=em)=>{Un[e]=ph(Un[e]||hh,s),sl.forEach(([t,n])=>{t===e&&n(Un[e])})},yh=s=>Object.keys(Un).forEach(e=>gh(s,e)),l0=s=>Object.keys(Un).find(e=>Un[e].toasts.some(t=>t.id===s)),Fl=(s=em)=>e=>{gh(e,s)},c0={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},u0=(s={},e=em)=>{let[t,n]=A.useState(Un[e]||hh),r=A.useRef(Un[e]);A.useEffect(()=>(r.current!==Un[e]&&n(Un[e]),sl.push([e,n]),()=>{let o=sl.findIndex(([l])=>l===e);o>-1&&sl.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...s,...s[o.type],...o,removeDelay:o.removeDelay||((l=s[o.type])==null?void 0:l.removeDelay)||(s==null?void 0:s.removeDelay),duration:o.duration||((u=s[o.type])==null?void 0:u.duration)||(s==null?void 0:s.duration)||c0[o.type],style:{...s.style,...(m=s[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},m0=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||o0()}),da=s=>(e,t)=>{let n=m0(e,s,t);return Fl(n.toasterId||l0(n.id))({type:2,toast:n}),n.id},ws=(s,e)=>da("blank")(s,e);ws.error=da("error");ws.success=da("success");ws.loading=da("loading");ws.custom=da("custom");ws.dismiss=(s,e)=>{let t={type:3,toastId:s};e?Fl(e)(t):yh(t)};ws.dismissAll=s=>ws.dismiss(void 0,s);ws.remove=(s,e)=>{let t={type:4,toastId:s};e?Fl(e)(t):yh(t)};ws.removeAll=s=>ws.remove(void 0,s);ws.promise=(s,e,t)=>{let n=ws.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof s=="function"&&(s=s()),s.then(r=>{let i=e.success?bl(e.success,r):void 0;return i?ws.success(i,{id:n,...t,...t==null?void 0:t.success}):ws.dismiss(n),r}).catch(r=>{let i=e.error?bl(e.error,r):void 0;i?ws.error(i,{id:n,...t,...t==null?void 0:t.error}):ws.dismiss(n)}),s};var d0=1e3,f0=(s,e="default")=>{let{toasts:t,pausedAt:n}=u0(s,e),r=A.useRef(new Map).current,i=A.useCallback((f,h=d0)=>{if(r.has(f))return;let b=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,b)},[]);A.useEffect(()=>{if(n)return;let f=Date.now(),h=t.map(b=>{if(b.duration===1/0)return;let V=(b.duration||0)+b.pauseDuration-(f-b.createdAt);if(V<0){b.visible&&ws.dismiss(b.id);return}return setTimeout(()=>ws.dismiss(b.id,e),V)});return()=>{h.forEach(b=>b&&clearTimeout(b))}},[t,n,e]);let o=A.useCallback(Fl(e),[e]),l=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=A.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=A.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),d=A.useCallback((f,h)=>{let{reverseOrder:b=!1,gutter:V=8,defaultPosition:_}=h||{},w=t.filter(F=>(F.position||_)===(f.position||_)&&F.height),B=w.findIndex(F=>F.id===f.id),I=w.filter((F,oe)=>oe<B&&F.visible).length;return w.filter(F=>F.visible).slice(...b?[I+1]:[0,I]).reduce((F,oe)=>F+(oe.height||0)+V,0)},[t]);return A.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},p0=sr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,h0=sr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,g0=sr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,y0=Rr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${p0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${h0} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${g0} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,b0=sr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,N0=Rr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${b0} 1s linear infinite;
`,x0=sr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,v0=sr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_0=Rr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${x0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${v0} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,D0=Rr("div")`
  position: absolute;
`,k0=Rr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,A0=sr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,E0=Rr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${A0} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,C0=({toast:s})=>{let{icon:e,type:t,iconTheme:n}=s;return e!==void 0?typeof e=="string"?A.createElement(E0,null,e):e:t==="blank"?null:A.createElement(k0,null,A.createElement(N0,{...n}),t!=="loading"&&A.createElement(D0,null,t==="error"?A.createElement(y0,{...n}):A.createElement(_0,{...n})))},V0=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,w0=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,S0="0%{opacity:0;} 100%{opacity:1;}",T0="0%{opacity:1;} 100%{opacity:0;}",L0=Rr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,I0=Rr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,P0=(s,e)=>{let t=s.includes("top")?1:-1,[n,r]=fh()?[S0,T0]:[V0(t),w0(t)];return{animation:e?`${sr(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${sr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},j0=A.memo(({toast:s,position:e,style:t,children:n})=>{let r=s.height?P0(s.position||e||"top-center",s.visible):{opacity:0},i=A.createElement(C0,{toast:s}),o=A.createElement(I0,{...s.ariaProps},bl(s.message,s));return A.createElement(L0,{className:s.className,style:{...r,...t,...s.style}},typeof n=="function"?n({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});r0(A.createElement);var R0=({id:s,className:e,style:t,onHeightUpdate:n,children:r})=>{let i=A.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(s,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[s,n]);return A.createElement("div",{ref:i,className:e,style:t},r)},B0=(s,e)=>{let t=s.includes("top"),n=t?{top:0}:{bottom:0},r=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:fh()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...r}},U0=Ol`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ia=16,H0=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:n,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=f0(t,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ia,left:Ia,right:Ia,bottom:Ia,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:s,gutter:n,defaultPosition:e}),b=B0(f,h);return A.createElement(R0,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?U0:"",style:b},d.type==="custom"?bl(d.message,d):r?r(d):A.createElement(j0,{toast:d,position:f}))}))},ne=ws;const Wn=Object.create(null);Wn.open="0";Wn.close="1";Wn.ping="2";Wn.pong="3";Wn.message="4";Wn.upgrade="5";Wn.noop="6";const nl=Object.create(null);Object.keys(Wn).forEach(s=>{nl[Wn[s]]=s});const ou={type:"error",data:"parser error"},bh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Nh=typeof ArrayBuffer=="function",xh=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,tm=({type:s,data:e},t,n)=>bh&&e instanceof Blob?t?n(e):Bd(e,n):Nh&&(e instanceof ArrayBuffer||xh(e))?t?n(e):Bd(new Blob([e]),n):n(Wn[s]+(e||"")),Bd=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Ud(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Lc;function M0(s,e){if(bh&&s.data instanceof Blob)return s.data.arrayBuffer().then(Ud).then(e);if(Nh&&(s.data instanceof ArrayBuffer||xh(s.data)))return e(Ud(s.data));tm(s,!1,t=>{Lc||(Lc=new TextEncoder),e(Lc.encode(t))})}const Hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Po=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Hd.length;s++)Po[Hd.charCodeAt(s)]=s;const O0=s=>{let e=s.length*.75,t=s.length,n,r=0,i,o,l,u;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(n=0;n<t;n+=4)i=Po[s.charCodeAt(n)],o=Po[s.charCodeAt(n+1)],l=Po[s.charCodeAt(n+2)],u=Po[s.charCodeAt(n+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},F0=typeof ArrayBuffer=="function",sm=(s,e)=>{if(typeof s!="string")return{type:"message",data:vh(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:q0(s.substring(1),e)}:nl[t]?s.length>1?{type:nl[t],data:s.substring(1)}:{type:nl[t]}:ou},q0=(s,e)=>{if(F0){const t=O0(s);return vh(t,e)}else return{base64:!0,data:s}},vh=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},_h="",$0=(s,e)=>{const t=s.length,n=new Array(t);let r=0;s.forEach((i,o)=>{tm(i,!1,l=>{n[o]=l,++r===t&&e(n.join(_h))})})},W0=(s,e)=>{const t=s.split(_h),n=[];for(let r=0;r<t.length;r++){const i=sm(t[r],e);if(n.push(i),i.type==="error")break}return n};function z0(){return new TransformStream({transform(s,e){M0(s,t=>{const n=t.length;let r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Ic;function Pa(s){return s.reduce((e,t)=>e+t.length,0)}function ja(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let r=0;r<e;r++)t[r]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function K0(s,e){Ic||(Ic=new TextDecoder);const t=[];let n=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(Pa(t)<1)break;const u=ja(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(Pa(t)<2)break;const u=ja(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(Pa(t)<8)break;const u=ja(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(ou);break}r=d*Math.pow(2,32)+m.getUint32(4),n=3}else{if(Pa(t)<r)break;const u=ja(t,r);l.enqueue(sm(i?u:Ic.decode(u),e)),n=0}if(r===0||r>s){l.enqueue(ou);break}}}})}const Dh=4;function Ds(s){if(s)return Q0(s)}function Q0(s){for(var e in Ds.prototype)s[e]=Ds.prototype[e];return s}Ds.prototype.on=Ds.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Ds.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Ds.prototype.off=Ds.prototype.removeListener=Ds.prototype.removeAllListeners=Ds.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Ds.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};Ds.prototype.emitReserved=Ds.prototype.emit;Ds.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ds.prototype.hasListeners=function(s){return!!this.listeners(s).length};const ql=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),gn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Y0="arraybuffer";function kh(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const G0=gn.setTimeout,X0=gn.clearTimeout;function $l(s,e){e.useNativeTimers?(s.setTimeoutFn=G0.bind(gn),s.clearTimeoutFn=X0.bind(gn)):(s.setTimeoutFn=gn.setTimeout.bind(gn),s.clearTimeoutFn=gn.clearTimeout.bind(gn))}const J0=1.33;function Z0(s){return typeof s=="string"?ex(s):Math.ceil((s.byteLength||s.size)*J0)}function ex(s){let e=0,t=0;for(let n=0,r=s.length;n<r;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Ah(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function tx(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function sx(s){let e={},t=s.split("&");for(let n=0,r=t.length;n<r;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class nx extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class nm extends Ds{constructor(e){super(),this.writable=!1,$l(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new nx(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=sm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=tx(e);return t.length?"?"+t:""}}class rx extends nm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};W0(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,$0(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Ah()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Eh=!1;try{Eh=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ix=Eh;function ox(){}class ax extends rx{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}let Wi=class rl extends Ds{constructor(e,t,n){super(),this.createRequest=e,$l(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=kh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var r;n.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=rl.requestsCount++,rl.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ox,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete rl.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Wi.requestsCount=0;Wi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Md);else if(typeof addEventListener=="function"){const s="onpagehide"in gn?"pagehide":"unload";addEventListener(s,Md,!1)}}function Md(){for(let s in Wi.requests)Wi.requests.hasOwnProperty(s)&&Wi.requests[s].abort()}const lx=function(){const s=Ch({xdomain:!1});return s&&s.responseType!==null}();class cx extends ax{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=lx&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Wi(Ch,this.uri(),e)}}function Ch(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ix))return new XMLHttpRequest}catch{}if(!e)try{return new gn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Vh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class ux extends nm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Vh?{}:kh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;tm(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}r&&ql(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ah()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Pc=gn.WebSocket||gn.MozWebSocket;class mx extends ux{createSocket(e,t,n){return Vh?new Pc(e,t,n):t?new Pc(e,t):new Pc(e)}doWrite(e,t){this.ws.send(t)}}class dx extends nm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=K0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=z0();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&ql(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const fx={websocket:mx,webtransport:dx,polling:cx},px=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function au(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let r=px.exec(s||""),i={},o=14;for(;o--;)i[hx[o]]=r[o]||"";return t!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=gx(i,i.path),i.queryKey=yx(i,i.query),i}function gx(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function yx(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,i){r&&(t[r]=i)}),t}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",il=[];lu&&addEventListener("offline",()=>{il.forEach(s=>s())},!1);class Dr extends Ds{constructor(e,t){if(super(),this.binaryType=Y0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=au(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=au(t.host).host);$l(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const r=n.prototype.name;this.transports.push(r),this._transportsByName[r]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=sx(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},il.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Dh,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Dr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Dr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+=Z0(r)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ql(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if(typeof t=="function"&&(r=t,t=void 0),typeof n=="function"&&(r=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Dr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=il.indexOf(this._offlineEventListener);n!==-1&&il.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Dr.protocol=Dh;class bx extends Dr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Dr.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Dr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){n||(n=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Nx=class extends bx{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>fx[r]).filter(r=>!!r)),super(e,n)}};function xx(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=au(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}const vx=typeof ArrayBuffer=="function",_x=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,wh=Object.prototype.toString,Dx=typeof Blob=="function"||typeof Blob<"u"&&wh.call(Blob)==="[object BlobConstructor]",kx=typeof File=="function"||typeof File<"u"&&wh.call(File)==="[object FileConstructor]";function rm(s){return vx&&(s instanceof ArrayBuffer||_x(s))||Dx&&s instanceof Blob||kx&&s instanceof File}function ol(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(ol(s[t]))return!0;return!1}if(rm(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return ol(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&ol(s[t]))return!0;return!1}function Ax(s){const e=[],t=s.data,n=s;return n.data=cu(t,e),n.attachments=e.length,{packet:n,buffers:e}}function cu(s,e){if(!s)return s;if(rm(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=cu(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=cu(s[n],e));return t}return s}function Ex(s,e){return s.data=uu(s.data,e),delete s.attachments,s}function uu(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=uu(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=uu(s[t],e));return s}const Cx=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Vx=5;var kt;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(kt||(kt={}));class wx{constructor(e){this.replacer=e}encode(e){return(e.type===kt.EVENT||e.type===kt.ACK)&&ol(e)?this.encodeAsBinary({type:e.type===kt.EVENT?kt.BINARY_EVENT:kt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===kt.BINARY_EVENT||e.type===kt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Ax(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function Od(s){return Object.prototype.toString.call(s)==="[object Object]"}class im extends Ds{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===kt.BINARY_EVENT;n||t.type===kt.BINARY_ACK?(t.type=n?kt.EVENT:kt.ACK,this.reconstructor=new Sx(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(rm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(kt[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===kt.BINARY_EVENT||n.type===kt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(i,t)}else n.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(im.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case kt.CONNECT:return Od(t);case kt.DISCONNECT:return t===void 0;case kt.CONNECT_ERROR:return typeof t=="string"||Od(t);case kt.EVENT:case kt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Cx.indexOf(t[0])===-1);case kt.ACK:case kt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Sx{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Ex(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Tx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:im,Encoder:wx,get PacketType(){return kt},protocol:Vx},Symbol.toStringTag,{value:"Module"}));function vn(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const Lx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Sh extends Ds{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[vn(e,"open",this.onopen.bind(this)),vn(e,"packet",this.onpacket.bind(this)),vn(e,"error",this.onerror.bind(this)),vn(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,i;if(Lx.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:kt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{const i=(o,l)=>o?r(o):n(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:kt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case kt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case kt.EVENT:case kt.BINARY_EVENT:this.onevent(e);break;case kt.ACK:case kt.BINARY_ACK:this.onack(e);break;case kt.DISCONNECT:this.ondisconnect();break;case kt.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:kt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:kt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function so(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}so.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};so.prototype.reset=function(){this.attempts=0};so.prototype.setMin=function(s){this.ms=s};so.prototype.setMax=function(s){this.max=s};so.prototype.setJitter=function(s){this.jitter=s};class mu extends Ds{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,$l(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new so({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Tx;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Nx(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=vn(t,"open",function(){n.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=vn(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(vn(e,"ping",this.onping.bind(this)),vn(e,"data",this.ondata.bind(this)),vn(e,"error",this.onerror.bind(this)),vn(e,"close",this.onclose.bind(this)),vn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){ql(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Sh(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const No={};function Mo(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=xx(s,e.path||"/socket.io"),n=t.source,r=t.id,i=t.path,o=No[r]&&i in No[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new mu(n,e):(No[r]||(No[r]=new mu(n,e)),u=No[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Mo,{Manager:mu,Socket:Sh,io:Mo,connect:Mo});function Ix(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Qn(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const b=()=>{h=!0,l==null||l.addEventListener("controlling",V=>{V.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",V=>{typeof V.isUpdate>"u"?typeof V.isExternal<"u"?V.isExternal?b():!h&&(n==null||n()):V.isExternal?window.location.reload():!h&&(n==null||n()):V.isUpdate||n==null||n()}),l.addEventListener("waiting",b),l.addEventListener("externalwaiting",b)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const Px=()=>{if(typeof window<"u"){const s=window.location.hostname;if(s==="hvlab.app"||s.includes("hv-lab-app")||s.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},jx=Px(),Xo=bN.create({baseURL:jx,headers:{"Content-Type":"application/json"}});Xo.interceptors.request.use(s=>{const e=localStorage.getItem("token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));Xo.interceptors.response.use(s=>s,s=>{var e,t,n;return((e=s.response)==null?void 0:e.status)===401&&!((n=(t=s.config)==null?void 0:t.url)!=null&&n.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Rx=()=>{};var Fd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Bx=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const r=s[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=s[t++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=s[t++],o=s[t++],l=s[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=s[t++],o=s[t++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Lh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<s.length;r+=3){const i=s[r],o=r+1<s.length,l=o?s[r+1]:0,u=r+2<s.length,m=u?s[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,b=m&63;u||(b=64,o||(h=64)),n.push(t[d],t[f],t[h],t[b])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Th(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Bx(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<s.length;){const i=t[s.charAt(r++)],l=r<s.length?t[s.charAt(r)]:0;++r;const m=r<s.length?t[s.charAt(r)]:64;++r;const f=r<s.length?t[s.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new Ux;const h=i<<2|l>>4;if(n.push(h),m!==64){const b=l<<4&240|m>>2;if(n.push(b),f!==64){const V=m<<6&192|f;n.push(V)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Ux extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Hx=function(s){const e=Th(s);return Lh.encodeByteArray(e,!0)},Nl=function(s){return Hx(s).replace(/\./g,"")},Mx=function(s){try{return Lh.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx=()=>Ox().__FIREBASE_DEFAULTS__,qx=()=>{if(typeof process>"u"||typeof Fd>"u")return;const s=Fd.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},$x=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Mx(s[1]);return e&&JSON.parse(e)},om=()=>{try{return Rx()||Fx()||qx()||$x()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Wx=s=>{var e,t;return(t=(e=om())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},Ih=s=>{const e=Wx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Ph=()=>{var s;return(s=om())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function jh(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=s.iat||0,i=s.sub||s.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Nl(JSON.stringify(t)),Nl(JSON.stringify(o)),""].join(".")}const Oo={};function Kx(){const s={prod:[],emulator:[]};for(const e of Object.keys(Oo))Oo[e]?s.emulator.push(e):s.prod.push(e);return s}function Qx(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let qd=!1;function Bh(s,e){if(typeof window>"u"||typeof document>"u"||!fa(window.location.host)||Oo[s]===e||Oo[s]||qd)return;Oo[s]=e;function t(h){return`__firebase__banner__${h}`}const n="__firebase__banner",i=Kx().prod.length>0;function o(){const h=document.getElementById(n);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,b){h.setAttribute("width","24"),h.setAttribute("id",b),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{qd=!0,o()},h}function d(h,b){h.setAttribute("id",b),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=Qx(n),b=t("text"),V=document.getElementById(b)||document.createElement("span"),_=t("learnmore"),w=document.getElementById(_)||document.createElement("a"),B=t("preprendIcon"),I=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const F=h.element;l(F),d(w,_);const oe=m();u(I,B),F.append(I,V,w,oe),document.body.appendChild(F)}i?(V.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gx(){var e;const s=(e=om())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Xx(){return!Gx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jx(){try{return typeof indexedDB=="object"}catch{return!1}}function Zx(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="FirebaseError";class ui extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ev,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Uh.prototype.create)}}class Uh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?tv(i,n):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new ui(r,l,n)}}function tv(s,e){return s.replace(sv,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const sv=/\{\$([^}]+)}/g;function xl(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const i=s[r],o=e[r];if($d(i)&&$d(o)){if(!xl(i,o))return!1}else if(i!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function $d(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(s){return s&&s._delegate?s._delegate:s}class Ki{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new zx;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iv(e))try{this.getOrInitializeService({instanceIdentifier:Jr})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=Jr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jr){return this.instances.has(e)}getOptions(e=Jr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:rv(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Jr){return this.component?this.component.multipleInstances?e:Jr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rv(s){return s===Jr?void 0:s}function iv(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nv(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Vt||(Vt={}));const av={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},lv=Vt.INFO,cv={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},uv=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),r=cv[e];if(r)console[r](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hh{constructor(e){this.name=e,this._logLevel=lv,this._logHandler=uv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?av[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const mv=(s,e)=>e.some(t=>s instanceof t);let Wd,zd;function dv(){return Wd||(Wd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fv(){return zd||(zd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Mh=new WeakMap,du=new WeakMap,Oh=new WeakMap,jc=new WeakMap,am=new WeakMap;function pv(s){const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("success",i),s.removeEventListener("error",o)},i=()=>{t(kr(s.result)),r()},o=()=>{n(s.error),r()};s.addEventListener("success",i),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Mh.set(t,s)}).catch(()=>{}),am.set(e,s),e}function hv(s){if(du.has(s))return;const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("complete",i),s.removeEventListener("error",o),s.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",i),s.addEventListener("error",o),s.addEventListener("abort",o)});du.set(s,e)}let fu={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return du.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Oh.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return kr(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function gv(s){fu=s(fu)}function yv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Rc(this),e,...t);return Oh.set(n,e.sort?e.sort():[e]),kr(n)}:fv().includes(s)?function(...e){return s.apply(Rc(this),e),kr(Mh.get(this))}:function(...e){return kr(s.apply(Rc(this),e))}}function bv(s){return typeof s=="function"?yv(s):(s instanceof IDBTransaction&&hv(s),mv(s,dv())?new Proxy(s,fu):s)}function kr(s){if(s instanceof IDBRequest)return pv(s);if(jc.has(s))return jc.get(s);const e=bv(s);return e!==s&&(jc.set(s,e),am.set(e,s)),e}const Rc=s=>am.get(s);function Nv(s,e,{blocked:t,upgrade:n,blocking:r,terminated:i}={}){const o=indexedDB.open(s,e),l=kr(o);return n&&o.addEventListener("upgradeneeded",u=>{n(kr(o.result),u.oldVersion,u.newVersion,kr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const xv=["get","getKey","getAll","getAllKeys","count"],vv=["put","add","delete","clear"],Bc=new Map;function Kd(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Bc.get(e))return Bc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=vv.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||xv.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return n&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Bc.set(e,i),i}gv(s=>({...s,get:(e,t,n)=>Kd(e,t)||s.get(e,t,n),has:(e,t)=>!!Kd(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Dv(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Dv(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pu="@firebase/app",Qd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new Hh("@firebase/app"),kv="@firebase/app-compat",Av="@firebase/analytics-compat",Ev="@firebase/analytics",Cv="@firebase/app-check-compat",Vv="@firebase/app-check",wv="@firebase/auth",Sv="@firebase/auth-compat",Tv="@firebase/database",Lv="@firebase/data-connect",Iv="@firebase/database-compat",Pv="@firebase/functions",jv="@firebase/functions-compat",Rv="@firebase/installations",Bv="@firebase/installations-compat",Uv="@firebase/messaging",Hv="@firebase/messaging-compat",Mv="@firebase/performance",Ov="@firebase/performance-compat",Fv="@firebase/remote-config",qv="@firebase/remote-config-compat",$v="@firebase/storage",Wv="@firebase/storage-compat",zv="@firebase/firestore",Kv="@firebase/ai",Qv="@firebase/firestore-compat",Yv="firebase",Gv="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="[DEFAULT]",Xv={[pu]:"fire-core",[kv]:"fire-core-compat",[Ev]:"fire-analytics",[Av]:"fire-analytics-compat",[Vv]:"fire-app-check",[Cv]:"fire-app-check-compat",[wv]:"fire-auth",[Sv]:"fire-auth-compat",[Tv]:"fire-rtdb",[Lv]:"fire-data-connect",[Iv]:"fire-rtdb-compat",[Pv]:"fire-fn",[jv]:"fire-fn-compat",[Rv]:"fire-iid",[Bv]:"fire-iid-compat",[Uv]:"fire-fcm",[Hv]:"fire-fcm-compat",[Mv]:"fire-perf",[Ov]:"fire-perf-compat",[Fv]:"fire-rc",[qv]:"fire-rc-compat",[$v]:"fire-gcs",[Wv]:"fire-gcs-compat",[zv]:"fire-fst",[Qv]:"fire-fst-compat",[Kv]:"fire-vertex","fire-js":"fire-js",[Yv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new Map,Jv=new Map,gu=new Map;function Yd(s,e){try{s.container.addComponent(e)}catch(t){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Zo(s){const e=s.name;if(gu.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;gu.set(e,s);for(const t of Jo.values())Yd(t,s);for(const t of Jv.values())Yd(t,s);return!0}function Fh(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function qh(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ar=new Uh("app","Firebase",Zv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ki("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=Gv;function Wh(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:hu,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw Ar.create("bad-app-name",{appName:String(r)});if(t||(t=Ph()),!t)throw Ar.create("no-options");const i=Jo.get(r);if(i){if(xl(t,i.options)&&xl(n,i.config))return i;throw Ar.create("duplicate-app",{appName:r})}const o=new ov(r);for(const u of gu.values())o.addComponent(u);const l=new e_(t,n,o);return Jo.set(r,l),l}function zh(s=hu){const e=Jo.get(s);if(!e&&s===hu&&Ph())return Wh();if(!e)throw Ar.create("no-app",{appName:s});return e}function Gd(){return Array.from(Jo.values())}function Er(s,e,t){let n=Xv[s]??s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(o.join(" "));return}Zo(new Ki(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="firebase-heartbeat-database",s_=1,ea="firebase-heartbeat-store";let Uc=null;function Kh(){return Uc||(Uc=Nv(t_,s_,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(ea)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ar.create("idb-open",{originalErrorMessage:s.message})})),Uc}async function n_(s){try{const t=(await Kh()).transaction(ea),n=await t.objectStore(ea).get(Qh(s));return await t.done,n}catch(e){if(e instanceof ui)nr.warn(e.message);else{const t=Ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(t.message)}}}async function Xd(s,e){try{const n=(await Kh()).transaction(ea,"readwrite");await n.objectStore(ea).put(e,Qh(s)),await n.done}catch(t){if(t instanceof ui)nr.warn(t.message);else{const n=Ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});nr.warn(n.message)}}}function Qh(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=1024,i_=30;class o_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new l_(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Jd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>i_){const o=c_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){nr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Jd(),{heartbeatsToSend:n,unsentEntries:r}=a_(this._heartbeatsCache.heartbeats),i=Nl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return nr.warn(t),""}}}function Jd(){return new Date().toISOString().substring(0,10)}function a_(s,e=r_){const t=[];let n=s.slice();for(const r of s){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Zd(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Zd(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class l_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jx()?Zx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await n_(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Zd(s){return Nl(JSON.stringify({version:2,heartbeats:s})).length}function c_(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(s){Zo(new Ki("platform-logger",e=>new _v(e),"PRIVATE")),Zo(new Ki("heartbeat",e=>new o_(e),"PRIVATE")),Er(pu,Qd,s),Er(pu,Qd,"esm2020"),Er("fire-js","")}u_("");var m_="firebase",d_="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er(m_,d_,"app");var ef=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cr,Yh;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,x){function E(){}E.prototype=x.prototype,C.F=x.prototype,C.prototype=new E,C.prototype.constructor=C,C.D=function(j,L,S){for(var k=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)k[_e-2]=arguments[_e];return x.prototype[L].apply(j,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,x,E){E||(E=0);const j=Array(16);if(typeof x=="string")for(var L=0;L<16;++L)j[L]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(L=0;L<16;++L)j[L]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=C.g[0],E=C.g[1],L=C.g[2];let S=C.g[3],k;k=x+(S^E&(L^S))+j[0]+3614090360&4294967295,x=E+(k<<7&4294967295|k>>>25),k=S+(L^x&(E^L))+j[1]+3905402710&4294967295,S=x+(k<<12&4294967295|k>>>20),k=L+(E^S&(x^E))+j[2]+606105819&4294967295,L=S+(k<<17&4294967295|k>>>15),k=E+(x^L&(S^x))+j[3]+3250441966&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(S^E&(L^S))+j[4]+4118548399&4294967295,x=E+(k<<7&4294967295|k>>>25),k=S+(L^x&(E^L))+j[5]+1200080426&4294967295,S=x+(k<<12&4294967295|k>>>20),k=L+(E^S&(x^E))+j[6]+2821735955&4294967295,L=S+(k<<17&4294967295|k>>>15),k=E+(x^L&(S^x))+j[7]+4249261313&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(S^E&(L^S))+j[8]+1770035416&4294967295,x=E+(k<<7&4294967295|k>>>25),k=S+(L^x&(E^L))+j[9]+2336552879&4294967295,S=x+(k<<12&4294967295|k>>>20),k=L+(E^S&(x^E))+j[10]+4294925233&4294967295,L=S+(k<<17&4294967295|k>>>15),k=E+(x^L&(S^x))+j[11]+2304563134&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(S^E&(L^S))+j[12]+1804603682&4294967295,x=E+(k<<7&4294967295|k>>>25),k=S+(L^x&(E^L))+j[13]+4254626195&4294967295,S=x+(k<<12&4294967295|k>>>20),k=L+(E^S&(x^E))+j[14]+2792965006&4294967295,L=S+(k<<17&4294967295|k>>>15),k=E+(x^L&(S^x))+j[15]+1236535329&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(L^S&(E^L))+j[1]+4129170786&4294967295,x=E+(k<<5&4294967295|k>>>27),k=S+(E^L&(x^E))+j[6]+3225465664&4294967295,S=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(S^x))+j[11]+643717713&4294967295,L=S+(k<<14&4294967295|k>>>18),k=E+(S^x&(L^S))+j[0]+3921069994&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^S&(E^L))+j[5]+3593408605&4294967295,x=E+(k<<5&4294967295|k>>>27),k=S+(E^L&(x^E))+j[10]+38016083&4294967295,S=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(S^x))+j[15]+3634488961&4294967295,L=S+(k<<14&4294967295|k>>>18),k=E+(S^x&(L^S))+j[4]+3889429448&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^S&(E^L))+j[9]+568446438&4294967295,x=E+(k<<5&4294967295|k>>>27),k=S+(E^L&(x^E))+j[14]+3275163606&4294967295,S=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(S^x))+j[3]+4107603335&4294967295,L=S+(k<<14&4294967295|k>>>18),k=E+(S^x&(L^S))+j[8]+1163531501&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^S&(E^L))+j[13]+2850285829&4294967295,x=E+(k<<5&4294967295|k>>>27),k=S+(E^L&(x^E))+j[2]+4243563512&4294967295,S=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(S^x))+j[7]+1735328473&4294967295,L=S+(k<<14&4294967295|k>>>18),k=E+(S^x&(L^S))+j[12]+2368359562&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(E^L^S)+j[5]+4294588738&4294967295,x=E+(k<<4&4294967295|k>>>28),k=S+(x^E^L)+j[8]+2272392833&4294967295,S=x+(k<<11&4294967295|k>>>21),k=L+(S^x^E)+j[11]+1839030562&4294967295,L=S+(k<<16&4294967295|k>>>16),k=E+(L^S^x)+j[14]+4259657740&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^S)+j[1]+2763975236&4294967295,x=E+(k<<4&4294967295|k>>>28),k=S+(x^E^L)+j[4]+1272893353&4294967295,S=x+(k<<11&4294967295|k>>>21),k=L+(S^x^E)+j[7]+4139469664&4294967295,L=S+(k<<16&4294967295|k>>>16),k=E+(L^S^x)+j[10]+3200236656&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^S)+j[13]+681279174&4294967295,x=E+(k<<4&4294967295|k>>>28),k=S+(x^E^L)+j[0]+3936430074&4294967295,S=x+(k<<11&4294967295|k>>>21),k=L+(S^x^E)+j[3]+3572445317&4294967295,L=S+(k<<16&4294967295|k>>>16),k=E+(L^S^x)+j[6]+76029189&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^S)+j[9]+3654602809&4294967295,x=E+(k<<4&4294967295|k>>>28),k=S+(x^E^L)+j[12]+3873151461&4294967295,S=x+(k<<11&4294967295|k>>>21),k=L+(S^x^E)+j[15]+530742520&4294967295,L=S+(k<<16&4294967295|k>>>16),k=E+(L^S^x)+j[2]+3299628645&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(L^(E|~S))+j[0]+4096336452&4294967295,x=E+(k<<6&4294967295|k>>>26),k=S+(E^(x|~L))+j[7]+1126891415&4294967295,S=x+(k<<10&4294967295|k>>>22),k=L+(x^(S|~E))+j[14]+2878612391&4294967295,L=S+(k<<15&4294967295|k>>>17),k=E+(S^(L|~x))+j[5]+4237533241&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~S))+j[12]+1700485571&4294967295,x=E+(k<<6&4294967295|k>>>26),k=S+(E^(x|~L))+j[3]+2399980690&4294967295,S=x+(k<<10&4294967295|k>>>22),k=L+(x^(S|~E))+j[10]+4293915773&4294967295,L=S+(k<<15&4294967295|k>>>17),k=E+(S^(L|~x))+j[1]+2240044497&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~S))+j[8]+1873313359&4294967295,x=E+(k<<6&4294967295|k>>>26),k=S+(E^(x|~L))+j[15]+4264355552&4294967295,S=x+(k<<10&4294967295|k>>>22),k=L+(x^(S|~E))+j[6]+2734768916&4294967295,L=S+(k<<15&4294967295|k>>>17),k=E+(S^(L|~x))+j[13]+1309151649&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~S))+j[4]+4149444226&4294967295,x=E+(k<<6&4294967295|k>>>26),k=S+(E^(x|~L))+j[11]+3174756917&4294967295,S=x+(k<<10&4294967295|k>>>22),k=L+(x^(S|~E))+j[2]+718787259&4294967295,L=S+(k<<15&4294967295|k>>>17),k=E+(S^(L|~x))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+x&4294967295,C.g[1]=C.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+S&4294967295}n.prototype.v=function(C,x){x===void 0&&(x=C.length);const E=x-this.blockSize,j=this.C;let L=this.h,S=0;for(;S<x;){if(L==0)for(;S<=E;)r(this,C,S),S+=this.blockSize;if(typeof C=="string"){for(;S<x;)if(j[L++]=C.charCodeAt(S++),L==this.blockSize){r(this,j),L=0;break}}else for(;S<x;)if(j[L++]=C[S++],L==this.blockSize){r(this,j),L=0;break}}this.h=L,this.o+=x},n.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var x=1;x<C.length-8;++x)C[x]=0;x=this.o*8;for(var E=C.length-8;E<C.length;++E)C[E]=x&255,x/=256;for(this.v(C),C=Array(16),x=0,E=0;E<4;++E)for(let j=0;j<32;j+=8)C[x++]=this.g[E]>>>j&255;return C};function i(C,x){var E=l;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=x(C)}function o(C,x){this.h=x;const E=[];let j=!0;for(let L=C.length-1;L>=0;L--){const S=C[L]|0;j&&S==x||(E[L]=S,j=!1)}this.g=E}var l={};function u(C){return-128<=C&&C<128?i(C,function(x){return new o([x|0],x<0?-1:0)}):new o([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return f;if(C<0)return w(m(-C));const x=[];let E=1;for(let j=0;C>=E;j++)x[j]=C/E|0,E*=4294967296;return new o(x,0)}function d(C,x){if(C.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(C.charAt(0)=="-")return w(d(C.substring(1),x));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=m(Math.pow(x,8));let j=f;for(let S=0;S<C.length;S+=8){var L=Math.min(8,C.length-S);const k=parseInt(C.substring(S,S+L),x);L<8?(L=m(Math.pow(x,L)),j=j.j(L).add(m(k))):(j=j.j(E),j=j.add(m(k)))}return j}var f=u(0),h=u(1),b=u(16777216);s=o.prototype,s.m=function(){if(_(this))return-w(this).m();let C=0,x=1;for(let E=0;E<this.g.length;E++){const j=this.i(E);C+=(j>=0?j:4294967296+j)*x,x*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(V(this))return"0";if(_(this))return"-"+w(this).toString(C);const x=m(Math.pow(C,6));var E=this;let j="";for(;;){const L=oe(E,x).g;E=B(E,L.j(x));let S=((E.g.length>0?E.g[0]:E.h)>>>0).toString(C);if(E=L,V(E))return S+j;for(;S.length<6;)S="0"+S;j=S+j}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function V(C){if(C.h!=0)return!1;for(let x=0;x<C.g.length;x++)if(C.g[x]!=0)return!1;return!0}function _(C){return C.h==-1}s.l=function(C){return C=B(this,C),_(C)?-1:V(C)?0:1};function w(C){const x=C.g.length,E=[];for(let j=0;j<x;j++)E[j]=~C.g[j];return new o(E,~C.h).add(h)}s.abs=function(){return _(this)?w(this):this},s.add=function(C){const x=Math.max(this.g.length,C.g.length),E=[];let j=0;for(let L=0;L<=x;L++){let S=j+(this.i(L)&65535)+(C.i(L)&65535),k=(S>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);j=k>>>16,S&=65535,k&=65535,E[L]=k<<16|S}return new o(E,E[E.length-1]&-2147483648?-1:0)};function B(C,x){return C.add(w(x))}s.j=function(C){if(V(this)||V(C))return f;if(_(this))return _(C)?w(this).j(w(C)):w(w(this).j(C));if(_(C))return w(this.j(w(C)));if(this.l(b)<0&&C.l(b)<0)return m(this.m()*C.m());const x=this.g.length+C.g.length,E=[];for(var j=0;j<2*x;j++)E[j]=0;for(j=0;j<this.g.length;j++)for(let L=0;L<C.g.length;L++){const S=this.i(j)>>>16,k=this.i(j)&65535,_e=C.i(L)>>>16,Ue=C.i(L)&65535;E[2*j+2*L]+=k*Ue,I(E,2*j+2*L),E[2*j+2*L+1]+=S*Ue,I(E,2*j+2*L+1),E[2*j+2*L+1]+=k*_e,I(E,2*j+2*L+1),E[2*j+2*L+2]+=S*_e,I(E,2*j+2*L+2)}for(C=0;C<x;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=x;C<2*x;C++)E[C]=0;return new o(E,0)};function I(C,x){for(;(C[x]&65535)!=C[x];)C[x+1]+=C[x]>>>16,C[x]&=65535,x++}function F(C,x){this.g=C,this.h=x}function oe(C,x){if(V(x))throw Error("division by zero");if(V(C))return new F(f,f);if(_(C))return x=oe(w(C),x),new F(w(x.g),w(x.h));if(_(x))return x=oe(C,w(x)),new F(w(x.g),x.h);if(C.g.length>30){if(_(C)||_(x))throw Error("slowDivide_ only works with positive integers.");for(var E=h,j=x;j.l(C)<=0;)E=se(E),j=se(j);var L=M(E,1),S=M(j,1);for(j=M(j,2),E=M(E,2);!V(j);){var k=S.add(j);k.l(C)<=0&&(L=L.add(E),S=k),j=M(j,1),E=M(E,1)}return x=B(C,L.j(x)),new F(L,x)}for(L=f;C.l(x)>=0;){for(E=Math.max(1,Math.floor(C.m()/x.m())),j=Math.ceil(Math.log(E)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),S=m(E),k=S.j(x);_(k)||k.l(C)>0;)E-=j,S=m(E),k=S.j(x);V(S)&&(S=h),L=L.add(S),C=B(C,k)}return new F(L,C)}s.B=function(C){return oe(this,C).h},s.and=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)&C.i(j);return new o(E,this.h&C.h)},s.or=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)|C.i(j);return new o(E,this.h|C.h)},s.xor=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)^C.i(j);return new o(E,this.h^C.h)};function se(C){const x=C.g.length+1,E=[];for(let j=0;j<x;j++)E[j]=C.i(j)<<1|C.i(j-1)>>>31;return new o(E,C.h)}function M(C,x){const E=x>>5;x%=32;const j=C.g.length-E,L=[];for(let S=0;S<j;S++)L[S]=x>0?C.i(S+E)>>>x|C.i(S+E+1)<<32-x:C.i(S+E);return new o(L,C.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Yh=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Cr=o}).apply(typeof ef<"u"?ef:typeof self<"u"?self:typeof window<"u"?window:{});var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gh,jo,Xh,al,yu,Jh,Zh,eg;(function(){var s,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ra=="object"&&Ra];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=t(this);function r(c,p){if(p)e:{var g=n;c=c.split(".");for(var D=0;D<c.length-1;D++){var W=c[D];if(!(W in g))break e;g=g[W]}c=c[c.length-1],D=g[c],p=p(D),p!=D&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],D;for(D in p)Object.prototype.hasOwnProperty.call(p,D)&&g.push([D,p[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),c.apply(this,D)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(D,W,X){for(var ve=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)ve[dt-2]=arguments[dt];return p.prototype[W].apply(D,ve)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function b(c){const p=c.length;if(p>0){const g=Array(p);for(let D=0;D<p;D++)g[D]=c[D];return g}return[]}function V(c,p){for(let D=1;D<arguments.length;D++){const W=arguments[D];var g=typeof W;if(g=g!="object"?g:W?Array.isArray(W)?"array":g:"null",g=="array"||g=="object"&&typeof W.length=="number"){g=c.length||0;const X=W.length||0;c.length=g+X;for(let ve=0;ve<X;ve++)c[g+ve]=W[ve]}else c.push(W)}}class _{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(c){o.setTimeout(()=>{throw c},0)}function B(){var c=C;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class I{constructor(){this.h=this.g=null}add(p,g){const D=F.get();D.set(p,g),this.h?this.h.next=D:this.g=D,this.h=D}}var F=new _(()=>new oe,c=>c.reset());class oe{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let se,M=!1,C=new I,x=()=>{const c=Promise.resolve(void 0);se=()=>{c.then(E)}};function E(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){w(g)}var p=F;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function _e(c,p){L.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(_e,L),_e.prototype.init=function(c,p){const g=this.type=c.type,D=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ue="closure_listenable_"+(Math.random()*1e6|0),pe=0;function je(c,p,g,D,W){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!D,this.ha=W,this.key=++pe,this.da=this.fa=!1}function ft(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function qt(c,p,g){for(const D in c)p.call(g,c[D],D,c)}function Ht(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const He="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(c,p){let g,D;for(let W=1;W<arguments.length;W++){D=arguments[W];for(g in D)c[g]=D[g];for(let X=0;X<He.length;X++)g=He[X],Object.prototype.hasOwnProperty.call(D,g)&&(c[g]=D[g])}}function Le(c){this.src=c,this.g={},this.h=0}Le.prototype.add=function(c,p,g,D,W){const X=c.toString();c=this.g[X],c||(c=this.g[X]=[],this.h++);const ve=bt(c,p,D,W);return ve>-1?(p=c[ve],g||(p.fa=!1)):(p=new je(p,this.src,X,!!D,W),p.fa=g,c.push(p)),p};function ze(c,p){const g=p.type;if(g in c.g){var D=c.g[g],W=Array.prototype.indexOf.call(D,p,void 0),X;(X=W>=0)&&Array.prototype.splice.call(D,W,1),X&&(ft(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function bt(c,p,g,D){for(let W=0;W<c.length;++W){const X=c[W];if(!X.da&&X.listener==p&&X.capture==!!g&&X.ha==D)return W}return-1}var it="closure_lm_"+(Math.random()*1e6|0),St={};function st(c,p,g,D,W){if(Array.isArray(p)){for(let X=0;X<p.length;X++)st(c,p[X],g,D,W);return null}return g=$t(g),c&&c[Ue]?c.J(p,g,l(D)?!!D.capture:!1,W):ut(c,p,g,!1,D,W)}function ut(c,p,g,D,W,X){if(!p)throw Error("Invalid event type");const ve=l(W)?!!W.capture:!!W;let dt=Ye(c);if(dt||(c[it]=dt=new Le(c)),g=dt.add(p,g,D,ve,X),g.proxy)return g;if(D=ms(),g.proxy=D,D.src=c,D.listener=g,c.addEventListener)S||(W=ve),W===void 0&&(W=!1),c.addEventListener(p.toString(),D,W);else if(c.attachEvent)c.attachEvent(Re(p.toString()),D);else if(c.addListener&&c.removeListener)c.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ms(){function c(g){return p.call(c.src,c.listener,g)}const p=we;return c}function Q(c,p,g,D,W){if(Array.isArray(p))for(var X=0;X<p.length;X++)Q(c,p[X],g,D,W);else D=l(D)?!!D.capture:!!D,g=$t(g),c&&c[Ue]?(c=c.i,X=String(p).toString(),X in c.g&&(p=c.g[X],g=bt(p,g,D,W),g>-1&&(ft(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[X],c.h--)))):c&&(c=Ye(c))&&(p=c.g[p.toString()],c=-1,p&&(c=bt(p,g,D,W)),(g=c>-1?p[c]:null)&&Te(g))}function Te(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ue])ze(p.i,c);else{var g=c.type,D=c.proxy;p.removeEventListener?p.removeEventListener(g,D,c.capture):p.detachEvent?p.detachEvent(Re(g),D):p.addListener&&p.removeListener&&p.removeListener(D),(g=Ye(p))?(ze(g,c),g.h==0&&(g.src=null,p[it]=null)):ft(c)}}}function Re(c){return c in St?St[c]:St[c]="on"+c}function we(c,p){if(c.da)c=!0;else{p=new _e(p,this);const g=c.listener,D=c.ha||c.src;c.fa&&Te(c),c=g.call(D,p)}return c}function Ye(c){return c=c[it],c instanceof Le?c:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(c){return typeof c=="function"?c:(c[Tt]||(c[Tt]=function(p){return c.handleEvent(p)}),c[Tt])}function ct(){j.call(this),this.i=new Le(this),this.M=this,this.G=null}f(ct,j),ct.prototype[Ue]=!0,ct.prototype.removeEventListener=function(c,p,g,D){Q(this,c,p,g,D)};function P(c,p){var g,D=c.G;if(D)for(g=[];D;D=D.G)g.push(D);if(c=c.M,D=p.type||p,typeof p=="string")p=new L(p,c);else if(p instanceof L)p.target=p.target||c;else{var W=p;p=new L(D,c),de(p,W)}W=!0;let X,ve;if(g)for(ve=g.length-1;ve>=0;ve--)X=p.g=g[ve],W=O(X,D,!0,p)&&W;if(X=p.g=c,W=O(X,D,!0,p)&&W,W=O(X,D,!1,p)&&W,g)for(ve=0;ve<g.length;ve++)X=p.g=g[ve],W=O(X,D,!1,p)&&W}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let D=0;D<g.length;D++)ft(g[D]);delete c.g[p],c.h--}}this.G=null},ct.prototype.J=function(c,p,g,D){return this.i.add(String(c),p,!1,g,D)},ct.prototype.K=function(c,p,g,D){return this.i.add(String(c),p,!0,g,D)};function O(c,p,g,D){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let W=!0;for(let X=0;X<p.length;++X){const ve=p[X];if(ve&&!ve.da&&ve.capture==g){const dt=ve.listener,Cs=ve.ha||ve.src;ve.fa&&ze(c.i,ve),W=dt.call(Cs,D)!==!1&&W}}return W&&!D.defaultPrevented}function J(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function ye(c){c.g=J(()=>{c.g=null,c.i&&(c.i=!1,ye(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ue extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){j.call(this),this.h=c,this.g={}}f(fe,j);var Ce=[];function Me(c){qt(c.g,function(p,g){this.g.hasOwnProperty(g)&&Te(p)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),Me(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=o.JSON.stringify,Ae=o.JSON.parse,Rs=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function jt(){}function ee(){}var Ge={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function H(){L.call(this,"d")}f(H,L);function be(){L.call(this,"c")}f(be,L);var De={},Ie=null;function me(){return Ie=Ie||new ct}De.Ia="serverreachability";function Mt(c){L.call(this,De.Ia,c)}f(Mt,L);function mt(c){const p=me();P(p,new Mt(p))}De.STAT_EVENT="statevent";function Wt(c,p){L.call(this,De.STAT_EVENT,c),this.stat=p}f(Wt,L);function At(c){const p=me();P(p,new Wt(p,c))}De.Ja="timingevent";function ds(c,p){L.call(this,De.Ja,c),this.size=p}f(ds,L);function ss(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Ts(){this.g=!0}Ts.prototype.ua=function(){this.g=!1};function fn(c,p,g,D,W,X){c.info(function(){if(c.g)if(X){var ve="",dt=X.split("&");for(let Qt=0;Qt<dt.length;Qt++){var Cs=dt[Qt].split("=");if(Cs.length>1){const Ls=Cs[0];Cs=Cs[1];const Pn=Ls.split("_");ve=Pn.length>=2&&Pn[1]=="type"?ve+(Ls+"="+Cs+"&"):ve+(Ls+"=redacted&")}}}else ve=null;else ve=X;return"XMLHTTP REQ ("+D+") [attempt "+W+"]: "+p+`
`+g+`
`+ve})}function Ks(c,p,g,D,W,X,ve){c.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+W+"]: "+p+`
`+g+`
`+X+" "+ve})}function pn(c,p,g,D){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Sn(c,g)+(D?" "+D:"")})}function Kr(c,p){c.info(function(){return"TIMEOUT: "+p})}Ts.prototype.info=function(){};function Sn(c,p){if(!c.g)return p;if(!p)return null;try{const X=JSON.parse(p);if(X){for(c=0;c<X.length;c++)if(Array.isArray(X[c])){var g=X[c];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var W=D[0];if(W!="noop"&&W!="stop"&&W!="close")for(let ve=1;ve<D.length;ve++)D[ve]=""}}}}return et(X)}catch{return p}}var en={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Tn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},v;function q(){}f(q,jt),q.prototype.g=function(){return new XMLHttpRequest},v=new q;function y(c){return encodeURIComponent(String(c))}function R(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function T(c,p,g,D){this.j=c,this.i=p,this.l=g,this.S=D||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new $}function $(){this.i=null,this.g="",this.h=!1}var Z={},z={};function G(c,p,g){c.M=1,c.A=bi(Zt(p)),c.u=g,c.R=!0,te(c,null)}function te(c,p){c.F=Date.now(),Ne(c),c.B=Zt(c.A);var g=c.B,D=c.S;Array.isArray(D)||(D=[String(D)]),le(g.i,"t",D),c.C=0,g=c.j.L,c.h=new $,c.g=kd(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ue(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,D=c.ba;var W="readystatechange";Array.isArray(W)||(W&&(Ce[0]=W.toString()),W=Ce);for(let X=0;X<W.length;X++){const ve=st(g,W[X],D||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),mt(),fn(c.i,c.v,c.B,c.l,c.S,c.u)}T.prototype.ba=function(c){c=c.target;const p=this.O;p&&Nn(c)==3?p.j():this.Y(c)},T.prototype.Y=function(c){try{if(c==this.g)e:{const dt=Nn(this.g),Cs=this.g.ya(),Qt=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||fd(this.g)))){this.K||dt!=4||Cs==7||(Cs==8||Qt<=0?mt(3):mt(2)),Yt(this);var p=this.g.ca();this.X=p;var g=Oe(this);if(this.o=p==200,Ks(this.i,this.v,this.B,this.l,this.S,dt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var D,W=this.g;if((D=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(D)){var X=D;break t}}X=null}if(c=X)pn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gt(this,c);else{this.o=!1,this.m=3,At(12),fs(this),Dt(this);break e}}if(this.R){c=!0;let Ls;for(;!this.K&&this.C<g.length;)if(Ls=Fe(this,g),Ls==z){dt==4&&(this.m=4,At(14),c=!1),pn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ls==Z){this.m=4,At(15),pn(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else pn(this.i,this.l,Ls,null),Gt(this,Ls);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||g.length!=0||this.h.h||(this.m=1,At(16),c=!1),this.o=this.o&&c,!c)pn(this.i,this.l,g,"[Invalid Chunked Response]"),fs(this),Dt(this);else if(g.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Cc(ve),ve.P=!0,At(11))}}else pn(this.i,this.l,g,null),Gt(this,g);dt==4&&fs(this),this.o&&!this.K&&(dt==4?xd(this.j,this):(this.o=!1,Ne(this)))}else cN(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),fs(this),Dt(this)}}}catch{}finally{}};function Oe(c){if(!Ke(c))return c.g.la();const p=fd(c.g);if(p==="")return"";let g="";const D=p.length,W=Nn(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return fs(c),Dt(c),"";c.h.i=new o.TextDecoder}for(let X=0;X<D;X++)c.h.h=!0,g+=c.h.i.decode(p[X],{stream:!(W&&X==D-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Ke(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Fe(c,p){var g=c.C,D=p.indexOf(`
`,g);return D==-1?z:(g=Number(p.substring(g,D)),isNaN(g)?Z:(D+=1,D+g>p.length?z:(p=p.slice(D,D+g),c.C=D+g,p)))}T.prototype.cancel=function(){this.K=!0,fs(this)};function Ne(c){c.T=Date.now()+c.H,Ze(c,c.H)}function Ze(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ss(m(c.aa,c),p)}function Yt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}T.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Kr(this.i,this.B),this.M!=2&&(mt(),At(17)),fs(this),this.m=2,Dt(this)):Ze(this,this.T-c)};function Dt(c){c.j.I==0||c.K||xd(c.j,c)}function fs(c){Yt(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Me(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Gt(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||ke(g.h,c))){if(!c.L&&ke(g.h,c)&&g.I==3){try{var D=g.Ba.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var W=D;if(W[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Sa(g),Va(g);else break e;Ec(g),At(18)}}else g.xa=W[1],0<g.xa-g.K&&W[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ss(m(g.Va,g),6e3));We(g.h)<=1&&g.ta&&(g.ta=void 0)}else Qr(g,11)}else if((c.L||g.g==c)&&Sa(g),!k(p))for(W=g.Ba.g.parse(p),p=0;p<W.length;p++){let Qt=W[p];const Ls=Qt[0];if(!(Ls<=g.K))if(g.K=Ls,Qt=Qt[1],g.I==2)if(Qt[0]=="c"){g.M=Qt[1],g.ba=Qt[2];const Pn=Qt[3];Pn!=null&&(g.ka=Pn,g.j.info("VER="+g.ka));const Yr=Qt[4];Yr!=null&&(g.za=Yr,g.j.info("SVER="+g.za));const mr=Qt[5];mr!=null&&typeof mr=="number"&&mr>0&&(D=1.5*mr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const dr=c.g;if(dr){const La=dr.g?dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(La){var X=D.h;X.g||La.indexOf("spdy")==-1&&La.indexOf("quic")==-1&&La.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Qe(X,X.h),X.h=null))}if(D.G){const Vc=dr.g?dr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vc&&(D.wa=Vc,yt(D.J,D.G,Vc))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var ve=c;if(D.na=Dd(D,D.L?D.ba:null,D.W),ve.L){Je(D.h,ve);var dt=ve,Cs=D.O;Cs&&(dt.H=Cs),dt.D&&(Yt(dt),Ne(dt)),D.g=ve}else bd(D);g.i.length>0&&wa(g)}else Qt[0]!="stop"&&Qt[0]!="close"||Qr(g,7);else g.I==3&&(Qt[0]=="stop"||Qt[0]=="close"?Qt[0]=="stop"?Qr(g,7):Ac(g):Qt[0]!="noop"&&g.l&&g.l.qa(Qt),g.A=0)}}mt(4)}catch{}}var Qs=class{constructor(c,p){this.g=c,this.map=p}};function Ys(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ot(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function We(c){return c.h?1:c.g?c.g.size:0}function ke(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Qe(c,p){c.g?c.g.add(p):c.h=p}function Je(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Ys.prototype.cancel=function(){if(this.i=Nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Nt(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return b(c.i)}var Be=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nt(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const D=c[g].indexOf("=");let W,X=null;D>=0?(W=c[g].substring(0,D),X=c[g].substring(D+1)):W=c[g],p(W,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function gt(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof gt?(this.l=c.l,is(this,c.j),this.o=c.o,this.g=c.g,Ln(this,c.u),this.h=c.h,yi(this,ge(c.i)),this.m=c.m):c&&(p=String(c).match(Be))?(this.l=!1,is(this,p[1]||"",!0),this.o=lr(p[2]||""),this.g=lr(p[3]||"",!0),Ln(this,p[4]),this.h=lr(p[5]||"",!0),yi(this,p[6]||"",!0),this.m=lr(p[7]||"")):(this.l=!1,this.i=new ur(null,this.l))}gt.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(cr(p,po,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(cr(p,po,!0),"@"),c.push(y(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(cr(g,g.charAt(0)=="/"?vc:Ca,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",cr(g,Dc)),c.join("")},gt.prototype.resolve=function(c){const p=Zt(this);let g=!!c.j;g?is(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var D=c.h;if(g)Ln(p,c.u);else if(g=!!c.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var W=p.h.lastIndexOf("/");W!=-1&&(D=p.h.slice(0,W+1)+D)}if(W=D,W==".."||W==".")D="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){D=W.lastIndexOf("/",0)==0,W=W.split("/");const X=[];for(let ve=0;ve<W.length;){const dt=W[ve++];dt=="."?D&&ve==W.length&&X.push(""):dt==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),D&&ve==W.length&&X.push("")):(X.push(dt),D=!0)}D=X.join("/")}else D=W}return g?p.h=D:g=c.i.toString()!=="",g?yi(p,ge(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Zt(c){return new gt(c)}function is(c,p,g){c.j=g?lr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Ln(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function yi(c,p,g){p instanceof ur?(c.i=p,at(c.i,c.l)):(g||(p=cr(p,_c)),c.i=new ur(p,c.l))}function yt(c,p,g){c.i.set(p,g)}function bi(c){return yt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function lr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function cr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Ea),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ea(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var po=/[#\/\?@]/g,Ca=/[#\?:]/g,vc=/[#\?]/g,_c=/[#\?@]/g,Dc=/#/g;function ur(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function N(c){c.g||(c.g=new Map,c.h=0,c.i&&nt(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}s=ur.prototype,s.add=function(c,p){N(this),this.i=null,c=he(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function U(c,p){N(c),p=he(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y(c,p){return N(c),p=he(c,p),c.g.has(p)}s.forEach=function(c,p){N(this),this.g.forEach(function(g,D){g.forEach(function(W){c.call(p,W,D,this)},this)},this)};function K(c,p){N(c);let g=[];if(typeof p=="string")Y(c,p)&&(g=g.concat(c.g.get(he(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}s.set=function(c,p){return N(this),this.i=null,c=he(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},s.get=function(c,p){return c?(c=K(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){U(c,p),g.length>0&&(c.i=null,c.g.set(he(c,p),b(g)),c.h+=g.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let D=0;D<p.length;D++){var g=p[D];const W=y(g);g=K(this,g);for(let X=0;X<g.length;X++){let ve=W;g[X]!==""&&(ve+="="+y(g[X])),c.push(ve)}}return this.i=c.join("&")};function ge(c){const p=new ur;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function he(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function at(c,p){p&&!c.j&&(N(c),c.i=null,c.g.forEach(function(g,D){const W=D.toLowerCase();D!=W&&(U(this,D),le(this,W,g))},c)),c.j=p}function pt(c,p){const g=new Ts;if(o.Image){const D=new Image;D.onload=d(Lt,g,"TestLoadImage: loaded",!0,p,D),D.onerror=d(Lt,g,"TestLoadImage: error",!1,p,D),D.onabort=d(Lt,g,"TestLoadImage: abort",!1,p,D),D.ontimeout=d(Lt,g,"TestLoadImage: timeout",!1,p,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=c}else p(!1)}function gs(c,p){const g=new Ts,D=new AbortController,W=setTimeout(()=>{D.abort(),Lt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:D.signal}).then(X=>{clearTimeout(W),X.ok?Lt(g,"TestPingServer: ok",!0,p):Lt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(W),Lt(g,"TestPingServer: error",!1,p)})}function Lt(c,p,g,D,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),D(g)}catch{}}function It(){this.g=new Rs}function ns(c){this.i=c.Sb||null,this.h=c.ab||!1}f(ns,jt),ns.prototype.g=function(){return new Es(this.i,this.h)};function Es(c,p){ct.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Es,ct),s=Es.prototype,s.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ps(this)},s.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,es(this)),this.readyState=0},s.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Et(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Et(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}s.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?es(this):ps(this),this.readyState==3&&Et(this)}},s.Oa=function(c){this.g&&(this.response=this.responseText=c,es(this))},s.Na=function(c){this.g&&(this.response=c,es(this))},s.ga=function(){this.g&&es(this)};function es(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ps(c)}s.setRequestHeader=function(c,p){this.A.append(c,p)},s.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function ps(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function zt(c){let p="";return qt(c,function(g,D){p+=D,p+=":",p+=g,p+=`\r
`}),p}function Kt(c,p,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=zt(g),typeof c=="string"?g!=null&&y(g):yt(c,p,g))}function ht(c){ct.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ht,ct);var Jt=/^https?$/i,bn=["POST","PUT"];s=ht.prototype,s.Fa=function(c){this.H=c},s.ea=function(c,p,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():v.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(X){In(this,X);return}if(c=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var W in D)g.set(W,D[W]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const X of D.keys())g.set(X,D.get(X));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(X=>X.toLowerCase()=="content-type"),W=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(bn,p,void 0)>=0)||D||W||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ve]of g)this.g.setRequestHeader(X,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(X){In(this,X)}};function In(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Ni(c),xi(c)}function Ni(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}s.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),xi(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xi(this,!0)),ht.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kc(this):this.Xa())},s.Xa=function(){kc(this)};function kc(c){if(c.h&&typeof i<"u"){if(c.v&&Nn(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),Nn(c)==4){c.h=!1;try{const X=c.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var D;if(D=X===0){let ve=String(c.D).match(Be)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),D=!Jt.test(ve?ve.toLowerCase():"")}g=D}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var W=Nn(c)>2?c.g.statusText:""}catch{W=""}c.l=W+" ["+c.ca()+"]",Ni(c)}}finally{xi(c)}}}}function xi(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||P(c,"ready");try{g.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Nn(c){return c.g?c.g.readyState:0}s.ca=function(){try{return Nn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ae(p)}};function fd(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function cN(c){const p={};c=(c.g&&Nn(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<c.length;D++){if(k(c[D]))continue;var g=R(c[D]);const W=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const X=p[W]||[];p[W]=X,X.push(g)}Ht(p,function(D){return D.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ho(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function pd(c){this.za=0,this.i=[],this.j=new Ts,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ho("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ho("baseRetryDelayMs",5e3,c),this.Za=ho("retryDelaySeedMs",1e4,c),this.Ta=ho("forwardChannelMaxRetries",2,c),this.va=ho("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Ys(c&&c.concurrentRequestLimit),this.Ba=new It,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=pd.prototype,s.ka=8,s.I=1,s.connect=function(c,p,g,D){At(0),this.W=c,this.H=p||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=Dd(this,null,this.W),wa(this)};function Ac(c){if(hd(c),c.I==3){var p=c.V++,g=Zt(c.J);if(yt(g,"SID",c.M),yt(g,"RID",p),yt(g,"TYPE","terminate"),go(c,g),p=new T(c,c.j,p),p.M=2,p.A=bi(Zt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=kd(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Ne(p)}_d(c)}function Va(c){c.g&&(Cc(c),c.g.cancel(),c.g=null)}function hd(c){Va(c),c.v&&(o.clearTimeout(c.v),c.v=null),Sa(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function wa(c){if(!Ot(c.h)&&!c.m){c.m=!0;var p=c.Ea;se||x(),M||(se(),M=!0),C.add(p,c),c.D=0}}function uN(c,p){return We(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ss(m(c.Ea,c,p),vd(c,c.D)),c.D++,!0)}s.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const W=new T(this,this.j,c);let X=this.o;if(this.U&&(X?(X=ae(X),de(X,this.U)):X=this.U),this.u!==null||this.R||(W.J=X,X=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=yd(this,W,p),g=Zt(this.J),yt(g,"RID",c),yt(g,"CVER",22),this.G&&yt(g,"X-HTTP-Session-Id",this.G),go(this,g),X&&(this.R?p="headers="+y(zt(X))+"&"+p:this.u&&Kt(g,this.u,X)),Qe(this.h,W),this.Ra&&yt(g,"TYPE","init"),this.S?(yt(g,"$req",p),yt(g,"SID","null"),W.U=!0,G(W,g,null)):G(W,g,p),this.I=2}}else this.I==3&&(c?gd(this,c):this.i.length==0||Ot(this.h)||gd(this))};function gd(c,p){var g;p?g=p.l:g=c.V++;const D=Zt(c.J);yt(D,"SID",c.M),yt(D,"RID",g),yt(D,"AID",c.K),go(c,D),c.u&&c.o&&Kt(D,c.u,c.o),g=new T(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=yd(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Qe(c.h,g),G(g,D,p)}function go(c,p){c.H&&qt(c.H,function(g,D){yt(p,D,g)}),c.l&&qt({},function(g,D){yt(p,D,g)})}function yd(c,p,g){g=Math.min(c.i.length,g);const D=c.l?m(c.l.Ka,c.l,c):null;e:{var W=c.i;let dt=-1;for(;;){const Cs=["count="+g];dt==-1?g>0?(dt=W[0].g,Cs.push("ofs="+dt)):dt=0:Cs.push("ofs="+dt);let Qt=!0;for(let Ls=0;Ls<g;Ls++){var X=W[Ls].g;const Pn=W[Ls].map;if(X-=dt,X<0)dt=Math.max(0,W[Ls].g-100),Qt=!1;else try{X="req"+X+"_"||"";try{var ve=Pn instanceof Map?Pn:Object.entries(Pn);for(const[Yr,mr]of ve){let dr=mr;l(mr)&&(dr=et(mr)),Cs.push(X+Yr+"="+encodeURIComponent(dr))}}catch(Yr){throw Cs.push(X+"type="+encodeURIComponent("_badmap")),Yr}}catch{D&&D(Pn)}}if(Qt){ve=Cs.join("&");break e}}ve=void 0}return c=c.i.splice(0,g),p.G=c,ve}function bd(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;se||x(),M||(se(),M=!0),C.add(p,c),c.A=0}}function Ec(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ss(m(c.Da,c),vd(c,c.A)),c.A++,!0)}s.Da=function(){if(this.v=null,Nd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ss(m(this.Wa,this),c)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),Va(this),Nd(this))};function Cc(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Nd(c){c.g=new T(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Zt(c.na);yt(p,"RID","rpc"),yt(p,"SID",c.M),yt(p,"AID",c.K),yt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&yt(p,"TO",c.ia),yt(p,"TYPE","xmlhttp"),go(c,p),c.u&&c.o&&Kt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=bi(Zt(p)),g.u=null,g.R=!0,te(g,c)}s.Va=function(){this.C!=null&&(this.C=null,Va(this),Ec(this),At(19))};function Sa(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function xd(c,p){var g=null;if(c.g==p){Sa(c),Cc(c),c.g=null;var D=2}else if(ke(c.h,p))g=p.G,Je(c.h,p),D=1;else return;if(c.I!=0){if(p.o)if(D==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var W=c.D;D=me(),P(D,new ds(D,g)),wa(c)}else bd(c);else if(W=p.m,W==3||W==0&&p.X>0||!(D==1&&uN(c,p)||D==2&&Ec(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),W){case 1:Qr(c,5);break;case 4:Qr(c,10);break;case 3:Qr(c,6);break;default:Qr(c,2)}}}function vd(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Qr(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),D=c.Ua;const W=!D;D=new gt(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||is(D,"https"),bi(D),W?pt(D.toString(),g):gs(D.toString(),g)}else At(2);c.I=0,c.l&&c.l.pa(p),_d(c),hd(c)}s.bb=function(c){c?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function _d(c){if(c.I=0,c.ja=[],c.l){const p=Nt(c.h);(p.length!=0||c.i.length!=0)&&(V(c.ja,p),V(c.ja,c.i),c.h.i.length=0,b(c.i),c.i.length=0),c.l.oa()}}function Dd(c,p,g){var D=g instanceof gt?Zt(g):new gt(g);if(D.g!="")p&&(D.g=p+"."+D.g),Ln(D,D.u);else{var W=o.location;D=W.protocol,p=p?p+"."+W.hostname:W.hostname,W=+W.port;const X=new gt(null);D&&is(X,D),p&&(X.g=p),W&&Ln(X,W),g&&(X.h=g),D=X}return g=c.G,p=c.wa,g&&p&&yt(D,g,p),yt(D,"VER",c.ka),go(c,D),D}function kd(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ht(new ns({ab:g})):new ht(c.ma),p.Fa(c.L),p}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ad(){}s=Ad.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ta(){}Ta.prototype.g=function(c,p){return new an(c,p)};function an(c,p){ct.call(this),this.g=new pd(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new vi(this)}f(an,ct),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Ac(this.g)},an.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=et(c),c=g);p.i.push(new Qs(p.Ya++,c)),p.I==3&&wa(p)},an.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,an.Z.N.call(this)};function Ed(c){H.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Ed,H);function Cd(){be.call(this),this.status=1}f(Cd,be);function vi(c){this.g=c}f(vi,Ad),vi.prototype.ra=function(){P(this.g,"a")},vi.prototype.qa=function(c){P(this.g,new Ed(c))},vi.prototype.pa=function(c){P(this.g,new Cd)},vi.prototype.oa=function(){P(this.g,"b")},Ta.prototype.createWebChannel=Ta.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,eg=function(){return new Ta},Zh=function(){return me()},Jh=De,yu={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,al=en,Tn.COMPLETE="complete",Xh=Tn,ee.EventType=Ge,Ge.OPEN="a",Ge.CLOSE="b",Ge.ERROR="c",Ge.MESSAGE="d",ct.prototype.listen=ct.prototype.J,jo=ee,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,Gh=ht}).apply(typeof Ra<"u"?Ra:typeof self<"u"?self:typeof window<"u"?window:{});const tf="@firebase/firestore",sf="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi=new Hh("@firebase/firestore");function Bi(){return oi.logLevel}function Ve(s,...e){if(oi.logLevel<=Vt.DEBUG){const t=e.map(lm);oi.debug(`Firestore (${no}): ${s}`,...t)}}function rr(s,...e){if(oi.logLevel<=Vt.ERROR){const t=e.map(lm);oi.error(`Firestore (${no}): ${s}`,...t)}}function Qi(s,...e){if(oi.logLevel<=Vt.WARN){const t=e.map(lm);oi.warn(`Firestore (${no}): ${s}`,...t)}}function lm(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,tg(s,n,t)}function tg(s,e,t){let n=`FIRESTORE (${no}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw rr(n),new Error(n)}function Ut(s,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,s||tg(e,r,n)}function rt(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends ui{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class f_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($s.UNAUTHENTICATED))}shutdown(){}}class p_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class h_{constructor(e){this.t=e,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ut(this.o===void 0,42304);let n=this.i;const r=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ut(typeof n.accessToken=="string",31837,{l:n}),new sg(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string",2055,{h:e}),new $s(e)}}class g_{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class y_{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new g_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t($s.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b_{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ut(this.o===void 0,3512);const n=i=>{i.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ve("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const r=i=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nf(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ut(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=N_(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function vt(s,e){return s<e?-1:s>e?1:0}function bu(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const r=s.charAt(n),i=e.charAt(n);if(r!==i)return Hc(r)===Hc(i)?vt(r,i):Hc(r)?1:-1}return vt(s.length,e.length)}const x_=55296,v_=57343;function Hc(s){const e=s.charCodeAt(0);return e>=x_&&e<=v_}function Yi(s,e,t){return s.length===e.length&&s.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf="__name__";class Rn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Xe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Xe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Rn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Rn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const i=Rn.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return vt(e.length,t.length)}static compareSegments(e,t){const n=Rn.isNumericId(e),r=Rn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Rn.extractNumericId(e).compare(Rn.extractNumericId(t)):bu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Cr.fromString(e.substring(4,e.length-2))}}class Xt extends Rn{construct(e,t,n){return new Xt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Xt(t)}static emptyPath(){return new Xt([])}}const __=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends Rn{construct(e,t,n){return new Hs(e,t,n)}static isValidIdentifier(e){return __.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rf}static keyField(){return new Hs([rf])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ee(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ee(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(n+=l,r++):(i(),r++)}if(i(),o)throw new Ee(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(t)}static emptyPath(){return new Hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Xt.fromString(e))}static fromName(e){return new $e(Xt.fromString(e).popFirst(5))}static empty(){return new $e(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(s,e,t){if(!t)throw new Ee(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function D_(s,e,t,n){if(e===!0&&n===!0)throw new Ee(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function of(s){if(!$e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function af(s){if($e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function rg(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Wl(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Xe(12329,{type:typeof s})}function Js(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ee(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Wl(s);throw new Ee(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function pa(s,e){if(!rg(s))throw new Ee(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const o=s[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new Ee(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=-62135596800,cf=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*cf);return new xe(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lf)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cf}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pa(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:ks("string",xe._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{static fromTimestamp(e){return new tt(e)}static min(){return new tt(new xe(0,0))}static max(){return new tt(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=-1;function k_(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,r=tt.fromTimestamp(n===1e9?new xe(t+1,0):new xe(t,n));return new wr(r,$e.empty(),e)}function A_(s){return new wr(s.readTime,s.key,ta)}class wr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new wr(tt.min(),$e.empty(),ta)}static max(){return new wr(tt.max(),$e.empty(),ta)}}function E_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=$e.comparator(s.documentKey,e.documentKey),t!==0?t:vt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ro(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==C_)throw s;Ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>n(u))}),o=!0,i===r&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(r=>r?ce.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,i)=>{n.push(t.call(this,r,i))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&n(o)},d=>r(d))}})}static doWhile(e,t){return new ce((n,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):n()};i()})}}function w_(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function io(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=-1;function Kl(s){return s==null}function vl(s){return s===0&&1/s==-1/0}function S_(s){return typeof s=="number"&&Number.isInteger(s)&&!vl(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="";function T_(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=uf(e)),e=L_(s.get(t),e);return uf(e)}function L_(s,e){let t=e;const n=s.length;for(let r=0;r<n;r++){const i=s.charAt(r);switch(i){case"\0":t+="";break;case ig:t+="";break;default:t+=i}}return t}function uf(s){return s+ig+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Br(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function og(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new rs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ba(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ba(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ba(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ba(this.root,e,this.comparator,!0)}}class Ba{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??Bs.RED,this.left=r??Bs.EMPTY,this.right=i??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Bs(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Bs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xe(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw Xe(57766)}get value(){throw Xe(16141)}get color(){throw Xe(16727)}get left(){throw Xe(29726)}get right(){throw Xe(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new df(this.data.getIterator())}getIteratorFrom(e){return new df(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ss(this.comparator);return t.data=e,t}}class df{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new un([])}unionWith(e){let t=new Ss(Hs.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yi(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new ag("Invalid base64 string: "+i):i}}(e);return new Os(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Os(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Os.EMPTY_BYTE_STRING=new Os("");const I_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sr(s){if(Ut(!!s,39018),typeof s=="string"){let e=0;const t=I_.exec(s);if(Ut(!!t,46558,{timestamp:s}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Tr(s){return typeof s=="string"?Os.fromBase64String(s):Os.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="server_timestamp",cg="__type__",ug="__previous_value__",mg="__local_write_time__";function mm(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[cg])==null?void 0:n.stringValue)===lg}function Ql(s){const e=s.mapValue.fields[ug];return mm(e)?Ql(e):e}function sa(s){const e=Sr(s.mapValue.fields[mg].timestampValue);return new xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,t,n,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const _l="(default)";class na{constructor(e,t){this.projectId=e,this.database=t||_l}static empty(){return new na("","")}get isDefaultDatabase(){return this.database===_l}isEqual(e){return e instanceof na&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="__type__",j_="__max__",Ua={mapValue:{}},fg="__vector__",Dl="value";function Lr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?mm(s)?4:B_(s)?9007199254740991:R_(s)?10:11:Xe(28295,{value:s})}function zn(s,e){if(s===e)return!0;const t=Lr(s);if(t!==Lr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return sa(s).isEqual(sa(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Sr(r.timestampValue),l=Sr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(r,i){return Tr(r.bytesValue).isEqual(Tr(i.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(r,i){return hs(r.geoPointValue.latitude)===hs(i.geoPointValue.latitude)&&hs(r.geoPointValue.longitude)===hs(i.geoPointValue.longitude)}(s,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return hs(r.integerValue)===hs(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=hs(r.doubleValue),l=hs(i.doubleValue);return o===l?vl(o)===vl(l):isNaN(o)&&isNaN(l)}return!1}(s,e);case 9:return Yi(s.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(mf(o)!==mf(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!zn(o[u],l[u])))return!1;return!0}(s,e);default:return Xe(52216,{left:s})}}function ra(s,e){return(s.values||[]).find(t=>zn(t,e))!==void 0}function Gi(s,e){if(s===e)return 0;const t=Lr(s),n=Lr(e);if(t!==n)return vt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(s.booleanValue,e.booleanValue);case 2:return function(i,o){const l=hs(i.integerValue||i.doubleValue),u=hs(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(s,e);case 3:return ff(s.timestampValue,e.timestampValue);case 4:return ff(sa(s),sa(e));case 5:return bu(s.stringValue,e.stringValue);case 6:return function(i,o){const l=Tr(i),u=Tr(o);return l.compareTo(u)}(s.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=vt(l[m],u[m]);if(d!==0)return d}return vt(l.length,u.length)}(s.referenceValue,e.referenceValue);case 8:return function(i,o){const l=vt(hs(i.latitude),hs(o.latitude));return l!==0?l:vt(hs(i.longitude),hs(o.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return pf(s.arrayValue,e.arrayValue);case 10:return function(i,o){var h,b,V,_;const l=i.fields||{},u=o.fields||{},m=(h=l[Dl])==null?void 0:h.arrayValue,d=(b=u[Dl])==null?void 0:b.arrayValue,f=vt(((V=m==null?void 0:m.values)==null?void 0:V.length)||0,((_=d==null?void 0:d.values)==null?void 0:_.length)||0);return f!==0?f:pf(m,d)}(s.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ua.mapValue&&o===Ua.mapValue)return 0;if(i===Ua.mapValue)return 1;if(o===Ua.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=bu(u[f],d[f]);if(h!==0)return h;const b=Gi(l[u[f]],m[d[f]]);if(b!==0)return b}return vt(u.length,d.length)}(s.mapValue,e.mapValue);default:throw Xe(23264,{he:t})}}function ff(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return vt(s,e);const t=Sr(s),n=Sr(e),r=vt(t.seconds,n.seconds);return r!==0?r:vt(t.nanos,n.nanos)}function pf(s,e){const t=s.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const i=Gi(t[r],n[r]);if(i)return i}return vt(t.length,n.length)}function Xi(s){return Nu(s)}function Nu(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const n=Sr(t);return`time(${n.seconds},${n.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Tr(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return $e.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=Nu(i);return n+"]"}(s.arrayValue):"mapValue"in s?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of n)i?i=!1:r+=",",r+=`${o}:${Nu(t.fields[o])}`;return r+"}"}(s.mapValue):Xe(61005,{value:s})}function ll(s){switch(Lr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ql(s);return e?16+ll(e):16;case 5:return 2*s.stringValue.length;case 6:return Tr(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+ll(i),0)}(s.arrayValue);case 10:case 11:return function(n){let r=0;return Br(n.fields,(i,o)=>{r+=i.length+ll(o)}),r}(s.mapValue);default:throw Xe(13486,{value:s})}}function hf(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function xu(s){return!!s&&"integerValue"in s}function dm(s){return!!s&&"arrayValue"in s}function gf(s){return!!s&&"nullValue"in s}function yf(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function cl(s){return!!s&&"mapValue"in s}function R_(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[dg])==null?void 0:n.stringValue)===fg}function Fo(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Br(s.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Fo(n)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fo(s.arrayValue.values[t]);return e}return{...s}}function B_(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===j_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!cl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fo(t)}setAll(e){let t=Hs.emptyPath(),n={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,n,r),n={},r=[],t=l.popLast()}o?n[l.lastSegment()]=Fo(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());cl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];cl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Br(t,(r,i)=>e[r]=i);for(const r of n)delete e[r]}clone(){return new on(Fo(this.value))}}function pg(s){const e=[];return Br(s.fields,(t,n)=>{const r=new Hs([t]);if(cl(n)){const i=pg(n.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t,n,r,i,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Ws(e,0,tt.min(),tt.min(),tt.min(),on.empty(),0)}static newFoundDocument(e,t,n,r){return new Ws(e,1,t,tt.min(),n,r,0)}static newNoDocument(e,t){return new Ws(e,2,t,tt.min(),tt.min(),on.empty(),0)}static newUnknownDocument(e,t){return new Ws(e,3,t,tt.min(),tt.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ws&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ws(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,t){this.position=e,this.inclusive=t}}function bf(s,e,t){let n=0;for(let r=0;r<s.position.length;r++){const i=e[r],o=s.position[r];if(i.field.isKeyField()?n=$e.comparator($e.fromName(o.referenceValue),t.key):n=Gi(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Nf(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!zn(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t="asc"){this.field=e,this.dir=t}}function U_(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{}class _s extends hg{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new M_(e,t,n):t==="array-contains"?new q_(e,n):t==="in"?new $_(e,n):t==="not-in"?new W_(e,n):t==="array-contains-any"?new z_(e,n):new _s(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new O_(e,n):new F_(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Gi(t,this.value)):t!==null&&Lr(this.value)===Lr(t)&&this.matchesComparison(Gi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cn extends hg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Cn(e,t)}matches(e){return gg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gg(s){return s.op==="and"}function yg(s){return H_(s)&&gg(s)}function H_(s){for(const e of s.filters)if(e instanceof Cn)return!1;return!0}function vu(s){if(s instanceof _s)return s.field.canonicalString()+s.op.toString()+Xi(s.value);if(yg(s))return s.filters.map(e=>vu(e)).join(",");{const e=s.filters.map(t=>vu(t)).join(",");return`${s.op}(${e})`}}function bg(s,e){return s instanceof _s?function(n,r){return r instanceof _s&&n.op===r.op&&n.field.isEqual(r.field)&&zn(n.value,r.value)}(s,e):s instanceof Cn?function(n,r){return r instanceof Cn&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,o,l)=>i&&bg(o,r.filters[l]),!0):!1}(s,e):void Xe(19439)}function Ng(s){return s instanceof _s?function(t){return`${t.field.canonicalString()} ${t.op} ${Xi(t.value)}`}(s):s instanceof Cn?function(t){return t.op.toString()+" {"+t.getFilters().map(Ng).join(" ,")+"}"}(s):"Filter"}class M_ extends _s{constructor(e,t,n){super(e,t,n),this.key=$e.fromName(n.referenceValue)}matches(e){const t=$e.comparator(e.key,this.key);return this.matchesComparison(t)}}class O_ extends _s{constructor(e,t){super(e,"in",t),this.keys=xg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class F_ extends _s{constructor(e,t){super(e,"not-in",t),this.keys=xg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xg(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(n=>$e.fromName(n.referenceValue))}class q_ extends _s{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dm(t)&&ra(t.arrayValue,this.value)}}class $_ extends _s{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ra(this.value.arrayValue,t)}}class W_ extends _s{constructor(e,t){super(e,"not-in",t)}matches(e){if(ra(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ra(this.value.arrayValue,t)}}class z_ extends _s{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ra(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t=null,n=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function xf(s,e=null,t=[],n=[],r=null,i=null,o=null){return new K_(s,e,t,n,r,i,o)}function fm(s){const e=rt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Kl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Xi(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Xi(n)).join(",")),e.Te=t}return e.Te}function pm(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!U_(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!bg(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Nf(s.startAt,e.startAt)&&Nf(s.endAt,e.endAt)}function _u(s){return $e.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t=null,n=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Q_(s,e,t,n,r,i,o,l){return new oo(s,e,t,n,r,i,o,l)}function Yl(s){return new oo(s)}function vf(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function vg(s){return s.collectionGroup!==null}function qo(s){const e=rt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ss(Hs.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ia(i,n))}),t.has(Hs.keyField().canonicalString())||e.Ie.push(new ia(Hs.keyField(),n))}return e.Ie}function Mn(s){const e=rt(s);return e.Ee||(e.Ee=Y_(e,qo(s))),e.Ee}function Y_(s,e){if(s.limitType==="F")return xf(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new ia(r.field,i)});const t=s.endAt?new kl(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new kl(s.startAt.position,s.startAt.inclusive):null;return xf(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Du(s,e){const t=s.filters.concat([e]);return new oo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ku(s,e,t){return new oo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Gl(s,e){return pm(Mn(s),Mn(e))&&s.limitType===e.limitType}function _g(s){return`${fm(Mn(s))}|lt:${s.limitType}`}function Ui(s){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>Ng(r)).join(", ")}]`),Kl(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Xi(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Xi(r)).join(",")),`Target(${n})`}(Mn(s))}; limitType=${s.limitType})`}function Xl(s,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):$e.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(s,e)&&function(n,r){for(const i of qo(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(s,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(s,e)&&function(n,r){return!(n.startAt&&!function(o,l,u){const m=bf(o,l,u);return o.inclusive?m<=0:m<0}(n.startAt,qo(n),r)||n.endAt&&!function(o,l,u){const m=bf(o,l,u);return o.inclusive?m>=0:m>0}(n.endAt,qo(n),r))}(s,e)}function G_(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Dg(s){return(e,t)=>{let n=!1;for(const r of qo(s)){const i=X_(r,e,t);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function X_(s,e,t){const n=s.field.isKeyField()?$e.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Gi(u,m):Xe(42886)}(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Xe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Br(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return og(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_=new rs($e.comparator);function ir(){return J_}const kg=new rs($e.comparator);function Ro(...s){let e=kg;for(const t of s)e=e.insert(t.key,t);return e}function Ag(s){let e=kg;return s.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Zr(){return $o()}function Eg(){return $o()}function $o(){return new mi(s=>s.toString(),(s,e)=>s.isEqual(e))}const Z_=new rs($e.comparator),eD=new Ss($e.comparator);function _t(...s){let e=eD;for(const t of s)e=e.add(t);return e}const tD=new Ss(vt);function sD(){return tD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vl(e)?"-0":e}}function Cg(s){return{integerValue:""+s}}function nD(s,e){return S_(e)?Cg(e):hm(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(){this._=void 0}}function rD(s,e,t){return s instanceof oa?function(r,i){const o={fields:{[cg]:{stringValue:lg},[mg]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&mm(i)&&(i=Ql(i)),i&&(o.fields[ug]=i),{mapValue:o}}(t,e):s instanceof aa?wg(s,e):s instanceof la?Sg(s,e):function(r,i){const o=Vg(r,i),l=_f(o)+_f(r.Ae);return xu(o)&&xu(r.Ae)?Cg(l):hm(r.serializer,l)}(s,e)}function iD(s,e,t){return s instanceof aa?wg(s,e):s instanceof la?Sg(s,e):t}function Vg(s,e){return s instanceof Al?function(n){return xu(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class oa extends Jl{}class aa extends Jl{constructor(e){super(),this.elements=e}}function wg(s,e){const t=Tg(e);for(const n of s.elements)t.some(r=>zn(r,n))||t.push(n);return{arrayValue:{values:t}}}class la extends Jl{constructor(e){super(),this.elements=e}}function Sg(s,e){let t=Tg(e);for(const n of s.elements)t=t.filter(r=>!zn(r,n));return{arrayValue:{values:t}}}class Al extends Jl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function _f(s){return hs(s.integerValue||s.doubleValue)}function Tg(s){return dm(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,t){this.field=e,this.transform=t}}function aD(s,e){return s.field.isEqual(e.field)&&function(n,r){return n instanceof aa&&r instanceof aa||n instanceof la&&r instanceof la?Yi(n.elements,r.elements,zn):n instanceof Al&&r instanceof Al?zn(n.Ae,r.Ae):n instanceof oa&&r instanceof oa}(s.transform,e.transform)}class lD{constructor(e,t){this.version=e,this.transformResults=t}}class Zs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zs}static exists(e){return new Zs(void 0,e)}static updateTime(e){return new Zs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ul(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Zl{}function Lg(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new ec(s.key,Zs.none()):new ha(s.key,s.data,Zs.none());{const t=s.data,n=on.empty();let r=new Ss(Hs.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),r=r.add(i)}return new Ur(s.key,n,new un(r.toArray()),Zs.none())}}function cD(s,e,t){s instanceof ha?function(r,i,o){const l=r.value.clone(),u=kf(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(s,e,t):s instanceof Ur?function(r,i,o){if(!ul(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=kf(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Ig(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(s,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wo(s,e,t,n){return s instanceof ha?function(i,o,l,u){if(!ul(i.precondition,o))return l;const m=i.value.clone(),d=Af(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(s,e,t,n):s instanceof Ur?function(i,o,l,u){if(!ul(i.precondition,o))return l;const m=Af(i.fieldTransforms,u,o),d=o.data;return d.setAll(Ig(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(s,e,t,n):function(i,o,l){return ul(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(s,e,t)}function uD(s,e){let t=null;for(const n of s.fieldTransforms){const r=e.data.field(n.field),i=Vg(n.transform,r||null);i!=null&&(t===null&&(t=on.empty()),t.set(n.field,i))}return t||null}function Df(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Yi(n,r,(i,o)=>aD(i,o))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class ha extends Zl{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ur extends Zl{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ig(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}}),e}function kf(s,e,t){const n=new Map;Ut(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let r=0;r<t.length;r++){const i=s[r],o=i.transform,l=e.data.field(i.field);n.set(i.field,iD(o,l,t[r]))}return n}function Af(s,e,t){const n=new Map;for(const r of s){const i=r.transform,o=t.data.field(r.field);n.set(r.field,rD(i,o,e))}return n}class ec extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mD extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&cD(i,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Wo(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Wo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Eg();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=Lg(o,l);u!==null&&n.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(tt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),_t())}isEqual(e){return this.batchId===e.batchId&&Yi(this.mutations,e.mutations,(t,n)=>Df(t,n))&&Yi(this.baseMutations,e.baseMutations,(t,n)=>Df(t,n))}}class gm{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ut(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return Z_}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new gm(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs,Ct;function hD(s){switch(s){case ie.OK:return Xe(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Xe(15467,{code:s})}}function Pg(s){if(s===void 0)return rr("GRPC error has no .code"),ie.UNKNOWN;switch(s){case bs.OK:return ie.OK;case bs.CANCELLED:return ie.CANCELLED;case bs.UNKNOWN:return ie.UNKNOWN;case bs.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case bs.INTERNAL:return ie.INTERNAL;case bs.UNAVAILABLE:return ie.UNAVAILABLE;case bs.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case bs.NOT_FOUND:return ie.NOT_FOUND;case bs.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case bs.ABORTED:return ie.ABORTED;case bs.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case bs.DATA_LOSS:return ie.DATA_LOSS;default:return Xe(39323,{code:s})}}(Ct=bs||(bs={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=new Cr([4294967295,4294967295],0);function Ef(s){const e=gD().encode(s),t=new Yh;return t.update(e),new Uint8Array(t.digest())}function Cf(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Cr([t,n],0),new Cr([r,i],0)]}class ym{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Bo(`Invalid padding: ${t}`);if(n<0)throw new Bo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Bo(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Bo(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Cr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Cr.fromNumber(n)));return r.compare(yD)===1&&(r=new Cr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ef(e),[n,r]=Cf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ym(i,r,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Ef(e),[n,r]=Cf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Bo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ga.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new tc(tt.min(),r,new rs(vt),ir(),_t())}}class ga{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ga(n,t,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class jg{constructor(e,t){this.targetId=e,this.Ce=t}}class Rg{constructor(e,t,n=Os.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Vf{constructor(){this.ve=0,this.Fe=wf(),this.Me=Os.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),n=_t();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Xe(38017,{changeType:i})}}),new ga(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=wf()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ut(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bD{constructor(e){this.Ge=e,this.ze=new Map,this.je=ir(),this.Je=Ha(),this.He=Ha(),this.Ye=new rs(vt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(_u(i))if(n===0){const o=new $e(i.path);this.et(t,o,Ws.newNoDocument(o,tt.min()))}else Ut(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=Tr(n).toUint8Array()}catch(u){if(u instanceof ag)return Qi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ym(o,r,i)}catch(u){return Qi(u instanceof Bo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&_u(l.target)){const u=new $e(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Ws.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=_t();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new tc(e,t,this.Ye,this.je,n);return this.je=ir(),this.Je=Ha(),this.He=Ha(),this.Ye=new rs(vt),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Vf,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ss(vt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ss(vt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vf),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ha(){return new rs($e.comparator)}function wf(){return new rs($e.comparator)}const ND={asc:"ASCENDING",desc:"DESCENDING"},xD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vD={and:"AND",or:"OR"};class _D{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Au(s,e){return s.useProto3Json||Kl(e)?e:{value:e}}function El(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bg(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function DD(s,e){return El(s,e.toTimestamp())}function On(s){return Ut(!!s,49232),tt.fromTimestamp(function(t){const n=Sr(t);return new xe(n.seconds,n.nanos)}(s))}function bm(s,e){return Eu(s,e).canonicalString()}function Eu(s,e){const t=function(r){return new Xt(["projects",r.projectId,"databases",r.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Ug(s){const e=Xt.fromString(s);return Ut(qg(e),10190,{key:e.toString()}),e}function Cu(s,e){return bm(s.databaseId,e.path)}function Mc(s,e){const t=Ug(e);if(t.get(1)!==s.databaseId.projectId)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new $e(Mg(t))}function Hg(s,e){return bm(s.databaseId,e)}function kD(s){const e=Ug(s);return e.length===4?Xt.emptyPath():Mg(e)}function Vu(s){return new Xt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Mg(s){return Ut(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Sf(s,e,t){return{name:Cu(s,e),fields:t.value.mapValue.fields}}function AD(s,e){let t;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Xe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Ut(d===void 0||typeof d=="string",58123),Os.fromBase64String(d||"")):(Ut(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Os.fromUint8Array(d||new Uint8Array))}(s,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?ie.UNKNOWN:Pg(m.code);return new Ee(d,m.message||"")}(o);t=new Rg(n,r,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Mc(s,n.document.name),i=On(n.document.updateTime),o=n.document.createTime?On(n.document.createTime):tt.min(),l=new on({mapValue:{fields:n.document.fields}}),u=Ws.newFoundDocument(r,i,o,l),m=n.targetIds||[],d=n.removedTargetIds||[];t=new ml(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Mc(s,n.document),i=n.readTime?On(n.readTime):tt.min(),o=Ws.newNoDocument(r,i),l=n.removedTargetIds||[];t=new ml([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Mc(s,n.document),i=n.removedTargetIds||[];t=new ml([],i,r,null)}else{if(!("filter"in e))return Xe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,o=new pD(r,i),l=n.targetId;t=new jg(l,o)}}return t}function ED(s,e){let t;if(e instanceof ha)t={update:Sf(s,e.key,e.value)};else if(e instanceof ec)t={delete:Cu(s,e.key)};else if(e instanceof Ur)t={update:Sf(s,e.key,e.data),updateMask:jD(e.fieldMask)};else{if(!(e instanceof mD))return Xe(16599,{Vt:e.type});t={verify:Cu(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof oa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof aa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof la)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Al)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Xe(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:DD(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Xe(27497)}(s,e.precondition)),t}function CD(s,e){return s&&s.length>0?(Ut(e!==void 0,14353),s.map(t=>function(r,i){let o=r.updateTime?On(r.updateTime):On(i);return o.isEqual(tt.min())&&(o=On(i)),new lD(o,r.transformResults||[])}(t,e))):[]}function VD(s,e){return{documents:[Hg(s,e.path)]}}function wD(s,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Hg(s,r);const i=function(m){if(m.length!==0)return Fg(Cn.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Hi(h.field),direction:LD(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Au(s,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function SD(s){let e=kD(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Ut(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=Og(f);return h instanceof Cn&&yg(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(V){return new ia(Mi(V.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Kl(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,b=f.values||[];return new kl(b,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,b=f.values||[];return new kl(b,h)}(t.endAt)),Q_(e,r,o,i,l,"F",u,m)}function TD(s,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xe(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Og(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Mi(t.unaryFilter.field);return _s.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Mi(t.unaryFilter.field);return _s.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Mi(t.unaryFilter.field);return _s.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mi(t.unaryFilter.field);return _s.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xe(61313);default:return Xe(60726)}}(s):s.fieldFilter!==void 0?function(t){return _s.create(Mi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xe(58110);default:return Xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Cn.create(t.compositeFilter.filters.map(n=>Og(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Xe(1026)}}(t.compositeFilter.op))}(s):Xe(30097,{filter:s})}function LD(s){return ND[s]}function ID(s){return xD[s]}function PD(s){return vD[s]}function Hi(s){return{fieldPath:s.canonicalString()}}function Mi(s){return Hs.fromServerFormat(s.fieldPath)}function Fg(s){return s instanceof _s?function(t){if(t.op==="=="){if(yf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NAN"}};if(gf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NAN"}};if(gf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hi(t.field),op:ID(t.op),value:t.value}}}(s):s instanceof Cn?function(t){const n=t.getFilters().map(r=>Fg(r));return n.length===1?n[0]:{compositeFilter:{op:PD(t.op),filters:n}}}(s):Xe(54877,{filter:s})}function jD(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qg(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t,n,r,i=tt.min(),o=tt.min(),l=Os.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.yt=e}}function BD(s){const e=SD({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ku(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this.Cn=new HD}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(wr.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(wr.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class HD{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ss(Xt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ss(Xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$g=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn($g,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ji(0)}static cr(){return new Ji(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="LruGarbageCollector",MD=1048576;function If([s,e],[t,n]){const r=vt(s,t);return r===0?vt(e,n):r}class OD{constructor(e){this.Ir=e,this.buffer=new Ss(If),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();If(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(Lf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){io(t)?Ve(Lf,"Ignoring IndexedDB error during garbage collection: ",t):await ro(t)}await this.Vr(3e5)})}}class qD{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(zl.ce);const n=new OD(t);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Tf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(m=Date.now(),Bi()<=Vt.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function $D(s,e){return new qD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.changes=new mi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ws.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Wo(n.mutation,r,un.empty(),xe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,_t()).next(()=>n))}getLocalViewOfDocuments(e,t,n=_t()){const r=Zr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(i=>{let o=Ro();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Zr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,_t()))}populateOverlays(e,t,n){const r=[];return n.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,r){let i=ir();const o=$o(),l=function(){return $o()}();return t.forEach((u,m)=>{const d=n.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof Ur)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Wo(d.mutation,m,d.mutation.getFieldMask(),xe.now())):o.set(m.key,un.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new zD(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const n=$o();let r=new rs((o,l)=>o-l),i=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=n.get(u)||un.empty();d=l.applyToLocalView(m,d),n.set(u,d);const f=(r.get(l.batchId)||_t()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Eg();d.forEach(h=>{if(!i.has(h)){const b=Lg(t.get(h),n.get(h));b!==null&&f.set(h,b),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return $e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ce.resolve(Zr());let l=ta,u=i;return o.next(m=>ce.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,_t())).next(d=>({batchId:l,changes:Ag(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $e(t)).next(n=>{let r=Ro();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=Ro();return this.indexManager.getCollectionParents(e,i).next(l=>ce.forEach(l,u=>{const m=function(f,h){return new oo(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,n,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,Ws.newInvalidDocument(d)))});let l=Ro();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Wo(d.mutation,m,un.empty(),xe.now()),Xl(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:On(r.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:BD(r.bundledQuery),readTime:On(r.readTime)}}(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(){this.overlays=new rs($e.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Zr();return ce.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&n.set(r,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,i)=>{this.St(e,t,i)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const r=Zr(),i=t.length+1,o=new $e(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new rs((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let d=i.get(m.largestBatchId);d===null&&(d=Zr(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Zr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return ce.resolve(l)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new fD(t,n));let i=this.qr.get(t);i===void 0&&(i=_t(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(){this.sessionToken=Os.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.Qr=new Ss(Ps.$r),this.Ur=new Ss(Ps.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ps(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Ps(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new $e(new Xt([])),n=new Ps(t,e),r=new Ps(t,e+1),i=[];return this.Ur.forEachInRange([n,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new $e(new Xt([])),n=new Ps(t,e),r=new Ps(t,e+1);let i=_t();return this.Ur.forEachInRange([n,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Ps(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Ps{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return $e.comparator(e.key,t.key)||vt(e.Yr,t.Yr)}static Kr(e,t){return vt(e.Yr,t.Yr)||$e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ss(Ps.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dD(i,t,n,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Ps(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?um:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ps(t,0),r=new Ps(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ss(vt);return t.forEach(r=>{const i=new Ps(r,0),o=new Ps(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{n=n.add(l.Yr)})}),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;$e.isDocumentKey(i)||(i=i.child(""));const o=new Ps(new $e(i),0);let l=new Ss(vt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!n.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),ce.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(n=>{const r=this.Xr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ut(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,r=>{const i=new Ps(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Ps(t,0),r=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.ri=e,this.docs=function(){return new rs($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():Ws.newInvalidDocument(t))}getEntries(e,t){let n=ir();return t.forEach(r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():Ws.newInvalidDocument(r))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ir();const o=t.path,l=new $e(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||E_(A_(d),n)<=0||(r.has(d.key)||Xl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Xe(9500)}ii(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new ZD(this)}getSize(e){return ce.resolve(this.size)}}class ZD extends WD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.persistence=e,this.si=new mi(t=>fm(t),pm),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.oi=0,this._i=new Nm,this.targetCount=0,this.ai=Ji.ur()}forEachTarget(e,t){return this.si.forEach((n,r)=>t(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ji(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.ui={},this.overlays={},this.ci=new zl(0),this.li=!1,this.li=!0,this.hi=new GD,this.referenceDelegate=e(this),this.Pi=new ek(this),this.indexManager=new UD,this.remoteDocumentCache=function(r){return new JD(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new RD(t),this.Ii=new QD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new XD(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve("MemoryPersistence","Starting transaction:",e);const r=new tk(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class tk extends V_{constructor(e){super(),this.currentSequenceNumber=e}}class xm{constructor(e){this.persistence=e,this.Ri=new Nm,this.Vi=null}static mi(e){return new xm(e)}get fi(){if(this.Vi)return this.Vi;throw Xe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,n=>{const r=$e.fromPath(n);return this.gi(e,r).next(i=>{i||t.removeEntry(r,tt.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Cl{constructor(e,t){this.persistence=e,this.pi=new mi(n=>T_(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=$D(this,t)}static mi(e,t){return new Cl(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(i=>i?ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(n++,i.removeEntry(o,tt.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ll(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=_t(),r=_t();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new vm(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Xx()?8:w_(Yx())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new sk;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Bi()<=Vt.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",Ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Bi()<=Vt.DEBUG&&Ve("QueryEngine","Query:",Ui(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Bi()<=Vt.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",Ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mn(t))):ce.resolve())}ys(e,t){if(vf(t))return ce.resolve(null);let n=Mn(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ku(t,null,"F"),n=Mn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=_t(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ku(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,n,r){return vf(t)||r.isEqual(tt.min())?ce.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?ce.resolve(null):(Bi()<=Vt.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ui(t)),this.vs(e,o,t,k_(r,ta)).next(l=>l))})}Ds(e,t){let n=new Ss(Dg(e));return t.forEach((r,i)=>{Xl(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Bi()<=Vt.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",Ui(t)),this.ps.getDocumentsMatchingQuery(e,t,wr.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="LocalStore",rk=3e8;class ik{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new rs(vt),this.xs=new mi(i=>fm(i),pm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function ok(s,e,t,n){return new ik(s,e,t,n)}async function zg(s,e){const t=rt(s);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let u=_t();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function ak(s,e){const t=rt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let b=ce.resolve();return h.forEach(V=>{b=b.next(()=>d.getEntry(u,V)).next(_=>{const w=m.docVersions.get(V);Ut(w!==null,48541),_.version.compareTo(w)<0&&(f.applyToRemoteDocument(_,m),_.isValidDocument()&&(_.setReadTime(m.commitVersion),d.addEntry(_)))})}),b.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=_t();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Kg(s){const e=rt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function lk(s,e){const t=rt(s),n=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let b=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?b=b.withResumeToken(Os.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):d.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(d.resumeToken,n)),r=r.insert(f,b),function(_,w,B){return _.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=rk?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(h,b,d)&&l.push(t.Pi.updateTargetData(i,b))});let u=ir(),m=_t();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(ck(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!n.isEqual(tt.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return ce.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function ck(s,e,t){let n=_t(),r=_t();return t.forEach(i=>n=n.add(i)),e.getEntries(s,n).next(i=>{let o=ir();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(tt.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Ve(_m,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function uk(s,e){const t=rt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=um),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function mk(s,e){const t=rt(s);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Pi.getTargetData(n,e).next(i=>i?(r=i,ce.resolve(r)):t.Pi.allocateTargetId(n).next(o=>(r=new _r(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function wu(s,e,t){const n=rt(s),r=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!io(o))throw o;Ve(_m,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function Pf(s,e,t){const n=rt(s);let r=tt.min(),i=_t();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=rt(u),h=f.xs.get(d);return h!==void 0?ce.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(n,o,Mn(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?r:tt.min(),t?i:_t())).next(l=>(dk(n,G_(e),l),{documents:l,Qs:i})))}function dk(s,e,t){let n=s.Os.get(e)||tt.min();t.forEach((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),s.Os.set(e,n)}class jf{constructor(){this.activeTargetIds=sD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fk{constructor(){this.Mo=new jf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf="ConnectivityMonitor";class Bf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Rf,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Rf,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ma=null;function Su(){return Ma===null?Ma=function(){return 268435456+Math.round(2147483648*Math.random())}():Ma++,"0x"+Ma.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc="RestConnection",hk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===_l?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const o=Su(),l=this.zo(e,t.toUriEncodedString());Ve(Oc,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=fa(m);return this.Jo(e,l,u,n,d).then(f=>(Ve(Oc,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Qi(Oc,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",n),f})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+no}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),n&&n.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const n=hk[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="WebChannelConnection";class bk extends gk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=Su();return new Promise((l,u)=>{const m=new Gh;m.setWithCredentials(!0),m.listenOnce(Xh.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case al.NO_ERROR:const f=m.getResponseJson();Ve(Fs,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case al.TIMEOUT:Ve(Fs,`RPC '${e}' ${o} timed out`),u(new Ee(ie.DEADLINE_EXCEEDED,"Request time out"));break;case al.HTTP_ERROR:const h=m.getStatus();if(Ve(Fs,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let b=m.getResponseJson();Array.isArray(b)&&(b=b[0]);const V=b==null?void 0:b.error;if(V&&V.status&&V.message){const _=function(B){const I=B.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(I)>=0?I:ie.UNKNOWN}(V.status);u(new Ee(_,V.message))}else u(new Ee(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new Ee(ie.UNAVAILABLE,"Connection failed."));break;default:Xe(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ve(Fs,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);Ve(Fs,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,n,15)})}T_(e,t,n){const r=Su(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eg(),l=Zh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=i.join("");Ve(Fs,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,b=!1;const V=new yk({Yo:w=>{b?Ve(Fs,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(Ve(Fs,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),Ve(Fs,`RPC '${e}' stream ${r} sending:`,w),f.send(w))},Zo:()=>f.close()}),_=(w,B,I)=>{w.listen(B,F=>{try{I(F)}catch(oe){setTimeout(()=>{throw oe},0)}})};return _(f,jo.EventType.OPEN,()=>{b||(Ve(Fs,`RPC '${e}' stream ${r} transport opened.`),V.o_())}),_(f,jo.EventType.CLOSE,()=>{b||(b=!0,Ve(Fs,`RPC '${e}' stream ${r} transport closed`),V.a_(),this.E_(f))}),_(f,jo.EventType.ERROR,w=>{b||(b=!0,Qi(Fs,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),V.a_(new Ee(ie.UNAVAILABLE,"The operation could not be completed")))}),_(f,jo.EventType.MESSAGE,w=>{var B;if(!b){const I=w.data[0];Ut(!!I,16349);const F=I,oe=(F==null?void 0:F.error)||((B=F[0])==null?void 0:B.error);if(oe){Ve(Fs,`RPC '${e}' stream ${r} received error:`,oe);const se=oe.status;let M=function(E){const j=bs[E];if(j!==void 0)return Pg(j)}(se),C=oe.message;M===void 0&&(M=ie.INTERNAL,C="Unknown error status: "+se+" with message "+oe.message),b=!0,V.a_(new Ee(M,C)),f.close()}else Ve(Fs,`RPC '${e}' stream ${r} received:`,I),V.u_(I)}}),_(l,Jh.STAT_EVENT,w=>{w.stat===yu.PROXY?Ve(Fs,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===yu.NOPROXY&&Ve(Fs,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{V.__()},0),V}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Fc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(s){return new _D(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="PersistentStream";class Yg{constructor(e,t,n,r,i,o,l,u){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Qg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(rr(t.toString()),rr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===t&&this.G_(n,r)},n=>{e(()=>{const r=new Ee(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ve(Uf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Ve(Uf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Nk extends Yg{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AD(this.serializer,e),n=function(i){if(!("targetChange"in i))return tt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?tt.min():o.readTime?On(o.readTime):tt.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Vu(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=_u(u)?{documents:VD(i,u)}:{query:wD(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Bg(i,o.resumeToken);const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(tt.min())>0){l.readTime=El(i,o.snapshotVersion.toTimestamp());const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const n=TD(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Vu(this.serializer),t.removeTarget=e,this.q_(t)}}class xk extends Yg{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ut(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ut(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CD(e.writeResults,e.commitTime),n=On(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Vu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>ED(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{}class _k extends vk{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Eu(t,n),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(ie.UNKNOWN,i.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,Eu(t,n),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(ie.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Dk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(rr(t),this.aa=!1):Ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="RemoteStore";class kk{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{di(this)&&(Ve(ai,"Restarting streams for network reachability change."),await async function(u){const m=rt(u);m.Ea.add(4),await ya(m),m.Ra.set("Unknown"),m.Ea.delete(4),await nc(m)}(this))})}),this.Ra=new Dk(n,r)}}async function nc(s){if(di(s))for(const e of s.da)await e(!0)}async function ya(s){for(const e of s.da)await e(!1)}function Gg(s,e){const t=rt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Em(t)?Am(t):ao(t).O_()&&km(t,e))}function Dm(s,e){const t=rt(s),n=ao(t);t.Ia.delete(e),n.O_()&&Xg(t,e),t.Ia.size===0&&(n.O_()?n.L_():di(t)&&t.Ra.set("Unknown"))}function km(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ao(s).Y_(e)}function Xg(s,e){s.Va.Ue(e),ao(s).Z_(e)}function Am(s){s.Va=new bD({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ao(s).start(),s.Ra.ua()}function Em(s){return di(s)&&!ao(s).x_()&&s.Ia.size>0}function di(s){return rt(s).Ea.size===0}function Jg(s){s.Va=void 0}async function Ak(s){s.Ra.set("Online")}async function Ek(s){s.Ia.forEach((e,t)=>{km(s,e)})}async function Ck(s,e){Jg(s),Em(s)?(s.Ra.ha(e),Am(s)):s.Ra.set("Unknown")}async function Vk(s,e,t){if(s.Ra.set("Online"),e instanceof Rg&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(s,e)}catch(n){Ve(ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Vl(s,n)}else if(e instanceof ml?s.Va.Ze(e):e instanceof jg?s.Va.st(e):s.Va.tt(e),!t.isEqual(tt.min()))try{const n=await Kg(s.localStore);t.compareTo(n)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Os.EMPTY_BYTE_STRING,d.snapshotVersion)),Xg(i,u);const f=new _r(d.target,u,m,d.sequenceNumber);km(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(s,t)}catch(n){Ve(ai,"Failed to raise snapshot:",n),await Vl(s,n)}}async function Vl(s,e,t){if(!io(e))throw e;s.Ea.add(1),await ya(s),s.Ra.set("Offline"),t||(t=()=>Kg(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{Ve(ai,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await nc(s)})}function Zg(s,e){return e().catch(t=>Vl(s,t,e))}async function rc(s){const e=rt(s),t=Ir(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:um;for(;wk(e);)try{const r=await uk(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,Sk(e,r)}catch(r){await Vl(e,r)}ey(e)&&ty(e)}function wk(s){return di(s)&&s.Ta.length<10}function Sk(s,e){s.Ta.push(e);const t=Ir(s);t.O_()&&t.X_&&t.ea(e.mutations)}function ey(s){return di(s)&&!Ir(s).x_()&&s.Ta.length>0}function ty(s){Ir(s).start()}async function Tk(s){Ir(s).ra()}async function Lk(s){const e=Ir(s);for(const t of s.Ta)e.ea(t.mutations)}async function Ik(s,e,t){const n=s.Ta.shift(),r=gm.from(n,e,t);await Zg(s,()=>s.remoteSyncer.applySuccessfulWrite(r)),await rc(s)}async function Pk(s,e){e&&Ir(s).X_&&await async function(n,r){if(function(o){return hD(o)&&o!==ie.ABORTED}(r.code)){const i=n.Ta.shift();Ir(n).B_(),await Zg(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await rc(n)}}(s,e),ey(s)&&ty(s)}async function Hf(s,e){const t=rt(s);t.asyncQueue.verifyOperationInProgress(),Ve(ai,"RemoteStore received new credentials");const n=di(t);t.Ea.add(3),await ya(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nc(t)}async function jk(s,e){const t=rt(s);e?(t.Ea.delete(2),await nc(t)):e||(t.Ea.add(2),await ya(t),t.Ra.set("Unknown"))}function ao(s){return s.ma||(s.ma=function(t,n,r){const i=rt(t);return i.sa(),new Nk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:Ak.bind(null,s),t_:Ek.bind(null,s),r_:Ck.bind(null,s),H_:Vk.bind(null,s)}),s.da.push(async e=>{e?(s.ma.B_(),Em(s)?Am(s):s.Ra.set("Unknown")):(await s.ma.stop(),Jg(s))})),s.ma}function Ir(s){return s.fa||(s.fa=function(t,n,r){const i=rt(t);return i.sa(),new xk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:Tk.bind(null,s),r_:Pk.bind(null,s),ta:Lk.bind(null,s),na:Ik.bind(null,s)}),s.da.push(async e=>{e?(s.fa.B_(),await rc(s)):(await s.fa.stop(),s.Ta.length>0&&(Ve(ai,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))})),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,l=new Cm(e,t,o,r,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vm(s,e){if(rr("AsyncQueue",`${e}: ${s}`),io(s))return new Ee(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{static emptySet(e){return new zi(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||$e.comparator(t.key,n.key):(t,n)=>$e.comparator(t.key,n.key),this.keyedMap=Ro(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new zi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(){this.ga=new rs($e.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Zi{constructor(e,t,n,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Zi(e,t,zi.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Bk{constructor(){this.queries=Of(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=rt(t),i=r.queries;r.queries=Of(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new Ee(ie.ABORTED,"Firestore shutting down"))}}function Of(){return new mi(s=>_g(s),Gl)}async function wm(s,e){const t=rt(s);let n=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(n=2):(i=new Rk,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Vm(o,`Initialization of query '${Ui(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Tm(t)}async function Sm(s,e){const t=rt(s),n=e.query;let r=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function Uk(s,e){const t=rt(s);let n=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(n=!0);o.wa=r}}n&&Tm(t)}function Hk(s,e,t){const n=rt(s),r=n.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);n.queries.delete(e)}function Tm(s){s.Ca.forEach(e=>{e.next()})}var Tu,Ff;(Ff=Tu||(Tu={})).Ma="default",Ff.Cache="cache";class Lm{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Zi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Zi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e){this.key=e}}class ny{constructor(e){this.key=e}}class Mk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=Dg(e),this.tu=new zi(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Mf,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),b=Xl(this.query,f)?f:null,V=!!h&&this.mutatedKeys.has(h.key),_=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let w=!1;h&&b?h.data.isEqual(b.data)?V!==_&&(n.track({type:3,doc:b}),w=!0):this.su(h,b)||(n.track({type:2,doc:b}),w=!0,(u&&this.eu(b,u)>0||m&&this.eu(b,m)<0)&&(l=!0)):!h&&b?(n.track({type:0,doc:b}),w=!0):h&&!b&&(n.track({type:1,doc:h}),w=!0,(u||m)&&(l=!0)),w&&(b?(o=o.add(b),i=_?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(b,V){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xe(20277,{Rt:w})}};return _(b)-_(V)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(n),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new Zi(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Mf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new ny(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new sy(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Zi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Im="SyncEngine";class Ok{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Fk{constructor(e){this.key=e,this.hu=!1}}class qk{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new mi(l=>_g(l),Gl),this.Iu=new Map,this.Eu=new Set,this.du=new rs($e.comparator),this.Au=new Map,this.Ru=new Nm,this.Vu={},this.mu=new Map,this.fu=Ji.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $k(s,e,t=!0){const n=cy(s);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await ry(n,e,t,!0),r}async function Wk(s,e){const t=cy(s);await ry(t,e,!0,!1)}async function ry(s,e,t,n){const r=await mk(s.localStore,Mn(e)),i=r.targetId,o=s.sharedClientState.addLocalQueryTarget(i,t);let l;return n&&(l=await zk(s,e,i,o==="current",r.resumeToken)),s.isPrimaryClient&&t&&Gg(s.remoteStore,r),l}async function zk(s,e,t,n,r){s.pu=(f,h,b)=>async function(_,w,B,I){let F=w.view.ru(B);F.Cs&&(F=await Pf(_.localStore,w.query,!1).then(({documents:C})=>w.view.ru(C,F)));const oe=I&&I.targetChanges.get(w.targetId),se=I&&I.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(F,_.isPrimaryClient,oe,se);return $f(_,w.targetId,M.au),M.snapshot}(s,f,h,b);const i=await Pf(s.localStore,e,!0),o=new Mk(e,i.Qs),l=o.ru(i.documents),u=ga.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",r),m=o.applyChanges(l,s.isPrimaryClient,u);$f(s,t,m.au);const d=new Ok(e,t,o);return s.Tu.set(e,d),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function Kk(s,e,t){const n=rt(s),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter(o=>!Gl(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await wu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Dm(n.remoteStore,r.targetId),Lu(n,r.targetId)}).catch(ro)):(Lu(n,r.targetId),await wu(n.localStore,r.targetId,!0))}async function Qk(s,e){const t=rt(s),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Dm(t.remoteStore,n.targetId))}async function Yk(s,e,t){const n=sA(s);try{const r=await function(o,l){const u=rt(o),m=xe.now(),d=l.reduce((b,V)=>b.add(V.key),_t());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",b=>{let V=ir(),_=_t();return u.Ns.getEntries(b,d).next(w=>{V=w,V.forEach((B,I)=>{I.isValidDocument()||(_=_.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(b,V)).next(w=>{f=w;const B=[];for(const I of l){const F=uD(I,f.get(I.key).overlayedDocument);F!=null&&B.push(new Ur(I.key,F,pg(F.value.mapValue),Zs.exists(!0)))}return u.mutationQueue.addMutationBatch(b,m,B,l)}).next(w=>{h=w;const B=w.applyToLocalDocumentSet(f,_);return u.documentOverlayCache.saveOverlays(b,w.batchId,B)})}).then(()=>({batchId:h.batchId,changes:Ag(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new rs(vt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(n,r.batchId,t),await ba(n,r.changes),await rc(n.remoteStore)}catch(r){const i=Vm(r,"Failed to persist write");t.reject(i)}}async function iy(s,e){const t=rt(s);try{const n=await lk(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Ut(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ut(o.hu,14607):r.removedDocuments.size>0&&(Ut(o.hu,42227),o.hu=!1))}),await ba(t,n,e)}catch(n){await ro(n)}}function qf(s,e,t){const n=rt(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=rt(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Tm(u)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Gk(s,e,t){const n=rt(s);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),i=r&&r.key;if(i){let o=new rs($e.comparator);o=o.insert(i,Ws.newNoDocument(i,tt.min()));const l=_t().add(i),u=new tc(tt.min(),new Map,new rs(vt),o,l);await iy(n,u),n.du=n.du.remove(i),n.Au.delete(e),Pm(n)}else await wu(n.localStore,e,!1).then(()=>Lu(n,e,t)).catch(ro)}async function Xk(s,e){const t=rt(s),n=e.batch.batchId;try{const r=await ak(t.localStore,e);ay(t,n,null),oy(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await ba(t,r)}catch(r){await ro(r)}}async function Jk(s,e,t){const n=rt(s);try{const r=await function(o,l){const u=rt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Ut(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(n.localStore,e);ay(n,e,t),oy(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await ba(n,r)}catch(r){await ro(r)}}function oy(s,e){(s.mu.get(e)||[]).forEach(t=>{t.resolve()}),s.mu.delete(e)}function ay(s,e,t){const n=rt(s);let r=n.Vu[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function Lu(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach(n=>{s.Ru.containsKey(n)||ly(s,n)})}function ly(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Dm(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),Pm(s))}function $f(s,e,t){for(const n of t)n instanceof sy?(s.Ru.addReference(n.key,e),Zk(s,n)):n instanceof ny?(Ve(Im,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||ly(s,n.key)):Xe(19791,{wu:n})}function Zk(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(Ve(Im,"New document in limbo: "+t),s.Eu.add(n),Pm(s))}function Pm(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new $e(Xt.fromString(e)),n=s.fu.next();s.Au.set(n,new Fk(t)),s.du=s.du.insert(t,n),Gg(s.remoteStore,new _r(Mn(Yl(t.path)),n,"TargetPurposeLimboResolution",zl.ce))}}async function ba(s,e,t){const n=rt(s),r=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((l,u)=>{o.push(n.pu(u,e,t).then(m=>{var d;if((m||t)&&n.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=vm.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),n.Pu.H_(r),await async function(u,m){const d=rt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ce.forEach(m,h=>ce.forEach(h.Es,b=>d.persistence.referenceDelegate.addReference(f,h.targetId,b)).next(()=>ce.forEach(h.ds,b=>d.persistence.referenceDelegate.removeReference(f,h.targetId,b)))))}catch(f){if(!io(f))throw f;Ve(_m,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const b=d.Ms.get(h),V=b.snapshotVersion,_=b.withLastLimboFreeSnapshotVersion(V);d.Ms=d.Ms.insert(h,_)}}}(n.localStore,i))}async function eA(s,e){const t=rt(s);if(!t.currentUser.isEqual(e)){Ve(Im,"User change. New user:",e.toKey());const n=await zg(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Ee(ie.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ba(t,n.Ls)}}function tA(s,e){const t=rt(s),n=t.Au.get(e);if(n&&n.hu)return _t().add(n.key);{let r=_t();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function cy(s){const e=rt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=iy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gk.bind(null,e),e.Pu.H_=Uk.bind(null,e.eventManager),e.Pu.yu=Hk.bind(null,e.eventManager),e}function sA(s){const e=rt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Xk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Jk.bind(null,e),e}class wl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ok(this.persistence,new nk,e.initialUser,this.serializer)}Cu(e){return new Wg(xm.mi,this.serializer)}Du(e){return new fk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wl.provider={build:()=>new wl};class nA extends wl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ut(this.persistence.referenceDelegate instanceof Cl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new FD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new Wg(n=>Cl.mi(n,t),this.serializer)}}class Iu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>qf(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=eA.bind(null,this.syncEngine),await jk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Bk}()}createDatastore(e){const t=sc(e.databaseInfo.databaseId),n=function(i){return new bk(i)}(e.databaseInfo);return function(i,o,l,u){return new _k(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,i,o,l){return new kk(n,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>qf(this.syncEngine,t,0),function(){return Bf.v()?new Bf:new pk}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new qk(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=rt(r);Ve(ai,"RemoteStore shutting down."),i.Ea.add(5),await ya(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Iu.provider={build:()=>new Iu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):rr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr="FirestoreClient";class rA{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=$s.UNAUTHENTICATED,this.clientId=cm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{Ve(Pr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ve(Pr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Vm(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qc(s,e){s.asyncQueue.verifyOperationInProgress(),Ve(Pr,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener(async r=>{n.isEqual(r)||(await zg(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function Wf(s,e){s.asyncQueue.verifyOperationInProgress();const t=await iA(s);Ve(Pr,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(n=>Hf(e.remoteStore,n)),s.setAppCheckTokenChangeListener((n,r)=>Hf(e.remoteStore,r)),s._onlineComponents=e}async function iA(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ve(Pr,"Using user provided OfflineComponentProvider");try{await qc(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===ie.FAILED_PRECONDITION||r.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Qi("Error using user provided cache. Falling back to memory cache: "+t),await qc(s,new wl)}}else Ve(Pr,"Using default OfflineComponentProvider"),await qc(s,new nA(void 0));return s._offlineComponents}async function uy(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ve(Pr,"Using user provided OnlineComponentProvider"),await Wf(s,s._uninitializedComponentsProvider._online)):(Ve(Pr,"Using default OnlineComponentProvider"),await Wf(s,new Iu))),s._onlineComponents}function oA(s){return uy(s).then(e=>e.syncEngine)}async function Sl(s){const e=await uy(s),t=e.eventManager;return t.onListen=$k.bind(null,e.syncEngine),t.onUnlisten=Kk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Wk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Qk.bind(null,e.syncEngine),t}function aA(s,e,t={}){const n=new er;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f));const b=h.docs.has(l);!b&&h.fromCache?m.reject(new Ee(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&h.fromCache&&u&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(Yl(l.path),d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Sl(s),s.asyncQueue,e,t,n)),n.promise}function lA(s,e,t={}){const n=new er;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f)),h.fromCache&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(l,d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Sl(s),s.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy="firestore.googleapis.com",Kf=!0;class Qf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dy,this.ssl=Kf}else this.host=e.host,this.ssl=e.ssl??Kf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$g;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<MD)throw new Ee(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}D_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=my(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ic{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new f_;switch(n.type){case"firstParty":return new y_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ee(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=zf.get(t);n&&(Ve("ComponentProvider","Removing Datastore"),zf.delete(t),n.terminate())}(this),Promise.resolve()}}function cA(s,e,t,n={}){var m;s=Js(s,ic);const r=fa(e),i=s._getSettings(),o={...i,emulatorOptions:s._getEmulatorOptions()},l=`${e}:${t}`;r&&(jh(`https://${l}`),Bh("Firestore",!0)),i.host!==dy&&i.host!==l&&Qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:n};if(!xl(u,o)&&(s._setSettings(u),n.mockUserToken)){let d,f;if(typeof n.mockUserToken=="string")d=n.mockUserToken,f=$s.MOCK_USER;else{d=Rh(n.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Ee(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new $s(h)}s._authCredentials=new p_(new sg(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class as{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new as(this.firestore,e,this._key)}toJSON(){return{type:as._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(pa(t,as._jsonSchema))return new as(e,n||null,new $e(Xt.fromString(t.referencePath)))}}as._jsonSchemaVersion="firestore/documentReference/1.0",as._jsonSchema={type:ks("string",as._jsonSchemaVersion),referencePath:ks("string")};class Vr extends Hr{constructor(e,t,n){super(e,t,Yl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new as(this.firestore,null,new $e(e))}withConverter(e){return new Vr(this.firestore,e,this._path)}}function qe(s,e,...t){if(s=Ms(s),ng("collection","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return af(n),new Vr(s,null,n)}{if(!(s instanceof as||s instanceof Vr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return af(n),new Vr(s.firestore,null,n)}}function Se(s,e,...t){if(s=Ms(s),arguments.length===1&&(e=cm.newId()),ng("doc","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return of(n),new as(s,null,new $e(n))}{if(!(s instanceof as||s instanceof Vr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return of(n),new as(s.firestore,s instanceof Vr?s.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="AsyncQueue";class Gf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Qg(this,"async_queue_retry"),this._c=()=>{const n=Fc();n&&Ve(Yf,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Fc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!io(e))throw e;Ve(Yf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,rr("INTERNAL UNHANDLED ERROR: ",Xf(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cm.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Xe(47125,{Pc:Xf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Xf(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(s){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(s,["next","error","complete"])}class Kn extends ic{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Gf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gf(e),this._firestoreClient=void 0,await e}}}function uA(s,e){const t=typeof s=="object"?s:zh(),n=typeof s=="string"?s:_l,r=Fh(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=Ih("firestore");i&&cA(r,...i)}return r}function Na(s){if(s._terminated)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||mA(s),s._firestoreClient}function mA(s){var n,r,i;const e=s._freezeSettings(),t=function(l,u,m,d){return new P_(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,my(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,e);s._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new rA(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(Os.fromBase64String(e))}catch(t){throw new Ee(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yn(Os.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pa(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:ks("string",yn._jsonSchemaVersion),bytes:ks("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fn._jsonSchemaVersion}}static fromJSON(e){if(pa(e,Fn._jsonSchema))return new Fn(e.latitude,e.longitude)}}Fn._jsonSchemaVersion="firestore/geoPoint/1.0",Fn._jsonSchema={type:ks("string",Fn._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pa(e,qn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new qn(e.vectorValues);throw new Ee(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qn._jsonSchemaVersion="firestore/vectorValue/1.0",qn._jsonSchema={type:ks("string",qn._jsonSchemaVersion),vectorValues:ks("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=/^__.*__$/;class fA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms):new ha(e,this.data,t,this.fieldTransforms)}}class fy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function py(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xe(40011,{Ac:s})}}class Rm{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Rm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Tl(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(py(this.Ac)&&dA.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pA{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sc(e)}Cc(e,t,n,r=!1){return new Rm({Ac:e,methodName:t,Dc:n,path:Hs.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function va(s){const e=s._freezeSettings(),t=sc(s._databaseId);return new pA(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Bm(s,e,t,n,r,i={}){const o=s.Cc(i.merge||i.mergeFields?2:0,e,t,r);Hm("Data must be an object, but it was:",o,n);const l=yy(n,o);let u,m;if(i.merge)u=new un(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=Pu(e,f,t);if(!o.contains(h))throw new Ee(ie.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Ny(d,h)||d.push(h)}u=new un(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new fA(new on(l),u,m)}class ac extends oc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ac}}class Um extends oc{_toFieldTransform(e){return new oD(e.path,new oa)}isEqual(e){return e instanceof Um}}function hy(s,e,t,n){const r=s.Cc(1,e,t);Hm("Data must be an object, but it was:",r,n);const i=[],o=on.empty();Br(n,(u,m)=>{const d=Mm(e,u,t);m=Ms(m);const f=r.yc(d);if(m instanceof ac)i.push(d);else{const h=_a(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new un(i);return new fy(o,l,r.fieldTransforms)}function gy(s,e,t,n,r,i){const o=s.Cc(1,e,t),l=[Pu(e,n,t)],u=[r];if(i.length%2!=0)throw new Ee(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Pu(e,i[h])),u.push(i[h+1]);const m=[],d=on.empty();for(let h=l.length-1;h>=0;--h)if(!Ny(m,l[h])){const b=l[h];let V=u[h];V=Ms(V);const _=o.yc(b);if(V instanceof ac)m.push(b);else{const w=_a(V,_);w!=null&&(m.push(b),d.set(b,w))}}const f=new un(m);return new fy(d,f,o.fieldTransforms)}function hA(s,e,t,n=!1){return _a(t,s.Cc(n?4:3,e))}function _a(s,e){if(by(s=Ms(s)))return Hm("Unsupported field value:",e,s),yy(s,e);if(s instanceof oc)return function(n,r){if(!py(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let o=0;for(const l of n){let u=_a(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(s,e)}return function(n,r){if((n=Ms(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return nD(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xe.fromDate(n);return{timestampValue:El(r.serializer,i)}}if(n instanceof xe){const i=new xe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:El(r.serializer,i)}}if(n instanceof Fn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yn)return{bytesValue:Bg(r.serializer,n._byteString)};if(n instanceof as){const i=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bm(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof qn)return function(o,l){return{mapValue:{fields:{[dg]:{stringValue:fg},[Dl]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return hm(l.serializer,m)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${Wl(n)}`)}(s,e)}function yy(s,e){const t={};return og(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Br(s,(n,r)=>{const i=_a(r,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function by(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof xe||s instanceof Fn||s instanceof yn||s instanceof as||s instanceof oc||s instanceof qn)}function Hm(s,e,t){if(!by(t)||!rg(t)){const n=Wl(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function Pu(s,e,t){if((e=Ms(e))instanceof xa)return e._internalPath;if(typeof e=="string")return Mm(s,e);throw Tl("Field path arguments must be of type string or ",s,!1,void 0,t)}const gA=new RegExp("[~\\*/\\[\\]]");function Mm(s,e,t){if(e.search(gA)>=0)throw Tl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new xa(...e.split("."))._internalPath}catch{throw Tl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Tl(s,e,t,n,r){const i=n&&!n.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${r}`),u+=")"),new Ee(ie.INVALID_ARGUMENT,l+s+u)}function Ny(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new as(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class yA extends xy{data(){return super.data()}}function lc(s,e){return typeof e=="string"?Mm(s,e):e instanceof xa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ee(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Om{}class _y extends Om{}function xt(s,e,...t){let n=[];e instanceof Om&&n.push(e),n=n.concat(t),function(i){const o=i.filter(u=>u instanceof Fm).length,l=i.filter(u=>u instanceof cc).length;if(o>1||o>0&&l>0)throw new Ee(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)s=r._apply(s);return s}class cc extends _y{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cc(e,t,n)}_apply(e){const t=this._parse(e);return Dy(e._query,t),new Hr(e.firestore,e.converter,Du(e._query,t))}_parse(e){const t=va(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ep(f,d);const V=[];for(const _ of f)V.push(Zf(u,i,_));h={arrayValue:{values:V}}}else h=Zf(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ep(f,d),h=hA(l,o,f,d==="in"||d==="not-in");return _s.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function js(s,e,t){const n=e,r=lc("where",s);return cc._create(r,n,t)}class Fm extends Om{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fm(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Cn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)Dy(o,u),o=Du(o,u)}(e._query,t),new Hr(e.firestore,e.converter,Du(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class qm extends _y{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qm(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ia(i,o)}(e._query,this._field,this._direction);return new Hr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new oo(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function ls(s,e="asc"){const t=e,n=lc("orderBy",s);return qm._create(n,t)}function Zf(s,e,t){if(typeof(t=Ms(t))=="string"){if(t==="")throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vg(e)&&t.indexOf("/")!==-1)throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Xt.fromString(t));if(!$e.isDocumentKey(n))throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hf(s,new $e(n))}if(t instanceof as)return hf(s,t._key);throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wl(t)}.`)}function ep(s,e){if(!Array.isArray(s)||s.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Dy(s,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(s.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class bA{convertValue(e,t="none"){switch(Lr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Br(e,(r,i)=>{n[r]=this.convertValue(i,t)}),n}convertVectorValue(e){var n,r,i;const t=(i=(r=(n=e.fields)==null?void 0:n[Dl].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>hs(o.doubleValue));return new qn(t)}convertGeoPoint(e){return new Fn(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ql(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(sa(e));default:return null}}convertTimestamp(e){const t=Sr(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xt.fromString(e);Ut(qg(n),9688,{name:e});const r=new na(n.get(1),n.get(3)),i=new $e(n.popFirst(5));return r.isEqual(t)||rr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class Uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ti extends xy{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(lc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ti._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ti._jsonSchemaVersion="firestore/documentSnapshot/1.0",ti._jsonSchema={type:ks("string",ti._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class dl extends ti{data(e={}){return super.data(e)}}class si{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Uo(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new dl(this._firestore,this._userDataWriter,n.key,n,new Uo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new dl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Uo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new dl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Uo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:NA(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=si._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NA(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xe(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(s){s=Js(s,as);const e=Js(s.firestore,Kn);return aA(Na(e),s._key).then(t=>ky(e,s,t))}si._jsonSchemaVersion="firestore/querySnapshot/1.0",si._jsonSchema={type:ks("string",si._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class Wm extends bA{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new as(this.firestore,null,t)}}function wt(s){s=Js(s,Hr);const e=Js(s.firestore,Kn),t=Na(e),n=new Wm(e);return vy(s._query),lA(t,s._query).then(r=>new si(e,n,s,r))}function li(s,e,t){s=Js(s,as);const n=Js(s.firestore,Kn),r=$m(s.converter,e,t);return Da(n,[Bm(va(n),"setDoc",s._key,r,s.converter!==null,t).toMutation(s._key,Zs.none())])}function Bt(s,e,t,...n){s=Js(s,as);const r=Js(s.firestore,Kn),i=va(r);let o;return o=typeof(e=Ms(e))=="string"||e instanceof xa?gy(i,"updateDoc",s._key,e,t,n):hy(i,"updateDoc",s._key,e),Da(r,[o.toMutation(s._key,Zs.exists(!0))])}function Us(s){return Da(Js(s.firestore,Kn),[new ec(s._key,Zs.none())])}function $n(s,e){const t=Js(s.firestore,Kn),n=Se(s),r=$m(s.converter,e);return Da(t,[Bm(va(s.firestore),"addDoc",n._key,r,s.converter!==null,{}).toMutation(n._key,Zs.exists(!1))]).then(()=>n)}function dn(s,...e){var u,m,d;s=Ms(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Jf(e[n])||(t=e[n++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Jf(e[n])){const f=e[n];e[n]=(u=f.next)==null?void 0:u.bind(f),e[n+1]=(m=f.error)==null?void 0:m.bind(f),e[n+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(s instanceof as)o=Js(s.firestore,Kn),l=Yl(s._key.path),i={next:f=>{e[n]&&e[n](ky(o,s,f))},error:e[n+1],complete:e[n+2]};else{const f=Js(s,Hr);o=Js(f.firestore,Kn),l=f._query;const h=new Wm(o);i={next:b=>{e[n]&&e[n](new si(o,h,f,b))},error:e[n+1],complete:e[n+2]},vy(s._query)}return function(h,b,V,_){const w=new jm(_),B=new Lm(b,w,V);return h.asyncQueue.enqueueAndForget(async()=>wm(await Sl(h),B)),()=>{w.Nu(),h.asyncQueue.enqueueAndForget(async()=>Sm(await Sl(h),B))}}(Na(o),l,r,i)}function Da(s,e){return function(n,r){const i=new er;return n.asyncQueue.enqueueAndForget(async()=>Yk(await oA(n),r,i)),i.promise}(Na(s),e)}function ky(s,e,t){const n=t.docs.get(e._key),r=new Wm(s);return new ti(s,r,e._key,n,new Uo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=va(e)}set(e,t,n){this._verifyNotCommitted();const r=$c(e,this._firestore),i=$m(r.converter,t,n),o=Bm(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,Zs.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=$c(e,this._firestore);let o;return o=typeof(t=Ms(t))=="string"||t instanceof xa?gy(this._dataReader,"WriteBatch.update",i._key,t,n,r):hy(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Zs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=$c(e,this._firestore);return this._mutations=this._mutations.concat(new ec(t._key,Zs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ee(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $c(s,e){if((s=Ms(s)).firestore!==e)throw new Ee(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function os(){return new Um("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(s){return Na(s=Js(s,Kn)),new xA(s,e=>Da(s,e))}(function(e,t=!0){(function(r){no=r})($h),Zo(new Ki("firestore",(n,{instanceIdentifier:r,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new Kn(new h_(n.getProvider("auth-internal")),new b_(o,n.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ee(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new na(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Er(tf,sf,e),Er(tf,sf,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="firebasestorage.googleapis.com",Ey="storageBucket",_A=2*60*1e3,DA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends ui{constructor(e,t,n=0){super(Wc(e),`Firebase Storage: ${t} (${Wc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,us.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cs||(cs={}));function Wc(s){return"storage/"+s}function zm(){const s="An unknown error occurred, please check the error payload for server response.";return new us(cs.UNKNOWN,s)}function kA(s){return new us(cs.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function AA(s){return new us(cs.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function EA(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new us(cs.UNAUTHENTICATED,s)}function CA(){return new us(cs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VA(s){return new us(cs.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function wA(){return new us(cs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function SA(){return new us(cs.CANCELED,"User canceled the upload/download.")}function TA(s){return new us(cs.INVALID_URL,"Invalid URL '"+s+"'.")}function LA(s){return new us(cs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function IA(){return new us(cs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ey+"' property when initializing the app?")}function PA(){return new us(cs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jA(){return new us(cs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function RA(s){return new us(cs.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ju(s){return new us(cs.INVALID_ARGUMENT,s)}function Cy(){return new us(cs.APP_DELETED,"The Firebase app was deleted.")}function BA(s){return new us(cs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function zo(s,e){return new us(cs.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function xo(s){throw new us(cs.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=mn.makeFromUrl(e,t)}catch{return new mn(e,"")}if(n.path==="")return n;throw LA(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(oe){oe.path.charAt(oe.path.length-1)==="/"&&(oe.path_=oe.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(oe){oe.path_=decodeURIComponent(oe.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",b=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),V={bucket:1,path:3},_=t===Ay?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",B=new RegExp(`^https?://${_}/${r}/${w}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:b,indices:V,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let oe=0;oe<F.length;oe++){const se=F[oe],M=se.regex.exec(e);if(M){const C=M[se.indices.bucket];let x=M[se.indices.path];x||(x=""),n=new mn(C,x),se.postModify(n);break}}if(n==null)throw TA(e);return n}}class UA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(s,e,t){let n=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...w){m||(m=!0,e.apply(null,w))}function f(w){r=setTimeout(()=>{r=null,s(b,u())},w)}function h(){i&&clearTimeout(i)}function b(w,...B){if(m){h();return}if(w){h(),d.call(null,w,...B);return}if(u()||o){h(),d.call(null,w,...B);return}n<64&&(n*=2);let F;l===1?(l=2,F=0):F=(n+Math.random())*1e3,f(F)}let V=!1;function _(w){V||(V=!0,h(),!m&&(r!==null?(w||(l=2),clearTimeout(r),f(0)):w||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,_(!0)},t),_}function MA(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(s){return s!==void 0}function FA(s){return typeof s=="object"&&!Array.isArray(s)}function Km(s){return typeof s=="string"||s instanceof String}function tp(s){return Qm()&&s instanceof Blob}function Qm(){return typeof Blob<"u"}function sp(s,e,t,n){if(n<e)throw ju(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw ju(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function Vy(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const r=e(n)+"="+e(s[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var ni;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ni||(ni={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(s,e){const t=s>=500&&s<600,r=[408,429].indexOf(s)!==-1,i=e.indexOf(s)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t,n,r,i,o,l,u,m,d,f,h=!0,b=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((V,_)=>{this.resolve_=V,this.reject_=_,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Oa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===ni.NO_ERROR,u=i.getStatus();if(!l||qA(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ni.ABORT;n(!1,new Oa(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;n(!0,new Oa(m,i))})},t=(n,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());OA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=zm();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?Cy():SA();o(u)}else{const u=wA();o(u)}};this.canceled_?t(!1,new Oa(!1,null,!0)):this.backoffId_=HA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&MA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Oa{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function WA(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function zA(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KA(s,e){e&&(s["X-Firebase-GMPID"]=e)}function QA(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function YA(s,e,t,n,r,i,o=!0,l=!1){const u=Vy(s.urlParams),m=s.url+u,d=Object.assign({},s.headers);return KA(d,e),WA(d,t),zA(d,i),QA(d,n),new $A(m,s.method,d,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function XA(...s){const e=GA();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(Qm())return new Blob(s);throw new us(cs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function JA(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(s){if(typeof atob>"u")throw RA("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zc{constructor(e,t){this.data=e,this.contentType=t||null}}function eE(s,e){switch(s){case Hn.RAW:return new zc(wy(e));case Hn.BASE64:case Hn.BASE64URL:return new zc(Sy(s,e));case Hn.DATA_URL:return new zc(sE(e),nE(e))}throw zm()}function wy(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=s.charCodeAt(++t);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function tE(s){let e;try{e=decodeURIComponent(s)}catch{throw zo(Hn.DATA_URL,"Malformed data URL.")}return wy(e)}function Sy(s,e){switch(s){case Hn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw zo(s,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Hn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw zo(s,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=ZA(e)}catch(r){throw r.message.includes("polyfill")?r:zo(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class Ty{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw zo(Hn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=rE(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function sE(s){const e=new Ty(s);return e.base64?Sy(Hn.BASE64,e.rest):tE(e.rest)}function nE(s){return new Ty(s).contentType}function rE(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,t){let n=0,r="";tp(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(tp(this.data_)){const n=this.data_,r=JA(n,e,t);return r===null?null:new xr(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new xr(n,!0)}}static getBlob(...e){if(Qm()){const t=e.map(n=>n instanceof xr?n.data_:n);return new xr(XA.apply(null,t))}else{const t=e.map(o=>Km(o)?eE(Hn.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let i=0;return t.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new xr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(s){let e;try{e=JSON.parse(s)}catch{return null}return FA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function oE(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function Iy(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(s,e){return e}class Gs{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||aE}}let Fa=null;function lE(s){return!Km(s)||s.length<2?s:Iy(s)}function Py(){if(Fa)return Fa;const s=[];s.push(new Gs("bucket")),s.push(new Gs("generation")),s.push(new Gs("metageneration")),s.push(new Gs("name","fullPath",!0));function e(i,o){return lE(o)}const t=new Gs("name");t.xform=e,s.push(t);function n(i,o){return o!==void 0?Number(o):o}const r=new Gs("size");return r.xform=n,s.push(r),s.push(new Gs("timeCreated")),s.push(new Gs("updated")),s.push(new Gs("md5Hash",null,!0)),s.push(new Gs("cacheControl",null,!0)),s.push(new Gs("contentDisposition",null,!0)),s.push(new Gs("contentEncoding",null,!0)),s.push(new Gs("contentLanguage",null,!0)),s.push(new Gs("contentType",null,!0)),s.push(new Gs("metadata","customMetadata",!0)),Fa=s,Fa}function cE(s,e){function t(){const n=s.bucket,r=s.fullPath,i=new mn(n,r);return e._makeStorageReference(i)}Object.defineProperty(s,"ref",{get:t})}function uE(s,e,t){const n={};n.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];n[o.local]=o.xform(n,e[o.server])}return cE(n,s),n}function jy(s,e,t){const n=Ly(e);return n===null?null:uE(s,n,t)}function mE(s,e,t,n){const r=Ly(e);if(r===null||!Km(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(m=>{const d=s.bucket,f=s.fullPath,h="/b/"+o(d)+"/o/"+o(f),b=uc(h,t,n),V=Vy({alt:"media",token:m});return b+V})[0]}function dE(s,e){const t={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(t[i.server]=s[i.local])}return JSON.stringify(t)}class Ym{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(s){if(!s)throw zm()}function fE(s,e){function t(n,r){const i=jy(s,r,e);return Ry(i!==null),i}return t}function pE(s,e){function t(n,r){const i=jy(s,r,e);return Ry(i!==null),mE(i,r,s.host,s._protocol)}return t}function By(s){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=CA():r=EA():t.getStatus()===402?r=AA(s.bucket):t.getStatus()===403?r=VA(s.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Uy(s){const e=By(s);function t(n,r){let i=e(n,r);return n.getStatus()===404&&(i=kA(s.path)),i.serverResponse=r.serverResponse,i}return t}function hE(s,e,t){const n=e.fullServerUrl(),r=uc(n,s.host,s._protocol),i="GET",o=s.maxOperationRetryTime,l=new Ym(r,i,pE(s,t),o);return l.errorHandler=Uy(e),l}function gE(s,e){const t=e.fullServerUrl(),n=uc(t,s.host,s._protocol),r="DELETE",i=s.maxOperationRetryTime;function o(u,m){}const l=new Ym(n,r,o,i);return l.successCodes=[200,204],l.errorHandler=Uy(e),l}function yE(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function bE(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=yE(null,e)),n}function NE(s,e,t,n,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let F="";for(let oe=0;oe<2;oe++)F=F+Math.random().toString().slice(2);return F}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const m=bE(e,n,r),d=dE(m,t),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+m.contentType+`\r
\r
`,h=`\r
--`+u+"--",b=xr.getBlob(f,n,h);if(b===null)throw PA();const V={name:m.fullPath},_=uc(i,s.host,s._protocol),w="POST",B=s.maxUploadRetryTime,I=new Ym(_,w,fE(s,t),B);return I.urlParams=V,I.headers=o,I.body=b.uploadData(),I.errorHandler=By(e),I}class xE{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ni.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ni.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ni.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,i){if(this.sent_)throw xo("cannot .send() more than once");if(fa(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw xo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw xo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw xo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw xo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class vE extends xE{initXhr(){this.xhr_.responseType="text"}}function Gm(){return new vE}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t){this._service=e,t instanceof mn?this._location=t:this._location=mn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ci(e,t)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Iy(this._location.path)}get storage(){return this._service}get parent(){const e=iE(this._location.path);if(e===null)return null;const t=new mn(this._location.bucket,e);return new ci(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw BA(e)}}function _E(s,e,t){s._throwIfRoot("uploadBytes");const n=NE(s.storage,s._location,Py(),new xr(e,!0),t);return s.storage.makeRequestWithTokens(n,Gm).then(r=>({metadata:r,ref:s}))}function DE(s){s._throwIfRoot("getDownloadURL");const e=hE(s.storage,s._location,Py());return s.storage.makeRequestWithTokens(e,Gm).then(t=>{if(t===null)throw jA();return t})}function kE(s){s._throwIfRoot("deleteObject");const e=gE(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Gm)}function AE(s,e){const t=oE(s._location.path,e),n=new mn(s._location.bucket,t);return new ci(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(s){return/^[A-Za-z]+:\/\//.test(s)}function CE(s,e){return new ci(s,e)}function Hy(s,e){if(s instanceof Xm){const t=s;if(t._bucket==null)throw IA();const n=new ci(t,t._bucket);return e!=null?Hy(n,e):n}else return e!==void 0?AE(s,e):s}function VE(s,e){if(e&&EE(e)){if(s instanceof Xm)return CE(s,e);throw ju("To use ref(service, url), the first argument must be a Storage instance.")}else return Hy(s,e)}function np(s,e){const t=e==null?void 0:e[Ey];return t==null?null:mn.makeFromBucketSpec(t,s)}function wE(s,e,t,n={}){s.host=`${e}:${t}`;const r=fa(e);r&&(jh(`https://${s.host}/b`),Bh("Storage",!0)),s._isUsingEmulator=!0,s._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(s._overrideAuthToken=typeof i=="string"?i:Rh(i,s.app.options.projectId))}class Xm{constructor(e,t,n,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=Ay,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_A,this._maxUploadRetryTime=DA,this._requests=new Set,r!=null?this._bucket=mn.makeFromBucketSpec(r,this._host):this._bucket=np(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=np(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qh(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ci(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new UA(Cy());{const o=YA(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const rp="@firebase/storage",ip="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="storage";function Ru(s,e,t){return s=Ms(s),_E(s,e,t)}function Bu(s){return s=Ms(s),DE(s)}function SE(s){return s=Ms(s),kE(s)}function Ll(s,e){return s=Ms(s),VE(s,e)}function TE(s=zh(),e){s=Ms(s);const n=Fh(s,My).getImmediate({identifier:e}),r=Ih("storage");return r&&LE(n,...r),n}function LE(s,e,t,n={}){wE(s,e,t,n)}function IE(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),r=s.getProvider("app-check-internal");return new Xm(t,n,r,e,$h)}function PE(){Zo(new Ki(My,IE,"PUBLIC").setMultipleInstances(!0)),Er(rp,ip,""),Er(rp,ip,"esm2020")}PE();const jE={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Oy=Gd().length===0?Wh(jE):Gd()[0],re=uA(Oy),Il=TE(Oy),qa=async s=>{const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")},RE=s=>{const t=new TextEncoder().encode(s);let n="";return t.forEach(r=>n+=String.fromCharCode(r)),btoa(n)},BE=s=>{const e=atob(s),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)},op=s=>{const e={id:s.id,username:s.username,role:s.role,iat:Date.now(),exp:Date.now()+2592e6};return RE(JSON.stringify(e))},ap=s=>{try{if(s.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse(BE(s));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},lp={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Kc={async login(s){console.time("[Auth]   ");const e=lp[s.username];if(e){if(s.password!==e.password)throw new Error("  .");const d=e.user,f=op(d);return wt(xt(qe(re,"users"),js("username","==",s.username))).then(h=>{h.empty||Bt(Se(re,"users",h.docs[0].id),{lastLogin:os()}).catch(b=>console.error("lastLogin  :",b))}).catch(h=>console.error("Firestore  :",h)),console.timeEnd("[Auth]   "),{success:!0,token:f,user:d}}console.time("[Auth] Firestore ");const t=qe(re,"users"),n=xt(t,js("username","==",s.username)),r=await wt(n);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],o=i.data(),l=await qa(s.password);if(o.passwordHash){if(o.passwordHash!==l)throw new Error("  .")}else if(o.password){if(o.password.startsWith("$2b$")||o.password.startsWith("$2a$")){if(s.password!=="1234")throw new Error("  .")}else if(o.password!==s.password&&s.password!=="1234")throw new Error("  .")}else if(s.password!=="1234")throw new Error("  .");const u={id:i.id,username:o.username,name:o.name,email:o.email,role:o.role||"user",phone:o.phone,department:o.department,position:o.position,avatar:o.avatar},m=op(u);return Bt(Se(re,"users",i.id),{lastLogin:os()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:m,user:u}},async getCurrentUser(s){const e=ap(s);if(!e)return null;const t=lp[e.username];if(t)return t.user;try{const n=await Pt(Se(re,"users",e.id));if(!n.exists())return null;const r=n.data();return{id:n.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(n){return console.error("Firestore getCurrentUser error:",n),null}},async getUserById(s){const e=await Pt(Se(re,"users",s));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(s){const e=qe(re,"users"),t=xt(e,js("username","==",s)),n=await wt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const s=qe(re,"users");return(await wt(s)).docs.map(t=>{const n=t.data();return{id:t.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}})},async createUser(s){const{password:e,...t}=s,n=await qa(e),r=qe(re,"users"),i=Se(r),o={...t,passwordHash:n,createdAt:os(),updatedAt:os()};return await li(i,o),{id:i.id,...t}},async updateUser(s,e){const t=Se(re,"users",s);await Bt(t,{...e,updatedAt:os()});const r=(await Pt(t)).data();return{id:s,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(s,e,t){const n=await Pt(Se(re,"users",s));if(!n.exists())throw new Error("   .");const r=n.data(),i=await qa(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await qa(t);return await Bt(Se(re,"users",s),{passwordHash:o,updatedAt:os()}),!0},verifyToken:ap};class UE{async login(e){const t=await Kc.login(e);return t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}async getCurrentUser(){const e=this.getToken(),t=this.getUser();if(!e)return t;try{const n=await Kc.getCurrentUser(e);return n?(localStorage.setItem("user",JSON.stringify(n)),n):(console.log("Token invalid or expired, using cached user..."),t?(localStorage.removeItem("token"),t):null)}catch(n){return console.error("Get current user error:",n),t?(console.log("Using cached user data due to error"),t):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Kc.getAllUsers()}}const cp=new UE,_i=(s,e)=>({id:parseInt(s)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Qc={async getLibraryMeta(){const s=qe(re,"specbook_items"),e=xt(s,js("is_library","==",1),ls("category"),ls("name"));return(await wt(e)).docs.map(n=>_i(n.id,n.data()))},async getCategories(){const s=await this.getLibraryMeta();return[...new Set(s.map(t=>t.category))].sort()},async getProjectMeta(s){const e=qe(re,"specbook_items"),t=xt(e,js("project_id","==",s),ls("display_order"));return(await wt(t)).docs.map(r=>_i(r.id,r.data()))},async getItemById(s){const e=Se(re,"specbook_items",s),t=await Pt(e);return t.exists()?_i(t.id,t.data()):null},async getItemImage(s){const e=Se(re,"specbook_items",s),t=await Pt(e);if(!t.exists())return null;const n=t.data();return{image_url:n.image_url||null,sub_images:n.sub_images||[]}},subscribeToLibraryItems(s){const e=qe(re,"specbook_items"),t=xt(e,js("is_library","==",1));return dn(t,r=>{const i=r.docs.map(o=>_i(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),s(i)})},subscribeToProjectItems(s,e){const t=qe(re,"specbook_items"),n=xt(t,js("project_id","==",s));return dn(n,i=>{const o=i.docs.map(l=>_i(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})},async updateCategories(s){const e=Se(re,"specbook_settings","categories");await li(e,{categories:s,updatedAt:os()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(s){try{const e=qe(re,"specbook_items"),t=await wt(e);let n=0;t.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>n&&(n=m)});const r=n+1;let i=null;if(s.image&&s.image.startsWith("data:")){const u=s.image.split(",")[1],m=s.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),b=new Array(h.length);for(let I=0;I<h.length;I++)b[I]=h.charCodeAt(I);const V=new Uint8Array(b),_=new Blob([V],{type:d}),w=`specbook/${r}-${Date.now()}.${f}`,B=Ll(Il,w);await Ru(B,_),i=await Bu(B)}const o=new Date().toISOString(),l=Se(re,"specbook_items",String(r));return await li(l,{name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade||null,created_at:o,updated_at:o}),console.log(" [Firestore]    :",r),{id:r,name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade,created_at:o,updated_at:o}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(s,e){try{const t=Se(re,"specbook_items",String(s)),n=await Pt(t);if(!n.exists())throw new Error("   .");const r=n.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const u=e.image.split(",")[1],m=e.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),b=new Array(h.length);for(let I=0;I<h.length;I++)b[I]=h.charCodeAt(I);const V=new Uint8Array(b),_=new Blob([V],{type:d}),w=`specbook/${s}-${Date.now()}.${f}`,B=Ll(Il,w);await Ru(B,_),i=await Bu(B)}const l={updated_at:new Date().toISOString()};return e.name!==void 0&&(l.name=e.name),e.category!==void 0&&(l.category=e.category),e.brand!==void 0&&(l.brand=e.brand),e.price!==void 0&&(l.price=e.price),e.description!==void 0&&(l.description=e.description),i!==r.image_url&&(l.image_url=i),e.sub_images!==void 0&&(l.sub_images=e.sub_images),e.project_id!==void 0&&(l.project_id=e.project_id),e.is_library!==void 0&&(l.is_library=e.is_library),e.display_order!==void 0&&(l.display_order=e.display_order),e.grade!==void 0&&(l.grade=e.grade),await Bt(t,l),console.log(" [Firestore]    :",s),_i(String(s),{...r,...l,image_url:i})}catch(t){throw console.error("[Firestore]    :",t),new Error(`  : ${t.message||"   "}`)}},async deleteItem(s){try{const e=Se(re,"specbook_items",String(s));await Us(e),console.log(" [Firestore]    :",s)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(s,e){try{const t=Se(re,"specbook_items",String(s));await Bt(t,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",s)}catch(t){throw console.error("[Firestore]    :",t),new Error(`   : ${t.message||"   "}`)}},async reorderItems(s){try{const e=vA(re);s.forEach(t=>{const n=Se(re,"specbook_items",String(t.id));e.update(n,{display_order:t.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},HE=10*60*1e3,ME=Wu((s,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<HE){console.log("[SpecbookStore]   , ");return}s({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const n=await Qc.getLibraryMeta();s({libraryItems:n,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",n.length," ")}catch(n){console.error("[SpecbookStore]   :",n),s({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const n=await Qc.getCategories();s({categories:n,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",n.length,"")}catch(n){console.error("[SpecbookStore]   :",n)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:n}=e();await Promise.all([t(),n()])},getLibraryItems:(t,n)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),n&&n.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return n.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:n}=e();return n.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const i=await Qc.getProjectMeta(t);return s(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{s(n=>{const r=new Map(n.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?s(n=>({libraryItems:[t,...n.libraryItems]})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?s(n=>({libraryItems:n.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,n,r)=>{n?s(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&s(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),Fy=A.createContext(void 0);function OE({children:s}){const[e,t]=A.useState(null),[n,r]=A.useState(!0),i=$p(),o=ME(f=>f.preloadAll);A.useEffect(()=>{l()},[]);const l=async()=>{try{const f=localStorage.getItem("user");let h=null;if(f)try{h=JSON.parse(f)}catch{}if(h&&(t(h),o()),!localStorage.getItem("token")){r(!1);return}const V=await cp.getCurrentUser();V&&(t(V),localStorage.setItem("user",JSON.stringify(V)))}catch(f){console.error("Auth check error:",f)}finally{r(!1)}},u=async(f,h)=>{var b,V;try{const _=await cp.login({username:f,password:h}),w=_.token,B=_.user;localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(B)),Xo.defaults.headers.common.Authorization=`Bearer ${w}`,t(B),o(),ne.success(`${B.name}, !`);const I=sessionStorage.getItem("redirectAfterLogin");I?(sessionStorage.removeItem("redirectAfterLogin"),i(I)):i("/")}catch(_){const w=_;throw ne.error(((V=(b=w.response)==null?void 0:b.data)==null?void 0:V.message)||" "),_}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Xo.defaults.headers.common.Authorization,t(null),i("/login"),ne.success("")},d=f=>{t(f)};return a.jsxDEV(Fy.Provider,{value:{user:e,loading:n,login:u,logout:m,updateUser:d},children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:131,columnNumber:5},this)}function Mr(){const s=A.useContext(Fy);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const FE={};function qE(s,e){let t;try{t=s()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const ca=s=>e=>{try{const t=s(e);return t instanceof Promise?t:{then(n){return ca(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return ca(n)(t)}}}},$E=(s,e)=>(t,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,B)=>({...B,...w}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return s((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...w)},n,r);const d=ca(i.serialize),f=()=>{const w=i.partialize({...n()});let B;const I=d({state:w,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{B=F});if(B)throw B;return I},h=r.setState;r.setState=(w,B)=>{h(w,B),f()};const b=s((...w)=>{t(...w),f()},n,r);let V;const _=()=>{var w;if(!m)return;o=!1,l.forEach(I=>I(n()));const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,n()))||void 0;return ca(m.getItem.bind(m))(i.name).then(I=>{if(I)return i.deserialize(I)}).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return i.migrate(I.state,I.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return I.state}).then(I=>{var F;return V=i.merge(I,(F=n())!=null?F:b),t(V,!0),f()}).then(()=>{B==null||B(V,void 0),o=!0,u.forEach(I=>I(V))}).catch(I=>{B==null||B(void 0,I)})};return r.persist={setOptions:w=>{i={...i,...w},w.getStorage&&(m=w.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},_(),V||b},WE=(s,e)=>(t,n,r)=>{let i={storage:qE(()=>localStorage),partialize:_=>_,version:0,merge:(_,w)=>({...w,..._}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return s((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(..._)},n,r);const d=()=>{const _=i.partialize({...n()});return m.setItem(i.name,{state:_,version:i.version})},f=r.setState;r.setState=(_,w)=>{f(_,w),d()};const h=s((..._)=>{t(..._),d()},n,r);r.getInitialState=()=>h;let b;const V=()=>{var _,w;if(!m)return;o=!1,l.forEach(I=>{var F;return I((F=n())!=null?F:h)});const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(_=n())!=null?_:h))||void 0;return ca(m.getItem.bind(m))(i.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate)return[!0,i.migrate(I.state,I.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var F;const[oe,se]=I;if(b=i.merge(se,(F=n())!=null?F:h),t(b,!0),oe)return d()}).then(()=>{B==null||B(b,void 0),b=n(),o=!0,u.forEach(I=>I(b))}).catch(I=>{B==null||B(void 0,I)})};return r.persist={setOptions:_=>{i={...i,..._},_.storage&&(m=_.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>V(),hasHydrated:()=>o,onHydrate:_=>(l.add(_),()=>{l.delete(_)}),onFinishHydration:_=>(u.add(_),()=>{u.delete(_)})},i.skipHydration||V(),b||h},zE=(s,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((FE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),$E(s,e)):WE(s,e),qy=zE,$y=Wu()(qy((s,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const n={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};s(r=>({notifications:[n,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{s(n=>({notifications:n.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,n.unreadCount-1)}))},markAllAsRead:()=>{s(t=>({notifications:t.notifications.map(n=>({...n,read:!0})),unreadCount:0}))},deleteNotification:t=>{s(n=>{const r=n.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:n.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,n.unreadCount-1):n.unreadCount}})},clearAll:()=>{s({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:s=>({notifications:s.notifications,unreadCount:s.unreadCount})}));var KE={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},QE=function(e,t,n){var r,i=KE[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+" ":r+" ":r},YE={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},GE={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},XE={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},JE={date:Tc({formats:YE,defaultWidth:"full"}),time:Tc({formats:GE,defaultWidth:"full"}),dateTime:Tc({formats:XE,defaultWidth:"full"})},ZE={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},eC=function(e,t,n,r){return ZE[e]},tC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},sC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},nC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},rC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},iC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},oC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},aC=function(e,t){var n=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},lC={ordinalNumber:aC,era:yo({values:tC,defaultWidth:"wide"}),quarter:yo({values:sC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:yo({values:nC,defaultWidth:"wide"}),day:yo({values:rC,defaultWidth:"wide"}),dayPeriod:yo({values:iC,defaultWidth:"wide",formattingValues:oC,defaultFormattingWidth:"wide"})},cC=/^(\d+)(|)?/i,uC=/\d+/i,mC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},dC={any:[/^(bc|)/i,/^(ad|)/i]},fC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},pC={any:[/1/i,/2/i,/3/i,/4/i]},hC={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},gC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},yC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},bC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},NC={any:/^(am|pm|||||||)/i},xC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},vC={ordinalNumber:PN({matchPattern:cC,parsePattern:uC,valueCallback:function(e){return parseInt(e,10)}}),era:bo({matchPatterns:mC,defaultMatchWidth:"wide",parsePatterns:dC,defaultParseWidth:"any"}),quarter:bo({matchPatterns:fC,defaultMatchWidth:"wide",parsePatterns:pC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:bo({matchPatterns:hC,defaultMatchWidth:"wide",parsePatterns:gC,defaultParseWidth:"any"}),day:bo({matchPatterns:yC,defaultMatchWidth:"wide",parsePatterns:bC,defaultParseWidth:"any"}),dayPeriod:bo({matchPatterns:NC,defaultMatchWidth:"any",parsePatterns:xC,defaultParseWidth:"any"})},xs={code:"ko",formatDistance:QE,formatLong:JE,formatRelative:eC,localize:lC,match:vC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const _C=({isOpen:s,onClose:e})=>{const t=$p(),{notifications:n,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=$y();if(!s)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(DN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(_N,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Kp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(vN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Sc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Sc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),n.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(zp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(ii,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Sc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:n.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:jN(new Date(h.createdAt),{addSuffix:!0,locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:b=>{b.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},Di="work_requests",vo=s=>{const e=s.data();return{_id:s.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof xe?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof xe?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},ki={getAllWorkRequests:async()=>{const s=xt(qe(re,Di),ls("createdAt","desc"));return(await wt(s)).docs.map(vo)},getWorkRequestById:async s=>{const e=Se(re,Di,s),t=await Pt(e);return t.exists()?vo(t):null},createWorkRequest:async s=>{const e=xe.now(),t={project:s.project,requestType:s.requestType,description:s.description,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,dueDate:s.dueDate instanceof Date?xe.fromDate(s.dueDate):s.dueDate,requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status||"pending",priority:s.priority||"medium",notes:s.notes||"",createdAt:e,updatedAt:e},n=await $n(qe(re,Di),t),r=await Pt(n);return vo(r)},updateWorkRequest:async(s,e)=>{const t=Se(re,Di,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.requestType!==void 0&&(n.requestType=e.requestType),e.description!==void 0&&(n.description=e.description),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(n.dueDate=e.dueDate instanceof Date?xe.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(n.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.status!==void 0&&(n.status=e.status),e.priority!==void 0&&(n.priority=e.priority),e.notes!==void 0&&(n.notes=e.notes),e.completedDate!==void 0&&(n.completedDate=e.completedDate instanceof Date?xe.fromDate(e.completedDate):e.completedDate),await Bt(t,n);const r=await Pt(t);return vo(r)},deleteWorkRequest:async s=>{const e=Se(re,Di,s);await Us(e)},subscribeToWorkRequests:s=>{const e=xt(qe(re,Di),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(vo);s(n)})}},DC={getAllWorkRequests:()=>ki.getAllWorkRequests(),getWorkRequestById:async s=>{const e=await ki.getWorkRequestById(s);if(!e)throw new Error("Work request not found");return e},createWorkRequest:s=>ki.createWorkRequest(s),updateWorkRequest:(s,e)=>ki.updateWorkRequest(s,e),deleteWorkRequest:s=>ki.deleteWorkRequest(s),subscribeToWorkRequests:ki.subscribeToWorkRequests},Rt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function m2(s,e){const t=qe(re,s);return(await $n(t,{...e,createdAt:xe.now(),updatedAt:xe.now()})).id}function eo(s){return!s||typeof s!="string"||s.startsWith("http://")||s.startsWith("https://")?!1:!!(s.startsWith("data:image")||s.length>1e3)}function kC(s){if(s.startsWith("data:")){const e=s.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function AC(s){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[s]||"jpg"}function EC(s){let e=s,t="image/jpeg";if(s.includes(",")){const o=s.split(",");e=o[1];const l=o[0].match(/data:([^;]+);/);l&&(t=l[1])}const n=atob(e),r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);const i=new Uint8Array(r);return new Blob([i],{type:t})}async function Wy(s,e,t,n){if(!eo(t))return t;const r=kC(t),i=AC(r),o=n!==void 0?`image_${n}.${i}`:`main.${i}`,l=`${s}/${e}/${o}`,u=Ll(Il,l),m=EC(t);return await Ru(u,m,{contentType:r}),await Bu(u)}async function Pl(s,e,t){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=await Wy(s,e,i,r);n.push(o)}return n}async function zy(s){if(s.includes("firebasestorage.googleapis.com"))try{const e=s.match(/\/o\/(.+)\?/);if(e){const t=decodeURIComponent(e[1]),n=Ll(Il,t);await SE(n)}}catch(e){console.warn("  :",e)}}async function Ky(s){await Promise.all(s.map(e=>zy(e)))}let ri=new Map,Oi=null;async function fr(){if(!(ri.size>0))return Oi||(Oi=(async()=>{try{const s=qe(re,Rt.PROJECTS);(await wt(s)).docs.forEach(t=>{const n=t.data();ri.set(t.id,{name:n.name||"",color:n.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ri.size,"")}catch(s){throw console.error("[paymentFirestoreService]    :",s),Oi=null,s}})(),Oi)}function _o(s){const e=ri.get(String(s.projectId))||{name:"",color:"#4A90E2"};return!e.name&&s.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:s.id,projectId:s.projectId,cacheSize:ri.size,cacheKeys:Array.from(ri.keys()).slice(0,5),vendorName:s.vendorName}),{id:s.id,project_id:s.projectId,project_name:e.name,project_color:e.color,user_id:s.userId||0,requester_name:s.requestedBy||"",approved_by:s.approvedBy||void 0,request_type:s.requestType||"material",vendor_name:s.vendorName||"",description:s.description||"",amount:s.amount||0,account_holder:s.accountHolder||"",bank_name:s.bankName||"",account_number:s.accountNumber||"",item_name:s.itemName||"",material_amount:s.materialAmount||0,labor_amount:s.laborAmount||0,original_material_amount:s.originalMaterialAmount||0,original_labor_amount:s.originalLaborAmount||0,apply_tax_deduction:s.applyTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,quick_text:s.quickText||"",images:s.images?JSON.stringify(s.images):"[]",notes:s.notes||"",status:s.status||"pending",created_at:s.createdAt||"",updated_at:s.updatedAt||"",paid_at:s.paidAt||void 0}}function up(s){const e={};if(s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.request_type!==void 0&&(e.requestType=s.request_type),s.category!==void 0&&(e.requestType=s.category),s.vendor_name!==void 0&&(e.vendorName=s.vendor_name),s.process!==void 0&&(e.vendorName=s.process),s.description!==void 0&&(e.description=s.description),s.purpose!==void 0&&(e.description=s.purpose),s.amount!==void 0&&(e.amount=s.amount),s.account_holder!==void 0&&(e.accountHolder=s.account_holder),s.bank_name!==void 0&&(e.bankName=s.bank_name),s.account_number!==void 0&&(e.accountNumber=s.account_number),s.bankInfo!==void 0&&typeof s.bankInfo=="object"&&s.bankInfo!==null){const t=s.bankInfo;t.accountHolder&&(e.accountHolder=t.accountHolder),t.bankName&&(e.bankName=t.bankName),t.accountNumber&&(e.accountNumber=t.accountNumber)}return s.notes!==void 0&&(e.notes=s.notes),s.itemName!==void 0&&(e.itemName=s.itemName),s.item_name!==void 0&&(e.itemName=s.item_name),s.materialAmount!==void 0&&(e.materialAmount=s.materialAmount),s.laborAmount!==void 0&&(e.laborAmount=s.laborAmount),s.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=s.originalMaterialAmount),s.originalLaborAmount!==void 0&&(e.originalLaborAmount=s.originalLaborAmount),s.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=s.applyTaxDeduction),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),s.quickText!==void 0&&(e.quickText=s.quickText),s.images!==void 0&&(e.images=Array.isArray(s.images)?s.images:[]),s.status!==void 0&&(e.status=s.status),s.requestedBy!==void 0&&(e.requestedBy=s.requestedBy),e}const tn={getAllPayments:async()=>{await fr();const s=qe(re,Rt.PAYMENTS),e=xt(s,ls("id","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return _o({...r,id:parseInt(n.id)||r.id})})},getPaymentById:async s=>{await fr();const e=Se(re,Rt.PAYMENTS,s),t=await Pt(e);if(t.exists()){const n=t.data();return _o({...n,id:parseInt(t.id)||n.id})}return null},createPayment:async s=>{await fr();const e=qe(re,Rt.PAYMENTS),t=await wt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=n+1,i=up(s),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},u=Se(re,Rt.PAYMENTS,String(r));if(await li(u,l),i.images&&i.images.length>0)if(i.images.some(d=>eo(d))){const d=await Pl("payments",String(r),i.images);await Bt(u,{images:d,imageCount:d.length}),l.images=d,l.imageCount=d.length}else await Bt(u,{images:i.images,imageCount:i.images.length}),l.images=i.images,l.imageCount=i.images.length;return _o(l)},updatePayment:async(s,e)=>{await fr();const t=Se(re,Rt.PAYMENTS,s),n=up(e);await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(s,e)=>{await fr();const t=Se(re,Rt.PAYMENTS,s),n=new Date().toISOString(),r={status:e,updatedAt:n};e==="completed"&&(r.paidAt=n),await Bt(t,r);const i=await tn.getPaymentById(s);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(s,e,t)=>{await fr();const n=Se(re,Rt.PAYMENTS,s);await Bt(n,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(s,e)=>{const t=Se(re,Rt.PAYMENTS,s);let n=e;return e.length>0&&e.some(i=>eo(i))&&(n=await Pl("payments",s,e)),await Bt(t,{images:n,imageCount:n.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:n}},deletePayment:async s=>{const e=Se(re,Rt.PAYMENTS,s),t=await Pt(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Ky(n.images)}await Us(e)},subscribeToPayments:s=>{let e=null;return fr().then(()=>{const t=qe(re,Rt.PAYMENTS),n=xt(t,ls("id","desc"));e=dn(n,r=>{const i=r.docs.map(o=>{const l=o.data();return _o({...l,id:parseInt(o.id)||l.id})});s(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async s=>{await fr();const e=qe(re,Rt.PAYMENTS),t=xt(e,js("projectId","==",s),ls("id","desc"));return(await wt(t)).docs.map(r=>{const i=r.data();return _o({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ri.clear(),Oi=null}},ln={getAllPayments:()=>tn.getAllPayments(),getPaymentById:async s=>{const e=await tn.getPaymentById(s);if(!e)throw new Error("Payment not found");return e},createPayment:s=>tn.createPayment(s),updatePayment:(s,e)=>tn.updatePayment(s,e),updatePaymentStatus:(s,e)=>tn.updatePaymentStatus(s,e),updatePaymentAmounts:(s,e,t)=>tn.updatePaymentAmounts(s,e,t),updatePaymentImages:(s,e)=>tn.updatePaymentImages(s,e),deletePayment:s=>tn.deletePayment(s),sendTossPaymentSms:async s=>(await Xo.post("/payments/send-toss-payment-sms",s)).data,subscribeToPayments:tn.subscribeToPayments,getPaymentsByProject:tn.getPaymentsByProject,clearProjectsCache:tn.clearProjectsCache},Ai="as_requests",Do=s=>{const e=s.data();return{_id:s.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof xe?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof xe?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ei={getAllASRequests:async()=>{const s=xt(qe(re,Ai),ls("createdAt","desc"));return(await wt(s)).docs.map(Do)},getASRequestById:async s=>{const e=Se(re,Ai,s),t=await Pt(e);return t.exists()?Do(t):null},createASRequest:async s=>{const e=xe.now(),t={project:s.project,client:s.client,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,status:s.status||"pending",notes:s.notes||"",createdAt:e,updatedAt:e};s.scheduledVisitDate&&(t.scheduledVisitDate=s.scheduledVisitDate instanceof Date?xe.fromDate(s.scheduledVisitDate):s.scheduledVisitDate),s.scheduledVisitTime&&(t.scheduledVisitTime=s.scheduledVisitTime),s.assignedTo&&(t.assignedTo=s.assignedTo);const n=await $n(qe(re,Ai),t),r=await Pt(n);return Do(r)},updateASRequest:async(s,e)=>{const t=Se(re,Ai,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(n.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(n.entrancePassword=e.entrancePassword),e.description!==void 0&&(n.description=e.description),e.scheduledVisitDate!==void 0&&(n.scheduledVisitDate=e.scheduledVisitDate instanceof Date?xe.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(n.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.completionDate!==void 0&&(n.completionDate=e.completionDate instanceof Date?xe.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(n.notes=e.notes),e.status!==void 0&&(n.status=e.status),await Bt(t,n);const r=await Pt(t);return Do(r)},deleteASRequest:async s=>{const e=Se(re,Ai,s);await Us(e)},subscribeToASRequests:s=>{const e=xt(qe(re,Ai),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Do);s(n)})}},Ho={getAllASRequests:()=>Ei.getAllASRequests(),getASRequestById:async s=>{const e=await Ei.getASRequestById(s);if(!e)throw new Error("AS Request not found");return e},createASRequest:s=>Ei.createASRequest(s),updateASRequest:(s,e)=>Ei.updateASRequest(s,e),deleteASRequest:s=>Ei.deleteASRequest(s),subscribeToASRequests:Ei.subscribeToASRequests};function ko(s){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:s.id,id:parseInt(s.id)||0,name:s.name,client:{name:s.client||"",phone:"",address:s.address||""},location:{address:s.address||""},startDate:s.startDate||"",endDate:s.endDate||"",status:e[s.status]||"planning",budget:0,actualCost:0,manager:{_id:String(s.managerId||""),name:s.managerName||s.manager||"",username:s.managerUsername||""},fieldManagers:[],workers:[],colorCode:s.color||"#4A90E2",progress:0,description:s.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:s.createdAt||"",updatedAt:s.updatedAt||"",meetingNotes:s.meetingNotes||[],customerRequests:s.customerRequests||[],entrancePassword:s.entrancePassword||"",sitePassword:s.sitePassword||""}}function mp(s){var t,n,r,i,o,l,u,m;const e={};if(s.name!==void 0&&(e.name=s.name),s.client!==void 0&&(e.client=typeof s.client=="string"?s.client:((t=s.client)==null?void 0:t.name)||""),s.location!==void 0&&(e.address=typeof s.location=="string"?s.location:((n=s.location)==null?void 0:n.address)||""),s.address!==void 0&&(e.address=s.address),s.startDate!==void 0&&(e.startDate=typeof s.startDate=="string"?s.startDate:((o=(i=(r=s.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),s.endDate!==void 0&&(e.endDate=typeof s.endDate=="string"?s.endDate:((m=(u=(l=s.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),s.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[s.status]||"planning"}return s.description!==void 0&&(e.description=s.description),s.manager!==void 0&&(e.manager=s.manager),s.meetingNotes!==void 0&&(e.meetingNotes=s.meetingNotes),s.customerRequests!==void 0&&(e.customerRequests=s.customerRequests),s.entrancePassword!==void 0&&(e.entrancePassword=s.entrancePassword),s.sitePassword!==void 0&&(e.sitePassword=s.sitePassword),s.color!==void 0&&(e.color=s.color),s.colorCode!==void 0&&(e.color=s.colorCode),e}const yr={getAllProjects:async()=>{const s=qe(re,Rt.PROJECTS);return(await wt(s)).docs.map(n=>{const r=n.data();return ko({...r,id:n.id})}).sort((n,r)=>(r.id||0)-(n.id||0))},getProjectById:async s=>{const e=Se(re,Rt.PROJECTS,s),t=await Pt(e);if(t.exists()){const n=t.data();return ko({...n,id:t.id})}return null},createProject:async s=>{const e=qe(re,Rt.PROJECTS),t=await wt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=String(n+1),i=mp(s),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Se(re,Rt.PROJECTS,r);return await li(u,l),ko(l)},updateProject:async(s,e)=>{const t=Se(re,Rt.PROJECTS,s),n=mp(e);await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await yr.getProjectById(s);if(!r)throw new Error("Project not found after update");return r},deleteProject:async s=>{const e=Se(re,Rt.PROJECTS,s);await Us(e)},subscribeToProjects:s=>{const e=qe(re,Rt.PROJECTS);return dn(e,t=>{const n=t.docs.map(r=>{const i=r.data();return ko({...i,id:r.id})});n.sort((r,i)=>(i.id||0)-(r.id||0)),s(n)})},subscribeToProject:(s,e)=>{const t=Se(re,Rt.PROJECTS,s);return dn(t,n=>{if(n.exists()){const r=n.data();e(ko({...r,id:n.id}))}else e(null)})}},qi={getAllProjects:()=>yr.getAllProjects(),getProjectById:async s=>{const e=await yr.getProjectById(s);if(!e)throw new Error("Project not found");return e},createProject:s=>yr.createProject(s),updateProject:(s,e)=>yr.updateProject(s,e),deleteProject:s=>yr.deleteProject(s),subscribeToProjects:yr.subscribeToProjects,subscribeToProject:yr.subscribeToProject},Yc=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),$a={async getAllQuoteInquiries(){const s=qe(re,"quote_inquiries"),e=xt(s,ls("createdAt","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return{id:n.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Yc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(s){const e=Se(re,"quote_inquiries",s),t=await Pt(e);if(!t.exists())return null;const n=t.data();return{id:t.id,name:n.name||"",phone:n.phone||"",email:n.email||"",address:n.address,projectType:n.projectType,budget:n.budget,message:n.message||"",createdAt:Yc(n.createdAt),isRead:n.isRead||!1}},async createQuoteInquiry(s){const e=qe(re,"quote_inquiries"),t={...s,isRead:!1,createdAt:os()};return{id:(await $n(e,t)).id,...s,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(s){const e=Se(re,"quote_inquiries",s);await Bt(e,{isRead:!0,updatedAt:os()})},async deleteQuoteInquiry(s){const e=Se(re,"quote_inquiries",s);await Us(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(s){const e=qe(re,"quote_inquiries"),t=xt(e,ls("createdAt","desc"));return dn(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:Yc(l.createdAt),isRead:l.isRead||!1}});s(i)})}},fl={getAllQuoteInquiries:()=>$a.getAllQuoteInquiries(),markAsRead:s=>$a.markAsRead(s),deleteQuoteInquiry:s=>$a.deleteQuoteInquiry(s),subscribeToQuoteInquiries:$a.subscribeToQuoteInquiries},CC=()=>typeof window<"u"?window.location.origin:"",VC=CC();class wC{constructor(){Vd(this,"socket",null)}connect(e){return this.socket=Mo(VC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var n;(n=this.socket)==null||n.on(e,t)}emit(e,t){var n;(n=this.socket)==null||n.emit(e,t)}off(e,t){var n;(n=this.socket)==null||n.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const jl=new wC,SC=()=>{var ae,He;const{user:s,logout:e,loading:t}=Mr(),[n,r]=A.useState(!1),[i,o]=A.useState(!1),[l,u]=A.useState(!1),m=pN(),{unreadCount:d}=$y(),[f,h]=A.useState(0),[b,V]=A.useState(0),[_,w]=A.useState(0),[B,I]=A.useState(0),[F,oe]=A.useState(!1),[se,M]=A.useState(0),[C,x]=A.useState(!1),E=A.useRef(0),j=A.useRef(null),L=80,S=A.useCallback(de=>{if(window.scrollY>0)return!1;let Le=de;for(;Le&&Le!==document.body;){const bt=window.getComputedStyle(Le).overflowY;if((bt==="auto"||bt==="scroll")&&Le.scrollTop>0)return!1;Le=Le.parentElement}return!0},[]),k=A.useCallback(de=>{if(window.innerWidth>=768)return;const Le=de.target;S(Le)&&(E.current=de.touches[0].clientY,oe(!0))},[S]),_e=A.useCallback(de=>{if(!F||C)return;const Le=de.target;if(!S(Le)){oe(!1),M(0);return}const bt=de.touches[0].clientY-E.current;if(bt>0){const it=Math.min(bt*.5,120);M(it)}else oe(!1),M(0)},[F,C,S]),Ue=A.useCallback(()=>{F&&(se>=L&&!C?(x(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),oe(!1))},[F,se,C]);if(A.useEffect(()=>{u(!1)},[m.pathname]),A.useEffect(()=>{const de=Le=>{u(Le.detail.isOpen)};return window.addEventListener("mobileFormStateChange",de),()=>window.removeEventListener("mobileFormStateChange",de)},[]),A.useEffect(()=>{const de=()=>{I(Le=>Math.max(0,Le-1))};return window.addEventListener("quoteInquiryRead",de),()=>window.removeEventListener("quoteInquiryRead",de)},[]),A.useEffect(()=>{const de=()=>{V(Le=>Math.max(0,Le-1))};return window.addEventListener("paymentCompleted",de),()=>window.removeEventListener("paymentCompleted",de)},[]),A.useEffect(()=>{const de=jl.getSocket();if(!de||!s)return;const Le=async()=>{try{const[ze,bt]=await Promise.all([ln.getAllPayments(),qi.getAllProjects()]);let it=ze;if(s.name===""){const St=bt.map(st=>st.name);it=ze.filter(st=>St.includes(st.project))}V(it.filter(St=>St.status==="pending").length)}catch(ze){console.error("Failed to refresh payment count:",ze)}};return de.on("payment:refresh",Le),()=>{de.off("payment:refresh",Le)}},[s]),A.useEffect(()=>{if(!s)return;const de=async()=>{try{const[ze,bt,it,St]=await Promise.all([DC.getAllWorkRequests(),ln.getAllPayments(),Ho.getAllASRequests(),qi.getAllProjects()]);h(ze.filter(ut=>ut.assignedTo===s.name&&ut.status==="pending").length);let st=bt;if(s.name===""){const ut=St.map(ms=>ms.name);st=bt.filter(ms=>ut.includes(ms.project))}if(V(st.filter(ut=>ut.status==="pending").length),w(it.filter(ut=>ut.status==="in-progress").length),s.role==="admin"||s.role==="manager")try{const ms=(await fl.getAllQuoteInquiries()).filter(Q=>!Q.isRead).length;I(ms)}catch(ut){console.error("Failed to load quote inquiry count:",ut)}}catch(ze){console.error("Failed to load badge counts:",ze)}};de();const Le=setInterval(de,3e4);return()=>clearInterval(Le)},[s]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!s){const de=window.location.pathname+window.location.search;return de&&de!=="/login"&&de!=="/"&&sessionStorage.setItem("redirectAfterLogin",de),a.jsxDEV(Wp,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const pe=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...b>0&&{badge:b}},{name:"AS ",href:"/after-service",..._>0&&{badge:_}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],je=pe.filter(de=>!de.roles||de.roles.includes((s==null?void 0:s.role)||"")),ft=((ae=pe.find(de=>de.href===m.pathname))==null?void 0:ae.name)||"",Ht=(()=>{const de=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(de)?()=>{const ze=new CustomEvent("headerAddButtonClick");window.dispatchEvent(ze)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:_n("fixed inset-0 z-40 lg:hidden",n?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>_n("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>_n("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ft&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ft},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ht&&a.jsxDEV("button",{onClick:Ht,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(vs,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV($i,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:s==null?void 0:s.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:s==null?void 0:s.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(He=s==null?void 0:s.name)==null?void 0:He.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>_n("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Le?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:_e,onTouchEnd:Ue,children:[se>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:se,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:_n("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",C&&"animate-spin"),style:{transform:`rotate(${C?0:se*2}deg)`,opacity:Math.min(se/L,1)},children:a.jsxDEV(kN,{className:_n("w-5 h-5",se>=L?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:se>0?`translateY(${se}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(hN,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(_C,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},TC=s=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,n=s==="emergency"?5:3;let r=0;const i=()=>{if(r>=n)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=s==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<n&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},LC=s=>{if("vibrate"in navigator){const e=s==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},IC=(s,e)=>{TC(s),LC(s),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},PC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Ci="schedules",Ao=s=>{const e=s.data();return{_id:s.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof xe?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof xe?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof xe?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},Vi={getAllSchedules:async()=>{const s=xt(qe(re,Ci),ls("startDate","desc"));return(await wt(s)).docs.map(Ao)},getScheduleById:async s=>{const e=Se(re,Ci,s),t=await Pt(e);return t.exists()?Ao(t):null},createSchedule:async s=>{const e=xe.now(),t={project:typeof s.project=="string"?{_id:s.project,name:s.project}:s.project,title:s.title,type:s.type||"other",phase:s.phase||"",startDate:s.startDate instanceof Date?xe.fromDate(s.startDate):s.startDate,endDate:s.endDate instanceof Date?xe.fromDate(s.endDate):s.endDate,allDay:s.allDay??!0,assignedTo:s.assignedTo||[],description:s.description||"",location:s.location||"",priority:s.priority||"medium",progress:s.progress??0,isCompleted:s.isCompleted??!1,time:s.time||"",asRequestId:s.asRequestId||null,createdAt:e,updatedAt:e},n=await $n(qe(re,Ci),t),r=await Pt(n);return Ao(r)},updateSchedule:async(s,e)=>{const t=Se(re,Ci,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(n.title=e.title),e.type!==void 0&&(n.type=e.type),e.phase!==void 0&&(n.phase=e.phase),e.startDate!==void 0&&(n.startDate=e.startDate instanceof Date?xe.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(n.endDate=e.endDate instanceof Date?xe.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(n.allDay=e.allDay),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.description!==void 0&&(n.description=e.description),e.location!==void 0&&(n.location=e.location),e.priority!==void 0&&(n.priority=e.priority),e.progress!==void 0&&(n.progress=e.progress),e.isCompleted!==void 0&&(n.isCompleted=e.isCompleted,e.isCompleted&&(n.completedAt=xe.now())),e.time!==void 0&&(n.time=e.time),await Bt(t,n);const r=await Pt(t);return Ao(r)},deleteSchedule:async s=>{const e=Se(re,Ci,s);await Us(e)},subscribeToSchedules:s=>{const e=xt(qe(re,Ci),ls("startDate","desc"));return dn(e,t=>{const n=t.docs.map(Ao);s(n)})}},Wa={getAllSchedules:()=>Vi.getAllSchedules(),getScheduleById:async s=>{const e=await Vi.getScheduleById(s);if(!e)throw new Error("Schedule not found");return e},createSchedule:s=>Vi.createSchedule(s),updateSchedule:(s,e)=>Vi.updateSchedule(s,e),deleteSchedule:s=>Vi.deleteSchedule(s),subscribeToSchedules:Vi.subscribeToSchedules},wi="contractors",Eo=s=>{const e=s.data();return{_id:s.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Si={getAllContractors:async()=>{const s=xt(qe(re,wi),ls("name","asc"));return(await wt(s)).docs.map(Eo)},getContractorById:async s=>{const e=Se(re,wi,s),t=await Pt(e);return t.exists()?Eo(t):null},createContractor:async s=>{const e=xe.now(),t={rank:s.rank||"",companyName:s.companyName||"",name:s.name,position:s.position||"",process:s.process,contact:s.contact||"",accountNumber:s.accountNumber,notes:s.notes||"",createdAt:e,updatedAt:e},n=await $n(qe(re,wi),t),r=await Pt(n);return Eo(r)},updateContractor:async(s,e)=>{const t=Se(re,wi,s),n={updatedAt:xe.now()};e.rank!==void 0&&(n.rank=e.rank),e.companyName!==void 0&&(n.companyName=e.companyName),e.name!==void 0&&(n.name=e.name),e.position!==void 0&&(n.position=e.position),e.process!==void 0&&(n.process=e.process),e.contact!==void 0&&(n.contact=e.contact),e.accountNumber!==void 0&&(n.accountNumber=e.accountNumber),e.notes!==void 0&&(n.notes=e.notes),await Bt(t,n);const r=await Pt(t);return Eo(r)},deleteContractor:async s=>{const e=Se(re,wi,s);await Us(e)},subscribeToContractors:s=>{const e=xt(qe(re,wi),ls("name","asc"));return dn(e,t=>{const n=t.docs.map(Eo);s(n)})}},Zn={getAllContractors:()=>Si.getAllContractors(),getContractorById:async s=>{const e=await Si.getContractorById(s);if(!e)throw new Error("Contractor not found");return e},createContractor:s=>Si.createContractor(s),updateContractor:(s,e)=>Si.updateContractor(s,e),deleteContractor:s=>Si.deleteContractor(s),subscribeToContractors:Si.subscribeToContractors},Ti="construction_payments",Co=s=>{const e=s.data();let t=e.payments||[];if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}Array.isArray(t)||(t=[]);const n=t.map(i=>{let o=i.types||[];if(typeof o=="string")try{o=JSON.parse(o)}catch{o=[o]}return Array.isArray(o)||(o=[]),{types:o,type:o[0]||i.type||"",amount:i.amount||0,date:i.date instanceof xe?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof xe?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof xe?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof xe?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof xe?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:s.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:n,expectedPaymentDates:r,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Li={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const s=await wt(qe(re,Ti));console.log("[ConstructionPayment] Firestore :",s.size," ");const e=s.docs.map(Co).filter(t=>t.project&&t.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(s){return console.error("[ConstructionPayment] Firestore  :",s),[]}},getConstructionPaymentById:async s=>{const e=Se(re,Ti,s),t=await Pt(e);return t.exists()?Co(t):null},createConstructionPayment:async s=>{const e=xe.now(),t=(s.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?xe.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),n={};s.expectedPaymentDates&&(s.expectedPaymentDates.contract&&(n.contract=s.expectedPaymentDates.contract instanceof Date?xe.fromDate(s.expectedPaymentDates.contract):s.expectedPaymentDates.contract),s.expectedPaymentDates.start&&(n.start=s.expectedPaymentDates.start instanceof Date?xe.fromDate(s.expectedPaymentDates.start):s.expectedPaymentDates.start),s.expectedPaymentDates.middle&&(n.middle=s.expectedPaymentDates.middle instanceof Date?xe.fromDate(s.expectedPaymentDates.middle):s.expectedPaymentDates.middle),s.expectedPaymentDates.final&&(n.final=s.expectedPaymentDates.final instanceof Date?xe.fromDate(s.expectedPaymentDates.final):s.expectedPaymentDates.final));const r={project:s.project,client:s.client,totalAmount:s.totalAmount,vatType:s.vatType,vatPercentage:s.vatPercentage,vatAmount:s.vatAmount,payments:t,expectedPaymentDates:n,createdAt:e,updatedAt:e},i=await $n(qe(re,Ti),r),o=await Pt(i);return Co(o)},updateConstructionPayment:async(s,e)=>{const t=Se(re,Ti,s),n={updatedAt:xe.now()};if(e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.totalAmount!==void 0&&(n.totalAmount=e.totalAmount),e.vatType!==void 0&&(n.vatType=e.vatType),e.vatPercentage!==void 0&&(n.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(n.vatAmount=e.vatAmount),e.payments!==void 0&&(n.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?xe.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?xe.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?xe.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?xe.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?xe.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),n.expectedPaymentDates=i}await Bt(t,n);const r=await Pt(t);return Co(r)},deleteConstructionPayment:async s=>{const e=Se(re,Ti,s);await Us(e)},subscribeToConstructionPayments:s=>{const e=xt(qe(re,Ti),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Co);s(n)})}},za={getAllConstructionPayments:()=>Li.getAllConstructionPayments(),getConstructionPaymentById:async s=>{const e=await Li.getConstructionPaymentById(s);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:s=>Li.createConstructionPayment(s),updateConstructionPayment:(s,e)=>Li.updateConstructionPayment(s,e),deleteConstructionPayment:s=>Li.deleteConstructionPayment(s),subscribeToConstructionPayments:Li.subscribeToConstructionPayments};let pl=new Map,Vo=null;async function jC(){if(!(pl.size>0))return Vo||(Vo=(async()=>{try{const s=qe(re,Rt.PROJECTS);(await wt(s)).docs.forEach(t=>{const n=t.data(),r=parseInt(t.id);!isNaN(r)&&n.name&&pl.set(n.name,r)}),console.log("[executionRecordFirestoreService]    :",pl.size,"")}catch(s){throw console.error("[executionRecordFirestoreService]    :",s),Vo=null,s}})(),Vo)}function Ii(s){return{id:s.id,project_id:s.projectId,project_name:s.projectName||"",author:s.author||"",date:s.date||"",process:s.process||"",item_name:s.itemName||"",material_cost:s.materialCost||0,labor_cost:s.laborCost||0,vat_amount:s.vatAmount||0,total_amount:s.totalAmount||0,notes:s.notes||"",images:s.images||[],payment_id:s.paymentId,includes_tax_deduction:s.includesTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,created_at:s.createdAt||"",updated_at:s.updatedAt||""}}function dp(s){const e={};return s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.project_name!==void 0&&(e.projectName=s.project_name),s.projectName!==void 0&&(e.projectName=s.projectName),s.author!==void 0&&(e.author=s.author),s.date!==void 0&&(e.date=s.date),s.process!==void 0&&(e.process=s.process),s.item_name!==void 0&&(e.itemName=s.item_name),s.itemName!==void 0&&(e.itemName=s.itemName),s.material_cost!==void 0&&(e.materialCost=s.material_cost),s.materialCost!==void 0&&(e.materialCost=s.materialCost),s.labor_cost!==void 0&&(e.laborCost=s.labor_cost),s.laborCost!==void 0&&(e.laborCost=s.laborCost),s.vat_amount!==void 0&&(e.vatAmount=s.vat_amount),s.vatAmount!==void 0&&(e.vatAmount=s.vatAmount),s.total_amount!==void 0&&(e.totalAmount=s.total_amount),s.totalAmount!==void 0&&(e.totalAmount=s.totalAmount),s.notes!==void 0&&(e.notes=s.notes),s.images!==void 0&&(e.images=s.images),s.payment_id!==void 0&&(e.paymentId=s.payment_id),s.paymentId!==void 0&&(e.paymentId=s.paymentId),s.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=s.includes_tax_deduction===!0||s.includes_tax_deduction===1),s.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=s.includesTaxDeduction),s.includes_vat!==void 0&&(e.includesVAT=s.includes_vat===!0||s.includes_vat===1),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),e}const Jn={getAllRecords:async()=>{const s=qe(re,Rt.EXECUTION_RECORDS),e=xt(s,ls("id","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return Ii({...r,id:parseInt(n.id)||r.id})})},getRecordById:async s=>{const e=Se(re,Rt.EXECUTION_RECORDS,s),t=await Pt(e);if(t.exists()){const n=t.data();return Ii({...n,id:parseInt(t.id)||n.id})}return null},createRecord:async s=>{await jC();const e=qe(re,Rt.EXECUTION_RECORDS),t=await wt(e);let n=0;t.docs.forEach(f=>{const h=parseInt(f.id);!isNaN(h)&&h>n&&(n=h)});const r=n+1,i=dp(s),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const f=pl.get(u);f?(l=f,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:[],imageCount:0},d=Se(re,Rt.EXECUTION_RECORDS,String(r));if(await li(d,m),i.images&&i.images.length>0)if(i.images.some(h=>eo(h))){const h=await Pl("execution_records",String(r),i.images);await Bt(d,{images:h,imageCount:h.length}),m.images=h,m.imageCount=h.length}else await Bt(d,{images:i.images,imageCount:i.images.length}),m.images=i.images,m.imageCount=i.images.length;return Ii(m)},updateRecord:async(s,e)=>{const t=Se(re,Rt.EXECUTION_RECORDS,s),n=dp(e);n.images!==void 0&&(n.images.some(o=>eo(o))&&(n.images=await Pl("execution_records",s,n.images)),n.imageCount=n.images.length),await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await Jn.getRecordById(s);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async s=>{const e=Se(re,Rt.EXECUTION_RECORDS,s),t=await Pt(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Ky(n.images)}await Us(e)},subscribeToRecords:s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,ls("id","desc"));return dn(t,n=>{const r=n.docs.map(i=>{const o=i.data();return Ii({...o,id:parseInt(i.id)||o.id})});s(r)})},getRecordsByProject:async s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,js("projectId","==",s),ls("id","desc"));return(await wt(t)).docs.map(r=>{const i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,js("paymentId","==",s)),n=await wt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})}},Ka={getAllRecords:()=>Jn.getAllRecords(),getRecordById:async s=>{const e=await Jn.getRecordById(s);if(!e)throw new Error("Execution record not found");return e},createRecord:s=>Jn.createRecord(s),updateRecord:(s,e)=>Jn.updateRecord(s,e),deleteRecord:s=>Jn.deleteRecord(s),subscribeToRecords:Jn.subscribeToRecords,getRecordsByProject:Jn.getRecordsByProject,getRecordByPaymentId:Jn.getRecordByPaymentId},tr=Wu()(qy((s,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>s({projects:t}),addProject:t=>s(n=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...n.projects],constructionPayments:[r,...n.constructionPayments]}}),updateProject:(t,n)=>s(r=>({projects:r.projects.map(i=>i.id===t?{...i,...n}:i)})),deleteProject:t=>s(n=>({projects:n.projects.filter(r=>r.id!==t),constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>s({schedules:t}),addSchedule:t=>s(n=>({schedules:[t,...n.schedules]})),updateSchedule:(t,n)=>s(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...n}:i)})),deleteSchedule:t=>s(n=>({schedules:n.schedules.filter(r=>r.id!==t)})),setPayments:t=>s({payments:t}),addPayment:t=>s(n=>({payments:[t,...n.payments]})),updatePayment:(t,n)=>s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)})),deletePayment:t=>s(n=>({payments:n.payments.filter(r=>r.id!==t)})),setContractors:t=>s({contractors:t}),addContractor:t=>s(n=>({contractors:[t,...n.contractors]})),updateContractor:(t,n)=>s(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...n}:i)})),deleteContractor:t=>s(n=>({contractors:n.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>s({constructionPayments:t}),addConstructionPayment:t=>s(n=>({constructionPayments:[t,...n.constructionPayments]})),updateConstructionPayment:(t,n)=>s(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...n}:i)})),deleteConstructionPayment:t=>s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>s({asRequests:t}),addASRequest:t=>s(n=>({asRequests:[t,...n.asRequests]})),updateASRequest:(t,n)=>s(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...n}:i)})),deleteASRequest:t=>s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>s({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),s(n=>{const r=[t,...n.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,n)=>s(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...n}:i)})),deleteExecutionRecord:t=>s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await ln.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const n=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));n.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(n.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",n.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(V=>V.id)),f=n.filter(V=>!d.has(V.id)),b=[...m.map(V=>({...V,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",b.length),s({payments:b})}else console.log("[loadPaymentsFromAPI]    - API  "),s({payments:n})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const n=`temp_${Date.now()}`,r={...t,id:n,_addedAt:Date.now(),_tempId:n};s(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",n);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await ln.createPayment(u),d=String(m.id);return s(f=>({payments:f.payments.map(h=>h._tempId===n?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),s(o=>({payments:o.payments.filter(l=>l._tempId!==n)})),i}},updatePaymentInAPI:async(t,n)=>{try{if(n.status&&Object.keys(n).length===1)await ln.updatePaymentStatus(t,n.status);else{let r=n.project;if(n.project){const o=e().projects.find(l=>l.name===n.project);r=o?o.id:n.project}await ln.updatePayment(t,{projectId:r,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,materialAmount:n.materialAmount,laborAmount:n.laborAmount,originalMaterialAmount:n.originalMaterialAmount,originalLaborAmount:n.originalLaborAmount,category:n.category,urgency:n.urgency,bankInfo:n.bankInfo,notes:n.notes,requestDate:n.requestDate,includesVAT:n.includesVAT,applyTaxDeduction:n.applyTaxDeduction})}s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await ln.deletePayment(t),s(n=>({payments:n.payments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete payment from API:",n),n}},loadSchedulesFromAPI:async()=>{try{const t=await Wa.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const n=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});n.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),s({schedules:n})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const n=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:n};s(l=>({schedules:[...l.schedules,r]}));try{const l=await Wa.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};s(f=>({schedules:f.schedules.map(h=>h.id===n?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),s(u=>({schedules:u.schedules.filter(m=>m.id!==n)})),l}},updateScheduleInAPI:async(t,n)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:n});const l={};n.project!==void 0&&(l.project=n.project),n.title!==void 0&&(l.title=n.title),n.type!==void 0&&(l.type=n.type),n.start!==void 0&&(l.startDate=n.start),n.end!==void 0&&(l.endDate=n.end),n.location!==void 0&&(l.location=n.location),n.description!==void 0&&(l.description=n.description),n.attendees!==void 0&&(l.assignedTo=n.attendees),n.time!==void 0&&(l.time=n.time),console.log(" Sending update data:",l);const u=await Wa.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};s(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:n}=e(),r=n.find(o=>o.id===t);if(r){s(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await Wa.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&s(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const n=(await qi.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});s({projects:n})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var n,r;try{const i=await qi.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((n=i.meetingNotes)==null?void 0:n.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};s(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,n)=>{var r,i;try{const o=await qi.updateProject(t,n),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:typeof o.manager=="object"&&o.manager!==null?o.manager.name||"":o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};s(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await qi.deleteProject(t),s(n=>({projects:n.projects.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete project from API:",n),n}},loadContractorsFromAPI:async()=>{try{const n=(await Zn.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));s({contractors:n})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const n=await Zn.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:n._id,rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)};s(i=>({contractors:[r,...i.contractors]}))}catch(n){throw console.error("Failed to add contractor to API:",n),n}},updateContractorInAPI:async(t,n)=>{try{const r=await Zn.updateContractor(t,{rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};s(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await Zn.deleteContractor(t),s(n=>({contractors:n.contractors.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete contractor from API:",n),n}},loadConstructionPaymentsFromAPI:async()=>{try{const n=(await za.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});s({constructionPayments:n})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var n;try{const r=await za.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((n=r.payments)==null?void 0:n.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};s(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,n)=>{var r;try{const i=await za.updateConstructionPayment(t,n);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};s(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await za.deleteConstructionPayment(t),s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete construction payment from API:",n),n}},loadASRequestsFromAPI:async()=>{try{const n=(await Ho.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));s({asRequests:n})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const n=await Ho.createASRequest(t),r={id:n._id,project:n.project,client:n.client,requestDate:new Date(n.requestDate),siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,scheduledVisitDate:n.scheduledVisitDate?new Date(n.scheduledVisitDate):void 0,scheduledVisitTime:n.scheduledVisitTime,assignedTo:Array.isArray(n.assignedTo)?n.assignedTo:[],completionDate:n.completionDate?new Date(n.completionDate):void 0,notes:n.notes};return s(i=>({asRequests:[r,...i.asRequests]})),r}catch(n){throw console.error("Failed to add AS request to API:",n),n}},updateASRequestInAPI:async(t,n)=>{try{const r=await Ho.updateASRequest(t,n),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};s(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Ho.deleteASRequest(t),s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete AS request from API:",n),n}},loadExecutionRecordsFromAPI:async()=>{try{const t=await Ka.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const n=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));s({executionRecords:n})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const n=await Ka.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(n.id),project:n.project_name,author:n.author||void 0,date:new Date(n.date),process:n.process||void 0,itemName:n.item_name,materialCost:n.material_cost||0,laborCost:n.labor_cost||0,vatAmount:n.vat_amount||0,totalAmount:n.total_amount||0,notes:n.notes||void 0,paymentId:n.payment_id?String(n.payment_id):void 0,includesTaxDeduction:n.includes_tax_deduction===1,includesVat:n.includes_vat===1,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",n.includes_vat),s(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(n){throw console.error("Failed to add execution record to API:",n),n}},updateExecutionRecordInAPI:async(t,n)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",n);try{let r;if(n.date){const i=n.date instanceof Date?n.date:new Date(n.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:n.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat),await Ka.updateRecord(t,{project_name:n.project,author:n.author,date:r,process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,images:n.images,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),s(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...n,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await Ka.deleteRecord(t),s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete execution record from API:",n),n}}}),{name:"interior-management-storage",partialize:s=>({...s,payments:s.payments.map(e=>{const{images:t,...n}=e;return n}),executionRecords:s.executionRecords.map(e=>{const{images:t,...n}=e;return n})}),storage:{getItem:s=>{var u,m,d,f,h,b,V;const e=localStorage.getItem(s);if(!e)return null;const{state:t}=JSON.parse(e),n=((u=t.projects)==null?void 0:u.map(_=>({..._,startDate:_.startDate?new Date(_.startDate):void 0,endDate:_.endDate?new Date(_.endDate):void 0,contractAmount:_.contractAmount!==void 0?_.contractAmount:_.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(_=>{var w;return{..._,vatType:_.vatType||"percentage",vatPercentage:_.vatPercentage??100,vatAmount:_.vatAmount??0,payments:((w=_.payments)==null?void 0:w.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(_=>_.id)),o=n.filter(_=>!i.has(_.id)).map(_=>({id:_.id,project:_.name,client:_.client,totalAmount:_.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:n,schedules:((d=t.schedules)==null?void 0:d.map(_=>({..._,start:new Date(_.start),end:new Date(_.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(_=>({..._,requestDate:new Date(_.requestDate),approvalDate:_.approvalDate?new Date(_.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(_=>({..._,createdAt:new Date(_.createdAt),updatedAt:new Date(_.updatedAt)})))||[],constructionPayments:l,asRequests:((b=t.asRequests)==null?void 0:b.map(_=>({..._,requestDate:new Date(_.requestDate),scheduledVisitDate:_.scheduledVisitDate?new Date(_.scheduledVisitDate):void 0,completionDate:_.completionDate?new Date(_.completionDate):void 0})))||[],executionRecords:((V=t.executionRecords)==null?void 0:V.map(_=>({..._,date:new Date(_.date),createdAt:new Date(_.createdAt),updatedAt:new Date(_.updatedAt)})))||[]}}},setItem:(s,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(s,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:s=>localStorage.removeItem(s)}}));var ka=s=>s.type==="checkbox",ei=s=>s instanceof Date,Xs=s=>s==null;const Qy=s=>typeof s=="object";var As=s=>!Xs(s)&&!Array.isArray(s)&&Qy(s)&&!ei(s),RC=s=>As(s)&&s.target?ka(s.target)?s.target.checked:s.target.value:s,BC=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,UC=(s,e)=>s.has(BC(e)),HC=s=>{const e=s.constructor&&s.constructor.prototype;return As(e)&&e.hasOwnProperty("isPrototypeOf")},Jm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Is(s){let e;const t=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)e=new Date(s);else if(!(Jm&&(s instanceof Blob||n))&&(t||As(s)))if(e=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!HC(s))e=s;else for(const r in s)s.hasOwnProperty(r)&&(e[r]=Is(s[r]));else return s;return e}var mc=s=>/^\w*$/.test(s),Ns=s=>s===void 0,Zm=s=>Array.isArray(s)?s.filter(Boolean):[],ed=s=>Zm(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Pe=(s,e,t)=>{if(!e||!As(s))return t;const n=(mc(e)?[e]:ed(e)).reduce((r,i)=>Xs(r)?r:r[i],s);return Ns(n)||n===s?Ns(s[e])?t:s[e]:n},Bn=s=>typeof s=="boolean",ts=(s,e,t)=>{let n=-1;const r=mc(e)?[e]:ed(e),i=r.length,o=i-1;for(;++n<i;){const l=r[n];let u=t;if(n!==o){const m=s[l];u=As(m)||Array.isArray(m)?m:isNaN(+r[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;s[l]=u,s=s[l]}};const fp={BLUR:"blur",FOCUS_OUT:"focusout"},kn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Gn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},MC=lt.createContext(null);MC.displayName="HookFormContext";var OC=(s,e,t,n=!0)=>{const r={defaultValues:e._defaultValues};for(const i in s)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==kn.all&&(e._proxyFormState[o]=!n||kn.all),s[o]}});return r};const FC=typeof window<"u"?lt.useLayoutEffect:lt.useEffect;var cn=s=>typeof s=="string",qC=(s,e,t,n,r)=>cn(s)?(n&&e.watch.add(s),Pe(t,s,r)):Array.isArray(s)?s.map(i=>(n&&e.watch.add(i),Pe(t,i))):(n&&(e.watchAll=!0),t),Uu=s=>Xs(s)||!Qy(s);function vr(s,e,t=new WeakSet){if(Uu(s)||Uu(e))return s===e;if(ei(s)&&ei(e))return s.getTime()===e.getTime();const n=Object.keys(s),r=Object.keys(e);if(n.length!==r.length)return!1;if(t.has(s)||t.has(e))return!0;t.add(s),t.add(e);for(const i of n){const o=s[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ei(o)&&ei(l)||As(o)&&As(l)||Array.isArray(o)&&Array.isArray(l)?!vr(o,l,t):o!==l)return!1}}return!0}var $C=(s,e,t,n,r)=>e?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[n]:r||!0}}:{},Ko=s=>Array.isArray(s)?s:[s],pp=()=>{let s=[];return{get observers(){return s},next:r=>{for(const i of s)i.next&&i.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(i=>i!==r)}}),unsubscribe:()=>{s=[]}}};function Yy(s,e){const t={};for(const n in s)if(s.hasOwnProperty(n)){const r=s[n],i=e[n];if(r&&As(r)&&i){const o=Yy(r,i);As(o)&&(t[n]=o)}else s[n]&&(t[n]=i)}return t}var sn=s=>As(s)&&!Object.keys(s).length,td=s=>s.type==="file",An=s=>typeof s=="function",Rl=s=>{if(!Jm)return!1;const e=s?s.ownerDocument:0;return s instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Gy=s=>s.type==="select-multiple",sd=s=>s.type==="radio",WC=s=>sd(s)||ka(s),Gc=s=>Rl(s)&&s.isConnected;function zC(s,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)s=Ns(s)?n++:s[e[n++]];return s}function KC(s){for(const e in s)if(s.hasOwnProperty(e)&&!Ns(s[e]))return!1;return!0}function ys(s,e){const t=Array.isArray(e)?e:mc(e)?[e]:ed(e),n=t.length===1?s:zC(s,t),r=t.length-1,i=t[r];return n&&delete n[i],r!==0&&(As(n)&&sn(n)||Array.isArray(n)&&KC(n))&&ys(s,t.slice(0,-1)),s}var QC=s=>{for(const e in s)if(An(s[e]))return!0;return!1};function Xy(s){return Array.isArray(s)||As(s)&&!QC(s)}function Hu(s,e={}){for(const t in s)Xy(s[t])?(e[t]=Array.isArray(s[t])?[]:{},Hu(s[t],e[t])):Xs(s[t])||(e[t]=!0);return e}function Fi(s,e,t){t||(t=Hu(e));for(const n in s)Xy(s[n])?Ns(e)||Uu(t[n])?t[n]=Hu(s[n],Array.isArray(s[n])?[]:{}):Fi(s[n],Xs(e)?{}:e[n],t[n]):t[n]=!vr(s[n],e[n]);return t}const hp={value:!1,isValid:!1},gp={value:!0,isValid:!0};var Jy=s=>{if(Array.isArray(s)){if(s.length>1){const e=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Ns(s[0].attributes.value)?Ns(s[0].value)||s[0].value===""?gp:{value:s[0].value,isValid:!0}:gp:hp}return hp},Zy=(s,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>Ns(s)?s:e?s===""?NaN:s&&+s:t&&cn(s)?new Date(s):n?n(s):s;const yp={isValid:!1,value:null};var eb=s=>Array.isArray(s)?s.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,yp):yp;function bp(s){const e=s.ref;return td(e)?e.files:sd(e)?eb(s.refs).value:Gy(e)?[...e.selectedOptions].map(({value:t})=>t):ka(e)?Jy(s.refs).value:Zy(Ns(e.value)?s.ref.value:e.value,s)}var YC=(s,e,t,n)=>{const r={};for(const i of s){const o=Pe(e,i);o&&ts(r,i,o._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:n}},Bl=s=>s instanceof RegExp,wo=s=>Ns(s)?s:Bl(s)?s.source:As(s)?Bl(s.value)?s.value.source:s.value:s,Np=s=>({isOnSubmit:!s||s===kn.onSubmit,isOnBlur:s===kn.onBlur,isOnChange:s===kn.onChange,isOnAll:s===kn.all,isOnTouch:s===kn.onTouched});const xp="AsyncFunction";var GC=s=>!!s&&!!s.validate&&!!(An(s.validate)&&s.validate.constructor.name===xp||As(s.validate)&&Object.values(s.validate).find(e=>e.constructor.name===xp)),XC=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),vp=(s,e,t)=>!t&&(e.watchAll||e.watch.has(s)||[...e.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const Qo=(s,e,t,n)=>{for(const r of t||Object.keys(s)){const i=Pe(s,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!n)return!0;if(o.ref&&e(o.ref,o.name)&&!n)return!0;if(Qo(l,e))break}else if(As(l)&&Qo(l,e))break}}};function _p(s,e,t){const n=Pe(s,t);if(n||mc(t))return{error:n,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Pe(e,i),l=Pe(s,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var JC=(s,e,t,n)=>{t(s);const{name:r,...i}=s;return sn(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!n||kn.all))},ZC=(s,e,t)=>!s||!e||s===e||Ko(s).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),e1=(s,e,t,n,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||s):(t?n.isOnBlur:r.isOnBlur)?!s:(t?n.isOnChange:r.isOnChange)?s:!0,t1=(s,e)=>!Zm(Pe(s,e)).length&&ys(s,e),s1=(s,e,t)=>{const n=Ko(Pe(s,t));return ts(n,"root",e[t]),ts(s,t,n),s};function Dp(s,e,t="validate"){if(cn(s)||Array.isArray(s)&&s.every(cn)||Bn(s)&&!s)return{type:t,message:cn(s)?s:"",ref:e}}var Pi=s=>As(s)&&!Bl(s)?s:{value:s,message:""},kp=async(s,e,t,n,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:b,validate:V,name:_,valueAsNumber:w,mount:B}=s._f,I=Pe(t,_);if(!B||e.has(_))return{};const F=l?l[0]:o,oe=S=>{r&&F.reportValidity&&(F.setCustomValidity(Bn(S)?"":S||""),F.reportValidity())},se={},M=sd(o),C=ka(o),x=M||C,E=(w||td(o))&&Ns(o.value)&&Ns(I)||Rl(o)&&o.value===""||I===""||Array.isArray(I)&&!I.length,j=$C.bind(null,_,n,se),L=(S,k,_e,Ue=Gn.maxLength,pe=Gn.minLength)=>{const je=S?k:_e;se[_]={type:S?Ue:pe,message:je,ref:o,...j(S?Ue:pe,je)}};if(i?!Array.isArray(I)||!I.length:u&&(!x&&(E||Xs(I))||Bn(I)&&!I||C&&!Jy(l).isValid||M&&!eb(l).isValid)){const{value:S,message:k}=cn(u)?{value:!!u,message:u}:Pi(u);if(S&&(se[_]={type:Gn.required,message:k,ref:F,...j(Gn.required,k)},!n))return oe(k),se}if(!E&&(!Xs(f)||!Xs(h))){let S,k;const _e=Pi(h),Ue=Pi(f);if(!Xs(I)&&!isNaN(I)){const pe=o.valueAsNumber||I&&+I;Xs(_e.value)||(S=pe>_e.value),Xs(Ue.value)||(k=pe<Ue.value)}else{const pe=o.valueAsDate||new Date(I),je=Ht=>new Date(new Date().toDateString()+" "+Ht),ft=o.type=="time",qt=o.type=="week";cn(_e.value)&&I&&(S=ft?je(I)>je(_e.value):qt?I>_e.value:pe>new Date(_e.value)),cn(Ue.value)&&I&&(k=ft?je(I)<je(Ue.value):qt?I<Ue.value:pe<new Date(Ue.value))}if((S||k)&&(L(!!S,_e.message,Ue.message,Gn.max,Gn.min),!n))return oe(se[_].message),se}if((m||d)&&!E&&(cn(I)||i&&Array.isArray(I))){const S=Pi(m),k=Pi(d),_e=!Xs(S.value)&&I.length>+S.value,Ue=!Xs(k.value)&&I.length<+k.value;if((_e||Ue)&&(L(_e,S.message,k.message),!n))return oe(se[_].message),se}if(b&&!E&&cn(I)){const{value:S,message:k}=Pi(b);if(Bl(S)&&!I.match(S)&&(se[_]={type:Gn.pattern,message:k,ref:o,...j(Gn.pattern,k)},!n))return oe(k),se}if(V){if(An(V)){const S=await V(I,t),k=Dp(S,F);if(k&&(se[_]={...k,...j(Gn.validate,k.message)},!n))return oe(k.message),se}else if(As(V)){let S={};for(const k in V){if(!sn(S)&&!n)break;const _e=Dp(await V[k](I,t),F,k);_e&&(S={..._e,...j(k,_e.message)},oe(_e.message),n&&(se[_]=S))}if(!sn(S)&&(se[_]={ref:F,...S},!n))return se}}return oe(!0),se};const n1={mode:kn.onSubmit,reValidateMode:kn.onChange,shouldFocusError:!0};function r1(s={}){let e={...n1,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:An(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},r=As(e.defaultValues)||As(e.values)?Is(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Is(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:pp(),state:pp()},b=e.criteriaMode===kn.all,V=P=>O=>{clearTimeout(m),m=setTimeout(P,O)},_=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const O=e.resolver?sn((await C()).errors):await E(n,!0);O!==t.isValid&&h.state.next({isValid:O})}},w=(P,O)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(J=>{J&&(O?ts(t.validatingFields,J,O):ys(t.validatingFields,J))}),h.state.next({validatingFields:t.validatingFields,isValidating:!sn(t.validatingFields)}))},B=(P,O=[],J,ye,ue=!0,fe=!0)=>{if(ye&&J&&!e.disabled){if(o.action=!0,fe&&Array.isArray(Pe(n,P))){const Ce=J(Pe(n,P),ye.argA,ye.argB);ue&&ts(n,P,Ce)}if(fe&&Array.isArray(Pe(t.errors,P))){const Ce=J(Pe(t.errors,P),ye.argA,ye.argB);ue&&ts(t.errors,P,Ce),t1(t.errors,P)}if((d.touchedFields||f.touchedFields)&&fe&&Array.isArray(Pe(t.touchedFields,P))){const Ce=J(Pe(t.touchedFields,P),ye.argA,ye.argB);ue&&ts(t.touchedFields,P,Ce)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=Fi(r,i)),h.state.next({name:P,isDirty:L(P,O),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ts(i,P,O)},I=(P,O)=>{ts(t.errors,P,O),h.state.next({errors:t.errors})},F=P=>{t.errors=P,h.state.next({errors:t.errors,isValid:!1})},oe=(P,O,J,ye)=>{const ue=Pe(n,P);if(ue){const fe=Pe(i,P,Ns(J)?Pe(r,P):J);Ns(fe)||ye&&ye.defaultChecked||O?ts(i,P,O?fe:bp(ue._f)):_e(P,fe),o.mount&&_()}},se=(P,O,J,ye,ue)=>{let fe=!1,Ce=!1;const Me={name:P};if(!e.disabled){if(!J||ye){(d.isDirty||f.isDirty)&&(Ce=t.isDirty,t.isDirty=Me.isDirty=L(),fe=Ce!==Me.isDirty);const et=vr(Pe(r,P),O);Ce=!!Pe(t.dirtyFields,P),et?ys(t.dirtyFields,P):ts(t.dirtyFields,P,!0),Me.dirtyFields=t.dirtyFields,fe=fe||(d.dirtyFields||f.dirtyFields)&&Ce!==!et}if(J){const et=Pe(t.touchedFields,P);et||(ts(t.touchedFields,P,J),Me.touchedFields=t.touchedFields,fe=fe||(d.touchedFields||f.touchedFields)&&et!==J)}fe&&ue&&h.state.next(Me)}return fe?Me:{}},M=(P,O,J,ye)=>{const ue=Pe(t.errors,P),fe=(d.isValid||f.isValid)&&Bn(O)&&t.isValid!==O;if(e.delayError&&J?(u=V(()=>I(P,J)),u(e.delayError)):(clearTimeout(m),u=null,J?ts(t.errors,P,J):ys(t.errors,P)),(J?!vr(ue,J):ue)||!sn(ye)||fe){const Ce={...ye,...fe&&Bn(O)?{isValid:O}:{},errors:t.errors,name:P};t={...t,...Ce},h.state.next(Ce)}},C=async P=>{w(P,!0);const O=await e.resolver(i,e.context,YC(P||l.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return w(P),O},x=async P=>{const{errors:O}=await C(P);if(P)for(const J of P){const ye=Pe(O,J);ye?ts(t.errors,J,ye):ys(t.errors,J)}else t.errors=O;return O},E=async(P,O,J={valid:!0})=>{for(const ye in P){const ue=P[ye];if(ue){const{_f:fe,...Ce}=ue;if(fe){const Me=l.array.has(fe.name),et=ue._f&&GC(ue._f);et&&d.validatingFields&&w([fe.name],!0);const Ae=await kp(ue,l.disabled,i,b,e.shouldUseNativeValidation&&!O,Me);if(et&&d.validatingFields&&w([fe.name]),Ae[fe.name]&&(J.valid=!1,O))break;!O&&(Pe(Ae,fe.name)?Me?s1(t.errors,Ae,fe.name):ts(t.errors,fe.name,Ae[fe.name]):ys(t.errors,fe.name))}!sn(Ce)&&await E(Ce,O,J)}}return J.valid},j=()=>{for(const P of l.unMount){const O=Pe(n,P);O&&(O._f.refs?O._f.refs.every(J=>!Gc(J)):!Gc(O._f.ref))&&it(P)}l.unMount=new Set},L=(P,O)=>!e.disabled&&(P&&O&&ts(i,P,O),!vr(Ht(),r)),S=(P,O,J)=>qC(P,l,{...o.mount?i:Ns(O)?r:cn(P)?{[P]:O}:O},J,O),k=P=>Zm(Pe(o.mount?i:r,P,e.shouldUnregister?Pe(r,P,[]):[])),_e=(P,O,J={})=>{const ye=Pe(n,P);let ue=O;if(ye){const fe=ye._f;fe&&(!fe.disabled&&ts(i,P,Zy(O,fe)),ue=Rl(fe.ref)&&Xs(O)?"":O,Gy(fe.ref)?[...fe.ref.options].forEach(Ce=>Ce.selected=ue.includes(Ce.value)):fe.refs?ka(fe.ref)?fe.refs.forEach(Ce=>{(!Ce.defaultChecked||!Ce.disabled)&&(Array.isArray(ue)?Ce.checked=!!ue.find(Me=>Me===Ce.value):Ce.checked=ue===Ce.value||!!ue)}):fe.refs.forEach(Ce=>Ce.checked=Ce.value===ue):td(fe.ref)?fe.ref.value="":(fe.ref.value=ue,fe.ref.type||h.state.next({name:P,values:Is(i)})))}(J.shouldDirty||J.shouldTouch)&&se(P,ue,J.shouldTouch,J.shouldDirty,!0),J.shouldValidate&&qt(P)},Ue=(P,O,J)=>{for(const ye in O){if(!O.hasOwnProperty(ye))return;const ue=O[ye],fe=P+"."+ye,Ce=Pe(n,fe);(l.array.has(P)||As(ue)||Ce&&!Ce._f)&&!ei(ue)?Ue(fe,ue,J):_e(fe,ue,J)}},pe=(P,O,J={})=>{const ye=Pe(n,P),ue=l.array.has(P),fe=Is(O);ts(i,P,fe),ue?(h.array.next({name:P,values:Is(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&J.shouldDirty&&h.state.next({name:P,dirtyFields:Fi(r,i),isDirty:L(P,fe)})):ye&&!ye._f&&!Xs(fe)?Ue(P,fe,J):_e(P,fe,J),vp(P,l)&&h.state.next({...t,name:P}),h.state.next({name:o.mount?P:void 0,values:Is(i)})},je=async P=>{o.mount=!0;const O=P.target;let J=O.name,ye=!0;const ue=Pe(n,J),fe=et=>{ye=Number.isNaN(et)||ei(et)&&isNaN(et.getTime())||vr(et,Pe(i,J,et))},Ce=Np(e.mode),Me=Np(e.reValidateMode);if(ue){let et,Ae;const Rs=O.type?bp(ue._f):RC(P),jt=P.type===fp.BLUR||P.type===fp.FOCUS_OUT,ee=!XC(ue._f)&&!e.resolver&&!Pe(t.errors,J)&&!ue._f.deps||e1(jt,Pe(t.touchedFields,J),t.isSubmitted,Me,Ce),Ge=vp(J,l,jt);ts(i,J,Rs),jt?(!O||!O.readOnly)&&(ue._f.onBlur&&ue._f.onBlur(P),u&&u(0)):ue._f.onChange&&ue._f.onChange(P);const H=se(J,Rs,jt),be=!sn(H)||Ge;if(!jt&&h.state.next({name:J,type:P.type,values:Is(i)}),ee)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?jt&&_():jt||_()),be&&h.state.next({name:J,...Ge?{}:H});if(!jt&&Ge&&h.state.next({...t}),e.resolver){const{errors:De}=await C([J]);if(fe(Rs),ye){const Ie=_p(t.errors,n,J),me=_p(De,n,Ie.name||J);et=me.error,J=me.name,Ae=sn(De)}}else w([J],!0),et=(await kp(ue,l.disabled,i,b,e.shouldUseNativeValidation))[J],w([J]),fe(Rs),ye&&(et?Ae=!1:(d.isValid||f.isValid)&&(Ae=await E(n,!0)));ye&&(ue._f.deps&&(!Array.isArray(ue._f.deps)||ue._f.deps.length>0)&&qt(ue._f.deps),M(J,Ae,et,H))}},ft=(P,O)=>{if(Pe(t.errors,O)&&P.focus)return P.focus(),1},qt=async(P,O={})=>{let J,ye;const ue=Ko(P);if(e.resolver){const fe=await x(Ns(P)?P:ue);J=sn(fe),ye=P?!ue.some(Ce=>Pe(fe,Ce)):J}else P?(ye=(await Promise.all(ue.map(async fe=>{const Ce=Pe(n,fe);return await E(Ce&&Ce._f?{[fe]:Ce}:Ce)}))).every(Boolean),!(!ye&&!t.isValid)&&_()):ye=J=await E(n);return h.state.next({...!cn(P)||(d.isValid||f.isValid)&&J!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:J}:{},errors:t.errors}),O.shouldFocus&&!ye&&Qo(n,ft,P?ue:l.mount),ye},Ht=(P,O)=>{let J={...o.mount?i:r};return O&&(J=Yy(O.dirtyFields?t.dirtyFields:t.touchedFields,J)),Ns(P)?J:cn(P)?Pe(J,P):P.map(ye=>Pe(J,ye))},ae=(P,O)=>({invalid:!!Pe((O||t).errors,P),isDirty:!!Pe((O||t).dirtyFields,P),error:Pe((O||t).errors,P),isValidating:!!Pe(t.validatingFields,P),isTouched:!!Pe((O||t).touchedFields,P)}),He=P=>{P&&Ko(P).forEach(O=>ys(t.errors,O)),h.state.next({errors:P?t.errors:{}})},de=(P,O,J)=>{const ye=(Pe(n,P,{_f:{}})._f||{}).ref,ue=Pe(t.errors,P)||{},{ref:fe,message:Ce,type:Me,...et}=ue;ts(t.errors,P,{...et,...O,ref:ye}),h.state.next({name:P,errors:t.errors,isValid:!1}),J&&J.shouldFocus&&ye&&ye.focus&&ye.focus()},Le=(P,O)=>An(P)?h.state.subscribe({next:J=>"values"in J&&P(S(void 0,O),J)}):S(P,O,!0),ze=P=>h.state.subscribe({next:O=>{ZC(P.name,O.name,P.exact)&&JC(O,P.formState||d,Tt,P.reRenderRoot)&&P.callback({values:{...i},...t,...O,defaultValues:r})}}).unsubscribe,bt=P=>(o.mount=!0,f={...f,...P.formState},ze({...P,formState:f})),it=(P,O={})=>{for(const J of P?Ko(P):l.mount)l.mount.delete(J),l.array.delete(J),O.keepValue||(ys(n,J),ys(i,J)),!O.keepError&&ys(t.errors,J),!O.keepDirty&&ys(t.dirtyFields,J),!O.keepTouched&&ys(t.touchedFields,J),!O.keepIsValidating&&ys(t.validatingFields,J),!e.shouldUnregister&&!O.keepDefaultValue&&ys(r,J);h.state.next({values:Is(i)}),h.state.next({...t,...O.keepDirty?{isDirty:L()}:{}}),!O.keepIsValid&&_()},St=({disabled:P,name:O})=>{(Bn(P)&&o.mount||P||l.disabled.has(O))&&(P?l.disabled.add(O):l.disabled.delete(O))},st=(P,O={})=>{let J=Pe(n,P);const ye=Bn(O.disabled)||Bn(e.disabled);return ts(n,P,{...J||{},_f:{...J&&J._f?J._f:{ref:{name:P}},name:P,mount:!0,...O}}),l.mount.add(P),J?St({disabled:Bn(O.disabled)?O.disabled:e.disabled,name:P}):oe(P,!0,O.value),{...ye?{disabled:O.disabled||e.disabled}:{},...e.progressive?{required:!!O.required,min:wo(O.min),max:wo(O.max),minLength:wo(O.minLength),maxLength:wo(O.maxLength),pattern:wo(O.pattern)}:{},name:P,onChange:je,onBlur:je,ref:ue=>{if(ue){st(P,O),J=Pe(n,P);const fe=Ns(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,Ce=WC(fe),Me=J._f.refs||[];if(Ce?Me.find(et=>et===fe):fe===J._f.ref)return;ts(n,P,{_f:{...J._f,...Ce?{refs:[...Me.filter(Gc),fe,...Array.isArray(Pe(r,P))?[{}]:[]],ref:{type:fe.type,name:P}}:{ref:fe}}}),oe(P,!1,void 0,fe)}else J=Pe(n,P,{}),J._f&&(J._f.mount=!1),(e.shouldUnregister||O.shouldUnregister)&&!(UC(l.array,P)&&o.action)&&l.unMount.add(P)}}},ut=()=>e.shouldFocusError&&Qo(n,ft,l.mount),ms=P=>{Bn(P)&&(h.state.next({disabled:P}),Qo(n,(O,J)=>{const ye=Pe(n,J);ye&&(O.disabled=ye._f.disabled||P,Array.isArray(ye._f.refs)&&ye._f.refs.forEach(ue=>{ue.disabled=ye._f.disabled||P}))},0,!1))},Q=(P,O)=>async J=>{let ye;J&&(J.preventDefault&&J.preventDefault(),J.persist&&J.persist());let ue=Is(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:Ce}=await C();t.errors=fe,ue=Is(Ce)}else await E(n);if(l.disabled.size)for(const fe of l.disabled)ys(ue,fe);if(ys(t.errors,"root"),sn(t.errors)){h.state.next({errors:{}});try{await P(ue,J)}catch(fe){ye=fe}}else O&&await O({...t.errors},J),ut(),setTimeout(ut);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:sn(t.errors)&&!ye,submitCount:t.submitCount+1,errors:t.errors}),ye)throw ye},Te=(P,O={})=>{Pe(n,P)&&(Ns(O.defaultValue)?pe(P,Is(Pe(r,P))):(pe(P,O.defaultValue),ts(r,P,Is(O.defaultValue))),O.keepTouched||ys(t.touchedFields,P),O.keepDirty||(ys(t.dirtyFields,P),t.isDirty=O.defaultValue?L(P,Is(Pe(r,P))):L()),O.keepError||(ys(t.errors,P),d.isValid&&_()),h.state.next({...t}))},Re=(P,O={})=>{const J=P?Is(P):r,ye=Is(J),ue=sn(P),fe=ue?r:ye;if(O.keepDefaultValues||(r=J),!O.keepValues){if(O.keepDirtyValues){const Ce=new Set([...l.mount,...Object.keys(Fi(r,i))]);for(const Me of Array.from(Ce))Pe(t.dirtyFields,Me)?ts(fe,Me,Pe(i,Me)):pe(Me,Pe(fe,Me))}else{if(Jm&&Ns(P))for(const Ce of l.mount){const Me=Pe(n,Ce);if(Me&&Me._f){const et=Array.isArray(Me._f.refs)?Me._f.refs[0]:Me._f.ref;if(Rl(et)){const Ae=et.closest("form");if(Ae){Ae.reset();break}}}}if(O.keepFieldsRef)for(const Ce of l.mount)pe(Ce,Pe(fe,Ce));else n={}}i=e.shouldUnregister?O.keepDefaultValues?Is(r):{}:Is(fe),h.array.next({values:{...fe}}),h.state.next({values:{...fe}})}l={mount:O.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!O.keepIsValid||!!O.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:O.keepSubmitCount?t.submitCount:0,isDirty:ue?!1:O.keepDirty?t.isDirty:!!(O.keepDefaultValues&&!vr(P,r)),isSubmitted:O.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ue?{}:O.keepDirtyValues?O.keepDefaultValues&&i?Fi(r,i):t.dirtyFields:O.keepDefaultValues&&P?Fi(r,P):O.keepDirty?t.dirtyFields:{},touchedFields:O.keepTouched?t.touchedFields:{},errors:O.keepErrors?t.errors:{},isSubmitSuccessful:O.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},we=(P,O)=>Re(An(P)?P(i):P,O),Ye=(P,O={})=>{const J=Pe(n,P),ye=J&&J._f;if(ye){const ue=ye.refs?ye.refs[0]:ye.ref;ue.focus&&(ue.focus(),O.shouldSelect&&An(ue.select)&&ue.select())}},Tt=P=>{t={...t,...P}},ct={control:{register:st,unregister:it,getFieldState:ae,handleSubmit:Q,setError:de,_subscribe:ze,_runSchema:C,_focusError:ut,_getWatch:S,_getDirty:L,_setValid:_,_setFieldArray:B,_setDisabledField:St,_setErrors:F,_getFieldArray:k,_reset:Re,_resetDefaultValues:()=>An(e.defaultValues)&&e.defaultValues().then(P=>{we(P,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:ms,_subjects:h,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:bt,trigger:qt,register:st,handleSubmit:Q,watch:Le,setValue:pe,getValues:Ht,reset:we,resetField:Te,clearErrors:He,unregister:it,setError:de,setFocus:Ye,getFieldState:ae};return{...ct,formControl:ct}}function nd(s={}){const e=lt.useRef(void 0),t=lt.useRef(void 0),[n,r]=lt.useState({isDirty:!1,isValidating:!1,isLoading:An(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:An(s.defaultValues)?void 0:s.defaultValues});if(!e.current)if(s.formControl)e.current={...s.formControl,formState:n},s.defaultValues&&!An(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...l}=r1(s);e.current={...l,formState:n}}const i=e.current.control;return i._options=s,FC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),lt.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),lt.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),lt.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),lt.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),lt.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),lt.useEffect(()=>{s.values&&!vr(s.values,t.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=s.values,r(o=>({...o}))):i._resetDefaultValues()},[i,s.values]),lt.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=OC(n,i),e.current}const Ap=["","","","","","",""],tb=({event:s,slotInfo:e,defaultProjectName:t,onClose:n,onSave:r,onDelete:i})=>{const[o,l]=A.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:b}=nd({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:V}=tr(),[_,w]=A.useState([]),[B,I]=A.useState(""),[F,oe]=A.useState(!1),[se,M]=A.useState(""),[C,x]=A.useState(9),[E,j]=A.useState(0),[L,S]=A.useState(""),k=f("projectId");A.useEffect(()=>{if(k){const ae=V.find(He=>He.id===k||He.id===parseInt(k)||He.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",_)}},[k,V,_]),A.useEffect(()=>{console.log(" Modal mount - initializing states"),w([]),S(""),I("")},[]),A.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!s,eventId:s==null?void 0:s.id,hasSlotInfo:!!e,hasMergedEvents:!!(s!=null&&s.mergedEventIds)}),s&&s.id){console.log(" ScheduleModal processing event:",{title:s.title,projectId:s.projectId,projectName:s.projectName,start:s.start,assignedTo:s.assignedTo,time:s.time});const ae=s.originalTitle||s.title,He=/ - (|) \d{1,2}$/,de=ae.replace(He,"");if(d("title",de,{shouldValidate:!1,shouldDirty:!1}),d("date",Ft(s.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",s.description||"",{shouldValidate:!1,shouldDirty:!1}),s.projectId&&s.projectId!==""&&s.projectId!=="undefined")console.log(" Setting projectId from event:",s.projectId),d("projectId",s.projectId,{shouldValidate:!1,shouldDirty:!1}),S("");else if(s.projectName){const ze=V.find(bt=>bt.name===s.projectName);console.log(" Finding project by name:",s.projectName,"found:",ze),ze?(console.log(" Setting projectId from found project:",ze.id),d("projectId",ze.id,{shouldValidate:!1,shouldDirty:!1}),S("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),S(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),S("");const Le=s.assignedTo||s.attendees||[];if(console.log(" Setting selectedMembers to:",Le),w(Array.isArray(Le)?Le:[]),s.time&&s.time!=="-"){console.log(" Setting time from event:",{eventTime:s.time,parsedHours:s.time.split(":")[0],parsedMinutes:s.time.split(":")[1]}),oe(!0);const[ze,bt]=s.time.split(":"),it=parseInt(ze,10),St=parseInt(bt,10);it>=12?(M(""),x(it===12?12:it-12)):(M(""),x(it===0?12:it)),j(St),console.log(" Time state set:",{hasTime:!0,period:it>=12?"":"",hour:it>=12?it===12?12:it-12:it===0?12:it,minute:St})}else console.log(" No time in event, setting hasTime to false"),oe(!1),M(""),x(9),j(0)}else if(e&&!s&&(console.log(" New schedule from slot:",e),b({projectId:"",title:"",date:Ft(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),w([]),S(""),t)){const ae=V.find(He=>He.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[s==null?void 0:s.id]);const _e=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",_),w(He=>{console.log(" Previous members in setState:",He);const de=He.includes(ae)?He.filter(Le=>Le!==ae):[...He,ae];return console.log(" Updated members after toggle:",de),de})},Ue=()=>{const ae="HV LAB";_.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He.filter(de=>de!==""),ae])},pe=()=>{const ae="";_.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He,ae])},je=()=>{const ae="";_.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He,ae])},ft=()=>{B.trim()&&!_.includes(B.trim())&&(w(ae=>[...ae,B.trim()]),I(""))},qt=ae=>{w(He=>He.filter(de=>de!==ae))},Ht=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",_),console.log(" hasTime state:",F),console.log(" timePeriod:",se,"timeHour:",C,"timeMinute:",E),console.log(" Available projects:",V.map(st=>({id:st.id,name:st.name,idType:typeof st.id}))),console.log(" Merged event IDs:",s==null?void 0:s.mergedEventIds);const He=/ - (|) \d{1,2}$/,de=ae.title.replace(He,"").trim();let Le="",ze="";if(ae.projectId){const st=V.find(ut=>ut.id===ae.projectId||ut.id===parseInt(ae.projectId)||ut.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",st),Le=(st==null?void 0:st.name)||"",ze=ae.projectId}else Le="",ze="";console.log(" Final projectId:",ze,"projectName:",Le,"cleanedTitle:",de);const bt=new Date(ae.date);let it="-";if(F){let st=C;se===""&&C!==12?st=C+12:se===""&&C===12&&(st=0),it=`${st.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`,console.log(" Time calculated:",it)}else console.log(" No time set (hasTime is false)");const St={...s,title:de,start:bt,end:bt,projectId:ze,projectName:Le,assignedTo:_,description:ae.description||"",time:it,mergedEventIds:s==null?void 0:s.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",St);try{await r(St),console.log(" onSave completed successfully")}catch(st){throw console.error(" onSave failed:",st),st}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",_),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ht),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),V.filter(ae=>s!=null&&s.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>oe(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${se===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${se===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:C,onChange:ae=>x(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:E,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:Ue,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:pe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:je,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Ap.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>_e(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),_.filter(ae=>!Ap.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>qt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>I(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ft())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ft,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:s&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(s.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(ii,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:n,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Mu=s=>{if(!s||s==="-")return"";const[e,t]=s.split(":"),n=parseInt(e,10),r=parseInt(t,10),i=n>=12?"":"",o=n%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},Ul=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Yo=s=>{if(!s)return s;const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Ul)if(n===r)return t.slice(0,-1).join(" ").trim()}for(const n of Ul)if(e.endsWith(n))return e.substring(0,e.length-n.length).trim()||e;return e},Qa=s=>{const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Ul)if(n===r)return r}for(const n of Ul)if(e.endsWith(n))return n;return""},i1=["","","","","","",""],o1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Xc=["","","/","","","","","","","","","","","","",""],a1={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},l1={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Ep=i1,c1=()=>{const{schedules:s,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:n}=tr(),{user:r}=Mr(),[i,o]=A.useState(!1);A.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Ep.filter(d=>d!==l)]:Ep,m=d=>{const f=s.filter(_=>_.attendees?!!(_.attendees.includes(d)||_.attendees.includes("HV LAB")&&d!==""||_.attendees.includes("")&&["",""].includes(d)||_.attendees.includes("")&&["","",""].includes(d)):!1),h=_=>{const w=new Set;return _.filter(B=>{const F=`${Ft(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return w.has(F)?!1:(w.add(F),!0)})},b=h(f.filter(_=>Ld(new Date(_.start)))),V=h(f.filter(_=>BN(new Date(_.start))&&!Ld(new Date(_.start))).sort((_,w)=>new Date(_.start).getTime()-new Date(w.start).getTime())).slice(0,3);return{todaySchedules:b,upcomingSchedules:V,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),b=f.length+h.length,V=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${V?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),V&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[V&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV($i,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${V&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Kp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const _=f.reduce((w,B)=>{const I=B.project||"-";return w[I]||(w[I]=[]),w[I].push(B),w},{});return Object.entries(_).map(([w,B])=>{const I=d===l;return a.jsxDEV("div",{className:`border-l-3 ${I?"border-gray-400":"border-gray-900"} ${I?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${I?"bg-amber-100":"bg-gray-100"} border-b ${I?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(F=>{const oe=F.time&&F.time!=="-"?` - ${Mu(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,oe]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},w,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(AN,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const _=h.reduce((w,B)=>{const I=Ft(new Date(B.start),"MM.dd",{locale:xs}),F=B.project||"-",oe=`${I}|${F}`;return w[oe]||(w[oe]={date:I,project:F,schedules:[]}),w[oe].schedules.push(B),w},{});return Object.values(_).map(({date:w,project:B,schedules:I})=>{const oe=I.length>0&&RN(new Date(I[0].start))?`${w} ()`:w;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:oe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:I.map(se=>{const M=se.time&&se.time!=="-"?` - ${Mu(se.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",se.title,M]},se.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${w}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),b===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&a.jsxDEV(tb,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await n(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},dc=()=>{const{user:s}=Mr(),{projects:e}=tr();return A.useMemo(()=>s?s.name===""?e.filter(n=>{const i=(n.manager?n.manager.split(",").map(l=>l.trim()):[]).includes(""),o=n.team&&Array.isArray(n.team)&&n.team.includes("");return i||o}):e:[],[s,e])},u1=({value:s,detailValue:e="",onChange:t,onDetailChange:n,placeholder:r=" ",error:i})=>{const[o,l]=A.useState(!1),[u,m]=A.useState(s),[d,f]=A.useState(e),h=A.useRef(null);A.useEffect(()=>{const B=I=>{h.current&&!h.current.contains(I.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),A.useEffect(()=>{m(s)},[s]),A.useEffect(()=>{f(e)},[e]);const b=()=>new Promise((B,I)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>B(!0),F.onerror=()=>I(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),V=B=>{const I=B.roadAddr||B.jibunAddr;m(I),t(I,d),l(!1)},_=B=>{const I=B.target.value;f(I),n&&n(I),u&&t(u,I)},w=async()=>{try{(!window.daum||!window.daum.Postcode)&&await b(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const I={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};V(I)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>w(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Qp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:_,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},Cp=["","","","","","",""],m1=({project:s,onClose:e,onSave:t})=>{const{register:n,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=nd({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=A.useState([]),[d,f]=A.useState(""),[h,b]=A.useState(""),[V,_]=A.useState(""),[w,B]=A.useState(!1);A.useEffect(()=>{var M;if(s){const C=s.location?s.location.split(","):["",""],x=((M=C[0])==null?void 0:M.trim())||s.location||"",E=C.length>1?C.slice(1).join(",").trim():"";o({name:s.name,client:s.client||"",location:x,detailLocation:E,startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:""}),b(x),_(E);const j=s.manager?s.manager.split(",").map(L=>L.trim()).filter(L=>L&&L!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),b(""),_(""),m([])},[s,o]);const I=M=>{m(C=>C.includes(M)?C.filter(x=>x!==M):[...C,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},oe=M=>{m(C=>C.filter(x=>x!==M))},se=async M=>{if(w)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const C=h&&V?`${h}, ${V}`:h||M.location,x={name:M.name,client:M.client,location:C,manager:u.join(", "),contractAmount:(s==null?void 0:s.contractAmount)??0,spent:(s==null?void 0:s.spent)??0,status:(s==null?void 0:s.status)??"planning",progress:(s==null?void 0:s.progress)??0,description:(s==null?void 0:s.description)??"",meetingNotes:(s==null?void 0:s.meetingNotes)??[],customerRequests:(s==null?void 0:s.customerRequests)??[],entrancePassword:(s==null?void 0:s.entrancePassword)??"",sitePassword:(s==null?void 0:s.sitePassword)??""};if(M.startDate&&M.startDate!=="")x.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(s!=null&&s.startDate){const E=typeof s.startDate=="string"&&s.startDate.includes("T")?s.startDate.split("T")[0]:s.startDate;x.startDate=E,console.log(" Keeping existing startDate:",x.startDate)}if(M.endDate&&M.endDate!=="")x.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(s!=null&&s.endDate){const E=typeof s.endDate=="string"&&s.endDate.includes("T")?s.endDate.split("T")[0]:s.endDate;x.endDate=E,console.log(" Keeping existing endDate:",x.endDate)}console.log(" ProjectModal onSubmit - Final formData:",x);try{await t(x)}catch(E){throw B(!1),E}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(se),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...n("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...n("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(u1,{value:h,detailValue:V,onChange:(M,C)=>{b(M),_(C||""),i("location",M),i("detailLocation",C||"")},onDetailChange:M=>{_(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...n("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...n("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[Cp.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>I(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!Cp.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>oe(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:w,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:w?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},d1=({projectName:s,meetingNotes:e,onClose:t,onSave:n,onDelete:r})=>{const[i,o]=A.useState(""),[l,u]=A.useState(new Date().toISOString().split("T")[0]),[m,d]=A.useState(!1),[f,h]=A.useState(!1),b=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},V=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await n(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},_=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},w=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:b,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:V,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:_,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ft(new Date(B.date),"yyyy.MM.dd (eee)",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>w(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},f1=({projectName:s,customerRequests:e,onClose:t,onSave:n,onToggleComplete:r,onDelete:i})=>{const[o,l]=A.useState(""),[u,m]=A.useState(new Date().toISOString().split("T")[0]),[d,f]=A.useState(!1),[h,b]=A.useState(!1),V=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},_=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}b(!0);try{await n(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{b(!1)}}},w=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=se=>{window.confirm("  ?")&&i(se)},I=se=>{r(se)},F=e.filter(se=>!se.completed),oe=e.filter(se=>se.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:se=>se.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:V,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:se=>m(se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:se=>l(se.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:_,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:w,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(se=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>I(se.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(EN,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:se.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ft(new Date(se.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(se.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},se.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),oe.map(se=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>I(se.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(CN,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:se.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ft(new Date(se.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(se.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},se.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},p1=({projectName:s,entrancePassword:e,sitePassword:t,onClose:n,onSave:r})=>{const[i,o]=A.useState(e||""),[l,u]=A.useState(t||""),[m,d]=A.useState(!1),[f,h]=A.useState(!1),b=()=>{d(!0)},V=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},_=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:w=>w.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:V,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:_,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},h1=({projectName:s,onClose:e})=>{var o;const[t,n]=A.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>n({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>n({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>n({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>n({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>n({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>n({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&n({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>n({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ft(new Date(t.startDate),"yyyy",{locale:xs}),"",Ft(new Date(t.startDate),"MM",{locale:xs}),"",Ft(new Date(t.startDate),"dd",{locale:xs})," ~ ",Ft(new Date(t.endDate),"yyyy",{locale:xs}),"",Ft(new Date(t.endDate),"MM",{locale:xs}),"",Ft(new Date(t.endDate),"dd",{locale:xs})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},g1=()=>{const{loadProjectsFromAPI:s,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:n}=tr(),{user:r}=Mr(),i=dc(),[o,l]=A.useState("in-progress"),[u,m]=A.useState("grid"),[d,f]=A.useState(!1),[h,b]=A.useState(null),[V,_]=A.useState(!1),[w,B]=A.useState(!1),[I,F]=A.useState(!1),[oe,se]=A.useState(!1),[M,C]=A.useState(null),x=(Q,Te)=>`lastViewed_${r==null?void 0:r.id}_${Q}_${Te}`,E=(Q,Te)=>{const Re=x(Q,Te),we=localStorage.getItem(Re);return we?parseInt(we,10):0},j=(Q,Te)=>{const Re=x(Q,Te);localStorage.setItem(Re,Date.now().toString())},L=(Q,Te)=>{const Re=E(Q.id,Te);return Te==="meeting"?(Q.meetingNotes||[]).some(Ye=>(Ye.createdAt?new Date(Ye.createdAt).getTime():new Date(Ye.date).getTime())>Re):(Q.customerRequests||[]).some(Ye=>!Ye.completed)};A.useEffect(()=>{s().catch(Q=>{console.error("Failed to load projects:",Q),ne.error("   ")})},[s]),A.useEffect(()=>{const Q=()=>{b(null),f(!0)};return window.addEventListener("headerAddButtonClick",Q),()=>window.removeEventListener("headerAddButtonClick",Q)},[]);const S=(Q,Te)=>{if(!Q||!Te)return 0;const Re=new Date,we=new Date(Q),Ye=new Date(Te);if(Re<we)return 0;if(Re>Ye)return 100;const Tt=Math.ceil((Ye.getTime()-we.getTime())/(1e3*60*60*24)),$t=Math.ceil((Re.getTime()-we.getTime())/(1e3*60*60*24)),ct=Math.round($t/Tt*100);return Math.min(100,Math.max(0,ct))},k=Q=>{b(Q),f(!0)},_e=async(Q,Te)=>{if(window.confirm(`"${Te}"  ?

    .`))try{await n(Q),ne.success(" ")}catch(Re){console.error("Failed to delete project:",Re),ne.error("  ")}},Ue=async Q=>{try{if(h)await t(h.id,Q),ne.success(" ");else{const Te={id:"",...Q,team:Q.team||[]};await e(Te),ne.success(" "),l(Q.status||"planning")}f(!1),b(null)}catch(Te){console.error("Failed to save project:",Te),ne.error("  ")}},pe=async(Q,Te)=>{try{await t(Q,{status:Te}),ne.success(" ")}catch(Re){console.error("Failed to update project status:",Re),ne.error("  ")}},je=Q=>{C(Q),_(!0),j(Q.id,"meeting")},ft=Q=>{C(Q),B(!0),j(Q.id,"request")},qt=Q=>{C(Q),F(!0)},Ht=Q=>{C(Q),se(!0)},ae=async(Q,Te)=>{if(!M)return;const Re=M.entrancePassword,we=M.sitePassword;C({...M,entrancePassword:Q,sitePassword:Te});try{await t(M.id,{entrancePassword:Q,sitePassword:Te}),ne.success(" ")}catch(Ye){console.error("Failed to save passwords:",Ye),ne.error("  "),C({...M,entrancePassword:Re,sitePassword:we})}},He=async(Q,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:Q,date:Te,createdAt:new Date},we=[...M.meetingNotes||[],Re];C({...M,meetingNotes:we});try{await t(M.id,{meetingNotes:we}),ne.success("  ")}catch(Ye){console.error("Failed to save meeting note:",Ye),ne.error("   "),C({...M,meetingNotes:M.meetingNotes||[]})}},de=async(Q,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:Q,completed:!1,createdAt:Te},we=[...M.customerRequests||[],Re];C({...M,customerRequests:we});try{await t(M.id,{customerRequests:we}),ne.success("  ")}catch(Ye){console.error("Failed to save customer request:",Ye),ne.error("   "),C({...M,customerRequests:M.customerRequests||[]})}},Le=async Q=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.map(we=>we.id===Q?{...we,completed:!we.completed}:we);C({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ne.success("  ")}catch(we){console.error("Failed to toggle request:",we),ne.error("  "),C({...M,customerRequests:Te})}},ze=async Q=>{if(!M)return;const Te=M.meetingNotes||[],Re=Te.filter(we=>we.id!==Q);C({...M,meetingNotes:Re});try{await t(M.id,{meetingNotes:Re}),ne.success("  ")}catch(we){console.error("Failed to delete meeting note:",we),ne.error(" "),C({...M,meetingNotes:Te})}},bt=async Q=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.filter(we=>we.id!==Q);C({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ne.success("  ")}catch(we){console.error("Failed to delete customer request:",we),ne.error(" "),C({...M,customerRequests:Te})}},it=({project:Q})=>{const Re={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[Q.status];return a.jsxDEV("select",{value:Q.status,onChange:we=>pe(Q.id,we.target.value),className:_n("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Re.color),onClick:we=>we.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},st=(()=>{let Q=i;return o!=="all"&&(Q=Q.filter(Te=>Te.status===o)),r!=null&&r.name&&(Q=[...Q].sort((Te,Re)=>{var Tt,$t;const we=Te.manager===r.name||((Tt=Te.team)==null?void 0:Tt.includes(r.name)),Ye=Re.manager===r.name||(($t=Re.team)==null?void 0:$t.includes(r.name));return we&&!Ye?-1:!we&&Ye?1:0})),Q})(),ut={planning:i.filter(Q=>Q.status==="planning").length,inProgress:i.filter(Q=>Q.status==="in-progress").length,completed:i.filter(Q=>Q.status==="completed").length,onHold:i.filter(Q=>Q.status==="on-hold").length},ms=({project:Q})=>{var Re,we,Ye;const Te=S(Q.startDate,Q.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ht(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(it,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.startDate&&Q.endDate?`${Ft(Q.startDate,"MM.dd (eee)",{locale:xs})} - ${Ft(Q.endDate,"MM.dd (eee)",{locale:xs})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>qt(Q),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>je(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Re=Q.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=Q.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),L(Q,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),Q.meetingNotes&&Q.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ye=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:Ye.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var ct;const Tt=((ct=Q.customerRequests)==null?void 0:ct.filter(P=>!P.completed))||[],$t=Tt[Tt.length-1];return a.jsxDEV("div",{onClick:()=>ft(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Tt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Tt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),L(Q,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),$t?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:$t.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>_e(Q.id,Q.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ut.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ut.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ut.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(Q=>a.jsxDEV("button",{onClick:()=>l(Q.id),className:_n("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===Q.id?`border-gray-700 ${Q.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[Q.label,a.jsxDEV("span",{className:_n("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===Q.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:Q.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:_n("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:_n("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{b(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV($i,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:st.map(Q=>a.jsxDEV(ms,{project:Q},Q.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:st.map(Q=>{var Re,we,Ye,Tt;const Te=S(Q.startDate,Q.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:Q.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q.startDate&&Q.endDate?a.jsxDEV(a.Fragment,{children:[Ft(Q.startDate,"yyyy.MM.dd (eee)",{locale:xs})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ft(Q.endDate,"yyyy.MM.dd (eee)",{locale:xs})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ht(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(it,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>qt(Q),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>je(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Re=Q.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=Q.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),L(Q,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ye=Q.meetingNotes)!=null&&Ye.length?((Tt=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:Tt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const $t=((P=Q.customerRequests)==null?void 0:P.filter(O=>!O.completed))||[],ct=$t[$t.length-1];return a.jsxDEV("div",{onClick:()=>ft(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",$t.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",$t.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),L(Q,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:ct?ct.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>_e(Q.id,Q.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(m1,{project:h,onClose:()=>{f(!1),b(null)},onSave:Ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),V&&M&&a.jsxDEV(d1,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{_(!1),C(null)},onSave:He,onDelete:ze},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),w&&M&&a.jsxDEV(f1,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{B(!1),C(null)},onSave:de,onToggleComplete:Le,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),I&&M&&a.jsxDEV(p1,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),C(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),oe&&M&&a.jsxDEV(h1,{projectName:M.name,onClose:()=>{se(!1),C(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var rd={},sb={exports:{}};(function(s){function e(t){return t&&t.__esModule?t:{default:t}}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(sb);var zs=sb.exports,id={},nb={exports:{}},rb={exports:{}},ib={exports:{}},ob={exports:{}};(function(s){function e(t){"@babel/helpers - typeof";return s.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ob);var lo=ob.exports,ab={exports:{}};(function(s){var e=lo.default;function t(n,r){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(ab);var y1=ab.exports;(function(s){var e=lo.default,t=y1;function n(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(ib);var lb=ib.exports;(function(s){var e=lb;function t(n,r,i){return(r=e(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(rb);var cb=rb.exports;(function(s){var e=cb;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function n(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(nb);var Or=nb.exports,ub={exports:{}},mb={exports:{}};(function(s){function e(t,n){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(n.indexOf(i)!==-1)continue;r[i]=t[i]}return r}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(mb);var b1=mb.exports;(function(s){var e=b1;function t(n,r){if(n==null)return{};var i,o,l=e(n,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(l[i]=n[i])}return l}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(ub);var od=ub.exports,db={exports:{}};(function(s){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(db);var fi=db.exports,fb={exports:{}};(function(s){var e=lb;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function n(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(fb);var pi=fb.exports,pb={exports:{}},hb={exports:{}};(function(s){function e(t){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(hb);var N1=hb.exports,gb={exports:{}};(function(s){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s.exports=e=function(){return!!t},s.exports.__esModule=!0,s.exports.default=s.exports)()}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(gb);var x1=gb.exports,yb={exports:{}},bb={exports:{}};(function(s){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(bb);var v1=bb.exports;(function(s){var e=lo.default,t=v1;function n(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(yb);var _1=yb.exports;(function(s){var e=N1,t=x1,n=_1;function r(i,o,l){return o=e(o),n(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}s.exports=r,s.exports.__esModule=!0,s.exports.default=s.exports})(pb);var co=pb.exports,Nb={exports:{}},xb={exports:{}};(function(s){function e(t,n){return s.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},s.exports.__esModule=!0,s.exports.default=s.exports,e(t,n)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(xb);var D1=xb.exports;(function(s){var e=D1;function t(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&e(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Nb);var uo=Nb.exports;const Aa=ma(UN);var En={},to={};Object.defineProperty(to,"__esModule",{value:!0});to.views=to.navigate=void 0;to.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};to.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var k1=zs.default;Object.defineProperty(En,"__esModule",{value:!0});En.views=En.dateRangeFormat=En.dateFormat=En.accessor=En.DayLayoutAlgorithmPropType=void 0;var rn=k1(Gp),Vp=to,wp=Object.keys(Vp.views).map(function(s){return Vp.views[s]});En.accessor=rn.default.oneOfType([rn.default.string,rn.default.func]);En.dateFormat=rn.default.any;En.dateRangeFormat=rn.default.func;En.views=rn.default.oneOfType([rn.default.arrayOf(rn.default.oneOf(wp)),rn.default.objectOf(function(s,e){var t=wp.indexOf(e)!==-1&&typeof s[e]=="boolean";if(t)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return rn.default.elementType.apply(rn.default,[s,e].concat(r))})]);En.DayLayoutAlgorithmPropType=rn.default.oneOfType([rn.default.oneOf(["overlap","no-overlap"]),rn.default.func]);var fc={},mo={},A1=zs.default;Object.defineProperty(mo,"__esModule",{value:!0});mo.accessor=vb;mo.wrapAccessor=void 0;var E1=A1(lo);function vb(s,e){var t=null;return typeof e=="function"?t=e(s):typeof e=="string"&&(0,E1.default)(s)==="object"&&s!=null&&e in s&&(t=s[e]),t}mo.wrapAccessor=function(e){return function(t){return vb(t,e)}};var hi={},C1=zs.default;Object.defineProperty(hi,"__esModule",{value:!0});hi.DnDContext=void 0;var V1=C1(A);hi.DnDContext=V1.default.createContext();var gi=zs.default;Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var w1=gi(Or),S1=gi(fi),T1=gi(pi),L1=gi(co),I1=gi(uo),ji=gi(A),Sp=gi(Aa),Tp=mo,P1=hi,_b=function(s){function e(){var t;(0,S1.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,L1.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,w1.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,I1.default)(e,s),(0,T1.default)(e,[{key:"renderAnchor",value:function(n){var r=n==="Up"||n==="Down"?"ns":"ew";return ji.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(n)]},ji.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var n=this.props,r=n.event,i=n.type,o=n.continuesPrior,l=n.continuesAfter,u=n.resizable,m=this.props.children;if(r.__isPreview)return ji.default.cloneElement(m,{className:(0,Sp.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,b=f?!!(0,Tp.accessor)(r,f):!0;if(!b)return m;var V=u&&(h?!!(0,Tp.accessor)(r,h):!0);if(V||b){var _={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(V){var w=null,B=null;i==="date"?(w=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(w=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),_.children=ji.default.createElement("div",{className:"rbc-addons-dnd-resizable"},w,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(_.className=(0,Sp.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=ji.default.cloneElement(m,_)}return m}}])}(ji.default.Component);_b.contextType=P1.DnDContext;fc.default=_b;var pc={},Db={exports:{}};(function(s){var e=lo.default;function t(n,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(s.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var b in u)b!=="default"&&{}.hasOwnProperty.call(u,b)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,b))&&(f.get||f.set)?d(h,b,f):h[b]=u[b]);return h},s.exports.__esModule=!0,s.exports.default=s.exports)(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Db);var kb=Db.exports;function ad(s,e,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!0),s){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,n),s.dispatchEvent(r)}}function j1(s){var e=Dn(s,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function R1(s,e,t){t===void 0&&(t=5);var n=!1,r=setTimeout(function(){n||ad(s,"transitionend",!0)},e+t),i=Hl(s,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(r),i()}}function ld(s,e,t,n){t==null&&(t=j1(s)||0);var r=R1(s,t,n),i=Hl(s,"transitionend",e);return function(){r(),i()}}var Lp={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Ip(s){var e=s.node,t=s.properties,n=s.duration,r=n===void 0?200:n,i=s.easing,o=s.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var b=t[h];HN(h)?m+=h+"("+b+") ":(u[h]=b,l.push(MN(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(Dn(e,Lp),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=ld(e,d,r);return e.clientLeft,Dn(e,u),{cancel:function(){f(),Dn(e,Lp)}}}function Ab(s,e,t,n,r){if(!("nodeType"in s))return Ip(s);if(!e)throw new Error("must include properties to animate");return typeof n=="function"&&(r=n,n=""),Ip({node:s,properties:e,duration:t,easing:n,callback:r})}function Eb(s,e,t){if(s){if(typeof t>"u")return s.getAttribute(e);!t&&t!==""?s.removeAttribute(e):s.setAttribute(e,String(t))}}function Cb(s){return s?Array.from(s.children):[]}function Vb(s){if(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}return null}var B1=Function.prototype.bind.call(Function.prototype.call,[].slice);function wb(s){return s?B1(s.childNodes):[]}function Sb(s,e){return function(n){var r=n.currentTarget,i=n.target,o=zu(r,s);o.some(function(l){return Ku(l,i)})&&e.call(this,n)}}function Tb(s,e){return s&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(s,e.nextSibling):e.parentNode.appendChild(s),s):null}var U1=/^(?:input|select|textarea|button)$/i;function Lb(s){return s?U1.test(s.nodeName):!1}function Ib(s){return s?!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length):!1}function Pb(s,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var n=[];s;s=s.nextElementSibling)if(s!==e){if(t&&Qu(s,t))break;n.push(s)}return n}function jb(s,e){return Pb(s,s,e)}function H1(s,e){var t=null,n=[];for(t=s?s[e]:null;t&&t.nodeType!==9;)n.push(t),t=t[e]||null;return n}function Rb(s){return H1(s,"parentElement")}function Bb(s,e){return s&&e?(e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s),s):null}function Ub(s){return s&&s.parentNode?(s.parentNode.removeChild(s),s):null}function cd(s,e){var t=Dn(s,"position"),n=t==="absolute",r=s.ownerDocument;if(t==="fixed")return r||document;for(;(s=s.parentNode)&&!ON(s);){var i=n&&Dn(s,"position")==="static",o=(Dn(s,"overflow")||"")+(Dn(s,"overflow-y")||"")+Dn(s,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Ml(s)<s.scrollHeight))return s}return r||document}function Hb(s,e){var t=gl(s),n={top:0,left:0};if(s){var r=e||cd(s),i=FN(r),o=yl(r),l=Ml(r,!0);i||(n=gl(r)),t={top:t.top-n.top,left:t.left-n.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Yu(function(){return yl(r,o)});return function(){return Gu(f)}}}function Mb(s){return Pb(s&&s.parentElement?s.parentElement.firstElementChild:null,s)}var M1=/&nbsp;/gi,O1=/\xA0/g,F1=/\s+([^\s])/gm;function Ob(s,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var n="";return s&&(n=(s.textContent||"").replace(M1," ").replace(O1," "),e&&(n=n.trim()),t&&(n=n.replace(F1," $1"))),n}function Fb(s,e){s.classList?s.classList.toggle(e):Xu(s,e)?Ju(s,e):Zu(s,e)}const q1={addEventListener:lh,removeEventListener:ah,triggerEvent:ad,animate:Ab,filter:Sb,listen:Hl,style:Dn,getComputedStyle:oh,attribute:Eb,activeElement:ih,ownerDocument:rh,ownerWindow:nh,requestAnimationFrame:Yu,cancelAnimationFrame:Gu,matches:Qu,height:Ml,width:sh,offset:gl,offsetParent:th,position:eh,contains:Ku,scrollbarSize:Zp,scrollLeft:Jp,scrollParent:cd,scrollTo:Hb,scrollTop:yl,querySelectorAll:zu,closest:Xp,addClass:Zu,removeClass:Ju,hasClass:Xu,toggleClass:Fb,transitionEnd:ld,childNodes:wb,childElements:Cb,nextUntil:jb,parents:Rb,siblings:Mb,clear:Vb,insertAfter:Tb,isInput:Lb,isVisible:Ib,prepend:Bb,remove:Ub,text:Ob},$1=Object.freeze(Object.defineProperty({__proto__:null,activeElement:ih,addClass:Zu,addEventListener:lh,animate:Ab,attribute:Eb,cancelAnimationFrame:Gu,childElements:Cb,childNodes:wb,clear:Vb,closest:Xp,contains:Ku,default:q1,filter:Sb,getComputedStyle:oh,hasClass:Xu,height:Ml,insertAfter:Tb,isInput:Lb,isVisible:Ib,listen:Hl,matches:Qu,nextUntil:jb,offset:gl,offsetParent:th,ownerDocument:rh,ownerWindow:nh,parents:Rb,position:eh,prepend:Bb,querySelectorAll:zu,remove:Ub,removeClass:Ju,removeEventListener:ah,requestAnimationFrame:Yu,scrollLeft:Jp,scrollParent:cd,scrollTo:Hb,scrollTop:yl,scrollbarSize:Zp,siblings:Mb,style:Dn,text:Ob,toggleClass:Fb,transitionEnd:ld,triggerEvent:ad,width:sh},Symbol.toStringTag,{value:"Module"})),W1=ma($1);var Ou={exports:{}};(function(s,e){e.__esModule=!0,e.default=n;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(r,i){return t(r.querySelectorAll(i))}s.exports=e.default})(Ou,Ou.exports);var z1=Ou.exports,Vn={};const K1=ma(qN),Q1=ma($N),Y1=ma(WN);var fo=zs.default;Object.defineProperty(Vn,"__esModule",{value:!0});Vn.default=void 0;Vn.getBoundsForNode=ua;Vn.getEventNodeFromPoint=$b;Vn.getShowMoreNodeFromPoint=Wb;Vn.isEvent=tV;Vn.isShowMore=sV;Vn.objectsCollide=qu;var G1=fo(lo),X1=fo(fi),J1=fo(pi),Fu=fo(K1),qb=fo(Q1),Z1=fo(Y1);function qs(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,Z1.default)(t,s,e,{passive:!1})}function eV(s,e,t){return!s||(0,Fu.default)(s,document.elementFromPoint(e,t))}function $b(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,qb.default)(r,".rbc-event",s)}function Wb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,qb.default)(r,".rbc-show-more",s)}function tV(s,e){return!!$b(s,e)}function sV(s,e){return!!Wb(s,e)}function So(s){var e=s;return s.touches&&s.touches.length&&(e=s.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Pp=5,nV=250,rV=function(){function s(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.global,r=n===void 0?!1:n,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,X1.default)(this,s),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=qs("touchmove",function(){},window),this._removeKeyDownListener=qs("keydown",this._keyListener),this._removeKeyUpListener=qs("keyup",this._keyListener),this._removeDropFromOutsideListener=qs("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=qs("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,J1.default)(s,[{key:"on",value:function(t,n){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(n),{remove:function(){var o=r.indexOf(n);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var n=this._selectRect;return!n||!this.selecting?!1:qu(n,ua(t))}},{key:"filter",value:function(t){var n=this._selectRect;return!n||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,n){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=qs("touchmove",function(){return d()}),l=qs("touchend",function(){return d()})},m=qs("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&u(n),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,n=qs("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=qs("mousedown",t._handleInitialEvent)}),r=qs("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var n=So(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var n=So(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var n=So(t),r=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!eV(u,r,i))){if(!this.globalMouse&&u&&!(0,Fu.default)(u,t.target)){var f=iV(0),h=f.top,b=f.left,V=f.bottom,_=f.right;if(d=ua(u),m=qu({top:d.top-h,left:d.left-b,bottom:d.bottom+V,right:d.right+_},{top:l,left:o}),!m)return}var w=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(w!==!1)switch(t.type){case"mousedown":this._removeEndListener=qs("mouseup",this._handleTerminatingEvent),this._onEscListener=qs("keydown",this._handleTerminatingEvent),this._removeMoveListener=qs("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=qs("touchend",this._handleTerminatingEvent),this._removeMoveListener=qs("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var n=t.target,r=this.validContainers;return!r||!r.length||!n?!0:r.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var n=this.selecting,r=this._selectRect;if(!n&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Fu.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(t):n?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var n=So(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<nV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,r=n.x,i=n.y,o=So(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),b=this.selecting,V=this.isClick(l,u);V&&!b&&!(m||d)||(!b&&!V&&this.emit("selectStart",this._initialEventData),V||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,n){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Pp&&Math.abs(n-o)<=Pp}}])}();function iV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,G1.default)(s)!=="object"&&(s={top:s,left:s,right:s,bottom:s}),s}function qu(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=ua(s),r=n.top,i=n.left,o=n.right,l=o===void 0?i:o,u=n.bottom,m=u===void 0?r:u,d=ua(e),f=d.top,h=d.left,b=d.right,V=b===void 0?h:b,_=d.bottom,w=_===void 0?f:_;return!(m-t<f||r+t>w||l-t<h||i+t>V)}function ua(s){if(!s.getBoundingClientRect)return s;var e=s.getBoundingClientRect(),t=e.left+jp("left"),n=e.top+jp("top");return{top:n,left:t,right:(s.offsetWidth||0)+t,bottom:(s.offsetHeight||0)+n}}function jp(s){if(s==="left")return window.pageXOffset||document.body.scrollLeft||0;if(s==="top")return window.pageYOffset||document.body.scrollTop||0}Vn.default=rV;var hc={},gc=zs.default;Object.defineProperty(hc,"__esModule",{value:!0});hc.default=void 0;var oV=gc(cb),Rp=gc(Or),aV=gc(Aa),To=gc(A);function Ya(s){return typeof s=="string"?s:s+"%"}function lV(s){var e=s.style,t=s.className,n=s.event,r=s.accessors,i=s.rtl,o=s.selected,l=s.label,u=s.continuesPrior,m=s.continuesAfter,d=s.getters,f=s.onClick,h=s.onDoubleClick,b=s.isBackgroundEvent,V=s.onKeyPress,_=s.components,w=_.event,B=_.eventWrapper,I=r.title(n),F=r.tooltip(n),oe=r.end(n),se=r.start(n),M=d.eventProp(n,se,oe,o),C=[To.default.createElement("div",{key:"1",className:"rbc-event-label"},l),To.default.createElement("div",{key:"2",className:"rbc-event-content"},w?To.default.createElement(w,{event:n,title:I}):I)],x=e.height,E=e.top,j=e.width,L=e.xOffset,S=(0,Rp.default)((0,Rp.default)({},M.style),{},(0,oV.default)({top:Ya(E),height:Ya(x),width:Ya(j)},i?"right":"left",Ya(L)));return To.default.createElement(B,Object.assign({type:"time"},s),To.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:S,onKeyDown:V,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,aV.default)(b?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},C))}hc.default=lV;var or={},zb=zs.default;Object.defineProperty(or,"__esModule",{value:!0});or.dragAccessors=void 0;or.eventTimes=gV;or.mergeComponents=pV;or.pointInColumn=hV;var cV=zb(Or),uV=zb(od),Bp=mo,mV=A,dV=["children"];or.dragAccessors={start:(0,Bp.wrapAccessor)(function(s){return s.start}),end:(0,Bp.wrapAccessor)(function(s){return s.end})};function fV(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];var n=function(i){var o=i.children,l=(0,uV.default)(i,dV);return e.filter(Boolean).reduceRight(function(u,m){return(0,mV.createElement)(m,l,u)},o)};return n}function pV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),n=(0,cV.default)({},s);return t.forEach(function(r){n[r]=s[r]?fV(s[r],e[r]):e[r]}),n}function hV(s,e){var t=s.left,n=s.right,r=s.top,i=e.x,o=e.y;return i<n+10&&i>t&&o>r}function gV(s,e,t){var n=e.start(s),r=e.end(s),i=t.eq(n,r,"minutes")&&t.diff(n,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(n,r,"milliseconds");return{start:n,end:r,duration:o}}var yV=kb.default,Fr=zs.default;Object.defineProperty(pc,"__esModule",{value:!0});pc.default=void 0;var pr=Fr(Or),bV=Fr(fi),NV=Fr(pi),xV=Fr(co),vV=Fr(uo),Jc=W1,_V=Fr(z1),Gr=Fr(A),DV=hi,hr=yV(Vn),kV=Fr(hc),Xn=or,Kb=function(s){function e(){var t;(0,bV.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,xV.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,Xn.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),b=(0,Xn.eventTimes)(u,d,t.props.localizer),V=b.duration,_=t.props.localizer.add(h,V,"milliseconds");t.update(u,f.getRange(h,_,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,Xn.eventTimes)(f,u,d),b=h.duration,V=m.nextSlot(o),_=!isNaN(b);if(_){var w=d.add(o,b,"milliseconds");V=new Date(Math.max(w,V))}return V},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,_V.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Jc.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Jc.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new hr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Jc.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,Xn.pointInColumn)((0,hr.getBoundsForNode)(l),f);var b=(0,hr.getEventNodeFromPoint)(l,f);if(!b)return!1;t.eventOffsetTop=f.y-(0,hr.getBoundsForNode)(b).top}),m.on("selecting",function(f){var h=(0,hr.getBoundsForNode)(l),b=t.context.draggable.dragAndDropAction;b.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),b.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,hr.getBoundsForNode)(l);(0,Xn.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var b=(0,hr.getBoundsForNode)(l);if(!(0,Xn.pointInColumn)(b,f))return t.reset();t.handleDragOverFromOutside(f,b)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,hr.getBoundsForNode)(l);u=!1;var b=t.context.draggable.dragAndDropAction;if(b.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,Xn.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Gr.default.createRef(),t}return(0,vV.default)(e,s),(0,NV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,pr.default)((0,pr.default)({},n),{},{start:i,end:o})})}},{key:"handleResize",value:function(n,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(n,r),b=(0,Xn.eventTimes)(d,o,u),V=b.start,_=b.end,w;if(f==="UP"){var B=u.min(h,l.closestSlotFromDate(_,-1));w=l.getRange(B,_),w=(0,pr.default)((0,pr.default)({},w),{},{endDate:_})}else if(f==="DOWN"){var I=u.max(h,l.closestSlotFromDate(V));w=l.getRange(V,I),w=(0,pr.default)((0,pr.default)({},w),{},{startDate:V})}this.update(d,w)}},{key:"renderContent",value:function(){var n=this.props,r=n.children,i=n.accessors,o=n.components,l=n.getters,u=n.slotMetrics,m=n.localizer,d=this.state,f=d.event,h=d.top,b=d.height;if(!f)return r;var V=r.props.children,_=f.start,w=f.end,B,I="eventTimeRangeFormat",F=u.startsBeforeDay(_),oe=u.startsAfterDay(w);return F?I="eventTimeRangeEndFormat":oe&&(I="eventTimeRangeStartFormat"),F&&oe?B=m.messages.allDay:B=m.format({start:_,end:w},I),Gr.default.cloneElement(r,{children:Gr.default.createElement(Gr.default.Fragment,null,V,f&&Gr.default.createElement(kV.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:b,width:100},getters:l,components:o,accessors:(0,pr.default)((0,pr.default)({},i),Xn.dragAccessors),continuesPrior:F,continuesAfter:oe}))})}},{key:"render",value:function(){return Gr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Gr.default.Component);Kb.contextType=DV.DnDContext;pc.default=Kb;var yc={},Qb={exports:{}},Yb={exports:{}},Gb={exports:{}};(function(s){function e(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Gb);var Xb=Gb.exports;(function(s){var e=Xb;function t(n){if(Array.isArray(n))return e(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Yb);var AV=Yb.exports,Jb={exports:{}};(function(s){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Jb);var EV=Jb.exports,Zb={exports:{}};(function(s){var e=Xb;function t(n,r){if(n){if(typeof n=="string")return e(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,r):void 0}}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Zb);var CV=Zb.exports,eN={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(eN);var VV=eN.exports;(function(s){var e=AV,t=EV,n=CV,r=VV;function i(o){return e(o)||t(o)||n(o)||r()}s.exports=i,s.exports.__esModule=!0,s.exports.default=s.exports})(Qb);var tN=Qb.exports,bc={},Nc={},xc={},qr=zs.default;Object.defineProperty(xc,"__esModule",{value:!0});xc.default=void 0;var Up=qr(Or),wV=qr(od),SV=qr(fi),TV=qr(pi),LV=qr(co),IV=qr(uo),Lo=qr(A),PV=qr(Aa),jV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],RV=function(s){function e(){return(0,SV.default)(this,e),(0,LV.default)(this,e,arguments)}return(0,IV.default)(e,s),(0,TV.default)(e,[{key:"render",value:function(){var n=this.props,r=n.style,i=n.className,o=n.event,l=n.selected,u=n.isAllDay,m=n.onSelect,d=n.onDoubleClick,f=n.onKeyPress,h=n.localizer,b=n.continuesPrior,V=n.continuesAfter,_=n.accessors,w=n.getters,B=n.children,I=n.components,F=I.event,oe=I.eventWrapper,se=n.slotStart,M=n.slotEnd,C=(0,wV.default)(n,jV);delete C.resizable;var x=_.title(o),E=_.tooltip(o),j=_.end(o),L=_.start(o),S=_.allDay(o),k=u||S||h.diff(L,h.ceil(j,"day"),"day")>1,_e=w.eventProp(o,L,j,l),Ue=Lo.default.createElement("div",{className:"rbc-event-content",title:E||void 0},F?Lo.default.createElement(F,{event:o,continuesPrior:b,continuesAfter:V,title:x,isAllDay:S,localizer:h,slotStart:se,slotEnd:M}):x);return Lo.default.createElement(oe,Object.assign({},this.props,{type:"date"}),Lo.default.createElement("div",Object.assign({},C,{style:(0,Up.default)((0,Up.default)({},_e.style),r),className:(0,PV.default)("rbc-event",i,_e.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":b,"rbc-event-continues-after":V}),onClick:function(je){return m&&m(o,je)},onDoubleClick:function(je){return d&&d(o,je)},onKeyDown:function(je){return f&&f(o,je)}}),typeof B=="function"?B(Ue):Ue))}}])}(Lo.default.Component);xc.default=RV;var $r={},BV=zs.default;Object.defineProperty($r,"__esModule",{value:!0});$r.dateCellSelection=OV;$r.getSlotAtX=sN;$r.isSelected=HV;$r.pointInBox=MV;$r.slotWidth=ud;var UV=BV(zN);function HV(s,e){return!s||e==null?!1:(0,UV.default)(s,e)}function ud(s,e){var t=s.right-s.left,n=t/e;return n}function sN(s,e,t,n){var r=ud(s,n);return t?n-1-Math.floor((e-s.left)/r):Math.floor((e-s.left)/r)}function MV(s,e){var t=e.x,n=e.y;return n>=s.top&&n<=s.bottom&&t>=s.left&&t<=s.right}function OV(s,e,t,n,r){var i=-1,o=-1,l=n-1,u=ud(e,n),m=sN(e,t.x,r,n),d=e.top<t.y&&e.bottom>t.y,f=e.top<s.y&&e.bottom>s.y,h=s.y>e.bottom,b=e.top>s.y,V=t.top<e.top&&t.bottom>e.bottom;return V&&(i=0,o=l),d&&(b?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((s.x-e.left)/u):Math.floor((s.x-e.left)/u),d?m<i?i=m:o=m:s.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var md=zs.default;Object.defineProperty(Nc,"__esModule",{value:!0});Nc.default=void 0;var jn=md(Gp),Hp=md(A),FV=md(xc),qV=$r;Nc.default={propTypes:{slotMetrics:jn.default.object.isRequired,selected:jn.default.object,isAllDay:jn.default.bool,accessors:jn.default.object.isRequired,localizer:jn.default.object.isRequired,components:jn.default.object.isRequired,getters:jn.default.object.isRequired,onSelect:jn.default.func,onDoubleClick:jn.default.func,onKeyPress:jn.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var n=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,b=d.continuesPrior(t),V=d.continuesAfter(t);return Hp.default.createElement(FV.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:b,continuesAfter:V,slotStart:d.first,slotEnd:d.last,selected:(0,qV.isSelected)(t,n),resizable:h})},renderSpan:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return Hp.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Wr=zs.default;Object.defineProperty(bc,"__esModule",{value:!0});bc.default=void 0;var $V=Wr(Or),WV=Wr(fi),zV=Wr(pi),KV=Wr(co),QV=Wr(uo),YV=Wr(Aa),Mp=Wr(A),hl=Wr(Nc),nN=function(s){function e(){return(0,WV.default)(this,e),(0,KV.default)(this,e,arguments)}return(0,QV.default)(e,s),(0,zV.default)(e,[{key:"render",value:function(){var n=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return Mp.default.createElement("div",{className:(0,YV.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,b=d.left,V=d.right,_=d.span,w="_lvl_"+f,B=b-u,I=hl.default.renderEvent(n.props,h);return B&&m.push(hl.default.renderSpan(o,B,"".concat(w,"_gap"))),m.push(hl.default.renderSpan(o,_,w,I)),u=V+1,m},[]))}}])}(Mp.default.Component);nN.defaultProps=(0,$V.default)({},hl.default.defaultProps);bc.default=nN;var ar={},rN=zs.default;Object.defineProperty(ar,"__esModule",{value:!0});ar.endOfRange=iN;ar.eventLevels=JV;ar.eventSegments=XV;ar.inRange=ZV;ar.segsOverlap=oN;ar.sortEvents=$u;ar.sortWeekEvents=ew;var Zc=rN(tN),GV=rN(KN);function iN(s){var e=s.dateRange,t=s.unit,n=t===void 0?"day":t,r=s.localizer;return{first:e[0],last:r.add(e[e.length-1],1,n)}}function XV(s,e,t,n){var r=iN({dateRange:e,localizer:n}),i=r.first,o=r.last,l=n.diff(i,o,"day"),u=n.max(n.startOf(t.start(s),"day"),i),m=n.min(n.ceil(t.end(s),"day"),o),d=(0,GV.default)(e,function(h){return n.isSameDate(h,u)}),f=n.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-n.segmentOffset,1),{event:s,span:f,left:d+1,right:Math.max(d+f,1)}}function JV(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,n,r,i=[],o=[];for(t=0;t<s.length;t++){for(r=s[t],n=0;n<i.length&&oN(r,i[n]);n++);n>=e?o.push(r):(i[n]||(i[n]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function ZV(s,e,t,n,r){var i={start:n.start(s),end:n.end(s)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function oN(s,e){return e.some(function(t){return t.left<=s.right&&t.right>=s.left})}function ew(s,e,t){var n=(0,Zc.default)(s),r=[],i=[];n.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return $u(u,m,e,t)}),l=i.sort(function(u,m){return $u(u,m,e,t)});return[].concat((0,Zc.default)(o),(0,Zc.default)(l))}function $u(s,e,t,n){var r={start:t.start(s),end:t.end(s),allDay:t.allDay(s)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return n.sortEvents({evtA:r,evtB:i})}var tw=kb.default,zr=zs.default;Object.defineProperty(yc,"__esModule",{value:!0});yc.default=void 0;var Ga=zr(Or),sw=zr(tN),nw=zr(fi),rw=zr(pi),iw=zr(co),ow=zr(uo),Xa=zr(A),aw=zr(bc),Ri=tw(Vn),lw=ar,gr=$r,Ja=or,cw=hi,aN=function(s){function e(){var t;(0,nw.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,iw.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,gr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,b=d.rtl,V=d.localizer,_=(0,gr.getSlotAtX)(l,o.x,b,h.slots),w=h.getDateForSlot(_),B=(0,Ja.eventTimes)(m,f,V),I=B.start,F=B.duration;I=V.merge(w,I);var oe=V.add(I,F,"milliseconds");t.update(m,I,oe)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,gr.getSlotAtX)(l,o.x,d,m.slots),b=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:b,end:f.add(b,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Ri.default(function(){return l},{validContainers:(0,sw.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,b=(0,Ri.getBoundsForNode)(o),V=(0,gr.pointInBox)(b,d);return h==="move"||h==="resize"&&(!f||V)}),m.on("selecting",function(d){var f=(0,Ri.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Ri.getBoundsForNode)(o);t.state.segment&&((0,gr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Ri.getBoundsForNode)(o);(0,gr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Ri.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Xa.default.createRef(),t}return(0,ow.default)(e,s),(0,rw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,r,i){var o=(0,lw.eventSegments)((0,Ga.default)((0,Ga.default)({},n),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Ja.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(n,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,b=(0,Ja.eventTimes)(o,m,h),V=b.start,_=b.end,w=(0,gr.getSlotAtX)(r,n.x,f,d.slots),B=d.getDateForSlot(w),I=(0,gr.pointInBox)(r,n);if(l==="RIGHT"){if(I){if(d.last<V)return this.reset();h.eq(h.startOf(_,"day"),_)?_=h.add(B,1,"day"):_=B}else if(h.inRange(V,d.first,d.last)||r.bottom<n.y&&+d.first>+V)_=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);_=h.merge(_,F),h.lt(_,V)&&(_=F)}else if(l==="LEFT"){if(I){if(d.first>_)return this.reset();V=B}else if(h.inRange(_,d.first,d.last)||r.top>n.y&&h.lt(d.last,_))V=h.add(d.first,-1,"milliseconds");else{this.reset();return}var oe=m.start(o);V=h.merge(V,oe),h.gt(V,_)&&(V=oe)}this.update(o,V,_)}},{key:"render",value:function(){var n=this.props,r=n.children,i=n.accessors,o=this.state.segment;return Xa.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&Xa.default.createElement(aw.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,Ga.default)((0,Ga.default)({},i),Ja.dragAccessors)})))}}])}(Xa.default.Component);aN.contextType=cw.DnDContext;yc.default=aN;var wn=zs.default;Object.defineProperty(id,"__esModule",{value:!0});id.default=_w;var Za=wn(Or),uw=wn(od),mw=wn(fi),dw=wn(pi),fw=wn(co),pw=wn(uo),eu=wn(A),hw=wn(Aa),gw=wn(fc),yw=wn(pc),bw=wn(yc),Nw=or,xw=hi,vw=["selectable","elementProps","components"];function _w(s){var e=function(t){function n(){var r;(0,mw.default)(this,n);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,fw.default)(this,n,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,b=h.onEventDrop,V=h.onEventResize;d==="move"&&b&&b(u),d==="resize"&&V&&V(u)}},r.state={interacting:!1},r}return(0,pw.default)(n,t),(0,dw.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,uw.default)(i,vw),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,Nw.mergeComponents)(u,{eventWrapper:gw.default,eventContainerWrapper:yw.default,weekWrapper:bw.default});var f=this.props.onDropFromOutside?(0,Za.default)((0,Za.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,hw.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return eu.default.createElement(xw.DnDContext.Provider,{value:h},eu.default.createElement(s,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(eu.default.Component);return e.defaultProps=(0,Za.default)((0,Za.default)({},s.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var Dw=zs.default;Object.defineProperty(rd,"__esModule",{value:!0});var lN=rd.default=void 0,kw=Dw(id);lN=rd.default=kw.default;const br={async getAllProcesses(){try{const s=qe(re,"processes"),e=xt(s,ls("order","asc")),t=await wt(e);return t.empty?this.getDefaultProcesses():t.docs.map(n=>{const r=n.data();return{id:parseInt(n.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(s){return console.error("[Firestore]    :",s),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,t)=>({id:t+1,name:e,order:t,isDefault:!0}))},async createProcess(s,e){try{const t=qe(re,"processes"),n=await wt(t);let r=0;n.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>r&&(r=m)});const i=r+1,o=Se(re,"processes",String(i)),l=new Date().toISOString();return await li(o,{name:s,order:e,isDefault:!1,createdAt:l,updatedAt:os()}),console.log(" [Firestore]   :",i),{id:i,name:s,order:e,isDefault:!1,createdAt:l}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async updateProcess(s,e){try{const t=Se(re,"processes",String(s)),n=await Pt(t);if(!n.exists())throw new Error("   .");const r=n.data(),i={updatedAt:os()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Bt(t,i),console.log(" [Firestore]   :",s),{id:s,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async deleteProcess(s){try{const e=Se(re,"processes",String(s));await Us(e),console.log(" [Firestore]   :",s)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(s){try{const e=s.map((t,n)=>{const r=Se(re,"processes",String(t));return Bt(r,{order:n,updatedAt:os()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(s){const e=qe(re,"processes"),t=xt(e,ls("order","asc"));return dn(t,r=>{if(r.empty){s(br.getDefaultProcesses());return}const i=r.docs.map(o=>{const l=o.data();return{id:parseInt(o.id)||0,name:l.name||"",order:l.order||0,isDefault:l.isDefault||!1}});s(i)})}},Aw={getAllProcesses:()=>br.getAllProcesses(),createProcess:(s,e)=>br.createProcess(s,e),updateProcess:(s,e)=>br.updateProcess(s,e),deleteProcess:s=>br.deleteProcess(s),reorderProcesses:s=>br.reorderProcesses(s),subscribeToProcesses:br.subscribeToProcesses,getDefaultProcesses:br.getDefaultProcesses},Ew=lN(QN),Cw=o1;ot.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:s=>s<12?"":"",week:{dow:0,doy:1}});ot.locale("ko");const Vw=YN(ot),Op=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],ww=lt.memo(({onSave:s,onCancel:e,processList:t})=>{const[n,r]=A.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=A.useState(i);A.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:n,onChange:m=>r(m.target.value),onBlur:()=>{n.trim()?s(n.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?n.trim()?s(n.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),Fp=s=>s,Go={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},Sw=lt.memo(({date:s,label:e,filteredEvents:t,selectedDate:n,user:r,isMobileView:i})=>{const o=ot(s).format("YYYY-MM-DD"),l=Go[o],u=!!Go[o],m=n&&ot(s).isSame(n,"day"),d=t.filter(M=>ot(M.start).isSame(s,"day")),f=d.length,h=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,b=f-h,V=e.replace(/^0/,""),_=s.getDay()===0,w=s.getDay()===6;let B="#000000";u||_?B="#dc2626":w&&(B="#3b82f6");const I=ot(s).isSame(ot(),"day");let F="#d1d5db";u||_?F="#fecaca":w&&(F="#bfdbfe");const oe=V.length===2,se=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:I?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:I?"700":"400",paddingLeft:oe?"0px":"4px",...I&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:se,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((M,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:b}).map((M,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:se,children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),Tw=lt.memo(({event:s,user:e,filterProject:t,isEditing:n,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",b=s.assignedTo||[],[V,_]=A.useState(!1),w=lt.useRef(null),B=()=>{const pe=window.innerWidth,je=window.innerHeight;return pe>=768&&pe<1024||pe>=1024&&je>pe},[I,F]=A.useState(B),[oe,se]=A.useState(!1);lt.useRef(null),lt.useRef(!1);const[M,C]=A.useState(r||""),x=lt.useRef(n);A.useEffect(()=>{n&&!x.current&&r!==void 0&&C(r),x.current=n},[n,r]);const E=e!=null&&e.name?e.name.slice(-2):null,j=E&&["",""].includes(E),L=E&&["","",""].includes(E),S=(e==null?void 0:e.name)&&(b.includes(e.name)||b.includes("HV LAB")||b.includes("")&&L||b.includes("")&&j);A.useEffect(()=>{const pe=()=>{F(B())};return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const k=pe=>{C(pe)},_e=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},Ue=pe=>{pe.stopPropagation(),(pe.key==="Enter"||pe.key==="Escape")&&pe.currentTarget.blur()};return I?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{se(!0),_(!0)},onMouseLeave:()=>{se(!1),_(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[V&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:w,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!s.isASVisit&&s.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",Fp(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&b.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:b.map((pe,je)=>{const ft=pe==="HV LAB"||pe===""&&j||pe===""&&L||pe===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ft?"bold":"normal"},children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),je<b.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:pe=>k(pe.target.value),onBlur:_e,onKeyDown:Ue,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:S?"underline":"none",textDecorationColor:S?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:s.title,children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),oe&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),s.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",s.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),b.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",b.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!s.isASVisit&&s.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",Fp(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:pe=>k(pe.target.value),onBlur:_e,onKeyDown:Ue,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:S?"underline":"none",textDecorationColor:S?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&b.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:b.map((pe,je)=>{const ft=pe==="HV LAB"||pe===""&&j||pe===""&&L||pe===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{className:ft?"font-bold":"",children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),je<b.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),V&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:w,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&n&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(pe=>a.jsxDEV("option",{value:pe},pe,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),Lw=()=>{const{schedules:s,setSchedules:e,addSchedule:t,deleteSchedule:n,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=tr(),{user:b}=Mr(),V=dc(),[_,w]=A.useState(!1);A.useEffect(()=>{const N=()=>{const U=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;w(U)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const B=N=>!N||N==="-"?"":_?N:Mu(N),I=b!=null&&b.name?b.name.slice(-2):null;console.log(" Current user:",b==null?void 0:b.name,"Short name:",I);const F=lt.useRef(!1);A.useEffect(()=>{F.current||(F.current=!0,r().catch(N=>{console.error("Failed to load schedules:",N),ne.error("  ")}))},[r]);const[oe,se]=A.useState([]);A.useEffect(()=>{const N=async U=>{if((U.ctrlKey||U.metaKey)&&U.key==="z"){const Y=U.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(oe.length>0){U.preventDefault();const K=oe[oe.length-1];try{const le=K.type==="as_visit"||K.type==="expected_payment"?"other":K.type;await i({id:"",title:K.originalTitle||K.title,start:K.start,end:K.end,type:le,project:K.originalProjectName||K.projectName,attendees:K.assignedTo||[],time:K.time,description:K.description}),se(ge=>ge.slice(0,-1)),ne.success(" ")}catch(le){console.error("  :",le),ne.error("  ")}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[oe,i]);const[M,C]=A.useState([]),[x,E]=A.useState(!1),[j,L]=A.useState(""),[S,k]=A.useState(null),[_e,Ue]=A.useState(""),[pe,je]=A.useState(!1),[ft,qt]=A.useState(null),[Ht,ae]=A.useState(null),He=A.useCallback(async()=>{je(!0);try{const N=await Aw.getAllProcesses();C(N)}catch(N){console.error("   :",N),C([])}finally{je(!1)}},[]);A.useEffect(()=>{He()},[He]);const de=A.useMemo(()=>M.length>0?M.map(N=>N.name):Cw,[M]),Le=async()=>{if(j.trim())try{const N=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(N.ok)L(""),He(),ne.success(" ");else{const U=await N.json();ne.error(U.error||"  ")}}catch(N){console.error("  :",N),ne.error("  ")}},ze=async()=>{if(!(!S||!_e.trim()))try{const N=await fetch(`/api/processes/${S.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_e.trim()})});if(N.ok)k(null),Ue(""),He(),ne.success(" ");else{const U=await N.json();ne.error(U.error||"  ")}}catch(N){console.error("  :",N),ne.error("  ")}},bt=async N=>{if(confirm("   ?"))try{const U=await fetch(`/api/processes/${N}`,{method:"DELETE"});if(U.ok)He(),ne.success(" ");else{const Y=await U.json();ne.error(Y.error||"  ")}}catch(U){console.error("  :",U),ne.error("  ")}},it=N=>{qt(N)},St=(N,U)=>{N.preventDefault(),ft!==null&&ft!==U&&ae(U)},st=async()=>{if(ft!==null&&Ht!==null&&ft!==Ht){const N=[...M],[U]=N.splice(ft,1);N.splice(Ht,0,U),C(N);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:N.map(K=>({id:K.id}))})})).ok||(He(),ne.error("  "))}catch(Y){console.error("  :",Y),He(),ne.error("  ")}}qt(null),ae(null)},ut=N=>{const U=V.findIndex(Y=>Y.name===N);return U>=0?Op[U%Op.length]:"#e8e2ea"},ms=V.map(N=>N.name),Q=s.filter(N=>!N.asRequestId).filter(N=>(b==null?void 0:b.name)===""?N.project===""||ms.includes(N.project):!0).map(N=>{const U=V.find(he=>he.name===N.project);let Y=N.project===""?"[]":N.project;if(U&&N.project!==""){const he=U.name.length>2?U.name.substring(0,2):U.name,pt=(U.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";Y=gs?`${he}_${gs}`:he}const K=N.time,le=K&&K!=="-"?` - ${B(K)}`:"",ge=N.attendees||[];return{id:N.id,title:N.title+le,originalTitle:N.title,start:N.start,end:N.end,projectId:(U==null?void 0:U.id)||"",projectName:Y||"",originalProjectName:N.project||"",type:N.type||"other",phase:"",assignedTo:ge,priority:"medium",allDay:!K||K==="-",color:ut(N.project||""),isASVisit:!1,time:K,description:N.description}}),Te=u.filter(N=>N.scheduledVisitDate).filter(N=>(b==null?void 0:b.name)===""?ms.includes(N.project):!0).map(N=>{const U=N.scheduledVisitTime,Y=U&&U!=="-"?` - ${B(U)}`:"",K=V.find(he=>he.name===N.project);let le=N.project;if(K){const he=K.name.length>2?K.name.substring(0,2):K.name,pt=(K.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";le=gs?`${he}_${gs}`:he}const ge=`[AS] ${le}`;return{id:`as-${N.id}`,title:ge+Y,originalTitle:ge,start:N.scheduledVisitDate,end:N.scheduledVisitDate,projectId:(K==null?void 0:K.id)||"",projectName:le,originalProjectName:N.project,type:"as_visit",phase:"",assignedTo:N.assignedTo?Array.isArray(N.assignedTo)?N.assignedTo:N.assignedTo.split(",").map(he=>he.trim()):[],priority:"high",allDay:!U||U==="-",color:"#FEF3C7",isASVisit:!0,time:U,description:N.description}}),Re=(b==null?void 0:b.role)==="manager"?f.flatMap(N=>{var ge,he,at,pt,gs,Lt,It,ns;const U=V.find(Es=>Es.name===N.project);if(!U){const Es=[],Et=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),es=new Set(N.payments.flatMap(ps=>{var zt;return((zt=ps.type)==null?void 0:zt.split(", ").map(Kt=>Kt.trim()))||[]}));return!es.has("")&&((ge=N.expectedPaymentDates)!=null&&ge.contract)&&Es.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),!es.has("")&&((he=N.expectedPaymentDates)!=null&&he.start)&&Es.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!es.has("")&&((at=N.expectedPaymentDates)!=null&&at.middle)&&Es.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!es.has("")&&((pt=N.expectedPaymentDates)!=null&&pt.final)&&Es.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),Es}if(!U.startDate||!U.endDate)return[];const Y=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),K=new Set(N.payments.flatMap(Es=>{var Et;return((Et=Es.type)==null?void 0:Et.split(", ").map(es=>es.trim()))||[]})),le=[];return!K.has("")&&((gs=N.expectedPaymentDates)!=null&&gs.contract)&&le.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!K.has("")&&((Lt=N.expectedPaymentDates)!=null&&Lt.start)&&le.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!K.has("")&&((It=N.expectedPaymentDates)!=null&&It.middle)&&le.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!K.has("")&&((ns=N.expectedPaymentDates)!=null&&ns.final)&&le.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],we=[...Q,...Te,...Re],Ye=A.useCallback(N=>{if(!(b!=null&&b.name))return!1;const U=N.assignedTo||[],Y=b.name.slice(-2),K=["",""].includes(Y),le=["","",""].includes(Y);return U.includes(b.name)||U.includes("HV LAB")||U.includes("")&&le||U.includes("")&&K},[b==null?void 0:b.name]),Tt=(N,U)=>{if(!U)return[...N].sort((le,ge)=>{const he=Ye(le),at=Ye(ge);return he&&!at?-1:!he&&at?1:le.start.getTime()-ge.start.getTime()});const Y=new Map;N.forEach(le=>{const ge=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ge){const he=`single_${le.id}`;Y.set(he,[le])}else{const he=le.start.toISOString().split("T")[0],at=[...le.assignedTo].sort().join(","),pt=`${he}_${le.projectName}_${at}`;Y.has(pt)||Y.set(pt,[]),Y.get(pt).push(le)}});const K=[];return Y.forEach(le=>{if(le.length===1)K.push(le[0]);else{const ge=le[0],he=le.map(It=>It.originalTitle||It.title),at=[...new Set(he)],pt=le.map(It=>{const ns=It.originalTitle||It.title;return ns.startsWith(ge.projectName+" - ")?ns.substring(ge.projectName.length+3):ns}),gs=[...new Set(pt)],Lt={...ge,id:le[0].id,title:gs.join(", "),originalTitle:at.join(", "),description:le.map(It=>It.description||It.originalTitle||It.title).join(`
`),assignedTo:[...new Set(le.flatMap(It=>It.assignedTo))],mergedEventIds:le.map(It=>It.id)};K.push(Lt)}}),K.sort((le,ge)=>{const he=Ye(le),at=Ye(ge);return he&&!at?-1:!he&&at?1:le.start.getTime()-ge.start.getTime()})},[$t,ct]=A.useState("month"),[P,O]=A.useState(new Date),[J,ye]=A.useState(!1),[ue,fe]=A.useState(null),[Ce,Me]=A.useState(null),et=`schedule_filterProject_${(b==null?void 0:b.id)||"guest"}`,[Ae,Rs]=A.useState(()=>{const N=localStorage.getItem(et);return N||((b==null?void 0:b.name)===""&&V.length>0?V[0].name:"all")});A.useEffect(()=>{localStorage.setItem(et,Ae)},[Ae,et]),A.useCallback(()=>{document.body.classList.add("printing-schedule");const N=Ae==="all"?" ":Ae,U=ot(P).format("YYYY MM"),Y=document.title;document.title=`${N} - ${U} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ae,P]);const jt=Tt(we,Ae==="all"),[ee,Ge]=A.useState(window.innerWidth<768?new Date:null),[H,be]=A.useState(null),De=lt.useRef(null),Ie=lt.useRef(!1),[me,Mt]=A.useState(null),mt=lt.useRef(!1),Wt=lt.useRef(!1);A.useEffect(()=>{const N=K=>{K.key==="Control"&&(Wt.current=!0)},U=K=>{K.key==="Control"&&(Wt.current=!1)},Y=()=>{Wt.current=!1};return window.addEventListener("keydown",N),window.addEventListener("keyup",U),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",N),window.removeEventListener("keyup",U),window.removeEventListener("blur",Y)}},[]),A.useEffect(()=>{if(!H)return;let N=null;const U=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy")},Y=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy");const at=ge.target.closest(".rbc-day-bg");N&&N!==at&&(N.style.backgroundColor=""),at&&(at.style.backgroundColor="rgba(59, 130, 246, 0.15)",N=at)},K=()=>{N&&(N.style.backgroundColor="",N=null)},le=ge=>{ge.preventDefault(),N&&(N.style.backgroundColor="",N=null)};return document.addEventListener("dragenter",U),document.addEventListener("dragover",Y),document.addEventListener("dragend",K),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",U),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",K),document.removeEventListener("drop",le),N&&(N.style.backgroundColor="")}},[H]);const[At,ds]=A.useState(null),[ss,Ts]=A.useState(null),[fn,Ks]=A.useState(""),[pn,Kr]=A.useState(!1),[Sn,en]=A.useState(null),[Tn,v]=A.useState(!1),[q,y]=A.useState(""),[R,T]=A.useState(null),[$,Z]=A.useState({x:0,y:0}),[z,G]=A.useState({x:0,y:0}),[te,Oe]=A.useState(!1),Ke=8;A.useEffect(()=>{if(!R)return;const N=Y=>{Z({x:Y.clientX,y:Y.clientY});const K=Math.abs(Y.clientX-z.x),le=Math.abs(Y.clientY-z.y);(K>Ke||le>Ke)&&Oe(!0)},U=()=>{T(null),Oe(!1)};return window.addEventListener("mousemove",N),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",U)}},[R,z]);const Fe=lt.useRef(!1),Ne=A.useCallback(async({event:N,start:U,end:Y})=>{if(N.isASVisit||N.isExpectedPayment){ne.error("    ");return}const K=U instanceof Date?U:new Date(U),le=Y instanceof Date?Y:new Date(Y);if(Wt.current)try{const he=N.mergedEventIds||[N.id],at=s.filter(pt=>he.includes(pt.id));for(const pt of at)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:pt.title,start:K,end:le,project:pt.project,attendees:pt.attendees||[],time:pt.time,priority:pt.priority||"medium"});ne.success(" ")}catch(he){console.error("  :",he),ne.error("  ")}else{const he=N.mergedEventIds||[N.id];try{for(const at of he)await o(at,{start:K,end:le})}catch(at){console.error("  :",at),ne.error("  "),r()}}},[s,o,i,r]),Ze=A.useCallback(({event:N,action:U})=>{var K;if(N.isASVisit||N.isExpectedPayment||N.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((K=le.textContent)!=null&&K.includes(N.originalTitle||N.title)){const ge=le.getBoundingClientRect();G({x:ge.left,y:ge.top}),Z({x:ge.left,y:ge.top});break}Oe(!1),T(N)},[]),Yt=A.useCallback(async(N,U,Y=!1)=>{if(Ae==="all"){ne.error("  ");return}const K={id:"",title:N,start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(K)}catch(le){console.error("  :",le),ne.error("  ")}},[Ae,i,b]),Dt=A.useCallback(({start:N})=>{const U=H||De.current;U&&Ae!=="all"&&(Ie.current=!0,mt.current=!0,requestAnimationFrame(()=>{mt.current=!1}),ds(null),Ts(null),Ks(""),Yt(U,N),requestAnimationFrame(()=>{be(null),De.current=null,Ie.current=!1}))},[H,Ae,Yt]),fs=A.useCallback(()=>{const N=H||De.current;return N?{title:N}:null},[H]),Gt=A.useCallback(async N=>{if(!N.trim()||!At||Ae==="all"){ds(null);return}const U=At;ds(null);const Y={id:"",title:N.trim(),start:U,end:U,type:"construction",project:Ae,location:"",attendees:b!=null&&b.name?[b.name]:[],description:""};try{await i(Y)}catch(K){console.error("  :",K),ne.error("  ")}},[At,Ae,i,b]),Qs=A.useCallback(()=>{ds(null)},[]),Ys=A.useCallback(async()=>{var N;if(!ss||!fn.trim()){Ts(null),Ks("");return}try{const U=((N=ss.mergedEventIds)==null?void 0:N[0])||ss.id;await o(U,{title:fn.trim()})}catch(U){console.error("  :",U),ne.error("  ")}Ts(null),Ks("")},[ss,fn,o]),Ot=A.useCallback(async N=>{se(Y=>[...Y,N]);const U=N.mergedEventIds||[N.id];ne.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(U.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),ne.error("  "),se(K=>K.slice(0,-1))}Ts(null),Ks("")},[l]),We=Ae==="all"?jt:jt.filter(N=>(N.originalProjectName||N.projectName)===Ae),ke=lt.useMemo(()=>{const N=Ae!=="all",U=new Map;We.forEach(K=>{const le=ot(K.start).format("YYYY-MM-DD");U.has(le)||U.set(le,[]),U.get(le).push(K)});const Y=[];return U.forEach(K=>{if(N)K.forEach((le,ge)=>{const he=ot(le.start).startOf("day").add(ge,"milliseconds").toDate();Y.push({...le,start:he,allDay:!1})});else{const le=[],ge=[];K.forEach(he=>{Ye(he)?le.push(he):ge.push(he)}),le.forEach((he,at)=>{const pt=ot(he.start).startOf("day").add(at,"milliseconds").toDate();Y.push({...he,start:pt,allDay:!1})}),ge.forEach((he,at)=>{const pt=ot(he.start).startOf("day").add(1e3+at,"milliseconds").toDate();Y.push({...he,start:pt,allDay:!1})})}}),Y.sort((K,le)=>K.start.getTime()-le.start.getTime())},[We,Ye,Ae]),Qe=lt.useMemo(()=>{if(At&&Ae!=="all"){const N=ot(At).format("YYYY-MM-DD"),U=ke.filter(ge=>ot(ge.start).format("YYYY-MM-DD")===N),Y=U.length>0?Math.max(...U.map(ge=>ge.start.getTime())):ot(At).startOf("day").valueOf(),K=new Date(Y+1),le={id:"__inline_add__",title:"",start:K,end:K,projectId:"",projectName:Ae,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...ke,le]}return ke},[ke,At,Ae]);A.useEffect(()=>{(b==null?void 0:b.name)===""&&V.length>0&&(Ae==="all"||!V.find(N=>N.name===Ae))&&Rs(V[0].name)},[V,b]),A.useEffect(()=>{const N=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.opacity="0",he.style.pointerEvents="none",he.style.position="absolute",he.style.left="-9999px",he.style.top="-9999px",he.style.zIndex="-1"})};N();const U=new MutationObserver(N),Y=document.querySelector(".rbc-calendar");Y&&U.observe(Y,{childList:!0,subtree:!0});const K=new MutationObserver(N);return K.observe(document.body,{childList:!0,subtree:!0}),()=>{U.disconnect(),K.disconnect()}},[$t,P]);const[Je,Nt]=A.useState({date:null,projectId:"",title:""}),Be=lt.useRef(!1),nt=lt.useRef(null),gt=N=>{if(Fe.current){Fe.current=!1;return}if(N.id==="__inline_add__")return;Be.current=!0,nt.current&&clearTimeout(nt.current);const U=Ae!=="all",Y=window.innerWidth<768;if(U&&!Y&&!N.isASVisit&&!N.isExpectedPayment)ds(null),Ts(N),Ks(N.originalTitle||N.title);else{const K={...N,title:N.originalTitle||N.title};Me(null),fe(K),ye(!0)}nt.current=setTimeout(()=>{Be.current=!1,nt.current=null},300)},Zt=N=>{const U=window.innerWidth,Y=U<768,K=U>=768&&U<1024,le=Ae==="all";if(mt.current)return;if(Y){if(N.start){Ge(N.start);const he=document.querySelector(".md\\:hidden.mt-3.bg-white");he&&he.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ge=N.action==="click"||N.action==="select";if(!(K&&!ge)){if(le){Be.current=!1,Ts(null),Ks(""),ds(null),Me(N),fe(null),ye(!0);return}if(!Be.current){if(me){Yt(me,N.start,!0);return}Ts(null),Ks(""),ds(N.start)}}},is=async()=>{if(!Je.projectId||!Je.title.trim()){alert("  ");return}const N=V.find(U=>U.id===Je.projectId);if(!(!N||!Je.date))try{await i({id:Date.now().toString(),title:Je.title,start:Je.date,end:Je.date,type:"other",project:N.name,location:"",attendees:[],description:""}),Nt({date:null,projectId:"",title:""}),Ge(null)}catch(U){console.error("Failed to add schedule:",U),ne.error("  ")}},Ln=N=>{if(N.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let U=N.color||"#E0E7FF",Y="#1f2937";if(N.isASVisit)U="#E8F5E9",Y="#1f2937";else{const K=N.assignedTo&&N.assignedTo.includes("HV LAB"),le=N.assignedTo&&N.assignedTo.includes("")&&I&&["",""].includes(I),ge=N.assignedTo&&N.assignedTo.includes("")&&I&&["","",""].includes(I);N.assignedTo&&N.assignedTo.includes((b==null?void 0:b.name)||"")||K||le||ge?(U="#FEF3C7",Y="#1f2937"):N.color||(U="#e8e2ea")}return{style:{backgroundColor:U,"--event-bg-color":U,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},yi=lt.useCallback(N=>{const U=ot(N).format("YYYY-MM-DD"),Y=!!Go[U],K=ee&&ot(N).isSame(ee,"day"),le=window.innerWidth<768;let ge="";K&&(ge+="selected-date "),Y&&(ge+="holiday-date ");const he=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ge.trim(),style:he}},[ee]),[yt,bi]=A.useState(window.innerWidth<768);A.useEffect(()=>{const N=()=>{bi(window.innerWidth<768)};return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),A.useEffect(()=>{const N=()=>{const U=ee||new Date;Me({start:U,end:U}),fe(null),ye(!0)};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[ee]);const lr=lt.useCallback(({date:N,label:U})=>a.jsxDEV(Sw,{date:N,label:U,filteredEvents:Qe,selectedDate:ee,user:b,isMobileView:yt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[Qe,ee,b,yt]),cr=lt.useRef(fn);cr.current=fn;const Ea=lt.useCallback(N=>{Ks(N)},[]),po=lt.useCallback(()=>{Ts(null),Ks("")},[]),Ca=lt.useCallback(({event:N})=>{if(N.id==="__inline_add__")return a.jsxDEV(ww,{onSave:Gt,onCancel:Qs,processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const U=(ss==null?void 0:ss.id)===N.id||(ss==null?void 0:ss.mergedEventIds)&&ss.mergedEventIds.includes(N.id);return a.jsxDEV(Tw,{event:N,user:b,filterProject:Ae,isEditing:U,editTitle:U?cr.current:void 0,onEditTitleChange:U?Ea:void 0,onEditSave:U?Ys:void 0,onEditDelete:U?()=>Ot(N):void 0,onEditCancel:U?po:void 0,onHoverDelete:()=>Ot(N),onDeleteAction:()=>{Fe.current=!0},processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[b,Ae,ss,Ys,Ot,Gt,Qs,Ea,po,de]),vc=({onNavigate:N})=>{const[U,Y]=lt.useState(!1),[K,le]=lt.useState(ot(P).year()),[ge,he]=lt.useState(ot(P).month()),at=window.innerWidth<768,pt=()=>{le(ot(P).year()),he(ot(P).month()),Y(!0)},gs=()=>{O(ot().year(K).month(ge).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${at?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>N("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:pt,children:[a.jsxDEV("span",{children:ot(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ae==="all"?" ":Ae]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>N("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ae,onChange:Lt=>{Rs(Lt.target.value),Mt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(b==null?void 0:b.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),V.filter(Lt=>Lt.status!=="completed").map(Lt=>a.jsxDEV("option",{value:Lt.name,children:Lt.name},Lt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),U&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(K-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[K,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(K+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Lt=>{const It=ge===Lt-1,ns=ot().year()===K&&ot().month()===Lt-1;return a.jsxDEV("button",{onClick:()=>he(Lt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${It?"bg-gray-900 text-white":ns?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Lt,""]},Lt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{O(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:gs,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},_c=()=>null,Dc=A.useMemo(()=>({toolbar:vc,event:Ca,month:{dateHeader:lr,showMore:_c}}),[lr,Ca]),ur=lt.useMemo(()=>{if(!ee)return[];let N;if(yt)N=Qe.filter(Y=>ot(Y.start).isSame(ee,"day"));else{const Y=ot(ee).startOf("week"),K=ot(ee).endOf("week");N=Qe.filter(le=>{const ge=ot(le.start);return ge.isSameOrAfter(Y,"day")&&ge.isSameOrBefore(K,"day")})}const U=[...N].sort((Y,K)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),ge=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["",""].includes(I),he=Y.assignedTo&&Y.assignedTo.includes("")&&I&&["","",""].includes(I),at=Y.assignedTo&&I&&Y.assignedTo.includes(I)||Y.assignedTo&&(b==null?void 0:b.name)&&Y.assignedTo.includes(b.name)||le||ge||he,pt=K.assignedTo&&K.assignedTo.includes("HV LAB"),gs=K.assignedTo&&K.assignedTo.includes("")&&I&&["",""].includes(I),Lt=K.assignedTo&&K.assignedTo.includes("")&&I&&["","",""].includes(I),It=K.assignedTo&&I&&K.assignedTo.includes(I)||K.assignedTo&&(b==null?void 0:b.name)&&K.assignedTo.includes(b.name)||pt||gs||Lt;return at&&!It?-1:!at&&It?1:new Date(Y.start).getTime()-new Date(K.start).getTime()});return console.log("Sorted events:",U.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:b==null?void 0:b.name,userShort:I}))),U},[ee,Qe,b,I,yt]);return A.useEffect(()=>{const U=setTimeout(()=>{const Y=yt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),K=document.querySelectorAll(".rbc-month-row"),le=[];K.forEach((Et,es)=>{const ps=Et.querySelectorAll(".rbc-date-cell");let zt=0;ps.forEach(Kt=>{const ht=Kt.querySelector("button");let Jt=ht==null?void 0:ht.textContent;if(!Jt){const bn=Kt.querySelector("span");Jt=bn==null?void 0:bn.textContent}if(Jt&&!isNaN(parseInt(Jt))){const bn=ot(P).date(parseInt(Jt)),In=Qe.filter(Ni=>ot(Ni.start).isSame(bn,"day"));zt=Math.max(zt,In.length)}}),le.push(zt)});const ge=Ae&&Ae!=="all",he=100,at=ge?60:18,pt=25,gs=Math.floor((he-pt)/at),Lt=le.length,It=he*Lt,ns=le.map(Et=>Et<=gs?he:pt+Et*at+10),Es=ns.reduce((Et,es)=>Et+es,0);if(Es>It){const Et=ns.map((zt,Kt)=>({index:Kt,height:zt,overflow:zt>he})),es=Et.filter(zt=>zt.overflow).reduce((zt,Kt)=>zt+(Kt.height-he),0),ps=Et.filter(zt=>!zt.overflow);if(ps.length>0){const zt=It-es-ps.length*he,Kt=Math.max(50,he+zt/ps.length);K.forEach((ht,Jt)=>{const In=ns[Jt]>he?ns[Jt]:Kt;ht.style.height=`${In}px`,ht.style.minHeight=`${In}px`})}else{const zt=It/Es;K.forEach((Kt,ht)=>{const Jt=Math.max(80,ns[ht]*zt);Kt.style.height=`${Jt}px`,Kt.style.minHeight=`${Jt}px`})}}else{const Et=ns.reduce((Kt,ht)=>Kt+(ht>he?ht:0),0),es=ns.filter(Kt=>Kt<=he).length,ps=It-Et,zt=es>0?ps/es:he;K.forEach((Kt,ht)=>{const Jt=ns[ht]>he?ns[ht]:zt;Kt.style.height=`${Jt}px`,Kt.style.minHeight=`${Jt}px`})}Y.forEach(Et=>{const es=Et.querySelector("button");let ps=es==null?void 0:es.textContent;if(!ps){const Jt=Et.querySelector("span");ps=Jt==null?void 0:Jt.textContent}if(!ps||isNaN(parseInt(ps)))return;const zt=ot(P).date(parseInt(ps)),Kt=Qe.filter(Jt=>ot(Jt.start).isSame(zt,"day"));Kt.length>0?Et.setAttribute("data-event-count",Kt.length.toString()):Et.removeAttribute("data-event-count");const ht=zt.clone().toDate();if(ee&&ot(ht).isSame(ee,"day")?Et.classList.add("selected-date"):Et.classList.remove("selected-date"),yt){const Jt=Et,bn=Jt._mobileClickHandler;bn&&Et.removeEventListener("click",bn);const In=Ni=>{if(Ni.target.closest(".rbc-event"))return;const xi=zt.clone().toDate();Ge(xi);const Nn=document.querySelector(".md\\:hidden.mt-3.bg-white");Nn&&Nn.scrollIntoView({behavior:"smooth",block:"nearest"})};Jt._mobileClickHandler=In,Et.addEventListener("click",In,!0),Et.style.cursor="pointer",Et.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(U),yt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(K=>{const le=K,ge=le._mobileClickHandler;ge&&(K.removeEventListener("click",ge),delete le._mobileClickHandler)})}},[Qe,P,yt,ee,Ae]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[Je.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:ot(Je.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:Je.projectId,onChange:N=>Nt({...Je,projectId:N.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:V.filter(N=>N.status!=="completed").map(N=>a.jsxDEV("option",{value:N.id,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:Je.title,onChange:N=>Nt({...Je,title:N.target.value}),onKeyPress:N=>{N.key==="Enter"&&is()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:is,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Nt({date:null,projectId:"",title:""}),Ge(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ae!=="all"&&!yt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>E(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),me&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:de.map(N=>a.jsxDEV("div",{draggable:!0,onClick:()=>{Mt(me===N?null:N)},onDragStart:U=>{Ie.current=!1,Mt(null),be(N),De.current=N,U.dataTransfer.setData("text/plain",N),U.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Ie.current||(be(null),De.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${me===N?"bg-blue-500 text-white ring-2 ring-blue-300":H===N?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ae!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(Ew,{localizer:Vw,events:Qe,startAccessor:"start",endAccessor:"end",view:$t,onView:ct,date:P,onNavigate:O,onSelectEvent:gt,onSelectSlot:Zt,onEventDrop:Ae!=="all"?Ne:void 0,onDragStart:Ae!=="all"?Ze:void 0,onDropFromOutside:Ae!=="all"?Dt:void 0,dragFromOutsideItem:Ae!=="all"?fs:void 0,draggableAccessor:N=>Ae!=="all"&&N.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:Ln,dayPropGetter:yi,components:Dc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:N=>`+${N} `}},`calendar-${Ae}-${(ee==null?void 0:ee.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ee&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:yt?ot(ee).format("MM DD (ddd)"):`${ot(ee).startOf("week").format("MM DD")} - ${ot(ee).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Go[ot(ee).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Go[ot(ee).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ae!=="all"&&a.jsxDEV("button",{onClick:()=>v(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Ge(null),en(null),v(!1),y("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:ur.length===0?a.jsxDEV("div",{className:"p-4",children:Ae!=="all"&&Tn?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:q,onChange:N=>y(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&q.trim()){const U=ee||new Date,Y={id:"",title:q.trim(),start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{v(!1),y("")}).catch(K=>{console.error("  :",K),ne.error("  ")})}else N.key==="Escape"&&(v(!1),y(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(q.trim()){const N=ee||new Date,U={id:"",title:q.trim(),start:N,end:N,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{v(!1),y("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{v(!1),y("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const N=ur.reduce((Y,K)=>{const le=ot(K.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(K),Y},{});return Object.keys(N).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!yt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:ot(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:N[Y].map(K=>{const le=K.assignedTo&&K.assignedTo.includes("HV LAB"),ge=K.assignedTo&&K.assignedTo.includes("")&&I&&["",""].includes(I),he=K.assignedTo&&K.assignedTo.includes("")&&I&&["","",""].includes(I),pt=K.assignedTo&&(K.assignedTo.includes((b==null?void 0:b.name)||"")||I&&K.assignedTo.includes(I))||le||ge||he,gs=!K.color&&!pt,Lt=!K.isASVisit&&!K.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const It={...K,title:K.originalTitle||K.title};gt(It)},className:`p-3 cursor-pointer ${pt?"bg-yellow-50":""}`,style:gs?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:pt?"#FEF3C7":K.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:K.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),K.assignedTo&&K.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Es=>K.assignedTo.includes(Es))?"":K.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),K.projectName&&Ae==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:K.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Lt?a.jsxDEV("button",{onClick:It=>{It.stopPropagation(),en(K)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ae!=="all"&&Tn&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:q,onChange:N=>y(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&q.trim()){const U=ee||new Date,Y={id:"",title:q.trim(),start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{v(!1),y("")}).catch(K=>{console.error("  :",K),ne.error("  ")})}else N.key==="Escape"&&(v(!1),y(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(q.trim()){const N=ee||new Date,U={id:"",title:q.trim(),start:N,end:N,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{v(!1),y("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{v(!1),y("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),yt&&Ae!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:de.map(N=>a.jsxDEV("button",{onClick:async()=>{const U=ee||new Date;if(Ae!=="all"){const Y={id:"",title:N,start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(Y)}catch(K){console.error("  :",K),ne.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),J&&a.jsxDEV(tb,{event:ue,slotInfo:Ce,defaultProjectName:Ae!=="all"?Ae:void 0,onClose:()=>{ye(!1),fe(null),Me(null)},onSave:async N=>{console.log(" Schedule.tsx onSave called with newEvent:",N);try{if(ue)if(ue.id.startsWith("as-")){const U=ue.id.replace("as-","");let Y="";N.assignedTo&&Array.isArray(N.assignedTo)&&N.assignedTo.length>0?Y=N.assignedTo.join(", "):ue.assignedTo&&Array.isArray(ue.assignedTo)?Y=ue.assignedTo.join(", "):typeof ue.assignedTo=="string"&&(Y=ue.assignedTo),await m(U,{project:N.title||ue.title,assignedTo:Y,scheduledVisitDate:N.start,scheduledVisitTime:N.time||ue.time}),await d(),ye(!1)}else if(ue.id.startsWith("payment-")){const U=ue.id.split("-"),Y=U[1],K=U[2],le=f.find(ge=>ge.id===Y);if(le){const ge={...le.expectedPaymentDates};ge[K]=N.start,await h(Y,{expectedPaymentDates:ge})}}else{console.log(" Updating schedule with projectId:",N.projectId,"projectName:",N.projectName);let U=N.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(U=U.replace(Y,""),ue.mergedEventIds&&ue.mergedEventIds.length>0){console.log(" Updating merged schedules:",ue.mergedEventIds);const K=(ue.originalTitle||ue.title).split(", "),le=U.split(", ");for(let ge=0;ge<ue.mergedEventIds.length;ge++){const he=ue.mergedEventIds[ge],at=le[ge]||K[ge]||U;await o(he,{title:at.trim(),start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}}else await o(ue.id,{title:U,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}else{console.log(" Adding schedule with projectId:",N.projectId,"projectName:",N.projectName);const U={id:Date.now().toString(),title:N.title,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName||"",location:"",attendees:N.assignedTo||[],description:N.description||"",time:N.time||"-"};await i(U)}ye(!1)}catch(U){console.error("Failed to save schedule:",U),ne.error("  ")}},onDelete:async N=>{try{if(N.startsWith("payment-")){const U=N.split("-"),Y=U[1],K=U[2],le=f.find(ge=>ge.id===Y);if(le){const ge={...le.expectedPaymentDates};delete ge[K],await h(Y,{expectedPaymentDates:ge})}}else if(N.startsWith("as-")){const U=N.replace("as-","");await m(U,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const U=jt.find(Y=>Y.id===N);if(U!=null&&U.mergedEventIds&&U.mergedEventIds.length>0){console.log("Deleting merged schedules:",U.mergedEventIds);for(const Y of U.mergedEventIds)await l(Y)}else await l(N)}ye(!1)}catch(U){console.error("Failed to delete schedule:",U),ne.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),R&&te&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:$.x-50,top:$.y-15,backgroundColor:R.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:R.originalTitle||R.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Sn&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>en(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Sn.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>en(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const N=Sn.mergedEventIds||[Sn.id];await Promise.all(N.map(U=>l(U)))}catch(N){console.error("  :",N),ne.error(" ")}en(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),x&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{E(!1),k(null),L("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{E(!1),k(null),L("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:N=>L(N.target.value),onKeyDown:N=>N.key==="Enter"&&Le(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Le,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:pe?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((N,U)=>a.jsxDEV("div",{draggable:(S==null?void 0:S.id)!==N.id,onDragStart:()=>it(U),onDragOver:Y=>St(Y,U),onDragEnd:st,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ft===U?"opacity-50 bg-gray-100":""} ${Ht===U?"border-t-2 border-gray-400":""} ${(S==null?void 0:S.id)!==N.id?"cursor-grab active:cursor-grabbing":""}`,children:(S==null?void 0:S.id)===N.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:_e,onChange:Y=>Ue(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&ze(),Y.key==="Escape"&&(k(null),Ue(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:ze,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),Ue("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:U+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:N.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(N),Ue(N.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>bt(N.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},Iw=({projectName:s,onClose:e,type:t="cash"})=>{const n=t==="cash",r=n?"":"",i=n?"      .":"      .",[o,l]=A.useState({receiptDate:Ft(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],b=["","","",""],V=["","","","","","","","","",""];let _="",w=0;for(;f>0;){const B=f%1e4;if(B>0){let I="",F=B,oe=0;for(;F>0;){const se=F%10;se>0&&(I=V[se]+b[oe]+I),F=Math.floor(F/10),oe++}_=I+h[w]+_}f=Math.floor(f/1e4),w++}return _+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:n?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Pw="HVLabImageDB",jw=1,jr="paymentRecordImages";let el=null;const dd=()=>new Promise((s,e)=>{if(el){s(el);return}const t=indexedDB.open(Pw,jw);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{el=t.result,s(el)},t.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains(jr)||r.createObjectStore(jr,{keyPath:"id"})}}),Rw=async()=>{try{const s=await dd();return new Promise((e,t)=>{const i=s.transaction(jr,"readonly").objectStore(jr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(s){console.error("IndexedDB , localStorage :",s);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},Bw=async(s,e)=>{try{const t=await dd();return new Promise((n,r)=>{const l=t.transaction(jr,"readwrite").objectStore(jr).put({id:s,images:e});l.onsuccess=()=>n(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},Uw=async s=>{try{const e=await dd();return new Promise((t,n)=>{const r=e.transaction(jr,"readwrite"),i=r.objectStore(jr);i.clear(),Object.entries(s).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),n(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},Hw=async()=>{try{const s=localStorage.getItem("paymentRecordImages");if(s){const e=JSON.parse(s);Object.keys(e).length>0&&(await Uw(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(s){console.error(" :",s)}},tl=s=>{if(!s)return 0;try{const t=new Date(s).getTime();return isNaN(t)?0:t}catch{return 0}},qp=(s,e,t)=>{if(!s)return null;try{const n=new Date(s);return isNaN(n.getTime())?null:Ft(n,e,t)}catch{return null}},Mw=()=>{const{payments:s,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:n,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=tr(),{user:l}=Mr(),u=dc(),[m,d]=A.useState(""),[f,h]=A.useState(null),[b,V]=A.useState(null),[_,w]=A.useState(!1),[B,I]=A.useState(!1),[F,oe]=A.useState(!1),[se,M]=A.useState(!1),[C,x]=A.useState(""),[E,j]=A.useState("form"),[L,S]=A.useState(!1),[k,_e]=A.useState(!1),Ue=A.useRef(null),[pe,je]=A.useState("pending"),[ft,qt]=A.useState("all"),[Ht,ae]=A.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[He,de]=A.useState(!1),[Le,ze]=A.useState(null),[bt,it]=A.useState(!1),[St,st]=A.useState(""),[ut,ms]=A.useState(!1),Q=A.useRef(!1),Te=A.useRef(!1),Re=A.useRef(null),[we,Ye]=A.useState([]),[Tt,$t]=A.useState([]),[ct,P]=A.useState(null),[O,J]=A.useState([]),[ye,ue]=A.useState([]),[fe,Ce]=A.useState(!1),[Me,et]=A.useState({}),[Ae,Rs]=A.useState(!1),jt=()=>{const v=localStorage.getItem("lastSelectedProject"),q=u.filter(y=>y.status!=="completed");return v&&q.some(y=>y.name===v)?v:q.length>0?q[0].name:""},[ee,Ge]=A.useState({project:"",date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});A.useEffect(()=>{(async()=>{try{const q=await Zn.getAllContractors();Ye(q.map(y=>({id:y._id||y.id,rank:y.rank,companyName:y.companyName,name:y.name,process:y.process,contact:y.contact,accountNumber:y.accountNumber,bankName:y.bankName,notes:y.notes,createdAt:new Date(y.createdAt),updatedAt:new Date(y.updatedAt)})))}catch(q){console.error("Failed to load contractors:",q)}})()},[]),A.useEffect(()=>{qt("all"),t().catch(q=>{console.error("Failed to load projects:",q)}),e().catch(q=>{console.error("Failed to load payments:",q)});const v=()=>{S(window.innerWidth<1024)};if(v(),window.addEventListener("resize",v),u.length>0&&!ee.project&&!Te.current){const q=jt();q&&(Ge(y=>({...y,project:q})),localStorage.setItem("lastSelectedProject",q))}return()=>window.removeEventListener("resize",v)},[]);const H=A.useRef(new Map);A.useEffect(()=>{console.log("[ ] Firestore  ...");const v=ln.subscribeToPayments(q=>{console.log("[ ]  :",q.length,""),q.forEach(T=>{const $=String(T.id),Z=H.current.get($);if(Z&&Z!=="completed"&&T.status==="completed"){const z=s.find(G=>String(G.id)===$);(!z||z.status!=="completed")&&ne.success(`: ${T.project_name||""} ${T.item_name||""}`.trim(),{duration:4e3})}});const y=new Map;q.forEach(T=>{y.set(String(T.id),T.status)}),H.current=y;const R=q.map(T=>({id:String(T.id),project:T.project_name||"",purpose:T.description,process:T.vendor_name,itemName:T.item_name||"",amount:T.amount,materialAmount:T.material_amount||0,laborAmount:T.labor_amount||0,originalMaterialAmount:T.original_material_amount||0,originalLaborAmount:T.original_labor_amount||0,applyTaxDeduction:T.apply_tax_deduction===1,includesVAT:T.includes_vat===1,quickText:T.quick_text||"",images:(()=>{if(!T.images)return[];if(Array.isArray(T.images))return T.images;try{const $=JSON.parse(T.images);return Array.isArray($)?$:[]}catch{return[]}})(),category:T.request_type,status:T.status,urgency:"normal",requestedBy:T.requester_name,requestDate:new Date(T.created_at),approvalDate:T.approved_at?new Date(T.approved_at):void 0,bankInfo:{accountHolder:T.account_holder||"",bankName:T.bank_name||"",accountNumber:T.account_number||""},attachments:[],notes:T.notes||"",completionDate:T.paid_at?new Date(T.paid_at):void 0}));Re.current||tr.setState({payments:R})});return()=>{console.log("[ ] Firestore  "),v()}},[]),A.useEffect(()=>{const v=()=>{if(document.visibilityState==="visible"){if(Re.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(R=>{console.error("[ ] :",R)})}};document.addEventListener("visibilitychange",v);let q=null;return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(console.log("[ ] 3   "),q=setInterval(()=>{document.visibilityState==="visible"&&!Re.current&&e().catch(R=>{console.error("[ ]  :",R)})},3e3)),()=>{document.removeEventListener("visibilitychange",v),q&&clearInterval(q)}},[e]),A.useEffect(()=>{(async()=>{var R,T,$,Z;if(Q.current)return;const q=new URLSearchParams(window.location.search),y=q.get("complete")||q.get("c");if(y){if(!l){console.log("[ ]   -  ");return}Q.current=!0,console.log("[ ]  :",y),window.history.replaceState({},"","/payments"),Te.current=!0,j("list"),je("completed"),qt("all"),Ge(z=>({...z,project:""})),o(String(y),{status:"completed",completionDate:new Date}),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(y),{status:"completed"}),await e();const z=jl.getSocket();z&&z.emit("payment:refresh",{paymentId:y,status:"completed",updatedAt:new Date().toISOString()})}catch(z){console.error("[ ]  :",z),o(String(y),{status:"pending",completionDate:void 0}),je("pending");let G="  ";((R=z.response)==null?void 0:R.status)===401?G=" .  ":((T=z.response)==null?void 0:T.status)===404?G="     (ID: "+y+")":(Z=($=z.response)==null?void 0:$.data)!=null&&Z.error?G=z.response.data.error:z.message&&(G+=": "+z.message),ne.error(G)}}})()},[e,i,o,l]),A.useEffect(()=>{if(ee.process){const v=new Set(s.filter(T=>{var $;return T.status==="completed"&&(($=T.bankInfo)==null?void 0:$.accountHolder)}).map(T=>T.bankInfo.accountHolder.trim().toLowerCase())),q=(T,$)=>{const Z=T.toLowerCase(),z=$.toLowerCase();if(Z.includes(z)||z.includes(Z))return!0;const G=Z.split("/").map(Oe=>Oe.trim()),te=z.replace(/$/,"").trim();for(const Oe of G)if(Oe===te||te.includes(Oe)||Oe.includes(te))return!0;return!1},R=we.filter(T=>{if(!q(ee.process,T.process))return!1;const Z=T.accountNumber&&T.accountNumber.trim()!=="",z=T.name.trim().toLowerCase(),G=v.has(z);return Z||G}).sort((T,$)=>{const Z=T.accountNumber&&T.accountNumber.trim()!=="",z=$.accountNumber&&$.accountNumber.trim()!=="";return Z&&!z?-1:!Z&&z?1:0});$t(R)}else $t([])},[ee.process,we,s]),A.useEffect(()=>{if(ee.process){const v=(R,T)=>{if(!T)return!1;const $=R.toLowerCase(),Z=T.toLowerCase();if($.includes(Z)||Z.includes($))return!0;const z=$.split("/").map(te=>te.trim()),G=Z.replace(/$/,"").trim();for(const te of z)if(te===G||G.includes(te)||te.includes(G))return!0;return!1},q=s.filter(R=>{var T,$,Z;return R.status==="completed"&&R.process&&v(ee.process,R.process)&&((T=R.bankInfo)==null?void 0:T.accountHolder)&&(($=R.bankInfo)==null?void 0:$.bankName)&&((Z=R.bankInfo)==null?void 0:Z.accountNumber)}),y=new Map;q.forEach(R=>{const T=`${R.bankInfo.accountHolder}_${R.bankInfo.bankName}_${R.bankInfo.accountNumber}`;y.has(T)||y.set(T,{accountHolder:R.bankInfo.accountHolder,bankName:R.bankInfo.bankName,accountNumber:R.bankInfo.accountNumber,itemName:R.itemName||"",amount:R.amount||0})}),J(Array.from(y.values()))}else J([])},[ee.process,s]),A.useEffect(()=>{var q;const v=((q=ee.accountHolder)==null?void 0:q.trim())||"";if(v.length>=1&&fe){const y=[],R=new Set;we.filter(T=>T.accountNumber&&T.accountNumber.trim()!=="").forEach(T=>{const $=T.name.trim(),Z=$.toLowerCase(),z=v.toLowerCase();Z.startsWith(z)&&!R.has(Z)&&(R.add(Z),y.push({name:$,bankName:T.bankName||"",accountNumber:T.accountNumber||"",source:"contractor"}))}),s.filter(T=>{var $;return T.status==="completed"&&(($=T.bankInfo)==null?void 0:$.accountHolder)}).forEach(T=>{const $=T.bankInfo.accountHolder.trim(),Z=$.toLowerCase(),z=v.toLowerCase();Z.startsWith(z)&&!R.has(Z)&&(R.add(Z),y.push({name:$,bankName:T.bankInfo.bankName||"",accountNumber:T.bankInfo.accountNumber||"",source:"payment"}))}),ue(y)}else ue([])},[ee.accountHolder,fe,we,s]);const be=v=>{const q=v.split(`
`).map(z=>z.trim()).filter(z=>z),y={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},R=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],T=z=>{const G=["","","","","","","",""];for(const te of G)if(z.endsWith(te)&&z.length>te.length+1)return z.slice(0,-te.length);return z},$=z=>{if(!z||z.length<2||z.length>5||!/^[-]{2,5}$/.test(z)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(z)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(z))return!1;if(z.length>=2){const Oe=z.charAt(0),Ke=z.substring(0,2);if(["","","","","","",""].includes(Ke)||R.includes(Oe))return!0}return z.length>=2&&z.length<=4},Z=q.some(z=>z.includes(" ")||z.includes(""));if(q.forEach((z,G)=>{if(z.includes("")&&z.includes(":")){const te=z.match(/\s*:\s*(.+)/);te&&(y.itemName=te[1].trim())}if(z.includes("")&&z.includes(":")){const te=z.match(/\s*:\s*(.+)/);te&&(y.bankInfo.accountHolder=te[1].trim())}if(z.includes("")&&z.includes(":")){const te=z.match(/\s*:\s*(.+)/);te&&(y.bankInfo.bankName=te[1].trim())}if(z.includes("")&&z.includes(":")){const te=z.match(/\s*:\s*(.+)/);te&&(y.bankInfo.accountNumber=te[1].trim())}if(z.includes("")&&z.includes(":")){const te=z.match(/\s*:\s*([\d,]+)?/);te&&(y.amounts.total=parseInt(te[1].replace(/,/g,"")))}}),!Z){let z=-1;if(q.forEach(G=>{const te=G.match(/\[([^\]]+)\]/);te&&!y.itemName&&(y.itemName=te[1].trim())}),q.forEach((G,te)=>{if(G.includes("")||G.includes(" ")||G.includes("()")){y.includeVat=!0;const We=G.match(/(\d+)\s*\s*(\d+)\s*\s*?/),ke=G.match(/(\d+)\s*\s*?/),Qe=G.match(/([\d,]+)\s*/);if(We){const Je=parseInt(We[1])*1e4+parseInt(We[2])*1e3;y.amounts.total=Je}else if(ke){const Je=parseInt(ke[1])*1e4;y.amounts.total=Je}else if(Qe){const Je=parseInt(Qe[1].replace(/,/g,""));Je>=1e3&&(y.amounts.total=Je)}return}const Ke=G.match(/=\s*([\d,]+)\s*?/);let Fe=null;if(Ke){const We=parseInt(Ke[1].replace(/,/g,""));We>=1e3&&(y.amounts.total=We)}else{const We=G.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(We){const ke=parseInt(We[1])*1e4,Qe=parseInt(We[2])*1e3,Je=ke+Qe;G.includes("")||G.includes("")?y.amounts.material=Je:G.includes("")||G.includes("")?y.amounts.labor=Je:y.amounts.total||(y.amounts.total=Je),G=G.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Fe=We}else if(Fe=G.match(/(\d+)\s*\s*?/),Fe){const ke=parseInt(Fe[1])*1e4;G.includes("")||G.includes("")?y.amounts.material=ke:G.includes("")||G.includes("")?y.amounts.labor=ke:y.amounts.total||(y.amounts.total=ke),G=G.replace(/(\d+)\s*\s*?/g,"")}}G.includes("/")&&G.split("/").forEach(ke=>{const Qe=ke.trim();Qe.startsWith("[")||Qe.endsWith("]")||(/^[\d\-]+$/.test(Qe)&&Qe.replace(/\-/g,"").length>=10?y.bankInfo.accountNumber||(y.bankInfo.accountNumber=Qe):$(Qe)&&!y.bankInfo.accountHolder&&(y.bankInfo.accountHolder=Qe))});const Ne=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Ze="",Yt=-1;for(const We of Ne){const ke=G.match(We);if(ke&&!y.bankInfo.accountNumber){Ze=ke[0],Yt=ke.index||-1,y.bankInfo.accountNumber=ke[0].trim().replace(/\s+/g,"-");const Je=G.substring(Yt+Ze.length).trim().split(/\s+/);for(const Nt of Je){if(Nt.startsWith("[")||Nt.endsWith("]"))continue;const Be=T(Nt);if($(Be)){y.bankInfo.accountHolder=Be;break}}if(!y.bankInfo.accountHolder&&te>0){const Be=q[te-1].split(/\s+/);for(const nt of Be){if(nt.startsWith("[")||nt.endsWith("]"))continue;const gt=T(nt);if($(gt)){y.bankInfo.accountHolder=gt;break}}}if(!y.bankInfo.accountHolder&&te+1<q.length){const Nt=q[te+1],Be=Nt.split(/\s+/);for(const nt of Be){if(nt.startsWith("[")||nt.endsWith("]"))continue;const gt=T(nt);if($(gt)){y.bankInfo.accountHolder=gt;break}}if(!y.bankInfo.accountHolder){const nt=Nt.match(/^([-]{2,6})/);if(nt){const gt=T(nt[1].trim());$(gt)&&(y.bankInfo.accountHolder=gt)}}}break}}const Dt=G.match(/[\d,]+/g);if(Dt){const We=Ze?Ze.split(/[\s\-]+/).filter(ke=>ke):[];Dt.forEach(ke=>{const Qe=parseInt(ke.replace(/,/g,"")),Je=ke.replace(/,/g,""),Nt=We.some(Be=>Be===Je);!y.bankInfo.accountNumber&&Je.length>=10&&Je.length<=20?(y.bankInfo.accountNumber=Je,Ze=Je):Qe>=1e3&&!Fe&&!Nt&&(G.includes("")||G.includes("")?y.amounts.material=Qe:G.includes("")||G.includes("")?y.amounts.labor=Qe:y.amounts.total||(y.amounts.total=Qe))})}const fs={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Gt=Object.keys(fs).sort((We,ke)=>ke.length-We.length);for(const We of Gt)if(G.includes(We)){const ke=fs[We];y.bankInfo.bankName=ke,z=te;const Qe=new RegExp(`${We}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),Je=G.match(Qe);if(Je){const Nt=T(Je[1]);Nt&&!/^\d+$/.test(Nt)&&Nt!==""&&(y.bankInfo.accountHolder=Nt)}break}if(!y.bankInfo.bankName){const We=G.match(/([-]+)(|)/);We&&(y.bankInfo.bankName=We[0])}const Qs=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const We of Qs){const ke=G.match(We);if(ke&&!y.bankInfo.accountHolder){y.bankInfo.accountHolder=ke[0].trim();break}}const Ys=G.match(/\(([-]{2,5})\)/);if(Ys&&!y.bankInfo.accountHolder){const We=Ys[1];$(We)&&!["","",""].includes(We)&&(y.bankInfo.accountHolder=We)}if(!y.bankInfo.accountHolder){const We=/[-]{2,6}/g,ke=G.match(We);if(ke){const Qe=G.match(/\d{10,}/)||G.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),Je=G.match(/||||/);ke.forEach(Nt=>{const Be=T(Nt),nt=v.split(`
`)[te];if(nt&&nt.includes(`[${Nt}]`)||!$(Be)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Be))return;const Zt=G.indexOf(Nt);if(Zt>0){const is=G[Zt-1];if(/[-]/.test(is))return}if(Zt+Nt.length<G.length){const is=G[Zt+Nt.length];if(/[-]/.test(is))return}if(!(Ys&&Be===Ys[1])){if((Qe||Je)&&!y.bankInfo.accountHolder)y.bankInfo.accountHolder=Be;else if(!y.bankInfo.accountHolder){const is=/||||/,Ln=/\d{6,}/;(te>0&&(Ln.test(q[te-1])||is.test(q[te-1]))||te<q.length-1&&(Ln.test(q[te+1])||is.test(q[te+1]))||is.test(G))&&(y.bankInfo.accountHolder=Be)}}})}}const Ot={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[We,ke]of Object.entries(Ot))if(G.includes(We)){y.vendor=ke;break}if(te===0&&!y.itemName){const We=G.replace(/[\[\]{}()<>]/g,"").trim();We&&!We.includes(" ")&&($(We)||(y.itemName=We.substring(0,50)))}}),z>=0&&z+1<q.length){const G=q[z+1],te=G.trim();if(/^[-]{2,5}$/.test(te)&&$(te))y.bankInfo.accountHolder=te;else{const Oe=G.split(/\s+/);for(const Ke of Oe){const Fe=T(Ke);if($(Fe)){y.bankInfo.accountHolder=Fe;break}}}}}if(y.itemName&&y.itemName.includes("")&&(y.vendor=""),y.itemName){const z=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],G=y.itemName.toLowerCase(),te=z.some(Ne=>G===Ne.toLowerCase()||G.startsWith(Ne.toLowerCase()+" ")||G.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Oe=/^[\d\-\s]/.test(y.itemName),Ke=/^\d{2,}[\s\-]?\d+/.test(y.itemName.replace(/[-]/g,"").trim()),Fe=y.bankInfo.accountHolder&&(y.itemName===y.bankInfo.accountHolder||y.itemName.includes(y.bankInfo.accountHolder));(te||Oe||Ke||Fe)&&(y.itemName=void 0)}return y},De=async()=>{var v,q,y,R,T,$,Z,z,G,te,Oe;try{const Ke=ee.quickText;if(!Ke.trim())return;let Fe=s;s.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(ke=>setTimeout(ke,100)),Fe=tr.getState().payments,console.log("payments  :",Fe.length,""));const Ne=be(Ke);console.log("  :",Ne);const Ze={project:ee.project,date:ee.date,quickText:ee.quickText,quickImages:ee.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),I(!1),oe(!1);let Yt=0;Ne.amounts.material&&(Yt+=Ne.amounts.material),Ne.amounts.labor&&(Yt+=Ne.amounts.labor),Ne.amounts.total&&!Ne.amounts.material&&!Ne.amounts.labor&&(Yt=Ne.amounts.total),Yt>0&&(Ze.amount=Yt),Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),Ne.bankInfo.accountHolder&&(Ze.accountHolder=Ne.bankInfo.accountHolder),Ne.bankInfo.accountNumber&&(Ze.accountNumber=Ne.bankInfo.accountNumber);const Dt=ke=>ke?ke.replace(/[^0-9]/g,""):"",fs=(ke,Qe)=>{if(!ke||!Qe)return!1;const Je=Dt(ke),Nt=Dt(Qe);if(!Je||!Nt)return!1;const Be=6;return Je.length<Be||Nt.length<Be?Je===Nt:Nt.includes(Je)||Je.includes(Nt)},Gt=Dt(Ne.bankInfo.accountNumber||""),Qs=Ne.bankInfo.accountHolder||"";let Ys=!1;console.log("===    ==="),console.log(" :",Ne.bankInfo.accountNumber),console.log(" :",Gt),console.log(" :",Qs),console.log(" :",we.length),console.log("  :",Fe.filter(ke=>ke.status==="completed").length);let Ot=we.find(ke=>{const Qe=Dt(ke.accountNumber||"");return Qe&&Qe===Gt});if(!Ot&&Gt&&(Ot=we.find(ke=>{const Qe=Dt(ke.accountNumber||"");return fs(Gt,Qe)})),Ot&&(Ys=!0),!Ot&&Qs&&(Ot=we.find(ke=>ke.name===Qs),Ot)){console.log("  :",Ot.name);const ke=((v=Ot.accountNumber)==null?void 0:v.replace(/[-\s]/g,""))||"";Gt&&!fs(Gt,ke)?(console.log("    ( ) -  "),Ys=!1):Ys=!0}if(Ot&&(Ot.name&&(Ze.accountHolder=Ot.name,console.log("  :",Ot.name)),Ot.bankName?Ze.bankName=Ot.bankName:Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),Ys&&(Ze.accountNumber=Ot.accountNumber||Ne.bankInfo.accountNumber),P(Ot.id||Ot._id||null),Ot.process&&(Ze.process=Ot.process)),!Ot){let ke=!1;console.log("===     ==="),console.log("  payments :",Fe.length,""),console.log(" :",Gt),console.log(" :",Qs);const Qe=Fe.filter(nt=>nt.status==="completed");console.log(" :",Qe.length);const Je=[...new Set(Qe.map(nt=>{var gt;return(gt=nt.bankInfo)==null?void 0:gt.accountHolder}).filter(Boolean))];console.log("   ( 20):",Je.slice(0,20)),console.log("  ():",Gt);const Nt=Qe.filter(nt=>{var gt;return(gt=nt.bankInfo)==null?void 0:gt.accountNumber}).map(nt=>{var gt,Zt,is;return{holder:(gt=nt.bankInfo)==null?void 0:gt.accountHolder,account:(Zt=nt.bankInfo)==null?void 0:Zt.accountNumber,clean:Dt(((is=nt.bankInfo)==null?void 0:is.accountNumber)||"")}}).filter(nt=>nt.clean.includes(Gt.substring(0,6))||Gt.includes(nt.clean.substring(0,6)));console.log("  :",Nt);let Be=Fe.find(nt=>{var is;const gt=Dt(((is=nt.bankInfo)==null?void 0:is.accountNumber)||"");return gt&&gt===Gt&&nt.status==="completed"});if(Be&&console.log("   :",(q=Be.bankInfo)==null?void 0:q.accountHolder,Be.process),!Be&&Gt&&(Be=Fe.find(nt=>{var Zt;const gt=Dt(((Zt=nt.bankInfo)==null?void 0:Zt.accountNumber)||"");return fs(Gt,gt)&&nt.status==="completed"}),Be&&console.log("   :",(y=Be.bankInfo)==null?void 0:y.accountHolder,Be.process)),Be&&(ke=!0),!Be&&Qs&&(Be=Fe.find(nt=>{var gt;return((gt=nt.bankInfo)==null?void 0:gt.accountHolder)===Qs&&nt.status==="completed"}),Be)){console.log("    :",(R=Be.bankInfo)==null?void 0:R.accountHolder,":",Be.process);const nt=Dt(((T=Be.bankInfo)==null?void 0:T.accountNumber)||"");Gt&&!fs(Gt,nt)?(console.log("    ( ) -  "),ke=!1):ke=!0}Be?(console.log(" :",{accountHolder:($=Be.bankInfo)==null?void 0:$.accountHolder,accountNumber:(Z=Be.bankInfo)==null?void 0:Z.accountNumber,bankName:(z=Be.bankInfo)==null?void 0:z.bankName,process:Be.process,status:Be.status,paymentMatchedByAccountNumber:ke}),(G=Be.bankInfo)!=null&&G.accountHolder&&(Ze.accountHolder=Be.bankInfo.accountHolder,console.log("  :",Be.bankInfo.accountHolder)),(te=Be.bankInfo)!=null&&te.bankName?Ze.bankName=Be.bankInfo.bankName:Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),ke&&(Ze.accountNumber=((Oe=Be.bankInfo)==null?void 0:Oe.accountNumber)||Ne.bankInfo.accountNumber),Be.process&&!Ze.process?(Ze.process=Be.process,console.log("    :",Be.process)):console.log("   - process:",Be.process,"updatedFormData.process:",Ze.process)):console.log("  ")}if(Ne.vendor&&(Ze.process=Ne.vendor),!Ze.process){const ke=Ke.toLowerCase();for(const Qe of Xc)if(ke.includes(Qe.toLowerCase())){Ze.process=Qe;break}}Ne.itemName&&(Ze.itemName=Ne.itemName),Ge(Ze),Ne.includeVat&&(I(!0),oe(!1));const We=[];if(Ne.amounts.material||Ne.amounts.labor||Ne.amounts.total){const ke=[];Ne.amounts.material&&ke.push(`: ${Ne.amounts.material.toLocaleString()}`),Ne.amounts.labor&&ke.push(`: ${Ne.amounts.labor.toLocaleString()}`),Ne.amounts.total&&!Ne.amounts.material&&!Ne.amounts.labor&&ke.push(`: ${Ne.amounts.total.toLocaleString()}`),We.push(ke.join(", "))}if(Ne.bankInfo.bankName||Ne.bankInfo.accountHolder){const ke=[];Ne.bankInfo.bankName&&ke.push(Ne.bankInfo.bankName),Ne.bankInfo.accountHolder&&ke.push(Ne.bankInfo.accountHolder),Ne.bankInfo.accountNumber&&ke.push(Ne.bankInfo.accountNumber),ke.length>0&&We.push(`: ${ke.join(" ")}`)}Ne.vendor&&We.push(`: ${Ne.vendor}`),Ne.includeVat&&We.push("  "),We.length>0?ne.success(`  !
${We.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):ne.info("  ...    .")}catch(Ke){console.error(" :",Ke),ne.error("   .")}};A.useEffect(()=>{(async()=>{try{await Hw();const q=await Rw();et(q),Rs(!0)}catch(q){console.error("  :",q),Rs(!0)}})()},[]);const Ie=A.useRef({});A.useEffect(()=>{Ae&&(Object.entries(Me).forEach(([v,q])=>{JSON.stringify(Ie.current[v])!==JSON.stringify(q)&&Bw(v,q).catch(y=>{console.error("  :",y),ne.error("  ")})}),Ie.current={...Me})},[Me,Ae]);const me=A.useCallback(async v=>{var R;const q=(R=v.clipboardData)==null?void 0:R.items;if(!q)return;let y=!1;for(let T=0;T<q.length;T++)if(q[T].type.indexOf("image")!==-1){y=!0;break}if(y){if(!f){const T=document.activeElement;(T==null?void 0:T.tagName)==="INPUT"||(T==null?void 0:T.tagName)==="TEXTAREA"||(T==null?void 0:T.classList.contains("form-input"))||ne.error("  ");return}for(let T=0;T<q.length;T++)if(q[T].type.indexOf("image")!==-1){v.preventDefault();const $=q[T].getAsFile();if($){const Z=new FileReader;Z.onload=async z=>{var te;const G=(te=z.target)==null?void 0:te.result;if(G)try{const Oe=s.find(Ne=>Ne.id===f),Fe=[...(Oe==null?void 0:Oe.images)||Me[f]||[],G];await ln.updatePaymentImages(f,Fe),et(Ne=>({...Ne,[f]:Fe})),await e(),ne.success(" ")}catch(Oe){console.error("  :",Oe),ne.error("  ")}},Z.readAsDataURL($)}}}},[f,s,Me,e]);A.useEffect(()=>(document.addEventListener("paste",me),()=>document.removeEventListener("paste",me)),[me]);const mt=[...(l==null?void 0:l.name)===""?s.filter(v=>u.some(q=>q.name===v.project)):s].sort((v,q)=>new Date(q.requestDate).getTime()-new Date(v.requestDate).getTime()),Wt=mt.filter(v=>{var $,Z,z;if(!v||!v.id)return!1;const q=m===""||(($=v.purpose)==null?void 0:$.toLowerCase().includes(m.toLowerCase()))||((Z=v.itemName)==null?void 0:Z.toLowerCase().includes(m.toLowerCase()))||((z=v.process)==null?void 0:z.toLowerCase().includes(m.toLowerCase())),y=pe==="pending"?v.status!=="completed":v.status==="completed",R=ft==="all"||!ft||v.project===ft,T=!Ht||pe!=="completed"||v.requestedBy===(l==null?void 0:l.username);return q&&y&&R&&T}).sort((v,q)=>!v&&!q?0:v?q?pe==="completed"?tl(q.completionDate)-tl(v.completionDate):tl(q.requestDate)-tl(v.requestDate):-1:1),At=v=>{const q=v.id||v._id||null;if(ct===q){P(null);const $=document.querySelector('input[placeholder=" "]');$&&setTimeout(()=>{$.focus()},100);return}P(q);const y=Yo(v.name);let R=v.bankName||"",T=v.accountNumber||"";if(T&&!R){const $=T.trim().split(/\s+/);if($.length>=2){const Z=$[0];(Z.includes("")||Z.includes("")||Z.includes("")||Z.includes("")||Z.includes(""))&&(R=Z,T=$.slice(1).join(""))}}Ge($=>({...$,accountHolder:y,bankName:R,accountNumber:T}))};Wt.reduce((v,q)=>{const y=q.materialAmount||0,R=q.laborAmount||0,T=q.amount||0;let $=y,Z=R,z=0;return y===0&&R===0&&T>0?q.includesVAT?($=Math.round(T/1.1),z=T-$):($=T,z=0):q.includesVAT?(y>0&&($=Math.round(y/1.1)),R>0&&(Z=Math.round(R/1.1)),z=T-($+Z)):z=0,v.material+=$,v.labor+=Z,v.vat+=z,v.total+=T,v},{material:0,labor:0,vat:0,total:0});const ds=async()=>{var q,y,R;if(ut){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ee),!ee.project){ne.error(" ");return}if(!ee.itemName){ne.error(" ");return}const v=Number(ee.amount)||0;if(v===0){ne.error(" ");return}ms(!0);try{const T=F?Math.round(v*.967):v,$=new Date;if(b){const Z={project:ee.project,requestDate:new Date(ee.date),purpose:ee.itemName,amount:T,category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:T,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,updatedAt:$};console.log(" Updating payment:",Z),await i(b,Z),ne.success(" "),V(null)}else{const Z=ee.project||"",z={id:`payment_${Date.now()}`,project:Z,requestDate:new Date(ee.date),requestedBy:(l==null?void 0:l.username)||"  ",purpose:ee.itemName,amount:T,status:"pending",category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:T,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,quickText:ee.quickText||"",images:ee.quickImages,attachments:[],createdAt:$,updatedAt:$};console.log(" Creating payment:",z),console.log(" Images in payment:",((q=ee.quickImages)==null?void 0:q.length)||0,"");const G=await n(z);if(Re.current=G,setTimeout(()=>{Re.current=null},1e4),ne.success(" "),ee.accountHolder&&ee.bankName&&ee.accountNumber){const te=B||F?"01074088864":"01089423283";try{await ln.sendTossPaymentSms({recipientPhone:te,accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber,amount:T,projectName:Z,itemName:ee.itemName,process:ee.process,paymentId:G}),ne.success("   ")}catch(Oe){console.error("SMS  :",Oe),ne.error("  : "+(((R=(y=Oe.response)==null?void 0:y.data)==null?void 0:R.error)||Oe.message||"   "))}}}Ge(Z=>({project:Z.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),I(!1),oe(!1),P(null),window.innerWidth<768&&j("list")}catch(T){console.error(" Payment save error:",T),ne.error("  : "+T.message)}finally{ms(!1)}},ss=v=>{var q,y,R,T;try{console.log("[handleEdit] Starting edit for payment:",v.id);const $=v.originalMaterialAmount!==void 0?v.originalMaterialAmount:v.materialAmount||0,Z=v.originalLaborAmount!==void 0?v.originalLaborAmount:v.laborAmount||0,z={project:v.project||"",date:v.requestDate?Ft(new Date(v.requestDate),"yyyy-MM-dd"):Ft(new Date,"yyyy-MM-dd"),process:v.process||"",itemName:v.itemName||v.purpose||"",materialCost:$>0?$.toString():"",laborCost:Z>0?Z.toString():"",amount:((q=v.amount)==null?void 0:q.toString())||"",accountHolder:((y=v.bankInfo)==null?void 0:y.accountHolder)||"",bankName:((R=v.bankInfo)==null?void 0:R.bankName)||"",accountNumber:((T=v.bankInfo)==null?void 0:T.accountNumber)||"",images:v.attachments||[],quickText:v.quickText||"",quickImages:v.images||[]};console.log("[handleEdit] Setting form data:",z),Ge(z),I(v.includesVAT||!1),oe(v.applyTaxDeduction||!1),h(v.id),V(v.id),L&&j("form"),console.log("[handleEdit] Edit setup complete"),ne.success("  ")}catch($){console.error("[handleEdit] Error:",$),ne.error("     ")}},Ts=async v=>{var q,y,R;try{const T=((q=v.bankInfo)==null?void 0:q.accountHolder)||v.accountHolder,$=((y=v.bankInfo)==null?void 0:y.bankName)||v.bank,Z=((R=v.bankInfo)==null?void 0:R.accountNumber)||v.accountNumber;if(!T||!$||!Z){ne.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${$}
: ${Z}
: ${v.amount.toLocaleString()}`))return;const G=Z.replace(/[-\s]/g,""),te=l1[$]||$,Oe=a1[$]||"004",Ke="",Fe=`supertoss://send?amount=${v.amount}&bankCode=${Oe}&bank=${encodeURIComponent(te)}&accountNo=${G}&receiverName=${encodeURIComponent(Ke)}&toName=${encodeURIComponent(Ke)}`;let Ne=!1;try{window.location.href=Fe,Ne=!0,ne.success("  ...",{duration:3e3}),setTimeout(()=>{const Ze=/iPhone|iPad|iPod/i.test(navigator.userAgent),Yt=/Android/i.test(navigator.userAgent);(Ze||Yt)&&ne(`      .

: 
: ${Z}
: ${v.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Ze){console.error("   :",Ze),ne(`   .

: 
: ${$}
: ${Z}
: ${v.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(T){console.error(" :",T),ne.error(`   : ${T.message}`)}},fn=async v=>{const q=s.find(y=>y.id===v);if(q&&q.quickText){const y=localStorage.getItem("executionMemos"),R=y?JSON.parse(y):{};R[v]=q.quickText,localStorage.setItem("executionMemos",JSON.stringify(R))}o(v,{status:"completed",completionDate:new Date}),de(!1),je("completed"),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(v,{status:"completed"});const y=jl.getSocket();y&&y.emit("payment:refresh",{paymentId:v,status:"completed",projectName:(q==null?void 0:q.project)||"",itemName:(q==null?void 0:q.itemName)||(q==null?void 0:q.purpose)||"",completedBy:(l==null?void 0:l.username)||""})}catch(y){console.error(" API :",y),o(v,{status:"pending",completionDate:void 0}),je("pending"),ne.error("   -  ")}},Ks=async v=>{var R;if(!f){ne.error("  ");return}const y=Array.from(((R=v.target)==null?void 0:R.files)||[]).filter(T=>T.type.startsWith("image/"));if(y.length!==0){try{const T=await Promise.all(y.map(G=>new Promise((te,Oe)=>{const Ke=new FileReader;Ke.onload=Fe=>{var Ze;const Ne=(Ze=Fe.target)==null?void 0:Ze.result;Ne?te(Ne):Oe(new Error("  "))},Ke.onerror=()=>Oe(new Error("FileReader ")),Ke.readAsDataURL(G)}))),$=s.find(G=>G.id===f),z=[...($==null?void 0:$.images)||Me[f]||[],...T];await ln.updatePaymentImages(f,z),et(G=>({...G,[f]:z})),await e(),ne.success(`${T.length}  `)}catch(T){console.error("  :",T),ne.error("  ")}v.target.value=""}},pn=async v=>{if(f)try{const q=s.find(T=>T.id===f),R=((q==null?void 0:q.images)||Me[f]||[]).filter((T,$)=>$!==v);await ln.updatePaymentImages(f,R),et(T=>({...T,[f]:R})),await e()}catch(q){console.error("  :",q),ne.error("  ")}},Kr=v=>{x(v),M(!0)},Sn=v=>{v.preventDefault(),w(!0)},en=v=>{v.preventDefault(),w(!1)},Tn=async v=>{if(v.preventDefault(),w(!1),!f){ne.error("  ");return}const y=Array.from(v.dataTransfer.files).filter(R=>R.type.startsWith("image/"));if(y.length!==0)try{const R=await Promise.all(y.map(z=>new Promise((G,te)=>{const Oe=new FileReader;Oe.onload=Ke=>{var Ne;const Fe=(Ne=Ke.target)==null?void 0:Ne.result;Fe?G(Fe):te(new Error("  "))},Oe.onerror=()=>te(new Error("FileReader ")),Oe.readAsDataURL(z)}))),T=s.find(z=>z.id===f),Z=[...(T==null?void 0:T.images)||Me[f]||[],...R];await ln.updatePaymentImages(f,Z),et(z=>({...z,[f]:Z})),await e(),ne.success(`${R.length}  `)}catch(R){console.error("  :",R),ne.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ee.project,onChange:v=>{Ge({...ee,project:v.target.value}),v.target.value&&localStorage.setItem("lastSelectedProject",v.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2492,columnNumber:35},void 0),u.filter(v=>v.status!=="completed").map(v=>a.jsxDEV("option",{value:v.name,children:v.name},v.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2494,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2482,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2481,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2503,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2513,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2523,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2502,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2501,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2500,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${E!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ee.project,onChange:v=>{Ge({...ee,project:v.target.value}),v.target.value&&localStorage.setItem("lastSelectedProject",v.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:43},void 0),u.filter(v=>v.status!=="completed").map(v=>a.jsxDEV("option",{value:v.name,children:v.name},v.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2560,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:v=>Ge({...ee,bankName:v.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2568,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2569,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2570,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2571,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2572,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2573,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2574,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2575,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2576,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2577,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2578,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2579,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2580,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2563,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ee.quickText,onChange:v=>Ge({...ee,quickText:v.target.value}),onPaste:v=>{var y;const q=(y=v.clipboardData)==null?void 0:y.items;if(q){for(let R=0;R<q.length;R++)if(q[R].type.indexOf("image")!==-1){v.preventDefault();const T=q[R].getAsFile();if(T){const $=new FileReader;$.onload=Z=>{var G;const z=(G=Z.target)==null?void 0:G.result;Ge(te=>({...te,quickImages:[...te.quickImages,z]}))},$.readAsDataURL(T)}break}}},onDragOver:v=>{v.preventDefault(),v.stopPropagation()},onDrop:v=>{v.preventDefault(),v.stopPropagation(),Array.from(v.dataTransfer.files).filter(R=>R.type.startsWith("image/")).forEach(R=>{const T=new FileReader;T.onload=$=>{var z;const Z=(z=$.target)==null?void 0:z.result;Ge(G=>({...G,quickImages:[...G.quickImages,Z]}))},T.readAsDataURL(R)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:L?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2587,columnNumber:15},void 0),ee.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ee.quickImages.map((v,q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:v,alt:` ${q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2642,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Ge(y=>({...y,quickImages:y.quickImages.filter((R,T)=>T!==q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2647,columnNumber:23},void 0)]},q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2641,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2639,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:v=>{Array.from(v.target.files||[]).forEach(y=>{const R=new FileReader;R.onload=T=>{var Z;const $=(Z=T.target)==null?void 0:Z.result;Ge(z=>({...z,quickImages:[...z.quickImages,$]}))},R.readAsDataURL(y)}),v.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2666,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2687,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2665,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:De,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2691,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2664,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2586,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ee.date&&`(${Ft(new Date(ee.date),"E",{locale:xs})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2704,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ee.date,onChange:v=>Ge({...ee,date:v.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2707,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2703,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2723,columnNumber:17},void 0),a.jsxDEV("button",{ref:Ue,type:"button",onClick:()=>_e(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ee.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2730,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2724,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2702,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ee.itemName,onChange:v=>Ge({...ee,itemName:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2736,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2749,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ee.amount?Number(ee.amount).toLocaleString():"",onChange:v=>{const q=v.target.value.replace(/[^0-9]/g,"");Ge({...ee,amount:q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2751,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2762,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2748,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:v=>v.preventDefault(),onClick:()=>{B||oe(!1),I(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2780,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2779,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:v=>v.preventDefault(),onClick:()=>{F||I(!1),oe(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2798,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2797,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2800,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2767,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2747,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Tt.length>0||O.length>0&&!ct)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Tt.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Tt.map(v=>{const q=v.id||v._id,y=ct===q;return a.jsxDEV("button",{type:"button",onClick:()=>At(v),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${y?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Yo(v.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2832,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[v.bankName||""," ",v.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2835,columnNumber:29},void 0)]},q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2822,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2817,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2813,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${O.length===0||ct?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2848,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:O.map((v,q)=>a.jsxDEV("button",{type:"button",onClick:()=>{Ge(y=>({...y,accountHolder:v.accountHolder,bankName:v.bankName,accountNumber:v.accountNumber})),J([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:v.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2865,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[v.bankName," ",v.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2868,columnNumber:27},void 0)]},q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2849,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2845,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2811,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2880,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountHolder,onChange:v=>Ge({...ee,accountHolder:v.target.value}),onFocus:()=>Ce(!0),onBlur:()=>setTimeout(()=>Ce(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2881,columnNumber:17},void 0),fe&&ye.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:ye.map((v,q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:y=>y.preventDefault(),onClick:()=>{let y=v.bankName||"",R=v.accountNumber||"";const T=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],$={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const Z of T)if(R.includes(Z)){y||(y=$[Z]||Z),R=R.replace(Z,"").trim();break}for(const Z of T)if(y.includes(Z)){const z=$[Z]||Z,G=y.replace(Z,"").trim();G&&/\d/.test(G)&&(R=G),y=z;break}R=R.replace(/[^\d\-]/g,"").trim(),Ge({...ee,accountHolder:v.name,bankName:y||ee.bankName,accountNumber:R||ee.accountNumber}),Ce(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:v.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2981,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:v.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:25},void 0)]},`${v.name}-${q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2894,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2892,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2879,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2993,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:v=>Ge({...ee,bankName:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2999,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3e3,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3001,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3002,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3003,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3004,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3005,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3006,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3011,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3013,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3014,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3015,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3017,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3018,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3019,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3021,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2994,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountNumber,onChange:v=>Ge({...ee,accountNumber:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3025,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3038,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3041,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const v=Number(ee.amount)||0;let q=v;return F&&(q=Math.round(v*.967)),q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3045,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[b&&a.jsxDEV("button",{onClick:()=>{V(null),Ge(v=>({project:v.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),I(!1),oe(!1),P(null),ne.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:19},void 0),a.jsxDEV("button",{onClick:v=>{console.log(" Payment button clicked!",v),console.log(" Button element:",v.currentTarget),console.log(" Form data:",ee),ds()},disabled:ut,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ut?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ut?"...":b?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3093,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3062,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2808,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2541,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${E!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>je("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:mt.filter(v=>v&&v.id&&v.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3132,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3123,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{je("completed"),Ge(v=>({...v,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:mt.filter(v=>v&&v.id&&v.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3151,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3138,columnNumber:17},void 0),pe==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ht,onChange:v=>{ae(v.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(v.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3160,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3159,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3122,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3121,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3120,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Wt.length>0?a.jsxDEV("div",{className:"space-y-4",children:Wt.map(v=>{var Z,z,G;const q=v.amount||0,y=((Z=v.bankInfo)==null?void 0:Z.accountHolder)||v.accountHolder||"",R=((z=v.bankInfo)==null?void 0:z.bankName)||v.bank||"",T=((G=v.bankInfo)==null?void 0:G.accountNumber)||v.accountNumber||"",$=y&&R&&T?`${y} | ${R} ${T}`:" ";return a.jsxDEV("div",{onClick:()=>h(v.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===v.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[v.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",v.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3207,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:v.purpose||v.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:v.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3213,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[v.requestedBy||"-","  ",qp(v.requestDate,"MM/dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3219,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3215,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(v.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3227,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3228,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(v.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:25},void 0),v.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3232,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3233,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:27},void 0),v.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3238,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3239,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3237,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3226,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:$},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3246,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:te=>{te.stopPropagation(),ss(v)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(VN,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3258,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async te=>{te.stopPropagation(),window.confirm("  ?")&&(await r(v.id),ne.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ii,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3271,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3260,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3249,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3245,columnNumber:23},void 0),pe==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:te=>{if(te.stopPropagation(),v.status==="completed"){ne.info("   ");return}Ts(v)},disabled:v.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${v.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:v.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3280,columnNumber:27},void 0),a.jsxDEV("button",{onClick:te=>{te.stopPropagation(),fn(v.id)},disabled:v.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${v.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:v.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:te=>{v.status!=="completed"&&(te.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:te=>{v.status!=="completed"&&(te.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3298,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3279,columnNumber:25},void 0)]},v.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3193,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3179,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3329,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3177,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3116,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${E!=="image"?"hidden lg:flex":""}`,onDragOver:Sn,onDragLeave:en,onDrop:Tn,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:Ks,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3345,columnNumber:11},void 0),L&&f&&E==="image"&&(()=>{const v=mt.find(q=>q.id===f);return v?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:v.purpose||v.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3362,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[v.process||"-","  ",qp(v.requestDate,"yyyy.MM.dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3363,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3361,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(v.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3367,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3360,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3359,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:v=>{var y;const q=v.target;if(!q.closest("img")&&!q.closest("button")&&f){const R=mt.find(z=>z.id===f),T=(R==null?void 0:R.images)||[],$=Me[f]||[];(T.length>0?T:$).length>0&&((y=document.getElementById("image-file-input"))==null||y.click())}},children:f?(()=>{const v=mt.find(T=>T.id===f),q=(v==null?void 0:v.images)||[],y=Me[f]||[],R=q.length>0?q:y;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3403,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(v==null?void 0:v.quickText)||(v==null?void 0:v.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3402,columnNumber:19},void 0),R.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:R.map((T,$)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:T,alt:` ${$+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:Z=>{Z.stopPropagation(),Kr(T)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3418,columnNumber:27},void 0),a.jsxDEV("button",{onClick:Z=>{Z.stopPropagation(),pn($)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(vs,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3434,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3427,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[$+1,"/",R.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3436,columnNumber:27},void 0)]},$,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3417,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3415,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${R.length>0?"":"flex-1"}`,onClick:T=>T.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${_?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${R.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(tu,{className:`mx-auto text-gray-400 mb-1 ${R.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:R.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:23},void 0),R.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3460,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3450,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3445,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3400,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(Io,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3469,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3470,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3467,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3377,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3337,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2538,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3485,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3490,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3486,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3484,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Xc.map(v=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:v}),_e(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ee.process===v?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:v},v,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3497,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3495,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),_e(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3494,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3483,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3482,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>_e(!1),children:a.jsxDEV("div",{onClick:v=>v.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:Ue.current?`${Ue.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:Ue.current?`${Ue.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3543,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3539,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3537,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Xc.map(v=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:v}),_e(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ee.process===v?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:v},v,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3550,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3548,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),_e(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3567,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3547,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3528,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3480,columnNumber:9},void 0),se&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:v=>{v.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(vs,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3596,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3589,columnNumber:13},void 0),a.jsxDEV("img",{src:C,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:v=>v.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3598,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3588,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3584,columnNumber:9},void 0),bt&&a.jsxDEV(Iw,{projectName:St,onClose:()=>it(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3610,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2479,columnNumber:5},void 0)},Xr=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),hn={async getSpaces(s){const e=qe(re,"finish_check_spaces");let t;s?t=xt(e,js("project_id","==",s)):t=xt(e);const r=(await wt(t)).docs.sort((o,l)=>(o.data().display_order||0)-(l.data().display_order||0)),i=[];for(const o of r){const l=o.data(),u=qe(re,"finish_check_items"),m=xt(u,js("space_id","==",o.id)),f=(await wt(m)).docs.sort((b,V)=>(b.data().display_order||0)-(V.data().display_order||0)),h=[];for(const b of f){const V=b.data(),_=qe(re,"finish_check_images"),w=xt(_,js("item_id","==",b.id)),I=(await wt(w)).docs.map(F=>({id:F.id,item_id:b.id,filename:F.data().filename||null,created_at:Xr(F.data().created_at)}));h.push({id:b.id,space_id:o.id,content:V.content||"",is_completed:V.is_completed||0,is_priority:V.is_priority||0,completed_at:V.completed_at?Xr(V.completed_at):null,display_order:V.display_order||0,created_at:Xr(V.created_at),updated_at:Xr(V.updated_at),images:I})}i.push({id:o.id,name:l.name||"",project_id:l.project_id||null,display_order:l.display_order||0,created_at:Xr(l.created_at),updated_at:Xr(l.updated_at),items:h})}return i},async createSpace(s,e){const t=qe(re,"finish_check_spaces"),n=xt(t,js("project_id","==",e)),i=(await wt(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={name:s,project_id:e,display_order:i+1,created_at:os(),updated_at:os()};return{id:(await $n(t,o)).id,name:s,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(s,e){const t=Se(re,"finish_check_spaces",s);await Bt(t,{name:e,updated_at:os()})},async deleteSpace(s){const e=qe(re,"finish_check_items"),t=xt(e,js("space_id","==",s)),n=await wt(t);for(const r of n.docs){const i=qe(re,"finish_check_images"),o=xt(i,js("item_id","==",r.id)),l=await wt(o);for(const u of l.docs)await Us(Se(re,"finish_check_images",u.id));await Us(Se(re,"finish_check_items",r.id))}await Us(Se(re,"finish_check_spaces",s))},async createItem(s,e){const t=qe(re,"finish_check_items"),n=xt(t,js("space_id","==",s)),i=(await wt(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:os(),updated_at:os()};return{id:(await $n(t,o)).id,space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(s,e){const t=Se(re,"finish_check_items",s);await Bt(t,{content:e,updated_at:os()})},async deleteItem(s){const e=qe(re,"finish_check_images"),t=xt(e,js("item_id","==",s)),n=await wt(t);for(const r of n.docs)await Us(Se(re,"finish_check_images",r.id));await Us(Se(re,"finish_check_items",s))},async toggleItem(s){const e=Se(re,"finish_check_items",s),t=await Pt(e);if(!t.exists())throw new Error("   .");const n=t.data(),r=n.is_completed?0:1;return await Bt(e,{is_completed:r,completed_at:r?os():null,updated_at:os()}),{id:s,space_id:n.space_id,content:n.content,is_completed:r,is_priority:n.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:n.display_order||0,created_at:Xr(n.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(s){const e=Se(re,"finish_check_items",s),t=await Pt(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await Bt(e,{is_priority:r,updated_at:os()}),{is_priority:r}},async getImageData(s){const e=Se(re,"finish_check_images",s),t=await Pt(e);if(!t.exists())return null;const n=t.data();return{image_data:n.image_url||n.image_data||""}},async uploadImage(s,e,t){const n=qe(re,"finish_check_images"),r={item_id:s,image_data:"",image_url:"",filename:t,created_at:os()},i=await $n(n,r);let o=e;if(eo(e)){const l=await Wy("finish_check",i.id,e);await Bt(i,{image_url:l,image_data:""}),o=l}else await Bt(i,{image_data:e});return{id:i.id,item_id:s,image_data:o,filename:t,created_at:new Date().toISOString()}},async deleteImage(s){const e=Se(re,"finish_check_images",s),t=await Pt(e);if(t.exists()){const n=t.data();n.image_url&&await zy(n.image_url)}await Us(e)}},xn={getSpaces:s=>hn.getSpaces(s),createSpace:(s,e)=>hn.createSpace(s,e),updateSpace:(s,e)=>hn.updateSpace(String(s),e),deleteSpace:s=>hn.deleteSpace(String(s)),createItem:(s,e)=>hn.createItem(String(s),e),updateItem:(s,e)=>hn.updateItem(String(s),e),deleteItem:s=>hn.deleteItem(String(s)),toggleItem:s=>hn.toggleItem(String(s)),togglePriority:s=>hn.togglePriority(String(s)),getImageData:s=>hn.getImageData(String(s)),uploadImage:(s,e,t)=>hn.uploadImage(String(s),e,t),deleteImage:s=>hn.deleteImage(String(s))},Ow=()=>{var ee,Ge;const{user:s}=Mr(),{loadProjectsFromAPI:e,projects:t}=tr(),n=dc(),[r,i]=A.useState([]),[o,l]=A.useState(!0),[u,m]=A.useState(null),[d,f]=A.useState([]),[h,b]=A.useState(!1),[V,_]=A.useState(""),[w,B]=A.useState(""),[I,F]=A.useState(null),[oe,se]=A.useState(null),[M,C]=A.useState(""),[x,E]=A.useState(null),[j,L]=A.useState(""),[S,k]=A.useState(null),[_e,Ue]=A.useState(new Set),pe=A.useRef(null),[je,ft]=A.useState(window.innerWidth<768),[qt,Ht]=A.useState(!1),[ae,He]=A.useState(null),[de,Le]=A.useState(new Set),[ze,bt]=A.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[it,St]=A.useState(!1),[st,ut]=A.useState(!1),[ms,Q]=A.useState(new Set);A.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(ze))},[ze]),A.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const be=()=>{ft(window.innerWidth<768)};return window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)},[]),A.useEffect(()=>{o||Te()},[n,o]),A.useEffect(()=>{u!==null&&Re()},[u]),A.useEffect(()=>{u!==null&&(s!=null&&s.id)&&localStorage.setItem(`finishCheck_selectedProject_${s.id}`,u.toString())},[u,s==null?void 0:s.id]),A.useEffect(()=>{if(!je&&S){const H=async be=>{var Ie;const De=(Ie=be.clipboardData)==null?void 0:Ie.items;if(De){for(let me=0;me<De.length;me++)if(De[me].type.indexOf("image")!==-1){be.preventDefault();const Mt=De[me].getAsFile();Mt&&await Ce(S,Mt)}}};return document.addEventListener("paste",H),()=>document.removeEventListener("paste",H)}},[S,je]);const Te=async()=>{try{const H=n.map(De=>({id:De.id,title:De.name}));i(H);const be=s!=null&&s.id?localStorage.getItem(`finishCheck_selectedProject_${s.id}`):null;be&&H.some(De=>De.id===Number(be))?m(Number(be)):H.length>0&&m(H[0].id)}catch(H){console.error("Failed to load projects:",H),ne.error("   ")}},Re=async()=>{try{d.length===0&&b(!0);const be=(await xn.getSpaces(u||void 0)).map(De=>({...De,items:De.items.map(Ie=>({...Ie,images:Ie.images||[]}))}));f(be)}catch(H){console.error("Failed to load spaces:",H),ne.error("   ")}finally{b(!1)}},we=async H=>{if(ms.has(Number(H)))return null;try{Q(Ie=>new Set(Ie).add(Number(H)));const be=await xn.getImageData(H),De=(be==null?void 0:be.image_data)||null;return f(Ie=>Ie.map(me=>({...me,items:me.items.map(Mt=>({...Mt,images:Mt.images.map(mt=>String(mt.id)===String(H)?{...mt,image_data:De}:mt)}))}))),De}catch(be){return console.error("   :",be),null}finally{Q(be=>{const De=new Set(be);return De.delete(Number(H)),De})}},Ye=async H=>{const be=d.find(me=>me.items.some(Mt=>Mt.id===H)),De=be==null?void 0:be.items.find(me=>me.id===H);if(!De)return;const Ie=De.images.filter(me=>!me.image_data);await Promise.all(Ie.map(me=>we(me.id)))},Tt=async()=>{if(!st){if(!V.trim()){ne.error("  ");return}if(!u){ne.error(" ");return}ut(!0);try{const H=await xn.createSpace(V.trim(),u),be={...H,items:H.items||[]};f([...d,be]),_(""),St(!1),ne.success(" ")}catch(H){console.error("Failed to add space:",H),ne.error("  ")}finally{ut(!1)}}},$t=async(H,be)=>{if(!be.trim()){ne.error("  ");return}try{await xn.updateSpace(H,be.trim()),f(d.map(De=>String(De.id)===String(H)?{...De,name:be.trim()}:De)),se(null),C(""),ne.success("  ")}catch(De){console.error("Failed to update space:",De),ne.error("  ")}},ct=H=>{He(H),Le(new Set)},P=async()=>{if(ae!==null){if(de.size===0){ne.error("  ");return}try{await Promise.all(Array.from(de).map(H=>xn.deleteItem(H))),f(d.map(H=>String(H.id)===String(ae)?{...H,items:H.items.filter(be=>!de.has(be.id))}:H)),ne.success(`${de.size}  `),He(null),Le(new Set)}catch(H){console.error("Failed to delete items:",H),ne.error("  ")}}},O=async()=>{if(ae===null)return;const H=d.find(be=>String(be.id)===String(ae));if(H&&confirm(`"${H.name}"  ?

        .`))try{await xn.deleteSpace(ae),f(d.filter(be=>String(be.id)!==String(ae))),ne.success(" "),He(null),Le(new Set)}catch(be){console.error("Failed to delete space:",be),ne.error("  ")}},J=async H=>{if(!w.trim()){ne.error("  ");return}const be=-Date.now(),De={id:be,space_id:H,content:w.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(me=>String(me.id)===String(H)?{...me,items:[...me.items,De]}:me));const Ie=w.trim();B(""),F(null);try{const me=await xn.createItem(H,Ie);f(Mt=>Mt.map(mt=>String(mt.id)===String(H)?{...mt,items:mt.items.map(Wt=>Wt.id===be?{...me,images:[]}:Wt)}:mt))}catch(me){console.error("Failed to add item:",me),f(Mt=>Mt.map(mt=>String(mt.id)===String(H)?{...mt,items:mt.items.filter(Wt=>Wt.id!==be)}:mt)),ne.error("  ")}},ye=async H=>{try{const be=await xn.toggleItem(H);f(d.map(De=>({...De,items:De.items.map(Ie=>String(Ie.id)===String(H)?{...Ie,...be}:Ie)})))}catch(be){console.error("Failed to toggle item:",be),ne.error("   ")}},ue=async H=>{try{const be=await xn.togglePriority(H);f(d.map(De=>({...De,items:De.items.map(Ie=>String(Ie.id)===String(H)?{...Ie,is_priority:be.is_priority}:Ie)})))}catch(be){console.error("Failed to toggle priority:",be),ne.error("  ")}},fe=H=>new Promise((be,De)=>{const Ie=new FileReader;Ie.readAsDataURL(H),Ie.onload=()=>be(Ie.result),Ie.onerror=me=>De(me)}),Ce=async(H,be)=>{var me,Mt;if(!["image/jpeg","image/png","image/webp"].includes(be.type)){ne.error("JPEG, PNG, WebP    ");return}const Ie=5*1024*1024;if(be.size>Ie){ne.error("  5MB  ");return}try{Ue(At=>new Set([...At,Number(H)]));const mt=await fe(be),Wt=await xn.uploadImage(H,mt,be.name);f(d.map(At=>({...At,items:At.items.map(ds=>String(ds.id)===String(H)?{...ds,images:[...ds.images,Wt]}:ds)}))),ne.success(" ")}catch(mt){console.error("Failed to upload image:",mt),ne.error(((Mt=(me=mt.response)==null?void 0:me.data)==null?void 0:Mt.error)||"  ")}finally{Ue(mt=>{const Wt=new Set(mt);return Wt.delete(Number(H)),Wt})}},Me=async(H,be)=>{const De=be.target.files;if(!(!De||De.length===0)){for(let Ie=0;Ie<De.length;Ie++)await Ce(H,De[Ie]);pe.current&&(pe.current.value="")}},et=async(H,be)=>{if(confirm("  ?"))try{await xn.deleteImage(be),f(d.map(De=>({...De,items:De.items.map(Ie=>String(Ie.id)===String(H)?{...Ie,images:Ie.images.filter(me=>String(me.id)!==String(be))}:Ie)}))),ne.success(" ")}catch(De){console.error("Failed to delete image:",De),ne.error("  ")}},Ae=async(H,be)=>{H.preventDefault(),H.stopPropagation();const De=H.dataTransfer.files;if(!(!De||De.length===0))for(let Ie=0;Ie<De.length;Ie++)De[Ie].type.startsWith("image/")&&await Ce(be,De[Ie])},Rs=H=>{H.preventDefault(),H.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const jt=S?d.flatMap(H=>H.items).find(H=>H.id===S):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:pe,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:H=>{S&&Me(S,H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:je?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:H=>{const be=H.target.value?Number(H.target.value):null;m(be)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(H=>a.jsxDEV("option",{value:H.id,children:H.title},H.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>St(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV($i,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:H=>{const be=H.target.value?Number(H.target.value):null;m(be)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(H=>a.jsxDEV("option",{value:H.id,children:H.title},H.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:V,onChange:H=>_(H.target.value),onKeyPress:H=>{H.key==="Enter"&&Tt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Tt,disabled:st,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV($i,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((H,be)=>{const De=H.items.filter(me=>!me.is_completed).sort((me,Mt)=>(Mt.is_priority||0)-(me.is_priority||0)),Ie=H.items.filter(me=>me.is_completed);return ze&&De.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[oe===H.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:me=>C(me.target.value),onKeyPress:me=>{me.key==="Enter"?$t(H.id,M):me.key==="Escape"&&(se(null),C(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>$t(H.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(zp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{se(null),C("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:be+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),H.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Ie.length,"/",H.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{I===H.id?(F(null),B("")):F(H.id)},className:`p-1 transition-colors ${I===H.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV($i,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{se(H.id),C(H.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>ct(H.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),I===H.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:me=>B(me.target.value),onKeyPress:me=>{me.key==="Enter"&&w.trim()&&J(H.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>J(H.id),disabled:!w.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),De.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:De.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ye(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!je&&S===me.id?"font-semibold":""}`,onClick:async()=>{je||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:je?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),je&&Ht(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Io,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(wd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!ze&&Ie.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Ie.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ye(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!je&&S===me.id?"font-semibold":""}`,onClick:async()=>{je||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:je?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),je&&Ht(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Io,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(wd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!je&&S&&jt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var H;return(H=pe.current)==null?void 0:H.click()},disabled:_e.has(S),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),_e.has(S)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:H=>Ae(H,S),onDragOver:Rs,children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(Io,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(H=>a.jsxDEV("div",{className:"relative group",children:[H.image_data?a.jsxDEV("img",{src:H.image_data,alt:H.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>et(S,H.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Sd,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),H.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:H.filename,children:H.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),je&&qt&&S&&jt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ht(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var H;return(H=pe.current)==null?void 0:H.click()},disabled:_e.has(S),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),_e.has(S)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(Io,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(H=>a.jsxDEV("div",{className:"relative",children:[H.image_data?a.jsxDEV("img",{src:H.image_data,alt:H.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>et(S,H.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Sd,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),H.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:H.filename,children:H.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ee=d.find(H=>H.id===ae))==null?void 0:ee.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{He(null),Le(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Ge=d.find(H=>H.id===ae))==null?void 0:Ge.items.map(H=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const be=new Set(de);be.has(H.id)?be.delete(H.id):be.add(H.id),Le(be)},children:[a.jsxDEV("input",{type:"checkbox",checked:de.has(H.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${H.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:H.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:de.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",de.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:O,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{He(null),Le(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),it&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{St(!1),_("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:V,onChange:H=>_(H.target.value),onKeyPress:H=>{H.key==="Enter"&&V.trim()&&Tt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{St(!1),_("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:Tt,disabled:!V.trim()||st,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:st?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function Fw(){const[s,e]=A.useState([]),[t,n]=A.useState(!1),[r,i]=A.useState(null),[o,l]=A.useState(!1),[u,m]=A.useState(null),[d,f]=A.useState(""),[h,b]=A.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[V,_]=A.useState(!1);A.useEffect(()=>{w()},[]),A.useEffect(()=>{const x=()=>{B()};return window.addEventListener("headerAddButtonClick",x),()=>window.removeEventListener("headerAddButtonClick",x)},[]);const w=async()=>{var x,E;try{s.length===0&&n(!0),i(null);const j=await Zn.getAllContractors();e(j.map(L=>({id:L._id,rank:L.rank,companyName:L.companyName,name:L.name,position:L.position,process:L.process,contact:L.contact,accountNumber:L.accountNumber,notes:L.notes,createdAt:new Date(L.createdAt),updatedAt:new Date(L.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const L=j instanceof Error&&((E=(x=j.response)==null?void 0:x.data)==null?void 0:E.message);i(L||"   .")}finally{n(!1)}},B=x=>{if(x){m(x);let E="",j=x.accountNumber||"";if(x.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const _e of k)if(x.accountNumber.startsWith(_e)){E=_e,j=x.accountNumber.substring(_e.length).trim();break}}let L=x.name,S=x.position||"";S||(S=Qa(x.name),L=Yo(x.name)),b({rank:x.rank||"",companyName:x.companyName||"",name:L,position:S,process:x.process,contact:x.contact||"",bankName:E,accountNumber:j,notes:x.notes||""})}else m(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},I=()=>{l(!1),m(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async x=>{var j,L;if(x.preventDefault(),V)return;_(!0);const E=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const S={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:E,notes:h.notes};u?await Zn.updateContractor(u.id,S):await Zn.createContractor(S),await w(),I()}catch(S){console.error("Failed to save contractor:",S);const k=S instanceof Error&&((L=(j=S.response)==null?void 0:j.data)==null?void 0:L.message);alert(k||"  .")}finally{_(!1)}},oe=async x=>{var E,j;if(window.confirm("   ?"))try{await Zn.deleteContractor(x),await w()}catch(L){console.error("Failed to delete contractor:",L);const S=L instanceof Error&&((j=(E=L.response)==null?void 0:E.data)==null?void 0:j.message);alert(S||"  .")}},se=()=>"border-gray-200 text-gray-600 bg-gray-50",M=x=>x?x==="1"?1:x==="1()"?2:x==="2"?3:x==="2()"?4:x==="3"?5:x==="3()"?6:x===""?100:x===""?200:999:999,C=s.filter(x=>x.name.toLowerCase().includes(d.toLowerCase())||x.process.toLowerCase().includes(d.toLowerCase())||x.accountNumber.toLowerCase().includes(d.toLowerCase())||x.contact&&x.contact.toLowerCase().includes(d.toLowerCase())||x.rank&&x.rank.toLowerCase().includes(d.toLowerCase())||x.companyName&&x.companyName.toLowerCase().includes(d.toLowerCase())).sort((x,E)=>{const j=M(x.rank)-M(E.rank);if(j!==0)return j;const L=x.process.localeCompare(E.process,"ko");return L!==0?L:x.name.localeCompare(E.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Qp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:x=>f(x.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):C.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):C.map(x=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${se(x.rank)}`,children:x.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:Yo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.position||Qa(x.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):C.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):C.map(x=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[x.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${se(x.rank)}`,children:x.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),x.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:x.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Yo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(x.position||Qa(x.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.position||Qa(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),x.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),x.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:x.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:I,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(vs,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:x=>b({...h,rank:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:x=>b({...h,companyName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:x=>b({...h,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:x=>b({...h,position:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:x=>b({...h,process:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:x=>b({...h,contact:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:x=>b({...h,bankName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:x=>b({...h,accountNumber:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:x=>b({...h,notes:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:V,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:V?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const qw=()=>{const[s,e]=A.useState([]),[t,n]=A.useState(null),[r,i]=A.useState(!1),o=A.useRef(null);A.useEffect(()=>(o.current=fl.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{o.current&&o.current()}),[]);const l=async f=>{try{await fl.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{n(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await fl.deleteQuoteInquiry(f),(t==null?void 0:t.id)===f&&n(null),ne.success(" ")}catch(b){console.error("Failed to delete inquiry:",b),ne.error("  ")}},d=s.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:s.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ft(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Td,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>n(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ft(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(wN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Td,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(SN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(TN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(LN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},$w=()=>{const{login:s}=Mr(),[e,t]=A.useState(!1),{register:n,handleSubmit:r,setValue:i,formState:{errors:o}}=nd(),l=async m=>{t(!0);try{await s(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...n("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...n("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(IN,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},Ww=A.lazy(()=>Qn(()=>import("./Drawings-ClhJlrd2.js"),__vite__mapDeps([0,1,2,3,4,5]))),zw=A.lazy(()=>Qn(()=>import("./SiteLog-q8M7ISXV.js"),__vite__mapDeps([6,1,4,2,3,5]))),Kw=A.lazy(()=>Qn(()=>import("./AfterService-C4CNHUsZ.js"),__vite__mapDeps([7,1,2,4,3,5]))),Qw=A.lazy(()=>Qn(()=>import("./AdditionalWork-DKprSW_-.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),Yw=A.lazy(()=>Qn(()=>import("./ConstructionPayment-UWlBjwkv.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),Gw=A.lazy(()=>Qn(()=>import("./WorkRequest-BfjAqprG.js"),__vite__mapDeps([11,1,2,4,3,5]))),Xw=A.lazy(()=>Qn(()=>import("./Specbook-D3Y5sy-V.js"),__vite__mapDeps([12,1,2,3,4,5]))),Jw=A.lazy(()=>Qn(()=>import("./EstimatePreview-D_UZn09Z.js"),__vite__mapDeps([13,1,2,3,4,5]))),Zw=A.lazy(()=>Qn(()=>import("./ExecutionHistory-BznxYysR.js"),__vite__mapDeps([14,1,4,2,3,5]))),e2=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),t2=new NN({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function s2(){const[s,e]=A.useState(!1);return A.useEffect(()=>{const t=Ix({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),ne.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{ne.dismiss(),ne.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});PC();const n=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(n,5e3);const r=setInterval(n,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Mo(u,{transports:["websocket","polling"]}),jl.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;IC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(xN,{client:t2,children:a.jsxDEV(gN,{children:a.jsxDEV(OE,{children:[a.jsxDEV(A.Suspense,{fallback:a.jsxDEV(e2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(yN,{children:[a.jsxDEV(Vs,{path:"/login",element:a.jsxDEV($w,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Vs,{path:"/",element:a.jsxDEV(SC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Vs,{index:!0,element:a.jsxDEV(Wp,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Vs,{path:"dashboard",element:a.jsxDEV(c1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Vs,{path:"projects",element:a.jsxDEV(g1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Vs,{path:"schedule",element:a.jsxDEV(Lw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Vs,{path:"drawings",element:a.jsxDEV(Ww,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Vs,{path:"site-log",element:a.jsxDEV(zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Vs,{path:"after-service",element:a.jsxDEV(Kw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Vs,{path:"additional-work",element:a.jsxDEV(Qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Vs,{path:"construction-payment",element:a.jsxDEV(Yw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Vs,{path:"contractors",element:a.jsxDEV(Fw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Vs,{path:"work-request",element:a.jsxDEV(Gw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Vs,{path:"finish-check",element:a.jsxDEV(Ow,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Vs,{path:"specbook",element:a.jsxDEV(Xw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Vs,{path:"estimate-preview",element:a.jsxDEV(Jw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Vs,{path:"execution-history",element:a.jsxDEV(Zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Vs,{path:"payments",element:a.jsxDEV(Mw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Vs,{path:"quote-inquiry",element:a.jsxDEV(qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(H0,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(s){for(const e of s)e.update()});uh(document.getElementById("root")).render(a.jsxDEV(A.StrictMode,{children:a.jsxDEV(s2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{nd as A,xs as B,Mu as C,DC as D,Qc as E,ME as F,m2 as G,Rt as H,Bw as I,ln as J,Hw as K,Rw as L,Xc as P,xe as T,re as a,Us as b,os as c,Se as d,Il as e,Bu as f,Pt as g,Mr as h,dc as i,a as j,qe as k,dn as l,wt as m,Ky as n,ls as o,eo as p,xt as q,Ll as r,li as s,Pl as t,Ru as u,Bt as v,js as w,$n as x,tr as y,ne as z};
