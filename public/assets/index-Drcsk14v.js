const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-Bn-7R0VB.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-DzhApM2D.js","assets/AfterService-DpQVOqyE.js","assets/AdditionalWork-Tn3r4k6p.js","assets/additionalWorkService-BlVxNiJo.js","assets/ConstructionPayment-Bxa0oIiF.js","assets/WorkRequest-CNsXMkBS.js","assets/Specbook-Cu5WOUKv.js","assets/EstimatePreview-BWtA_mZM.js","assets/ExecutionHistory-DFjMqkVe.js"])))=>i.map(i=>d[i]);
var qx=Object.defineProperty;var $x=(n,e,t)=>e in n?qx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var dp=(n,e,t)=>$x(n,typeof e!="symbol"?e+"":e,t);import{r as A,b as zx,u as Gg,d as Wx,N as Qg,e as sm,O as Kx,R as ft,f as Nl,B as Gx,h as Qx,i as Tn}from"./vendor-react-DN7YJcfR.js";import{a as Im,c as Ed,Q as Yx,b as Xx}from"./vendor-data-DrLf5NIQ.js";import{B as rm,X as An,C as Yg,T as Si,a as Jx,b as Xg,W as Zx,c as ev,d as Ss,P as Eo,R as tv,e as nv,S as Jg,f as sv,g as rv,h as Zg,i as iv,U as Sm,I as Pa,j as Tm,k as fp,l as pp,m as hp,n as ov,M as av,o as lv,p as cv,L as uv}from"./vendor-ui-D8A9iq7X.js";import{k as im,l as ia,m as oa,n as mv,o as dv,p as $t,q as fv,r as gp,s as pv,t as mt}from"./vendor-date-DbWJ9m7c.js";import{c as hv,p as ey,l as ru,s as Ts,i as gv,h as yv,q as Vd,a as wd,m as Cd,b as bv,d as iu,o as Cc,e as Nv,f as Ic,r as Id,g as Sd,j as Td,k as Pd,n as Ld,t as ty,u as ny,v as sy,w as ry,x as iy,y as oy,z as ay,A as ly,B as cy,C as uy,D as my,E as dy,F as xv,G as vv,H as _v,I as Dv,J as kv,K as Av,L as Ev}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var fy={exports:{}},Pm={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var n=A,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),C=Symbol.iterator,v="@@iterator";function w(x){if(x===null||typeof x!="object")return null;var L=C&&x[C]||x[v];return typeof L=="function"?L:null}var B=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function T(x){{for(var L=arguments.length,U=new Array(L>1?L-1:0),X=1;X<L;X++)U[X-1]=arguments[X];F("error",x,U)}}function F(x,L,U){{var X=B.ReactDebugCurrentFrame,G=X.getStackAddendum();G!==""&&(L+="%s",U=U.concat([G]));var Z=U.map(function(ie){return String(ie)});Z.unshift("Warning: "+L),Function.prototype.apply.call(console[x],console,Z)}}var re=!1,ee=!1,M=!1,E=!1,N=!1,V;V=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===m||x===d||E||x===y||re||ee||M||typeof x=="object"&&x!==null&&(x.$$typeof===p||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===V||x.getModuleId!==void 0))}function S(x,L,U){var X=x.displayName;if(X)return X;var G=L.displayName||L.name||"";return G!==""?U+"("+G+")":U}function I(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&T("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var L=x;return I(L)+".Consumer";case o:var U=x;return I(U._context)+".Provider";case u:return S(x,x.render,"ForwardRef");case f:var X=x.displayName||null;return X!==null?X:k(x.type)||"Memo";case p:{var G=x,Z=G._payload,ie=G._init;try{return k(ie(Z))}catch{return null}}}return null}var Ae=Object.assign,$e=0,ge,He,yt,Kt,qt,ae,ze;function me(){}me.__reactDisabledLog=!0;function Be(){{if($e===0){ge=console.log,He=console.info,yt=console.warn,Kt=console.error,qt=console.group,ae=console.groupCollapsed,ze=console.groupEnd;var x={configurable:!0,enumerable:!0,value:me,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}$e++}}function Xe(){{if($e--,$e===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Ae({},x,{value:ge}),info:Ae({},x,{value:He}),warn:Ae({},x,{value:yt}),error:Ae({},x,{value:Kt}),group:Ae({},x,{value:qt}),groupCollapsed:Ae({},x,{value:ae}),groupEnd:Ae({},x,{value:ze})})}$e<0&&T("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Dt=B.ReactCurrentDispatcher,ut;function Tt(x,L,U){{if(ut===void 0)try{throw Error()}catch(G){var X=G.stack.trim().match(/\n( *(at )?)/);ut=X&&X[1]||""}return`
`+ut+x}}var ct=!1,ht;{var yn=typeof WeakMap=="function"?WeakMap:Map;ht=new yn}function K(x,L){if(!x||ct)return"";{var U=ht.get(x);if(U!==void 0)return U}var X;ct=!0;var G=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Z;Z=Dt.current,Dt.current=null,Be();try{if(L){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Mt){X=Mt}Reflect.construct(x,[],ie)}else{try{ie.call()}catch(Mt){X=Mt}x.call(ie.prototype)}}else{try{throw Error()}catch(Mt){X=Mt}x()}}catch(Mt){if(Mt&&X&&typeof Mt.stack=="string"){for(var Ce=Mt.stack.split(`
`),tt=X.stack.split(`
`),Oe=Ce.length-1,pe=tt.length-1;Oe>=1&&pe>=0&&Ce[Oe]!==tt[pe];)pe--;for(;Oe>=1&&pe>=0;Oe--,pe--)if(Ce[Oe]!==tt[pe]){if(Oe!==1||pe!==1)do if(Oe--,pe--,pe<0||Ce[Oe]!==tt[pe]){var Ge=`
`+Ce[Oe].replace(" at new "," at ");return x.displayName&&Ge.includes("<anonymous>")&&(Ge=Ge.replace("<anonymous>",x.displayName)),typeof x=="function"&&ht.set(x,Ge),Ge}while(Oe>=1&&pe>=0);break}}}finally{ct=!1,Dt.current=Z,Xe(),Error.prepareStackTrace=G}var pn=x?x.displayName||x.name:"",Qt=pn?Tt(pn):"";return typeof x=="function"&&ht.set(x,Qt),Qt}function je(x,L,U){return K(x,!1)}function Me(x){var L=x.prototype;return!!(L&&L.isReactComponent)}function Pe(x,L,U){if(x==null)return"";if(typeof x=="function")return K(x,Me(x));if(typeof x=="string")return Tt(x);switch(x){case m:return Tt("Suspense");case d:return Tt("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return je(x.render);case f:return Pe(x.type,L,U);case p:{var X=x,G=X._payload,Z=X._init;try{return Pe(Z(G),L,U)}catch{}}}return""}var Ze=Object.prototype.hasOwnProperty,Pt={},Gt=B.ReactDebugCurrentFrame;function pt(x){if(x){var L=x._owner,U=Pe(x.type,x._source,L?L.type:null);Gt.setExtraStackFrame(U)}else Gt.setExtraStackFrame(null)}function P(x,L,U,X,G){{var Z=Function.call.bind(Ze);for(var ie in x)if(Z(x,ie)){var Ce=void 0;try{if(typeof x[ie]!="function"){var tt=Error((X||"React class")+": "+U+" type `"+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[ie]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw tt.name="Invariant Violation",tt}Ce=x[ie](L,ie,X,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Oe){Ce=Oe}Ce&&!(Ce instanceof Error)&&(pt(G),T("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",X||"React class",U,ie,typeof Ce),pt(null)),Ce instanceof Error&&!(Ce.message in Pt)&&(Pt[Ce.message]=!0,pt(G),T("Failed %s type: %s",U,Ce.message),pt(null))}}}var q=Array.isArray;function te(x){return q(x)}function xe(x){{var L=typeof Symbol=="function"&&Symbol.toStringTag,U=L&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ce(x){try{return de(x),!1}catch{return!0}}function de(x){return""+x}function Se(x){if(ce(x))return T("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",xe(x)),de(x)}var We=B.ReactCurrentOwner,st={key:!0,ref:!0,__self:!0,__source:!0},Ee,Mn,Ht;Ht={};function ne(x){if(Ze.call(x,"ref")){var L=Object.getOwnPropertyDescriptor(x,"ref").get;if(L&&L.isReactWarning)return!1}return x.ref!==void 0}function et(x){if(Ze.call(x,"key")){var L=Object.getOwnPropertyDescriptor(x,"key").get;if(L&&L.isReactWarning)return!1}return x.key!==void 0}function O(x,L){if(typeof x.ref=="string"&&We.current&&L&&We.current.stateNode!==L){var U=k(We.current.type);Ht[U]||(T('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(We.current.type),x.ref),Ht[U]=!0)}}function ve(x,L){{var U=function(){Ee||(Ee=!0,T("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function ke(x,L){{var U=function(){Mn||(Mn=!0,T("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Re=function(x,L,U,X,G,Z,ie){var Ce={$$typeof:e,type:x,key:L,ref:U,props:ie,_owner:Z};return Ce._store={},Object.defineProperty(Ce._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ce,"_self",{configurable:!1,enumerable:!1,writable:!1,value:X}),Object.defineProperty(Ce,"_source",{configurable:!1,enumerable:!1,writable:!1,value:G}),Object.freeze&&(Object.freeze(Ce.props),Object.freeze(Ce)),Ce};function ue(x,L,U,X,G){{var Z,ie={},Ce=null,tt=null;U!==void 0&&(Se(U),Ce=""+U),et(L)&&(Se(L.key),Ce=""+L.key),ne(L)&&(tt=L.ref,O(L,G));for(Z in L)Ze.call(L,Z)&&!st.hasOwnProperty(Z)&&(ie[Z]=L[Z]);if(x&&x.defaultProps){var Oe=x.defaultProps;for(Z in Oe)ie[Z]===void 0&&(ie[Z]=Oe[Z])}if(Ce||tt){var pe=typeof x=="function"?x.displayName||x.name||"Unknown":x;Ce&&ve(ie,pe),tt&&ke(ie,pe)}return Re(x,Ce,tt,G,X,We.current,ie)}}var Et=B.ReactCurrentOwner,_t=B.ReactDebugCurrentFrame;function nn(x){if(x){var L=x._owner,U=Pe(x.type,x._source,L?L.type:null);_t.setExtraStackFrame(U)}else _t.setExtraStackFrame(null)}var wt;wt=!1;function bn(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function un(){{if(Et.current){var x=k(Et.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Rn(x){{if(x!==void 0){var L=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+L+":"+U+"."}return""}}var gs={};function es(x){{var L=un();if(!L){var U=typeof x=="string"?x:x.displayName||x.name;U&&(L=`

Check the top-level render call using <`+U+">.")}return L}}function ys(x,L){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=es(L);if(gs[U])return;gs[U]=!0;var X="";x&&x._owner&&x._owner!==Et.current&&(X=" It was passed a child from "+k(x._owner.type)+"."),nn(x),T('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,X),nn(null)}}function ui(x,L){{if(typeof x!="object")return;if(te(x))for(var U=0;U<x.length;U++){var X=x[U];bn(X)&&ys(X,L)}else if(bn(x))x._store&&(x._store.validated=!0);else if(x){var G=w(x);if(typeof G=="function"&&G!==x.entries)for(var Z=G.call(x),ie;!(ie=Z.next()).done;)bn(ie.value)&&ys(ie.value,L)}}}function Fs(x){{var L=x.type;if(L==null||typeof L=="string")return;var U;if(typeof L=="function")U=L.propTypes;else if(typeof L=="object"&&(L.$$typeof===u||L.$$typeof===f))U=L.propTypes;else return;if(U){var X=k(L);P(U,x.props,"prop",X,x)}else if(L.PropTypes!==void 0&&!wt){wt=!0;var G=k(L);T("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",G||"Unknown")}typeof L.getDefaultProps=="function"&&!L.getDefaultProps.isReactClassApproved&&T("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function os(x){{for(var L=Object.keys(x.props),U=0;U<L.length;U++){var X=L[U];if(X!=="children"&&X!=="key"){nn(x),T("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",X),nn(null);break}}x.ref!==null&&(nn(x),T("Invalid attribute `ref` supplied to `React.Fragment`."),nn(null))}}var D={};function Q(x,L,U,X,G,Z){{var ie=j(x);if(!ie){var Ce="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Ce+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var tt=Rn(G);tt?Ce+=tt:Ce+=un();var Oe;x===null?Oe="null":te(x)?Oe="array":x!==void 0&&x.$$typeof===e?(Oe="<"+(k(x.type)||"Unknown")+" />",Ce=" Did you accidentally export a JSX literal instead of a component?"):Oe=typeof x,T("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Oe,Ce)}var pe=ue(x,L,U,G,Z);if(pe==null)return pe;if(ie){var Ge=L.children;if(Ge!==void 0)if(X)if(te(Ge)){for(var pn=0;pn<Ge.length;pn++)ui(Ge[pn],x);Object.freeze&&Object.freeze(Ge)}else T("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ui(Ge,x)}if(Ze.call(L,"key")){var Qt=k(x),Mt=Object.keys(L).filter(function(Wn){return Wn!=="key"}),Bt=Mt.length>0?"{key: someKey, "+Mt.join(": ..., ")+": ...}":"{key: someKey}";if(!D[Qt+Bt]){var Fn=Mt.length>0?"{"+Mt.join(": ..., ")+": ...}":"{}";T(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Bt,Qt,Fn,Qt),D[Qt+Bt]=!0}}return x===s?os(pe):Fs(pe),pe}}var R=Q;Pm.Fragment=s,Pm.jsxDEV=R})();fy.exports=Pm;var a=fy.exports,py,yp=zx;{var bp=yp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;py=function(n,e){bp.usingClientEntryPoint=!0;try{return yp.createRoot(n,e)}finally{bp.usingClientEntryPoint=!1}}}const Vv="modulepreload",wv=function(n){return"/"+n},Np={},rr=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=wv(u),u in Np)return;Np[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":Vv,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((p,y)=>{f.addEventListener("load",p),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let Cv={data:""},Iv=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||Cv},Sv=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Tv=/\/\*[^]*?\*\/|  +/g,xp=/\n+/g,Rr=(n,e)=>{let t="",s="",r="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?Rr(o,i):i+"{"+Rr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Rr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Rr.p?Rr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},or={},hy=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+hy(n[t]);return e}return n},Pv=(n,e,t,s,r)=>{let i=hy(n),o=or[i]||(or[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!or[o]){let u=i!==n?n:(m=>{let d,f,p=[{}];for(;d=Sv.exec(m.replace(Tv,""));)d[4]?p.shift():d[3]?(f=d[3].replace(xp," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][d[1]]=d[2].replace(xp," ").trim();return p[0]})(n);or[o]=Rr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&or.g?or.g:null;return t&&(or.g=or[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(or[o],e,s,l),o},Lv=(n,e,t)=>n.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Rr(l,""):l===!1?"":l}return s+r+(o??"")},"");function ou(n){let e=this||{},t=n.call?n(e.p):n;return Pv(t.unshift?t.raw?Lv(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,Iv(e.target),e.g,e.o,e.k)}let gy,Lm,jm;ou.bind({g:1});let dr=ou.bind({k:1});function jv(n,e,t,s){Rr.p=e,gy=n,Lm=t,jm=s}function Zr(n,e){let t=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:Lm&&Lm()},l),t.o=/ *go\d+/.test(u),l.className=ou.apply(t,s)+(u?" "+u:"");let m=n;return n[0]&&(m=l.as||n,delete l.as),jm&&m[0]&&jm(l),gy(m,l)}return r}}var Rv=n=>typeof n=="function",Sc=(n,e)=>Rv(n)?n(e):n,Bv=(()=>{let n=0;return()=>(++n).toString()})(),yy=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),Uv=20,jd="default",by=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return by(n,{type:n.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},uc=[],Ny={toasts:[],pausedAt:void 0,settings:{toastLimit:Uv}},Ks={},xy=(n,e=jd)=>{Ks[e]=by(Ks[e]||Ny,n),uc.forEach(([t,s])=>{t===e&&s(Ks[e])})},vy=n=>Object.keys(Ks).forEach(e=>xy(n,e)),Hv=n=>Object.keys(Ks).find(e=>Ks[e].toasts.some(t=>t.id===n)),au=(n=jd)=>e=>{xy(e,n)},Mv={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Fv=(n={},e=jd)=>{let[t,s]=A.useState(Ks[e]||Ny),r=A.useRef(Ks[e]);A.useEffect(()=>(r.current!==Ks[e]&&s(Ks[e]),uc.push([e,s]),()=>{let o=uc.findIndex(([l])=>l===e);o>-1&&uc.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((l=n[o.type])==null?void 0:l.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||Mv[o.type],style:{...n.style,...(m=n[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},Ov=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Bv()}),xl=n=>(e,t)=>{let s=Ov(e,n,t);return au(s.toasterId||Hv(s.id))({type:2,toast:s}),s.id},Pn=(n,e)=>xl("blank")(n,e);Pn.error=xl("error");Pn.success=xl("success");Pn.loading=xl("loading");Pn.custom=xl("custom");Pn.dismiss=(n,e)=>{let t={type:3,toastId:n};e?au(e)(t):vy(t)};Pn.dismissAll=n=>Pn.dismiss(void 0,n);Pn.remove=(n,e)=>{let t={type:4,toastId:n};e?au(e)(t):vy(t)};Pn.removeAll=n=>Pn.remove(void 0,n);Pn.promise=(n,e,t)=>{let s=Pn.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(r=>{let i=e.success?Sc(e.success,r):void 0;return i?Pn.success(i,{id:s,...t,...t==null?void 0:t.success}):Pn.dismiss(s),r}).catch(r=>{let i=e.error?Sc(e.error,r):void 0;i?Pn.error(i,{id:s,...t,...t==null?void 0:t.error}):Pn.dismiss(s)}),n};var qv=1e3,$v=(n,e="default")=>{let{toasts:t,pausedAt:s}=Fv(n,e),r=A.useRef(new Map).current,i=A.useCallback((f,p=qv)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},p);r.set(f,y)},[]);A.useEffect(()=>{if(s)return;let f=Date.now(),p=t.map(y=>{if(y.duration===1/0)return;let C=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(C<0){y.visible&&Pn.dismiss(y.id);return}return setTimeout(()=>Pn.dismiss(y.id,e),C)});return()=>{p.forEach(y=>y&&clearTimeout(y))}},[t,s,e]);let o=A.useCallback(au(e),[e]),l=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=A.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),m=A.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=A.useCallback((f,p)=>{let{reverseOrder:y=!1,gutter:C=8,defaultPosition:v}=p||{},w=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),B=w.findIndex(F=>F.id===f.id),T=w.filter((F,re)=>re<B&&F.visible).length;return w.filter(F=>F.visible).slice(...y?[T+1]:[0,T]).reduce((F,re)=>F+(re.height||0)+C,0)},[t]);return A.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let p=r.get(f.id);p&&(clearTimeout(p),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},zv=dr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Wv=dr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Kv=dr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Gv=Zr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${zv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Wv} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Kv} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Qv=dr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Yv=Zr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${Qv} 1s linear infinite;
`,Xv=dr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Jv=dr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Zv=Zr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Xv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Jv} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,e_=Zr("div")`
  position: absolute;
`,t_=Zr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,n_=dr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,s_=Zr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${n_} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,r_=({toast:n})=>{let{icon:e,type:t,iconTheme:s}=n;return e!==void 0?typeof e=="string"?A.createElement(s_,null,e):e:t==="blank"?null:A.createElement(t_,null,A.createElement(Yv,{...s}),t!=="loading"&&A.createElement(e_,null,t==="error"?A.createElement(Gv,{...s}):A.createElement(Zv,{...s})))},i_=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,o_=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,a_="0%{opacity:0;} 100%{opacity:1;}",l_="0%{opacity:1;} 100%{opacity:0;}",c_=Zr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,u_=Zr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,m_=(n,e)=>{let t=n.includes("top")?1:-1,[s,r]=yy()?[a_,l_]:[i_(t),o_(t)];return{animation:e?`${dr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${dr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},d_=A.memo(({toast:n,position:e,style:t,children:s})=>{let r=n.height?m_(n.position||e||"top-center",n.visible):{opacity:0},i=A.createElement(r_,{toast:n}),o=A.createElement(u_,{...n.ariaProps},Sc(n.message,n));return A.createElement(c_,{className:n.className,style:{...r,...t,...n.style}},typeof s=="function"?s({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});jv(A.createElement);var f_=({id:n,className:e,style:t,onHeightUpdate:s,children:r})=>{let i=A.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;s(n,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return A.createElement("div",{ref:i,className:e,style:t},r)},p_=(n,e)=>{let t=n.includes("top"),s=t?{top:0}:{bottom:0},r=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:yy()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},h_=ou`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ml=16,g_=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=$v(t,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ml,left:Ml,right:Ml,bottom:Ml,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,p=m.calculateOffset(d,{reverseOrder:n,gutter:s,defaultPosition:e}),y=p_(f,p);return A.createElement(f_,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?h_:"",style:y},d.type==="custom"?Sc(d.message,d):r?r(d):A.createElement(d_,{toast:d,position:f}))}))},oe=Pn;const er=Object.create(null);er.open="0";er.close="1";er.ping="2";er.pong="3";er.message="4";er.upgrade="5";er.noop="6";const mc=Object.create(null);Object.keys(er).forEach(n=>{mc[er[n]]=n});const Rm={type:"error",data:"parser error"},_y=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Dy=typeof ArrayBuffer=="function",ky=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Rd=({type:n,data:e},t,s)=>_y&&e instanceof Blob?t?s(e):vp(e,s):Dy&&(e instanceof ArrayBuffer||ky(e))?t?s(e):vp(new Blob([e]),s):s(er[n]+(e||"")),vp=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function _p(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let om;function y_(n,e){if(_y&&n.data instanceof Blob)return n.data.arrayBuffer().then(_p).then(e);if(Dy&&(n.data instanceof ArrayBuffer||ky(n.data)))return e(_p(n.data));Rd(n,!1,t=>{om||(om=new TextEncoder),e(om.encode(t))})}const Dp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",La=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Dp.length;n++)La[Dp.charCodeAt(n)]=n;const b_=n=>{let e=n.length*.75,t=n.length,s,r=0,i,o,l,u;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(s=0;s<t;s+=4)i=La[n.charCodeAt(s)],o=La[n.charCodeAt(s+1)],l=La[n.charCodeAt(s+2)],u=La[n.charCodeAt(s+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},N_=typeof ArrayBuffer=="function",Bd=(n,e)=>{if(typeof n!="string")return{type:"message",data:Ay(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:x_(n.substring(1),e)}:mc[t]?n.length>1?{type:mc[t],data:n.substring(1)}:{type:mc[t]}:Rm},x_=(n,e)=>{if(N_){const t=b_(n);return Ay(t,e)}else return{base64:!0,data:n}},Ay=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Ey="",v_=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((i,o)=>{Rd(i,!1,l=>{s[o]=l,++r===t&&e(s.join(Ey))})})},__=(n,e)=>{const t=n.split(Ey),s=[];for(let r=0;r<t.length;r++){const i=Bd(t[r],e);if(s.push(i),i.type==="error")break}return s};function D_(){return new TransformStream({transform(n,e){y_(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let am;function Fl(n){return n.reduce((e,t)=>e+t.length,0)}function Ol(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function k_(n,e){am||(am=new TextDecoder);const t=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(s===0){if(Fl(t)<1)break;const u=Ol(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(Fl(t)<2)break;const u=Ol(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(Fl(t)<8)break;const u=Ol(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Rm);break}r=d*Math.pow(2,32)+m.getUint32(4),s=3}else{if(Fl(t)<r)break;const u=Ol(t,r);l.enqueue(Bd(i?u:am.decode(u),e)),s=0}if(r===0||r>n){l.enqueue(Rm);break}}}})}const Vy=4;function En(n){if(n)return A_(n)}function A_(n){for(var e in En.prototype)n[e]=En.prototype[e];return n}En.prototype.on=En.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};En.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};En.prototype.off=En.prototype.removeListener=En.prototype.removeAllListeners=En.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};En.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};En.prototype.emitReserved=En.prototype.emit;En.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};En.prototype.hasListeners=function(n){return!!this.listeners(n).length};const lu=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),xs=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),E_="arraybuffer";function wy(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const V_=xs.setTimeout,w_=xs.clearTimeout;function cu(n,e){e.useNativeTimers?(n.setTimeoutFn=V_.bind(xs),n.clearTimeoutFn=w_.bind(xs)):(n.setTimeoutFn=xs.setTimeout.bind(xs),n.clearTimeoutFn=xs.clearTimeout.bind(xs))}const C_=1.33;function I_(n){return typeof n=="string"?S_(n):Math.ceil((n.byteLength||n.size)*C_)}function S_(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function Cy(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function T_(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function P_(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let i=t[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class L_ extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class Ud extends En{constructor(e){super(),this.writable=!1,cu(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new L_(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Bd(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=T_(e);return t.length?"?"+t:""}}class j_ extends Ud{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};__(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,v_(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Cy()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Iy=!1;try{Iy=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const R_=Iy;function B_(){}class U_ extends j_{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}let Vo=class dc extends En{constructor(e,t,s){super(),this.createRequest=e,cu(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=wy(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=dc.requestsCount++,dc.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=B_,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete dc.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Vo.requestsCount=0;Vo.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",kp);else if(typeof addEventListener=="function"){const n="onpagehide"in xs?"pagehide":"unload";addEventListener(n,kp,!1)}}function kp(){for(let n in Vo.requests)Vo.requests.hasOwnProperty(n)&&Vo.requests[n].abort()}const H_=function(){const n=Sy({xdomain:!1});return n&&n.responseType!==null}();class M_ extends U_{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=H_&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Vo(Sy,this.uri(),e)}}function Sy(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||R_))return new XMLHttpRequest}catch{}if(!e)try{return new xs[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ty=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class F_ extends Ud{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=Ty?{}:wy(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;Rd(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&lu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Cy()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const lm=xs.WebSocket||xs.MozWebSocket;class O_ extends F_{createSocket(e,t,s){return Ty?new lm(e,t,s):t?new lm(e,t):new lm(e)}doWrite(e,t){this.ws.send(t)}}class q_ extends Ud{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=k_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=D_();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&lu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const $_={websocket:O_,webtransport:q_,polling:M_},z_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,W_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Bm(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=z_.exec(n||""),i={},o=14;for(;o--;)i[W_[o]]=r[o]||"";return t!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=K_(i,i.path),i.queryKey=G_(i,i.query),i}function K_(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function G_(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(t[r]=i)}),t}const Um=typeof addEventListener=="function"&&typeof removeEventListener=="function",fc=[];Um&&addEventListener("offline",()=>{fc.forEach(n=>n())},!1);class Mr extends En{constructor(e,t){if(super(),this.binaryType=E_,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=Bm(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=Bm(t.host).host);cu(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=P_(this.opts.query)),Um&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},fc.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Vy,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Mr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Mr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=I_(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,lu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:t,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Mr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Um&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=fc.indexOf(this._offlineEventListener);s!==-1&&fc.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Mr.protocol=Vy;class Q_ extends Mr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;Mr.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Mr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=t.name,this.emitReserved("upgradeError",p)}}))};function i(){s||(s=!0,d(),t.close(),t=null)}const o=f=>{const p=new Error("probe error: "+f);p.transport=t.name,i(),this.emitReserved("upgradeError",p)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let Y_=class extends Q_{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>$_[r]).filter(r=>!!r)),super(e,s)}};function X_(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=Bm(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(t&&t.port===s.port?"":":"+s.port),s}const J_=typeof ArrayBuffer=="function",Z_=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Py=Object.prototype.toString,eD=typeof Blob=="function"||typeof Blob<"u"&&Py.call(Blob)==="[object BlobConstructor]",tD=typeof File=="function"||typeof File<"u"&&Py.call(File)==="[object FileConstructor]";function Hd(n){return J_&&(n instanceof ArrayBuffer||Z_(n))||eD&&n instanceof Blob||tD&&n instanceof File}function pc(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(pc(n[t]))return!0;return!1}if(Hd(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return pc(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&pc(n[t]))return!0;return!1}function nD(n){const e=[],t=n.data,s=n;return s.data=Hm(t,e),s.attachments=e.length,{packet:s,buffers:e}}function Hm(n,e){if(!n)return n;if(Hd(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=Hm(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=Hm(n[s],e));return t}return n}function sD(n,e){return n.data=Mm(n.data,e),delete n.attachments,n}function Mm(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=Mm(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=Mm(n[t],e));return n}const rD=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],iD=5;var Vt;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(Vt||(Vt={}));class oD{constructor(e){this.replacer=e}encode(e){return(e.type===Vt.EVENT||e.type===Vt.ACK)&&pc(e)?this.encodeAsBinary({type:e.type===Vt.EVENT?Vt.BINARY_EVENT:Vt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Vt.BINARY_EVENT||e.type===Vt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=nD(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function Ap(n){return Object.prototype.toString.call(n)==="[object Object]"}class Md extends En{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===Vt.BINARY_EVENT;s||t.type===Vt.BINARY_ACK?(t.type=s?Vt.EVENT:Vt.ACK,this.reconstructor=new aD(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Hd(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(Vt[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Vt.BINARY_EVENT||s.type===Vt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(i,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(Md.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Vt.CONNECT:return Ap(t);case Vt.DISCONNECT:return t===void 0;case Vt.CONNECT_ERROR:return typeof t=="string"||Ap(t);case Vt.EVENT:case Vt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&rD.indexOf(t[0])===-1);case Vt.ACK:case Vt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class aD{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=sD(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const lD=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Md,Encoder:oD,get PacketType(){return Vt},protocol:iD},Symbol.toStringTag,{value:"Module"}));function Cs(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const cD=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ly extends En{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Cs(e,"open",this.onopen.bind(this)),Cs(e,"packet",this.onpacket.bind(this)),Cs(e,"error",this.onerror.bind(this)),Cs(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,i;if(cD.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:Vt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,r)=>{const i=(o,l)=>o?r(o):s(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Vt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Vt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Vt.EVENT:case Vt.BINARY_EVENT:this.onevent(e);break;case Vt.ACK:case Vt.BINARY_ACK:this.onack(e);break;case Vt.DISCONNECT:this.ondisconnect();break;case Vt.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:Vt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Vt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function zo(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}zo.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};zo.prototype.reset=function(){this.attempts=0};zo.prototype.setMin=function(n){this.ms=n};zo.prototype.setMax=function(n){this.max=n};zo.prototype.setJitter=function(n){this.jitter=n};class Fm extends En{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,cu(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new zo({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||lD;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Y_(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=Cs(t,"open",function(){s.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=Cs(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Cs(e,"ping",this.onping.bind(this)),Cs(e,"data",this.ondata.bind(this)),Cs(e,"error",this.onerror.bind(this)),Cs(e,"close",this.onclose.bind(this)),Cs(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){lu(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Ly(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const aa={};function Oa(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=X_(n,e.path||"/socket.io"),s=t.source,r=t.id,i=t.path,o=aa[r]&&i in aa[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new Fm(s,e):(aa[r]||(aa[r]=new Fm(s,e)),u=aa[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Oa,{Manager:Fm,Socket:Ly,io:Oa,connect:Oa});function uD(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=n;let l,u,m;const d=async(p=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await rr(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{o==null||o(p)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let p=!1;const y=()=>{p=!0,l==null||l.addEventListener("controlling",C=>{C.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",C=>{typeof C.isUpdate>"u"?typeof C.isExternal<"u"?C.isExternal?y():!p&&(s==null||s()):C.isExternal?window.location.reload():!p&&(s==null||s()):C.isUpdate||s==null||s()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(p=>{i?i("/sw.js",p):r==null||r(p)}).catch(p=>{o==null||o(p)})}}return u=f(),d}const mD=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},dD=mD(),Ie=Im.create({baseURL:dD,headers:{"Content-Type":"application/json"}});Ie.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));Ie.interceptors.response.use(n=>n,n=>{var e,t,s;return((e=n.response)==null?void 0:e.status)===401&&!((s=(t=n.config)==null?void 0:t.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(n)});const fD=()=>{};var Ep={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},pD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ry={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,m=u?n[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(p=64)),s.push(t[d],t[f],t[p],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jy(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new hD;const p=i<<2|l>>4;if(s.push(p),m!==64){const y=l<<4&240|m>>2;if(s.push(y),f!==64){const C=m<<6&192|f;s.push(C)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class hD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gD=function(n){const e=jy(n);return Ry.encodeByteArray(e,!0)},Tc=function(n){return gD(n).replace(/\./g,"")},yD=function(n){try{return Ry.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=()=>By().__FIREBASE_DEFAULTS__,ND=()=>{if(typeof process>"u"||typeof Ep>"u")return;const n=Ep.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&yD(n[1]);return e&&JSON.parse(e)},Fd=()=>{try{return fD()||bD()||ND()||xD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vD=n=>{var e,t;return(t=(e=Fd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Uy=n=>{const e=vD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},Hy=()=>{var n;return(n=Fd())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function My(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Tc(JSON.stringify(t)),Tc(JSON.stringify(o)),""].join(".")}const qa={};function DD(){const n={prod:[],emulator:[]};for(const e of Object.keys(qa))qa[e]?n.emulator.push(e):n.prod.push(e);return n}function kD(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Vp=!1;function Oy(n,e){if(typeof window>"u"||typeof document>"u"||!uu(window.location.host)||qa[n]===e||qa[n]||Vp)return;qa[n]=e;function t(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=DD().prod.length>0;function o(){const p=document.getElementById(s);p&&p.remove()}function l(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,y){p.setAttribute("width","24"),p.setAttribute("id",y),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function m(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Vp=!0,o()},p}function d(p,y){p.setAttribute("id",y),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=kD(s),y=t("text"),C=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),w=document.getElementById(v)||document.createElement("a"),B=t("preprendIcon"),T=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const F=p.element;l(F),d(w,v);const re=m();u(T,B),F.append(T,C,w,re),document.body.appendChild(F)}i?(C.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qy(){var e;const n=(e=Fd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $y(){return!qy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zy(){return!qy()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Wy(){try{return typeof indexedDB=="object"}catch{return!1}}function AD(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="FirebaseError";class Mi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=ED,Object.setPrototypeOf(this,Mi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ky.prototype.create)}}class Ky{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?VD(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new Mi(r,l,s)}}function VD(n,e){return n.replace(wD,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const wD=/\{\$([^}]+)}/g;function Lc(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(wp(i)&&wp(o)){if(!Lc(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function wp(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(n){return n&&n._delegate?n._delegate:n}class Co{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new _D;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SD(e))try{this.getOrInitializeService({instanceIdentifier:gi})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=gi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=gi){return this.instances.has(e)}getOptions(e=gi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:ID(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=gi){return this.component?this.component.multipleInstances?e:gi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ID(n){return n===gi?void 0:n}function SD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(St||(St={}));const PD={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},LD=St.INFO,jD={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},RD=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=jD[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gy{constructor(e){this.name=e,this._logLevel=LD,this._logHandler=RD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}}const BD=(n,e)=>e.some(t=>n instanceof t);let Cp,Ip;function UD(){return Cp||(Cp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HD(){return Ip||(Ip=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qy=new WeakMap,Om=new WeakMap,Yy=new WeakMap,cm=new WeakMap,Od=new WeakMap;function MD(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Fr(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Qy.set(t,n)}).catch(()=>{}),Od.set(e,n),e}function FD(n){if(Om.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Om.set(n,e)}let qm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Om.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Yy.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function OD(n){qm=n(qm)}function qD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(um(this),e,...t);return Yy.set(s,e.sort?e.sort():[e]),Fr(s)}:HD().includes(n)?function(...e){return n.apply(um(this),e),Fr(Qy.get(this))}:function(...e){return Fr(n.apply(um(this),e))}}function $D(n){return typeof n=="function"?qD(n):(n instanceof IDBTransaction&&FD(n),BD(n,UD())?new Proxy(n,qm):n)}function Fr(n){if(n instanceof IDBRequest)return MD(n);if(cm.has(n))return cm.get(n);const e=$D(n);return e!==n&&(cm.set(n,e),Od.set(e,n)),e}const um=n=>Od.get(n);function zD(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Fr(o);return s&&o.addEventListener("upgradeneeded",u=>{s(Fr(o.result),u.oldVersion,u.newVersion,Fr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const WD=["get","getKey","getAll","getAllKeys","count"],KD=["put","add","delete","clear"],mm=new Map;function Sp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(mm.get(e))return mm.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=KD.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||WD.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return s&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return mm.set(e,i),i}OD(n=>({...n,get:(e,t,s)=>Sp(e,t)||n.get(e,t,s),has:(e,t)=>!!Sp(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QD(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function QD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $m="@firebase/app",Tp="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr=new Gy("@firebase/app"),YD="@firebase/app-compat",XD="@firebase/analytics-compat",JD="@firebase/analytics",ZD="@firebase/app-check-compat",ek="@firebase/app-check",tk="@firebase/auth",nk="@firebase/auth-compat",sk="@firebase/database",rk="@firebase/data-connect",ik="@firebase/database-compat",ok="@firebase/functions",ak="@firebase/functions-compat",lk="@firebase/installations",ck="@firebase/installations-compat",uk="@firebase/messaging",mk="@firebase/messaging-compat",dk="@firebase/performance",fk="@firebase/performance-compat",pk="@firebase/remote-config",hk="@firebase/remote-config-compat",gk="@firebase/storage",yk="@firebase/storage-compat",bk="@firebase/firestore",Nk="@firebase/ai",xk="@firebase/firestore-compat",vk="firebase",_k="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm="[DEFAULT]",Dk={[$m]:"fire-core",[YD]:"fire-core-compat",[JD]:"fire-analytics",[XD]:"fire-analytics-compat",[ek]:"fire-app-check",[ZD]:"fire-app-check-compat",[tk]:"fire-auth",[nk]:"fire-auth-compat",[sk]:"fire-rtdb",[rk]:"fire-data-connect",[ik]:"fire-rtdb-compat",[ok]:"fire-fn",[ak]:"fire-fn-compat",[lk]:"fire-iid",[ck]:"fire-iid-compat",[uk]:"fire-fcm",[mk]:"fire-fcm-compat",[dk]:"fire-perf",[fk]:"fire-perf-compat",[pk]:"fire-rc",[hk]:"fire-rc-compat",[gk]:"fire-gcs",[yk]:"fire-gcs-compat",[bk]:"fire-fst",[xk]:"fire-fst-compat",[Nk]:"fire-vertex","fire-js":"fire-js",[vk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc=new Map,kk=new Map,Wm=new Map;function Pp(n,e){try{n.container.addComponent(e)}catch(t){fr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function nl(n){const e=n.name;if(Wm.has(e))return fr.debug(`There were multiple attempts to register component ${e}.`),!1;Wm.set(e,n);for(const t of jc.values())Pp(t,n);for(const t of kk.values())Pp(t,n);return!0}function Xy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Jy(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Or=new Ky("app","Firebase",Ak);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Co("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Or.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=_k;function eb(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:zm,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Or.create("bad-app-name",{appName:String(r)});if(t||(t=Hy()),!t)throw Or.create("no-options");const i=jc.get(r);if(i){if(Lc(t,i.options)&&Lc(s,i.config))return i;throw Or.create("duplicate-app",{appName:r})}const o=new TD(r);for(const u of Wm.values())o.addComponent(u);const l=new Ek(t,s,o);return jc.set(r,l),l}function tb(n=zm){const e=jc.get(n);if(!e&&n===zm&&Hy())return eb();if(!e)throw Or.create("no-app",{appName:n});return e}function qr(n,e,t){let s=Dk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fr.warn(o.join(" "));return}nl(new Co(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="firebase-heartbeat-database",wk=1,sl="firebase-heartbeat-store";let dm=null;function nb(){return dm||(dm=zD(Vk,wk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(sl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Or.create("idb-open",{originalErrorMessage:n.message})})),dm}async function Ck(n){try{const t=(await nb()).transaction(sl),s=await t.objectStore(sl).get(sb(n));return await t.done,s}catch(e){if(e instanceof Mi)fr.warn(e.message);else{const t=Or.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fr.warn(t.message)}}}async function Lp(n,e){try{const s=(await nb()).transaction(sl,"readwrite");await s.objectStore(sl).put(e,sb(n)),await s.done}catch(t){if(t instanceof Mi)fr.warn(t.message);else{const s=Or.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});fr.warn(s.message)}}}function sb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik=1024,Sk=30;class Tk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Lk(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=jp();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>Sk){const o=jk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){fr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=jp(),{heartbeatsToSend:s,unsentEntries:r}=Pk(this._heartbeatsCache.heartbeats),i=Tc(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return fr.warn(t),""}}}function jp(){return new Date().toISOString().substring(0,10)}function Pk(n,e=Ik){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Rp(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Rp(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Lk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wy()?AD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Ck(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Lp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Lp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Rp(n){return Tc(JSON.stringify({version:2,heartbeats:n})).length}function jk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(n){nl(new Co("platform-logger",e=>new GD(e),"PRIVATE")),nl(new Co("heartbeat",e=>new Tk(e),"PRIVATE")),qr($m,Tp,n),qr($m,Tp,"esm2020"),qr("fire-js","")}Rk("");var Bk="firebase",Uk="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr(Bk,Uk,"app");var Bp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,rb;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,N){function V(){}V.prototype=N.prototype,E.F=N.prototype,E.prototype=new V,E.prototype.constructor=E,E.D=function(j,S,I){for(var k=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)k[Ae-2]=arguments[Ae];return N.prototype[S].apply(j,k)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,N,V){V||(V=0);const j=Array(16);if(typeof N=="string")for(var S=0;S<16;++S)j[S]=N.charCodeAt(V++)|N.charCodeAt(V++)<<8|N.charCodeAt(V++)<<16|N.charCodeAt(V++)<<24;else for(S=0;S<16;++S)j[S]=N[V++]|N[V++]<<8|N[V++]<<16|N[V++]<<24;N=E.g[0],V=E.g[1],S=E.g[2];let I=E.g[3],k;k=N+(I^V&(S^I))+j[0]+3614090360&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[1]+3905402710&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[2]+606105819&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[3]+3250441966&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[4]+4118548399&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[5]+1200080426&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[6]+2821735955&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[7]+4249261313&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[8]+1770035416&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[9]+2336552879&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[10]+4294925233&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[11]+2304563134&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(I^V&(S^I))+j[12]+1804603682&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(S^N&(V^S))+j[13]+4254626195&4294967295,I=N+(k<<12&4294967295|k>>>20),k=S+(V^I&(N^V))+j[14]+2792965006&4294967295,S=I+(k<<17&4294967295|k>>>15),k=V+(N^S&(I^N))+j[15]+1236535329&4294967295,V=S+(k<<22&4294967295|k>>>10),k=N+(S^I&(V^S))+j[1]+4129170786&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[6]+3225465664&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[11]+643717713&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[0]+3921069994&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[5]+3593408605&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[10]+38016083&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[15]+3634488961&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[4]+3889429448&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[9]+568446438&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[14]+3275163606&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[3]+4107603335&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[8]+1163531501&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(S^I&(V^S))+j[13]+2850285829&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^S&(N^V))+j[2]+4243563512&4294967295,I=N+(k<<9&4294967295|k>>>23),k=S+(N^V&(I^N))+j[7]+1735328473&4294967295,S=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(S^I))+j[12]+2368359562&4294967295,V=S+(k<<20&4294967295|k>>>12),k=N+(V^S^I)+j[5]+4294588738&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[8]+2272392833&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[11]+1839030562&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[14]+4259657740&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[1]+2763975236&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[4]+1272893353&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[7]+4139469664&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[10]+3200236656&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[13]+681279174&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[0]+3936430074&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[3]+3572445317&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[6]+76029189&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(V^S^I)+j[9]+3654602809&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^S)+j[12]+3873151461&4294967295,I=N+(k<<11&4294967295|k>>>21),k=S+(I^N^V)+j[15]+530742520&4294967295,S=I+(k<<16&4294967295|k>>>16),k=V+(S^I^N)+j[2]+3299628645&4294967295,V=S+(k<<23&4294967295|k>>>9),k=N+(S^(V|~I))+j[0]+4096336452&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[7]+1126891415&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[14]+2878612391&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[5]+4237533241&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[12]+1700485571&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[3]+2399980690&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[10]+4293915773&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[1]+2240044497&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[8]+1873313359&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[15]+4264355552&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[6]+2734768916&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[13]+1309151649&4294967295,V=S+(k<<21&4294967295|k>>>11),k=N+(S^(V|~I))+j[4]+4149444226&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~S))+j[11]+3174756917&4294967295,I=N+(k<<10&4294967295|k>>>22),k=S+(N^(I|~V))+j[2]+718787259&4294967295,S=I+(k<<15&4294967295|k>>>17),k=V+(I^(S|~N))+j[9]+3951481745&4294967295,E.g[0]=E.g[0]+N&4294967295,E.g[1]=E.g[1]+(S+(k<<21&4294967295|k>>>11))&4294967295,E.g[2]=E.g[2]+S&4294967295,E.g[3]=E.g[3]+I&4294967295}s.prototype.v=function(E,N){N===void 0&&(N=E.length);const V=N-this.blockSize,j=this.C;let S=this.h,I=0;for(;I<N;){if(S==0)for(;I<=V;)r(this,E,I),I+=this.blockSize;if(typeof E=="string"){for(;I<N;)if(j[S++]=E.charCodeAt(I++),S==this.blockSize){r(this,j),S=0;break}}else for(;I<N;)if(j[S++]=E[I++],S==this.blockSize){r(this,j),S=0;break}}this.h=S,this.o+=N},s.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var N=1;N<E.length-8;++N)E[N]=0;N=this.o*8;for(var V=E.length-8;V<E.length;++V)E[V]=N&255,N/=256;for(this.v(E),E=Array(16),N=0,V=0;V<4;++V)for(let j=0;j<32;j+=8)E[N++]=this.g[V]>>>j&255;return E};function i(E,N){var V=l;return Object.prototype.hasOwnProperty.call(V,E)?V[E]:V[E]=N(E)}function o(E,N){this.h=N;const V=[];let j=!0;for(let S=E.length-1;S>=0;S--){const I=E[S]|0;j&&I==N||(V[S]=I,j=!1)}this.g=V}var l={};function u(E){return-128<=E&&E<128?i(E,function(N){return new o([N|0],N<0?-1:0)}):new o([E|0],E<0?-1:0)}function m(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return w(m(-E));const N=[];let V=1;for(let j=0;E>=V;j++)N[j]=E/V|0,V*=4294967296;return new o(N,0)}function d(E,N){if(E.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(E.charAt(0)=="-")return w(d(E.substring(1),N));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=m(Math.pow(N,8));let j=f;for(let I=0;I<E.length;I+=8){var S=Math.min(8,E.length-I);const k=parseInt(E.substring(I,I+S),N);S<8?(S=m(Math.pow(N,S)),j=j.j(S).add(m(k))):(j=j.j(V),j=j.add(m(k)))}return j}var f=u(0),p=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let E=0,N=1;for(let V=0;V<this.g.length;V++){const j=this.i(V);E+=(j>=0?j:4294967296+j)*N,N*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(v(this))return"-"+w(this).toString(E);const N=m(Math.pow(E,6));var V=this;let j="";for(;;){const S=re(V,N).g;V=B(V,S.j(N));let I=((V.g.length>0?V.g[0]:V.h)>>>0).toString(E);if(V=S,C(V))return I+j;for(;I.length<6;)I="0"+I;j=I+j}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(let N=0;N<E.g.length;N++)if(E.g[N]!=0)return!1;return!0}function v(E){return E.h==-1}n.l=function(E){return E=B(this,E),v(E)?-1:C(E)?0:1};function w(E){const N=E.g.length,V=[];for(let j=0;j<N;j++)V[j]=~E.g[j];return new o(V,~E.h).add(p)}n.abs=function(){return v(this)?w(this):this},n.add=function(E){const N=Math.max(this.g.length,E.g.length),V=[];let j=0;for(let S=0;S<=N;S++){let I=j+(this.i(S)&65535)+(E.i(S)&65535),k=(I>>>16)+(this.i(S)>>>16)+(E.i(S)>>>16);j=k>>>16,I&=65535,k&=65535,V[S]=k<<16|I}return new o(V,V[V.length-1]&-2147483648?-1:0)};function B(E,N){return E.add(w(N))}n.j=function(E){if(C(this)||C(E))return f;if(v(this))return v(E)?w(this).j(w(E)):w(w(this).j(E));if(v(E))return w(this.j(w(E)));if(this.l(y)<0&&E.l(y)<0)return m(this.m()*E.m());const N=this.g.length+E.g.length,V=[];for(var j=0;j<2*N;j++)V[j]=0;for(j=0;j<this.g.length;j++)for(let S=0;S<E.g.length;S++){const I=this.i(j)>>>16,k=this.i(j)&65535,Ae=E.i(S)>>>16,$e=E.i(S)&65535;V[2*j+2*S]+=k*$e,T(V,2*j+2*S),V[2*j+2*S+1]+=I*$e,T(V,2*j+2*S+1),V[2*j+2*S+1]+=k*Ae,T(V,2*j+2*S+1),V[2*j+2*S+2]+=I*Ae,T(V,2*j+2*S+2)}for(E=0;E<N;E++)V[E]=V[2*E+1]<<16|V[2*E];for(E=N;E<2*N;E++)V[E]=0;return new o(V,0)};function T(E,N){for(;(E[N]&65535)!=E[N];)E[N+1]+=E[N]>>>16,E[N]&=65535,N++}function F(E,N){this.g=E,this.h=N}function re(E,N){if(C(N))throw Error("division by zero");if(C(E))return new F(f,f);if(v(E))return N=re(w(E),N),new F(w(N.g),w(N.h));if(v(N))return N=re(E,w(N)),new F(w(N.g),N.h);if(E.g.length>30){if(v(E)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var V=p,j=N;j.l(E)<=0;)V=ee(V),j=ee(j);var S=M(V,1),I=M(j,1);for(j=M(j,2),V=M(V,2);!C(j);){var k=I.add(j);k.l(E)<=0&&(S=S.add(V),I=k),j=M(j,1),V=M(V,1)}return N=B(E,S.j(N)),new F(S,N)}for(S=f;E.l(N)>=0;){for(V=Math.max(1,Math.floor(E.m()/N.m())),j=Math.ceil(Math.log(V)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),I=m(V),k=I.j(N);v(k)||k.l(E)>0;)V-=j,I=m(V),k=I.j(N);C(I)&&(I=p),S=S.add(I),E=B(E,k)}return new F(S,E)}n.B=function(E){return re(this,E).h},n.and=function(E){const N=Math.max(this.g.length,E.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)&E.i(j);return new o(V,this.h&E.h)},n.or=function(E){const N=Math.max(this.g.length,E.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)|E.i(j);return new o(V,this.h|E.h)},n.xor=function(E){const N=Math.max(this.g.length,E.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)^E.i(j);return new o(V,this.h^E.h)};function ee(E){const N=E.g.length+1,V=[];for(let j=0;j<N;j++)V[j]=E.i(j)<<1|E.i(j-1)>>>31;return new o(V,E.h)}function M(E,N){const V=N>>5;N%=32;const j=E.g.length-V,S=[];for(let I=0;I<j;I++)S[I]=N>0?E.i(I+V)>>>N|E.i(I+V+1)<<32-N:E.i(I+V);return new o(S,E.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,rb=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,$r=o}).apply(typeof Bp<"u"?Bp:typeof self<"u"?self:typeof window<"u"?window:{});var ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ib,ja,ob,hc,Km,ab,lb,cb;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ql=="object"&&ql];for(var h=0;h<c.length;++h){var g=c[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=t(this);function r(c,h){if(h)e:{var g=s;c=c.split(".");for(var _=0;_<c.length-1;_++){var z=c[_];if(!(z in g))break e;g=g[z]}c=c[c.length-1],_=g[c],h=h(_),h!=_&&h!=null&&e(g,c,{configurable:!0,writable:!0,value:h})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(h){var g=[],_;for(_ in h)Object.prototype.hasOwnProperty.call(h,_)&&g.push([_,h[_]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function u(c,h,g){return c.call.apply(c.bind,arguments)}function m(c,h,g){return m=u,m.apply(null,arguments)}function d(c,h){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function f(c,h){function g(){}g.prototype=h.prototype,c.Z=h.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(_,z,J){for(var De=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)De[gt-2]=arguments[gt];return h.prototype[z].apply(_,De)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const h=c.length;if(h>0){const g=Array(h);for(let _=0;_<h;_++)g[_]=c[_];return g}return[]}function C(c,h){for(let _=1;_<arguments.length;_++){const z=arguments[_];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=c.length||0;const J=z.length||0;c.length=g+J;for(let De=0;De<J;De++)c[g+De]=z[De]}else c.push(z)}}class v{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function w(c){o.setTimeout(()=>{throw c},0)}function B(){var c=E;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class T{constructor(){this.h=this.g=null}add(h,g){const _=F.get();_.set(h,g),this.h?this.h.next=_:this.g=_,this.h=_}}var F=new v(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,M=!1,E=new T,N=()=>{const c=Promise.resolve(void 0);ee=()=>{c.then(V)}};function V(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){w(g)}var h=F;h.j(c),h.h<100&&(h.h++,c.next=h.g,h.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,h),o.removeEventListener("test",g,h)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function Ae(c,h){S.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,h)}f(Ae,S),Ae.prototype.init=function(c,h){const g=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget,h||(g=="mouseover"?h=c.fromElement:g=="mouseout"&&(h=c.toElement)),this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Ae.Z.h.call(this)},Ae.prototype.h=function(){Ae.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var $e="closure_listenable_"+(Math.random()*1e6|0),ge=0;function He(c,h,g,_,z){this.listener=c,this.proxy=null,this.src=h,this.type=g,this.capture=!!_,this.ha=z,this.key=++ge,this.da=this.fa=!1}function yt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Kt(c,h,g){for(const _ in c)h.call(g,c[_],_,c)}function qt(c,h){for(const g in c)h.call(void 0,c[g],g,c)}function ae(c){const h={};for(const g in c)h[g]=c[g];return h}const ze="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(c,h){let g,_;for(let z=1;z<arguments.length;z++){_=arguments[z];for(g in _)c[g]=_[g];for(let J=0;J<ze.length;J++)g=ze[J],Object.prototype.hasOwnProperty.call(_,g)&&(c[g]=_[g])}}function Be(c){this.src=c,this.g={},this.h=0}Be.prototype.add=function(c,h,g,_,z){const J=c.toString();c=this.g[J],c||(c=this.g[J]=[],this.h++);const De=Dt(c,h,_,z);return De>-1?(h=c[De],g||(h.fa=!1)):(h=new He(h,this.src,J,!!_,z),h.fa=g,c.push(h)),h};function Xe(c,h){const g=h.type;if(g in c.g){var _=c.g[g],z=Array.prototype.indexOf.call(_,h,void 0),J;(J=z>=0)&&Array.prototype.splice.call(_,z,1),J&&(yt(h),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Dt(c,h,g,_){for(let z=0;z<c.length;++z){const J=c[z];if(!J.da&&J.listener==h&&J.capture==!!g&&J.ha==_)return z}return-1}var ut="closure_lm_"+(Math.random()*1e6|0),Tt={};function ct(c,h,g,_,z){if(Array.isArray(h)){for(let J=0;J<h.length;J++)ct(c,h[J],g,_,z);return null}return g=Gt(g),c&&c[$e]?c.J(h,g,l(_)?!!_.capture:!1,z):ht(c,h,g,!1,_,z)}function ht(c,h,g,_,z,J){if(!h)throw Error("Invalid event type");const De=l(z)?!!z.capture:!!z;let gt=Ze(c);if(gt||(c[ut]=gt=new Be(c)),g=gt.add(h,g,_,De,J),g.proxy)return g;if(_=yn(),g.proxy=_,_.src=c,_.listener=g,c.addEventListener)I||(z=De),z===void 0&&(z=!1),c.addEventListener(h.toString(),_,z);else if(c.attachEvent)c.attachEvent(Me(h.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function yn(){function c(g){return h.call(c.src,c.listener,g)}const h=Pe;return c}function K(c,h,g,_,z){if(Array.isArray(h))for(var J=0;J<h.length;J++)K(c,h[J],g,_,z);else _=l(_)?!!_.capture:!!_,g=Gt(g),c&&c[$e]?(c=c.i,J=String(h).toString(),J in c.g&&(h=c.g[J],g=Dt(h,g,_,z),g>-1&&(yt(h[g]),Array.prototype.splice.call(h,g,1),h.length==0&&(delete c.g[J],c.h--)))):c&&(c=Ze(c))&&(h=c.g[h.toString()],c=-1,h&&(c=Dt(h,g,_,z)),(g=c>-1?h[c]:null)&&je(g))}function je(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[$e])Xe(h.i,c);else{var g=c.type,_=c.proxy;h.removeEventListener?h.removeEventListener(g,_,c.capture):h.detachEvent?h.detachEvent(Me(g),_):h.addListener&&h.removeListener&&h.removeListener(_),(g=Ze(h))?(Xe(g,c),g.h==0&&(g.src=null,h[ut]=null)):yt(c)}}}function Me(c){return c in Tt?Tt[c]:Tt[c]="on"+c}function Pe(c,h){if(c.da)c=!0;else{h=new Ae(h,this);const g=c.listener,_=c.ha||c.src;c.fa&&je(c),c=g.call(_,h)}return c}function Ze(c){return c=c[ut],c instanceof Be?c:null}var Pt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Gt(c){return typeof c=="function"?c:(c[Pt]||(c[Pt]=function(h){return c.handleEvent(h)}),c[Pt])}function pt(){j.call(this),this.i=new Be(this),this.M=this,this.G=null}f(pt,j),pt.prototype[$e]=!0,pt.prototype.removeEventListener=function(c,h,g,_){K(this,c,h,g,_)};function P(c,h){var g,_=c.G;if(_)for(g=[];_;_=_.G)g.push(_);if(c=c.M,_=h.type||h,typeof h=="string")h=new S(h,c);else if(h instanceof S)h.target=h.target||c;else{var z=h;h=new S(_,c),me(h,z)}z=!0;let J,De;if(g)for(De=g.length-1;De>=0;De--)J=h.g=g[De],z=q(J,_,!0,h)&&z;if(J=h.g=c,z=q(J,_,!0,h)&&z,z=q(J,_,!1,h)&&z,g)for(De=0;De<g.length;De++)J=h.g=g[De],z=q(J,_,!1,h)&&z}pt.prototype.N=function(){if(pt.Z.N.call(this),this.i){var c=this.i;for(const h in c.g){const g=c.g[h];for(let _=0;_<g.length;_++)yt(g[_]);delete c.g[h],c.h--}}this.G=null},pt.prototype.J=function(c,h,g,_){return this.i.add(String(c),h,!1,g,_)},pt.prototype.K=function(c,h,g,_){return this.i.add(String(c),h,!0,g,_)};function q(c,h,g,_){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();let z=!0;for(let J=0;J<h.length;++J){const De=h[J];if(De&&!De.da&&De.capture==g){const gt=De.listener,Sn=De.ha||De.src;De.fa&&Xe(c.i,De),z=gt.call(Sn,_)!==!1&&z}}return z&&!_.defaultPrevented}function te(c,h){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(c,h||0)}function xe(c){c.g=te(()=>{c.g=null,c.i&&(c.i=!1,xe(c))},c.l);const h=c.h;c.h=null,c.m.apply(null,h)}class ce extends j{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(c){j.call(this),this.h=c,this.g={}}f(de,j);var Se=[];function We(c){Kt(c.g,function(h,g){this.g.hasOwnProperty(g)&&je(h)},c),c.g={}}de.prototype.N=function(){de.Z.N.call(this),We(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var st=o.JSON.stringify,Ee=o.JSON.parse,Mn=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Ht(){}function ne(){}var et={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function O(){S.call(this,"d")}f(O,S);function ve(){S.call(this,"c")}f(ve,S);var ke={},Re=null;function ue(){return Re=Re||new pt}ke.Ia="serverreachability";function Et(c){S.call(this,ke.Ia,c)}f(Et,S);function _t(c){const h=ue();P(h,new Et(h))}ke.STAT_EVENT="statevent";function nn(c,h){S.call(this,ke.STAT_EVENT,c),this.stat=h}f(nn,S);function wt(c){const h=ue();P(h,new nn(h,c))}ke.Ja="timingevent";function bn(c,h){S.call(this,ke.Ja,c),this.size=h}f(bn,S);function un(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},h)}function Rn(){this.g=!0}Rn.prototype.ua=function(){this.g=!1};function gs(c,h,g,_,z,J){c.info(function(){if(c.g)if(J){var De="",gt=J.split("&");for(let tn=0;tn<gt.length;tn++){var Sn=gt[tn].split("=");if(Sn.length>1){const Bn=Sn[0];Sn=Sn[1];const qs=Bn.split("_");De=qs.length>=2&&qs[1]=="type"?De+(Bn+"="+Sn+"&"):De+(Bn+"=redacted&")}}}else De=null;else De=J;return"XMLHTTP REQ ("+_+") [attempt "+z+"]: "+h+`
`+g+`
`+De})}function es(c,h,g,_,z,J,De){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+z+"]: "+h+`
`+g+`
`+J+" "+De})}function ys(c,h,g,_){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+Fs(c,g)+(_?" "+_:"")})}function ui(c,h){c.info(function(){return"TIMEOUT: "+h})}Rn.prototype.info=function(){};function Fs(c,h){if(!c.g)return h;if(!h)return null;try{const J=JSON.parse(h);if(J){for(c=0;c<J.length;c++)if(Array.isArray(J[c])){var g=J[c];if(!(g.length<2)){var _=g[1];if(Array.isArray(_)&&!(_.length<1)){var z=_[0];if(z!="noop"&&z!="stop"&&z!="close")for(let De=1;De<_.length;De++)_[De]=""}}}}return st(J)}catch{return h}}var os={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},D={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Q;function R(){}f(R,Ht),R.prototype.g=function(){return new XMLHttpRequest},Q=new R;function x(c){return encodeURIComponent(String(c))}function L(c){var h=1;c=c.split(":");const g=[];for(;h>0&&c.length;)g.push(c.shift()),h--;return c.length&&g.push(c.join(":")),g}function U(c,h,g,_){this.j=c,this.i=h,this.l=g,this.S=_||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var G={},Z={};function ie(c,h,g){c.M=1,c.A=Ki(sn(h)),c.u=g,c.R=!0,Ce(c,null)}function Ce(c,h){c.F=Date.now(),Ge(c),c.B=sn(c.A);var g=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),le(g.i,"t",_),c.C=0,g=c.j.L,c.h=new X,c.g=lp(c.j,g?h:null,!c.u),c.P>0&&(c.O=new ce(m(c.Y,c,c.g),c.P)),h=c.V,g=c.g,_=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(Se[0]=z.toString()),z=Se);for(let J=0;J<z.length;J++){const De=ct(g,z[J],_||h.handleEvent,!1,h.h||h);if(!De)break;h.g[De.key]=De}h=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,h)):(c.v="GET",c.g.ea(c.B,c.v,null,h)),_t(),gs(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const h=this.O;h&&Vs(c)==3?h.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const gt=Vs(this.g),Sn=this.g.ya(),tn=this.g.ca();if(!(gt<3)&&(gt!=3||this.g&&(this.h.h||this.g.la()||Xf(this.g)))){this.K||gt!=4||Sn==7||(Sn==8||tn<=0?_t(3):_t(2)),Qt(this);var h=this.g.ca();this.X=h;var g=tt(this);if(this.o=h==200,es(this.i,this.v,this.B,this.l,this.S,gt,h),this.o){if(this.U&&!this.L){t:{if(this.g){var _,z=this.g;if((_=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var J=_;break t}}J=null}if(c=J)ys(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fn(this,c);else{this.o=!1,this.m=3,wt(12),Bt(this),Mt(this);break e}}if(this.R){c=!0;let Bn;for(;!this.K&&this.C<g.length;)if(Bn=pe(this,g),Bn==Z){gt==4&&(this.m=4,wt(14),c=!1),ys(this.i,this.l,null,"[Incomplete Response]");break}else if(Bn==G){this.m=4,wt(15),ys(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else ys(this.i,this.l,Bn,null),Fn(this,Bn);if(Oe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||g.length!=0||this.h.h||(this.m=1,wt(16),c=!1),this.o=this.o&&c,!c)ys(this.i,this.l,g,"[Invalid Chunked Response]"),Bt(this),Mt(this);else if(g.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),tm(De),De.P=!0,wt(11))}}else ys(this.i,this.l,g,null),Fn(this,g);gt==4&&Bt(this),this.o&&!this.K&&(gt==4?rp(this.j,this):(this.o=!1,Ge(this)))}else Fx(this.g),h==400&&g.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),Bt(this),Mt(this)}}}catch{}finally{}};function tt(c){if(!Oe(c))return c.g.la();const h=Xf(c.g);if(h==="")return"";let g="";const _=h.length,z=Vs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Bt(c),Mt(c),"";c.h.i=new o.TextDecoder}for(let J=0;J<_;J++)c.h.h=!0,g+=c.h.i.decode(h[J],{stream:!(z&&J==_-1)});return h.length=0,c.h.g+=g,c.C=0,c.h.g}function Oe(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function pe(c,h){var g=c.C,_=h.indexOf(`
`,g);return _==-1?Z:(g=Number(h.substring(g,_)),isNaN(g)?G:(_+=1,_+g>h.length?Z:(h=h.slice(_,_+g),c.C=_+g,h)))}U.prototype.cancel=function(){this.K=!0,Bt(this)};function Ge(c){c.T=Date.now()+c.H,pn(c,c.H)}function pn(c,h){if(c.D!=null)throw Error("WatchDog timer not null");c.D=un(m(c.aa,c),h)}function Qt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ui(this.i,this.B),this.M!=2&&(_t(),wt(17)),Bt(this),this.m=2,Mt(this)):pn(this,this.T-c)};function Mt(c){c.j.I==0||c.K||rp(c.j,c)}function Bt(c){Qt(c);var h=c.O;h&&typeof h.dispose=="function"&&h.dispose(),c.O=null,We(c.V),c.g&&(h=c.g,c.g=null,h.abort(),h.dispose())}function Fn(c,h){try{var g=c.j;if(g.I!=0&&(g.g==c||nt(g.h,c))){if(!c.L&&nt(g.h,c)&&g.I==3){try{var _=g.Ba.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var z=_;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Bl(g),jl(g);else break e;em(g),wt(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=un(m(g.Va,g),6e3));we(g.h)<=1&&g.ta&&(g.ta=void 0)}else mi(g,11)}else if((c.L||g.g==c)&&Bl(g),!k(h))for(z=g.Ba.g.parse(h),h=0;h<z.length;h++){let tn=z[h];const Bn=tn[0];if(!(Bn<=g.K))if(g.K=Bn,tn=tn[1],g.I==2)if(tn[0]=="c"){g.M=tn[1],g.ba=tn[2];const qs=tn[3];qs!=null&&(g.ka=qs,g.j.info("VER="+g.ka));const di=tn[4];di!=null&&(g.za=di,g.j.info("SVER="+g.za));const kr=tn[5];kr!=null&&typeof kr=="number"&&kr>0&&(_=1.5*kr,g.O=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const Ar=c.g;if(Ar){const Hl=Ar.g?Ar.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hl){var J=_.h;J.g||Hl.indexOf("spdy")==-1&&Hl.indexOf("quic")==-1&&Hl.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(rt(J,J.h),J.h=null))}if(_.G){const nm=Ar.g?Ar.g.getResponseHeader("X-HTTP-Session-Id"):null;nm&&(_.wa=nm,vt(_.J,_.G,nm))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),_=g;var De=c;if(_.na=ap(_,_.L?_.ba:null,_.W),De.L){it(_.h,De);var gt=De,Sn=_.O;Sn&&(gt.H=Sn),gt.D&&(Qt(gt),Ge(gt)),_.g=De}else np(_);g.i.length>0&&Rl(g)}else tn[0]!="stop"&&tn[0]!="close"||mi(g,7);else g.I==3&&(tn[0]=="stop"||tn[0]=="close"?tn[0]=="stop"?mi(g,7):Zu(g):tn[0]!="noop"&&g.l&&g.l.qa(tn),g.A=0)}}_t(4)}catch{}}var Wn=class{constructor(c,h){this.g=c,this.map=h}};function Yt(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qe(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function we(c){return c.h?1:c.g?c.g.size:0}function nt(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function rt(c,h){c.g?c.g.add(h):c.h=h}function it(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}Yt.prototype.cancel=function(){if(this.i=qe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function qe(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let h=c.i;for(const g of c.g.values())h=h.concat(g.G);return h}return y(c.i)}var ot=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lt(c,h){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const _=c[g].indexOf("=");let z,J=null;_>=0?(z=c[g].substring(0,_),J=c[g].substring(_+1)):z=c[g],h(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function mn(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;c instanceof mn?(this.l=c.l,As(this,c.j),this.o=c.o,this.g=c.g,xr(this,c.u),this.h=c.h,ta(this,Ne(c.i)),this.m=c.m):c&&(h=String(c).match(ot))?(this.l=!1,As(this,h[1]||"",!0),this.o=vr(h[2]||""),this.g=vr(h[3]||"",!0),xr(this,h[4]),this.h=vr(h[5]||"",!0),ta(this,h[6]||"",!0),this.m=vr(h[7]||"")):(this.l=!1,this.i=new Dr(null,this.l))}mn.prototype.toString=function(){const c=[];var h=this.j;h&&c.push(_r(h,na,!0),":");var g=this.g;return(g||h=="file")&&(c.push("//"),(h=this.o)&&c.push(_r(h,na,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(_r(g,g.charAt(0)=="/"?Qu:Ll,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",_r(g,Xu)),c.join("")},mn.prototype.resolve=function(c){const h=sn(this);let g=!!c.j;g?As(h,c.j):g=!!c.o,g?h.o=c.o:g=!!c.g,g?h.g=c.g:g=c.u!=null;var _=c.h;if(g)xr(h,c.u);else if(g=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var z=h.h.lastIndexOf("/");z!=-1&&(_=h.h.slice(0,z+1)+_)}if(z=_,z==".."||z==".")_="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){_=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let De=0;De<z.length;){const gt=z[De++];gt=="."?_&&De==z.length&&J.push(""):gt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&De==z.length&&J.push("")):(J.push(gt),_=!0)}_=J.join("/")}else _=z}return g?h.h=_:g=c.i.toString()!=="",g?ta(h,Ne(c.i)):g=!!c.m,g&&(h.m=c.m),h};function sn(c){return new mn(c)}function As(c,h,g){c.j=g?vr(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function xr(c,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);c.u=h}else c.u=null}function ta(c,h,g){h instanceof Dr?(c.i=h,dt(c.i,c.l)):(g||(h=_r(h,Yu)),c.i=new Dr(h,c.l))}function vt(c,h,g){c.i.set(h,g)}function Ki(c){return vt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function vr(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function _r(c,h,g){return typeof c=="string"?(c=encodeURI(c).replace(h,Pl),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Pl(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var na=/[#\/\?@]/g,Ll=/[#\?:]/g,Qu=/[#\?]/g,Yu=/[#\?@]/g,Xu=/#/g;function Dr(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&Lt(c.i,function(h,g){c.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}n=Dr.prototype,n.add=function(c,h){b(this),this.i=null,c=ye(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(h),this.h+=1,this};function H(c,h){b(c),h=ye(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function Y(c,h){return b(c),h=ye(c,h),c.g.has(h)}n.forEach=function(c,h){b(this),this.g.forEach(function(g,_){g.forEach(function(z){c.call(h,z,_,this)},this)},this)};function W(c,h){b(c);let g=[];if(typeof h=="string")Y(c,h)&&(g=g.concat(c.g.get(ye(c,h))));else for(c=Array.from(c.g.values()),h=0;h<c.length;h++)g=g.concat(c[h]);return g}n.set=function(c,h){return b(this),this.i=null,c=ye(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},n.get=function(c,h){return c?(c=W(this,c),c.length>0?String(c[0]):h):h};function le(c,h,g){H(c,h),g.length>0&&(c.i=null,c.g.set(ye(c,h),y(g)),c.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],h=Array.from(this.g.keys());for(let _=0;_<h.length;_++){var g=h[_];const z=x(g);g=W(this,g);for(let J=0;J<g.length;J++){let De=z;g[J]!==""&&(De+="="+x(g[J])),c.push(De)}}return this.i=c.join("&")};function Ne(c){const h=new Dr;return h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),h}function ye(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function dt(c,h){h&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,_){const z=_.toLowerCase();_!=z&&(H(this,_),le(this,z,g))},c)),c.j=h}function bt(c,h){const g=new Rn;if(o.Image){const _=new Image;_.onload=d(jt,g,"TestLoadImage: loaded",!0,h,_),_.onerror=d(jt,g,"TestLoadImage: error",!1,h,_),_.onabort=d(jt,g,"TestLoadImage: abort",!1,h,_),_.ontimeout=d(jt,g,"TestLoadImage: timeout",!1,h,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else h(!1)}function xn(c,h){const g=new Rn,_=new AbortController,z=setTimeout(()=>{_.abort(),jt(g,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:_.signal}).then(J=>{clearTimeout(z),J.ok?jt(g,"TestPingServer: ok",!0,h):jt(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(z),jt(g,"TestPingServer: error",!1,h)})}function jt(c,h,g,_,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),_(g)}catch{}}function Rt(){this.g=new Mn}function dn(c){this.i=c.Sb||null,this.h=c.ab||!1}f(dn,Ht),dn.prototype.g=function(){return new In(this.i,this.h)};function In(c,h){pt.call(this),this.H=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(In,pt),n=In.prototype,n.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=h,this.readyState=1,Nn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(h.body=c),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,on(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Nn(this)),this.g&&(this.readyState=3,Nn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ct(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ct(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?on(this):Nn(this),this.readyState==3&&Ct(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,on(this))},n.Na=function(c){this.g&&(this.response=c,on(this))},n.ga=function(){this.g&&on(this)};function on(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Nn(c)}n.setRequestHeader=function(c,h){this.A.append(c,h)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=h.next();return c.join(`\r
`)};function Nn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(In.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Xt(c){let h="";return Kt(c,function(g,_){h+=_,h+=":",h+=g,h+=`\r
`}),h}function en(c,h,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Xt(g),typeof c=="string"?g!=null&&x(g):vt(c,h,g))}function Nt(c){pt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Nt,pt);var rn=/^https?$/i,Es=["POST","PUT"];n=Nt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,h,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Q.g(),this.g.onreadystatechange=p(m(this.Ca,this));try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(J){Os(this,J);return}if(c=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var z in _)g.set(z,_[z]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())g.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Es,h,void 0)>=0)||_||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,De]of g)this.g.setRequestHeader(J,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(J){Os(this,J)}};function Os(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.o=5,Gi(c),Qi(c)}function Gi(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),Qi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qi(this,!0)),Nt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ju(this):this.Xa())},n.Xa=function(){Ju(this)};function Ju(c){if(c.h&&typeof i<"u"){if(c.v&&Vs(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),Vs(c)==4){c.h=!1;try{const J=c.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var _;if(_=J===0){let De=String(c.D).match(ot)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),_=!rn.test(De?De.toLowerCase():"")}g=_}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var z=Vs(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",Gi(c)}}finally{Qi(c)}}}}function Qi(c,h){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,h||P(c,"ready");try{g.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vs(c){return c.g?c.g.readyState:0}n.ca=function(){try{return Vs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),Ee(h)}};function Xf(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Fx(c){const h={};c=(c.g&&Vs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var g=L(c[_]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=h[z]||[];h[z]=J,J.push(g)}qt(h,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function sa(c,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||h}function Jf(c){this.za=0,this.i=[],this.j=new Rn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=sa("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=sa("baseRetryDelayMs",5e3,c),this.Za=sa("retryDelaySeedMs",1e4,c),this.Ta=sa("forwardChannelMaxRetries",2,c),this.va=sa("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(c&&c.concurrentRequestLimit),this.Ba=new Rt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Jf.prototype,n.ka=8,n.I=1,n.connect=function(c,h,g,_){wt(0),this.W=c,this.H=h||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.J=ap(this,null,this.W),Rl(this)};function Zu(c){if(Zf(c),c.I==3){var h=c.V++,g=sn(c.J);if(vt(g,"SID",c.M),vt(g,"RID",h),vt(g,"TYPE","terminate"),ra(c,g),h=new U(c,c.j,h),h.M=2,h.A=Ki(sn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=h.A,g=!0),g||(h.g=lp(h.j,null),h.g.ea(h.A)),h.F=Date.now(),Ge(h)}op(c)}function jl(c){c.g&&(tm(c),c.g.cancel(),c.g=null)}function Zf(c){jl(c),c.v&&(o.clearTimeout(c.v),c.v=null),Bl(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Rl(c){if(!Qe(c.h)&&!c.m){c.m=!0;var h=c.Ea;ee||N(),M||(ee(),M=!0),E.add(h,c),c.D=0}}function Ox(c,h){return we(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=h.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=un(m(c.Ea,c,h),ip(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new U(this,this.j,c);let J=this.o;if(this.U&&(J?(J=ae(J),me(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,h>4096){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=tp(this,z,h),g=sn(this.J),vt(g,"RID",c),vt(g,"CVER",22),this.G&&vt(g,"X-HTTP-Session-Id",this.G),ra(this,g),J&&(this.R?h="headers="+x(Xt(J))+"&"+h:this.u&&en(g,this.u,J)),rt(this.h,z),this.Ra&&vt(g,"TYPE","init"),this.S?(vt(g,"$req",h),vt(g,"SID","null"),z.U=!0,ie(z,g,null)):ie(z,g,h),this.I=2}}else this.I==3&&(c?ep(this,c):this.i.length==0||Qe(this.h)||ep(this))};function ep(c,h){var g;h?g=h.l:g=c.V++;const _=sn(c.J);vt(_,"SID",c.M),vt(_,"RID",g),vt(_,"AID",c.K),ra(c,_),c.u&&c.o&&en(_,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),h&&(c.i=h.G.concat(c.i)),h=tp(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),rt(c.h,g),ie(g,_,h)}function ra(c,h){c.H&&Kt(c.H,function(g,_){vt(h,_,g)}),c.l&&Kt({},function(g,_){vt(h,_,g)})}function tp(c,h,g){g=Math.min(c.i.length,g);const _=c.l?m(c.l.Ka,c.l,c):null;e:{var z=c.i;let gt=-1;for(;;){const Sn=["count="+g];gt==-1?g>0?(gt=z[0].g,Sn.push("ofs="+gt)):gt=0:Sn.push("ofs="+gt);let tn=!0;for(let Bn=0;Bn<g;Bn++){var J=z[Bn].g;const qs=z[Bn].map;if(J-=gt,J<0)gt=Math.max(0,z[Bn].g-100),tn=!1;else try{J="req"+J+"_"||"";try{var De=qs instanceof Map?qs:Object.entries(qs);for(const[di,kr]of De){let Ar=kr;l(kr)&&(Ar=st(kr)),Sn.push(J+di+"="+encodeURIComponent(Ar))}}catch(di){throw Sn.push(J+"type="+encodeURIComponent("_badmap")),di}}catch{_&&_(qs)}}if(tn){De=Sn.join("&");break e}}De=void 0}return c=c.i.splice(0,g),h.G=c,De}function np(c){if(!c.g&&!c.v){c.Y=1;var h=c.Da;ee||N(),M||(ee(),M=!0),E.add(h,c),c.A=0}}function em(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=un(m(c.Da,c),ip(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,sp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=un(m(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),jl(this),sp(this))};function tm(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function sp(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var h=sn(c.na);vt(h,"RID","rpc"),vt(h,"SID",c.M),vt(h,"AID",c.K),vt(h,"CI",c.F?"0":"1"),!c.F&&c.ia&&vt(h,"TO",c.ia),vt(h,"TYPE","xmlhttp"),ra(c,h),c.u&&c.o&&en(h,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Ki(sn(h)),g.u=null,g.R=!0,Ce(g,c)}n.Va=function(){this.C!=null&&(this.C=null,jl(this),em(this),wt(19))};function Bl(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function rp(c,h){var g=null;if(c.g==h){Bl(c),tm(c),c.g=null;var _=2}else if(nt(c.h,h))g=h.G,it(c.h,h),_=1;else return;if(c.I!=0){if(h.o)if(_==1){g=h.u?h.u.length:0,h=Date.now()-h.F;var z=c.D;_=ue(),P(_,new bn(_,g)),Rl(c)}else np(c);else if(z=h.m,z==3||z==0&&h.X>0||!(_==1&&Ox(c,h)||_==2&&em(c)))switch(g&&g.length>0&&(h=c.h,h.i=h.i.concat(g)),z){case 1:mi(c,5);break;case 4:mi(c,10);break;case 3:mi(c,6);break;default:mi(c,2)}}}function ip(c,h){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*h}function mi(c,h){if(c.j.info("Error code "+h),h==2){var g=m(c.bb,c),_=c.Ua;const z=!_;_=new mn(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||As(_,"https"),Ki(_),z?bt(_.toString(),g):xn(_.toString(),g)}else wt(2);c.I=0,c.l&&c.l.pa(h),op(c),Zf(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function op(c){if(c.I=0,c.ja=[],c.l){const h=qe(c.h);(h.length!=0||c.i.length!=0)&&(C(c.ja,h),C(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function ap(c,h,g){var _=g instanceof mn?sn(g):new mn(g);if(_.g!="")h&&(_.g=h+"."+_.g),xr(_,_.u);else{var z=o.location;_=z.protocol,h=h?h+"."+z.hostname:z.hostname,z=+z.port;const J=new mn(null);_&&As(J,_),h&&(J.g=h),z&&xr(J,z),g&&(J.h=g),_=J}return g=c.G,h=c.wa,g&&h&&vt(_,g,h),vt(_,"VER",c.ka),ra(c,_),_}function lp(c,h,g){if(h&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Aa&&!c.ma?new Nt(new dn({ab:g})):new Nt(c.ma),h.Fa(c.L),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cp(){}n=cp.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ul(){}Ul.prototype.g=function(c,h){return new ms(c,h)};function ms(c,h){pt.call(this),this.g=new Jf(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(c?c["X-WebChannel-Client-Profile"]=h.sa:c={"X-WebChannel-Client-Profile":h.sa}),this.g.U=c,(c=h&&h.Qb)&&!k(c)&&(this.g.u=c),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!k(h)&&(this.g.G=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new Yi(this)}f(ms,pt),ms.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ms.prototype.close=function(){Zu(this.g)},ms.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=st(c),c=g);h.i.push(new Wn(h.Ya++,c)),h.I==3&&Rl(h)},ms.prototype.N=function(){this.g.l=null,delete this.j,Zu(this.g),delete this.g,ms.Z.N.call(this)};function up(c){O.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(const g in h){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}f(up,O);function mp(){ve.call(this),this.status=1}f(mp,ve);function Yi(c){this.g=c}f(Yi,cp),Yi.prototype.ra=function(){P(this.g,"a")},Yi.prototype.qa=function(c){P(this.g,new up(c))},Yi.prototype.pa=function(c){P(this.g,new mp)},Yi.prototype.oa=function(){P(this.g,"b")},Ul.prototype.createWebChannel=Ul.prototype.g,ms.prototype.send=ms.prototype.o,ms.prototype.open=ms.prototype.m,ms.prototype.close=ms.prototype.close,cb=function(){return new Ul},lb=function(){return ue()},ab=ke,Km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},os.NO_ERROR=0,os.TIMEOUT=8,os.HTTP_ERROR=6,hc=os,D.COMPLETE="complete",ob=D,ne.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",pt.prototype.listen=pt.prototype.J,ja=ne,Nt.prototype.listenOnce=Nt.prototype.K,Nt.prototype.getLastError=Nt.prototype.Ha,Nt.prototype.getLastErrorCode=Nt.prototype.ya,Nt.prototype.getStatus=Nt.prototype.ca,Nt.prototype.getResponseJson=Nt.prototype.La,Nt.prototype.getResponseText=Nt.prototype.la,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Fa,ib=Nt}).apply(typeof ql<"u"?ql:typeof self<"u"?self:typeof window<"u"?window:{});const Up="@firebase/firestore",Hp="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qn.UNAUTHENTICATED=new qn(null),qn.GOOGLE_CREDENTIALS=new qn("google-credentials-uid"),qn.FIRST_PARTY=new qn("first-party-uid"),qn.MOCK_USER=new qn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wo="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=new Gy("@firebase/firestore");function bo(){return Ti.logLevel}function he(n,...e){if(Ti.logLevel<=St.DEBUG){const t=e.map(qd);Ti.debug(`Firestore (${Wo}): ${n}`,...t)}}function ss(n,...e){if(Ti.logLevel<=St.ERROR){const t=e.map(qd);Ti.error(`Firestore (${Wo}): ${n}`,...t)}}function Pi(n,...e){if(Ti.logLevel<=St.WARN){const t=e.map(qd);Ti.warn(`Firestore (${Wo}): ${n}`,...t)}}function qd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,ub(n,s,t)}function ub(n,e,t){let s=`FIRESTORE (${Wo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw ss(s),new Error(s)}function Fe(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||ub(e,r,s)}function lt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends Mi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qn.UNAUTHENTICATED))}shutdown(){}}class Mk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Fk{constructor(e){this.t=e,this.currentUser=qn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fe(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,t(u)):Promise.resolve();let i=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ys,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ys)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Fe(typeof s.accessToken=="string",31837,{l:s}),new mb(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string",2055,{h:e}),new qn(e)}}class Ok{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=qn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qk{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Ok(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(qn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $k{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Jy(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fe(this.o===void 0,3512);const s=i=>{i.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,he("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Mp(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Fe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Mp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=zk(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function at(n,e){return n<e?-1:n>e?1:0}function Gm(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return fm(r)===fm(i)?at(r,i):fm(r)?1:-1}return at(n.length,e.length)}const Wk=55296,Kk=57343;function fm(n){const e=n.charCodeAt(0);return e>=Wk&&e<=Kk}function Io(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function db(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp="__name__";class zs{constructor(e,t,s){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Le(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return zs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zs?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=zs.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return at(e.length,t.length)}static compareSegments(e,t){const s=zs.isNumericId(e),r=zs.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?zs.extractNumericId(e).compare(zs.extractNumericId(t)):Gm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $r.fromString(e.substring(4,e.length-2))}}class Ut extends zs{construct(e,t,s){return new Ut(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new _e(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Ut(t)}static emptyPath(){return new Ut([])}}const Gk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fn extends zs{construct(e,t,s){return new fn(e,t,s)}static isValidIdentifier(e){return Gk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fp}static keyField(){return new fn([Fp])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new _e(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new _e(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new _e(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new _e(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fn(t)}static emptyPath(){return new fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(Ut.fromString(e))}static fromName(e){return new Ve(Ut.fromString(e).popFirst(5))}static empty(){return new Ve(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new Ut(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(n,e,t){if(!t)throw new _e(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qk(n,e,t,s){if(e===!0&&s===!0)throw new _e(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Op(n){if(!Ve.isDocumentKey(n))throw new _e(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function qp(n){if(Ve.isDocumentKey(n))throw new _e(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function pb(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function mu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new _e(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=mu(n);throw new _e(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(n,e){const t={typeString:n};return e&&(t.value=e),t}function vl(n,e){if(!pb(n))throw new _e(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new _e(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p=-62135596800,zp=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(e){return be.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*zp);return new be(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<$p)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zp}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vl(e,be._jsonSchema))return new be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-$p;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:Vn("string",be._jsonSchemaVersion),seconds:Vn("number"),nanoseconds:Vn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{static fromTimestamp(e){return new Ye(e)}static min(){return new Ye(new be(0,0))}static max(){return new Ye(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=-1;class Rc{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function Qm(n){return n.fields.find(e=>e.kind===2)}function yi(n){return n.fields.filter(e=>e.kind!==2)}Rc.UNKNOWN_ID=-1;class gc{constructor(e,t){this.fieldPath=e,this.kind=t}}class il{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new il(0,hs.min())}}function Yk(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=Ye.fromTimestamp(s===1e9?new be(t+1,0):new be(t,s));return new hs(r,Ve.empty(),e)}function hb(n){return new hs(n.readTime,n.key,rl)}class hs{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new hs(Ye.min(),Ve.empty(),rl)}static max(){return new hs(Ye.max(),Ve.empty(),rl)}}function zd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(n.documentKey,e.documentKey),t!==0?t:at(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fi(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==gb)throw n;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$.reject(t)}static resolve(e){return new $((t,s)=>{t(e)})}static reject(e){return new $((t,s)=>{s(e)})}static waitFor(e){return new $((t,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>s(u))}),o=!0,i===r&&t()})}static or(e){let t=$.resolve(!1);for(const s of e)t=t.next(r=>r?$.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&s(o)},d=>r(d))}})}static doWhile(e,t){return new $((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds="SimpleDb";class du{static open(e,t,s,r){try{return new du(t,e.transaction(r,s))}catch(i){throw new $a(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ys,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new $a(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=Wd(s.target.error);this.S.reject(new $a(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(he(ds,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Jk(t)}}class zr{static delete(e){return he(ds,"Removing database:",e),Ni(By().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Wy())return!1;if(zr.F())return!0;const e=Pc(),t=zr.M(e),s=0<t&&t<10,r=bb(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,zr.M(Pc())===12.2&&ss("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(he(ds,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new $a(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new _e(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new _e(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new $a(e,o))},r.onupgradeneeded=i=>{he(ds,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next(()=>{he(ds,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=du.open(this.db,e,i?"readonly":"readwrite",s),u=r(l).next(m=>(l.C(),m)).catch(m=>(l.abort(m),$.reject(m))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,m=u.name!=="FirebaseError"&&o<3;if(he(ds,"Transaction failed with error:",u.message,"Retrying:",m),this.close(),!m)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function bb(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Xk{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ni(this.U.delete())}}class $a extends _e{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ei(n){return n.name==="IndexedDbTransactionError"}class Jk{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(he(ds,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(he(ds,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ni(s)}add(e){return he(ds,"ADD",this.store.name,e,e),Ni(this.store.add(e))}get(e){return Ni(this.store.get(e)).next(t=>(t===void 0&&(t=null),he(ds,"GET",this.store.name,e,t),t))}delete(e){return he(ds,"DELETE",this.store.name,e),Ni(this.store.delete(e))}count(){return he(ds,"COUNT",this.store.name),Ni(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(s),o=[];return this.H(i,(l,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Z(e,t){he(ds,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,l)=>l.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new $((s,r)=>{t.onerror=i=>{const o=Wd(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}H(e,t){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new Xk(l),m=t(l.primaryKey,l.value,u);if(m instanceof $){const d=m.catch(f=>(u.done(),$.reject(f)));s.push(d)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}}).next(()=>$.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ni(n){return new $((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=Wd(s.target.error);t(r)}})}let Wp=!1;function Wd(n){const e=zr.M(Pc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new _e("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Wp||(Wp=!0,setTimeout(()=>{throw s},0)),s}}return n}const za="IndexBackfiller";class Zk{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){he(za,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();he(za,`Documents written: ${t}`)}catch(t){ei(t)?he(za,"Ignoring IndexedDB error during index backfill: ",t):await Fi(t)}await this.re(6e4)})}}class eA{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let r=t,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return he(za,`Processing collection: ${o}`),this.oe(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>t-r)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(r,i)).next(l=>(he(za,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}_e(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=hb(i);zd(o,s)>0&&(s=o)}),new hs(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_s.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai=-1;function fu(n){return n==null}function ol(n){return n===0&&1/n==-1/0}function tA(n){return typeof n=="number"&&Number.isInteger(n)&&!ol(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc="";function Jn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Kp(e)),e=nA(n.get(t),e);return Kp(e)}function nA(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case Bc:t+="";break;default:t+=i}}return t}function Kp(n){return n+Bc+""}function Gs(n){const e=n.length;if(Fe(e>=2,64408,{path:n}),e===2)return Fe(n.charAt(0)===Bc&&n.charAt(1)==="",56145,{path:n}),Ut.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf(Bc,i);switch((o<0||o>t)&&Le(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),s.push(u);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:Le(61167,{path:n})}i=o+2}return new Ut(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="remoteDocuments",_l="owner",Xi="owner",al="mutationQueues",sA="userId",Is="mutations",Gp="batchId",Di="userMutationsIndex",Qp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yc(n,e){return[n,Jn(e)]}function Nb(n,e,t){return[n,Jn(e),t]}const rA={},So="documentMutations",Uc="remoteDocumentsV14",iA=["prefixPath","collectionGroup","readTime","documentId"],bc="documentKeyIndex",oA=["prefixPath","collectionGroup","documentId"],xb="collectionGroupIndex",aA=["collectionGroup","readTime","prefixPath","documentId"],ll="remoteDocumentGlobal",Ym="remoteDocumentGlobalKey",To="targets",vb="queryTargetsIndex",lA=["canonicalId","targetId"],Po="targetDocuments",cA=["targetId","path"],Kd="documentTargetsIndex",uA=["path","targetId"],Hc="targetGlobalKey",Ei="targetGlobal",cl="collectionParents",mA=["collectionId","parent"],Lo="clientMetadata",dA="clientId",pu="bundles",fA="bundleId",hu="namedQueries",pA="name",Gd="indexConfiguration",hA="indexId",Xm="collectionGroupIndex",gA="collectionGroup",Wa="indexState",yA=["indexId","uid"],_b="sequenceNumberIndex",bA=["uid","sequenceNumber"],Ka="indexEntries",NA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Db="documentKeyIndex",xA=["indexId","uid","orderedDocumentKey"],gu="documentOverlays",vA=["userId","collectionPath","documentId"],Jm="collectionPathOverlayIndex",_A=["userId","collectionPath","largestBatchId"],kb="collectionGroupOverlayIndex",DA=["userId","collectionGroup","largestBatchId"],Qd="globals",kA="name",Ab=[al,Is,So,bi,To,_l,Ei,Po,Lo,ll,cl,pu,hu],AA=[...Ab,gu],Eb=[al,Is,So,Uc,To,_l,Ei,Po,Lo,ll,cl,pu,hu,gu],Vb=Eb,Yd=[...Vb,Gd,Wa,Ka],EA=Yd,wb=[...Yd,Qd],VA=wb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm extends yb{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function jn(n,e){const t=lt(n);return zr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ti(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Cb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t){this.comparator=e,this.root=t||$n.EMPTY}insert(e,t){return new cn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$n.BLACK,null,null))}remove(e){return new cn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $l(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $l(this.root,e,this.comparator,!1)}getReverseIterator(){return new $l(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $l(this.root,e,this.comparator,!0)}}class $l{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $n{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??$n.RED,this.left=r??$n.EMPTY,this.right=i??$n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new $n(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return $n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return $n.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}$n.EMPTY=null,$n.RED=!0,$n.BLACK=!1;$n.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new $n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.comparator=e,this.data=new cn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Xp(this.data.getIterator())}getIteratorFrom(e){return new Xp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Wt(this.comparator);return t.data=e,t}}class Xp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ji(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.fields=e,e.sort(fn.comparator)}static empty(){return new us([])}unionWith(e){let t=new Wt(fn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new us(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Io(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ib("Invalid base64 string: "+i):i}}(e);return new Cn(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Cn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const wA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(n){if(Fe(!!n,39018),typeof n=="string"){let e=0;const t=wA.exec(n);if(Fe(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ln(n.seconds),nanos:ln(n.nanos)}}function ln(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function hr(n){return typeof n=="string"?Cn.fromBase64String(n):Cn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb="server_timestamp",Tb="__type__",Pb="__previous_value__",Lb="__local_write_time__";function Xd(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Tb])==null?void 0:s.stringValue)===Sb}function yu(n){const e=n.mapValue.fields[Pb];return Xd(e)?yu(e):e}function ul(n){const e=pr(n.mapValue.fields[Lb].timestampValue);return new be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,t,s,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Mc="(default)";class Li{constructor(e,t){this.projectId=e,this.database=t||Mc}static empty(){return new Li("","")}get isDefaultDatabase(){return this.database===Mc}isEqual(e){return e instanceof Li&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="__type__",jb="__max__",Hr={mapValue:{fields:{__type__:{stringValue:jb}}}},Zd="__vector__",jo="value",Nc={nullValue:"NULL_VALUE"};function Kr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xd(n)?4:Rb(n)?9007199254740991:bu(n)?10:11:Le(28295,{value:n})}function tr(n,e){if(n===e)return!0;const t=Kr(n);if(t!==Kr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ul(n).isEqual(ul(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=pr(r.timestampValue),l=pr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return hr(r.bytesValue).isEqual(hr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return ln(r.geoPointValue.latitude)===ln(i.geoPointValue.latitude)&&ln(r.geoPointValue.longitude)===ln(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ln(r.integerValue)===ln(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=ln(r.doubleValue),l=ln(i.doubleValue);return o===l?ol(o)===ol(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Io(n.arrayValue.values||[],e.arrayValue.values||[],tr);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(Yp(o)!==Yp(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!tr(o[u],l[u])))return!1;return!0}(n,e);default:return Le(52216,{left:n})}}function ml(n,e){return(n.values||[]).find(t=>tr(t,e))!==void 0}function Gr(n,e){if(n===e)return 0;const t=Kr(n),s=Kr(e);if(t!==s)return at(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ln(i.integerValue||i.doubleValue),u=ln(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(n,e);case 3:return Jp(n.timestampValue,e.timestampValue);case 4:return Jp(ul(n),ul(e));case 5:return Gm(n.stringValue,e.stringValue);case 6:return function(i,o){const l=hr(i),u=hr(o);return l.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=at(l[m],u[m]);if(d!==0)return d}return at(l.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const l=at(ln(i.latitude),ln(o.latitude));return l!==0?l:at(ln(i.longitude),ln(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Zp(n.arrayValue,e.arrayValue);case 10:return function(i,o){var p,y,C,v;const l=i.fields||{},u=o.fields||{},m=(p=l[jo])==null?void 0:p.arrayValue,d=(y=u[jo])==null?void 0:y.arrayValue,f=at(((C=m==null?void 0:m.values)==null?void 0:C.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:Zp(m,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Hr.mapValue&&o===Hr.mapValue)return 0;if(i===Hr.mapValue)return 1;if(o===Hr.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const p=Gm(u[f],d[f]);if(p!==0)return p;const y=Gr(l[u[f]],m[d[f]]);if(y!==0)return y}return at(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function Jp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return at(n,e);const t=pr(n),s=pr(e),r=at(t.seconds,s.seconds);return r!==0?r:at(t.nanos,s.nanos)}function Zp(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Gr(t[r],s[r]);if(i)return i}return at(t.length,s.length)}function Ro(n){return ed(n)}function ed(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=pr(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return hr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ve.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=ed(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${ed(t.fields[o])}`;return r+"}"}(n.mapValue):Le(61005,{value:n})}function xc(n){switch(Kr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=yu(n);return e?16+xc(e):16;case 5:return 2*n.stringValue.length;case 6:return hr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+xc(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return ti(s.fields,(i,o)=>{r+=i.length+xc(o)}),r}(n.mapValue);default:throw Le(13486,{value:n})}}function dl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function td(n){return!!n&&"integerValue"in n}function fl(n){return!!n&&"arrayValue"in n}function eh(n){return!!n&&"nullValue"in n}function th(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vc(n){return!!n&&"mapValue"in n}function bu(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Jd])==null?void 0:s.stringValue)===Zd}function Ga(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ti(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Ga(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ga(n.arrayValue.values[t]);return e}return{...n}}function Rb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===jb}const Bb={mapValue:{fields:{[Jd]:{stringValue:Zd},[jo]:{arrayValue:{}}}}};function IA(n){return"nullValue"in n?Nc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?dl(Li.empty(),Ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?bu(n)?Bb:{mapValue:{}}:Le(35942,{value:n})}function SA(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?dl(Li.empty(),Ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Bb:"mapValue"in n?bu(n)?{mapValue:{}}:Hr:Le(61959,{value:n})}function nh(n,e){const t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function sh(n,e){const t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.value=e}static empty(){return new Yn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!vc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ga(t)}setAll(e){let t=fn.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=Ga(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());vc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return tr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];vc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){ti(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Yn(Ga(this.value))}}function Ub(n){const e=[];return ti(n.fields,(t,s)=>{const r=new fn([t]);if(vc(s)){const i=Ub(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new us(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new hn(e,0,Ye.min(),Ye.min(),Ye.min(),Yn.empty(),0)}static newFoundDocument(e,t,s,r){return new hn(e,1,t,Ye.min(),s,r,0)}static newNoDocument(e,t){return new hn(e,2,t,Ye.min(),Ye.min(),Yn.empty(),0)}static newUnknownDocument(e,t){return new hn(e,3,t,Ye.min(),Ye.min(),Yn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,t){this.position=e,this.inclusive=t}}function rh(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=Ve.comparator(Ve.fromName(o.referenceValue),t.key):s=Gr(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function ih(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!tr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,t="asc"){this.field=e,this.dir=t}}function TA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{}class At extends Hb{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new PA(e,t,s):t==="array-contains"?new RA(e,s):t==="in"?new zb(e,s):t==="not-in"?new BA(e,s):t==="array-contains-any"?new UA(e,s):new At(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new LA(e,s):new jA(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Gr(t,this.value)):t!==null&&Kr(this.value)===Kr(t)&&this.matchesComparison(Gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zt extends Hb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new zt(e,t)}matches(e){return Uo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Uo(n){return n.op==="and"}function nd(n){return n.op==="or"}function ef(n){return Mb(n)&&Uo(n)}function Mb(n){for(const e of n.filters)if(e instanceof zt)return!1;return!0}function sd(n){if(n instanceof At)return n.field.canonicalString()+n.op.toString()+Ro(n.value);if(ef(n))return n.filters.map(e=>sd(e)).join(",");{const e=n.filters.map(t=>sd(t)).join(",");return`${n.op}(${e})`}}function Fb(n,e){return n instanceof At?function(s,r){return r instanceof At&&s.op===r.op&&s.field.isEqual(r.field)&&tr(s.value,r.value)}(n,e):n instanceof zt?function(s,r){return r instanceof zt&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&Fb(o,r.filters[l]),!0):!1}(n,e):void Le(19439)}function Ob(n,e){const t=n.filters.concat(e);return zt.create(t,n.op)}function qb(n){return n instanceof At?function(t){return`${t.field.canonicalString()} ${t.op} ${Ro(t.value)}`}(n):n instanceof zt?function(t){return t.op.toString()+" {"+t.getFilters().map(qb).join(" ,")+"}"}(n):"Filter"}class PA extends At{constructor(e,t,s){super(e,t,s),this.key=Ve.fromName(s.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class LA extends At{constructor(e,t){super(e,"in",t),this.keys=$b("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jA extends At{constructor(e,t){super(e,"not-in",t),this.keys=$b("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $b(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(s=>Ve.fromName(s.referenceValue))}class RA extends At{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return fl(t)&&ml(t.arrayValue,this.value)}}class zb extends At{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ml(this.value.arrayValue,t)}}class BA extends At{constructor(e,t){super(e,"not-in",t)}matches(e){if(ml(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ml(this.value.arrayValue,t)}}class UA extends At{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!fl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>ml(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function rd(n,e=null,t=[],s=[],r=null,i=null,o=null){return new HA(n,e,t,s,r,i,o)}function ji(n){const e=lt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>sd(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),fu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>Ro(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>Ro(s)).join(",")),e.Te=t}return e.Te}function Dl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!TA(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Fb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ih(n.startAt,e.startAt)&&ih(n.endAt,e.endAt)}function Fc(n){return Ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Oc(n,e){return n.filters.filter(t=>t instanceof At&&t.field.isEqual(e))}function oh(n,e,t){let s=Nc,r=!0;for(const i of Oc(n,e)){let o=Nc,l=!0;switch(i.op){case"<":case"<=":o=IA(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Nc}nh({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];nh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function ah(n,e,t){let s=Hr,r=!0;for(const i of Oc(n,e)){let o=Hr,l=!0;switch(i.op){case">=":case">":o=SA(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Hr}sh({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];sh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MA(n,e,t,s,r,i,o,l){return new Ko(n,e,t,s,r,i,o,l)}function kl(n){return new Ko(n)}function lh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Wb(n){return n.collectionGroup!==null}function Qa(n){const e=lt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Wt(fn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new pl(i,s))}),t.has(fn.keyField().canonicalString())||e.Ie.push(new pl(fn.keyField(),s))}return e.Ie}function Ds(n){const e=lt(n);return e.Ee||(e.Ee=FA(e,Qa(n))),e.Ee}function FA(n,e){if(n.limitType==="F")return rd(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new pl(r.field,i)});const t=n.endAt?new Bo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Bo(n.startAt.position,n.startAt.inclusive):null;return rd(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function id(n,e){const t=n.filters.concat([e]);return new Ko(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function od(n,e,t){return new Ko(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nu(n,e){return Dl(Ds(n),Ds(e))&&n.limitType===e.limitType}function Kb(n){return`${ji(Ds(n))}|lt:${n.limitType}`}function No(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>qb(r)).join(", ")}]`),fu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>Ro(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>Ro(r)).join(",")),`Target(${s})`}(Ds(n))}; limitType=${n.limitType})`}function Al(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Ve.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of Qa(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,l,u){const m=rh(o,l,u);return o.inclusive?m<=0:m<0}(s.startAt,Qa(s),r)||s.endAt&&!function(o,l,u){const m=rh(o,l,u);return o.inclusive?m>=0:m>0}(s.endAt,Qa(s),r))}(n,e)}function OA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Gb(n){return(e,t)=>{let s=!1;for(const r of Qa(n)){const i=qA(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function qA(n,e,t){const s=n.field.isKeyField()?Ve.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Gr(u,m):Le(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Le(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ti(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return Cb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=new cn(Ve.comparator);function ps(){return $A}const Qb=new cn(Ve.comparator);function Ra(...n){let e=Qb;for(const t of n)e=e.insert(t.key,t);return e}function Yb(n){let e=Qb;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Qs(){return Ya()}function Xb(){return Ya()}function Ya(){return new gr(n=>n.toString(),(n,e)=>n.isEqual(e))}const zA=new cn(Ve.comparator),WA=new Wt(Ve.comparator);function xt(...n){let e=WA;for(const t of n)e=e.add(t);return e}const KA=new Wt(at);function GA(){return KA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ol(e)?"-0":e}}function Jb(n){return{integerValue:""+n}}function QA(n,e){return tA(e)?Jb(e):tf(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(){this._=void 0}}function YA(n,e,t){return n instanceof Ho?function(r,i){const o={fields:{[Tb]:{stringValue:Sb},[Lb]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Xd(i)&&(i=yu(i)),i&&(o.fields[Pb]=i),{mapValue:o}}(t,e):n instanceof Mo?eN(n,e):n instanceof Fo?tN(n,e):function(r,i){const o=Zb(r,i),l=ch(o)+ch(r.Ae);return td(o)&&td(r.Ae)?Jb(l):tf(r.serializer,l)}(n,e)}function XA(n,e,t){return n instanceof Mo?eN(n,e):n instanceof Fo?tN(n,e):t}function Zb(n,e){return n instanceof hl?function(s){return td(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Ho extends xu{}class Mo extends xu{constructor(e){super(),this.elements=e}}function eN(n,e){const t=nN(e);for(const s of n.elements)t.some(r=>tr(r,s))||t.push(s);return{arrayValue:{values:t}}}class Fo extends xu{constructor(e){super(),this.elements=e}}function tN(n,e){let t=nN(e);for(const s of n.elements)t=t.filter(r=>!tr(r,s));return{arrayValue:{values:t}}}class hl extends xu{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ch(n){return ln(n.integerValue||n.doubleValue)}function nN(n){return fl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,t){this.field=e,this.transform=t}}function JA(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof Mo&&r instanceof Mo||s instanceof Fo&&r instanceof Fo?Io(s.elements,r.elements,tr):s instanceof hl&&r instanceof hl?tr(s.Ae,r.Ae):s instanceof Ho&&r instanceof Ho}(n.transform,e.transform)}class ZA{constructor(e,t){this.version=e,this.transformResults=t}}class Xn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xn}static exists(e){return new Xn(void 0,e)}static updateTime(e){return new Xn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _c(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class vu{}function rN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _u(n.key,Xn.none()):new Go(n.key,n.data,Xn.none());{const t=n.data,s=Yn.empty();let r=new Wt(fn.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new yr(n.key,s,new us(r.toArray()),Xn.none())}}function eE(n,e,t){n instanceof Go?function(r,i,o){const l=r.value.clone(),u=mh(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof yr?function(r,i,o){if(!_c(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=mh(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(iN(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Xa(n,e,t,s){return n instanceof Go?function(i,o,l,u){if(!_c(i.precondition,o))return l;const m=i.value.clone(),d=dh(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(n,e,t,s):n instanceof yr?function(i,o,l,u){if(!_c(i.precondition,o))return l;const m=dh(i.fieldTransforms,u,o),d=o.data;return d.setAll(iN(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,o,l){return _c(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function tE(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=Zb(s.transform,r||null);i!=null&&(t===null&&(t=Yn.empty()),t.set(s.field,i))}return t||null}function uh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&Io(s,r,(i,o)=>JA(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Go extends vu{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class yr extends vu{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function iN(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function mh(n,e,t){const s=new Map;Fe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,XA(o,l,t[r]))}return s}function dh(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,YA(i,o,e))}return s}class _u extends vu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oN extends vu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&eE(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Xa(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Xa(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=Xb();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=rN(o,l);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Ye.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),xt())}isEqual(e){return this.batchId===e.batchId&&Io(this.mutations,e.mutations,(t,s)=>uh(t,s))&&Io(this.baseMutations,e.baseMutations,(t,s)=>uh(t,s))}}class sf{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Fe(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return zA}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new sf(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _n,It;function sE(n){switch(n){case se.OK:return Le(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function aN(n){if(n===void 0)return ss("GRPC error has no .code"),se.UNKNOWN;switch(n){case _n.OK:return se.OK;case _n.CANCELLED:return se.CANCELLED;case _n.UNKNOWN:return se.UNKNOWN;case _n.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case _n.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case _n.INTERNAL:return se.INTERNAL;case _n.UNAVAILABLE:return se.UNAVAILABLE;case _n.UNAUTHENTICATED:return se.UNAUTHENTICATED;case _n.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case _n.NOT_FOUND:return se.NOT_FOUND;case _n.ALREADY_EXISTS:return se.ALREADY_EXISTS;case _n.PERMISSION_DENIED:return se.PERMISSION_DENIED;case _n.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case _n.ABORTED:return se.ABORTED;case _n.OUT_OF_RANGE:return se.OUT_OF_RANGE;case _n.UNIMPLEMENTED:return se.UNIMPLEMENTED;case _n.DATA_LOSS:return se.DATA_LOSS;default:return Le(39323,{code:n})}}(It=_n||(_n={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=new $r([4294967295,4294967295],0);function fh(n){const e=rE().encode(n),t=new rb;return t.update(e),new Uint8Array(t.digest())}function ph(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $r([t,s],0),new $r([r,i],0)]}class of{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Ba(`Invalid padding: ${t}`);if(s<0)throw new Ba(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Ba(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Ba(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$r.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply($r.fromNumber(s)));return r.compare(iE)===1&&(r=new $r([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=fh(e),[s,r]=ph(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new of(i,r,t);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=fh(e),[s,r]=ph(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Ba extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,El.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Du(Ye.min(),r,new cn(at),ps(),xt())}}class El{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new El(s,t,xt(),xt(),xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class lN{constructor(e,t){this.targetId=e,this.Ce=t}}class cN{constructor(e,t,s=Cn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class hh{constructor(){this.ve=0,this.Fe=gh(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),t=xt(),s=xt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Le(38017,{changeType:i})}}),new El(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=gh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class oE{constructor(e){this.Ge=e,this.ze=new Map,this.je=ps(),this.Je=zl(),this.He=zl(),this.Ye=new cn(at)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Fc(i))if(s===0){const o=new Ve(i.path);this.et(t,o,hn.newNoDocument(o,Ye.min()))}else Fe(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=hr(s).toUint8Array()}catch(u){if(u instanceof Ib)return Pi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new of(o,r,i)}catch(u){return Pi(u instanceof Ba?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&Fc(l.target)){const u=new Ve(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,hn.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let s=xt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new Du(e,t,this.Ye,this.je,s);return this.je=ps(),this.Je=zl(),this.He=zl(),this.Ye=new cn(at),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new hh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Wt(at),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Wt(at),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new hh),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zl(){return new cn(Ve.comparator)}function gh(){return new cn(Ve.comparator)}const aE={asc:"ASCENDING",desc:"DESCENDING"},lE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cE={and:"AND",or:"OR"};class uE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ad(n,e){return n.useProto3Json||fu(e)?e:{value:e}}function Oo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function mE(n,e){return Oo(n,e.toTimestamp())}function is(n){return Fe(!!n,49232),Ye.fromTimestamp(function(t){const s=pr(t);return new be(s.seconds,s.nanos)}(n))}function af(n,e){return ld(n,e).canonicalString()}function ld(n,e){const t=function(r){return new Ut(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function mN(n){const e=Ut.fromString(n);return Fe(xN(e),10190,{key:e.toString()}),e}function qc(n,e){return af(n.databaseId,e.path)}function Vi(n,e){const t=mN(e);if(t.get(1)!==n.databaseId.projectId)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ve(pN(t))}function dN(n,e){return af(n.databaseId,e)}function fN(n){const e=mN(n);return e.length===4?Ut.emptyPath():pN(e)}function cd(n){return new Ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function pN(n){return Fe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function yh(n,e,t){return{name:qc(n,e),fields:t.value.mapValue.fields}}function dE(n,e,t){const s=Vi(n,e.name),r=is(e.updateTime),i=e.createTime?is(e.createTime):Ye.min(),o=new Yn({mapValue:{fields:e.fields}}),l=hn.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function fE(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Le(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Fe(d===void 0||typeof d=="string",58123),Cn.fromBase64String(d||"")):(Fe(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Cn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?se.UNKNOWN:aN(m.code);return new _e(d,m.message||"")}(o);t=new cN(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Vi(n,s.document.name),i=is(s.document.updateTime),o=s.document.createTime?is(s.document.createTime):Ye.min(),l=new Yn({mapValue:{fields:s.document.fields}}),u=hn.newFoundDocument(r,i,o,l),m=s.targetIds||[],d=s.removedTargetIds||[];t=new Dc(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Vi(n,s.document),i=s.readTime?is(s.readTime):Ye.min(),o=hn.newNoDocument(r,i),l=s.removedTargetIds||[];t=new Dc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Vi(n,s.document),i=s.removedTargetIds||[];t=new Dc([],i,r,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new nE(r,i),l=s.targetId;t=new lN(l,o)}}return t}function $c(n,e){let t;if(e instanceof Go)t={update:yh(n,e.key,e.value)};else if(e instanceof _u)t={delete:qc(n,e.key)};else if(e instanceof yr)t={update:yh(n,e.key,e.data),updateMask:NE(e.fieldMask)};else{if(!(e instanceof oN))return Le(16599,{Vt:e.type});t={verify:qc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof Ho)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Mo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof hl)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Le(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:mE(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Le(27497)}(n,e.precondition)),t}function ud(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Xn.updateTime(is(i.updateTime)):i.exists!==void 0?Xn.exists(i.exists):Xn.none()}(e.currentDocument):Xn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let u=null;if("setToServerValue"in l)Fe(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Ho;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new Mo(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new Fo(d)}else"increment"in l?u=new hl(o,l.increment):Le(16584,{proto:l});const m=fn.fromServerFormat(l.fieldPath);return new sN(m,u)}(n,r)):[];if(e.update){e.update.name;const r=Vi(n,e.update.name),i=new Yn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const m=u.fieldPaths||[];return new us(m.map(d=>fn.fromServerFormat(d)))}(e.updateMask);return new yr(r,i,o,t,s)}return new Go(r,i,t,s)}if(e.delete){const r=Vi(n,e.delete);return new _u(r,t)}if(e.verify){const r=Vi(n,e.verify);return new oN(r,t)}return Le(1463,{proto:e})}function pE(n,e){return n&&n.length>0?(Fe(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?is(r.updateTime):is(i);return o.isEqual(Ye.min())&&(o=is(i)),new ZA(o,r.transformResults||[])}(t,e))):[]}function hN(n,e){return{documents:[dN(n,e.path)]}}function gN(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=dN(n,r);const i=function(m){if(m.length!==0)return NN(zt.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(p){return{field:xo(p.field),direction:gE(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=ad(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function yN(n){let e=fN(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Fe(s===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const p=bN(f);return p instanceof zt&&ef(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(C){return new pl(vo(C.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(p))}(t.orderBy));let l=null;t.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,fu(p)?null:p}(t.limit));let u=null;t.startAt&&(u=function(f){const p=!!f.before,y=f.values||[];return new Bo(y,p)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const p=!f.before,y=f.values||[];return new Bo(y,p)}(t.endAt)),MA(e,r,o,i,l,"F",u,m)}function hE(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=vo(t.unaryFilter.field);return At.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=vo(t.unaryFilter.field);return At.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(t.unaryFilter.field);return At.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=vo(t.unaryFilter.field);return At.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}}(n):n.fieldFilter!==void 0?function(t){return At.create(vo(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return zt.create(t.compositeFilter.filters.map(s=>bN(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Le(1026)}}(t.compositeFilter.op))}(n):Le(30097,{filter:n})}function gE(n){return aE[n]}function yE(n){return lE[n]}function bE(n){return cE[n]}function xo(n){return{fieldPath:n.canonicalString()}}function vo(n){return fn.fromServerFormat(n.fieldPath)}function NN(n){return n instanceof At?function(t){if(t.op==="=="){if(th(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NAN"}};if(eh(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(th(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NOT_NAN"}};if(eh(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xo(t.field),op:yE(t.op),value:t.value}}}(n):n instanceof zt?function(t){const s=t.getFilters().map(r=>NN(r));return s.length===1?s[0]:{compositeFilter:{op:bE(t.op),filters:s}}}(n):Le(54877,{filter:n})}function NE(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function xN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,t,s,r,i=Ye.min(),o=Ye.min(),l=Cn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ur(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e){this.yt=e}}function xE(n,e){let t;if(e.document)t=dE(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Ve.fromSegments(e.noDocument.path),r=Bi(e.noDocument.readTime);t=hn.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const s=Ve.fromSegments(e.unknownDocument.path),r=Bi(e.unknownDocument.version);t=hn.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(r){const i=new be(r[0],r[1]);return Ye.fromTimestamp(i)}(e.readTime)),t}function bh(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:zc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:qc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Oo(i,o.version.toTimestamp()),createTime:Oo(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Ri(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Ri(e.version)}}return s}function zc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ri(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Bi(n){const e=new be(n.seconds,n.nanoseconds);return Ye.fromTimestamp(e)}function xi(n,e){const t=(e.baseMutations||[]).map(i=>ud(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>ud(n.yt,i)),r=be.fromMillis(e.localWriteTimeMs);return new nf(e.batchId,r,t,s)}function Ua(n){const e=Bi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Bi(n.lastLimboFreeSnapshotVersion):Ye.min();let s;return s=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return Fe(o===1,1966,{count:o}),Ds(kl(fN(i.documents[0])))}(n.query):function(i){return Ds(yN(i))}(n.query),new ur(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Cn.fromBase64String(n.resumeToken))}function _N(n,e){const t=Ri(e.snapshotVersion),s=Ri(e.lastLimboFreeSnapshotVersion);let r;r=Fc(e.target)?hN(n.yt,e.target):gN(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ji(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function DN(n){const e=yN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?od(e,e.limit,"L"):e}function pm(n,e){return new rf(e.largestBatchId,ud(n.yt,e.overlayMutation))}function Nh(n,e){const t=e.path.lastSegment();return[n,Jn(e.path.popLast()),t]}function xh(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ri(s.readTime),documentKey:Jn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{getBundleMetadata(e,t){return vh(e).get(t).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Bi(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,t){return vh(e).put(function(r){return{bundleId:r.id,createTime:Ri(is(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return _h(e).get(t).next(s=>{if(s)return function(i){return{name:i.name,query:DN(i.bundledQuery),readTime:Bi(i.readTime)}}(s)})}saveNamedQuery(e,t){return _h(e).put(function(r){return{name:r.name,readTime:Ri(is(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function vh(n){return jn(n,pu)}function _h(n){return jn(n,hu)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new ku(e,s)}getOverlay(e,t){return la(e).get(Nh(this.userId,t)).next(s=>s?pm(this.serializer,s):null)}getOverlays(e,t){const s=Qs();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const l=new rf(t,o);r.push(this.St(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add(Jn(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(la(e).Z(Jm,l))}),$.waitFor(i)}getOverlaysForCollection(e,t,s){const r=Qs(),i=Jn(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return la(e).J(Jm,o).next(l=>{for(const u of l){const m=pm(this.serializer,u);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=Qs();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return la(e).ee({index:kb,range:l},(u,m,d)=>{const f=pm(this.serializer,m);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return la(e).put(function(r,i,o){const[l,u,m]=Nh(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:m,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$c(r.yt,o.mutation)}}(this.serializer,this.userId,t))}}function la(n){return jn(n,gu)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{bt(e){return jn(e,Qd)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t==null?void 0:t.value;return s?Cn.fromUint8Array(s):Cn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ln(e.integerValue));else if("doubleValue"in e){const s=ln(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),ol(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=pr(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(hr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?Rb(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):bu(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Le(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){var o,l;const s=e.fields||{};this.Ft(t,53);const r=jo,i=((l=(o=s[r].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(ln(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ve.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}vi.Kt=new vi;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=255;function DE(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Dh(n){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=DE(255&s[i]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class kE{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=Dh(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=Dh(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Zi),this.sn(255)}_n(){this.an(Zi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Zi?(this.sn(Zi),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Zi?(this.an(Zi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class AE{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class EE{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ca{constructor(){this.cn=new kE,this.ln=new AE(this.cn),this.hn=new EE(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new _i(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:kc(this.En),directionalValue:kc(this.dn),orderedDocumentKey:kc(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Er(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=kh(n.En,e.En),t!==0?t:(t=kh(n.dn,e.dn),t!==0?t:Ve.comparator(n.In,e.In)))}function kh(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function kc(n){return zy()?function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s}(n):n}function Ah(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(n)}class Eh{constructor(e){this.mn=new Wt((t,s)=>fn.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Fe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Qm(e);if(t!==void 0&&!this.wn(t))return!1;const s=yi(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=s[i];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Wt(fn.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new gc(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new gc(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new gc(s.field,s.dir==="asc"?0:1)));return new Rc(Rc.UNKNOWN_ID,this.collectionId,t,il.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(n){var t,s;if(Fe(n instanceof At||n instanceof zt,20012),n instanceof At){if(n instanceof zb){const r=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map(i=>At.create(n.field,"==",i)))||[];return zt.create(r,"or")}return n}const e=n.filters.map(r=>kN(r));return zt.create(e,n.op)}function VE(n){if(n.getFilters().length===0)return[];const e=fd(kN(n));return Fe(AN(e),7391),md(e)||dd(e)?[e]:e.getFilters()}function md(n){return n instanceof At}function dd(n){return n instanceof zt&&ef(n)}function AN(n){return md(n)||dd(n)||function(t){if(t instanceof zt&&nd(t)){for(const s of t.getFilters())if(!md(s)&&!dd(s))return!1;return!0}return!1}(n)}function fd(n){if(Fe(n instanceof At||n instanceof zt,34018),n instanceof At)return n;if(n.filters.length===1)return fd(n.filters[0]);const e=n.filters.map(s=>fd(s));let t=zt.create(e,n.op);return t=Wc(t),AN(t)?t:(Fe(t instanceof zt,64498),Fe(Uo(t),40251),Fe(t.filters.length>1,57927),t.filters.reduce((s,r)=>lf(s,r)))}function lf(n,e){let t;return Fe(n instanceof At||n instanceof zt,38388),Fe(e instanceof At||e instanceof zt,25473),t=n instanceof At?e instanceof At?function(r,i){return zt.create([r,i],"and")}(n,e):Vh(n,e):e instanceof At?Vh(e,n):function(r,i){if(Fe(r.filters.length>0&&i.filters.length>0,48005),Uo(r)&&Uo(i))return Ob(r,i.getFilters());const o=nd(r)?r:i,l=nd(r)?i:r,u=o.filters.map(m=>lf(m,l));return zt.create(u,"or")}(n,e),Wc(t)}function Vh(n,e){if(Uo(e))return Ob(e,n.getFilters());{const t=e.filters.map(s=>lf(n,s));return zt.create(t,"or")}}function Wc(n){if(Fe(n instanceof At||n instanceof zt,11850),n instanceof At)return n;const e=n.getFilters();if(e.length===1)return Wc(e[0]);if(Mb(n))return n;const t=e.map(r=>Wc(r)),s=[];return t.forEach(r=>{r instanceof At?s.push(r):r instanceof zt&&(r.op===n.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:zt.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.Cn=new cf}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(hs.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(hs.min())}updateCollectionGroup(e,t,s){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class cf{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Wt(Ut.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Wt(Ut.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="IndexedDbIndexManager",Wl=new Uint8Array(0);class CE{constructor(e,t){this.databaseId=t,this.vn=new cf,this.Fn=new gr(s=>ji(s),(s,r)=>Dl(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:s,parent:Jn(r)};return Ch(e).put(i)}return $.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[db(t),""],!1,!0);return Ch(e).J(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(Gs(o.parent))}return s})}addFieldIndex(e,t){const s=ua(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=to(e);return i.next(l=>{o.put(xh(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=ua(e),r=to(e),i=eo(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ua(e),s=eo(e),r=to(e);return t.Z().next(()=>s.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return $.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new Eh(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const s=eo(e);let r=!0;const i=new Map;return $.forEach(this.Mn(t),o=>this.xn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=xt();const l=[];return $.forEach(i,(u,m)=>{he(wh,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(re=>`${re.fieldPath}:${re.kind}`).join(",")}`}(u)} to execute ${ji(t)}`);const d=function(F,re){const ee=Qm(re);if(ee===void 0)return null;for(const M of Oc(F,ee.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(m,u),f=function(F,re){const ee=new Map;for(const M of yi(re))for(const E of Oc(F,M.fieldPath))switch(E.op){case"==":case"in":ee.set(M.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return ee.set(M.fieldPath.canonicalString(),E.value),Array.from(ee.values())}return null}(m,u),p=function(F,re){const ee=[];let M=!0;for(const E of yi(re)){const N=E.kind===0?oh(F,E.fieldPath,F.startAt):ah(F,E.fieldPath,F.startAt);ee.push(N.value),M&&(M=N.inclusive)}return new Bo(ee,M)}(m,u),y=function(F,re){const ee=[];let M=!0;for(const E of yi(re)){const N=E.kind===0?ah(F,E.fieldPath,F.endAt):oh(F,E.fieldPath,F.endAt);ee.push(N.value),M&&(M=N.inclusive)}return new Bo(ee,M)}(m,u),C=this.On(u,m,p),v=this.On(u,m,y),w=this.Nn(u,m,f),B=this.Bn(u.indexId,d,C,p.inclusive,v,y.inclusive,w);return $.forEach(B,T=>s.Y(T,t.limit).next(F=>{F.forEach(re=>{const ee=Ve.fromSegments(re.documentKey);o.has(ee)||(o=o.add(ee),l.push(ee))})}))}).next(()=>l)}return $.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=VE(zt.create(e.filters,"and")).map(s=>rd(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const u=(t!=null?t.length:1)*Math.max(s.length,i.length),m=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const p=t?this.Ln(t[f/m]):Wl,y=this.kn(e,p,s[f%m],r),C=this.qn(e,p,i[f%m],o),v=l.map(w=>this.kn(e,p,w,!0));d.push(...this.createRange(y,C,v))}return d}kn(e,t,s,r){const i=new _i(e,Ve.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new _i(e,Ve.empty(),t,s);return r?i.An():i}xn(e,t){const s=new Eh(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let s=2;const r=this.Mn(t);return $.forEach(r,i=>this.xn(e,i).next(o=>{o?s!==0&&o.fields.length<function(u){let m=new Wt(fn.comparator),d=!1;for(const f of u.filters)for(const p of f.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:m=m.add(p.field));for(const f of u.orderBy)f.field.isKeyField()||(m=m.add(f.field));return m.size+(d?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&s===2?1:s)}Qn(e,t){const s=new ca;for(const r of yi(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);vi.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new ca;return vi.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new ca;return vi.Kt.Dt(dl(this.databaseId,t),s.Pn(function(i){const o=yi(i);return o.length===0?0:o[o.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new ca);let i=0;for(const o of yi(e)){const l=s[i++];for(const u of r)if(this.Un(t,o.fieldPath)&&fl(l))r=this.Kn(r,o,l);else{const m=u.Pn(o.kind);vi.Kt.Dt(l,m)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const u=new ca;u.seed(l.un()),vi.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(s=>s instanceof At&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=ua(e),r=to(e);return(t?s.J(Xm,IDBKeyRange.bound(t,t)):s.J()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(u=>{o.push(function(d,f){const p=f?new il(f.sequenceNumber,new hs(Bi(f.readTime),new Ve(Gs(f.documentKey)),f.largestBatchId)):il.empty(),y=d.fields.map(([C,v])=>new gc(fn.fromServerFormat(C),v));return new Rc(d.indexId,d.collectionGroup,y,p)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:at(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=ua(e),i=to(e);return this.Gn(e).next(o=>r.J(Xm,IDBKeyRange.bound(t,t)).next(l=>$.forEach(l,u=>i.put(xh(u.indexId,this.uid,o,s)))))}updateIndexEntries(e,t){const s=new Map;return $.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,u=>this.zn(e,r,u).next(m=>{const d=this.jn(i,u);return m.isEqual(d)?$.resolve():this.Jn(e,i,u,m,d)}))))})}Hn(e,t,s,r){return eo(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return eo(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=eo(e);let i=new Wt(Er);return r.ee({index:Db,range:IDBKeyRange.only([s.indexId,this.uid,kc(this.$n(s,t))])},(o,l)=>{i=i.add(new _i(s.indexId,t,Ah(l.arrayValue),Ah(l.directionalValue)))}).next(()=>i)}jn(e,t){let s=new Wt(Er);const r=this.Qn(t,e);if(r==null)return s;const i=Qm(t);if(i!=null){const o=e.data.field(i.fieldPath);if(fl(o))for(const l of o.arrayValue.values||[])s=s.add(new _i(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new _i(t.indexId,e.key,Wl,r));return s}Jn(e,t,s,r,i){he(wh,"Updating index entries for document '%s'",t.key);const o=[];return function(u,m,d,f,p){const y=u.getIterator(),C=m.getIterator();let v=Ji(y),w=Ji(C);for(;v||w;){let B=!1,T=!1;if(v&&w){const F=d(v,w);F<0?T=!0:F>0&&(B=!0)}else v!=null?T=!0:B=!0;B?(f(w),w=Ji(C)):T?(p(v),v=Ji(y)):(v=Ji(y),w=Ji(C))}}(r,i,Er,l=>{o.push(this.Hn(e,t,s,l))},l=>{o.push(this.Yn(e,t,s,l))}),$.waitFor(o)}Gn(e){let t=1;return to(e).ee({index:_b,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,l)=>Er(o,l)).filter((o,l,u)=>!l||Er(o,u[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=Er(o,e),u=Er(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Wl,Ve.empty()),u=r[o+1].Vn(this.uid,Wl,Ve.empty());i.push(IDBKeyRange.bound(l,u))}return i}Zn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ih)}getMinOffset(e,t){return $.mapArray(this.Mn(t),s=>this.xn(e,s).next(r=>r||Le(44426))).next(Ih)}}function Ch(n){return jn(n,cl)}function eo(n){return jn(n,Ka)}function ua(n){return jn(n,Gd)}function to(n){return jn(n,Wa)}function Ih(n){Fe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;zd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new hs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},EN=41943040;class Qn{static withCacheSize(e){return new Qn(e,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(n,e,t){const s=n.store(Is),r=n.store(So),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=s.ee({range:o},(d,f,p)=>(l++,p.delete()));i.push(u.next(()=>{Fe(l===1,47070,{batchId:t.batchId})}));const m=[];for(const d of t.mutations){const f=Nb(e,d.key.path,t.batchId);i.push(r.delete(f)),m.push(d.key)}return $.waitFor(i).next(()=>m)}function Kc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Le(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qn.DEFAULT_COLLECTION_PERCENTILE=10,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qn.DEFAULT=new Qn(EN,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qn.DISABLED=new Qn(-1,0,0);class Au{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){Fe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Au(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vr(e).ee({index:Di,range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=_o(e),o=Vr(e);return o.add({}).next(l=>{Fe(typeof l=="number",49019);const u=new nf(l,t,s,r),m=function(y,C,v){const w=v.baseMutations.map(T=>$c(y.yt,T)),B=v.mutations.map(T=>$c(y.yt,T));return{userId:C,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:B}}(this.serializer,this.userId,u),d=[];let f=new Wt((p,y)=>at(p.canonicalString(),y.canonicalString()));for(const p of r){const y=Nb(this.userId,p.key.path,l);f=f.add(p.key.path.popLast()),d.push(o.put(m)),d.push(i.put(y,rA))}return f.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Xn[l]=u.keys()}),$.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Vr(e).get(t).next(s=>s?(Fe(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),xi(this.serializer,s)):null)}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Vr(e).ee({index:Di,range:r},(o,l,u)=>{l.userId===this.userId&&(Fe(l.batchId>=s,47524,{tr:s}),i=xi(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Ai;return Vr(e).ee({index:Di,range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ai],[this.userId,Number.POSITIVE_INFINITY]);return Vr(e).J(Di,t).next(s=>s.map(r=>xi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=yc(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return _o(e).ee({range:r},(o,l,u)=>{const[m,d,f]=o,p=Gs(d);if(m===this.userId&&t.path.isEqual(p))return Vr(e).get(f).next(y=>{if(!y)throw Le(61480,{nr:o,batchId:f});Fe(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),i.push(xi(this.serializer,y))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Wt(at);const r=[];return t.forEach(i=>{const o=yc(this.userId,i.path),l=IDBKeyRange.lowerBound(o),u=_o(e).ee({range:l},(m,d,f)=>{const[p,y,C]=m,v=Gs(y);p===this.userId&&i.path.isEqual(v)?s=s.add(C):f.done()});r.push(u)}),$.waitFor(r).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=yc(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new Wt(at);return _o(e).ee({range:o},(u,m,d)=>{const[f,p,y]=u,C=Gs(p);f===this.userId&&s.isPrefixOf(C)?C.length===r&&(l=l.add(y)):d.done()}).next(()=>this.rr(e,l))}rr(e,t){const s=[],r=[];return t.forEach(i=>{r.push(Vr(e).get(i).next(o=>{if(o===null)throw Le(35274,{batchId:i});Fe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(xi(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return VN(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return _o(e).ee({range:s},(i,o,l)=>{if(i[0]===this.userId){const u=Gs(i[1]);r.push(u)}else l.done()}).next(()=>{Fe(r.length===0,56720,{sr:r.map(i=>i.canonicalString())})})})}containsKey(e,t){return wN(e,this.userId,t)}_r(e){return CN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ai,lastStreamToken:""})}}function wN(n,e,t){const s=yc(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return _o(n).ee({range:i,X:!0},(l,u,m)=>{const[d,f,p]=l;d===e&&f===r&&(o=!0),m.done()}).next(()=>o)}function Vr(n){return jn(n,Is)}function _o(n){return jn(n,So)}function CN(n){return jn(n,al)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ui(0)}static cr(){return new Ui(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new Ui(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>Ye.fromTimestamp(new be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>no(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(Fe(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return no(e).ee((o,l)=>{const u=Ua(l);u.sequenceNumber<=t&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,t){return no(e).ee((s,r)=>{const i=Ua(r);t(i)})}lr(e){return Th(e).get(Hc).next(t=>(Fe(t!==null,2888),t))}hr(e,t){return Th(e).put(Hc,t)}Pr(e,t){return no(e).put(_N(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=ji(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return no(e).ee({range:r,index:vb},(o,l,u)=>{const m=Ua(l);Dl(t,m.target)&&(i=m,u.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=Br(e);return t.forEach(o=>{const l=Jn(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,t,s){const r=Br(e);return $.forEach(t,i=>{const o=Jn(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=Br(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Br(e);let i=xt();return r.ee({range:s,X:!0},(o,l,u)=>{const m=Gs(o[1]),d=new Ve(m);i=i.add(d)}).next(()=>i)}containsKey(e,t){const s=Jn(t.path),r=IDBKeyRange.bound([s],[db(s)],!1,!0);let i=0;return Br(e).ee({index:Kd,X:!0,range:r},([o,l],u,m)=>{o!==0&&(i++,m.done())}).next(()=>i>0)}At(e,t){return no(e).get(t).next(s=>s?Ua(s):null)}}function no(n){return jn(n,To)}function Th(n){return jn(n,Ei)}function Br(n){return jn(n,Po)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="LruGarbageCollector",SE=1048576;function Lh([n,e],[t,s]){const r=at(n,t);return r===0?at(e,s):r}class TE{constructor(e){this.Ir=e,this.buffer=new Wt(Lh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Lh(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class IN{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){he(Ph,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ei(t)?he(Ph,"Ignoring IndexedDB error during garbage collection: ",t):await Fi(t)}await this.Vr(3e5)})}}class PE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return $.resolve(_s.ce);const s=new TE(t);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(Sh)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sh):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(m=Date.now(),bo()<=St.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function SN(n,e){return new PE(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,t){this.db=e,this.garbageCollector=SN(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,r)=>t(r))}addReference(e,t,s){return Kl(e,s)}removeReference(e,t,s){return Kl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Kl(e,t)}br(e,t){return function(r,i){let o=!1;return CN(r).te(l=>wN(r,l,i).next(u=>(u&&(o=!0),$.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.br(e,o).next(m=>{if(!m)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,Ye.min()),Br(e).delete(function(f){return[0,Jn(f.path)]}(o))))});r.push(u)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Kl(e,t)}Sr(e,t){const s=Br(e);let r,i=_s.ce;return s.ee({index:Kd},([o,l],{path:u,sequenceNumber:m})=>{o===0?(i!==_s.ce&&t(new Ve(Gs(r)),i),i=m,r=u):i=_s.ce}).next(()=>{i!==_s.ce&&t(new Ve(Gs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kl(n,e){return Br(n).put(function(s,r){return{targetId:0,path:Jn(s.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.changes=new gr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?$.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return fi(e).put(s)}removeEntry(e,t,s){return fi(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],zc(o),l[l.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=hn.newInvalidDocument(t);return fi(e).ee({index:bc,range:IDBKeyRange.only(ma(t))},(r,i)=>{s=this.Cr(t,i)}).next(()=>s)}vr(e,t){let s={size:0,document:hn.newInvalidDocument(t)};return fi(e).ee({index:bc,range:IDBKeyRange.only(ma(t))},(r,i)=>{s={document:this.Cr(t,i),size:Kc(i)}}).next(()=>s)}getEntries(e,t){let s=ps();return this.Fr(e,t,(r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)}).next(()=>s)}Mr(e,t){let s=ps(),r=new cn(Ve.comparator);return this.Fr(e,t,(i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,Kc(o))}).next(()=>({documents:s,Or:r}))}Fr(e,t,s){if(t.isEmpty())return $.resolve();let r=new Wt(Bh);t.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound(ma(r.first()),ma(r.last())),o=r.getIterator();let l=o.getNext();return fi(e).ee({index:bc,range:i},(u,m,d)=>{const f=Ve.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;l&&Bh(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,m),l=o.hasNext()?o.getNext():null),l?d.j(ma(l)):d.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),zc(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fi(e).J(IDBKeyRange.bound(l,u,!0)).next(m=>{i==null||i.incrementDocumentReadCount(m.length);let d=ps();for(const f of m){const p=this.Cr(Ve.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);p.isFoundDocument()&&(Al(t,p)||r.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,s,r){let i=ps();const o=Rh(t,s),l=Rh(t,hs.max());return fi(e).ee({index:xb,range:IDBKeyRange.bound(o,l,!0)},(u,m,d)=>{const f=this.Cr(Ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);i=i.insert(f.key,f),i.size===r&&d.done()}).next(()=>i)}newChangeBuffer(e){return new RE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return jh(e).get(Ym).next(t=>(Fe(!!t,20021),t))}Dr(e,t){return jh(e).put(Ym,t)}Cr(e,t){if(t){const s=xE(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Ye.min())))return s}return hn.newInvalidDocument(e)}}function PN(n){return new jE(n)}class RE extends TN{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new gr(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new Wt((i,o)=>at(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const u=bh(this.Nr.serializer,o);r=r.add(i.path.popLast());const m=Kc(u);s+=m-l.size,t.push(this.Nr.addEntry(e,i,u))}else if(s-=l.size,this.trackRemovals){const u=bh(this.Nr.serializer,o.convertToNoDocument(Ye.min()));t.push(this.Nr.addEntry(e,i,u))}}),r.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,s)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:r})=>(r.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function jh(n){return jn(n,ll)}function fi(n){return jn(n,Uc)}function ma(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Rh(n,e){const t=e.documentKey.path.toArray();return[n,zc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Bh(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=at(t[i],s[i]),r)return r;return r=at(t.length,s.length),r||(r=at(t[t.length-2],s[s.length-2]),r||at(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&Xa(s.mutation,r,us.empty(),be.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,xt()).next(()=>s))}getLocalViewOfDocuments(e,t,s=xt()){const r=Qs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=Ra();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Qs();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,xt()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,s,r){let i=ps();const o=Ya(),l=function(){return Ya()}();return t.forEach((u,m)=>{const d=s.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof yr)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Xa(d.mutation,m,d.mutation.getFieldMask(),be.now())):o.set(m.key,us.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new BE(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const s=Ya();let r=new cn((o,l)=>o-l),i=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=s.get(u)||us.empty();d=l.applyToLocalView(m,d),s.set(u,d);const f=(r.get(l.batchId)||xt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Xb();d.forEach(p=>{if(!i.has(p)){const y=rN(t.get(p),s.get(p));y!==null&&f.set(p,y),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return Ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Wb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):$.resolve(Qs());let l=rl,u=i;return o.next(m=>$.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{u=u.insert(d,p)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,xt())).next(d=>({batchId:l,changes:Yb(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next(s=>{let r=Ra();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=Ra();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const m=function(f,p){return new Ko(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,s,r).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,hn.newInvalidDocument(d)))});let l=Ra();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Xa(d.mutation,m,us.empty(),be.now()),Al(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:is(r.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:DN(r.bundledQuery),readTime:is(r.readTime)}}(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(){this.overlays=new cn(Ve.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Qs();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),$.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(e,t,s){const r=Qs(),i=t.length+1,o=new Ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return $.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new cn((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let d=i.get(m.largestBatchId);d===null&&(d=Qs(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Qs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return $.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new rf(t,s));let i=this.qr.get(t);i===void 0&&(i=xt(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(){this.Qr=new Wt(Hn.$r),this.Ur=new Wt(Hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Hn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new Hn(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new Ve(new Ut([])),s=new Hn(t,e),r=new Hn(t,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ve(new Ut([])),s=new Hn(t,e),r=new Hn(t,e+1);let i=xt();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Hn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Hn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ve.comparator(e.key,t.key)||at(e.Yr,t.Yr)}static Kr(e,t){return at(e.Yr,t.Yr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Wt(Hn.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new nf(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Hn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Ai:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Hn(t,0),r=new Hn(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Wt(at);return t.forEach(r=>{const i=new Hn(r,0),o=new Hn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{s=s.add(l.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;Ve.isDocumentKey(i)||(i=i.child(""));const o=new Hn(new Ve(i),0);let l=new Wt(at);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!s.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Fe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(t.mutations,r=>{const i=new Hn(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new Hn(t,0),r=this.Zr.firstAfterOrEqual(s);return $.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.ri=e,this.docs=function(){return new cn(Ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return $.resolve(s?s.document.mutableCopy():hn.newInvalidDocument(t))}getEntries(e,t){let s=ps();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():hn.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=ps();const o=t.path,l=new Ve(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||zd(hb(d),s)<=0||(r.has(d.key)||Al(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Le(9500)}ii(e,t){return $.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new qE(this)}getSize(e){return $.resolve(this.size)}}class qE extends TN{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e){this.persistence=e,this.si=new gr(t=>ji(t),Dl),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.oi=0,this._i=new uf,this.targetCount=0,this.ai=Ui.ur()}forEachTarget(e,t){return this.si.forEach((s,r)=>t(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ui(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return $.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),$.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return $.resolve(s)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t){this.ui={},this.overlays={},this.ci=new _s(0),this.li=!1,this.li=!0,this.hi=new ME,this.referenceDelegate=e(this),this.Pi=new $E(this),this.indexManager=new wE,this.remoteDocumentCache=function(r){return new OE(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new vN(t),this.Ii=new UE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new HE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new FE(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){he("MemoryPersistence","Starting transaction:",e);const r=new zE(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class zE extends yb{constructor(e){super(),this.currentSequenceNumber=e}}class Eu{constructor(e){this.persistence=e,this.Ri=new uf,this.Vi=null}static mi(e){return new Eu(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),$.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const r=Ve.fromPath(s);return this.gi(e,r).next(i=>{i||t.removeEntry(r,Ye.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Gc{constructor(e,t){this.persistence=e,this.pi=new gr(s=>Jn(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=SN(this,t)}static mi(e,t){return new Gc(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return $.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?$.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(s++,i.removeEntry(o,Ye.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xc(e.data.value)),t}br(e,t,s){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return $.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e){this.serializer=e}k(e,t,s,r){const i=new du("createOrUpgrade",t);s<1&&r>=1&&(function(u){u.createObjectStore(_l)}(e),function(u){u.createObjectStore(al,{keyPath:sA}),u.createObjectStore(Is,{keyPath:Gp,autoIncrement:!0}).createIndex(Di,Qp,{unique:!0}),u.createObjectStore(So)}(e),Uh(e),function(u){u.createObjectStore(bi)}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(u){u.deleteObjectStore(Po),u.deleteObjectStore(To),u.deleteObjectStore(Ei)}(e),Uh(e)),o=o.next(()=>function(u){const m=u.store(Ei),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ye.min().toTimestamp(),targetCount:0};return m.put(Hc,d)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(u,m){return m.store(Is).J().next(f=>{u.deleteObjectStore(Is),u.createObjectStore(Is,{keyPath:Gp,autoIncrement:!0}).createIndex(Di,Qp,{unique:!0});const p=m.store(Is),y=f.map(C=>p.put(C));return $.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(Lo,{keyPath:dA})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.yi(i))),s<6&&r>=6&&(o=o.next(()=>(function(u){u.createObjectStore(ll)}(e),this.wi(i)))),s<7&&r>=7&&(o=o.next(()=>this.Si(i))),s<8&&r>=8&&(o=o.next(()=>this.bi(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Di(i))),s<11&&r>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(pu,{keyPath:fA})})(e),function(u){u.createObjectStore(hu,{keyPath:pA})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(u){const m=u.createObjectStore(gu,{keyPath:vA});m.createIndex(Jm,_A,{unique:!1}),m.createIndex(kb,DA,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(u){const m=u.createObjectStore(Uc,{keyPath:iA});m.createIndex(bc,oA),m.createIndex(xb,aA)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(bi))),s<14&&r>=14&&(o=o.next(()=>this.Fi(e,i))),s<15&&r>=15&&(o=o.next(()=>function(u){u.createObjectStore(Gd,{keyPath:hA,autoIncrement:!0}).createIndex(Xm,gA,{unique:!1}),u.createObjectStore(Wa,{keyPath:yA}).createIndex(_b,bA,{unique:!1}),u.createObjectStore(Ka,{keyPath:NA}).createIndex(Db,xA,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{t.objectStore(Wa).clear()}).next(()=>{t.objectStore(Ka).clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(Qd,{keyPath:kA})})(e)})),s<18&&r>=18&&zy()&&(o=o.next(()=>{t.objectStore(Wa).clear()}).next(()=>{t.objectStore(Ka).clear()})),o}wi(e){let t=0;return e.store(bi).ee((s,r)=>{t+=Kc(r)}).next(()=>{const s={byteSize:t};return e.store(ll).put(Ym,s)})}yi(e){const t=e.store(al),s=e.store(Is);return t.J().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,Ai],[i.userId,i.lastAcknowledgedBatchId]);return s.J(Di,o).next(l=>$.forEach(l,u=>{Fe(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const m=xi(this.serializer,u);return VN(e,i.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(Po),s=e.store(bi);return e.store(Ei).get(Hc).next(r=>{const i=[];return s.ee((o,l)=>{const u=new Ut(o),m=function(f){return[0,Jn(f)]}(u);i.push(t.get(m).next(d=>d?$.resolve():(f=>t.put({targetId:0,path:Jn(f),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>$.waitFor(i))})}bi(e,t){e.createObjectStore(cl,{keyPath:mA});const s=t.store(cl),r=new cf,i=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return s.put({collectionId:l,parent:Jn(u)})}};return t.store(bi).ee({X:!0},(o,l)=>{const u=new Ut(o);return i(u.popLast())}).next(()=>t.store(So).ee({X:!0},([o,l,u],m)=>{const d=Gs(l);return i(d.popLast())}))}Di(e){const t=e.store(To);return t.ee((s,r)=>{const i=Ua(r),o=_N(this.serializer,i);return t.put(o)})}Ci(e,t){const s=t.store(bi),r=[];return s.ee((i,o)=>{const l=t.store(Uc),u=function(f){return f.document?new Ve(Ut.fromString(f.document.name).popFirst(5)):f.noDocument?Ve.fromSegments(f.noDocument.path):f.unknownDocument?Ve.fromSegments(f.unknownDocument.path):Le(36783)}(o).path.toArray(),m={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(m))}).next(()=>$.waitFor(r))}Fi(e,t){const s=t.store(Is),r=PN(this.serializer),i=new mf(Eu.mi,this.serializer.yt);return s.J().next(o=>{const l=new Map;return o.forEach(u=>{let m=l.get(u.userId)??xt();xi(this.serializer,u).keys().forEach(d=>m=m.add(d)),l.set(u.userId,m)}),$.forEach(l,(u,m)=>{const d=new qn(m),f=ku.wt(this.serializer,d),p=i.getIndexManager(d),y=Au.wt(d,this.serializer,p,i.referenceDelegate);return new LN(r,y,f,p).recalculateAndSaveOverlaysForDocumentKeys(new Zm(t,_s.ce),u).next()})})}}function Uh(n){n.createObjectStore(Po,{keyPath:cA}).createIndex(Kd,uA,{unique:!0}),n.createObjectStore(To,{keyPath:"targetId"}).createIndex(vb,lA,{unique:!0}),n.createObjectStore(Ei)}const wr="IndexedDbPersistence",hm=18e5,gm=5e3,ym="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",KE="main";class df{constructor(e,t,s,r,i,o,l,u,m,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=m,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=p=>Promise.resolve(),!df.v())throw new _e(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new LE(this,r),this.$i=t+KE,this.serializer=new vN(u),this.Ui=new zr(this.$i,this.Ni,new WE(this.serializer)),this.hi=new _E,this.Pi=new IE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=PN(this.serializer),this.Ii=new vE,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ss(wr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _e(se.FAILED_PRECONDITION,ym);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new _s(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Gl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(ei(e))return he(wr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he(wr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return da(e).get(Xi).next(t=>$.resolve(this.es(t)))}ts(e){return Gl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,hm)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=jn(t,Lo);return s.J().next(r=>{const i=this.ss(r,hm),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):da(e).get(Xi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,gm)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new _e(se.FAILED_PRECONDITION,ym);return!1}}return!(!this.networkEnabled||!this.inForeground)||Gl(e).J().next(s=>this.ss(s,gm).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&he(wr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[_l,Lo],e=>{const t=new Zm(e,_s.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Gl(e).J().next(t=>this.ss(t,hm).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Au.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new CE(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ku.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){he(wr,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?VA:u===17?wb:u===16?EA:u===15?Yd:u===14?Vb:u===13?Eb:u===12?AA:u===11?Ab:void Le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,r,i,l=>(o=new Zm(l,this.ci?this.ci.next():_s.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw ss(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new _e(se.FAILED_PRECONDITION,gb);return s(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Is(e){return da(e).get(Xi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,gm)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new _e(se.FAILED_PRECONDITION,ym)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return da(e).put(Xi,t)}static v(){return zr.v()}Zi(e){const t=da(e);return t.get(Xi).next(s=>this.es(s)?(he(wr,"Releasing primary lease."),t.delete(Xi)):$.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(ss(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;$y()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return he(wr,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ss(wr,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ss("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function da(n){return jn(n,_l)}function Gl(n){return jn(n,Lo)}function GE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=xt(),r=xt();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ff(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return $y()?8:bb(Pc())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new QE;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(bo()<=St.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",No(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(bo()<=St.DEBUG&&he("QueryEngine","Query:",No(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(bo()<=St.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",No(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ds(t))):$.resolve())}ys(e,t){if(lh(t))return $.resolve(null);let s=Ds(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=od(t,null,"F"),s=Ds(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=xt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,od(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,s,r){return lh(t)||r.isEqual(Ye.min())?$.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?$.resolve(null):(bo()<=St.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),No(t)),this.vs(e,o,t,Yk(r,rl)).next(l=>l))})}Ds(e,t){let s=new Wt(Gb(e));return t.forEach((r,i)=>{Al(e,i)&&(s=s.add(i))}),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return bo()<=St.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",No(t)),this.ps.getDocumentsMatchingQuery(e,t,hs.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="LocalStore",YE=3e8;class XE{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new cn(at),this.xs=new gr(i=>ji(i),Dl),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function RN(n,e,t,s){return new XE(n,e,t,s)}async function BN(n,e){const t=lt(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let u=xt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(s,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function JE(n,e){const t=lt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,p=f.keys();let y=$.resolve();return p.forEach(C=>{y=y.next(()=>d.getEntry(u,C)).next(v=>{const w=m.docVersions.get(C);Fe(w!==null,48541),v.version.compareTo(w)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=xt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function UN(n){const e=lt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function ZE(n,e){const t=lt(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const p=r.get(f);if(!p)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Cn.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(v,w,B){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=YE?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(p,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=ps(),m=xt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(eV(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!s.isEqual(Ye.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(d)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function eV(n,e,t){let s=xt(),r=xt();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=ps();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(Ye.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):he(pf,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function tV(n,e){const t=lt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Ai),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function nV(n,e){const t=lt(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Pi.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):t.Pi.allocateTargetId(s).next(o=>(r=new ur(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function pd(n,e,t){const s=lt(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!ei(o))throw o;he(pf,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Hh(n,e,t){const s=lt(n);let r=Ye.min(),i=xt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=lt(u),p=f.xs.get(d);return p!==void 0?$.resolve(f.Ms.get(p)):f.Pi.getTargetData(m,d)}(s,o,Ds(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:Ye.min(),t?i:xt())).next(l=>(sV(s,OA(e),l),{documents:l,Qs:i})))}function sV(n,e,t){let s=n.Os.get(e)||Ye.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Os.set(e,s)}class Mh{constructor(){this.activeTargetIds=GA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HN{constructor(){this.Mo=new Mh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Mh,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="ConnectivityMonitor";class Oh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){he(Fh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){he(Fh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ql=null;function hd(){return Ql===null?Ql=function(){return 268435456+Math.round(2147483648*Math.random())}():Ql++,"0x"+Ql.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm="RestConnection",iV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Mc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=hd(),l=this.zo(e,t.toUriEncodedString());he(bm,`Sending RPC '${e}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=uu(m);return this.Jo(e,l,u,s,d).then(f=>(he(bm,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Pi(bm,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const s=iV[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="WebChannelConnection";class lV extends oV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=hd();return new Promise((l,u)=>{const m=new ib;m.setWithCredentials(!0),m.listenOnce(ob.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case hc.NO_ERROR:const f=m.getResponseJson();he(Kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case hc.TIMEOUT:he(Kn,`RPC '${e}' ${o} timed out`),u(new _e(se.DEADLINE_EXCEEDED,"Request time out"));break;case hc.HTTP_ERROR:const p=m.getStatus();if(he(Kn,`RPC '${e}' ${o} failed with status:`,p,"response text:",m.getResponseText()),p>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const v=function(B){const T=B.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(T)>=0?T:se.UNKNOWN}(C.status);u(new _e(v,C.message))}else u(new _e(se.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new _e(se.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{he(Kn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);he(Kn,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,s,15)})}T_(e,t,s){const r=hd(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=cb(),l=lb(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,s),u.encodeInitMessageHeaders=!0;const d=i.join("");he(Kn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let p=!1,y=!1;const C=new aV({Yo:w=>{y?he(Kn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(p||(he(Kn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),p=!0),he(Kn,`RPC '${e}' stream ${r} sending:`,w),f.send(w))},Zo:()=>f.close()}),v=(w,B,T)=>{w.listen(B,F=>{try{T(F)}catch(re){setTimeout(()=>{throw re},0)}})};return v(f,ja.EventType.OPEN,()=>{y||(he(Kn,`RPC '${e}' stream ${r} transport opened.`),C.o_())}),v(f,ja.EventType.CLOSE,()=>{y||(y=!0,he(Kn,`RPC '${e}' stream ${r} transport closed`),C.a_(),this.E_(f))}),v(f,ja.EventType.ERROR,w=>{y||(y=!0,Pi(Kn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),C.a_(new _e(se.UNAVAILABLE,"The operation could not be completed")))}),v(f,ja.EventType.MESSAGE,w=>{var B;if(!y){const T=w.data[0];Fe(!!T,16349);const F=T,re=(F==null?void 0:F.error)||((B=F[0])==null?void 0:B.error);if(re){he(Kn,`RPC '${e}' stream ${r} received error:`,re);const ee=re.status;let M=function(V){const j=_n[V];if(j!==void 0)return aN(j)}(ee),E=re.message;M===void 0&&(M=se.INTERNAL,E="Unknown error status: "+ee+" with message "+re.message),y=!0,C.a_(new _e(M,E)),f.close()}else he(Kn,`RPC '${e}' stream ${r} received:`,T),C.u_(T)}}),v(l,ab.STAT_EVENT,w=>{w.stat===Km.PROXY?he(Kn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===Km.NOPROXY&&he(Kn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cV(){return typeof window<"u"?window:null}function Ac(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(n){return new uE(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&he("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh="PersistentStream";class FN{constructor(e,t,s,r,i,o,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new MN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(ss(t.toString()),ss("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===t&&this.G_(s,r)},s=>{e(()=>{const r=new _e(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return he(qh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(he(qh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uV extends FN{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=fE(this.serializer,e),s=function(i){if(!("targetChange"in i))return Ye.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ye.min():o.readTime?is(o.readTime):Ye.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=cd(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=Fc(u)?{documents:hN(i,u)}:{query:gN(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=uN(i,o.resumeToken);const m=ad(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(Ye.min())>0){l.readTime=Oo(i,o.snapshotVersion.toTimestamp());const m=ad(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const s=hE(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=cd(this.serializer),t.removeTarget=e,this.q_(t)}}class mV extends FN{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=pE(e.writeResults,e.commitTime),s=is(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=cd(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>$c(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{}class fV extends dV{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ld(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new _e(se.UNKNOWN,i.toString())})}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,ld(t,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _e(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class pV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ss(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi="RemoteStore";class hV{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{Oi(this)&&(he(Hi,"Restarting streams for network reachability change."),await async function(u){const m=lt(u);m.Ea.add(4),await Vl(m),m.Ra.set("Unknown"),m.Ea.delete(4),await wu(m)}(this))})}),this.Ra=new pV(s,r)}}async function wu(n){if(Oi(n))for(const e of n.da)await e(!0)}async function Vl(n){for(const e of n.da)await e(!1)}function ON(n,e){const t=lt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),bf(t)?yf(t):Qo(t).O_()&&gf(t,e))}function hf(n,e){const t=lt(n),s=Qo(t);t.Ia.delete(e),s.O_()&&qN(t,e),t.Ia.size===0&&(s.O_()?s.L_():Oi(t)&&t.Ra.set("Unknown"))}function gf(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ye.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Qo(n).Y_(e)}function qN(n,e){n.Va.Ue(e),Qo(n).Z_(e)}function yf(n){n.Va=new oE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Qo(n).start(),n.Ra.ua()}function bf(n){return Oi(n)&&!Qo(n).x_()&&n.Ia.size>0}function Oi(n){return lt(n).Ea.size===0}function $N(n){n.Va=void 0}async function gV(n){n.Ra.set("Online")}async function yV(n){n.Ia.forEach((e,t)=>{gf(n,e)})}async function bV(n,e){$N(n),bf(n)?(n.Ra.ha(e),yf(n)):n.Ra.set("Unknown")}async function NV(n,e,t){if(n.Ra.set("Online"),e instanceof cN&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(n,e)}catch(s){he(Hi,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Qc(n,s)}else if(e instanceof Dc?n.Va.Ze(e):e instanceof lN?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ye.min()))try{const s=await UN(n.localStore);t.compareTo(s)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Cn.EMPTY_BYTE_STRING,d.snapshotVersion)),qN(i,u);const f=new ur(d.target,u,m,d.sequenceNumber);gf(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(s){he(Hi,"Failed to raise snapshot:",s),await Qc(n,s)}}async function Qc(n,e,t){if(!ei(e))throw e;n.Ea.add(1),await Vl(n),n.Ra.set("Offline"),t||(t=()=>UN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{he(Hi,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await wu(n)})}function zN(n,e){return e().catch(t=>Qc(n,t,e))}async function wl(n){const e=lt(n),t=Qr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ai;for(;xV(e);)try{const r=await tV(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,vV(e,r)}catch(r){await Qc(e,r)}WN(e)&&KN(e)}function xV(n){return Oi(n)&&n.Ta.length<10}function vV(n,e){n.Ta.push(e);const t=Qr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function WN(n){return Oi(n)&&!Qr(n).x_()&&n.Ta.length>0}function KN(n){Qr(n).start()}async function _V(n){Qr(n).ra()}async function DV(n){const e=Qr(n);for(const t of n.Ta)e.ea(t.mutations)}async function kV(n,e,t){const s=n.Ta.shift(),r=sf.from(s,e,t);await zN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await wl(n)}async function AV(n,e){e&&Qr(n).X_&&await async function(s,r){if(function(o){return sE(o)&&o!==se.ABORTED}(r.code)){const i=s.Ta.shift();Qr(s).B_(),await zN(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await wl(s)}}(n,e),WN(n)&&KN(n)}async function $h(n,e){const t=lt(n);t.asyncQueue.verifyOperationInProgress(),he(Hi,"RemoteStore received new credentials");const s=Oi(t);t.Ea.add(3),await Vl(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await wu(t)}async function EV(n,e){const t=lt(n);e?(t.Ea.delete(2),await wu(t)):e||(t.Ea.add(2),await Vl(t),t.Ra.set("Unknown"))}function Qo(n){return n.ma||(n.ma=function(t,s,r){const i=lt(t);return i.sa(),new uV(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:gV.bind(null,n),t_:yV.bind(null,n),r_:bV.bind(null,n),H_:NV.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),bf(n)?yf(n):n.Ra.set("Unknown")):(await n.ma.stop(),$N(n))})),n.ma}function Qr(n){return n.fa||(n.fa=function(t,s,r){const i=lt(t);return i.sa(),new mV(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:_V.bind(null,n),r_:AV.bind(null,n),ta:DV.bind(null,n),na:kV.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await wl(n)):(await n.fa.stop(),n.Ta.length>0&&(he(Hi,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new Nf(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xf(n,e){if(ss("AsyncQueue",`${e}: ${n}`),ei(n))return new _e(se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{static emptySet(e){return new wo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ve.comparator(t.key,s.key):(t,s)=>Ve.comparator(t.key,s.key),this.keyedMap=Ra(),this.sortedSet=new cn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new wo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(){this.ga=new cn(Ve.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class qo{constructor(e,t,s,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new qo(e,t,wo.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wV{constructor(){this.queries=Wh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=lt(t),i=r.queries;r.queries=Wh(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new _e(se.ABORTED,"Firestore shutting down"))}}function Wh(){return new gr(n=>Kb(n),Nu)}async function vf(n,e){const t=lt(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new VV,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=xf(o,`Initialization of query '${No(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Df(t)}async function _f(n,e){const t=lt(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function CV(n,e){const t=lt(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&Df(t)}function IV(n,e,t){const s=lt(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function Df(n){n.Ca.forEach(e=>{e.next()})}var gd,Kh;(Kh=gd||(gd={})).Ma="default",Kh.Cache="cache";class kf{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new qo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e){this.key=e}}class QN{constructor(e){this.key=e}}class SV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xt(),this.mutatedKeys=xt(),this.eu=Gb(e),this.tu=new wo(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new zh,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const p=r.get(d),y=Al(this.query,f)?f:null,C=!!p&&this.mutatedKeys.has(p.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;p&&y?p.data.isEqual(y.data)?C!==v&&(s.track({type:3,doc:y}),w=!0):this.su(p,y)||(s.track({type:2,doc:y}),w=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!p&&y?(s.track({type:0,doc:y}),w=!0):p&&!y&&(s.track({type:1,doc:p}),w=!0,(u||m)&&(l=!0)),w&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,C){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:w})}};return v(y)-v(C)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new qo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new QN(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new GN(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=xt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return qo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Af="SyncEngine";class TV{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class PV{constructor(e){this.key=e,this.hu=!1}}class LV{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gr(l=>Kb(l),Nu),this.Iu=new Map,this.Eu=new Set,this.du=new cn(Ve.comparator),this.Au=new Map,this.Ru=new uf,this.Vu={},this.mu=new Map,this.fu=Ui.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jV(n,e,t=!0){const s=t0(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await YN(s,e,t,!0),r}async function RV(n,e){const t=t0(n);await YN(t,e,!0,!1)}async function YN(n,e,t,s){const r=await nV(n.localStore,Ds(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await BV(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&ON(n.remoteStore,r),l}async function BV(n,e,t,s,r){n.pu=(f,p,y)=>async function(v,w,B,T){let F=w.view.ru(B);F.Cs&&(F=await Hh(v.localStore,w.query,!1).then(({documents:E})=>w.view.ru(E,F)));const re=T&&T.targetChanges.get(w.targetId),ee=T&&T.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(F,v.isPrimaryClient,re,ee);return Qh(v,w.targetId,M.au),M.snapshot}(n,f,p,y);const i=await Hh(n.localStore,e,!0),o=new SV(e,i.Qs),l=o.ru(i.documents),u=El.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),m=o.applyChanges(l,n.isPrimaryClient,u);Qh(n,t,m.au);const d=new TV(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function UV(n,e,t){const s=lt(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!Nu(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await pd(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&hf(s.remoteStore,r.targetId),yd(s,r.targetId)}).catch(Fi)):(yd(s,r.targetId),await pd(s.localStore,r.targetId,!0))}async function HV(n,e){const t=lt(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),hf(t.remoteStore,s.targetId))}async function MV(n,e,t){const s=n0(n);try{const r=await function(o,l){const u=lt(o),m=be.now(),d=l.reduce((y,C)=>y.add(C.key),xt());let f,p;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=ps(),v=xt();return u.Ns.getEntries(y,d).next(w=>{C=w,C.forEach((B,T)=>{T.isValidDocument()||(v=v.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,C)).next(w=>{f=w;const B=[];for(const T of l){const F=tE(T,f.get(T.key).overlayedDocument);F!=null&&B.push(new yr(T.key,F,Ub(F.value.mapValue),Xn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,B,l)}).next(w=>{p=w;const B=w.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,w.batchId,B)})}).then(()=>({batchId:p.batchId,changes:Yb(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new cn(at)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(s,r.batchId,t),await Cl(s,r.changes),await wl(s.remoteStore)}catch(r){const i=xf(r,"Failed to persist write");t.reject(i)}}async function XN(n,e){const t=lt(n);try{const s=await ZE(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Fe(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Fe(o.hu,14607):r.removedDocuments.size>0&&(Fe(o.hu,42227),o.hu=!1))}),await Cl(t,s,e)}catch(s){await Fi(s)}}function Gh(n,e,t){const s=lt(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=lt(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const p of f.Sa)p.va(l)&&(m=!0)}),m&&Df(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function FV(n,e,t){const s=lt(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new cn(Ve.comparator);o=o.insert(i,hn.newNoDocument(i,Ye.min()));const l=xt().add(i),u=new Du(Ye.min(),new Map,new cn(at),o,l);await XN(s,u),s.du=s.du.remove(i),s.Au.delete(e),Ef(s)}else await pd(s.localStore,e,!1).then(()=>yd(s,e,t)).catch(Fi)}async function OV(n,e){const t=lt(n),s=e.batch.batchId;try{const r=await JE(t.localStore,e);ZN(t,s,null),JN(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Cl(t,r)}catch(r){await Fi(r)}}async function qV(n,e,t){const s=lt(n);try{const r=await function(o,l){const u=lt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Fe(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(s.localStore,e);ZN(s,e,t),JN(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Cl(s,r)}catch(r){await Fi(r)}}function JN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function ZN(n,e,t){const s=lt(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function yd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||e0(n,s)})}function e0(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(hf(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Ef(n))}function Qh(n,e,t){for(const s of t)s instanceof GN?(n.Ru.addReference(s.key,e),$V(n,s)):s instanceof QN?(he(Af,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||e0(n,s.key)):Le(19791,{wu:s})}function $V(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(he(Af,"New document in limbo: "+t),n.Eu.add(s),Ef(n))}function Ef(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ve(Ut.fromString(e)),s=n.fu.next();n.Au.set(s,new PV(t)),n.du=n.du.insert(t,s),ON(n.remoteStore,new ur(Ds(kl(t.path)),s,"TargetPurposeLimboResolution",_s.ce))}}async function Cl(n,e,t){const s=lt(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{o.push(s.pu(u,e,t).then(m=>{var d;if((m||t)&&s.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=ff.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(u,m){const d=lt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(m,p=>$.forEach(p.Es,y=>d.persistence.referenceDelegate.addReference(f,p.targetId,y)).next(()=>$.forEach(p.ds,y=>d.persistence.referenceDelegate.removeReference(f,p.targetId,y)))))}catch(f){if(!ei(f))throw f;he(pf,"Failed to update sequence numbers: "+f)}for(const f of m){const p=f.targetId;if(!f.fromCache){const y=d.Ms.get(p),C=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(C);d.Ms=d.Ms.insert(p,v)}}}(s.localStore,i))}async function zV(n,e){const t=lt(n);if(!t.currentUser.isEqual(e)){he(Af,"User change. New user:",e.toKey());const s=await BN(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new _e(se.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Cl(t,s.Ls)}}function WV(n,e){const t=lt(n),s=t.Au.get(e);if(s&&s.hu)return xt().add(s.key);{let r=xt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function t0(n){const e=lt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=XN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=WV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FV.bind(null,e),e.Pu.H_=CV.bind(null,e.eventManager),e.Pu.yu=IV.bind(null,e.eventManager),e}function n0(n){const e=lt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=OV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qV.bind(null,e),e}class gl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return RN(this.persistence,new jN,e.initialUser,this.serializer)}Cu(e){return new mf(Eu.mi,this.serializer)}Du(e){return new HN}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gl.provider={build:()=>new gl};class KV extends gl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fe(this.persistence.referenceDelegate instanceof Gc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new IN(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new mf(s=>Gc.mi(s,t),this.serializer)}}class GV extends gl{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await n0(this.xu.syncEngine),await wl(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return RN(this.persistence,new jN,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new IN(s,e.asyncQueue,t)}Mu(e,t){const s=new eA(t,this.persistence);return new Zk(e.asyncQueue,s)}Cu(e){const t=GE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new df(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,cV(),Ac(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new HN}}class Yc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Gh(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=zV.bind(null,this.syncEngine),await EV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wV}()}createDatastore(e){const t=Vu(e.databaseInfo.databaseId),s=function(i){return new lV(i)}(e.databaseInfo);return function(i,o,l,u){return new fV(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,l){return new hV(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>Gh(this.syncEngine,t,0),function(){return Oh.v()?new Oh:new rV}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new LV(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=lt(r);he(Hi,"RemoteStore shutting down."),i.Ea.add(5),await Vl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Yc.provider={build:()=>new Yc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ss("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="FirestoreClient";class QV{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=qn.UNAUTHENTICATED,this.clientId=$d.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{he(Yr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(he(Yr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=xf(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Nm(n,e){n.asyncQueue.verifyOperationInProgress(),he(Yr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await BN(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Yh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await YV(n);he(Yr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>$h(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>$h(e.remoteStore,r)),n._onlineComponents=e}async function YV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){he(Yr,"Using user provided OfflineComponentProvider");try{await Nm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Pi("Error using user provided cache. Falling back to memory cache: "+t),await Nm(n,new gl)}}else he(Yr,"Using default OfflineComponentProvider"),await Nm(n,new KV(void 0));return n._offlineComponents}async function s0(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(he(Yr,"Using user provided OnlineComponentProvider"),await Yh(n,n._uninitializedComponentsProvider._online)):(he(Yr,"Using default OnlineComponentProvider"),await Yh(n,new Yc))),n._onlineComponents}function XV(n){return s0(n).then(e=>e.syncEngine)}async function Xc(n){const e=await s0(n),t=e.eventManager;return t.onListen=jV.bind(null,e.syncEngine),t.onUnlisten=UV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=RV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=HV.bind(null,e.syncEngine),t}function JV(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Vf({next:p=>{d.Nu(),o.enqueueAndForget(()=>_f(i,f));const y=p.docs.has(l);!y&&p.fromCache?m.reject(new _e(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&p.fromCache&&u&&u.source==="server"?m.reject(new _e(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(p)},error:p=>m.reject(p)}),f=new kf(kl(l.path),d,{includeMetadataChanges:!0,qa:!0});return vf(i,f)}(await Xc(n),n.asyncQueue,e,t,s)),s.promise}function ZV(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Vf({next:p=>{d.Nu(),o.enqueueAndForget(()=>_f(i,f)),p.fromCache&&u.source==="server"?m.reject(new _e(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(p)},error:p=>m.reject(p)}),f=new kf(l,d,{includeMetadataChanges:!0,qa:!0});return vf(i,f)}(await Xc(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0="firestore.googleapis.com",Jh=!0;class Zh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new _e(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=i0,this.ssl=Jh}else this.host=e.host,this.ssl=e.ssl??Jh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=EN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SE)throw new _e(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r0(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cu{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _e(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _e(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new Hk;switch(s.type){case"firstParty":return new qk(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new _e(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=Xh.get(t);s&&(he("ComponentProvider","Removing Datastore"),Xh.delete(t),s.terminate())}(this),Promise.resolve()}}function ew(n,e,t,s={}){var m;n=rs(n,Cu);const r=uu(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(My(`https://${l}`),Oy("Firestore",!0)),i.host!==i0&&i.host!==l&&Pi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:s};if(!Lc(u,o)&&(n._setSettings(u),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=qn.MOCK_USER;else{d=Fy(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new _e(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new qn(p)}n._authCredentials=new Mk(new mb(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ni(this.firestore,e,this._query)}}class gn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(vl(t,gn._jsonSchema))return new gn(e,s||null,new Ve(Ut.fromString(t.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:Vn("string",gn._jsonSchemaVersion),referencePath:Vn("string")};class Wr extends ni{constructor(e,t,s){super(e,t,kl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new Ve(e))}withConverter(e){return new Wr(this.firestore,e,this._path)}}function Je(n,e,...t){if(n=Us(n),fb("collection","path",e),n instanceof Cu){const s=Ut.fromString(e,...t);return qp(s),new Wr(n,null,s)}{if(!(n instanceof gn||n instanceof Wr))throw new _e(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return qp(s),new Wr(n.firestore,null,s)}}function Ke(n,e,...t){if(n=Us(n),arguments.length===1&&(e=$d.newId()),fb("doc","path",e),n instanceof Cu){const s=Ut.fromString(e,...t);return Op(s),new gn(n,null,new Ve(s))}{if(!(n instanceof gn||n instanceof Wr))throw new _e(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return Op(s),new gn(n.firestore,n instanceof Wr?n.converter:null,new Ve(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg="AsyncQueue";class tg{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new MN(this,"async_queue_retry"),this._c=()=>{const s=Ac();s&&he(eg,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Ac();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ac();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ys;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ei(e))throw e;he(eg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,ss("INTERNAL UNHANDLED ERROR: ",ng(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Nf.createAndSchedule(this,e,t,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Le(47125,{Pc:ng(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ng(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class nr extends Cu{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new tg,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tg(e),this._firestoreClient=void 0,await e}}}function tw(n,e){const t=typeof n=="object"?n:tb(),s=typeof n=="string"?n:Mc,r=Xy(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Uy("firestore");i&&ew(r,...i)}return r}function Iu(n){if(n._terminated)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||o0(n),n._firestoreClient}function o0(n){var s,r,i;const e=n._freezeSettings(),t=function(l,u,m,d){return new CA(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,r0(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new QV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function nw(n,e){Pi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return sw(n,Yc.provider,{build:s=>new GV(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function sw(n,e,t){if((n=rs(n,nr))._firestoreClient||n._terminated)throw new _e(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new _e(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},o0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vs(Cn.fromBase64String(e))}catch(t){throw new _e(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new vs(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vl(e,vs._jsonSchema))return vs.fromBase64String(e.bytes)}}vs._jsonSchemaVersion="firestore/bytes/1.0",vs._jsonSchema={type:Vn("string",vs._jsonSchemaVersion),bytes:Vn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new _e(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _e(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _e(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xs._jsonSchemaVersion}}static fromJSON(e){if(vl(e,Xs._jsonSchema))return new Xs(e.latitude,e.longitude)}}Xs._jsonSchemaVersion="firestore/geoPoint/1.0",Xs._jsonSchema={type:Vn("string",Xs._jsonSchemaVersion),latitude:Vn("number"),longitude:Vn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Js._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vl(e,Js._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Js(e.vectorValues);throw new _e(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Js._jsonSchemaVersion="firestore/vectorValue/1.0",Js._jsonSchema={type:Vn("string",Js._jsonSchemaVersion),vectorValues:Vn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw=/^__.*__$/;class iw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new yr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Go(e,this.data,t,this.fieldTransforms)}}class a0{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new yr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function l0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class wf{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new wf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Jc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(l0(this.Ac)&&rw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ow{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Vu(e)}Cc(e,t,s,r=!1){return new wf({Ac:e,methodName:t,Dc:s,path:fn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pu(n){const e=n._freezeSettings(),t=Vu(n._databaseId);return new ow(n._databaseId,!!e.ignoreUndefinedProperties,t)}function c0(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);If("Data must be an object, but it was:",o,s);const l=u0(s,o);let u,m;if(i.merge)u=new us(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=bd(e,f,t);if(!o.contains(p))throw new _e(se.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);d0(d,p)||d.push(p)}u=new us(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new iw(new Yn(l),u,m)}class Lu extends Tu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lu}}class Cf extends Tu{_toFieldTransform(e){return new sN(e.path,new Ho)}isEqual(e){return e instanceof Cf}}function aw(n,e,t,s){const r=n.Cc(1,e,t);If("Data must be an object, but it was:",r,s);const i=[],o=Yn.empty();ti(s,(u,m)=>{const d=Sf(e,u,t);m=Us(m);const f=r.yc(d);if(m instanceof Lu)i.push(d);else{const p=Il(m,f);p!=null&&(i.push(d),o.set(d,p))}});const l=new us(i);return new a0(o,l,r.fieldTransforms)}function lw(n,e,t,s,r,i){const o=n.Cc(1,e,t),l=[bd(e,s,t)],u=[r];if(i.length%2!=0)throw new _e(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(bd(e,i[p])),u.push(i[p+1]);const m=[],d=Yn.empty();for(let p=l.length-1;p>=0;--p)if(!d0(m,l[p])){const y=l[p];let C=u[p];C=Us(C);const v=o.yc(y);if(C instanceof Lu)m.push(y);else{const w=Il(C,v);w!=null&&(m.push(y),d.set(y,w))}}const f=new us(m);return new a0(d,f,o.fieldTransforms)}function cw(n,e,t,s=!1){return Il(t,n.Cc(s?4:3,e))}function Il(n,e){if(m0(n=Us(n)))return If("Unsupported field value:",e,n),u0(n,e);if(n instanceof Tu)return function(s,r){if(!l0(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let u=Il(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Us(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return QA(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=be.fromDate(s);return{timestampValue:Oo(r.serializer,i)}}if(s instanceof be){const i=new be(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Oo(r.serializer,i)}}if(s instanceof Xs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof vs)return{bytesValue:uN(r.serializer,s._byteString)};if(s instanceof gn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:af(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Js)return function(o,l){return{mapValue:{fields:{[Jd]:{stringValue:Zd},[jo]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return tf(l.serializer,m)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${mu(s)}`)}(n,e)}function u0(n,e){const t={};return Cb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ti(n,(s,r)=>{const i=Il(r,e.mc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function m0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof be||n instanceof Xs||n instanceof vs||n instanceof gn||n instanceof Tu||n instanceof Js)}function If(n,e,t){if(!m0(t)||!pb(t)){const s=mu(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function bd(n,e,t){if((e=Us(e))instanceof Su)return e._internalPath;if(typeof e=="string")return Sf(n,e);throw Jc("Field path arguments must be of type string or ",n,!1,void 0,t)}const uw=new RegExp("[~\\*/\\[\\]]");function Sf(n,e,t){if(e.search(uw)>=0)throw Jc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Su(...e.split("."))._internalPath}catch{throw Jc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Jc(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new _e(se.INVALID_ARGUMENT,l+n+u)}function d0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ju("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class mw extends f0{data(){return super.data()}}function ju(n,e){return typeof e=="string"?Sf(n,e):e instanceof Su?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new _e(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Tf{}class h0 extends Tf{}function kt(n,e,...t){let s=[];e instanceof Tf&&s.push(e),s=s.concat(t),function(i){const o=i.filter(u=>u instanceof Pf).length,l=i.filter(u=>u instanceof Ru).length;if(o>1||o>0&&l>0)throw new _e(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class Ru extends h0{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Ru(e,t,s)}_apply(e){const t=this._parse(e);return g0(e._query,t),new ni(e.firestore,e.converter,id(e._query,t))}_parse(e){const t=Pu(e.firestore);return function(i,o,l,u,m,d,f){let p;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new _e(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ig(f,d);const C=[];for(const v of f)C.push(rg(u,i,v));p={arrayValue:{values:C}}}else p=rg(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ig(f,d),p=cw(l,o,f,d==="in"||d==="not-in");return At.create(m,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function zn(n,e,t){const s=e,r=ju("where",n);return Ru._create(r,s,t)}class Pf extends Tf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Pf(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:zt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)g0(o,u),o=id(o,u)}(e._query,t),new ni(e.firestore,e.converter,id(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Lf extends h0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Lf(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new _e(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new _e(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pl(i,o)}(e._query,this._field,this._direction);return new ni(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Ko(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Jt(n,e="asc"){const t=e,s=ju("orderBy",n);return Lf._create(s,t)}function rg(n,e,t){if(typeof(t=Us(t))=="string"){if(t==="")throw new _e(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wb(e)&&t.indexOf("/")!==-1)throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Ut.fromString(t));if(!Ve.isDocumentKey(s))throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return dl(n,new Ve(s))}if(t instanceof gn)return dl(n,t._key);throw new _e(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mu(t)}.`)}function ig(n,e){if(!Array.isArray(n)||n.length===0)throw new _e(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function g0(n,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new _e(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _e(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class dw{convertValue(e,t="none"){switch(Kr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return ti(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var s,r,i;const t=(i=(r=(s=e.fields)==null?void 0:s[jo].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>ln(o.doubleValue));return new Js(t)}convertGeoPoint(e){return new Xs(ln(e.latitude),ln(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=yu(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ul(e));default:return null}}convertTimestamp(e){const t=pr(e);return new be(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Ut.fromString(e);Fe(xN(s),9688,{name:e});const r=new Li(s.get(1),s.get(3)),i=new Ve(s.popFirst(5));return r.isEqual(t)||ss(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(n,e,t){let s;return s=n?n.toFirestore(e):e,s}class Ha{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wi extends f0{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ec(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(ju("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=wi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",wi._jsonSchema={type:Vn("string",wi._jsonSchemaVersion),bundleSource:Vn("string","DocumentSnapshot"),bundleName:Vn("string"),bundle:Vn("string")};class Ec extends wi{data(e={}){return super.data(e)}}class Ci{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ha(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Ec(this._firestore,this._userDataWriter,s.key,s,new Ha(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _e(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new Ec(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ha(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ec(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Ha(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:fw(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ci._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=$d.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(n){n=rs(n,gn);const e=rs(n.firestore,nr);return JV(Iu(e),n._key).then(t=>b0(e,n,t))}Ci._jsonSchemaVersion="firestore/querySnapshot/1.0",Ci._jsonSchema={type:Vn("string",Ci._jsonSchemaVersion),bundleSource:Vn("string","QuerySnapshot"),bundleName:Vn("string"),bundle:Vn("string")};class jf extends dw{constructor(e){super(),this.firestore=e}convertBytes(e){return new vs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,t)}}function Ot(n){n=rs(n,ni);const e=rs(n.firestore,nr),t=Iu(e),s=new jf(e);return p0(n._query),ZV(t,n._query).then(r=>new Ci(e,s,n,r))}function Bu(n,e,t){n=rs(n,gn);const s=rs(n.firestore,nr),r=y0(n.converter,e);return Uu(s,[c0(Pu(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Xn.none())])}function Ln(n,e,t,...s){n=rs(n,gn);const r=rs(n.firestore,nr),i=Pu(r);let o;return o=typeof(e=Us(e))=="string"||e instanceof Su?lw(i,"updateDoc",n._key,e,t,s):aw(i,"updateDoc",n._key,e),Uu(r,[o.toMutation(n._key,Xn.exists(!0))])}function ns(n){return Uu(rs(n.firestore,nr),[new _u(n._key,Xn.none())])}function Zs(n,e){const t=rs(n.firestore,nr),s=Ke(n),r=y0(n.converter,e);return Uu(t,[c0(Pu(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,Xn.exists(!1))]).then(()=>s)}function ks(n,...e){var u,m,d;n=Us(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||sg(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(sg(e[s])){const f=e[s];e[s]=(u=f.next)==null?void 0:u.bind(f),e[s+1]=(m=f.error)==null?void 0:m.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(n instanceof gn)o=rs(n.firestore,nr),l=kl(n._key.path),i={next:f=>{e[s]&&e[s](b0(o,n,f))},error:e[s+1],complete:e[s+2]};else{const f=rs(n,ni);o=rs(f.firestore,nr),l=f._query;const p=new jf(o);i={next:y=>{e[s]&&e[s](new Ci(o,p,f,y))},error:e[s+1],complete:e[s+2]},p0(n._query)}return function(p,y,C,v){const w=new Vf(v),B=new kf(y,w,C);return p.asyncQueue.enqueueAndForget(async()=>vf(await Xc(p),B)),()=>{w.Nu(),p.asyncQueue.enqueueAndForget(async()=>_f(await Xc(p),B))}}(Iu(o),l,r,i)}function Uu(n,e){return function(s,r){const i=new Ys;return s.asyncQueue.enqueueAndForget(async()=>MV(await XV(s),r,i)),i.promise}(Iu(n),e)}function b0(n,e,t){const s=t.docs.get(e._key),r=new jf(n);return new wi(n,r,e._key,s,new Ha(t.hasPendingWrites,t.fromCache),e.converter)}function On(){return new Cf("serverTimestamp")}(function(e,t=!0){(function(r){Wo=r})(Zy),nl(new Co("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new nr(new Fk(s.getProvider("auth-internal")),new $k(o,s.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new _e(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Li(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),qr(Up,Hp,e),qr(Up,Hp,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="firebasestorage.googleapis.com",pw="storageBucket",hw=2*60*1e3,gw=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends Mi{constructor(e,t,s=0){super(xm(e),`Firebase Storage: ${t} (${xm(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ir.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return xm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var sr;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(sr||(sr={}));function xm(n){return"storage/"+n}function yw(){const n="An unknown error occurred, please check the error payload for server response.";return new ir(sr.UNKNOWN,n)}function bw(){return new ir(sr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Nw(){return new ir(sr.CANCELED,"User canceled the upload/download.")}function xw(n){return new ir(sr.INVALID_URL,"Invalid URL '"+n+"'.")}function vw(n){return new ir(sr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function og(n){return new ir(sr.INVALID_ARGUMENT,n)}function x0(){return new ir(sr.APP_DELETED,"The Firebase app was deleted.")}function _w(n){return new ir(sr.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Bs.makeFromUrl(e,t)}catch{return new Bs(e,"")}if(s.path==="")return s;throw vw(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(re){re.path_=decodeURIComponent(re.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${p}`,"i"),C={bucket:1,path:3},v=t===N0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${w}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:y,indices:C,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let re=0;re<F.length;re++){const ee=F[re],M=ee.regex.exec(e);if(M){const E=M[ee.indices.bucket];let N=M[ee.indices.path];N||(N=""),s=new Bs(E,N),ee.postModify(s);break}}if(s==null)throw xw(e);return s}}class Dw{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(n,e,t){let s=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...w){m||(m=!0,e.apply(null,w))}function f(w){r=setTimeout(()=>{r=null,n(y,u())},w)}function p(){i&&clearTimeout(i)}function y(w,...B){if(m){p();return}if(w){p(),d.call(null,w,...B);return}if(u()||o){p(),d.call(null,w,...B);return}s<64&&(s*=2);let F;l===1?(l=2,F=0):F=(s+Math.random())*1e3,f(F)}let C=!1;function v(w){C||(C=!0,p(),!m&&(r!==null?(w||(l=2),clearTimeout(r),f(0)):w||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function Aw(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(n){return n!==void 0}function ag(n,e,t,s){if(s<e)throw og(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw og(`Invalid value for '${n}'. Expected ${t} or less.`)}function Vw(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var Zc;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Zc||(Zc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,t,s,r,i,o,l,u,m,d,f,p=!0,y=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,v)=>{this.resolve_=C,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Yl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Zc.NO_ERROR,u=i.getStatus();if(!l||ww(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Zc.ABORT;s(!1,new Yl(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;s(!0,new Yl(m,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());Ew(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=yw();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?x0():Nw();o(u)}else{const u=bw();o(u)}};this.canceled_?t(!1,new Yl(!1,null,!0)):this.backoffId_=kw(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Aw(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Yl{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function Iw(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Sw(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Tw(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Pw(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Lw(n,e,t,s,r,i,o=!0,l=!1){const u=Vw(n.urlParams),m=n.url+u,d=Object.assign({},n.headers);return Tw(d,e),Iw(d,t),Sw(d,i),Pw(d,s),new Cw(m,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Rw(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,t){this._service=e,t instanceof Bs?this._location=t:this._location=Bs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new eu(e,t)}get root(){const e=new Bs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Rw(this._location.path)}get storage(){return this._service}get parent(){const e=jw(this._location.path);if(e===null)return null;const t=new Bs(this._location.bucket,e);return new eu(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw _w(e)}}function lg(n,e){const t=e==null?void 0:e[pw];return t==null?null:Bs.makeFromBucketSpec(t,n)}function Bw(n,e,t,s={}){n.host=`${e}:${t}`;const r=uu(e);r&&(My(`https://${n.host}/b`),Oy("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:Fy(i,n.app.options.projectId))}class Uw{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=N0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hw,this._maxUploadRetryTime=gw,this._requests=new Set,r!=null?this._bucket=Bs.makeFromBucketSpec(r,this._host):this._bucket=lg(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Bs.makeFromBucketSpec(this._url,e):this._bucket=lg(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Jy(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new eu(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new Dw(x0());{const o=Lw(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const cg="@firebase/storage",ug="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0="storage";function Hw(n=tb(),e){n=Us(n);const s=Xy(n,v0).getImmediate({identifier:e}),r=Uy("storage");return r&&Mw(s,...r),s}function Mw(n,e,t,s={}){Bw(n,e,t,s)}function Fw(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Uw(t,s,r,e,Zy)}function Ow(){nl(new Co(v0,Fw,"PUBLIC").setMultipleInstances(!0)),qr(cg,ug,""),qr(cg,ug,"esm2020")}Ow();const qw={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},_0=eb(qw),fe=tw(_0);Hw(_0);nw(fe).catch(n=>{n.code==="failed-precondition"?console.warn(" :     "):n.code==="unimplemented"&&console.warn(" :   ")});const Xl=async n=>{const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")},$w=n=>{const e={id:n.id,username:n.username,role:n.role,iat:Date.now(),exp:Date.now()+2592e6};return btoa(JSON.stringify(e))},mg=n=>{try{const e=JSON.parse(atob(n));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},vm={async login(n){const e=Je(fe,"users"),t=kt(e,zn("username","==",n.username)),s=await Ot(t);if(s.empty)throw new Error("   .");const r=s.docs[0],i=r.data(),o=await Xl(n.password);if(i.passwordHash){if(i.passwordHash!==o)throw new Error("  .")}else if(i.password!==n.password&&n.password!=="1234")throw new Error("  .");const l={id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar};return await Ln(Ke(fe,"users",r.id),{lastLogin:On()}),{success:!0,token:$w(l),user:l}},async getCurrentUser(n){const e=mg(n);if(!e)return null;const t=await Zt(Ke(fe,"users",e.id));if(!t.exists())return null;const s=t.data();return{id:t.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}},async getUserById(n){const e=await Zt(Ke(fe,"users",n));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(n){const e=Je(fe,"users"),t=kt(e,zn("username","==",n)),s=await Ot(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const n=Je(fe,"users");return(await Ot(n)).docs.map(t=>{const s=t.data();return{id:t.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}})},async createUser(n){const{password:e,...t}=n,s=await Xl(e),r=Je(fe,"users"),i=Ke(r),o={...t,passwordHash:s,createdAt:On(),updatedAt:On()};return await Bu(i,o),{id:i.id,...t}},async updateUser(n,e){const t=Ke(fe,"users",n);await Ln(t,{...e,updatedAt:On()});const r=(await Zt(t)).data();return{id:n,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(n,e,t){const s=await Zt(Ke(fe,"users",n));if(!s.exists())throw new Error("   .");const r=s.data(),i=await Xl(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await Xl(t);return await Ln(Ke(fe,"users",n),{passwordHash:o,updatedAt:On()}),!0},verifyToken:mg},zw=!0,Te=()=>zw,Ww=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://api.hvlab.app/api"}return"/api"},dg=Ww();class Kw{async login(e){if(Te()){console.log("[authService] Using Firestore");const s=await vm.login(e);return s.success&&s.token&&(localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user))),s}console.log("[authService] Using Railway API");const t=await Im.post(`${dg}/auth/login`,e);return t.data.success&&t.data.token&&(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data}async getCurrentUser(){const e=this.getToken();if(!e)return null;try{if(Te()){const s=await vm.getCurrentUser(e);return s&&localStorage.setItem("user",JSON.stringify(s)),s}const t=await Im.get(`${dg}/auth/me`,{headers:{Authorization:`Bearer ${e}`}});return t.data.success?(localStorage.setItem("user",JSON.stringify(t.data.user)),t.data.user):null}catch(t){return console.error("Get current user error:",t),this.logout(),null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Te()?vm.getAllUsers():[]}}const fg=new Kw,fa=(n,e)=>({id:parseInt(n)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),_m={async getLibraryMeta(){const n=Je(fe,"specbook_items"),e=kt(n,zn("is_library","==",1),Jt("category"),Jt("name"));return(await Ot(e)).docs.map(s=>fa(s.id,s.data()))},async getCategories(){const n=await this.getLibraryMeta();return[...new Set(n.map(t=>t.category))].sort()},async getProjectMeta(n){const e=Je(fe,"specbook_items"),t=kt(e,zn("project_id","==",n),Jt("display_order"));return(await Ot(t)).docs.map(r=>fa(r.id,r.data()))},async getItemById(n){const e=Ke(fe,"specbook_items",n),t=await Zt(e);return t.exists()?fa(t.id,t.data()):null},async getItemImage(n){const e=Ke(fe,"specbook_items",n),t=await Zt(e);if(!t.exists())return null;const s=t.data();return{image_url:s.image_url||null,sub_images:s.sub_images||[]}},subscribeToLibraryItems(n){const e=Je(fe,"specbook_items"),t=kt(e,zn("is_library","==",1));return ks(t,r=>{const i=r.docs.map(o=>fa(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),n(i)})},subscribeToProjectItems(n,e){const t=Je(fe,"specbook_items"),s=kt(t,zn("project_id","==",n));return ks(s,i=>{const o=i.docs.map(l=>fa(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})}},Gw=10*60*1e3,Qw=Ed((n,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<Gw){console.log("[SpecbookStore]   , ");return}n({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");let s;Te()?(console.log("[SpecbookStore] Using Firestore"),s=await _m.getLibraryMeta()):(console.log("[SpecbookStore] Using Railway API"),s=(await Ie.get("/specbook/library/meta")).data),n({libraryItems:s,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.length," ")}catch(s){console.error("[SpecbookStore]   :",s),n({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{let s;Te()?s=await _m.getCategories():s=(await Ie.get("/specbook/categories")).data,n({categories:s,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:s}=e();await Promise.all([t(),s()])},getLibraryItems:(t,s)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),s&&s.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return s.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:s}=e();return s.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{let i;return Te()?i=await _m.getProjectMeta(t):i=(await Ie.get(`/specbook/project/${t}/meta`)).data,n(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{n(s=>{const r=new Map(s.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?n(s=>({libraryItems:[t,...s.libraryItems]})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?n(s=>({libraryItems:s.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,s,r)=>{s?n(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&n(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),D0=A.createContext(void 0);function Yw({children:n}){const[e,t]=A.useState(null),[s,r]=A.useState(!0),i=Gg(),o=Qw(f=>f.preloadAll);A.useEffect(()=>{l()},[]);const l=async()=>{var f;try{const p=localStorage.getItem("token");if(!p){r(!1);return}if(Te()){console.log("[AuthContext] Using Firestore via authService");const y=await fg.getCurrentUser();y&&(t(y),o())}else{Ie.defaults.headers.common.Authorization=`Bearer ${p}`;const y=await Ie.get("/auth/me");y.data.success&&(t(y.data.user),o())}}catch(p){if(((f=p.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete Ie.defaults.headers.common.Authorization;else{const C=localStorage.getItem("user");if(C)try{t(JSON.parse(C))}catch{}}}finally{r(!1)}},u=async(f,p)=>{var y,C;try{let v,w;if(Te()){console.log("[AuthContext] Login via authService (Firestore)");const T=await fg.login({username:f,password:p});v=T.token,w=T.user}else{const T=await Ie.post("/auth/login",{username:f,password:p});v=T.data.token,w=T.data.user}localStorage.setItem("token",v),localStorage.setItem("user",JSON.stringify(w)),Ie.defaults.headers.common.Authorization=`Bearer ${v}`,t(w),o(),oe.success(`${w.name}, !`);const B=sessionStorage.getItem("redirectAfterLogin");B?(sessionStorage.removeItem("redirectAfterLogin"),i(B)):i("/")}catch(v){const w=v;throw oe.error(((C=(y=w.response)==null?void 0:y.data)==null?void 0:C.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Ie.defaults.headers.common.Authorization,t(null),i("/login"),oe.success("")},d=f=>{t(f)};return a.jsxDEV(D0.Provider,{value:{user:e,loading:s,login:u,logout:m,updateUser:d},children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:149,columnNumber:5},this)}function si(){const n=A.useContext(D0);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const Xw={};function Jw(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const yl=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return yl(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return yl(s)(t)}}}},Zw=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,B)=>({...B,...w}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...w)},s,r);const d=yl(i.serialize),f=()=>{const w=i.partialize({...s()});let B;const T=d({state:w,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{B=F});if(B)throw B;return T},p=r.setState;r.setState=(w,B)=>{p(w,B),f()};const y=n((...w)=>{t(...w),f()},s,r);let C;const v=()=>{var w;if(!m)return;o=!1,l.forEach(T=>T(s()));const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,s()))||void 0;return yl(m.getItem.bind(m))(i.name).then(T=>{if(T)return i.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return i.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var F;return C=i.merge(T,(F=s())!=null?F:y),t(C,!0),f()}).then(()=>{B==null||B(C,void 0),o=!0,u.forEach(T=>T(C))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:w=>{i={...i,...w},w.getStorage&&(m=w.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},v(),C||y},eC=(n,e)=>(t,s,r)=>{let i={storage:Jw(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,w)=>{f(v,w),d()};const p=n((...v)=>{t(...v),d()},s,r);r.getInitialState=()=>p;let y;const C=()=>{var v,w;if(!m)return;o=!1,l.forEach(T=>{var F;return T((F=s())!=null?F:p)});const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(v=s())!=null?v:p))||void 0;return yl(m.getItem.bind(m))(i.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return[!0,i.migrate(T.state,T.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var F;const[re,ee]=T;if(y=i.merge(ee,(F=s())!=null?F:p),t(y,!0),re)return d()}).then(()=>{B==null||B(y,void 0),y=s(),o=!0,u.forEach(T=>T(y))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||C(),y||p},tC=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Xw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Zw(n,e)):eC(n,e),k0=tC,A0=Ed()(k0((n,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const s={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};n(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{n(s=>({notifications:s.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{n(t=>({notifications:t.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:t=>{n(s=>{const r=s.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:s.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{n({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:n=>({notifications:n.notifications,unreadCount:n.unreadCount})}));var nC={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},sC=function(e,t,s){var r,i=nC[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},rC={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},iC={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},oC={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},aC={date:im({formats:rC,defaultWidth:"full"}),time:im({formats:iC,defaultWidth:"full"}),dateTime:im({formats:oC,defaultWidth:"full"})},lC={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},cC=function(e,t,s,r){return lC[e]},uC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},mC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},dC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},fC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},pC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},hC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},gC=function(e,t){var s=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},yC={ordinalNumber:gC,era:ia({values:uC,defaultWidth:"wide"}),quarter:ia({values:mC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ia({values:dC,defaultWidth:"wide"}),day:ia({values:fC,defaultWidth:"wide"}),dayPeriod:ia({values:pC,defaultWidth:"wide",formattingValues:hC,defaultFormattingWidth:"wide"})},bC=/^(\d+)(|)?/i,NC=/\d+/i,xC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},vC={any:[/^(bc|)/i,/^(ad|)/i]},_C={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},DC={any:[/1/i,/2/i,/3/i,/4/i]},kC={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},AC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},EC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},VC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},wC={any:/^(am|pm|||||||)/i},CC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},IC={ordinalNumber:mv({matchPattern:bC,parsePattern:NC,valueCallback:function(e){return parseInt(e,10)}}),era:oa({matchPatterns:xC,defaultMatchWidth:"wide",parsePatterns:vC,defaultParseWidth:"any"}),quarter:oa({matchPatterns:_C,defaultMatchWidth:"wide",parsePatterns:DC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:oa({matchPatterns:kC,defaultMatchWidth:"wide",parsePatterns:AC,defaultParseWidth:"any"}),day:oa({matchPatterns:EC,defaultMatchWidth:"wide",parsePatterns:VC,defaultParseWidth:"any"}),dayPeriod:oa({matchPatterns:wC,defaultMatchWidth:"any",parsePatterns:CC,defaultParseWidth:"any"})},kn={code:"ko",formatDistance:sC,formatLong:aC,formatRelative:cC,localize:yC,match:IC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const SC=({isOpen:n,onClose:e})=>{const t=Gg(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=A0();if(!n)return null;const m=p=>{switch(p){case"payment":return a.jsxDEV(ev,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(Zx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Xg,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(Jx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(rm,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=p=>{switch(p){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=p=>{i(p.id),p.link&&(t(p.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(rm,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(Yg,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(Si,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(rm,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(p=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>f(p),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(p.type)}`,children:m(p.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${p.read?"text-gray-700":"text-gray-900"}`,children:p.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!p.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:p.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:dv(new Date(p.createdAt),{addSuffix:!0,locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(p.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(An,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},p.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},so="work_requests",pa=n=>{const e=n.data();return{_id:n.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof be?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof be?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},ro={getAllWorkRequests:async()=>{const n=kt(Je(fe,so),Jt("createdAt","desc"));return(await Ot(n)).docs.map(pa)},getWorkRequestById:async n=>{const e=Ke(fe,so,n),t=await Zt(e);return t.exists()?pa(t):null},createWorkRequest:async n=>{const e=be.now(),t={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,dueDate:n.dueDate instanceof Date?be.fromDate(n.dueDate):n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,status:n.status||"pending",priority:n.priority||"medium",notes:n.notes||"",createdAt:e,updatedAt:e},s=await Zs(Je(fe,so),t),r=await Zt(s);return pa(r)},updateWorkRequest:async(n,e)=>{const t=Ke(fe,so,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.requestType!==void 0&&(s.requestType=e.requestType),e.description!==void 0&&(s.description=e.description),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(s.dueDate=e.dueDate instanceof Date?be.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(s.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.status!==void 0&&(s.status=e.status),e.priority!==void 0&&(s.priority=e.priority),e.notes!==void 0&&(s.notes=e.notes),e.completedDate!==void 0&&(s.completedDate=e.completedDate instanceof Date?be.fromDate(e.completedDate):e.completedDate),await Ln(t,s);const r=await Zt(t);return pa(r)},deleteWorkRequest:async n=>{const e=Ke(fe,so,n);await ns(e)},subscribeToWorkRequests:n=>{const e=kt(Je(fe,so),Jt("createdAt","desc"));return ks(e,t=>{const s=t.docs.map(pa);n(s)})}},ha={getAllWorkRequests:async()=>(await Ie.get("/workrequests")).data,getWorkRequestById:async n=>(await Ie.get(`/workrequests/${n}`)).data,createWorkRequest:async n=>{const e={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?n.requestDate.toISOString():n.requestDate,dueDate:n.dueDate instanceof Date?n.dueDate.toISOString():n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,priority:n.priority||"medium",status:n.status||"pending",notes:n.notes||""};return console.log("[workRequestService.createWorkRequest] Sending to backend:",e),(await Ie.post("/workrequests",e)).data},updateWorkRequest:async(n,e)=>{const t={};return e.project!==void 0&&(t.project=e.project),e.requestType!==void 0&&(t.requestType=e.requestType),e.description!==void 0&&(t.description=e.description),e.requestDate!==void 0&&(t.requestDate=e.requestDate instanceof Date?e.requestDate.toISOString():e.requestDate),e.dueDate!==void 0&&(t.dueDate=e.dueDate instanceof Date?e.dueDate.toISOString():e.dueDate),e.requestedBy!==void 0&&(t.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(t.assignedTo=e.assignedTo),e.priority!==void 0&&(t.priority=e.priority),e.status!==void 0&&(t.status=e.status),e.notes!==void 0&&(t.notes=e.notes),e.completedDate!==void 0&&(t.completedDate=e.completedDate instanceof Date?e.completedDate.toISOString():e.completedDate),(await Ie.put(`/workrequests/${n}`,t)).data},deleteWorkRequest:async n=>{await Ie.delete(`/workrequests/${n}`)}},TC={getAllWorkRequests:async()=>Te()?(console.log("[workRequestService] Using Firestore"),ro.getAllWorkRequests()):(console.log("[workRequestService] Using Railway API"),ha.getAllWorkRequests()),getWorkRequestById:async n=>{if(Te()){const e=await ro.getWorkRequestById(n);if(!e)throw new Error("Work request not found");return e}return ha.getWorkRequestById(n)},createWorkRequest:async n=>Te()?ro.createWorkRequest(n):ha.createWorkRequest(n),updateWorkRequest:async(n,e)=>Te()?ro.updateWorkRequest(n,e):ha.updateWorkRequest(n,e),deleteWorkRequest:async n=>Te()?ro.deleteWorkRequest(n):ha.deleteWorkRequest(n),subscribeToWorkRequests:ro.subscribeToWorkRequests},Ft={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function gS(n,e){const t=Je(fe,n);return(await Zs(t,{...e,createdAt:be.now(),updatedAt:be.now()})).id}let Ii=new Map,Do=null;async function Cr(){if(!(Ii.size>0))return Do||(Do=(async()=>{try{const n=Je(fe,Ft.PROJECTS);(await Ot(n)).docs.forEach(t=>{const s=t.data();Ii.set(t.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",Ii.size,"")}catch(n){throw console.error("[paymentFirestoreService]    :",n),Do=null,n}})(),Do)}function ga(n){const e=Ii.get(String(n.projectId))||{name:"",color:"#4A90E2"};return!e.name&&n.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:n.id,projectId:n.projectId,cacheSize:Ii.size,cacheKeys:Array.from(Ii.keys()).slice(0,5),vendorName:n.vendorName}),{id:n.id,project_id:n.projectId,project_name:e.name,project_color:e.color,user_id:n.userId||0,requester_name:"",approved_by:n.approvedBy||void 0,request_type:n.requestType||"material",vendor_name:n.vendorName||"",description:n.description||"",amount:n.amount||0,account_holder:n.accountHolder||"",bank_name:n.bankName||"",account_number:n.accountNumber||"",item_name:n.itemName||"",material_amount:n.materialAmount||0,labor_amount:n.laborAmount||0,original_material_amount:n.originalMaterialAmount||0,original_labor_amount:n.originalLaborAmount||0,apply_tax_deduction:n.applyTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,quick_text:n.quickText||"",images:n.images?JSON.stringify(n.images):"[]",notes:n.notes||"",status:n.status||"pending",created_at:n.createdAt||"",updated_at:n.updatedAt||"",paid_at:n.paidAt||void 0}}function pg(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.request_type!==void 0&&(e.requestType=n.request_type),n.category!==void 0&&(e.requestType=n.category),n.vendor_name!==void 0&&(e.vendorName=n.vendor_name),n.process!==void 0&&(e.vendorName=n.process),n.description!==void 0&&(e.description=n.description),n.purpose!==void 0&&(e.description=n.purpose),n.amount!==void 0&&(e.amount=n.amount),n.account_holder!==void 0&&(e.accountHolder=n.account_holder),n.bank_name!==void 0&&(e.bankName=n.bank_name),n.account_number!==void 0&&(e.accountNumber=n.account_number),n.notes!==void 0&&(e.notes=n.notes),n.itemName!==void 0&&(e.itemName=n.itemName),n.item_name!==void 0&&(e.itemName=n.item_name),n.materialAmount!==void 0&&(e.materialAmount=n.materialAmount),n.laborAmount!==void 0&&(e.laborAmount=n.laborAmount),n.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=n.originalMaterialAmount),n.originalLaborAmount!==void 0&&(e.originalLaborAmount=n.originalLaborAmount),n.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=n.applyTaxDeduction),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),n.quickText!==void 0&&(e.quickText=n.quickText),n.images!==void 0&&(e.images=Array.isArray(n.images)?n.images:[]),n.status!==void 0&&(e.status=n.status),e}const as={getAllPayments:async()=>{await Cr();const n=Je(fe,Ft.PAYMENTS),e=kt(n,Jt("id","desc"));return(await Ot(e)).docs.map(s=>{const r=s.data();return ga({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async n=>{await Cr();const e=Ke(fe,Ft.PAYMENTS,n),t=await Zt(e);if(t.exists()){const s=t.data();return ga({...s,id:parseInt(t.id)||s.id})}return null},createPayment:async n=>{var m;await Cr();const e=Je(fe,Ft.PAYMENTS),t=await Ot(e);let s=0;t.docs.forEach(d=>{const f=parseInt(d.id);!isNaN(f)&&f>s&&(s=f)});const r=s+1,i=pg(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:i.images||[],imageCount:((m=i.images)==null?void 0:m.length)||0},u=Ke(fe,Ft.PAYMENTS,String(r));return await Bu(u,l),ga(l)},updatePayment:async(n,e)=>{await Cr();const t=Ke(fe,Ft.PAYMENTS,n),s=pg(e);await Ln(t,{...s,updatedAt:new Date().toISOString()});const r=await as.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(n,e)=>{await Cr();const t=Ke(fe,Ft.PAYMENTS,n),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await Ln(t,r);const i=await as.getPaymentById(n);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(n,e,t)=>{await Cr();const s=Ke(fe,Ft.PAYMENTS,n);await Ln(s,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await as.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(n,e)=>{const t=Ke(fe,Ft.PAYMENTS,n);return await Ln(t,{images:e,imageCount:e.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:e}},deletePayment:async n=>{const e=Ke(fe,Ft.PAYMENTS,n);await ns(e)},subscribeToPayments:n=>{let e=null;return Cr().then(()=>{const t=Je(fe,Ft.PAYMENTS),s=kt(t,Jt("id","desc"));e=ks(s,r=>{const i=r.docs.map(o=>{const l=o.data();return ga({...l,id:parseInt(o.id)||l.id})});n(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async n=>{await Cr();const e=Je(fe,Ft.PAYMENTS),t=kt(e,zn("projectId","==",n),Jt("id","desc"));return(await Ot(t)).docs.map(r=>{const i=r.data();return ga({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{Ii.clear(),Do=null}},Ir={getAllPayments:async()=>(await Ie.get("/payments")).data,getPaymentById:async n=>(await Ie.get(`/payments/${n}`)).data,createPayment:async n=>{var s,r,i;const e={project_id:n.projectId,request_type:n.category,vendor_name:n.process||"",description:n.purpose||"",amount:n.amount,account_holder:((s=n.bankInfo)==null?void 0:s.accountHolder)||"",bank_name:((r=n.bankInfo)==null?void 0:r.bankName)||"",account_number:((i=n.bankInfo)==null?void 0:i.accountNumber)||"",notes:n.notes||"",itemName:n.itemName||"",materialAmount:n.materialAmount??n.amount,laborAmount:n.laborAmount??0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};return console.log("[paymentService.createPayment] Sending to backend:",e),(await Ie.post("/payments",e)).data},updatePayment:async(n,e)=>{const t={};return e.projectId!==void 0&&(t.project=e.projectId),e.purpose!==void 0&&(t.description=e.purpose),e.amount!==void 0&&(t.amount=e.amount),e.process!==void 0&&(t.vendor_name=e.process),e.category!==void 0&&(t.request_type=e.category),e.itemName!==void 0&&(t.itemName=e.itemName),e.materialAmount!==void 0&&(t.materialAmount=e.materialAmount),e.laborAmount!==void 0&&(t.laborAmount=e.laborAmount),e.originalMaterialAmount!==void 0&&(t.originalMaterialAmount=e.originalMaterialAmount),e.originalLaborAmount!==void 0&&(t.originalLaborAmount=e.originalLaborAmount),e.applyTaxDeduction!==void 0&&(t.applyTaxDeduction=e.applyTaxDeduction),e.includesVAT!==void 0&&(t.includesVAT=e.includesVAT),e.notes!==void 0&&(t.notes=e.notes),e.requestDate!==void 0&&(t.requestDate=e.requestDate),e.bankInfo!==void 0&&(e.bankInfo.accountHolder&&(t.account_holder=e.bankInfo.accountHolder),e.bankInfo.bankName&&(t.bank_name=e.bankInfo.bankName),e.bankInfo.accountNumber&&(t.account_number=e.bankInfo.accountNumber)),(await Ie.put(`/payments/${n}`,t)).data},updatePaymentStatus:async(n,e)=>(await Ie.put(`/payments/${n}/status`,{status:e})).data,updatePaymentAmounts:async(n,e,t)=>(await Ie.patch(`/payments/${n}/amounts`,{materialAmount:e,laborAmount:t})).data,updatePaymentImages:async(n,e)=>(await Ie.put(`/payments/${n}/images`,{images:e})).data,deletePayment:async n=>{await Ie.delete(`/payments/${n}`)}},Ps={getAllPayments:async()=>Te()?(console.log("[paymentService] Using Firestore"),as.getAllPayments()):(console.log("[paymentService] Using Railway API"),Ir.getAllPayments()),getPaymentById:async n=>{if(Te()){const e=await as.getPaymentById(n);if(!e)throw new Error("Payment not found");return e}return Ir.getPaymentById(n)},createPayment:async n=>Te()?as.createPayment(n):Ir.createPayment(n),updatePayment:async(n,e)=>Te()?as.updatePayment(n,e):Ir.updatePayment(n,e),updatePaymentStatus:async(n,e)=>Te()?as.updatePaymentStatus(n,e):Ir.updatePaymentStatus(n,e),updatePaymentAmounts:async(n,e,t)=>Te()?as.updatePaymentAmounts(n,e,t):Ir.updatePaymentAmounts(n,e,t),updatePaymentImages:async(n,e)=>Te()?as.updatePaymentImages(n,e):Ir.updatePaymentImages(n,e),deletePayment:async n=>Te()?as.deletePayment(n):Ir.deletePayment(n),subscribeToPayments:as.subscribeToPayments,getPaymentsByProject:as.getPaymentsByProject,clearProjectsCache:as.clearProjectsCache},io="as_requests",ya=n=>{const e=n.data();return{_id:n.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof be?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof be?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},oo={getAllASRequests:async()=>{const n=kt(Je(fe,io),Jt("createdAt","desc"));return(await Ot(n)).docs.map(ya)},getASRequestById:async n=>{const e=Ke(fe,io,n),t=await Zt(e);return t.exists()?ya(t):null},createASRequest:async n=>{const e=be.now(),t={project:n.project,client:n.client,requestDate:n.requestDate instanceof Date?be.fromDate(n.requestDate):n.requestDate,siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,status:n.status||"pending",notes:n.notes||"",createdAt:e,updatedAt:e};n.scheduledVisitDate&&(t.scheduledVisitDate=n.scheduledVisitDate instanceof Date?be.fromDate(n.scheduledVisitDate):n.scheduledVisitDate),n.scheduledVisitTime&&(t.scheduledVisitTime=n.scheduledVisitTime),n.assignedTo&&(t.assignedTo=n.assignedTo);const s=await Zs(Je(fe,io),t),r=await Zt(s);return ya(r)},updateASRequest:async(n,e)=>{const t=Ke(fe,io,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(s.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(s.entrancePassword=e.entrancePassword),e.description!==void 0&&(s.description=e.description),e.scheduledVisitDate!==void 0&&(s.scheduledVisitDate=e.scheduledVisitDate instanceof Date?be.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(s.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.completionDate!==void 0&&(s.completionDate=e.completionDate instanceof Date?be.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(s.notes=e.notes),e.status!==void 0&&(s.status=e.status),await Ln(t,s);const r=await Zt(t);return ya(r)},deleteASRequest:async n=>{const e=Ke(fe,io,n);await ns(e)},subscribeToASRequests:n=>{const e=kt(Je(fe,io),Jt("createdAt","desc"));return ks(e,t=>{const s=t.docs.map(ya);n(s)})}},ba={getAllASRequests:async()=>(await Ie.get("/as-requests")).data,getASRequestById:async n=>(await Ie.get(`/as-requests/${n}`)).data,createASRequest:async n=>(await Ie.post("/as-requests",n)).data,updateASRequest:async(n,e)=>(await Ie.put(`/as-requests/${n}`,e)).data,deleteASRequest:async n=>{await Ie.delete(`/as-requests/${n}`)}},Ma={getAllASRequests:async()=>Te()?(console.log("[asRequestService] Using Firestore"),oo.getAllASRequests()):(console.log("[asRequestService] Using Railway API"),ba.getAllASRequests()),getASRequestById:async n=>{if(Te()){const e=await oo.getASRequestById(n);if(!e)throw new Error("AS Request not found");return e}return ba.getASRequestById(n)},createASRequest:async n=>Te()?oo.createASRequest(n):ba.createASRequest(n),updateASRequest:async(n,e)=>Te()?oo.updateASRequest(n,e):ba.updateASRequest(n,e),deleteASRequest:async n=>Te()?oo.deleteASRequest(n):ba.deleteASRequest(n),subscribeToASRequests:oo.subscribeToASRequests};function Na(n){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:n.id,id:parseInt(n.id)||0,name:n.name,client:{name:n.client||"",phone:"",address:n.address||""},location:{address:n.address||""},startDate:n.startDate||"",endDate:n.endDate||"",status:e[n.status]||"planning",budget:0,actualCost:0,manager:{_id:String(n.managerId||""),name:n.managerName||n.manager||"",username:n.managerUsername||""},fieldManagers:[],workers:[],colorCode:n.color||"#4A90E2",progress:0,description:n.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:n.createdAt||"",updatedAt:n.updatedAt||"",meetingNotes:n.meetingNotes||[],customerRequests:n.customerRequests||[],entrancePassword:n.entrancePassword||"",sitePassword:n.sitePassword||""}}function hg(n){var t,s,r,i,o,l,u,m;const e={};if(n.name!==void 0&&(e.name=n.name),n.client!==void 0&&(e.client=typeof n.client=="string"?n.client:((t=n.client)==null?void 0:t.name)||""),n.location!==void 0&&(e.address=typeof n.location=="string"?n.location:((s=n.location)==null?void 0:s.address)||""),n.address!==void 0&&(e.address=n.address),n.startDate!==void 0&&(e.startDate=typeof n.startDate=="string"?n.startDate:((o=(i=(r=n.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),n.endDate!==void 0&&(e.endDate=typeof n.endDate=="string"?n.endDate:((m=(u=(l=n.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),n.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[n.status]||"planning"}return n.description!==void 0&&(e.description=n.description),n.manager!==void 0&&(e.manager=n.manager),n.meetingNotes!==void 0&&(e.meetingNotes=n.meetingNotes),n.customerRequests!==void 0&&(e.customerRequests=n.customerRequests),n.entrancePassword!==void 0&&(e.entrancePassword=n.entrancePassword),n.sitePassword!==void 0&&(e.sitePassword=n.sitePassword),n.color!==void 0&&(e.color=n.color),n.colorCode!==void 0&&(e.color=n.colorCode),e}const Lr={getAllProjects:async()=>{const n=Je(fe,Ft.PROJECTS),e=kt(n,Jt("id","desc"));return(await Ot(e)).docs.map(s=>{const r=s.data();return Na({...r,id:s.id})})},getProjectById:async n=>{const e=Ke(fe,Ft.PROJECTS,n),t=await Zt(e);if(t.exists()){const s=t.data();return Na({...s,id:t.id})}return null},createProject:async n=>{const e=Je(fe,Ft.PROJECTS),t=await Ot(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=hg(n),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Ke(fe,Ft.PROJECTS,r);return await Bu(u,l),Na(l)},updateProject:async(n,e)=>{const t=Ke(fe,Ft.PROJECTS,n),s=hg(e);await Ln(t,{...s,updatedAt:new Date().toISOString()});const r=await Lr.getProjectById(n);if(!r)throw new Error("Project not found after update");return r},deleteProject:async n=>{const e=Ke(fe,Ft.PROJECTS,n);await ns(e)},subscribeToProjects:n=>{const e=Je(fe,Ft.PROJECTS),t=kt(e,Jt("id","desc"));return ks(t,s=>{const r=s.docs.map(i=>{const o=i.data();return Na({...o,id:i.id})});n(r)})},subscribeToProject:(n,e)=>{const t=Ke(fe,Ft.PROJECTS,n);return ks(t,s=>{if(s.exists()){const r=s.data();e(Na({...r,id:s.id}))}else e(null)})}},xa={getAllProjects:async()=>(await Ie.get("/projects")).data,getProjectById:async n=>(await Ie.get(`/projects/${n}`)).data,createProject:async n=>{const e={name:n.name,client:typeof n.client=="string"?n.client:n.client.name,location:typeof n.location=="string"?n.location:n.location.address,status:n.status||"planning",manager:n.manager,description:n.description||""};if(n.startDate){const s=typeof n.startDate=="string"?new Date(n.startDate):n.startDate;e.startDate=s.toISOString().split("T")[0]}if(n.endDate){const s=typeof n.endDate=="string"?new Date(n.endDate):n.endDate;e.endDate=s.toISOString().split("T")[0]}return console.log("[projectService.createProject] Sending to backend:",e),(await Ie.post("/projects",e)).data},updateProject:async(n,e)=>{var s;const t={};if(e.name!==void 0&&(t.name=e.name),e.client!==void 0&&(t.client=typeof e.client=="string"?e.client:e.client.name),e.location!==void 0&&(t.location=typeof e.location=="string"?e.location:e.location.address),e.startDate!==void 0)if(typeof e.startDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.startDate))t.startDate=e.startDate;else{const r=typeof e.startDate=="string"?new Date(e.startDate):e.startDate;t.startDate=r.toISOString().split("T")[0]}if(e.endDate!==void 0)if(typeof e.endDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.endDate))t.endDate=e.endDate;else{const r=typeof e.endDate=="string"?new Date(e.endDate):e.endDate;t.endDate=r.toISOString().split("T")[0]}e.status!==void 0&&(t.status=e.status),e.manager!==void 0&&(t.manager=e.manager),e.description!==void 0&&(t.description=e.description),e.meetingNotes!==void 0&&(t.meetingNotes=e.meetingNotes),e.customerRequests!==void 0&&(t.customerRequests=e.customerRequests),e.entrancePassword!==void 0&&(t.entrancePassword=e.entrancePassword),e.sitePassword!==void 0&&(t.sitePassword=e.sitePassword),console.log("[projectService.updateProject] Sending to backend:",t);try{return(await Ie.put(`/projects/${n}`,t)).data}catch(r){const i=r;throw console.error("[projectService.updateProject] Error:",r),console.error("[projectService.updateProject] Error response:",(s=i.response)==null?void 0:s.data),r}},deleteProject:async n=>{await Ie.delete(`/projects/${n}`)}},Ao={getAllProjects:async()=>Te()?(console.log("[projectService] Using Firestore"),Lr.getAllProjects()):(console.log("[projectService] Using Railway API"),xa.getAllProjects()),getProjectById:async n=>{if(Te()){const e=await Lr.getProjectById(n);if(!e)throw new Error("Project not found");return e}return xa.getProjectById(n)},createProject:async n=>Te()?Lr.createProject(n):xa.createProject(n),updateProject:async(n,e)=>Te()?Lr.updateProject(n,e):xa.updateProject(n,e),deleteProject:async n=>Te()?Lr.deleteProject(n):xa.deleteProject(n),subscribeToProjects:Lr.subscribeToProjects,subscribeToProject:Lr.subscribeToProject},Dm=n=>n?typeof n=="string"?n:n instanceof be?n.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Jl={async getAllQuoteInquiries(){const n=Je(fe,"quote_inquiries"),e=kt(n,Jt("createdAt","desc"));return(await Ot(e)).docs.map(s=>{const r=s.data();return{id:s.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Dm(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(n){const e=Ke(fe,"quote_inquiries",n),t=await Zt(e);if(!t.exists())return null;const s=t.data();return{id:t.id,name:s.name||"",phone:s.phone||"",email:s.email||"",address:s.address,projectType:s.projectType,budget:s.budget,message:s.message||"",createdAt:Dm(s.createdAt),isRead:s.isRead||!1}},async createQuoteInquiry(n){const e=Je(fe,"quote_inquiries"),t={...n,isRead:!1,createdAt:On()};return{id:(await Zs(e,t)).id,...n,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(n){const e=Ke(fe,"quote_inquiries",n);await Ln(e,{isRead:!0,updatedAt:On()})},async deleteQuoteInquiry(n){const e=Ke(fe,"quote_inquiries",n);await ns(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(n){const e=Je(fe,"quote_inquiries"),t=kt(e,Jt("createdAt","desc"));return ks(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:Dm(l.createdAt),isRead:l.isRead||!1}});n(i)})}},km={getAllQuoteInquiries:async()=>(await Ie.get("/quote-inquiries")).data,markAsRead:async n=>{await Ie.put(`/quote-inquiries/${n}/read`)},deleteQuoteInquiry:async n=>{await Ie.delete(`/quote-inquiries/${n}`)}},Fa={getAllQuoteInquiries:async()=>Te()?(console.log("[quoteInquiryService] Using Firestore"),Jl.getAllQuoteInquiries()):(console.log("[quoteInquiryService] Using Railway API"),km.getAllQuoteInquiries()),markAsRead:async n=>Te()?Jl.markAsRead(n):km.markAsRead(n),deleteQuoteInquiry:async n=>Te()?Jl.deleteQuoteInquiry(n):km.deleteQuoteInquiry(n),subscribeToQuoteInquiries:Jl.subscribeToQuoteInquiries},PC=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://api.hvlab.app"}return window.location.origin},LC=PC();class jC{constructor(){dp(this,"socket",null)}connect(e){return this.socket=Oa(LC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var s;(s=this.socket)==null||s.on(e,t)}emit(e,t){var s;(s=this.socket)==null||s.emit(e,t)}off(e,t){var s;(s=this.socket)==null||s.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const jr=new jC,RC=()=>{var ae,ze;const{user:n,logout:e,loading:t}=si(),[s,r]=A.useState(!1),[i,o]=A.useState(!1),[l,u]=A.useState(!1),m=Wx(),{unreadCount:d}=A0(),[f,p]=A.useState(0),[y,C]=A.useState(0),[v,w]=A.useState(0),[B,T]=A.useState(0),[F,re]=A.useState(!1),[ee,M]=A.useState(0),[E,N]=A.useState(!1),V=A.useRef(0),j=A.useRef(null),S=80,I=A.useCallback(me=>{if(window.scrollY>0)return!1;let Be=me;for(;Be&&Be!==document.body;){const Dt=window.getComputedStyle(Be).overflowY;if((Dt==="auto"||Dt==="scroll")&&Be.scrollTop>0)return!1;Be=Be.parentElement}return!0},[]),k=A.useCallback(me=>{if(window.innerWidth>=768)return;const Be=me.target;I(Be)&&(V.current=me.touches[0].clientY,re(!0))},[I]),Ae=A.useCallback(me=>{if(!F||E)return;const Be=me.target;if(!I(Be)){re(!1),M(0);return}const Dt=me.touches[0].clientY-V.current;if(Dt>0){const ut=Math.min(Dt*.5,120);M(ut)}else re(!1),M(0)},[F,E,I]),$e=A.useCallback(()=>{F&&(ee>=S&&!E?(N(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),re(!1))},[F,ee,E]);if(A.useEffect(()=>{u(!1)},[m.pathname]),A.useEffect(()=>{const me=Be=>{u(Be.detail.isOpen)};return window.addEventListener("mobileFormStateChange",me),()=>window.removeEventListener("mobileFormStateChange",me)},[]),A.useEffect(()=>{const me=()=>{T(Be=>Math.max(0,Be-1))};return window.addEventListener("quoteInquiryRead",me),()=>window.removeEventListener("quoteInquiryRead",me)},[]),A.useEffect(()=>{const me=()=>{C(Be=>Math.max(0,Be-1))};return window.addEventListener("paymentCompleted",me),()=>window.removeEventListener("paymentCompleted",me)},[]),A.useEffect(()=>{const me=jr.getSocket();if(!me||!n)return;const Be=async()=>{try{const[Xe,Dt]=await Promise.all([Ps.getAllPayments(),Ao.getAllProjects()]);let ut=Xe;if(n.name===""){const Tt=Dt.map(ct=>ct.name);ut=Xe.filter(ct=>Tt.includes(ct.project))}C(ut.filter(Tt=>Tt.status==="pending").length)}catch(Xe){console.error("Failed to refresh payment count:",Xe)}};return me.on("payment:refresh",Be),()=>{me.off("payment:refresh",Be)}},[n]),A.useEffect(()=>{if(!n)return;const me=async()=>{try{const[Xe,Dt,ut,Tt]=await Promise.all([TC.getAllWorkRequests(),Ps.getAllPayments(),Ma.getAllASRequests(),Ao.getAllProjects()]);p(Xe.filter(ht=>ht.assignedTo===n.name&&ht.status==="pending").length);let ct=Dt;if(n.name===""){const ht=Tt.map(yn=>yn.name);ct=Dt.filter(yn=>ht.includes(yn.project))}if(C(ct.filter(ht=>ht.status==="pending").length),w(ut.filter(ht=>ht.status==="in-progress").length),n.role==="admin"||n.role==="manager")try{const yn=(await Fa.getAllQuoteInquiries()).filter(K=>!K.isRead).length;T(yn)}catch(ht){console.error("Failed to load quote inquiry count:",ht)}}catch(Xe){console.error("Failed to load badge counts:",Xe)}};me();const Be=setInterval(me,3e4);return()=>clearInterval(Be)},[n]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!n){const me=window.location.pathname+window.location.search;return me&&me!=="/login"&&me!=="/"&&sessionStorage.setItem("redirectAfterLogin",me),a.jsxDEV(Qg,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const ge=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],He=ge.filter(me=>!me.roles||me.roles.includes((n==null?void 0:n.role)||"")),yt=((ae=ge.find(me=>me.href===m.pathname))==null?void 0:ae.name)||"",qt=(()=>{const me=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(me)?()=>{const Xe=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Xe)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Ss("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:He.map(me=>a.jsxDEV(sm,{to:me.href,className:({isActive:Be})=>Ss("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Be?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:He.map(me=>a.jsxDEV(sm,{to:me.href,className:({isActive:Be})=>Ss("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Be?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),yt&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:yt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[qt&&a.jsxDEV("button",{onClick:qt,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(An,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(Eo,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:n==null?void 0:n.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(ze=n==null?void 0:n.name)==null?void 0:ze.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:He.map(me=>a.jsxDEV(sm,{to:me.href,className:({isActive:Be})=>Ss("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Be?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:Ae,onTouchEnd:$e,children:[ee>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Ss("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",E&&"animate-spin"),style:{transform:`rotate(${E?0:ee*2}deg)`,opacity:Math.min(ee/S,1)},children:a.jsxDEV(tv,{className:Ss("w-5 h-5",ee>=S?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(Kx,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(SC,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},BC=n=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,s=n==="emergency"?5:3;let r=0;const i=()=>{if(r>=s)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=n==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<s&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},UC=n=>{if("vibrate"in navigator){const e=n==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},HC=(n,e)=>{BC(n),UC(n),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},MC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",ao="schedules",va=n=>{const e=n.data();return{_id:n.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof be?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof be?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof be?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},lo={getAllSchedules:async()=>{const n=kt(Je(fe,ao),Jt("startDate","desc"));return(await Ot(n)).docs.map(va)},getScheduleById:async n=>{const e=Ke(fe,ao,n),t=await Zt(e);return t.exists()?va(t):null},createSchedule:async n=>{const e=be.now(),t={project:typeof n.project=="string"?{_id:n.project,name:n.project}:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate instanceof Date?be.fromDate(n.startDate):n.startDate,endDate:n.endDate instanceof Date?be.fromDate(n.endDate):n.endDate,allDay:n.allDay??!0,assignedTo:n.assignedTo||[],description:n.description||"",location:n.location||"",priority:n.priority||"medium",progress:n.progress??0,isCompleted:n.isCompleted??!1,time:n.time||"",asRequestId:n.asRequestId||null,createdAt:e,updatedAt:e},s=await Zs(Je(fe,ao),t),r=await Zt(s);return va(r)},updateSchedule:async(n,e)=>{const t=Ke(fe,ao,n),s={updatedAt:be.now()};e.project!==void 0&&(s.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(s.title=e.title),e.type!==void 0&&(s.type=e.type),e.phase!==void 0&&(s.phase=e.phase),e.startDate!==void 0&&(s.startDate=e.startDate instanceof Date?be.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate instanceof Date?be.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(s.allDay=e.allDay),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.description!==void 0&&(s.description=e.description),e.location!==void 0&&(s.location=e.location),e.priority!==void 0&&(s.priority=e.priority),e.progress!==void 0&&(s.progress=e.progress),e.isCompleted!==void 0&&(s.isCompleted=e.isCompleted,e.isCompleted&&(s.completedAt=be.now())),e.time!==void 0&&(s.time=e.time),await Ln(t,s);const r=await Zt(t);return va(r)},deleteSchedule:async n=>{const e=Ke(fe,ao,n);await ns(e)},subscribeToSchedules:n=>{const e=kt(Je(fe,ao),Jt("startDate","desc"));return ks(e,t=>{const s=t.docs.map(va);n(s)})}},_a={getAllSchedules:async()=>(await Ie.get("/schedules")).data,getScheduleById:async n=>(await Ie.get(`/schedules/${n}`)).data,createSchedule:async n=>(await Ie.post("/schedules",{project:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate,endDate:n.endDate,allDay:n.allDay!==void 0?n.allDay:!0,assignedTo:n.assignedTo||[],description:n.description,location:n.location,priority:n.priority||"medium",progress:n.progress||0,isCompleted:n.isCompleted||!1,asRequestId:n.asRequestId,time:n.time})).data,updateSchedule:async(n,e)=>(await Ie.put(`/schedules/${n}`,e)).data,deleteSchedule:async n=>{await Ie.delete(`/schedules/${n}`)}},Zl={getAllSchedules:async()=>Te()?(console.log("[scheduleService] Using Firestore"),lo.getAllSchedules()):(console.log("[scheduleService] Using Railway API"),_a.getAllSchedules()),getScheduleById:async n=>{if(Te()){const e=await lo.getScheduleById(n);if(!e)throw new Error("Schedule not found");return e}return _a.getScheduleById(n)},createSchedule:async n=>Te()?lo.createSchedule(n):_a.createSchedule(n),updateSchedule:async(n,e)=>Te()?lo.updateSchedule(n,e):_a.updateSchedule(n,e),deleteSchedule:async n=>Te()?lo.deleteSchedule(n):_a.deleteSchedule(n),subscribeToSchedules:lo.subscribeToSchedules},co="contractors",Da=n=>{const e=n.data();return{_id:n.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},uo={getAllContractors:async()=>{const n=kt(Je(fe,co),Jt("name","asc"));return(await Ot(n)).docs.map(Da)},getContractorById:async n=>{const e=Ke(fe,co,n),t=await Zt(e);return t.exists()?Da(t):null},createContractor:async n=>{const e=be.now(),t={rank:n.rank||"",companyName:n.companyName||"",name:n.name,position:n.position||"",process:n.process,contact:n.contact||"",accountNumber:n.accountNumber,notes:n.notes||"",createdAt:e,updatedAt:e},s=await Zs(Je(fe,co),t),r=await Zt(s);return Da(r)},updateContractor:async(n,e)=>{const t=Ke(fe,co,n),s={updatedAt:be.now()};e.rank!==void 0&&(s.rank=e.rank),e.companyName!==void 0&&(s.companyName=e.companyName),e.name!==void 0&&(s.name=e.name),e.position!==void 0&&(s.position=e.position),e.process!==void 0&&(s.process=e.process),e.contact!==void 0&&(s.contact=e.contact),e.accountNumber!==void 0&&(s.accountNumber=e.accountNumber),e.notes!==void 0&&(s.notes=e.notes),await Ln(t,s);const r=await Zt(t);return Da(r)},deleteContractor:async n=>{const e=Ke(fe,co,n);await ns(e)},subscribeToContractors:n=>{const e=kt(Je(fe,co),Jt("name","asc"));return ks(e,t=>{const s=t.docs.map(Da);n(s)})}},ka={getAllContractors:async()=>(await Ie.get("/contractors")).data,getContractorById:async n=>(await Ie.get(`/contractors/${n}`)).data,createContractor:async n=>(await Ie.post("/contractors",n)).data,updateContractor:async(n,e)=>(await Ie.put(`/contractors/${n}`,e)).data,deleteContractor:async n=>{await Ie.delete(`/contractors/${n}`)}},mr={getAllContractors:async()=>Te()?(console.log("[contractorService] Using Firestore"),uo.getAllContractors()):(console.log("[contractorService] Using Railway API"),ka.getAllContractors()),getContractorById:async n=>{if(Te()){const e=await uo.getContractorById(n);if(!e)throw new Error("Contractor not found");return e}return ka.getContractorById(n)},createContractor:async n=>Te()?uo.createContractor(n):ka.createContractor(n),updateContractor:async(n,e)=>Te()?uo.updateContractor(n,e):ka.updateContractor(n,e),deleteContractor:async n=>Te()?uo.deleteContractor(n):ka.deleteContractor(n),subscribeToContractors:uo.subscribeToContractors},mo="construction_payments",Aa=n=>{const e=n.data(),t=(e.payments||[]).map(r=>({types:r.types||[],amount:r.amount||0,date:r.date instanceof be?r.date.toDate().toISOString():r.date||"",method:r.method||"",notes:r.notes||""})),s={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(s.contract=e.expectedPaymentDates.contract instanceof be?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(s.start=e.expectedPaymentDates.start instanceof be?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(s.middle=e.expectedPaymentDates.middle instanceof be?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(s.final=e.expectedPaymentDates.final instanceof be?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:n.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:t,expectedPaymentDates:s,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},fo={getAllConstructionPayments:async()=>{const n=kt(Je(fe,mo),Jt("createdAt","desc"));return(await Ot(n)).docs.map(Aa)},getConstructionPaymentById:async n=>{const e=Ke(fe,mo,n),t=await Zt(e);return t.exists()?Aa(t):null},createConstructionPayment:async n=>{const e=be.now(),t=(n.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?be.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),s={};n.expectedPaymentDates&&(n.expectedPaymentDates.contract&&(s.contract=n.expectedPaymentDates.contract instanceof Date?be.fromDate(n.expectedPaymentDates.contract):n.expectedPaymentDates.contract),n.expectedPaymentDates.start&&(s.start=n.expectedPaymentDates.start instanceof Date?be.fromDate(n.expectedPaymentDates.start):n.expectedPaymentDates.start),n.expectedPaymentDates.middle&&(s.middle=n.expectedPaymentDates.middle instanceof Date?be.fromDate(n.expectedPaymentDates.middle):n.expectedPaymentDates.middle),n.expectedPaymentDates.final&&(s.final=n.expectedPaymentDates.final instanceof Date?be.fromDate(n.expectedPaymentDates.final):n.expectedPaymentDates.final));const r={project:n.project,client:n.client,totalAmount:n.totalAmount,vatType:n.vatType,vatPercentage:n.vatPercentage,vatAmount:n.vatAmount,payments:t,expectedPaymentDates:s,createdAt:e,updatedAt:e},i=await Zs(Je(fe,mo),r),o=await Zt(i);return Aa(o)},updateConstructionPayment:async(n,e)=>{const t=Ke(fe,mo,n),s={updatedAt:be.now()};if(e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.totalAmount!==void 0&&(s.totalAmount=e.totalAmount),e.vatType!==void 0&&(s.vatType=e.vatType),e.vatPercentage!==void 0&&(s.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(s.vatAmount=e.vatAmount),e.payments!==void 0&&(s.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?be.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?be.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?be.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?be.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?be.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),s.expectedPaymentDates=i}await Ln(t,s);const r=await Zt(t);return Aa(r)},deleteConstructionPayment:async n=>{const e=Ke(fe,mo,n);await ns(e)},subscribeToConstructionPayments:n=>{const e=kt(Je(fe,mo),Jt("createdAt","desc"));return ks(e,t=>{const s=t.docs.map(Aa);n(s)})}},Ea={getAllConstructionPayments:async()=>(await Ie.get("/construction-payments")).data,getConstructionPaymentById:async n=>(await Ie.get(`/construction-payments/${n}`)).data,createConstructionPayment:async n=>(await Ie.post("/construction-payments",n)).data,updateConstructionPayment:async(n,e)=>(await Ie.put(`/construction-payments/${n}`,e)).data,deleteConstructionPayment:async n=>{await Ie.delete(`/construction-payments/${n}`)}},ec={getAllConstructionPayments:async()=>Te()?(console.log("[constructionPaymentService] Using Firestore"),fo.getAllConstructionPayments()):(console.log("[constructionPaymentService] Using Railway API"),Ea.getAllConstructionPayments()),getConstructionPaymentById:async n=>{if(Te()){const e=await fo.getConstructionPaymentById(n);if(!e)throw new Error("Construction payment not found");return e}return Ea.getConstructionPaymentById(n)},createConstructionPayment:async n=>Te()?fo.createConstructionPayment(n):Ea.createConstructionPayment(n),updateConstructionPayment:async(n,e)=>Te()?fo.updateConstructionPayment(n,e):Ea.updateConstructionPayment(n,e),deleteConstructionPayment:async n=>Te()?fo.deleteConstructionPayment(n):Ea.deleteConstructionPayment(n),subscribeToConstructionPayments:fo.subscribeToConstructionPayments};let Vc=new Map,Va=null;async function FC(){if(!(Vc.size>0))return Va||(Va=(async()=>{try{const n=Je(fe,Ft.PROJECTS);(await Ot(n)).docs.forEach(t=>{const s=t.data(),r=parseInt(t.id);!isNaN(r)&&s.name&&Vc.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",Vc.size,"")}catch(n){throw console.error("[executionRecordFirestoreService]    :",n),Va=null,n}})(),Va)}function po(n){return{id:n.id,project_id:n.projectId,project_name:n.projectName||"",author:n.author||"",date:n.date||"",process:n.process||"",item_name:n.itemName||"",material_cost:n.materialCost||0,labor_cost:n.laborCost||0,vat_amount:n.vatAmount||0,total_amount:n.totalAmount||0,notes:n.notes||"",images:n.images||[],payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,created_at:n.createdAt||"",updated_at:n.updatedAt||""}}function gg(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.project_name!==void 0&&(e.projectName=n.project_name),n.projectName!==void 0&&(e.projectName=n.projectName),n.author!==void 0&&(e.author=n.author),n.date!==void 0&&(e.date=n.date),n.process!==void 0&&(e.process=n.process),n.item_name!==void 0&&(e.itemName=n.item_name),n.itemName!==void 0&&(e.itemName=n.itemName),n.material_cost!==void 0&&(e.materialCost=n.material_cost),n.materialCost!==void 0&&(e.materialCost=n.materialCost),n.labor_cost!==void 0&&(e.laborCost=n.labor_cost),n.laborCost!==void 0&&(e.laborCost=n.laborCost),n.vat_amount!==void 0&&(e.vatAmount=n.vat_amount),n.vatAmount!==void 0&&(e.vatAmount=n.vatAmount),n.total_amount!==void 0&&(e.totalAmount=n.total_amount),n.totalAmount!==void 0&&(e.totalAmount=n.totalAmount),n.notes!==void 0&&(e.notes=n.notes),n.images!==void 0&&(e.images=n.images),n.payment_id!==void 0&&(e.paymentId=n.payment_id),n.paymentId!==void 0&&(e.paymentId=n.paymentId),n.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=n.includes_tax_deduction===!0||n.includes_tax_deduction===1),n.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=n.includesTaxDeduction),n.includes_vat!==void 0&&(e.includesVAT=n.includes_vat===!0||n.includes_vat===1),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),e}const cr={getAllRecords:async()=>{const n=Je(fe,Ft.EXECUTION_RECORDS),e=kt(n,Jt("id","desc"));return(await Ot(e)).docs.map(s=>{const r=s.data();return po({...r,id:parseInt(s.id)||r.id})})},getRecordById:async n=>{const e=Ke(fe,Ft.EXECUTION_RECORDS,n),t=await Zt(e);if(t.exists()){const s=t.data();return po({...s,id:parseInt(t.id)||s.id})}return null},createRecord:async n=>{var f;await FC();const e=Je(fe,Ft.EXECUTION_RECORDS),t=await Ot(e);let s=0;t.docs.forEach(p=>{const y=parseInt(p.id);!isNaN(y)&&y>s&&(s=y)});const r=s+1,i=gg(n),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const p=Vc.get(u);p?(l=p,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:i.images||[],imageCount:((f=i.images)==null?void 0:f.length)||0},d=Ke(fe,Ft.EXECUTION_RECORDS,String(r));return await Bu(d,m),po(m)},updateRecord:async(n,e)=>{const t=Ke(fe,Ft.EXECUTION_RECORDS,n),s=gg(e);await Ln(t,{...s,updatedAt:new Date().toISOString()});const r=await cr.getRecordById(n);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async n=>{const e=Ke(fe,Ft.EXECUTION_RECORDS,n);await ns(e)},subscribeToRecords:n=>{const e=Je(fe,Ft.EXECUTION_RECORDS),t=kt(e,Jt("id","desc"));return ks(t,s=>{const r=s.docs.map(i=>{const o=i.data();return po({...o,id:parseInt(i.id)||o.id})});n(r)})},getRecordsByProject:async n=>{const e=Je(fe,Ft.EXECUTION_RECORDS),t=kt(e,zn("projectId","==",n),Jt("id","desc"));return(await Ot(t)).docs.map(r=>{const i=r.data();return po({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async n=>{const e=Je(fe,Ft.EXECUTION_RECORDS),t=kt(e,zn("paymentId","==",n)),s=await Ot(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return po({...i,id:parseInt(r.id)||i.id})}},wa={getAllRecords:async()=>(await Ie.get("/execution-records")).data,getRecordById:async n=>(await Ie.get(`/execution-records/${n}`)).data,createRecord:async n=>(console.log("[executionRecordService.createRecord] Creating:",n),(await Ie.post("/execution-records",n)).data),updateRecord:async(n,e)=>(await Ie.put(`/execution-records/${n}`,e)).data,deleteRecord:async n=>{await Ie.delete(`/execution-records/${n}`)}},tc={getAllRecords:async()=>Te()?(console.log("[executionRecordService] Using Firestore"),cr.getAllRecords()):(console.log("[executionRecordService] Using Railway API"),wa.getAllRecords()),getRecordById:async n=>{if(Te()){const e=await cr.getRecordById(n);if(!e)throw new Error("Execution record not found");return e}return wa.getRecordById(n)},createRecord:async n=>Te()?cr.createRecord(n):wa.createRecord(n),updateRecord:async(n,e)=>Te()?cr.updateRecord(n,e):wa.updateRecord(n,e),deleteRecord:async n=>Te()?cr.deleteRecord(n):wa.deleteRecord(n),subscribeToRecords:cr.subscribeToRecords,getRecordsByProject:cr.getRecordsByProject,getRecordByPaymentId:cr.getRecordByPaymentId},Xr=Ed()(k0((n,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>n({projects:t}),addProject:t=>n(s=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(t,s)=>n(r=>({projects:r.projects.map(i=>i.id===t?{...i,...s}:i)})),deleteProject:t=>n(s=>({projects:s.projects.filter(r=>r.id!==t),constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>n({schedules:t}),addSchedule:t=>n(s=>({schedules:[t,...s.schedules]})),updateSchedule:(t,s)=>n(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...s}:i)})),deleteSchedule:t=>n(s=>({schedules:s.schedules.filter(r=>r.id!==t)})),setPayments:t=>n({payments:t}),addPayment:t=>n(s=>({payments:[t,...s.payments]})),updatePayment:(t,s)=>n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)})),deletePayment:t=>n(s=>({payments:s.payments.filter(r=>r.id!==t)})),setContractors:t=>n({contractors:t}),addContractor:t=>n(s=>({contractors:[t,...s.contractors]})),updateContractor:(t,s)=>n(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...s}:i)})),deleteContractor:t=>n(s=>({contractors:s.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>n({constructionPayments:t}),addConstructionPayment:t=>n(s=>({constructionPayments:[t,...s.constructionPayments]})),updateConstructionPayment:(t,s)=>n(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...s}:i)})),deleteConstructionPayment:t=>n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>n({asRequests:t}),addASRequest:t=>n(s=>({asRequests:[t,...s.asRequests]})),updateASRequest:(t,s)=>n(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...s}:i)})),deleteASRequest:t=>n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>n({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),n(s=>{const r=[t,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,s)=>n(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...s}:i)})),deleteExecutionRecord:t=>n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await Ps.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const s=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const p=JSON.parse(d.images);return Array.isArray(p)?p:[]}catch(p){return console.error("  :",p),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(s.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(C=>C.id)),f=s.filter(C=>!d.has(C.id)),y=[...m.map(C=>({...C,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),n({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),n({payments:s})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const s=`temp_${Date.now()}`,r={...t,id:s,_addedAt:Date.now(),_tempId:s};n(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await Ps.createPayment(u),d=String(m.id);return n(f=>({payments:f.payments.map(p=>p._tempId===s?{...p,id:d,_addedAt:Date.now()}:p)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),n(o=>({payments:o.payments.filter(l=>l._tempId!==s)})),i}},updatePaymentInAPI:async(t,s)=>{try{if(s.status&&Object.keys(s).length===1)await Ps.updatePaymentStatus(t,s.status);else{let r=s.project;if(s.project){const o=e().projects.find(l=>l.name===s.project);r=o?o.id:s.project}await Ps.updatePayment(t,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await Ps.deletePayment(t),n(s=>({payments:s.payments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const t=await Zl.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const s=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),n({schedules:s})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const s=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:s};n(l=>({schedules:[...l.schedules,r]}));try{const l=await Zl.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};n(f=>({schedules:f.schedules.map(p=>p.id===s?d:p)}))}catch(l){throw console.error("Failed to add schedule to API:",l),n(u=>({schedules:u.schedules.filter(m=>m.id!==s)})),l}},updateScheduleInAPI:async(t,s)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:s});const l={};s.project!==void 0&&(l.project=s.project),s.title!==void 0&&(l.title=s.title),s.type!==void 0&&(l.type=s.type),s.start!==void 0&&(l.startDate=s.start),s.end!==void 0&&(l.endDate=s.end),s.location!==void 0&&(l.location=s.location),s.description!==void 0&&(l.description=s.description),s.attendees!==void 0&&(l.assignedTo=s.attendees),s.time!==void 0&&(l.time=s.time),console.log(" Sending update data:",l);const u=await Zl.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};n(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:s}=e(),r=s.find(o=>o.id===t);if(r){n(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await Zl.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&n(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const s=(await Ao.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});n({projects:s})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var s,r;try{const i=await Ao.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};n(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,s)=>{var r,i;try{const o=await Ao.updateProject(t,s),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};n(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await Ao.deleteProject(t),n(s=>({projects:s.projects.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await mr.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));n({contractors:s})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const s=await mr.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};n(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(t,s)=>{try{const r=await mr.updateContractor(t,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};n(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await mr.deleteContractor(t),n(s=>({contractors:s.contractors.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await ec.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});n({constructionPayments:s})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var s;try{const r=await ec.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};n(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,s)=>{var r;try{const i=await ec.updateConstructionPayment(t,s);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};n(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await ec.deleteConstructionPayment(t),n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await Ma.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));n({asRequests:s})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const s=await Ma.createASRequest(t),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return n(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(t,s)=>{try{const r=await Ma.updateASRequest(t,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};n(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Ma.deleteASRequest(t),n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const t=await tc.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const s=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));n({executionRecords:s})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const s=await tc.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),n(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(t,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await tc.updateRecord(t,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),n(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...s,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await tc.deleteRecord(t),n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:n=>({...n,payments:n.payments.map(e=>{const{images:t,...s}=e;return s}),executionRecords:n.executionRecords.map(e=>{const{images:t,...s}=e;return s})}),storage:{getItem:n=>{var u,m,d,f,p,y,C;const e=localStorage.getItem(n);if(!e)return null;const{state:t}=JSON.parse(e),s=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var w;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((w=v.payments)==null?void 0:w.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:s,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((p=t.contractors)==null?void 0:p.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((C=t.executionRecords)==null?void 0:C.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(n,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(n,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:n=>localStorage.removeItem(n)}}));var Sl=n=>n.type==="checkbox",ki=n=>n instanceof Date,ts=n=>n==null;const E0=n=>typeof n=="object";var wn=n=>!ts(n)&&!Array.isArray(n)&&E0(n)&&!ki(n),OC=n=>wn(n)&&n.target?Sl(n.target)?n.target.checked:n.target.value:n,qC=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,$C=(n,e)=>n.has(qC(e)),zC=n=>{const e=n.constructor&&n.constructor.prototype;return wn(e)&&e.hasOwnProperty("isPrototypeOf")},Rf=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Un(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(Rf&&(n instanceof Blob||s))&&(t||wn(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!zC(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=Un(n[r]));else return n;return e}var Hu=n=>/^\w*$/.test(n),Dn=n=>n===void 0,Bf=n=>Array.isArray(n)?n.filter(Boolean):[],Uf=n=>Bf(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Ue=(n,e,t)=>{if(!e||!wn(n))return t;const s=(Hu(e)?[e]:Uf(e)).reduce((r,i)=>ts(r)?r:r[i],n);return Dn(s)||s===n?Dn(n[e])?t:n[e]:s},Ws=n=>typeof n=="boolean",an=(n,e,t)=>{let s=-1;const r=Hu(e)?[e]:Uf(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let u=t;if(s!==o){const m=n[l];u=wn(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=u,n=n[l]}};const yg={BLUR:"blur",FOCUS_OUT:"focusout"},Ls={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ar={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},WC=ft.createContext(null);WC.displayName="HookFormContext";var KC=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Ls.all&&(e._proxyFormState[o]=!s||Ls.all),n[o]}});return r};const GC=typeof window<"u"?ft.useLayoutEffect:ft.useEffect;var fs=n=>typeof n=="string",QC=(n,e,t,s,r)=>fs(n)?(s&&e.watch.add(n),Ue(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),Ue(t,i))):(s&&(e.watchAll=!0),t),Nd=n=>ts(n)||!E0(n);function Ur(n,e,t=new WeakSet){if(Nd(n)||Nd(e))return n===e;if(ki(n)&&ki(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ki(o)&&ki(l)||wn(o)&&wn(l)||Array.isArray(o)&&Array.isArray(l)?!Ur(o,l,t):o!==l)return!1}}return!0}var YC=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},Ja=n=>Array.isArray(n)?n:[n],bg=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function V0(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&wn(r)&&i){const o=V0(r,i);wn(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var ls=n=>wn(n)&&!Object.keys(n).length,Hf=n=>n.type==="file",js=n=>typeof n=="function",tu=n=>{if(!Rf)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},w0=n=>n.type==="select-multiple",Mf=n=>n.type==="radio",XC=n=>Mf(n)||Sl(n),Am=n=>tu(n)&&n.isConnected;function JC(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=Dn(n)?s++:n[e[s++]];return n}function ZC(n){for(const e in n)if(n.hasOwnProperty(e)&&!Dn(n[e]))return!1;return!0}function vn(n,e){const t=Array.isArray(e)?e:Hu(e)?[e]:Uf(e),s=t.length===1?n:JC(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(wn(s)&&ls(s)||Array.isArray(s)&&ZC(s))&&vn(n,t.slice(0,-1)),n}var e1=n=>{for(const e in n)if(js(n[e]))return!0;return!1};function C0(n){return Array.isArray(n)||wn(n)&&!e1(n)}function xd(n,e={}){for(const t in n)C0(n[t])?(e[t]=Array.isArray(n[t])?[]:{},xd(n[t],e[t])):ts(n[t])||(e[t]=!0);return e}function ko(n,e,t){t||(t=xd(e));for(const s in n)C0(n[s])?Dn(e)||Nd(t[s])?t[s]=xd(n[s],Array.isArray(n[s])?[]:{}):ko(n[s],ts(e)?{}:e[s],t[s]):t[s]=!Ur(n[s],e[s]);return t}const Ng={value:!1,isValid:!1},xg={value:!0,isValid:!0};var I0=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Dn(n[0].attributes.value)?Dn(n[0].value)||n[0].value===""?xg:{value:n[0].value,isValid:!0}:xg:Ng}return Ng},S0=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>Dn(n)?n:e?n===""?NaN:n&&+n:t&&fs(n)?new Date(n):s?s(n):n;const vg={isValid:!1,value:null};var T0=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,vg):vg;function _g(n){const e=n.ref;return Hf(e)?e.files:Mf(e)?T0(n.refs).value:w0(e)?[...e.selectedOptions].map(({value:t})=>t):Sl(e)?I0(n.refs).value:S0(Dn(e.value)?n.ref.value:e.value,n)}var t1=(n,e,t,s)=>{const r={};for(const i of n){const o=Ue(e,i);o&&an(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},nu=n=>n instanceof RegExp,Ca=n=>Dn(n)?n:nu(n)?n.source:wn(n)?nu(n.value)?n.value.source:n.value:n,Dg=n=>({isOnSubmit:!n||n===Ls.onSubmit,isOnBlur:n===Ls.onBlur,isOnChange:n===Ls.onChange,isOnAll:n===Ls.all,isOnTouch:n===Ls.onTouched});const kg="AsyncFunction";var n1=n=>!!n&&!!n.validate&&!!(js(n.validate)&&n.validate.constructor.name===kg||wn(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===kg)),s1=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),Ag=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const Za=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=Ue(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(Za(l,e))break}else if(wn(l)&&Za(l,e))break}}};function Eg(n,e,t){const s=Ue(n,t);if(s||Hu(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Ue(e,i),l=Ue(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var r1=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return ls(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||Ls.all))},i1=(n,e,t)=>!n||!e||n===e||Ja(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),o1=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,a1=(n,e)=>!Bf(Ue(n,e)).length&&vn(n,e),l1=(n,e,t)=>{const s=Ja(Ue(n,t));return an(s,"root",e[t]),an(n,t,s),n};function Vg(n,e,t="validate"){if(fs(n)||Array.isArray(n)&&n.every(fs)||Ws(n)&&!n)return{type:t,message:fs(n)?n:"",ref:e}}var ho=n=>wn(n)&&!nu(n)?n:{value:n,message:""},wg=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:p,pattern:y,validate:C,name:v,valueAsNumber:w,mount:B}=n._f,T=Ue(t,v);if(!B||e.has(v))return{};const F=l?l[0]:o,re=I=>{r&&F.reportValidity&&(F.setCustomValidity(Ws(I)?"":I||""),F.reportValidity())},ee={},M=Mf(o),E=Sl(o),N=M||E,V=(w||Hf(o))&&Dn(o.value)&&Dn(T)||tu(o)&&o.value===""||T===""||Array.isArray(T)&&!T.length,j=YC.bind(null,v,s,ee),S=(I,k,Ae,$e=ar.maxLength,ge=ar.minLength)=>{const He=I?k:Ae;ee[v]={type:I?$e:ge,message:He,ref:o,...j(I?$e:ge,He)}};if(i?!Array.isArray(T)||!T.length:u&&(!N&&(V||ts(T))||Ws(T)&&!T||E&&!I0(l).isValid||M&&!T0(l).isValid)){const{value:I,message:k}=fs(u)?{value:!!u,message:u}:ho(u);if(I&&(ee[v]={type:ar.required,message:k,ref:F,...j(ar.required,k)},!s))return re(k),ee}if(!V&&(!ts(f)||!ts(p))){let I,k;const Ae=ho(p),$e=ho(f);if(!ts(T)&&!isNaN(T)){const ge=o.valueAsNumber||T&&+T;ts(Ae.value)||(I=ge>Ae.value),ts($e.value)||(k=ge<$e.value)}else{const ge=o.valueAsDate||new Date(T),He=qt=>new Date(new Date().toDateString()+" "+qt),yt=o.type=="time",Kt=o.type=="week";fs(Ae.value)&&T&&(I=yt?He(T)>He(Ae.value):Kt?T>Ae.value:ge>new Date(Ae.value)),fs($e.value)&&T&&(k=yt?He(T)<He($e.value):Kt?T<$e.value:ge<new Date($e.value))}if((I||k)&&(S(!!I,Ae.message,$e.message,ar.max,ar.min),!s))return re(ee[v].message),ee}if((m||d)&&!V&&(fs(T)||i&&Array.isArray(T))){const I=ho(m),k=ho(d),Ae=!ts(I.value)&&T.length>+I.value,$e=!ts(k.value)&&T.length<+k.value;if((Ae||$e)&&(S(Ae,I.message,k.message),!s))return re(ee[v].message),ee}if(y&&!V&&fs(T)){const{value:I,message:k}=ho(y);if(nu(I)&&!T.match(I)&&(ee[v]={type:ar.pattern,message:k,ref:o,...j(ar.pattern,k)},!s))return re(k),ee}if(C){if(js(C)){const I=await C(T,t),k=Vg(I,F);if(k&&(ee[v]={...k,...j(ar.validate,k.message)},!s))return re(k.message),ee}else if(wn(C)){let I={};for(const k in C){if(!ls(I)&&!s)break;const Ae=Vg(await C[k](T,t),F,k);Ae&&(I={...Ae,...j(k,Ae.message)},re(Ae.message),s&&(ee[v]=I))}if(!ls(I)&&(ee[v]={ref:F,...I},!s))return ee}}return re(!0),ee};const c1={mode:Ls.onSubmit,reValidateMode:Ls.onChange,shouldFocusError:!0};function u1(n={}){let e={...c1,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:js(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=wn(e.defaultValues)||wn(e.values)?Un(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Un(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const p={array:bg(),state:bg()},y=e.criteriaMode===Ls.all,C=P=>q=>{clearTimeout(m),m=setTimeout(P,q)},v=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const q=e.resolver?ls((await E()).errors):await V(s,!0);q!==t.isValid&&p.state.next({isValid:q})}},w=(P,q)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(te=>{te&&(q?an(t.validatingFields,te,q):vn(t.validatingFields,te))}),p.state.next({validatingFields:t.validatingFields,isValidating:!ls(t.validatingFields)}))},B=(P,q=[],te,xe,ce=!0,de=!0)=>{if(xe&&te&&!e.disabled){if(o.action=!0,de&&Array.isArray(Ue(s,P))){const Se=te(Ue(s,P),xe.argA,xe.argB);ce&&an(s,P,Se)}if(de&&Array.isArray(Ue(t.errors,P))){const Se=te(Ue(t.errors,P),xe.argA,xe.argB);ce&&an(t.errors,P,Se),a1(t.errors,P)}if((d.touchedFields||f.touchedFields)&&de&&Array.isArray(Ue(t.touchedFields,P))){const Se=te(Ue(t.touchedFields,P),xe.argA,xe.argB);ce&&an(t.touchedFields,P,Se)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=ko(r,i)),p.state.next({name:P,isDirty:S(P,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else an(i,P,q)},T=(P,q)=>{an(t.errors,P,q),p.state.next({errors:t.errors})},F=P=>{t.errors=P,p.state.next({errors:t.errors,isValid:!1})},re=(P,q,te,xe)=>{const ce=Ue(s,P);if(ce){const de=Ue(i,P,Dn(te)?Ue(r,P):te);Dn(de)||xe&&xe.defaultChecked||q?an(i,P,q?de:_g(ce._f)):Ae(P,de),o.mount&&v()}},ee=(P,q,te,xe,ce)=>{let de=!1,Se=!1;const We={name:P};if(!e.disabled){if(!te||xe){(d.isDirty||f.isDirty)&&(Se=t.isDirty,t.isDirty=We.isDirty=S(),de=Se!==We.isDirty);const st=Ur(Ue(r,P),q);Se=!!Ue(t.dirtyFields,P),st?vn(t.dirtyFields,P):an(t.dirtyFields,P,!0),We.dirtyFields=t.dirtyFields,de=de||(d.dirtyFields||f.dirtyFields)&&Se!==!st}if(te){const st=Ue(t.touchedFields,P);st||(an(t.touchedFields,P,te),We.touchedFields=t.touchedFields,de=de||(d.touchedFields||f.touchedFields)&&st!==te)}de&&ce&&p.state.next(We)}return de?We:{}},M=(P,q,te,xe)=>{const ce=Ue(t.errors,P),de=(d.isValid||f.isValid)&&Ws(q)&&t.isValid!==q;if(e.delayError&&te?(u=C(()=>T(P,te)),u(e.delayError)):(clearTimeout(m),u=null,te?an(t.errors,P,te):vn(t.errors,P)),(te?!Ur(ce,te):ce)||!ls(xe)||de){const Se={...xe,...de&&Ws(q)?{isValid:q}:{},errors:t.errors,name:P};t={...t,...Se},p.state.next(Se)}},E=async P=>{w(P,!0);const q=await e.resolver(i,e.context,t1(P||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return w(P),q},N=async P=>{const{errors:q}=await E(P);if(P)for(const te of P){const xe=Ue(q,te);xe?an(t.errors,te,xe):vn(t.errors,te)}else t.errors=q;return q},V=async(P,q,te={valid:!0})=>{for(const xe in P){const ce=P[xe];if(ce){const{_f:de,...Se}=ce;if(de){const We=l.array.has(de.name),st=ce._f&&n1(ce._f);st&&d.validatingFields&&w([de.name],!0);const Ee=await wg(ce,l.disabled,i,y,e.shouldUseNativeValidation&&!q,We);if(st&&d.validatingFields&&w([de.name]),Ee[de.name]&&(te.valid=!1,q))break;!q&&(Ue(Ee,de.name)?We?l1(t.errors,Ee,de.name):an(t.errors,de.name,Ee[de.name]):vn(t.errors,de.name))}!ls(Se)&&await V(Se,q,te)}}return te.valid},j=()=>{for(const P of l.unMount){const q=Ue(s,P);q&&(q._f.refs?q._f.refs.every(te=>!Am(te)):!Am(q._f.ref))&&ut(P)}l.unMount=new Set},S=(P,q)=>!e.disabled&&(P&&q&&an(i,P,q),!Ur(qt(),r)),I=(P,q,te)=>QC(P,l,{...o.mount?i:Dn(q)?r:fs(P)?{[P]:q}:q},te,q),k=P=>Bf(Ue(o.mount?i:r,P,e.shouldUnregister?Ue(r,P,[]):[])),Ae=(P,q,te={})=>{const xe=Ue(s,P);let ce=q;if(xe){const de=xe._f;de&&(!de.disabled&&an(i,P,S0(q,de)),ce=tu(de.ref)&&ts(q)?"":q,w0(de.ref)?[...de.ref.options].forEach(Se=>Se.selected=ce.includes(Se.value)):de.refs?Sl(de.ref)?de.refs.forEach(Se=>{(!Se.defaultChecked||!Se.disabled)&&(Array.isArray(ce)?Se.checked=!!ce.find(We=>We===Se.value):Se.checked=ce===Se.value||!!ce)}):de.refs.forEach(Se=>Se.checked=Se.value===ce):Hf(de.ref)?de.ref.value="":(de.ref.value=ce,de.ref.type||p.state.next({name:P,values:Un(i)})))}(te.shouldDirty||te.shouldTouch)&&ee(P,ce,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&Kt(P)},$e=(P,q,te)=>{for(const xe in q){if(!q.hasOwnProperty(xe))return;const ce=q[xe],de=P+"."+xe,Se=Ue(s,de);(l.array.has(P)||wn(ce)||Se&&!Se._f)&&!ki(ce)?$e(de,ce,te):Ae(de,ce,te)}},ge=(P,q,te={})=>{const xe=Ue(s,P),ce=l.array.has(P),de=Un(q);an(i,P,de),ce?(p.array.next({name:P,values:Un(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&te.shouldDirty&&p.state.next({name:P,dirtyFields:ko(r,i),isDirty:S(P,de)})):xe&&!xe._f&&!ts(de)?$e(P,de,te):Ae(P,de,te),Ag(P,l)&&p.state.next({...t,name:P}),p.state.next({name:o.mount?P:void 0,values:Un(i)})},He=async P=>{o.mount=!0;const q=P.target;let te=q.name,xe=!0;const ce=Ue(s,te),de=st=>{xe=Number.isNaN(st)||ki(st)&&isNaN(st.getTime())||Ur(st,Ue(i,te,st))},Se=Dg(e.mode),We=Dg(e.reValidateMode);if(ce){let st,Ee;const Mn=q.type?_g(ce._f):OC(P),Ht=P.type===yg.BLUR||P.type===yg.FOCUS_OUT,ne=!s1(ce._f)&&!e.resolver&&!Ue(t.errors,te)&&!ce._f.deps||o1(Ht,Ue(t.touchedFields,te),t.isSubmitted,We,Se),et=Ag(te,l,Ht);an(i,te,Mn),Ht?(!q||!q.readOnly)&&(ce._f.onBlur&&ce._f.onBlur(P),u&&u(0)):ce._f.onChange&&ce._f.onChange(P);const O=ee(te,Mn,Ht),ve=!ls(O)||et;if(!Ht&&p.state.next({name:te,type:P.type,values:Un(i)}),ne)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?Ht&&v():Ht||v()),ve&&p.state.next({name:te,...et?{}:O});if(!Ht&&et&&p.state.next({...t}),e.resolver){const{errors:ke}=await E([te]);if(de(Mn),xe){const Re=Eg(t.errors,s,te),ue=Eg(ke,s,Re.name||te);st=ue.error,te=ue.name,Ee=ls(ke)}}else w([te],!0),st=(await wg(ce,l.disabled,i,y,e.shouldUseNativeValidation))[te],w([te]),de(Mn),xe&&(st?Ee=!1:(d.isValid||f.isValid)&&(Ee=await V(s,!0)));xe&&(ce._f.deps&&(!Array.isArray(ce._f.deps)||ce._f.deps.length>0)&&Kt(ce._f.deps),M(te,Ee,st,O))}},yt=(P,q)=>{if(Ue(t.errors,q)&&P.focus)return P.focus(),1},Kt=async(P,q={})=>{let te,xe;const ce=Ja(P);if(e.resolver){const de=await N(Dn(P)?P:ce);te=ls(de),xe=P?!ce.some(Se=>Ue(de,Se)):te}else P?(xe=(await Promise.all(ce.map(async de=>{const Se=Ue(s,de);return await V(Se&&Se._f?{[de]:Se}:Se)}))).every(Boolean),!(!xe&&!t.isValid)&&v()):xe=te=await V(s);return p.state.next({...!fs(P)||(d.isValid||f.isValid)&&te!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:te}:{},errors:t.errors}),q.shouldFocus&&!xe&&Za(s,yt,P?ce:l.mount),xe},qt=(P,q)=>{let te={...o.mount?i:r};return q&&(te=V0(q.dirtyFields?t.dirtyFields:t.touchedFields,te)),Dn(P)?te:fs(P)?Ue(te,P):P.map(xe=>Ue(te,xe))},ae=(P,q)=>({invalid:!!Ue((q||t).errors,P),isDirty:!!Ue((q||t).dirtyFields,P),error:Ue((q||t).errors,P),isValidating:!!Ue(t.validatingFields,P),isTouched:!!Ue((q||t).touchedFields,P)}),ze=P=>{P&&Ja(P).forEach(q=>vn(t.errors,q)),p.state.next({errors:P?t.errors:{}})},me=(P,q,te)=>{const xe=(Ue(s,P,{_f:{}})._f||{}).ref,ce=Ue(t.errors,P)||{},{ref:de,message:Se,type:We,...st}=ce;an(t.errors,P,{...st,...q,ref:xe}),p.state.next({name:P,errors:t.errors,isValid:!1}),te&&te.shouldFocus&&xe&&xe.focus&&xe.focus()},Be=(P,q)=>js(P)?p.state.subscribe({next:te=>"values"in te&&P(I(void 0,q),te)}):I(P,q,!0),Xe=P=>p.state.subscribe({next:q=>{i1(P.name,q.name,P.exact)&&r1(q,P.formState||d,Pt,P.reRenderRoot)&&P.callback({values:{...i},...t,...q,defaultValues:r})}}).unsubscribe,Dt=P=>(o.mount=!0,f={...f,...P.formState},Xe({...P,formState:f})),ut=(P,q={})=>{for(const te of P?Ja(P):l.mount)l.mount.delete(te),l.array.delete(te),q.keepValue||(vn(s,te),vn(i,te)),!q.keepError&&vn(t.errors,te),!q.keepDirty&&vn(t.dirtyFields,te),!q.keepTouched&&vn(t.touchedFields,te),!q.keepIsValidating&&vn(t.validatingFields,te),!e.shouldUnregister&&!q.keepDefaultValue&&vn(r,te);p.state.next({values:Un(i)}),p.state.next({...t,...q.keepDirty?{isDirty:S()}:{}}),!q.keepIsValid&&v()},Tt=({disabled:P,name:q})=>{(Ws(P)&&o.mount||P||l.disabled.has(q))&&(P?l.disabled.add(q):l.disabled.delete(q))},ct=(P,q={})=>{let te=Ue(s,P);const xe=Ws(q.disabled)||Ws(e.disabled);return an(s,P,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:P}},name:P,mount:!0,...q}}),l.mount.add(P),te?Tt({disabled:Ws(q.disabled)?q.disabled:e.disabled,name:P}):re(P,!0,q.value),{...xe?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Ca(q.min),max:Ca(q.max),minLength:Ca(q.minLength),maxLength:Ca(q.maxLength),pattern:Ca(q.pattern)}:{},name:P,onChange:He,onBlur:He,ref:ce=>{if(ce){ct(P,q),te=Ue(s,P);const de=Dn(ce.value)&&ce.querySelectorAll&&ce.querySelectorAll("input,select,textarea")[0]||ce,Se=XC(de),We=te._f.refs||[];if(Se?We.find(st=>st===de):de===te._f.ref)return;an(s,P,{_f:{...te._f,...Se?{refs:[...We.filter(Am),de,...Array.isArray(Ue(r,P))?[{}]:[]],ref:{type:de.type,name:P}}:{ref:de}}}),re(P,!1,void 0,de)}else te=Ue(s,P,{}),te._f&&(te._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!($C(l.array,P)&&o.action)&&l.unMount.add(P)}}},ht=()=>e.shouldFocusError&&Za(s,yt,l.mount),yn=P=>{Ws(P)&&(p.state.next({disabled:P}),Za(s,(q,te)=>{const xe=Ue(s,te);xe&&(q.disabled=xe._f.disabled||P,Array.isArray(xe._f.refs)&&xe._f.refs.forEach(ce=>{ce.disabled=xe._f.disabled||P}))},0,!1))},K=(P,q)=>async te=>{let xe;te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ce=Un(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:Se}=await E();t.errors=de,ce=Un(Se)}else await V(s);if(l.disabled.size)for(const de of l.disabled)vn(ce,de);if(vn(t.errors,"root"),ls(t.errors)){p.state.next({errors:{}});try{await P(ce,te)}catch(de){xe=de}}else q&&await q({...t.errors},te),ht(),setTimeout(ht);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ls(t.errors)&&!xe,submitCount:t.submitCount+1,errors:t.errors}),xe)throw xe},je=(P,q={})=>{Ue(s,P)&&(Dn(q.defaultValue)?ge(P,Un(Ue(r,P))):(ge(P,q.defaultValue),an(r,P,Un(q.defaultValue))),q.keepTouched||vn(t.touchedFields,P),q.keepDirty||(vn(t.dirtyFields,P),t.isDirty=q.defaultValue?S(P,Un(Ue(r,P))):S()),q.keepError||(vn(t.errors,P),d.isValid&&v()),p.state.next({...t}))},Me=(P,q={})=>{const te=P?Un(P):r,xe=Un(te),ce=ls(P),de=ce?r:xe;if(q.keepDefaultValues||(r=te),!q.keepValues){if(q.keepDirtyValues){const Se=new Set([...l.mount,...Object.keys(ko(r,i))]);for(const We of Array.from(Se))Ue(t.dirtyFields,We)?an(de,We,Ue(i,We)):ge(We,Ue(de,We))}else{if(Rf&&Dn(P))for(const Se of l.mount){const We=Ue(s,Se);if(We&&We._f){const st=Array.isArray(We._f.refs)?We._f.refs[0]:We._f.ref;if(tu(st)){const Ee=st.closest("form");if(Ee){Ee.reset();break}}}}if(q.keepFieldsRef)for(const Se of l.mount)ge(Se,Ue(de,Se));else s={}}i=e.shouldUnregister?q.keepDefaultValues?Un(r):{}:Un(de),p.array.next({values:{...de}}),p.state.next({values:{...de}})}l={mount:q.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!q.keepIsValid||!!q.keepDirtyValues,o.watch=!!e.shouldUnregister,p.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ce?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Ur(P,r)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ce?{}:q.keepDirtyValues?q.keepDefaultValues&&i?ko(r,i):t.dirtyFields:q.keepDefaultValues&&P?ko(r,P):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Pe=(P,q)=>Me(js(P)?P(i):P,q),Ze=(P,q={})=>{const te=Ue(s,P),xe=te&&te._f;if(xe){const ce=xe.refs?xe.refs[0]:xe.ref;ce.focus&&(ce.focus(),q.shouldSelect&&js(ce.select)&&ce.select())}},Pt=P=>{t={...t,...P}},pt={control:{register:ct,unregister:ut,getFieldState:ae,handleSubmit:K,setError:me,_subscribe:Xe,_runSchema:E,_focusError:ht,_getWatch:I,_getDirty:S,_setValid:v,_setFieldArray:B,_setDisabledField:Tt,_setErrors:F,_getFieldArray:k,_reset:Me,_resetDefaultValues:()=>js(e.defaultValues)&&e.defaultValues().then(P=>{Pe(P,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:yn,_subjects:p,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:Dt,trigger:Kt,register:ct,handleSubmit:K,watch:Be,setValue:ge,getValues:qt,reset:Pe,resetField:je,clearErrors:ze,unregister:ut,setError:me,setFocus:Ze,getFieldState:ae};return{...pt,formControl:pt}}function Ff(n={}){const e=ft.useRef(void 0),t=ft.useRef(void 0),[s,r]=ft.useState({isDirty:!1,isValidating:!1,isLoading:js(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:js(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!js(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=u1(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,GC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),ft.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),ft.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),ft.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),ft.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),ft.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),ft.useEffect(()=>{n.values&&!Ur(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),ft.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=KC(s,i),e.current}const Cg=["","","","","","",""],P0=({event:n,slotInfo:e,defaultProjectName:t,onClose:s,onSave:r,onDelete:i})=>{const[o,l]=A.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:p},reset:y}=Ff({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:C}=Xr(),[v,w]=A.useState([]),[B,T]=A.useState(""),[F,re]=A.useState(!1),[ee,M]=A.useState(""),[E,N]=A.useState(9),[V,j]=A.useState(0),[S,I]=A.useState(""),k=f("projectId");A.useEffect(()=>{if(k){const ae=C.find(ze=>ze.id===k||ze.id===parseInt(k)||ze.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,C,v]),A.useEffect(()=>{console.log(" Modal mount - initializing states"),w([]),I(""),T("")},[]),A.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!n,eventId:n==null?void 0:n.id,hasSlotInfo:!!e,hasMergedEvents:!!(n!=null&&n.mergedEventIds)}),n&&n.id){console.log(" ScheduleModal processing event:",{title:n.title,projectId:n.projectId,projectName:n.projectName,start:n.start,assignedTo:n.assignedTo,time:n.time});const ae=n.originalTitle||n.title,ze=/ - (|) \d{1,2}$/,me=ae.replace(ze,"");if(d("title",me,{shouldValidate:!1,shouldDirty:!1}),d("date",$t(n.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",n.description||"",{shouldValidate:!1,shouldDirty:!1}),n.projectId&&n.projectId!==""&&n.projectId!=="undefined")console.log(" Setting projectId from event:",n.projectId),d("projectId",n.projectId,{shouldValidate:!1,shouldDirty:!1}),I("");else if(n.projectName){const Xe=C.find(Dt=>Dt.name===n.projectName);console.log(" Finding project by name:",n.projectName,"found:",Xe),Xe?(console.log(" Setting projectId from found project:",Xe.id),d("projectId",Xe.id,{shouldValidate:!1,shouldDirty:!1}),I("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I("");const Be=n.assignedTo||n.attendees||[];if(console.log(" Setting selectedMembers to:",Be),w(Array.isArray(Be)?Be:[]),n.time&&n.time!=="-"){console.log(" Setting time from event:",{eventTime:n.time,parsedHours:n.time.split(":")[0],parsedMinutes:n.time.split(":")[1]}),re(!0);const[Xe,Dt]=n.time.split(":"),ut=parseInt(Xe,10),Tt=parseInt(Dt,10);ut>=12?(M(""),N(ut===12?12:ut-12)):(M(""),N(ut===0?12:ut)),j(Tt),console.log(" Time state set:",{hasTime:!0,period:ut>=12?"":"",hour:ut>=12?ut===12?12:ut-12:ut===0?12:ut,minute:Tt})}else console.log(" No time in event, setting hasTime to false"),re(!1),M(""),N(9),j(0)}else if(e&&!n&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:$t(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),w([]),I(""),t)){const ae=C.find(ze=>ze.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[n==null?void 0:n.id]);const Ae=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),w(ze=>{console.log(" Previous members in setState:",ze);const me=ze.includes(ae)?ze.filter(Be=>Be!==ae):[...ze,ae];return console.log(" Updated members after toggle:",me),me})},$e=()=>{const ae="HV LAB";v.includes(ae)?w(ze=>ze.filter(me=>me!==ae)):w(ze=>[...ze.filter(me=>me!==""),ae])},ge=()=>{const ae="";v.includes(ae)?w(ze=>ze.filter(me=>me!==ae)):w(ze=>[...ze,ae])},He=()=>{const ae="";v.includes(ae)?w(ze=>ze.filter(me=>me!==ae)):w(ze=>[...ze,ae])},yt=()=>{B.trim()&&!v.includes(B.trim())&&(w(ae=>[...ae,B.trim()]),T(""))},Kt=ae=>{w(ze=>ze.filter(me=>me!==ae))},qt=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",ee,"timeHour:",E,"timeMinute:",V),console.log(" Available projects:",C.map(ct=>({id:ct.id,name:ct.name,idType:typeof ct.id}))),console.log(" Merged event IDs:",n==null?void 0:n.mergedEventIds);const ze=/ - (|) \d{1,2}$/,me=ae.title.replace(ze,"").trim();let Be="",Xe="";if(ae.projectId){const ct=C.find(ht=>ht.id===ae.projectId||ht.id===parseInt(ae.projectId)||ht.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",ct),Be=(ct==null?void 0:ct.name)||"",Xe=ae.projectId}else Be="",Xe="";console.log(" Final projectId:",Xe,"projectName:",Be,"cleanedTitle:",me);const Dt=new Date(ae.date);let ut="-";if(F){let ct=E;ee===""&&E!==12?ct=E+12:ee===""&&E===12&&(ct=0),ut=`${ct.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`,console.log(" Time calculated:",ut)}else console.log(" No time set (hasTime is false)");const Tt={...n,title:me,start:Dt,end:Dt,projectId:Xe,projectName:Be,assignedTo:v,description:ae.description||"",time:ut,mergedEventIds:n==null?void 0:n.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",Tt);try{await r(Tt),console.log(" onSave completed successfully")}catch(ct){throw console.error(" onSave failed:",ct),ct}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(qt),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),C.filter(ae=>n!=null&&n.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),p.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),p.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>re(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:E,onChange:ae=>N(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:V,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:$e,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ge,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:He,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Cg.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>Ae(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!Cg.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>Kt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>T(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),yt())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:yt,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:n&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(n.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(Si,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},vd=n=>{if(!n||n==="-")return"";const[e,t]=n.split(":"),s=parseInt(e,10),r=parseInt(t,10),i=s>=12?"":"",o=s%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},su=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],el=n=>{if(!n)return n;const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of su)if(s===r)return t.slice(0,-1).join(" ").trim()}for(const s of su)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},nc=n=>{const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of su)if(s===r)return r}for(const s of su)if(e.endsWith(s))return s;return""},m1=["","","","","","",""],d1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Em=["","","/","","","","","","","","","","","","",""],f1={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},p1={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Ig=m1,h1=()=>{const{schedules:n,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:s}=Xr(),{user:r}=si(),[i,o]=A.useState(!1),l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Ig.filter(d=>d!==l)]:Ig,m=d=>{const f=n.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),p=v=>{const w=new Set;return v.filter(B=>{const F=`${$t(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return w.has(F)?!1:(w.add(F),!0)})},y=p(f.filter(v=>gp(new Date(v.start)))),C=p(f.filter(v=>pv(new Date(v.start))&&!gp(new Date(v.start))).sort((v,w)=>new Date(v.start).getTime()-new Date(w.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:C,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:p}=m(d),y=f.length+p.length,C=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${C?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),C&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[C&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(Eo,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${C&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[p.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Xg,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((w,B)=>{const T=B.project||"-";return w[T]||(w[T]=[]),w[T].push(B),w},{});return Object.entries(v).map(([w,B])=>{const T=d===l;return a.jsxDEV("div",{className:`border-l-3 ${T?"border-gray-400":"border-gray-900"} ${T?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${T?"bg-amber-100":"bg-gray-100"} border-b ${T?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(F=>{const re=F.time&&F.time!=="-"?` - ${vd(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,re]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},w,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),p.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(nv,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=p.reduce((w,B)=>{const T=$t(new Date(B.start),"MM.dd",{locale:kn}),F=B.project||"-",re=`${T}|${F}`;return w[re]||(w[re]={date:T,project:F,schedules:[]}),w[re].schedules.push(B),w},{});return Object.values(v).map(({date:w,project:B,schedules:T})=>{const re=T.length>0&&fv(new Date(T[0].start))?`${w} ()`:w;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:T.map(ee=>{const M=ee.time&&ee.time!=="-"?` - ${vd(ee.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,M]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${w}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),i&&a.jsxDEV(P0,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)},Mu=()=>{const{user:n}=si(),{projects:e}=Xr();return A.useMemo(()=>n?n.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(l=>l.trim()):[]).includes(""),o=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||o}):e:[],[n,e])},g1=({value:n,detailValue:e="",onChange:t,onDetailChange:s,placeholder:r=" ",error:i})=>{const[o,l]=A.useState(!1),[u,m]=A.useState(n),[d,f]=A.useState(e),p=A.useRef(null);A.useEffect(()=>{const B=T=>{p.current&&!p.current.contains(T.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),A.useEffect(()=>{m(n)},[n]),A.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((B,T)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>B(!0),F.onerror=()=>T(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),C=B=>{const T=B.roadAddr||B.jibunAddr;m(T),t(T,d),l(!1)},v=B=>{const T=B.target.value;f(T),s&&s(T),u&&t(u,T)},w=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const T={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};C(T)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>w(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Jg,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},Sg=["","","","","","",""],y1=({project:n,onClose:e,onSave:t})=>{const{register:s,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=Ff({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=A.useState([]),[d,f]=A.useState(""),[p,y]=A.useState(""),[C,v]=A.useState(""),[w,B]=A.useState(!1);A.useEffect(()=>{var M;if(n){const E=n.location?n.location.split(","):["",""],N=((M=E[0])==null?void 0:M.trim())||n.location||"",V=E.length>1?E.slice(1).join(",").trim():"";o({name:n.name,client:n.client||"",location:N,detailLocation:V,startDate:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:"",endDate:n.endDate?new Date(n.endDate).toISOString().split("T")[0]:""}),y(N),v(V);const j=n.manager?n.manager.split(",").map(S=>S.trim()).filter(S=>S&&S!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[n,o]);const T=M=>{m(E=>E.includes(M)?E.filter(N=>N!==M):[...E,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},re=M=>{m(E=>E.filter(N=>N!==M))},ee=async M=>{if(w)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const E=p&&C?`${p}, ${C}`:p||M.location,N={name:M.name,client:M.client,location:E,manager:u.join(", "),contractAmount:(n==null?void 0:n.contractAmount)??0,spent:(n==null?void 0:n.spent)??0,status:(n==null?void 0:n.status)??"planning",progress:(n==null?void 0:n.progress)??0,description:(n==null?void 0:n.description)??"",meetingNotes:(n==null?void 0:n.meetingNotes)??[],customerRequests:(n==null?void 0:n.customerRequests)??[],entrancePassword:(n==null?void 0:n.entrancePassword)??"",sitePassword:(n==null?void 0:n.sitePassword)??""};if(M.startDate&&M.startDate!=="")N.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(n!=null&&n.startDate){const V=typeof n.startDate=="string"&&n.startDate.includes("T")?n.startDate.split("T")[0]:n.startDate;N.startDate=V,console.log(" Keeping existing startDate:",N.startDate)}if(M.endDate&&M.endDate!=="")N.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(n!=null&&n.endDate){const V=typeof n.endDate=="string"&&n.endDate.includes("T")?n.endDate.split("T")[0]:n.endDate;N.endDate=V,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(V){throw B(!1),V}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(g1,{value:p,detailValue:C,onChange:(M,E)=>{y(M),v(E||""),i("location",M),i("detailLocation",E||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[Sg.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>T(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!Sg.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>re(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:w,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:w?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},b1=({projectName:n,meetingNotes:e,onClose:t,onSave:s,onDelete:r})=>{const[i,o]=A.useState(""),[l,u]=A.useState(new Date().toISOString().split("T")[0]),[m,d]=A.useState(!1),[f,p]=A.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},C=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}p(!0);try{await s(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{p(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},w=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:$t(new Date(B.date),"yyyy.MM.dd (eee)",{locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>w(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},N1=({projectName:n,customerRequests:e,onClose:t,onSave:s,onToggleComplete:r,onDelete:i})=>{const[o,l]=A.useState(""),[u,m]=A.useState(new Date().toISOString().split("T")[0]),[d,f]=A.useState(!1),[p,y]=A.useState(!1),C=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!p){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await s(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},w=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=ee=>{window.confirm("  ?")&&i(ee)},T=ee=>{r(ee)},F=e.filter(ee=>!ee.completed),re=e.filter(ee=>ee.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:C,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:ee=>m(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:ee=>l(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:p,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:p?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:w,disabled:p,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(ee=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(sv,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:$t(new Date(ee.createdAt),"yyyy.MM.dd",{locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),re.map(ee=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(rv,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:$t(new Date(ee.createdAt),"yyyy.MM.dd",{locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},x1=({projectName:n,entrancePassword:e,sitePassword:t,onClose:s,onSave:r})=>{const[i,o]=A.useState(e||""),[l,u]=A.useState(t||""),[m,d]=A.useState(!1),[f,p]=A.useState(!1),y=()=>{d(!0)},C=async()=>{if(!f){p(!0);try{await r(i,l),d(!1)}finally{p(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:w=>w.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},v1=({projectName:n,onClose:e})=>{var o;const[t,s]=A.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>s({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>s({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>s({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>s({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>s({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>s({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&s({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>s({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Zg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[$t(new Date(t.startDate),"yyyy",{locale:kn}),"",$t(new Date(t.startDate),"MM",{locale:kn}),"",$t(new Date(t.startDate),"dd",{locale:kn})," ~ ",$t(new Date(t.endDate),"yyyy",{locale:kn}),"",$t(new Date(t.endDate),"MM",{locale:kn}),"",$t(new Date(t.endDate),"dd",{locale:kn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},_1=()=>{const{loadProjectsFromAPI:n,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:s}=Xr(),{user:r}=si(),i=Mu(),[o,l]=A.useState("in-progress"),[u,m]=A.useState("grid"),[d,f]=A.useState(!1),[p,y]=A.useState(null),[C,v]=A.useState(!1),[w,B]=A.useState(!1),[T,F]=A.useState(!1),[re,ee]=A.useState(!1),[M,E]=A.useState(null),N=(K,je)=>`lastViewed_${r==null?void 0:r.id}_${K}_${je}`,V=(K,je)=>{const Me=N(K,je),Pe=localStorage.getItem(Me);return Pe?parseInt(Pe,10):0},j=(K,je)=>{const Me=N(K,je);localStorage.setItem(Me,Date.now().toString())},S=(K,je)=>{const Me=V(K.id,je);return je==="meeting"?(K.meetingNotes||[]).some(Ze=>(Ze.createdAt?new Date(Ze.createdAt).getTime():new Date(Ze.date).getTime())>Me):(K.customerRequests||[]).some(Ze=>!Ze.completed)};A.useEffect(()=>{n().catch(K=>{console.error("Failed to load projects:",K),oe.error("   ")})},[n]),A.useEffect(()=>{const K=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const I=(K,je)=>{if(!K||!je)return 0;const Me=new Date,Pe=new Date(K),Ze=new Date(je);if(Me<Pe)return 0;if(Me>Ze)return 100;const Pt=Math.ceil((Ze.getTime()-Pe.getTime())/(1e3*60*60*24)),Gt=Math.ceil((Me.getTime()-Pe.getTime())/(1e3*60*60*24)),pt=Math.round(Gt/Pt*100);return Math.min(100,Math.max(0,pt))},k=K=>{y(K),f(!0)},Ae=async(K,je)=>{if(window.confirm(`"${je}"  ?

    .`))try{await s(K),oe.success(" ")}catch(Me){console.error("Failed to delete project:",Me),oe.error("  ")}},$e=async K=>{try{if(p)await t(p.id,K),oe.success(" ");else{const je={id:"",...K,team:K.team||[]};await e(je),oe.success(" "),l(K.status||"planning")}f(!1),y(null)}catch(je){console.error("Failed to save project:",je),oe.error("  ")}},ge=async(K,je)=>{try{await t(K,{status:je}),oe.success(" ")}catch(Me){console.error("Failed to update project status:",Me),oe.error("  ")}},He=K=>{E(K),v(!0),j(K.id,"meeting")},yt=K=>{E(K),B(!0),j(K.id,"request")},Kt=K=>{E(K),F(!0)},qt=K=>{E(K),ee(!0)},ae=async(K,je)=>{if(!M)return;const Me=M.entrancePassword,Pe=M.sitePassword;E({...M,entrancePassword:K,sitePassword:je});try{await t(M.id,{entrancePassword:K,sitePassword:je}),oe.success(" ")}catch(Ze){console.error("Failed to save passwords:",Ze),oe.error("  "),E({...M,entrancePassword:Me,sitePassword:Pe})}},ze=async(K,je)=>{if(!M)return;const Me={id:Date.now().toString(),content:K,date:je,createdAt:new Date},Pe=[...M.meetingNotes||[],Me];E({...M,meetingNotes:Pe});try{await t(M.id,{meetingNotes:Pe}),oe.success("  ")}catch(Ze){console.error("Failed to save meeting note:",Ze),oe.error("   "),E({...M,meetingNotes:M.meetingNotes||[]})}},me=async(K,je)=>{if(!M)return;const Me={id:Date.now().toString(),content:K,completed:!1,createdAt:je},Pe=[...M.customerRequests||[],Me];E({...M,customerRequests:Pe});try{await t(M.id,{customerRequests:Pe}),oe.success("  ")}catch(Ze){console.error("Failed to save customer request:",Ze),oe.error("   "),E({...M,customerRequests:M.customerRequests||[]})}},Be=async K=>{if(!M)return;const je=M.customerRequests||[],Me=je.map(Pe=>Pe.id===K?{...Pe,completed:!Pe.completed}:Pe);E({...M,customerRequests:Me});try{await t(M.id,{customerRequests:Me}),oe.success("  ")}catch(Pe){console.error("Failed to toggle request:",Pe),oe.error("  "),E({...M,customerRequests:je})}},Xe=async K=>{if(!M)return;const je=M.meetingNotes||[],Me=je.filter(Pe=>Pe.id!==K);E({...M,meetingNotes:Me});try{await t(M.id,{meetingNotes:Me}),oe.success("  ")}catch(Pe){console.error("Failed to delete meeting note:",Pe),oe.error(" "),E({...M,meetingNotes:je})}},Dt=async K=>{if(!M)return;const je=M.customerRequests||[],Me=je.filter(Pe=>Pe.id!==K);E({...M,customerRequests:Me});try{await t(M.id,{customerRequests:Me}),oe.success("  ")}catch(Pe){console.error("Failed to delete customer request:",Pe),oe.error(" "),E({...M,customerRequests:je})}},ut=({project:K})=>{const Me={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:Pe=>ge(K.id,Pe.target.value),className:Ss("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Me.color),onClick:Pe=>Pe.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},ct=(()=>{let K=i;return o!=="all"&&(K=K.filter(je=>je.status===o)),r!=null&&r.name&&(K=[...K].sort((je,Me)=>{var Pt,Gt;const Pe=je.manager===r.name||((Pt=je.team)==null?void 0:Pt.includes(r.name)),Ze=Me.manager===r.name||((Gt=Me.team)==null?void 0:Gt.includes(r.name));return Pe&&!Ze?-1:!Pe&&Ze?1:0})),K})(),ht={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},yn=({project:K})=>{var Me,Pe,Ze;const je=I(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>qt(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(ut,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${$t(K.startDate,"MM.dd (eee)",{locale:kn})} - ${$t(K.endDate,"MM.dd (eee)",{locale:kn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>Kt(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[je,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${je}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>He(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Me=K.meetingNotes)==null?void 0:Me.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Pe=K.meetingNotes)==null?void 0:Pe.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ze=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Ze.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var pt;const Pt=((pt=K.customerRequests)==null?void 0:pt.filter(P=>!P.completed))||[],Gt=Pt[Pt.length-1];return a.jsxDEV("div",{onClick:()=>yt(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Pt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Pt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Gt?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Gt.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>Ae(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ht.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ht.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ht.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Ss("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Ss("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Ss("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Ss("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(Eo,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:ct.map(K=>a.jsxDEV(yn,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:ct.map(K=>{var Me,Pe,Ze,Pt;const je=I(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[$t(K.startDate,"yyyy.MM.dd (eee)",{locale:kn})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),$t(K.endDate,"yyyy.MM.dd (eee)",{locale:kn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>qt(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(ut,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>Kt(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${je}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[je,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>He(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Me=K.meetingNotes)==null?void 0:Me.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Pe=K.meetingNotes)==null?void 0:Pe.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ze=K.meetingNotes)!=null&&Ze.length?((Pt=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Pt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const Gt=((P=K.customerRequests)==null?void 0:P.filter(q=>!q.completed))||[],pt=Gt[Gt.length-1];return a.jsxDEV("div",{onClick:()=>yt(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Gt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Gt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:pt?pt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>Ae(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(y1,{project:p,onClose:()=>{f(!1),y(null)},onSave:$e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),C&&M&&a.jsxDEV(b1,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),E(null)},onSave:ze,onDelete:Xe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),w&&M&&a.jsxDEV(N1,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{B(!1),E(null)},onSave:me,onToggleComplete:Be,onDelete:Dt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),T&&M&&a.jsxDEV(x1,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),E(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),re&&M&&a.jsxDEV(v1,{projectName:M.name,onClose:()=>{ee(!1),E(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var Of={},L0={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(L0);var Zn=L0.exports,qf={},j0={exports:{}},R0={exports:{}},B0={exports:{}},U0={exports:{}};(function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(U0);var Yo=U0.exports,H0={exports:{}};(function(n){var e=Yo.default;function t(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(H0);var D1=H0.exports;(function(n){var e=Yo.default,t=D1;function s(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(B0);var M0=B0.exports;(function(n){var e=M0;function t(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(R0);var F0=R0.exports;(function(n){var e=F0;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function s(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(j0);var ri=j0.exports,O0={exports:{}},q0={exports:{}};(function(n){function e(t,s){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(s.indexOf(i)!==-1)continue;r[i]=t[i]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(q0);var k1=q0.exports;(function(n){var e=k1;function t(s,r){if(s==null)return{};var i,o,l=e(s,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(l[i]=s[i])}return l}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(O0);var $f=O0.exports,$0={exports:{}};(function(n){function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})($0);var qi=$0.exports,z0={exports:{}};(function(n){var e=M0;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function s(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(z0);var $i=z0.exports,W0={exports:{}},K0={exports:{}};(function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(K0);var A1=K0.exports,G0={exports:{}};(function(n){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n.exports=e=function(){return!!t},n.exports.__esModule=!0,n.exports.default=n.exports)()}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(G0);var E1=G0.exports,Q0={exports:{}},Y0={exports:{}};(function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Y0);var V1=Y0.exports;(function(n){var e=Yo.default,t=V1;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(Q0);var w1=Q0.exports;(function(n){var e=A1,t=E1,s=w1;function r(i,o,l){return o=e(o),s(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(W0);var Xo=W0.exports,X0={exports:{}},J0={exports:{}};(function(n){function e(t,s){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,s)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(J0);var C1=J0.exports;(function(n){var e=C1;function t(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(X0);var Jo=X0.exports;const Tl=Nl(hv);var Rs={},$o={};Object.defineProperty($o,"__esModule",{value:!0});$o.views=$o.navigate=void 0;$o.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};$o.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var I1=Zn.default;Object.defineProperty(Rs,"__esModule",{value:!0});Rs.views=Rs.dateRangeFormat=Rs.dateFormat=Rs.accessor=Rs.DayLayoutAlgorithmPropType=void 0;var cs=I1(ey),Tg=$o,Pg=Object.keys(Tg.views).map(function(n){return Tg.views[n]});Rs.accessor=cs.default.oneOfType([cs.default.string,cs.default.func]);Rs.dateFormat=cs.default.any;Rs.dateRangeFormat=cs.default.func;Rs.views=cs.default.oneOfType([cs.default.arrayOf(cs.default.oneOf(Pg)),cs.default.objectOf(function(n,e){var t=Pg.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return cs.default.elementType.apply(cs.default,[n,e].concat(r))})]);Rs.DayLayoutAlgorithmPropType=cs.default.oneOfType([cs.default.oneOf(["overlap","no-overlap"]),cs.default.func]);var Fu={},Zo={},S1=Zn.default;Object.defineProperty(Zo,"__esModule",{value:!0});Zo.accessor=Z0;Zo.wrapAccessor=void 0;var T1=S1(Yo);function Z0(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&(0,T1.default)(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}Zo.wrapAccessor=function(e){return function(t){return Z0(t,e)}};var zi={},P1=Zn.default;Object.defineProperty(zi,"__esModule",{value:!0});zi.DnDContext=void 0;var L1=P1(A);zi.DnDContext=L1.default.createContext();var Wi=Zn.default;Object.defineProperty(Fu,"__esModule",{value:!0});Fu.default=void 0;var j1=Wi(ri),R1=Wi(qi),B1=Wi($i),U1=Wi(Xo),H1=Wi(Jo),go=Wi(A),Lg=Wi(Tl),jg=Zo,M1=zi,ex=function(n){function e(){var t;(0,R1.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,U1.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,j1.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,H1.default)(e,n),(0,B1.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return go.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},go.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,o=s.continuesPrior,l=s.continuesAfter,u=s.resizable,m=this.props.children;if(r.__isPreview)return go.default.cloneElement(m,{className:(0,Lg.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,p=d.resizableAccessor,y=f?!!(0,jg.accessor)(r,f):!0;if(!y)return m;var C=u&&(p?!!(0,jg.accessor)(r,p):!0);if(C||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(C){var w=null,B=null;i==="date"?(w=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(w=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),v.children=go.default.createElement("div",{className:"rbc-addons-dnd-resizable"},w,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Lg.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=go.default.cloneElement(m,v)}return m}}])}(go.default.Component);ex.contextType=M1.DnDContext;Fu.default=ex;var Ou={},tx={exports:{}};(function(n){var e=Yo.default;function t(s,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(n.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,p={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return p;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,p)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(p,y,f):p[y]=u[y]);return p},n.exports.__esModule=!0,n.exports.default=n.exports)(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(tx);var nx=tx.exports;function zf(n,e,t,s){if(t===void 0&&(t=!1),s===void 0&&(s=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,s),n.dispatchEvent(r)}}function F1(n){var e=Ts(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function O1(n,e,t){t===void 0&&(t=5);var s=!1,r=setTimeout(function(){s||zf(n,"transitionend",!0)},e+t),i=ru(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function Wf(n,e,t,s){t==null&&(t=F1(n)||0);var r=O1(n,t,s),i=ru(n,"transitionend",e);return function(){r(),i()}}var Rg={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Bg(n){var e=n.node,t=n.properties,s=n.duration,r=s===void 0?200:s,i=n.easing,o=n.callback,l=[],u={},m="";Object.keys(t).forEach(function(p){var y=t[p];gv(p)?m+=p+"("+y+") ":(u[p]=y,l.push(yv(p)))}),m&&(u.transform=m,l.push("transform"));function d(p){p.target===p.currentTarget&&(Ts(e,Rg),o&&o.call(this,p))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=Wf(e,d,r);return e.clientLeft,Ts(e,u),{cancel:function(){f(),Ts(e,Rg)}}}function sx(n,e,t,s,r){if(!("nodeType"in n))return Bg(n);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Bg({node:n,properties:e,duration:t,easing:s,callback:r})}function rx(n,e,t){if(n){if(typeof t>"u")return n.getAttribute(e);!t&&t!==""?n.removeAttribute(e):n.setAttribute(e,String(t))}}function ix(n){return n?Array.from(n.children):[]}function ox(n){if(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}return null}var q1=Function.prototype.bind.call(Function.prototype.call,[].slice);function ax(n){return n?q1(n.childNodes):[]}function lx(n,e){return function(s){var r=s.currentTarget,i=s.target,o=Vd(r,n);o.some(function(l){return wd(l,i)})&&e.call(this,s)}}function cx(n,e){return n&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(n,e.nextSibling):e.parentNode.appendChild(n),n):null}var $1=/^(?:input|select|textarea|button)$/i;function ux(n){return n?$1.test(n.nodeName):!1}function mx(n){return n?!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length):!1}function dx(n,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var s=[];n;n=n.nextElementSibling)if(n!==e){if(t&&Cd(n,t))break;s.push(n)}return s}function fx(n,e){return dx(n,n,e)}function z1(n,e){var t=null,s=[];for(t=n?n[e]:null;t&&t.nodeType!==9;)s.push(t),t=t[e]||null;return s}function px(n){return z1(n,"parentElement")}function hx(n,e){return n&&e?(e.firstElementChild?e.insertBefore(n,e.firstElementChild):e.appendChild(n),n):null}function gx(n){return n&&n.parentNode?(n.parentNode.removeChild(n),n):null}function Kf(n,e){var t=Ts(n,"position"),s=t==="absolute",r=n.ownerDocument;if(t==="fixed")return r||document;for(;(n=n.parentNode)&&!bv(n);){var i=s&&Ts(n,"position")==="static",o=(Ts(n,"overflow")||"")+(Ts(n,"overflow-y")||"")+Ts(n,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||iu(n)<n.scrollHeight))return n}return r||document}function yx(n,e){var t=Cc(n),s={top:0,left:0};if(n){var r=e||Kf(n),i=Nv(r),o=Ic(r),l=iu(r,!0);i||(s=Cc(r)),t={top:t.top-s.top,left:t.left-s.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Id(function(){return Ic(r,o)});return function(){return Sd(f)}}}function bx(n){return dx(n&&n.parentElement?n.parentElement.firstElementChild:null,n)}var W1=/&nbsp;/gi,K1=/\xA0/g,G1=/\s+([^\s])/gm;function Nx(n,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var s="";return n&&(s=(n.textContent||"").replace(W1," ").replace(K1," "),e&&(s=s.trim()),t&&(s=s.replace(G1," $1"))),s}function xx(n,e){n.classList?n.classList.toggle(e):Td(n,e)?Pd(n,e):Ld(n,e)}const Q1={addEventListener:dy,removeEventListener:my,triggerEvent:zf,animate:sx,filter:lx,listen:ru,style:Ts,getComputedStyle:uy,attribute:rx,activeElement:cy,ownerDocument:ly,ownerWindow:ay,requestAnimationFrame:Id,cancelAnimationFrame:Sd,matches:Cd,height:iu,width:oy,offset:Cc,offsetParent:iy,position:ry,contains:wd,scrollbarSize:sy,scrollLeft:ny,scrollParent:Kf,scrollTo:yx,scrollTop:Ic,querySelectorAll:Vd,closest:ty,addClass:Ld,removeClass:Pd,hasClass:Td,toggleClass:xx,transitionEnd:Wf,childNodes:ax,childElements:ix,nextUntil:fx,parents:px,siblings:bx,clear:ox,insertAfter:cx,isInput:ux,isVisible:mx,prepend:hx,remove:gx,text:Nx},Y1=Object.freeze(Object.defineProperty({__proto__:null,activeElement:cy,addClass:Ld,addEventListener:dy,animate:sx,attribute:rx,cancelAnimationFrame:Sd,childElements:ix,childNodes:ax,clear:ox,closest:ty,contains:wd,default:Q1,filter:lx,getComputedStyle:uy,hasClass:Td,height:iu,insertAfter:cx,isInput:ux,isVisible:mx,listen:ru,matches:Cd,nextUntil:fx,offset:Cc,offsetParent:iy,ownerDocument:ly,ownerWindow:ay,parents:px,position:ry,prepend:hx,querySelectorAll:Vd,remove:gx,removeClass:Pd,removeEventListener:my,requestAnimationFrame:Id,scrollLeft:ny,scrollParent:Kf,scrollTo:yx,scrollTop:Ic,scrollbarSize:sy,siblings:bx,style:Ts,text:Nx,toggleClass:xx,transitionEnd:Wf,triggerEvent:zf,width:oy},Symbol.toStringTag,{value:"Module"})),X1=Nl(Y1);var _d={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return t(r.querySelectorAll(i))}n.exports=e.default})(_d,_d.exports);var J1=_d.exports,Hs={};const Z1=Nl(xv),eI=Nl(vv),tI=Nl(_v);var ea=Zn.default;Object.defineProperty(Hs,"__esModule",{value:!0});Hs.default=void 0;Hs.getBoundsForNode=bl;Hs.getEventNodeFromPoint=_x;Hs.getShowMoreNodeFromPoint=Dx;Hs.isEvent=aI;Hs.isShowMore=lI;Hs.objectsCollide=kd;var nI=ea(Yo),sI=ea(qi),rI=ea($i),Dd=ea(Z1),vx=ea(eI),iI=ea(tI);function Gn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,iI.default)(t,n,e,{passive:!1})}function oI(n,e,t){return!n||(0,Dd.default)(n,document.elementFromPoint(e,t))}function _x(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,vx.default)(r,".rbc-event",n)}function Dx(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,vx.default)(r,".rbc-show-more",n)}function aI(n,e){return!!_x(n,e)}function lI(n,e){return!!Dx(n,e)}function Ia(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Ug=5,cI=250,uI=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.global,r=s===void 0?!1:s,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,sI.default)(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Gn("touchmove",function(){},window),this._removeKeyDownListener=Gn("keydown",this._keyListener),this._removeKeyUpListener=Gn("keyup",this._keyListener),this._removeDropFromOutsideListener=Gn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Gn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,rI.default)(n,[{key:"on",value:function(t,s){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(s),{remove:function(){var o=r.indexOf(s);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var s=this._selectRect;return!s||!this.selecting?!1:kd(s,bl(t))}},{key:"filter",value:function(t){var s=this._selectRect;return!s||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,s){var r=this,i=null,o=null,l=null,u=function(p){i=setTimeout(function(){d(),t(p)},r.longPressThreshold),o=Gn("touchmove",function(){return d()}),l=Gn("touchend",function(){return d()})},m=Gn("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return s&&u(s),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,s=Gn("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Gn("mousedown",t._handleInitialEvent)}),r=Gn("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var s=Ia(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var s=Ia(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var s=Ia(t),r=s.clientX,i=s.clientY,o=s.pageX,l=s.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!oI(u,r,i))){if(!this.globalMouse&&u&&!(0,Dd.default)(u,t.target)){var f=mI(0),p=f.top,y=f.left,C=f.bottom,v=f.right;if(d=bl(u),m=kd({top:d.top-p,left:d.left-y,bottom:d.bottom+C,right:d.right+v},{top:l,left:o}),!m)return}var w=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(w!==!1)switch(t.type){case"mousedown":this._removeEndListener=Gn("mouseup",this._handleTerminatingEvent),this._onEscListener=Gn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Gn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Gn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Gn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var s=t.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var s=this.selecting,r=this._selectRect;if(!s&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Dd.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!s&&i?this._handleClickEvent(t):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var s=Ia(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<cI?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,o=Ia(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),p=Math.min(u,i),y=this.selecting,C=this.isClick(l,u);C&&!y&&!(m||d)||(!y&&!C&&this.emit("selectStart",this._initialEventData),C||(this.selecting=!0,this._selectRect={top:p,left:f,x:l,y:u,right:f+m,bottom:p+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,s){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Ug&&Math.abs(s-o)<=Ug}}])}();function mI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,nI.default)(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function kd(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=bl(n),r=s.top,i=s.left,o=s.right,l=o===void 0?i:o,u=s.bottom,m=u===void 0?r:u,d=bl(e),f=d.top,p=d.left,y=d.right,C=y===void 0?p:y,v=d.bottom,w=v===void 0?f:v;return!(m-t<f||r+t>w||l-t<p||i+t>C)}function bl(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+Hg("left"),s=e.top+Hg("top");return{top:s,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+s}}function Hg(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}Hs.default=uI;var qu={},$u=Zn.default;Object.defineProperty(qu,"__esModule",{value:!0});qu.default=void 0;var dI=$u(F0),Mg=$u(ri),fI=$u(Tl),Sa=$u(A);function sc(n){return typeof n=="string"?n:n+"%"}function pI(n){var e=n.style,t=n.className,s=n.event,r=n.accessors,i=n.rtl,o=n.selected,l=n.label,u=n.continuesPrior,m=n.continuesAfter,d=n.getters,f=n.onClick,p=n.onDoubleClick,y=n.isBackgroundEvent,C=n.onKeyPress,v=n.components,w=v.event,B=v.eventWrapper,T=r.title(s),F=r.tooltip(s),re=r.end(s),ee=r.start(s),M=d.eventProp(s,ee,re,o),E=[Sa.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Sa.default.createElement("div",{key:"2",className:"rbc-event-content"},w?Sa.default.createElement(w,{event:s,title:T}):T)],N=e.height,V=e.top,j=e.width,S=e.xOffset,I=(0,Mg.default)((0,Mg.default)({},M.style),{},(0,dI.default)({top:sc(V),height:sc(N),width:sc(j)},i?"right":"left",sc(S)));return Sa.default.createElement(B,Object.assign({type:"time"},n),Sa.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:p,style:I,onKeyDown:C,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,fI.default)(y?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},E))}qu.default=pI;var br={},kx=Zn.default;Object.defineProperty(br,"__esModule",{value:!0});br.dragAccessors=void 0;br.eventTimes=_I;br.mergeComponents=xI;br.pointInColumn=vI;var hI=kx(ri),gI=kx($f),Fg=Zo,yI=A,bI=["children"];br.dragAccessors={start:(0,Fg.wrapAccessor)(function(n){return n.start}),end:(0,Fg.wrapAccessor)(function(n){return n.end})};function NI(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s=function(i){var o=i.children,l=(0,gI.default)(i,bI);return e.filter(Boolean).reduceRight(function(u,m){return(0,yI.createElement)(m,l,u)},o)};return s}function xI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),s=(0,hI.default)({},n);return t.forEach(function(r){s[r]=n[r]?NI(n[r],e[r]):e[r]}),s}function vI(n,e){var t=n.left,s=n.right,r=n.top,i=e.x,o=e.y;return i<s+10&&i>t&&o>r}function _I(n,e,t){var s=e.start(n),r=e.end(n),i=t.eq(s,r,"minutes")&&t.diff(s,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(s,r,"milliseconds");return{start:s,end:r,duration:o}}var DI=nx.default,ii=Zn.default;Object.defineProperty(Ou,"__esModule",{value:!0});Ou.default=void 0;var Sr=ii(ri),kI=ii(qi),AI=ii($i),EI=ii(Xo),VI=ii(Jo),Vm=X1,wI=ii(J1),pi=ii(A),CI=zi,Tr=DI(Hs),II=ii(qu),lr=br,Ax=function(n){function e(){var t;(0,kI.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,EI.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,lr.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,p=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,lr.eventTimes)(u,d,t.props.localizer),C=y.duration,v=t.props.localizer.add(p,C,"milliseconds");t.update(u,f.getRange(p,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),p=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:p,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),p=(0,lr.eventTimes)(f,u,d),y=p.duration,C=m.nextSlot(o),v=!isNaN(y);if(v){var w=d.add(o,y,"milliseconds");C=new Date(Math.max(w,C))}return C},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,wI.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Vm.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Vm.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new Tr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Vm.scrollParent)(o);m.on("beforeSelect",function(f){var p=t.context.draggable.dragAndDropAction;if(!p.action)return!1;if(p.action==="resize")return(0,lr.pointInColumn)((0,Tr.getBoundsForNode)(l),f);var y=(0,Tr.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,Tr.getBoundsForNode)(y).top}),m.on("selecting",function(f){var p=(0,Tr.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,p)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,p))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var p=(0,Tr.getBoundsForNode)(l);(0,lr.pointInColumn)(p,f)&&t.handleDropFromOutside(f,p)}}),m.on("dragOverFromOutside",function(f){var p=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(p){var y=(0,Tr.getBoundsForNode)(l);if(!(0,lr.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var p=(0,Tr.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,lr.pointInColumn)(p,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=pi.default.createRef(),t}return(0,VI.default)(e,n),(0,AI.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,Sr.default)((0,Sr.default)({},s),{},{start:i,end:o})})}},{key:"handleResize",value:function(s,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,p=l.closestSlotFromPoint(s,r),y=(0,lr.eventTimes)(d,o,u),C=y.start,v=y.end,w;if(f==="UP"){var B=u.min(p,l.closestSlotFromDate(v,-1));w=l.getRange(B,v),w=(0,Sr.default)((0,Sr.default)({},w),{},{endDate:v})}else if(f==="DOWN"){var T=u.max(p,l.closestSlotFromDate(C));w=l.getRange(C,T),w=(0,Sr.default)((0,Sr.default)({},w),{},{startDate:C})}this.update(d,w)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,o=s.components,l=s.getters,u=s.slotMetrics,m=s.localizer,d=this.state,f=d.event,p=d.top,y=d.height;if(!f)return r;var C=r.props.children,v=f.start,w=f.end,B,T="eventTimeRangeFormat",F=u.startsBeforeDay(v),re=u.startsAfterDay(w);return F?T="eventTimeRangeEndFormat":re&&(T="eventTimeRangeStartFormat"),F&&re?B=m.messages.allDay:B=m.format({start:v,end:w},T),pi.default.cloneElement(r,{children:pi.default.createElement(pi.default.Fragment,null,C,f&&pi.default.createElement(II.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:p,height:y,width:100},getters:l,components:o,accessors:(0,Sr.default)((0,Sr.default)({},i),lr.dragAccessors),continuesPrior:F,continuesAfter:re}))})}},{key:"render",value:function(){return pi.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(pi.default.Component);Ax.contextType=CI.DnDContext;Ou.default=Ax;var zu={},Ex={exports:{}},Vx={exports:{}},wx={exports:{}};(function(n){function e(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,i=Array(s);r<s;r++)i[r]=t[r];return i}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(wx);var Cx=wx.exports;(function(n){var e=Cx;function t(s){if(Array.isArray(s))return e(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(Vx);var SI=Vx.exports,Ix={exports:{}};(function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Ix);var TI=Ix.exports,Sx={exports:{}};(function(n){var e=Cx;function t(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(Sx);var PI=Sx.exports,Tx={exports:{}};(function(n){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Tx);var LI=Tx.exports;(function(n){var e=SI,t=TI,s=PI,r=LI;function i(o){return e(o)||t(o)||s(o)||r()}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})(Ex);var Px=Ex.exports,Wu={},Ku={},Gu={},oi=Zn.default;Object.defineProperty(Gu,"__esModule",{value:!0});Gu.default=void 0;var Og=oi(ri),jI=oi($f),RI=oi(qi),BI=oi($i),UI=oi(Xo),HI=oi(Jo),Ta=oi(A),MI=oi(Tl),FI=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],OI=function(n){function e(){return(0,RI.default)(this,e),(0,UI.default)(this,e,arguments)}return(0,HI.default)(e,n),(0,BI.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,o=s.event,l=s.selected,u=s.isAllDay,m=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,p=s.localizer,y=s.continuesPrior,C=s.continuesAfter,v=s.accessors,w=s.getters,B=s.children,T=s.components,F=T.event,re=T.eventWrapper,ee=s.slotStart,M=s.slotEnd,E=(0,jI.default)(s,FI);delete E.resizable;var N=v.title(o),V=v.tooltip(o),j=v.end(o),S=v.start(o),I=v.allDay(o),k=u||I||p.diff(S,p.ceil(j,"day"),"day")>1,Ae=w.eventProp(o,S,j,l),$e=Ta.default.createElement("div",{className:"rbc-event-content",title:V||void 0},F?Ta.default.createElement(F,{event:o,continuesPrior:y,continuesAfter:C,title:N,isAllDay:I,localizer:p,slotStart:ee,slotEnd:M}):N);return Ta.default.createElement(re,Object.assign({},this.props,{type:"date"}),Ta.default.createElement("div",Object.assign({},E,{style:(0,Og.default)((0,Og.default)({},Ae.style),r),className:(0,MI.default)("rbc-event",i,Ae.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":C}),onClick:function(He){return m&&m(o,He)},onDoubleClick:function(He){return d&&d(o,He)},onKeyDown:function(He){return f&&f(o,He)}}),typeof B=="function"?B($e):$e))}}])}(Ta.default.Component);Gu.default=OI;var ai={},qI=Zn.default;Object.defineProperty(ai,"__esModule",{value:!0});ai.dateCellSelection=KI;ai.getSlotAtX=Lx;ai.isSelected=zI;ai.pointInBox=WI;ai.slotWidth=Gf;var $I=qI(Dv);function zI(n,e){return!n||e==null?!1:(0,$I.default)(n,e)}function Gf(n,e){var t=n.right-n.left,s=t/e;return s}function Lx(n,e,t,s){var r=Gf(n,s);return t?s-1-Math.floor((e-n.left)/r):Math.floor((e-n.left)/r)}function WI(n,e){var t=e.x,s=e.y;return s>=n.top&&s<=n.bottom&&t>=n.left&&t<=n.right}function KI(n,e,t,s,r){var i=-1,o=-1,l=s-1,u=Gf(e,s),m=Lx(e,t.x,r,s),d=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,p=n.y>e.bottom,y=e.top>n.y,C=t.top<e.top&&t.bottom>e.bottom;return C&&(i=0,o=l),d&&(y?(i=0,o=m):p&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((n.x-e.left)/u):Math.floor((n.x-e.left)/u),d?m<i?i=m:o=m:n.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var Qf=Zn.default;Object.defineProperty(Ku,"__esModule",{value:!0});Ku.default=void 0;var $s=Qf(ey),qg=Qf(A),GI=Qf(Gu),QI=ai;Ku.default={propTypes:{slotMetrics:$s.default.object.isRequired,selected:$s.default.object,isAllDay:$s.default.bool,accessors:$s.default.object.isRequired,localizer:$s.default.object.isRequired,components:$s.default.object.isRequired,getters:$s.default.object.isRequired,onSelect:$s.default.func,onDoubleClick:$s.default.func,onKeyPress:$s.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,p=e.resizable,y=d.continuesPrior(t),C=d.continuesAfter(t);return qg.default.createElement(GI.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:C,slotStart:d.first,slotEnd:d.last,selected:(0,QI.isSelected)(t,s),resizable:p})},renderSpan:function(e,t,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return qg.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var li=Zn.default;Object.defineProperty(Wu,"__esModule",{value:!0});Wu.default=void 0;var YI=li(ri),XI=li(qi),JI=li($i),ZI=li(Xo),e2=li(Jo),t2=li(Tl),$g=li(A),wc=li(Ku),jx=function(n){function e(){return(0,XI.default)(this,e),(0,ZI.default)(this,e,arguments)}return(0,e2.default)(e,n),(0,JI.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return $g.default.createElement("div",{className:(0,t2.default)(l,"rbc-row")},i.reduce(function(m,d,f){var p=d.event,y=d.left,C=d.right,v=d.span,w="_lvl_"+f,B=y-u,T=wc.default.renderEvent(s.props,p);return B&&m.push(wc.default.renderSpan(o,B,"".concat(w,"_gap"))),m.push(wc.default.renderSpan(o,v,w,T)),u=C+1,m},[]))}}])}($g.default.Component);jx.defaultProps=(0,YI.default)({},wc.default.defaultProps);Wu.default=jx;var Nr={},Rx=Zn.default;Object.defineProperty(Nr,"__esModule",{value:!0});Nr.endOfRange=Bx;Nr.eventLevels=r2;Nr.eventSegments=s2;Nr.inRange=i2;Nr.segsOverlap=Ux;Nr.sortEvents=Ad;Nr.sortWeekEvents=o2;var wm=Rx(Px),n2=Rx(kv);function Bx(n){var e=n.dateRange,t=n.unit,s=t===void 0?"day":t,r=n.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function s2(n,e,t,s){var r=Bx({dateRange:e,localizer:s}),i=r.first,o=r.last,l=s.diff(i,o,"day"),u=s.max(s.startOf(t.start(n),"day"),i),m=s.min(s.ceil(t.end(n),"day"),o),d=(0,n2.default)(e,function(p){return s.isSameDate(p,u)}),f=s.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-s.segmentOffset,1),{event:n,span:f,left:d+1,right:Math.max(d+f,1)}}function r2(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,s,r,i=[],o=[];for(t=0;t<n.length;t++){for(r=n[t],s=0;s<i.length&&Ux(r,i[s]);s++);s>=e?o.push(r):(i[s]||(i[s]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function i2(n,e,t,s,r){var i={start:s.start(n),end:s.end(n)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function Ux(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function o2(n,e,t){var s=(0,wm.default)(n),r=[],i=[];s.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return Ad(u,m,e,t)}),l=i.sort(function(u,m){return Ad(u,m,e,t)});return[].concat((0,wm.default)(o),(0,wm.default)(l))}function Ad(n,e,t,s){var r={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var a2=nx.default,ci=Zn.default;Object.defineProperty(zu,"__esModule",{value:!0});zu.default=void 0;var rc=ci(ri),l2=ci(Px),c2=ci(qi),u2=ci($i),m2=ci(Xo),d2=ci(Jo),ic=ci(A),f2=ci(Wu),yo=a2(Hs),p2=Nr,Pr=ai,oc=br,h2=zi,Hx=function(n){function e(){var t;(0,c2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,m2.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,Pr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,p=d.slotMetrics,y=d.rtl,C=d.localizer,v=(0,Pr.getSlotAtX)(l,o.x,y,p.slots),w=p.getDateForSlot(v),B=(0,oc.eventTimes)(m,f,C),T=B.start,F=B.duration;T=C.merge(w,T);var re=C.add(T,F,"milliseconds");t.update(m,T,re)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,p=(0,Pr.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(p);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new yo.default(function(){return l},{validContainers:(0,l2.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,p=t.context.draggable.dragAndDropAction.action,y=(0,yo.getBoundsForNode)(o),C=(0,Pr.pointInBox)(y,d);return p==="move"||p==="resize"&&(!f||C)}),m.on("selecting",function(d){var f=(0,yo.getBoundsForNode)(o),p=t.context.draggable.dragAndDropAction;p.action==="move"&&t.handleMove(d,f),p.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,yo.getBoundsForNode)(o);t.state.segment&&((0,Pr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,yo.getBoundsForNode)(o);(0,Pr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,yo.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=ic.default.createRef(),t}return(0,d2.default)(e,n),(0,u2.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var o=(0,p2.eventSegments)((0,rc.default)((0,rc.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,oc.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,p=u.localizer,y=(0,oc.eventTimes)(o,m,p),C=y.start,v=y.end,w=(0,Pr.getSlotAtX)(r,s.x,f,d.slots),B=d.getDateForSlot(w),T=(0,Pr.pointInBox)(r,s);if(l==="RIGHT"){if(T){if(d.last<C)return this.reset();p.eq(p.startOf(v,"day"),v)?v=p.add(B,1,"day"):v=B}else if(p.inRange(C,d.first,d.last)||r.bottom<s.y&&+d.first>+C)v=p.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=p.merge(v,F),p.lt(v,C)&&(v=F)}else if(l==="LEFT"){if(T){if(d.first>v)return this.reset();C=B}else if(p.inRange(v,d.first,d.last)||r.top>s.y&&p.lt(d.last,v))C=p.add(d.first,-1,"milliseconds");else{this.reset();return}var re=m.start(o);C=p.merge(C,re),p.gt(C,v)&&(C=re)}this.update(o,C,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,o=this.state.segment;return ic.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&ic.default.createElement(f2.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,rc.default)((0,rc.default)({},i),oc.dragAccessors)})))}}])}(ic.default.Component);Hx.contextType=h2.DnDContext;zu.default=Hx;var Ms=Zn.default;Object.defineProperty(qf,"__esModule",{value:!0});qf.default=w2;var ac=Ms(ri),g2=Ms($f),y2=Ms(qi),b2=Ms($i),N2=Ms(Xo),x2=Ms(Jo),Cm=Ms(A),v2=Ms(Tl),_2=Ms(Fu),D2=Ms(Ou),k2=Ms(zu),A2=br,E2=zi,V2=["selectable","elementProps","components"];function w2(n){var e=function(t){function s(){var r;(0,y2.default)(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,N2.default)(this,s,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var p=r.props,y=p.onEventDrop,C=p.onEventResize;d==="move"&&y&&y(u),d==="resize"&&C&&C(u)}},r.state={interacting:!1},r}return(0,x2.default)(s,t),(0,b2.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,g2.default)(i,V2),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,A2.mergeComponents)(u,{eventWrapper:_2.default,eventContainerWrapper:D2.default,weekWrapper:k2.default});var f=this.props.onDropFromOutside?(0,ac.default)((0,ac.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,v2.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var p=this.getDnDContextValue();return Cm.default.createElement(E2.DnDContext.Provider,{value:p},Cm.default.createElement(n,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(Cm.default.Component);return e.defaultProps=(0,ac.default)((0,ac.default)({},n.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var C2=Zn.default;Object.defineProperty(Of,"__esModule",{value:!0});var Mx=Of.default=void 0,I2=C2(qf);Mx=Of.default=I2.default;const S2=Mx(Av),T2=d1;mt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:n=>n<12?"":"",week:{dow:0,doy:1}});mt.locale("ko");const P2=Ev(mt),zg=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],L2=ft.memo(({onSave:n,onCancel:e,processList:t})=>{const[s,r]=A.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=A.useState(i);A.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:m=>r(m.target.value),onBlur:()=>{s.trim()?n(s.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?s.trim()?n(s.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),Wg=n=>n,tl={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},j2=ft.memo(({date:n,label:e,filteredEvents:t,selectedDate:s,user:r,isMobileView:i})=>{const o=mt(n).format("YYYY-MM-DD"),l=tl[o],u=!!tl[o],m=s&&mt(n).isSame(s,"day"),d=t.filter(M=>mt(M.start).isSame(n,"day")),f=d.length,p=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-p,C=e.replace(/^0/,""),v=n.getDay()===0,w=n.getDay()===6;let B="#000000";u||v?B="#dc2626":w&&(B="#3b82f6");const T=mt(n).isSame(mt(),"day");let F="#d1d5db";u||v?F="#fecaca":w&&(F="#bfdbfe");const re=C.length===2,ee=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:T?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:T?"700":"400",paddingLeft:re?"0px":"4px",...T&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:ee,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:p}).map((M,E)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${E}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((M,E)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${E}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:ee,children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),R2=ft.memo(({event:n,user:e,filterProject:t,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const p=t&&t!=="all",y=n.assignedTo||[],[C,v]=A.useState(!1),w=ft.useRef(null),B=()=>{const ge=window.innerWidth,He=window.innerHeight;return ge>=768&&ge<1024||ge>=1024&&He>ge},[T,F]=A.useState(B),[re,ee]=A.useState(!1);ft.useRef(null),ft.useRef(!1);const[M,E]=A.useState(r||""),N=ft.useRef(s);A.useEffect(()=>{s&&!N.current&&r!==void 0&&E(r),N.current=s},[s,r]);const V=e!=null&&e.name?e.name.slice(-2):null,j=V&&["",""].includes(V),S=V&&["","",""].includes(V),I=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&S||y.includes("")&&j);A.useEffect(()=>{const ge=()=>{F(B())};return window.addEventListener("resize",ge),()=>window.removeEventListener("resize",ge)},[]);const k=ge=>{E(ge)},Ae=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},$e=ge=>{ge.stopPropagation(),(ge.key==="Enter"||ge.key==="Escape")&&ge.currentTarget.blur()};return T?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),v(!0)},onMouseLeave:()=>{ee(!1),v(!1)},style:{padding:p?"2px 3px":"1px 3px",minHeight:p?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[C&&p&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:w,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:p?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!p&&!n.isASVisit&&n.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",Wg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!p&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((ge,He)=>{const yt=ge==="HV LAB"||ge===""&&j||ge===""&&S||ge===(e==null?void 0:e.name);return a.jsxDEV(ft.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:yt?"bold":"normal"},children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),He<y.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:ge=>k(ge.target.value),onBlur:Ae,onKeyDown:$e,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:n.title,children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),re&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),n.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",n.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:p?"32px":"18px",padding:p?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!p&&!n.isASVisit&&n.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",Wg(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:ge=>k(ge.target.value),onBlur:Ae,onKeyDown:$e,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:p?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:p?"18px":"12px",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!p&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((ge,He)=>{const yt=ge==="HV LAB"||ge===""&&j||ge===""&&S||ge===(e==null?void 0:e.name);return a.jsxDEV(ft.Fragment,{children:[a.jsxDEV("span",{className:yt?"font-bold":"",children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),He<y.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),C&&p&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:w,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(ge=>a.jsxDEV("option",{value:ge},ge,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),B2=()=>{const{schedules:n,setSchedules:e,addSchedule:t,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:p}=Xr(),{user:y}=si(),C=Mu(),[v,w]=A.useState(!1);A.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;w(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const B=b=>!b||b==="-"?"":v?b:vd(b),T=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",T);const F=ft.useRef(!1);A.useEffect(()=>{F.current||(F.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),oe.error("  ")}))},[r]);const[re,ee]=A.useState([]);A.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Y=H.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(re.length>0){H.preventDefault();const W=re[re.length-1];try{const le=W.type==="as_visit"||W.type==="expected_payment"?"other":W.type;await i({id:"",title:W.originalTitle||W.title,start:W.start,end:W.end,type:le,project:W.originalProjectName||W.projectName,attendees:W.assignedTo||[],time:W.time,description:W.description}),ee(Ne=>Ne.slice(0,-1)),oe.success(" ")}catch(le){console.error("  :",le),oe.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[re,i]);const[M,E]=A.useState([]),[N,V]=A.useState(!1),[j,S]=A.useState(""),[I,k]=A.useState(null),[Ae,$e]=A.useState(""),[ge,He]=A.useState(!1),[yt,Kt]=A.useState(null),[qt,ae]=A.useState(null),ze=A.useCallback(async()=>{He(!0);try{const b=await Ie.get("/processes");E(b.data)}catch(b){console.error("   :",b),E([])}finally{He(!1)}},[]);A.useEffect(()=>{ze()},[ze]);const me=A.useMemo(()=>M.length>0?M.map(b=>b.name):T2,[M]),Be=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)S(""),ze(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},Xe=async()=>{if(!(!I||!Ae.trim()))try{const b=await fetch(`/api/processes/${I.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ae.trim()})});if(b.ok)k(null),$e(""),ze(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},Dt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)ze(),oe.success(" ");else{const Y=await H.json();oe.error(Y.error||"  ")}}catch(H){console.error("  :",H),oe.error("  ")}},ut=b=>{Kt(b)},Tt=(b,H)=>{b.preventDefault(),yt!==null&&yt!==H&&ae(H)},ct=async()=>{if(yt!==null&&qt!==null&&yt!==qt){const b=[...M],[H]=b.splice(yt,1);b.splice(qt,0,H),E(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(W=>({id:W.id}))})})).ok||(ze(),oe.error("  "))}catch(Y){console.error("  :",Y),ze(),oe.error("  ")}}Kt(null),ae(null)},ht=b=>{const H=C.findIndex(Y=>Y.name===b);return H>=0?zg[H%zg.length]:"#e8e2ea"},yn=C.map(b=>b.name),K=n.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||yn.includes(b.project):!0).map(b=>{const H=C.find(ye=>ye.name===b.project);let Y=b.project===""?"[]":b.project;if(H&&b.project!==""){const ye=H.name.length>2?H.name.substring(0,2):H.name,bt=(H.location||"").match(/([A-Za-z]?\d+)/),xn=bt?bt[1]:"";Y=xn?`${ye}_${xn}`:ye}const W=b.time,le=W&&W!=="-"?` - ${B(W)}`:"",Ne=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Y||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:Ne,priority:"medium",allDay:!W||W==="-",color:ht(b.project||""),isASVisit:!1,time:W,description:b.description}}),je=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?yn.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Y=H&&H!=="-"?` - ${B(H)}`:"",W=C.find(ye=>ye.name===b.project);let le=b.project;if(W){const ye=W.name.length>2?W.name.substring(0,2):W.name,bt=(W.location||"").match(/([A-Za-z]?\d+)/),xn=bt?bt[1]:"";le=xn?`${ye}_${xn}`:ye}const Ne=`[AS] ${le}`;return{id:`as-${b.id}`,title:Ne+Y,originalTitle:Ne,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(W==null?void 0:W.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(ye=>ye.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),Me=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var Ne,ye,dt,bt,xn,jt,Rt,dn;const H=C.find(In=>In.name===b.project);if(!H){const In=[],Ct=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),on=new Set(b.payments.flatMap(Nn=>{var Xt;return((Xt=Nn.type)==null?void 0:Xt.split(", ").map(en=>en.trim()))||[]}));return!on.has("")&&((Ne=b.expectedPaymentDates)!=null&&Ne.contract)&&In.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Ct*.1).toLocaleString()}`}),!on.has("")&&((ye=b.expectedPaymentDates)!=null&&ye.start)&&In.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Ct*.4).toLocaleString()}`}),!on.has("")&&((dt=b.expectedPaymentDates)!=null&&dt.middle)&&In.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Ct*.4).toLocaleString()}`}),!on.has("")&&((bt=b.expectedPaymentDates)!=null&&bt.final)&&In.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Ct*.1).toLocaleString()}`}),In}if(!H.startDate||!H.endDate)return[];const Y=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),W=new Set(b.payments.flatMap(In=>{var Ct;return((Ct=In.type)==null?void 0:Ct.split(", ").map(on=>on.trim()))||[]})),le=[];return!W.has("")&&((xn=b.expectedPaymentDates)!=null&&xn.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!W.has("")&&((jt=b.expectedPaymentDates)!=null&&jt.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((Rt=b.expectedPaymentDates)!=null&&Rt.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((dn=b.expectedPaymentDates)!=null&&dn.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],Pe=[...K,...je,...Me],Ze=A.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Y=y.name.slice(-2),W=["",""].includes(Y),le=["","",""].includes(Y);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&le||H.includes("")&&W},[y==null?void 0:y.name]),Pt=(b,H)=>{if(!H)return[...b].sort((le,Ne)=>{const ye=Ze(le),dt=Ze(Ne);return ye&&!dt?-1:!ye&&dt?1:le.start.getTime()-Ne.start.getTime()});const Y=new Map;b.forEach(le=>{const Ne=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||Ne){const ye=`single_${le.id}`;Y.set(ye,[le])}else{const ye=le.start.toISOString().split("T")[0],dt=[...le.assignedTo].sort().join(","),bt=`${ye}_${le.projectName}_${dt}`;Y.has(bt)||Y.set(bt,[]),Y.get(bt).push(le)}});const W=[];return Y.forEach(le=>{if(le.length===1)W.push(le[0]);else{const Ne=le[0],ye=le.map(Rt=>Rt.originalTitle||Rt.title),dt=[...new Set(ye)],bt=le.map(Rt=>{const dn=Rt.originalTitle||Rt.title;return dn.startsWith(Ne.projectName+" - ")?dn.substring(Ne.projectName.length+3):dn}),xn=[...new Set(bt)],jt={...Ne,id:le[0].id,title:xn.join(", "),originalTitle:dt.join(", "),description:le.map(Rt=>Rt.description||Rt.originalTitle||Rt.title).join(`
`),assignedTo:[...new Set(le.flatMap(Rt=>Rt.assignedTo))],mergedEventIds:le.map(Rt=>Rt.id)};W.push(jt)}}),W.sort((le,Ne)=>{const ye=Ze(le),dt=Ze(Ne);return ye&&!dt?-1:!ye&&dt?1:le.start.getTime()-Ne.start.getTime()})},[Gt,pt]=A.useState("month"),[P,q]=A.useState(new Date),[te,xe]=A.useState(!1),[ce,de]=A.useState(null),[Se,We]=A.useState(null),st=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[Ee,Mn]=A.useState(()=>{const b=localStorage.getItem(st);return b||((y==null?void 0:y.name)===""&&C.length>0?C[0].name:"all")});A.useEffect(()=>{localStorage.setItem(st,Ee)},[Ee,st]),A.useCallback(()=>{document.body.classList.add("printing-schedule");const b=Ee==="all"?" ":Ee,H=mt(P).format("YYYY MM"),Y=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ee,P]);const Ht=Pt(Pe,Ee==="all"),[ne,et]=A.useState(window.innerWidth<768?new Date:null),[O,ve]=A.useState(null),ke=ft.useRef(null),Re=ft.useRef(!1),[ue,Et]=A.useState(null),_t=ft.useRef(!1),nn=ft.useRef(!1);A.useEffect(()=>{const b=W=>{W.key==="Control"&&(nn.current=!0)},H=W=>{W.key==="Control"&&(nn.current=!1)},Y=()=>{nn.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Y)}},[]),A.useEffect(()=>{if(!O)return;let b=null;const H=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy")},Y=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy");const dt=Ne.target.closest(".rbc-day-bg");b&&b!==dt&&(b.style.backgroundColor=""),dt&&(dt.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=dt)},W=()=>{b&&(b.style.backgroundColor="",b=null)},le=Ne=>{Ne.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Y),document.addEventListener("dragend",W),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",W),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[O]);const[wt,bn]=A.useState(null),[un,Rn]=A.useState(null),[gs,es]=A.useState(""),[ys,ui]=A.useState(!1),[Fs,os]=A.useState(null),[D,Q]=A.useState(!1),[R,x]=A.useState(""),[L,U]=A.useState(null),[X,G]=A.useState({x:0,y:0}),[Z,ie]=A.useState({x:0,y:0}),[Ce,tt]=A.useState(!1),Oe=8;A.useEffect(()=>{if(!L)return;const b=Y=>{G({x:Y.clientX,y:Y.clientY});const W=Math.abs(Y.clientX-Z.x),le=Math.abs(Y.clientY-Z.y);(W>Oe||le>Oe)&&tt(!0)},H=()=>{U(null),tt(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[L,Z]);const pe=ft.useRef(!1),Ge=A.useCallback(async({event:b,start:H,end:Y})=>{if(b.isASVisit||b.isExpectedPayment){oe.error("    ");return}const W=H instanceof Date?H:new Date(H),le=Y instanceof Date?Y:new Date(Y);if(nn.current)try{const ye=b.mergedEventIds||[b.id],dt=n.filter(bt=>ye.includes(bt.id));for(const bt of dt)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:bt.title,start:W,end:le,project:bt.project,attendees:bt.attendees||[],time:bt.time,priority:bt.priority||"medium"});oe.success(" ")}catch(ye){console.error("  :",ye),oe.error("  ")}else{const ye=b.mergedEventIds||[b.id];try{for(const dt of ye)await o(dt,{start:W,end:le})}catch(dt){console.error("  :",dt),oe.error("  "),r()}}},[n,o,i,r]),pn=A.useCallback(({event:b,action:H})=>{var W;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((W=le.textContent)!=null&&W.includes(b.originalTitle||b.title)){const Ne=le.getBoundingClientRect();ie({x:Ne.left,y:Ne.top}),G({x:Ne.left,y:Ne.top});break}tt(!1),U(b)},[]),Qt=A.useCallback(async(b,H,Y=!1)=>{if(Ee==="all"){oe.error("  ");return}const W={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(W)}catch(le){console.error("  :",le),oe.error("  ")}},[Ee,i,y]),Mt=A.useCallback(({start:b})=>{const H=O||ke.current;H&&Ee!=="all"&&(Re.current=!0,_t.current=!0,requestAnimationFrame(()=>{_t.current=!1}),bn(null),Rn(null),es(""),Qt(H,b),requestAnimationFrame(()=>{ve(null),ke.current=null,Re.current=!1}))},[O,Ee,Qt]),Bt=A.useCallback(()=>{const b=O||ke.current;return b?{title:b}:null},[O]),Fn=A.useCallback(async b=>{if(!b.trim()||!wt||Ee==="all"){bn(null);return}const H=wt;bn(null);const Y={id:"",title:b.trim(),start:H,end:H,type:"construction",project:Ee,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}},[wt,Ee,i,y]),Wn=A.useCallback(()=>{bn(null)},[]),Yt=A.useCallback(async()=>{var b;if(!un||!gs.trim()){Rn(null),es("");return}try{const H=((b=un.mergedEventIds)==null?void 0:b[0])||un.id;await o(H,{title:gs.trim()})}catch(H){console.error("  :",H),oe.error("  ")}Rn(null),es("")},[un,gs,o]),Qe=A.useCallback(async b=>{ee(Y=>[...Y,b]);const H=b.mergedEventIds||[b.id];oe.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),oe.error("  "),ee(W=>W.slice(0,-1))}Rn(null),es("")},[l]),we=Ee==="all"?Ht:Ht.filter(b=>(b.originalProjectName||b.projectName)===Ee),nt=ft.useMemo(()=>{const b=Ee!=="all",H=new Map;we.forEach(W=>{const le=mt(W.start).format("YYYY-MM-DD");H.has(le)||H.set(le,[]),H.get(le).push(W)});const Y=[];return H.forEach(W=>{if(b)W.forEach((le,Ne)=>{const ye=mt(le.start).startOf("day").add(Ne,"milliseconds").toDate();Y.push({...le,start:ye,allDay:!1})});else{const le=[],Ne=[];W.forEach(ye=>{Ze(ye)?le.push(ye):Ne.push(ye)}),le.forEach((ye,dt)=>{const bt=mt(ye.start).startOf("day").add(dt,"milliseconds").toDate();Y.push({...ye,start:bt,allDay:!1})}),Ne.forEach((ye,dt)=>{const bt=mt(ye.start).startOf("day").add(1e3+dt,"milliseconds").toDate();Y.push({...ye,start:bt,allDay:!1})})}}),Y.sort((W,le)=>W.start.getTime()-le.start.getTime())},[we,Ze,Ee]),rt=ft.useMemo(()=>{if(wt&&Ee!=="all"){const b=mt(wt).format("YYYY-MM-DD"),H=nt.filter(Ne=>mt(Ne.start).format("YYYY-MM-DD")===b),Y=H.length>0?Math.max(...H.map(Ne=>Ne.start.getTime())):mt(wt).startOf("day").valueOf(),W=new Date(Y+1),le={id:"__inline_add__",title:"",start:W,end:W,projectId:"",projectName:Ee,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...nt,le]}return nt},[nt,wt,Ee]);A.useEffect(()=>{(y==null?void 0:y.name)===""&&C.length>0&&(Ee==="all"||!C.find(b=>b.name===Ee))&&Mn(C[0].name)},[C,y]),A.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(ye=>{ye.style.display="none",ye.style.visibility="hidden",ye.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(ye=>{ye.style.display="none",ye.style.visibility="hidden",ye.style.opacity="0",ye.style.pointerEvents="none",ye.style.position="absolute",ye.style.left="-9999px",ye.style.top="-9999px",ye.style.zIndex="-1"})};b();const H=new MutationObserver(b),Y=document.querySelector(".rbc-calendar");Y&&H.observe(Y,{childList:!0,subtree:!0});const W=new MutationObserver(b);return W.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),W.disconnect()}},[Gt,P]);const[it,qe]=A.useState({date:null,projectId:"",title:""}),ot=ft.useRef(!1),Lt=ft.useRef(null),mn=b=>{if(pe.current){pe.current=!1;return}if(b.id==="__inline_add__")return;ot.current=!0,Lt.current&&clearTimeout(Lt.current);const H=Ee!=="all",Y=window.innerWidth<768;if(H&&!Y&&!b.isASVisit&&!b.isExpectedPayment)bn(null),Rn(b),es(b.originalTitle||b.title);else{const W={...b,title:b.originalTitle||b.title};We(null),de(W),xe(!0)}Lt.current=setTimeout(()=>{ot.current=!1,Lt.current=null},300)},sn=b=>{const H=window.innerWidth,Y=H<768,W=H>=768&&H<1024,le=Ee==="all";if(_t.current)return;if(Y){if(b.start){et(b.start);const ye=document.querySelector(".md\\:hidden.mt-3.bg-white");ye&&ye.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const Ne=b.action==="click"||b.action==="select";if(!(W&&!Ne)){if(le){ot.current=!1,Rn(null),es(""),bn(null),We(b),de(null),xe(!0);return}if(!ot.current){if(ue){Qt(ue,b.start,!0);return}Rn(null),es(""),bn(b.start)}}},As=async()=>{if(!it.projectId||!it.title.trim()){alert("  ");return}const b=C.find(H=>H.id===it.projectId);if(!(!b||!it.date))try{await i({id:Date.now().toString(),title:it.title,start:it.date,end:it.date,type:"other",project:b.name,location:"",attendees:[],description:""}),qe({date:null,projectId:"",title:""}),et(null)}catch(H){console.error("Failed to add schedule:",H),oe.error("  ")}},xr=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Y="#1f2937";if(b.isASVisit)H="#E8F5E9",Y="#1f2937";else{const W=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&T&&["",""].includes(T),Ne=b.assignedTo&&b.assignedTo.includes("")&&T&&["","",""].includes(T);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||W||le||Ne?(H="#FEF3C7",Y="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},ta=ft.useCallback(b=>{const H=mt(b).format("YYYY-MM-DD"),Y=!!tl[H],W=ne&&mt(b).isSame(ne,"day"),le=window.innerWidth<768;let Ne="";W&&(Ne+="selected-date "),Y&&(Ne+="holiday-date ");const ye=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:Ne.trim(),style:ye}},[ne]),[vt,Ki]=A.useState(window.innerWidth<768);A.useEffect(()=>{const b=()=>{Ki(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),A.useEffect(()=>{const b=()=>{const H=ne||new Date;We({start:H,end:H}),de(null),xe(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ne]);const vr=ft.useCallback(({date:b,label:H})=>a.jsxDEV(j2,{date:b,label:H,filteredEvents:rt,selectedDate:ne,user:y,isMobileView:vt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[rt,ne,y,vt]),_r=ft.useRef(gs);_r.current=gs;const Pl=ft.useCallback(b=>{es(b)},[]),na=ft.useCallback(()=>{Rn(null),es("")},[]),Ll=ft.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(L2,{onSave:Fn,onCancel:Wn,processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(un==null?void 0:un.id)===b.id||(un==null?void 0:un.mergedEventIds)&&un.mergedEventIds.includes(b.id);return a.jsxDEV(R2,{event:b,user:y,filterProject:Ee,isEditing:H,editTitle:H?_r.current:void 0,onEditTitleChange:H?Pl:void 0,onEditSave:H?Yt:void 0,onEditDelete:H?()=>Qe(b):void 0,onEditCancel:H?na:void 0,onHoverDelete:()=>Qe(b),onDeleteAction:()=>{pe.current=!0},processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,Ee,un,Yt,Qe,Fn,Wn,Pl,na,me]),Qu=({onNavigate:b})=>{const[H,Y]=ft.useState(!1),[W,le]=ft.useState(mt(P).year()),[Ne,ye]=ft.useState(mt(P).month()),dt=window.innerWidth<768,bt=()=>{le(mt(P).year()),ye(mt(P).month()),Y(!0)},xn=()=>{q(mt().year(W).month(Ne).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${dt?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:bt,children:[a.jsxDEV("span",{children:mt(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ee==="all"?" ":Ee]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ee,onChange:jt=>{Mn(jt.target.value),Et(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),C.filter(jt=>jt.status!=="completed").map(jt=>a.jsxDEV("option",{value:jt.name,children:jt.name},jt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(W-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[W,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(W+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(jt=>{const Rt=Ne===jt-1,dn=mt().year()===W&&mt().month()===jt-1;return a.jsxDEV("button",{onClick:()=>ye(jt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Rt?"bg-gray-900 text-white":dn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[jt,""]},jt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{q(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:xn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},Yu=()=>null,Xu=A.useMemo(()=>({toolbar:Qu,event:Ll,month:{dateHeader:vr,showMore:Yu}}),[vr,Ll]),Dr=ft.useMemo(()=>{if(!ne)return[];let b;if(vt)b=rt.filter(Y=>mt(Y.start).isSame(ne,"day"));else{const Y=mt(ne).startOf("week"),W=mt(ne).endOf("week");b=rt.filter(le=>{const Ne=mt(le.start);return Ne.isSameOrAfter(Y,"day")&&Ne.isSameOrBefore(W,"day")})}const H=[...b].sort((Y,W)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),Ne=Y.assignedTo&&Y.assignedTo.includes("")&&T&&["",""].includes(T),ye=Y.assignedTo&&Y.assignedTo.includes("")&&T&&["","",""].includes(T),dt=Y.assignedTo&&T&&Y.assignedTo.includes(T)||Y.assignedTo&&(y==null?void 0:y.name)&&Y.assignedTo.includes(y.name)||le||Ne||ye,bt=W.assignedTo&&W.assignedTo.includes("HV LAB"),xn=W.assignedTo&&W.assignedTo.includes("")&&T&&["",""].includes(T),jt=W.assignedTo&&W.assignedTo.includes("")&&T&&["","",""].includes(T),Rt=W.assignedTo&&T&&W.assignedTo.includes(T)||W.assignedTo&&(y==null?void 0:y.name)&&W.assignedTo.includes(y.name)||bt||xn||jt;return dt&&!Rt?-1:!dt&&Rt?1:new Date(Y.start).getTime()-new Date(W.start).getTime()});return console.log("Sorted events:",H.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:y==null?void 0:y.name,userShort:T}))),H},[ne,rt,y,T,vt]);return A.useEffect(()=>{const H=setTimeout(()=>{const Y=vt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),W=document.querySelectorAll(".rbc-month-row"),le=[];W.forEach((Ct,on)=>{const Nn=Ct.querySelectorAll(".rbc-date-cell");let Xt=0;Nn.forEach(en=>{const Nt=en.querySelector("button");let rn=Nt==null?void 0:Nt.textContent;if(!rn){const Es=en.querySelector("span");rn=Es==null?void 0:Es.textContent}if(rn&&!isNaN(parseInt(rn))){const Es=mt(P).date(parseInt(rn)),Os=rt.filter(Gi=>mt(Gi.start).isSame(Es,"day"));Xt=Math.max(Xt,Os.length)}}),le.push(Xt)});const Ne=Ee&&Ee!=="all",ye=100,dt=Ne?60:18,bt=25,xn=Math.floor((ye-bt)/dt),jt=le.length,Rt=ye*jt,dn=le.map(Ct=>Ct<=xn?ye:bt+Ct*dt+10),In=dn.reduce((Ct,on)=>Ct+on,0);if(In>Rt){const Ct=dn.map((Xt,en)=>({index:en,height:Xt,overflow:Xt>ye})),on=Ct.filter(Xt=>Xt.overflow).reduce((Xt,en)=>Xt+(en.height-ye),0),Nn=Ct.filter(Xt=>!Xt.overflow);if(Nn.length>0){const Xt=Rt-on-Nn.length*ye,en=Math.max(50,ye+Xt/Nn.length);W.forEach((Nt,rn)=>{const Os=dn[rn]>ye?dn[rn]:en;Nt.style.height=`${Os}px`,Nt.style.minHeight=`${Os}px`})}else{const Xt=Rt/In;W.forEach((en,Nt)=>{const rn=Math.max(80,dn[Nt]*Xt);en.style.height=`${rn}px`,en.style.minHeight=`${rn}px`})}}else{const Ct=dn.reduce((en,Nt)=>en+(Nt>ye?Nt:0),0),on=dn.filter(en=>en<=ye).length,Nn=Rt-Ct,Xt=on>0?Nn/on:ye;W.forEach((en,Nt)=>{const rn=dn[Nt]>ye?dn[Nt]:Xt;en.style.height=`${rn}px`,en.style.minHeight=`${rn}px`})}Y.forEach(Ct=>{const on=Ct.querySelector("button");let Nn=on==null?void 0:on.textContent;if(!Nn){const rn=Ct.querySelector("span");Nn=rn==null?void 0:rn.textContent}if(!Nn||isNaN(parseInt(Nn)))return;const Xt=mt(P).date(parseInt(Nn)),en=rt.filter(rn=>mt(rn.start).isSame(Xt,"day"));en.length>0?Ct.setAttribute("data-event-count",en.length.toString()):Ct.removeAttribute("data-event-count");const Nt=Xt.clone().toDate();if(ne&&mt(Nt).isSame(ne,"day")?Ct.classList.add("selected-date"):Ct.classList.remove("selected-date"),vt){const rn=Ct,Es=rn._mobileClickHandler;Es&&Ct.removeEventListener("click",Es);const Os=Gi=>{if(Gi.target.closest(".rbc-event"))return;const Qi=Xt.clone().toDate();et(Qi);const Vs=document.querySelector(".md\\:hidden.mt-3.bg-white");Vs&&Vs.scrollIntoView({behavior:"smooth",block:"nearest"})};rn._mobileClickHandler=Os,Ct.addEventListener("click",Os,!0),Ct.style.cursor="pointer",Ct.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),vt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(W=>{const le=W,Ne=le._mobileClickHandler;Ne&&(W.removeEventListener("click",Ne),delete le._mobileClickHandler)})}},[rt,P,vt,ne,Ee]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[it.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:mt(it.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:it.projectId,onChange:b=>qe({...it,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:C.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:it.title,onChange:b=>qe({...it,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&As()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:As,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{qe({date:null,projectId:"",title:""}),et(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ee!=="all"&&!vt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>V(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:me.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{Et(ue===b?null:b)},onDragStart:H=>{Re.current=!1,Et(null),ve(b),ke.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Re.current||(ve(null),ke.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===b?"bg-blue-500 text-white ring-2 ring-blue-300":O===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ee!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(S2,{localizer:P2,events:rt,startAccessor:"start",endAccessor:"end",view:Gt,onView:pt,date:P,onNavigate:q,onSelectEvent:mn,onSelectSlot:sn,onEventDrop:Ee!=="all"?Ge:void 0,onDragStart:Ee!=="all"?pn:void 0,onDropFromOutside:Ee!=="all"?Mt:void 0,dragFromOutsideItem:Ee!=="all"?Bt:void 0,draggableAccessor:b=>Ee!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:xr,dayPropGetter:ta,components:Xu,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${Ee}-${(ne==null?void 0:ne.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ne&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:vt?mt(ne).format("MM DD (ddd)"):`${mt(ne).startOf("week").format("MM DD")} - ${mt(ne).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),tl[mt(ne).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:tl[mt(ne).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ee!=="all"&&a.jsxDEV("button",{onClick:()=>Q(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{et(null),os(null),Q(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:Dr.length===0?a.jsxDEV("div",{className:"p-4",children:Ee!=="all"&&D?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=Dr.reduce((Y,W)=>{const le=mt(W.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(W),Y},{});return Object.keys(b).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!vt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:mt(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Y].map(W=>{const le=W.assignedTo&&W.assignedTo.includes("HV LAB"),Ne=W.assignedTo&&W.assignedTo.includes("")&&T&&["",""].includes(T),ye=W.assignedTo&&W.assignedTo.includes("")&&T&&["","",""].includes(T),bt=W.assignedTo&&(W.assignedTo.includes((y==null?void 0:y.name)||"")||T&&W.assignedTo.includes(T))||le||Ne||ye,xn=!W.color&&!bt,jt=!W.isASVisit&&!W.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Rt={...W,title:W.originalTitle||W.title};mn(Rt)},className:`p-3 cursor-pointer ${bt?"bg-yellow-50":""}`,style:xn?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:bt?"#FEF3C7":W.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:W.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),W.assignedTo&&W.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(In=>W.assignedTo.includes(In))?"":W.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),W.projectName&&Ee==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:W.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),jt?a.jsxDEV("button",{onClick:Rt=>{Rt.stopPropagation(),os(W)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ee!=="all"&&D&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),vt&&Ee!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:me.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=ne||new Date;if(Ee!=="all"){const Y={id:"",title:b,start:H,end:H,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),te&&a.jsxDEV(P0,{event:ce,slotInfo:Se,defaultProjectName:Ee!=="all"?Ee:void 0,onClose:()=>{xe(!1),de(null),We(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ce)if(ce.id.startsWith("as-")){const H=ce.id.replace("as-","");let Y="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Y=b.assignedTo.join(", "):ce.assignedTo&&Array.isArray(ce.assignedTo)?Y=ce.assignedTo.join(", "):typeof ce.assignedTo=="string"&&(Y=ce.assignedTo),await m(H,{project:b.title||ce.title,assignedTo:Y,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ce.time}),await d(),xe(!1)}else if(ce.id.startsWith("payment-")){const H=ce.id.split("-"),Y=H[1],W=H[2],le=f.find(Ne=>Ne.id===Y);if(le){const Ne={...le.expectedPaymentDates};Ne[W]=b.start,await p(Y,{expectedPaymentDates:Ne})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Y,""),ce.mergedEventIds&&ce.mergedEventIds.length>0){console.log(" Updating merged schedules:",ce.mergedEventIds);const W=(ce.originalTitle||ce.title).split(", "),le=H.split(", ");for(let Ne=0;Ne<ce.mergedEventIds.length;Ne++){const ye=ce.mergedEventIds[Ne],dt=le[Ne]||W[Ne]||H;await o(ye,{title:dt.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ce.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}xe(!1)}catch(H){console.error("Failed to save schedule:",H),oe.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Y=H[1],W=H[2],le=f.find(Ne=>Ne.id===Y);if(le){const Ne={...le.expectedPaymentDates};delete Ne[W],await p(Y,{expectedPaymentDates:Ne})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=Ht.find(Y=>Y.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Y of H.mergedEventIds)await l(Y)}else await l(b)}xe(!1)}catch(H){console.error("Failed to delete schedule:",H),oe.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),L&&Ce&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:X.x-50,top:X.y-15,backgroundColor:L.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:L.originalTitle||L.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Fs&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>os(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Fs.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>os(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=Fs.mergedEventIds||[Fs.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),oe.error(" ")}os(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{V(!1),k(null),S("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{V(!1),k(null),S("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>S(b.target.value),onKeyDown:b=>b.key==="Enter"&&Be(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Be,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:ge?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((b,H)=>a.jsxDEV("div",{draggable:(I==null?void 0:I.id)!==b.id,onDragStart:()=>ut(H),onDragOver:Y=>Tt(Y,H),onDragEnd:ct,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${yt===H?"opacity-50 bg-gray-100":""} ${qt===H?"border-t-2 border-gray-400":""} ${(I==null?void 0:I.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(I==null?void 0:I.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:Ae,onChange:Y=>$e(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Xe(),Y.key==="Escape"&&(k(null),$e(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:Xe,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),$e("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),$e(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>Dt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},U2=({projectName:n,onClose:e,type:t="cash"})=>{const s=t==="cash",r=s?"":"",i=s?"      .":"      .",[o,l]=A.useState({receiptDate:$t(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const p=Number(f.replace(/,/g,""));return isNaN(p)?"":p.toLocaleString()},d=f=>{if(f===0)return"";const p=["","","",""],y=["","","",""],C=["","","","","","","","","",""];let v="",w=0;for(;f>0;){const B=f%1e4;if(B>0){let T="",F=B,re=0;for(;F>0;){const ee=F%10;ee>0&&(T=C[ee]+y[re]+T),F=Math.floor(F/10),re++}v=T+p[w]+v}f=Math.floor(f/1e4),w++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(An,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const p=f.target.value.replace(/,/g,"");/^\d*$/.test(p)&&l({...o,amount:p})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Zg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:$t(new Date(o.receiptDate),"yyyy MM dd",{locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:$t(new Date(o.receiptDate),"yyyy MM dd",{locale:kn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},H2="HVLabImageDB",M2=1,Jr="paymentRecordImages";let lc=null;const Yf=()=>new Promise((n,e)=>{if(lc){n(lc);return}const t=indexedDB.open(H2,M2);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{lc=t.result,n(lc)},t.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(Jr)||r.createObjectStore(Jr,{keyPath:"id"})}}),F2=async()=>{try{const n=await Yf();return new Promise((e,t)=>{const i=n.transaction(Jr,"readonly").objectStore(Jr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(n){console.error("IndexedDB , localStorage :",n);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},O2=async(n,e)=>{try{const t=await Yf();return new Promise((s,r)=>{const l=t.transaction(Jr,"readwrite").objectStore(Jr).put({id:n,images:e});l.onsuccess=()=>s(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},q2=async n=>{try{const e=await Yf();return new Promise((t,s)=>{const r=e.transaction(Jr,"readwrite"),i=r.objectStore(Jr);i.clear(),Object.entries(n).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},$2=async()=>{try{const n=localStorage.getItem("paymentRecordImages");if(n){const e=JSON.parse(n);Object.keys(e).length>0&&(await q2(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(n){console.error(" :",n)}},cc=n=>{if(!n)return 0;try{const t=new Date(n).getTime();return isNaN(t)?0:t}catch{return 0}},Kg=(n,e,t)=>{if(!n)return null;try{const s=new Date(n);return isNaN(s.getTime())?null:$t(s,e,t)}catch{return null}},z2=()=>{const{payments:n,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=Xr(),{user:l}=si(),u=Mu(),[m,d]=A.useState(""),[f,p]=A.useState(null),[y,C]=A.useState(null),[v,w]=A.useState(!1),[B,T]=A.useState(!1),[F,re]=A.useState(!1),[ee,M]=A.useState(!1),[E,N]=A.useState(""),[V,j]=A.useState("form"),[S,I]=A.useState(!1),[k,Ae]=A.useState(!1),$e=A.useRef(null),[ge,He]=A.useState("pending"),[yt,Kt]=A.useState("all"),[qt,ae]=A.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[ze,me]=A.useState(!1),[Be,Xe]=A.useState(null),[Dt,ut]=A.useState(!1),[Tt,ct]=A.useState(""),[ht,yn]=A.useState(!1),K=A.useRef(!1),je=A.useRef(!1),Me=A.useRef(null),[Pe,Ze]=A.useState([]),[Pt,Gt]=A.useState([]),[pt,P]=A.useState(null),[q,te]=A.useState([]),[xe,ce]=A.useState([]),[de,Se]=A.useState(!1),[We,st]=A.useState({}),[Ee,Mn]=A.useState(!1),Ht=()=>{const D=localStorage.getItem("lastSelectedProject"),Q=u.filter(R=>R.status!=="completed");return D&&Q.some(R=>R.name===D)?D:Q.length>0?Q[0].name:""},[ne,et]=A.useState({project:"",date:$t(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});A.useEffect(()=>{(async()=>{try{const Q=await mr.getAllContractors();Ze(Q.map(R=>({id:R._id||R.id,rank:R.rank,companyName:R.companyName,name:R.name,process:R.process,contact:R.contact,accountNumber:R.accountNumber,bankName:R.bankName,notes:R.notes,createdAt:new Date(R.createdAt),updatedAt:new Date(R.updatedAt)})))}catch(Q){console.error("Failed to load contractors:",Q)}})()},[]),A.useEffect(()=>{Kt("all"),t().catch(Q=>{console.error("Failed to load projects:",Q)}),e().catch(Q=>{console.error("Failed to load payments:",Q)});const D=()=>{I(window.innerWidth<1024)};if(D(),window.addEventListener("resize",D),u.length>0&&!ne.project&&!je.current){const Q=Ht();Q&&(et(R=>({...R,project:Q})),localStorage.setItem("lastSelectedProject",Q))}return()=>window.removeEventListener("resize",D)},[]),A.useEffect(()=>{const D=setInterval(()=>{if(Me.current){console.log("[ ]     - ");return}console.log("[ ]    ..."),e().catch(R=>{console.error("[ ] :",R)})},3e4),Q=()=>{if(document.visibilityState==="visible"){if(Me.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(R=>{console.error("[ ] :",R)})}};return document.addEventListener("visibilitychange",Q),()=>{clearInterval(D),document.removeEventListener("visibilitychange",Q)}},[e]),A.useEffect(()=>{let D=jr.getSocket(),Q=0,R=null;const x=U=>{if(console.log(" [ ]    :",U),Me.current&&String(U.paymentId)===Me.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(X=>{console.error("[ ]  :",X)})},L=()=>(D=jr.getSocket(),D?(console.log(" [Payments] Socket  , payment:refresh  "),D.on("payment:refresh",x),R&&(clearInterval(R),R=null),!0):!1);return L()||(console.log(" [Payments] Socket  ..."),R=setInterval(()=>{Q++,(L()||Q>=10)&&(R&&(clearInterval(R),R=null),Q>=10&&!jr.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{R&&clearInterval(R);const U=jr.getSocket();U&&U.off("payment:refresh",x)}},[e]),A.useEffect(()=>{(async()=>{var x,L,U,X;if(K.current)return;const Q=new URLSearchParams(window.location.search),R=Q.get("complete")||Q.get("c");if(R){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",R),window.history.replaceState({},"","/payments"),je.current=!0,j("list"),He("completed"),Kt("all"),et(G=>({...G,project:""})),o(String(R),{status:"completed",completionDate:new Date}),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(R),{status:"completed"}),await e();const G=jr.getSocket();G&&G.emit("payment:refresh",{paymentId:R,status:"completed",updatedAt:new Date().toISOString()})}catch(G){console.error("[ ]  :",G),o(String(R),{status:"pending",completionDate:void 0}),He("pending");let Z="  ";((x=G.response)==null?void 0:x.status)===401?Z=" .  ":((L=G.response)==null?void 0:L.status)===404?Z="     (ID: "+R+")":(X=(U=G.response)==null?void 0:U.data)!=null&&X.error?Z=G.response.data.error:G.message&&(Z+=": "+G.message),oe.error(Z)}}})()},[e,i,o,l]),A.useEffect(()=>{if(ne.process){const D=new Set(n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).map(L=>L.bankInfo.accountHolder.trim().toLowerCase())),Q=(L,U)=>{const X=L.toLowerCase(),G=U.toLowerCase();if(X.includes(G)||G.includes(X))return!0;const Z=X.split("/").map(Ce=>Ce.trim()),ie=G.replace(/$/,"").trim();for(const Ce of Z)if(Ce===ie||ie.includes(Ce)||Ce.includes(ie))return!0;return!1},x=Pe.filter(L=>{if(!Q(ne.process,L.process))return!1;const X=L.accountNumber&&L.accountNumber.trim()!=="",G=L.name.trim().toLowerCase(),Z=D.has(G);return X||Z}).sort((L,U)=>{const X=L.accountNumber&&L.accountNumber.trim()!=="",G=U.accountNumber&&U.accountNumber.trim()!=="";return X&&!G?-1:!X&&G?1:0});Gt(x)}else Gt([])},[ne.process,Pe,n]),A.useEffect(()=>{if(ne.process){const D=(x,L)=>{if(!L)return!1;const U=x.toLowerCase(),X=L.toLowerCase();if(U.includes(X)||X.includes(U))return!0;const G=U.split("/").map(ie=>ie.trim()),Z=X.replace(/$/,"").trim();for(const ie of G)if(ie===Z||Z.includes(ie)||ie.includes(Z))return!0;return!1},Q=n.filter(x=>{var L,U,X;return x.status==="completed"&&x.process&&D(ne.process,x.process)&&((L=x.bankInfo)==null?void 0:L.accountHolder)&&((U=x.bankInfo)==null?void 0:U.bankName)&&((X=x.bankInfo)==null?void 0:X.accountNumber)}),R=new Map;Q.forEach(x=>{const L=`${x.bankInfo.accountHolder}_${x.bankInfo.bankName}_${x.bankInfo.accountNumber}`;R.has(L)||R.set(L,{accountHolder:x.bankInfo.accountHolder,bankName:x.bankInfo.bankName,accountNumber:x.bankInfo.accountNumber,itemName:x.itemName||"",amount:x.amount||0})}),te(Array.from(R.values()))}else te([])},[ne.process,n]),A.useEffect(()=>{var Q;const D=((Q=ne.accountHolder)==null?void 0:Q.trim())||"";if(D.length>=1&&de){const R=[],x=new Set;Pe.filter(L=>L.accountNumber&&L.accountNumber.trim()!=="").forEach(L=>{const U=L.name.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankName||"",accountNumber:L.accountNumber||"",source:"contractor"}))}),n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).forEach(L=>{const U=L.bankInfo.accountHolder.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankInfo.bankName||"",accountNumber:L.bankInfo.accountNumber||"",source:"payment"}))}),ce(R)}else ce([])},[ne.accountHolder,de,Pe,n]);const O=D=>{const Q=D.split(`
`).map(G=>G.trim()).filter(G=>G),R={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},x=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],L=G=>{const Z=["","","","","","","",""];for(const ie of Z)if(G.endsWith(ie)&&G.length>ie.length+1)return G.slice(0,-ie.length);return G},U=G=>{if(!G||G.length<2||G.length>5||!/^[-]{2,5}$/.test(G)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G))return!1;if(G.length>=2){const Ce=G.charAt(0),tt=G.substring(0,2);if(["","","","","","",""].includes(tt)||x.includes(Ce))return!0}return G.length>=2&&G.length<=4},X=Q.some(G=>G.includes(" ")||G.includes(""));if(Q.forEach((G,Z)=>{if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.itemName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountHolder=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.bankName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountNumber=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*([\d,]+)?/);ie&&(R.amounts.total=parseInt(ie[1].replace(/,/g,"")))}}),!X){let G=-1;if(Q.forEach(Z=>{const ie=Z.match(/\[([^\]]+)\]/);ie&&!R.itemName&&(R.itemName=ie[1].trim())}),Q.forEach((Z,ie)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){R.includeVat=!0;const Qe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),we=Z.match(/(\d+)\s*\s*?/),nt=Z.match(/([\d,]+)\s*/);if(Qe){const rt=parseInt(Qe[1])*1e4+parseInt(Qe[2])*1e3;R.amounts.total=rt}else if(we){const rt=parseInt(we[1])*1e4;R.amounts.total=rt}else if(nt){const rt=parseInt(nt[1].replace(/,/g,""));rt>=1e3&&(R.amounts.total=rt)}return}const tt=Z.match(/=\s*([\d,]+)\s*?/);let Oe=null;if(tt){const Qe=parseInt(tt[1].replace(/,/g,""));Qe>=1e3&&(R.amounts.total=Qe)}else{const Qe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Qe){const we=parseInt(Qe[1])*1e4,nt=parseInt(Qe[2])*1e3,rt=we+nt;Z.includes("")||Z.includes("")?R.amounts.material=rt:Z.includes("")||Z.includes("")?R.amounts.labor=rt:R.amounts.total||(R.amounts.total=rt),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Oe=Qe}else if(Oe=Z.match(/(\d+)\s*\s*?/),Oe){const we=parseInt(Oe[1])*1e4;Z.includes("")||Z.includes("")?R.amounts.material=we:Z.includes("")||Z.includes("")?R.amounts.labor=we:R.amounts.total||(R.amounts.total=we),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(we=>{const nt=we.trim();nt.startsWith("[")||nt.endsWith("]")||(/^[\d\-]+$/.test(nt)&&nt.replace(/\-/g,"").length>=10?R.bankInfo.accountNumber||(R.bankInfo.accountNumber=nt):U(nt)&&!R.bankInfo.accountHolder&&(R.bankInfo.accountHolder=nt))});const pe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Ge="",pn=-1;for(const Qe of pe){const we=Z.match(Qe);if(we&&!R.bankInfo.accountNumber){Ge=we[0],pn=we.index||-1,R.bankInfo.accountNumber=we[0].trim().replace(/\s+/g,"-");const rt=Z.substring(pn+Ge.length).trim().split(/\s+/);for(const it of rt){if(it.startsWith("[")||it.endsWith("]"))continue;const qe=L(it);if(U(qe)){R.bankInfo.accountHolder=qe;break}}if(!R.bankInfo.accountHolder&&ie>0){const qe=Q[ie-1].split(/\s+/);for(const ot of qe){if(ot.startsWith("[")||ot.endsWith("]"))continue;const Lt=L(ot);if(U(Lt)){R.bankInfo.accountHolder=Lt;break}}}if(!R.bankInfo.accountHolder&&ie+1<Q.length){const it=Q[ie+1],qe=it.split(/\s+/);for(const ot of qe){if(ot.startsWith("[")||ot.endsWith("]"))continue;const Lt=L(ot);if(U(Lt)){R.bankInfo.accountHolder=Lt;break}}if(!R.bankInfo.accountHolder){const ot=it.match(/^([-]{2,6})/);if(ot){const Lt=L(ot[1].trim());U(Lt)&&(R.bankInfo.accountHolder=Lt)}}}break}}const Qt=Z.match(/[\d,]+/g);if(Qt){const Qe=Ge?Ge.split(/[\s\-]+/).filter(we=>we):[];Qt.forEach(we=>{const nt=parseInt(we.replace(/,/g,"")),rt=we.replace(/,/g,""),it=Qe.some(qe=>qe===rt);!R.bankInfo.accountNumber&&rt.length>=10&&rt.length<=20?(R.bankInfo.accountNumber=rt,Ge=rt):nt>=1e3&&!Oe&&!it&&(Z.includes("")||Z.includes("")?R.amounts.material=nt:Z.includes("")||Z.includes("")?R.amounts.labor=nt:R.amounts.total||(R.amounts.total=nt))})}const Mt={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Bt=Object.keys(Mt).sort((Qe,we)=>we.length-Qe.length);for(const Qe of Bt)if(Z.includes(Qe)){const we=Mt[Qe];R.bankInfo.bankName=we,G=ie;const nt=new RegExp(`${Qe}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),rt=Z.match(nt);if(rt){const it=L(rt[1]);it&&!/^\d+$/.test(it)&&it!==""&&(R.bankInfo.accountHolder=it)}break}if(!R.bankInfo.bankName){const Qe=Z.match(/([-]+)(|)/);Qe&&(R.bankInfo.bankName=Qe[0])}const Fn=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Qe of Fn){const we=Z.match(Qe);if(we&&!R.bankInfo.accountHolder){R.bankInfo.accountHolder=we[0].trim();break}}const Wn=Z.match(/\(([-]{2,5})\)/);if(Wn&&!R.bankInfo.accountHolder){const Qe=Wn[1];U(Qe)&&!["","",""].includes(Qe)&&(R.bankInfo.accountHolder=Qe)}if(!R.bankInfo.accountHolder){const Qe=/[-]{2,6}/g,we=Z.match(Qe);if(we){const nt=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),rt=Z.match(/||||/);we.forEach(it=>{const qe=L(it),ot=D.split(`
`)[ie];if(ot&&ot.includes(`[${it}]`)||!U(qe)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(qe))return;const mn=Z.indexOf(it);if(mn>0){const sn=Z[mn-1];if(/[-]/.test(sn))return}if(mn+it.length<Z.length){const sn=Z[mn+it.length];if(/[-]/.test(sn))return}if(!(Wn&&qe===Wn[1])){if((nt||rt)&&!R.bankInfo.accountHolder)R.bankInfo.accountHolder=qe;else if(!R.bankInfo.accountHolder){const sn=/||||/,As=/\d{6,}/;(ie>0&&(As.test(Q[ie-1])||sn.test(Q[ie-1]))||ie<Q.length-1&&(As.test(Q[ie+1])||sn.test(Q[ie+1]))||sn.test(Z))&&(R.bankInfo.accountHolder=qe)}}})}}const Yt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Qe,we]of Object.entries(Yt))if(Z.includes(Qe)){R.vendor=we;break}if(ie===0&&!R.itemName){const Qe=Z.replace(/[\[\]{}()<>]/g,"").trim();Qe&&!Qe.includes(" ")&&(U(Qe)||(R.itemName=Qe.substring(0,50)))}}),G>=0&&G+1<Q.length){const Z=Q[G+1],ie=Z.trim();if(/^[-]{2,5}$/.test(ie)&&U(ie))R.bankInfo.accountHolder=ie;else{const Ce=Z.split(/\s+/);for(const tt of Ce){const Oe=L(tt);if(U(Oe)){R.bankInfo.accountHolder=Oe;break}}}}}if(R.itemName&&R.itemName.includes("")&&(R.vendor=""),R.itemName){const G=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=R.itemName.toLowerCase(),ie=G.some(pe=>Z===pe.toLowerCase()||Z.startsWith(pe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Ce=/^[\d\-\s]/.test(R.itemName),tt=/^\d{2,}[\s\-]?\d+/.test(R.itemName.replace(/[-]/g,"").trim()),Oe=R.bankInfo.accountHolder&&(R.itemName===R.bankInfo.accountHolder||R.itemName.includes(R.bankInfo.accountHolder));(ie||Ce||tt||Oe)&&(R.itemName=void 0)}return R},ve=async()=>{var D,Q,R,x,L,U,X,G,Z,ie,Ce;try{const tt=ne.quickText;if(!tt.trim())return;let Oe=n;n.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(we=>setTimeout(we,100)),Oe=Xr.getState().payments,console.log("payments  :",Oe.length,""));const pe=O(tt);console.log("  :",pe);const Ge={project:ne.project,date:ne.date,quickText:ne.quickText,quickImages:ne.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),T(!1),re(!1);let pn=0;pe.amounts.material&&(pn+=pe.amounts.material),pe.amounts.labor&&(pn+=pe.amounts.labor),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&(pn=pe.amounts.total),pn>0&&(Ge.amount=pn),pe.bankInfo.bankName&&(Ge.bankName=pe.bankInfo.bankName),pe.bankInfo.accountHolder&&(Ge.accountHolder=pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&(Ge.accountNumber=pe.bankInfo.accountNumber);const Qt=we=>we?we.replace(/[^0-9]/g,""):"",Mt=(we,nt)=>{if(!we||!nt)return!1;const rt=Qt(we),it=Qt(nt);if(!rt||!it)return!1;const qe=6;return rt.length<qe||it.length<qe?rt===it:it.includes(rt)||rt.includes(it)},Bt=Qt(pe.bankInfo.accountNumber||""),Fn=pe.bankInfo.accountHolder||"";let Wn=!1;console.log("===    ==="),console.log(" :",pe.bankInfo.accountNumber),console.log(" :",Bt),console.log(" :",Fn),console.log(" :",Pe.length),console.log("  :",Oe.filter(we=>we.status==="completed").length);let Yt=Pe.find(we=>{const nt=Qt(we.accountNumber||"");return nt&&nt===Bt});if(!Yt&&Bt&&(Yt=Pe.find(we=>{const nt=Qt(we.accountNumber||"");return Mt(Bt,nt)})),Yt&&(Wn=!0),!Yt&&Fn&&(Yt=Pe.find(we=>we.name===Fn),Yt)){console.log("  :",Yt.name);const we=((D=Yt.accountNumber)==null?void 0:D.replace(/[-\s]/g,""))||"";Bt&&!Mt(Bt,we)?(console.log("    ( ) -  "),Wn=!1):Wn=!0}if(Yt&&(Yt.name&&(Ge.accountHolder=Yt.name,console.log("  :",Yt.name)),Yt.bankName?Ge.bankName=Yt.bankName:pe.bankInfo.bankName&&(Ge.bankName=pe.bankInfo.bankName),Wn&&(Ge.accountNumber=Yt.accountNumber||pe.bankInfo.accountNumber),P(Yt.id||Yt._id||null),Yt.process&&(Ge.process=Yt.process)),!Yt){let we=!1;console.log("===     ==="),console.log("  payments :",Oe.length,""),console.log(" :",Bt),console.log(" :",Fn);const nt=Oe.filter(ot=>ot.status==="completed");console.log(" :",nt.length);const rt=[...new Set(nt.map(ot=>{var Lt;return(Lt=ot.bankInfo)==null?void 0:Lt.accountHolder}).filter(Boolean))];console.log("   ( 20):",rt.slice(0,20)),console.log("  ():",Bt);const it=nt.filter(ot=>{var Lt;return(Lt=ot.bankInfo)==null?void 0:Lt.accountNumber}).map(ot=>{var Lt,mn,sn;return{holder:(Lt=ot.bankInfo)==null?void 0:Lt.accountHolder,account:(mn=ot.bankInfo)==null?void 0:mn.accountNumber,clean:Qt(((sn=ot.bankInfo)==null?void 0:sn.accountNumber)||"")}}).filter(ot=>ot.clean.includes(Bt.substring(0,6))||Bt.includes(ot.clean.substring(0,6)));console.log("  :",it);let qe=Oe.find(ot=>{var sn;const Lt=Qt(((sn=ot.bankInfo)==null?void 0:sn.accountNumber)||"");return Lt&&Lt===Bt&&ot.status==="completed"});if(qe&&console.log("   :",(Q=qe.bankInfo)==null?void 0:Q.accountHolder,qe.process),!qe&&Bt&&(qe=Oe.find(ot=>{var mn;const Lt=Qt(((mn=ot.bankInfo)==null?void 0:mn.accountNumber)||"");return Mt(Bt,Lt)&&ot.status==="completed"}),qe&&console.log("   :",(R=qe.bankInfo)==null?void 0:R.accountHolder,qe.process)),qe&&(we=!0),!qe&&Fn&&(qe=Oe.find(ot=>{var Lt;return((Lt=ot.bankInfo)==null?void 0:Lt.accountHolder)===Fn&&ot.status==="completed"}),qe)){console.log("    :",(x=qe.bankInfo)==null?void 0:x.accountHolder,":",qe.process);const ot=Qt(((L=qe.bankInfo)==null?void 0:L.accountNumber)||"");Bt&&!Mt(Bt,ot)?(console.log("    ( ) -  "),we=!1):we=!0}qe?(console.log(" :",{accountHolder:(U=qe.bankInfo)==null?void 0:U.accountHolder,accountNumber:(X=qe.bankInfo)==null?void 0:X.accountNumber,bankName:(G=qe.bankInfo)==null?void 0:G.bankName,process:qe.process,status:qe.status,paymentMatchedByAccountNumber:we}),(Z=qe.bankInfo)!=null&&Z.accountHolder&&(Ge.accountHolder=qe.bankInfo.accountHolder,console.log("  :",qe.bankInfo.accountHolder)),(ie=qe.bankInfo)!=null&&ie.bankName?Ge.bankName=qe.bankInfo.bankName:pe.bankInfo.bankName&&(Ge.bankName=pe.bankInfo.bankName),we&&(Ge.accountNumber=((Ce=qe.bankInfo)==null?void 0:Ce.accountNumber)||pe.bankInfo.accountNumber),qe.process&&!Ge.process?(Ge.process=qe.process,console.log("    :",qe.process)):console.log("   - process:",qe.process,"updatedFormData.process:",Ge.process)):console.log("  ")}if(pe.vendor&&(Ge.process=pe.vendor),!Ge.process){const we=tt.toLowerCase();for(const nt of Em)if(we.includes(nt.toLowerCase())){Ge.process=nt;break}}pe.itemName&&(Ge.itemName=pe.itemName),et(Ge),pe.includeVat&&(T(!0),re(!1));const Qe=[];if(pe.amounts.material||pe.amounts.labor||pe.amounts.total){const we=[];pe.amounts.material&&we.push(`: ${pe.amounts.material.toLocaleString()}`),pe.amounts.labor&&we.push(`: ${pe.amounts.labor.toLocaleString()}`),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&we.push(`: ${pe.amounts.total.toLocaleString()}`),Qe.push(we.join(", "))}if(pe.bankInfo.bankName||pe.bankInfo.accountHolder){const we=[];pe.bankInfo.bankName&&we.push(pe.bankInfo.bankName),pe.bankInfo.accountHolder&&we.push(pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&we.push(pe.bankInfo.accountNumber),we.length>0&&Qe.push(`: ${we.join(" ")}`)}pe.vendor&&Qe.push(`: ${pe.vendor}`),pe.includeVat&&Qe.push("  "),Qe.length>0?oe.success(`  !
${Qe.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):oe.info("  ...    .")}catch(tt){console.error(" :",tt),oe.error("   .")}};A.useEffect(()=>{(async()=>{try{await $2();const Q=await F2();st(Q),Mn(!0)}catch(Q){console.error("  :",Q),Mn(!0)}})()},[]);const ke=A.useRef({});A.useEffect(()=>{Ee&&(Object.entries(We).forEach(([D,Q])=>{JSON.stringify(ke.current[D])!==JSON.stringify(Q)&&O2(D,Q).catch(R=>{console.error("  :",R),oe.error("  ")})}),ke.current={...We})},[We,Ee]);const Re=A.useCallback(async D=>{var x;const Q=(x=D.clipboardData)==null?void 0:x.items;if(!Q)return;let R=!1;for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){R=!0;break}if(R){if(!f){const L=document.activeElement;(L==null?void 0:L.tagName)==="INPUT"||(L==null?void 0:L.tagName)==="TEXTAREA"||(L==null?void 0:L.classList.contains("form-input"))||oe.error("  ");return}for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){D.preventDefault();const U=Q[L].getAsFile();if(U){const X=new FileReader;X.onload=async G=>{var ie;const Z=(ie=G.target)==null?void 0:ie.result;if(Z)try{const Ce=n.find(pe=>pe.id===f),Oe=[...(Ce==null?void 0:Ce.images)||We[f]||[],Z];await Ps.updatePaymentImages(f,Oe),st(pe=>({...pe,[f]:Oe})),await e(),oe.success(" ")}catch(Ce){console.error("  :",Ce),oe.error("  ")}},X.readAsDataURL(U)}}}},[f,n,We,e]);A.useEffect(()=>(document.addEventListener("paste",Re),()=>document.removeEventListener("paste",Re)),[Re]);const Et=[...(l==null?void 0:l.name)===""?n.filter(D=>u.some(Q=>Q.name===D.project)):n].sort((D,Q)=>new Date(Q.requestDate).getTime()-new Date(D.requestDate).getTime()),_t=Et.filter(D=>{var U,X,G;if(!D||!D.id)return!1;const Q=m===""||((U=D.purpose)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((X=D.itemName)==null?void 0:X.toLowerCase().includes(m.toLowerCase()))||((G=D.process)==null?void 0:G.toLowerCase().includes(m.toLowerCase())),R=ge==="pending"?D.status!=="completed":D.status==="completed",x=yt==="all"||!yt||D.project===yt,L=!qt||ge!=="completed"||D.requestedBy===(l==null?void 0:l.name);return Q&&R&&x&&L}).sort((D,Q)=>!D&&!Q?0:D?Q?ge==="completed"?cc(Q.completionDate)-cc(D.completionDate):cc(Q.requestDate)-cc(D.requestDate):-1:1),nn=D=>{const Q=D.id||D._id||null;if(pt===Q){P(null);const U=document.querySelector('input[placeholder=" "]');U&&setTimeout(()=>{U.focus()},100);return}P(Q);const R=el(D.name);let x=D.bankName||"",L=D.accountNumber||"";if(L&&!x){const U=L.trim().split(/\s+/);if(U.length>=2){const X=U[0];(X.includes("")||X.includes("")||X.includes("")||X.includes("")||X.includes(""))&&(x=X,L=U.slice(1).join(""))}}et(U=>({...U,accountHolder:R,bankName:x,accountNumber:L}))};_t.reduce((D,Q)=>{const R=Q.materialAmount||0,x=Q.laborAmount||0,L=Q.amount||0;let U=R,X=x,G=0;return R===0&&x===0&&L>0?Q.includesVAT?(U=Math.round(L/1.1),G=L-U):(U=L,G=0):Q.includesVAT?(R>0&&(U=Math.round(R/1.1)),x>0&&(X=Math.round(x/1.1)),G=L-(U+X)):G=0,D.material+=U,D.labor+=X,D.vat+=G,D.total+=L,D},{material:0,labor:0,vat:0,total:0});const wt=async()=>{var Q;if(ht){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ne),!ne.project){oe.error(" ");return}if(!ne.itemName){oe.error(" ");return}const D=Number(ne.amount)||0;if(D===0){oe.error(" ");return}yn(!0);try{const R=F?Math.round(D*.967):D,x=new Date;if(y){const L={project:ne.project,requestDate:new Date(ne.date),purpose:ne.itemName,amount:R,category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,updatedAt:x};console.log(" Updating payment:",L),await i(y,L),oe.success(" "),C(null)}else{const L=ne.project||"",U={id:`payment_${Date.now()}`,project:L,requestDate:new Date(ne.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:ne.itemName,amount:R,status:"pending",category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,quickText:ne.quickText||"",images:ne.quickImages,attachments:[],createdAt:x,updatedAt:x};console.log(" Creating payment:",U),console.log(" Images in payment:",((Q=ne.quickImages)==null?void 0:Q.length)||0,"");const X=await s(U);if(Me.current=X,setTimeout(()=>{Me.current=null},1e4),oe.success(" "),ne.accountHolder&&ne.bankName&&ne.accountNumber){const G=B||F?"01074088864":"01089423283";try{await Ie.post("/payments/send-toss-payment-sms",{recipientPhone:G,accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber,amount:R,projectName:L,itemName:ne.itemName,process:ne.process,paymentId:X}),oe.success("   ")}catch(Z){console.error("SMS  :",Z)}}}et(L=>({project:L.project,date:$t(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),re(!1),P(null),window.innerWidth<768&&j("list")}catch(R){console.error(" Payment save error:",R),oe.error("  : "+R.message)}finally{yn(!1)}},bn=D=>{var Q,R,x,L;try{console.log("[handleEdit] Starting edit for payment:",D.id);const U=D.originalMaterialAmount!==void 0?D.originalMaterialAmount:D.materialAmount||0,X=D.originalLaborAmount!==void 0?D.originalLaborAmount:D.laborAmount||0,G={project:D.project||"",date:D.requestDate?$t(new Date(D.requestDate),"yyyy-MM-dd"):$t(new Date,"yyyy-MM-dd"),process:D.process||"",itemName:D.itemName||D.purpose||"",materialCost:U>0?U.toString():"",laborCost:X>0?X.toString():"",amount:((Q=D.amount)==null?void 0:Q.toString())||"",accountHolder:((R=D.bankInfo)==null?void 0:R.accountHolder)||"",bankName:((x=D.bankInfo)==null?void 0:x.bankName)||"",accountNumber:((L=D.bankInfo)==null?void 0:L.accountNumber)||"",images:D.attachments||[],quickText:D.quickText||"",quickImages:D.images||[]};console.log("[handleEdit] Setting form data:",G),et(G),T(D.includesVAT||!1),re(D.applyTaxDeduction||!1),p(D.id),C(D.id),S&&j("form"),console.log("[handleEdit] Edit setup complete"),oe.success("  ")}catch(U){console.error("[handleEdit] Error:",U),oe.error("     ")}},un=async D=>{var Q,R,x;try{const L=((Q=D.bankInfo)==null?void 0:Q.accountHolder)||D.accountHolder,U=((R=D.bankInfo)==null?void 0:R.bankName)||D.bank,X=((x=D.bankInfo)==null?void 0:x.accountNumber)||D.accountNumber;if(!L||!U||!X){oe.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}`))return;const Z=X.replace(/[-\s]/g,""),ie=p1[U]||U,Ce=f1[U]||"004",tt="",Oe=`supertoss://send?amount=${D.amount}&bankCode=${Ce}&bank=${encodeURIComponent(ie)}&accountNo=${Z}&receiverName=${encodeURIComponent(tt)}&toName=${encodeURIComponent(tt)}`;let pe=!1;try{window.location.href=Oe,pe=!0,oe.success("  ...",{duration:3e3}),setTimeout(()=>{const Ge=/iPhone|iPad|iPod/i.test(navigator.userAgent),pn=/Android/i.test(navigator.userAgent);(Ge||pn)&&oe(`      .

: 
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Ge){console.error("   :",Ge),oe(`   .

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(L){console.error(" :",L),oe.error(`   : ${L.message}`)}},Rn=async D=>{const Q=n.find(R=>R.id===D);if(Q&&Q.quickText){const R=localStorage.getItem("executionMemos"),x=R?JSON.parse(R):{};x[D]=Q.quickText,localStorage.setItem("executionMemos",JSON.stringify(x))}o(D,{status:"completed",completionDate:new Date}),me(!1),He("completed"),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(D,{status:"completed"});const R=jr.getSocket();R&&R.emit("payment:refresh",{paymentId:D,status:"completed"})}catch(R){console.error(" API :",R),o(D,{status:"pending",completionDate:void 0}),He("pending"),oe.error("   -  ")}},gs=async D=>{var x;if(!f){oe.error("  ");return}const R=Array.from(((x=D.target)==null?void 0:x.files)||[]).filter(L=>L.type.startsWith("image/"));if(R.length!==0){try{const L=await Promise.all(R.map(Z=>new Promise((ie,Ce)=>{const tt=new FileReader;tt.onload=Oe=>{var Ge;const pe=(Ge=Oe.target)==null?void 0:Ge.result;pe?ie(pe):Ce(new Error("  "))},tt.onerror=()=>Ce(new Error("FileReader ")),tt.readAsDataURL(Z)}))),U=n.find(Z=>Z.id===f),G=[...(U==null?void 0:U.images)||We[f]||[],...L];await Ps.updatePaymentImages(f,G),st(Z=>({...Z,[f]:G})),await e(),oe.success(`${L.length}  `)}catch(L){console.error("  :",L),oe.error("  ")}D.target.value=""}},es=async D=>{if(f)try{const Q=n.find(L=>L.id===f),x=((Q==null?void 0:Q.images)||We[f]||[]).filter((L,U)=>U!==D);await Ps.updatePaymentImages(f,x),st(L=>({...L,[f]:x})),await e()}catch(Q){console.error("  :",Q),oe.error("  ")}},ys=D=>{N(D),M(!0)},ui=D=>{D.preventDefault(),w(!0)},Fs=D=>{D.preventDefault(),w(!1)},os=async D=>{if(D.preventDefault(),w(!1),!f){oe.error("  ");return}const R=Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/"));if(R.length!==0)try{const x=await Promise.all(R.map(G=>new Promise((Z,ie)=>{const Ce=new FileReader;Ce.onload=tt=>{var pe;const Oe=(pe=tt.target)==null?void 0:pe.result;Oe?Z(Oe):ie(new Error("  "))},Ce.onerror=()=>ie(new Error("FileReader ")),Ce.readAsDataURL(G)}))),L=n.find(G=>G.id===f),X=[...(L==null?void 0:L.images)||We[f]||[],...x];await Ps.updatePaymentImages(f,X),st(G=>({...G,[f]:X})),await e(),oe.success(`${x.length}  `)}catch(x){console.error("  :",x),oe.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ne.project,onChange:D=>{et({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2463,columnNumber:35},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2465,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2453,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2452,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2474,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2484,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2473,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2472,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2471,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${V!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ne.project,onChange:D=>{et({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2529,columnNumber:43},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2531,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2519,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>et({...ne,bankName:D.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2539,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2540,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2541,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2543,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2550,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2551,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2518,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2517,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ne.quickText,onChange:D=>et({...ne,quickText:D.target.value}),onPaste:D=>{var R;const Q=(R=D.clipboardData)==null?void 0:R.items;if(Q){for(let x=0;x<Q.length;x++)if(Q[x].type.indexOf("image")!==-1){D.preventDefault();const L=Q[x].getAsFile();if(L){const U=new FileReader;U.onload=X=>{var Z;const G=(Z=X.target)==null?void 0:Z.result;et(ie=>({...ie,quickImages:[...ie.quickImages,G]}))},U.readAsDataURL(L)}break}}},onDragOver:D=>{D.preventDefault(),D.stopPropagation()},onDrop:D=>{D.preventDefault(),D.stopPropagation(),Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/")).forEach(x=>{const L=new FileReader;L.onload=U=>{var G;const X=(G=U.target)==null?void 0:G.result;et(Z=>({...Z,quickImages:[...Z.quickImages,X]}))},L.readAsDataURL(x)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:S?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:15},void 0),ne.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ne.quickImages.map((D,Q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:D,alt:` ${Q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{et(R=>({...R,quickImages:R.quickImages.filter((x,L)=>L!==Q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2618,columnNumber:23},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D=>{Array.from(D.target.files||[]).forEach(R=>{const x=new FileReader;x.onload=L=>{var X;const U=(X=L.target)==null?void 0:X.result;et(G=>({...G,quickImages:[...G.quickImages,U]}))},x.readAsDataURL(R)}),D.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2637,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2658,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2636,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:ve,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2662,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ne.date&&`(${$t(new Date(ne.date),"E",{locale:kn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2675,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ne.date,onChange:D=>et({...ne,date:D.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2678,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2674,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2694,columnNumber:17},void 0),a.jsxDEV("button",{ref:$e,type:"button",onClick:()=>Ae(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ne.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2701,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2695,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2693,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ne.itemName,onChange:D=>et({...ne,itemName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2709,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2707,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2720,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ne.amount?Number(ne.amount).toLocaleString():"",onChange:D=>{const Q=D.target.value.replace(/[^0-9]/g,"");et({...ne,amount:Q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2733,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2719,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{B||re(!1),T(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2751,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2753,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2739,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{F||T(!1),re(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2718,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Pt.length>0||q.length>0&&!pt)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Pt.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Pt.map(D=>{const Q=D.id||D._id,R=pt===Q;return a.jsxDEV("button",{type:"button",onClick:()=>nn(D),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${R?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:el(D.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2803,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName||""," ",D.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2806,columnNumber:29},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2793,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2788,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${q.length===0||pt?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2819,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:q.map((D,Q)=>a.jsxDEV("button",{type:"button",onClick:()=>{et(R=>({...R,accountHolder:D.accountHolder,bankName:D.bankName,accountNumber:D.accountNumber})),te([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:D.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2836,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName," ",D.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2839,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2822,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountHolder,onChange:D=>et({...ne,accountHolder:D.target.value}),onFocus:()=>Se(!0),onBlur:()=>setTimeout(()=>Se(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:17},void 0),de&&xe.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:xe.map((D,Q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:R=>R.preventDefault(),onClick:()=>{let R=D.bankName||"",x=D.accountNumber||"";const L=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],U={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const X of L)if(x.includes(X)){R||(R=U[X]||X),x=x.replace(X,"").trim();break}for(const X of L)if(R.includes(X)){const G=U[X]||X,Z=R.replace(X,"").trim();Z&&/\d/.test(Z)&&(x=Z),R=G;break}x=x.replace(/[^\d\-]/g,"").trim(),et({...ne,accountHolder:D.name,bankName:R||ne.bankName,accountNumber:x||ne.accountNumber}),Se(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:D.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2952,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:D.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2953,columnNumber:25},void 0)]},`${D.name}-${Q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2865,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2863,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2964,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>et({...ne,bankName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2970,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2971,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2972,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2973,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2974,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2975,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2976,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2977,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2978,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2979,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2980,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2981,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2983,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2984,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2985,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2986,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2987,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2988,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2989,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2990,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2991,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2965,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2963,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2997,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountNumber,onChange:D=>et({...ne,accountNumber:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2998,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2996,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const D=Number(ne.amount)||0;let Q=D;return F&&(Q=Math.round(D*.967)),Q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{C(null),et(D=>({project:D.project,date:$t(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),re(!1),P(null),oe.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),a.jsxDEV("button",{onClick:D=>{console.log(" Payment button clicked!",D),console.log(" Button element:",D.currentTarget),console.log(" Form data:",ne),wt()},disabled:ht,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ht?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ht?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2779,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2515,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2512,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${V!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>He("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ge==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ge==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Et.filter(D=>D&&D.id&&D.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3103,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3094,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{He("completed"),et(D=>({...D,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ge==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ge==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Et.filter(D=>D&&D.id&&D.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3122,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3109,columnNumber:17},void 0),ge==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:qt,onChange:D=>{ae(D.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(D.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3131,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3130,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3093,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3092,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3091,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3146,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:_t.length>0?a.jsxDEV("div",{className:"space-y-4",children:_t.map(D=>{var X,G,Z;const Q=D.amount||0,R=((X=D.bankInfo)==null?void 0:X.accountHolder)||D.accountHolder||"",x=((G=D.bankInfo)==null?void 0:G.bankName)||D.bank||"",L=((Z=D.bankInfo)==null?void 0:Z.accountNumber)||D.accountNumber||"",U=R&&x&&L?`${R} | ${x} ${L}`:" ";return a.jsxDEV("div",{onClick:()=>p(D.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===D.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[D.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",D.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3178,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:D.purpose||D.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3180,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:D.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3184,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[Q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3187,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[D.requestedBy||"-","  ",Kg(D.requestDate,"MM/dd",{locale:kn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3190,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3174,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3198,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3199,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3200,columnNumber:25},void 0),D.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:27},void 0),D.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3210,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3208,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3197,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:U},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3217,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),bn(D)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(iv,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3221,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async ie=>{ie.stopPropagation(),window.confirm("  ?")&&(await r(D.id),oe.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(Si,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3242,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:23},void 0),ge==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:ie=>{if(ie.stopPropagation(),D.status==="completed"){oe.info("   ");return}un(D)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${D.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:D.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:27},void 0),a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),Rn(D.id)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${D.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:D.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3269,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:25},void 0)]},D.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3164,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3150,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3300,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3148,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3087,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${V!=="image"?"hidden lg:flex":""}`,onDragOver:ui,onDragLeave:Fs,onDrop:os,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:gs,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3316,columnNumber:11},void 0),S&&f&&V==="image"&&(()=>{const D=Et.find(Q=>Q.id===f);return D?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:D.purpose||D.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3333,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[D.process||"-","  ",Kg(D.requestDate,"yyyy.MM.dd",{locale:kn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3334,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3332,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(D.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3338,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3331,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3330,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:D=>{var R;const Q=D.target;if(!Q.closest("img")&&!Q.closest("button")&&f){const x=Et.find(G=>G.id===f),L=(x==null?void 0:x.images)||[],U=We[f]||[];(L.length>0?L:U).length>0&&((R=document.getElementById("image-file-input"))==null||R.click())}},children:f?(()=>{const D=Et.find(L=>L.id===f),Q=(D==null?void 0:D.images)||[],R=We[f]||[],x=Q.length>0?Q:R;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3374,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(D==null?void 0:D.quickText)||(D==null?void 0:D.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3375,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3373,columnNumber:19},void 0),x.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:x.map((L,U)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:L,alt:` ${U+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:X=>{X.stopPropagation(),ys(L)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3389,columnNumber:27},void 0),a.jsxDEV("button",{onClick:X=>{X.stopPropagation(),es(U)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(An,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3398,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[U+1,"/",x.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3407,columnNumber:27},void 0)]},U,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${x.length>0?"":"flex-1"}`,onClick:L=>L.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${x.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(Sm,{className:`mx-auto text-gray-400 mb-1 ${x.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3426,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:x.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3427,columnNumber:23},void 0),x.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3431,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3421,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3416,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3371,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(Pa,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3440,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3441,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3439,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3348,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3308,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2509,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ae(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(An,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3457,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Em.map(D=>a.jsxDEV("button",{onClick:()=>{et({...ne,process:D}),Ae(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3466,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{et({...ne,process:""}),Ae(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3485,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3465,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3454,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>Ae(!1),children:a.jsxDEV("div",{onClick:D=>D.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:$e.current?`${$e.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:$e.current?`${$e.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ae(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(An,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3510,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3508,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Em.map(D=>a.jsxDEV("button",{onClick:()=>{et({...ne,process:D}),Ae(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3519,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{et({...ne,process:""}),Ae(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3500,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3451,columnNumber:9},void 0),ee&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:D=>{D.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(An,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3567,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3560,columnNumber:13},void 0),a.jsxDEV("img",{src:E,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:D=>D.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3569,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3559,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3555,columnNumber:9},void 0),Dt&&a.jsxDEV(U2,{projectName:Tt,onClose:()=>ut(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2450,columnNumber:5},void 0)},hi=n=>n?typeof n=="string"?n:n instanceof be?n.toDate().toISOString():new Date().toISOString():new Date().toISOString(),bs={async getSpaces(n){const e=Je(fe,"finish_check_spaces");let t;n?t=kt(e,zn("project_id","==",n),Jt("display_order")):t=kt(e,Jt("display_order"));const s=await Ot(t),r=[];for(const i of s.docs){const o=i.data(),l=Je(fe,"finish_check_items"),u=kt(l,zn("space_id","==",i.id),Jt("display_order")),m=await Ot(u),d=[];for(const f of m.docs){const p=f.data(),y=Je(fe,"finish_check_images"),C=kt(y,zn("item_id","==",f.id)),w=(await Ot(C)).docs.map(B=>({id:B.id,item_id:f.id,filename:B.data().filename||null,created_at:hi(B.data().created_at)}));d.push({id:f.id,space_id:i.id,content:p.content||"",is_completed:p.is_completed||0,is_priority:p.is_priority||0,completed_at:p.completed_at?hi(p.completed_at):null,display_order:p.display_order||0,created_at:hi(p.created_at),updated_at:hi(p.updated_at),images:w})}r.push({id:i.id,name:o.name||"",project_id:o.project_id||null,display_order:o.display_order||0,created_at:hi(o.created_at),updated_at:hi(o.updated_at),items:d})}return r},async createSpace(n,e){const t=Je(fe,"finish_check_spaces"),s=kt(t,zn("project_id","==",e),Jt("display_order","desc")),r=await Ot(s),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={name:n,project_id:e,display_order:i+1,created_at:On(),updated_at:On()};return{id:(await Zs(t,o)).id,name:n,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(n,e){const t=Ke(fe,"finish_check_spaces",n);await Ln(t,{name:e,updated_at:On()})},async deleteSpace(n){const e=Je(fe,"finish_check_items"),t=kt(e,zn("space_id","==",n)),s=await Ot(t);for(const r of s.docs){const i=Je(fe,"finish_check_images"),o=kt(i,zn("item_id","==",r.id)),l=await Ot(o);for(const u of l.docs)await ns(Ke(fe,"finish_check_images",u.id));await ns(Ke(fe,"finish_check_items",r.id))}await ns(Ke(fe,"finish_check_spaces",n))},async createItem(n,e){const t=Je(fe,"finish_check_items"),s=kt(t,zn("space_id","==",n),Jt("display_order","desc")),r=await Ot(s),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={space_id:n,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:On(),updated_at:On()};return{id:(await Zs(t,o)).id,space_id:n,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(n,e){const t=Ke(fe,"finish_check_items",n);await Ln(t,{content:e,updated_at:On()})},async deleteItem(n){const e=Je(fe,"finish_check_images"),t=kt(e,zn("item_id","==",n)),s=await Ot(t);for(const r of s.docs)await ns(Ke(fe,"finish_check_images",r.id));await ns(Ke(fe,"finish_check_items",n))},async toggleItem(n){const e=Ke(fe,"finish_check_items",n),t=await Zt(e);if(!t.exists())throw new Error("   .");const s=t.data(),r=s.is_completed?0:1;return await Ln(e,{is_completed:r,completed_at:r?On():null,updated_at:On()}),{id:n,space_id:s.space_id,content:s.content,is_completed:r,is_priority:s.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:s.display_order||0,created_at:hi(s.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(n){const e=Ke(fe,"finish_check_items",n),t=await Zt(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await Ln(e,{is_priority:r,updated_at:On()}),{is_priority:r}},async getImageData(n){const e=Ke(fe,"finish_check_images",n),t=await Zt(e);return t.exists()?{image_data:t.data().image_data||""}:null},async uploadImage(n,e,t){const s=Je(fe,"finish_check_images"),r={item_id:n,image_data:e,filename:t,created_at:On()};return{id:(await Zs(s,r)).id,item_id:n,image_data:e,filename:t,created_at:new Date().toISOString()}},async deleteImage(n){await ns(Ke(fe,"finish_check_images",n))}},Ns={getSpaces:async n=>{const e=n?`/finish-check/spaces?project_id=${n}`:"/finish-check/spaces";return(await Ie.get(e)).data},createSpace:async(n,e)=>(await Ie.post("/finish-check/spaces",{name:n,project_id:e})).data,updateSpace:async(n,e)=>{await Ie.put(`/finish-check/spaces/${n}`,{name:e})},deleteSpace:async n=>{await Ie.delete(`/finish-check/spaces/${n}`)},createItem:async(n,e)=>(await Ie.post("/finish-check/items",{space_id:n,content:e})).data,updateItem:async(n,e)=>{await Ie.put(`/finish-check/items/${n}`,{content:e})},deleteItem:async n=>{await Ie.delete(`/finish-check/items/${n}`)},toggleItem:async n=>(await Ie.put(`/finish-check/items/${n}/toggle`)).data,togglePriority:async n=>(await Ie.put(`/finish-check/items/${n}/toggle-priority`)).data,getImageData:async n=>(await Ie.get(`/finish-check/images/${n}`)).data,uploadImage:async(n,e,t)=>(await Ie.post(`/finish-check/items/${n}/images`,{image_data:e,filename:t})).data,deleteImage:async n=>{await Ie.delete(`/finish-check/images/${n}`)}},ws={getSpaces:async n=>Te()?(console.log("[finishCheckService] Using Firestore"),bs.getSpaces(n)):(console.log("[finishCheckService] Using Railway API"),Ns.getSpaces(n)),createSpace:async(n,e)=>Te()?bs.createSpace(n,e):Ns.createSpace(n,e),updateSpace:async(n,e)=>Te()?bs.updateSpace(String(n),e):Ns.updateSpace(Number(n),e),deleteSpace:async n=>Te()?bs.deleteSpace(String(n)):Ns.deleteSpace(Number(n)),createItem:async(n,e)=>Te()?bs.createItem(String(n),e):Ns.createItem(Number(n),e),updateItem:async(n,e)=>Te()?bs.updateItem(String(n),e):Ns.updateItem(Number(n),e),deleteItem:async n=>Te()?bs.deleteItem(String(n)):Ns.deleteItem(Number(n)),toggleItem:async n=>Te()?bs.toggleItem(String(n)):Ns.toggleItem(Number(n)),togglePriority:async n=>Te()?bs.togglePriority(String(n)):Ns.togglePriority(Number(n)),getImageData:async n=>Te()?bs.getImageData(String(n)):Ns.getImageData(Number(n)),uploadImage:async(n,e,t)=>Te()?bs.uploadImage(String(n),e,t):Ns.uploadImage(Number(n),e,t),deleteImage:async n=>Te()?bs.deleteImage(String(n)):Ns.deleteImage(Number(n))},W2=()=>{var ne,et;const{user:n}=si(),{loadProjectsFromAPI:e,projects:t}=Xr(),s=Mu(),[r,i]=A.useState([]),[o,l]=A.useState(!0),[u,m]=A.useState(null),[d,f]=A.useState([]),[p,y]=A.useState(!1),[C,v]=A.useState(""),[w,B]=A.useState(""),[T,F]=A.useState(null),[re,ee]=A.useState(null),[M,E]=A.useState(""),[N,V]=A.useState(null),[j,S]=A.useState(""),[I,k]=A.useState(null),[Ae,$e]=A.useState(new Set),ge=A.useRef(null),[He,yt]=A.useState(window.innerWidth<768),[Kt,qt]=A.useState(!1),[ae,ze]=A.useState(null),[me,Be]=A.useState(new Set),[Xe,Dt]=A.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[ut,Tt]=A.useState(!1),[ct,ht]=A.useState(!1),[yn,K]=A.useState(new Set);A.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Xe))},[Xe]),A.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const ve=()=>{yt(window.innerWidth<768)};return window.addEventListener("resize",ve),()=>window.removeEventListener("resize",ve)},[]),A.useEffect(()=>{o||je()},[s,o]),A.useEffect(()=>{u!==null&&Me()},[u]),A.useEffect(()=>{u!==null&&(n!=null&&n.id)&&localStorage.setItem(`finishCheck_selectedProject_${n.id}`,u.toString())},[u,n==null?void 0:n.id]),A.useEffect(()=>{if(!He&&I){const O=async ve=>{var Re;const ke=(Re=ve.clipboardData)==null?void 0:Re.items;if(ke){for(let ue=0;ue<ke.length;ue++)if(ke[ue].type.indexOf("image")!==-1){ve.preventDefault();const Et=ke[ue].getAsFile();Et&&await Se(I,Et)}}};return document.addEventListener("paste",O),()=>document.removeEventListener("paste",O)}},[I,He]);const je=async()=>{try{const O=s.map(ke=>({id:ke.id,title:ke.name}));i(O);const ve=n!=null&&n.id?localStorage.getItem(`finishCheck_selectedProject_${n.id}`):null;ve&&O.some(ke=>ke.id===Number(ve))?m(Number(ve)):O.length>0&&m(O[0].id)}catch(O){console.error("Failed to load projects:",O),oe.error("   ")}},Me=async()=>{try{d.length===0&&y(!0);const ve=(await ws.getSpaces(u||void 0)).map(ke=>({...ke,items:ke.items.map(Re=>({...Re,images:Re.images||[]}))}));f(ve)}catch(O){console.error("Failed to load spaces:",O),oe.error("   ")}finally{y(!1)}},Pe=async O=>{if(yn.has(Number(O)))return null;try{K(Re=>new Set(Re).add(Number(O)));const ve=await ws.getImageData(O),ke=(ve==null?void 0:ve.image_data)||null;return f(Re=>Re.map(ue=>({...ue,items:ue.items.map(Et=>({...Et,images:Et.images.map(_t=>String(_t.id)===String(O)?{..._t,image_data:ke}:_t)}))}))),ke}catch(ve){return console.error("   :",ve),null}finally{K(ve=>{const ke=new Set(ve);return ke.delete(Number(O)),ke})}},Ze=async O=>{const ve=d.find(ue=>ue.items.some(Et=>Et.id===O)),ke=ve==null?void 0:ve.items.find(ue=>ue.id===O);if(!ke)return;const Re=ke.images.filter(ue=>!ue.image_data);await Promise.all(Re.map(ue=>Pe(ue.id)))},Pt=async()=>{if(!ct){if(!C.trim()){oe.error("  ");return}if(!u){oe.error(" ");return}ht(!0);try{const O=await ws.createSpace(C.trim(),u),ve={...O,items:O.items||[]};f([...d,ve]),v(""),Tt(!1),oe.success(" ")}catch(O){console.error("Failed to add space:",O),oe.error("  ")}finally{ht(!1)}}},Gt=async(O,ve)=>{if(!ve.trim()){oe.error("  ");return}try{await ws.updateSpace(O,ve.trim()),f(d.map(ke=>String(ke.id)===String(O)?{...ke,name:ve.trim()}:ke)),ee(null),E(""),oe.success("  ")}catch(ke){console.error("Failed to update space:",ke),oe.error("  ")}},pt=O=>{ze(O),Be(new Set)},P=async()=>{if(ae!==null){if(me.size===0){oe.error("  ");return}try{await Promise.all(Array.from(me).map(O=>ws.deleteItem(O))),f(d.map(O=>String(O.id)===String(ae)?{...O,items:O.items.filter(ve=>!me.has(ve.id))}:O)),oe.success(`${me.size}  `),ze(null),Be(new Set)}catch(O){console.error("Failed to delete items:",O),oe.error("  ")}}},q=async()=>{if(ae===null)return;const O=d.find(ve=>String(ve.id)===String(ae));if(O&&confirm(`"${O.name}"  ?

        .`))try{await ws.deleteSpace(ae),f(d.filter(ve=>String(ve.id)!==String(ae))),oe.success(" "),ze(null),Be(new Set)}catch(ve){console.error("Failed to delete space:",ve),oe.error("  ")}},te=async O=>{if(!w.trim()){oe.error("  ");return}const ve=-Date.now(),ke={id:ve,space_id:O,content:w.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(ue=>String(ue.id)===String(O)?{...ue,items:[...ue.items,ke]}:ue));const Re=w.trim();B(""),F(null);try{const ue=await ws.createItem(O,Re);f(Et=>Et.map(_t=>String(_t.id)===String(O)?{..._t,items:_t.items.map(nn=>nn.id===ve?{...ue,images:[]}:nn)}:_t))}catch(ue){console.error("Failed to add item:",ue),f(Et=>Et.map(_t=>String(_t.id)===String(O)?{..._t,items:_t.items.filter(nn=>nn.id!==ve)}:_t)),oe.error("  ")}},xe=async O=>{try{const ve=await ws.toggleItem(O);f(d.map(ke=>({...ke,items:ke.items.map(Re=>String(Re.id)===String(O)?{...Re,...ve}:Re)})))}catch(ve){console.error("Failed to toggle item:",ve),oe.error("   ")}},ce=async O=>{try{const ve=await ws.togglePriority(O);f(d.map(ke=>({...ke,items:ke.items.map(Re=>String(Re.id)===String(O)?{...Re,is_priority:ve.is_priority}:Re)})))}catch(ve){console.error("Failed to toggle priority:",ve),oe.error("  ")}},de=O=>new Promise((ve,ke)=>{const Re=new FileReader;Re.readAsDataURL(O),Re.onload=()=>ve(Re.result),Re.onerror=ue=>ke(ue)}),Se=async(O,ve)=>{var ue,Et;if(!["image/jpeg","image/png","image/webp"].includes(ve.type)){oe.error("JPEG, PNG, WebP    ");return}const Re=5*1024*1024;if(ve.size>Re){oe.error("  5MB  ");return}try{$e(wt=>new Set([...wt,Number(O)]));const _t=await de(ve),nn=await ws.uploadImage(O,_t,ve.name);f(d.map(wt=>({...wt,items:wt.items.map(bn=>String(bn.id)===String(O)?{...bn,images:[...bn.images,nn]}:bn)}))),oe.success(" ")}catch(_t){console.error("Failed to upload image:",_t),oe.error(((Et=(ue=_t.response)==null?void 0:ue.data)==null?void 0:Et.error)||"  ")}finally{$e(_t=>{const nn=new Set(_t);return nn.delete(Number(O)),nn})}},We=async(O,ve)=>{const ke=ve.target.files;if(!(!ke||ke.length===0)){for(let Re=0;Re<ke.length;Re++)await Se(O,ke[Re]);ge.current&&(ge.current.value="")}},st=async(O,ve)=>{if(confirm("  ?"))try{await ws.deleteImage(ve),f(d.map(ke=>({...ke,items:ke.items.map(Re=>String(Re.id)===String(O)?{...Re,images:Re.images.filter(ue=>String(ue.id)!==String(ve))}:Re)}))),oe.success(" ")}catch(ke){console.error("Failed to delete image:",ke),oe.error("  ")}},Ee=async(O,ve)=>{O.preventDefault(),O.stopPropagation();const ke=O.dataTransfer.files;if(!(!ke||ke.length===0))for(let Re=0;Re<ke.length;Re++)ke[Re].type.startsWith("image/")&&await Se(ve,ke[Re])},Mn=O=>{O.preventDefault(),O.stopPropagation()};if(p)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Ht=I?d.flatMap(O=>O.items).find(O=>O.id===I):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:ge,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:O=>{I&&We(I,O)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:He?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:O=>{const ve=O.target.value?Number(O.target.value):null;m(ve)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>Dt(!Xe),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Xe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Xe?" ":" ",children:Xe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>Tt(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(Eo,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:O=>{const ve=O.target.value?Number(O.target.value):null;m(ve)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:C,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&Pt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Pt,disabled:ct,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(Eo,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>Dt(!Xe),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Xe?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Xe?" ":" ",children:Xe?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((O,ve)=>{const ke=O.items.filter(ue=>!ue.is_completed).sort((ue,Et)=>(Et.is_priority||0)-(ue.is_priority||0)),Re=O.items.filter(ue=>ue.is_completed);return Xe&&ke.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[re===O.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:ue=>E(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?Gt(O.id,M):ue.key==="Escape"&&(ee(null),E(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Gt(O.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(Yg,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{ee(null),E("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(An,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:ve+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),O.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Re.length,"/",O.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{T===O.id?(F(null),B("")):F(O.id)},className:`p-1 transition-colors ${T===O.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(Eo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{ee(O.id),E(O.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(Tm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>pt(O.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(Si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),T===O.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:ue=>B(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&w.trim()&&te(O.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>te(O.id),disabled:!w.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),ke.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:ke.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>xe(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!He&&I===ue.id?"font-semibold":""}`,onClick:async()=>{He||(k(ue.id),ue.images&&ue.images.length>0&&await Ze(ue.id))},style:{cursor:He?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),He&&qt(!0),ue.images&&ue.images.length>0&&await Ze(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Pa,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(fp,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!Xe&&Re.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Re.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>xe(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!He&&I===ue.id?"font-semibold":""}`,onClick:async()=>{He||(k(ue.id),ue.images&&ue.images.length>0&&await Ze(ue.id))},style:{cursor:He?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),He&&qt(!0),ue.images&&ue.images.length>0&&await Ze(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Pa,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(fp,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!He&&I&&Ht&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(An,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Ht.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=ge.current)==null?void 0:O.click()},disabled:Ae.has(I),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(Sm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),Ae.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:O=>Ee(O,I),onDragOver:Mn,children:Ht.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(Pa,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Ht.images.map(O=>a.jsxDEV("div",{className:"relative group",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>st(I,O.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(pp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),He&&Kt&&I&&Ht&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{qt(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(An,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Ht.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=ge.current)==null?void 0:O.click()},disabled:Ae.has(I),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(Sm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),Ae.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Ht.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(Pa,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Ht.images.map(O=>a.jsxDEV("div",{className:"relative",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>st(I,O.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(pp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ne=d.find(O=>O.id===ae))==null?void 0:ne.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{ze(null),Be(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(An,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(et=d.find(O=>O.id===ae))==null?void 0:et.items.map(O=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const ve=new Set(me);ve.has(O.id)?ve.delete(O.id):ve.add(O.id),Be(ve)},children:[a.jsxDEV("input",{type:"checkbox",checked:me.has(O.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${O.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:O.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:me.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",me.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{ze(null),Be(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),ut&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Tt(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(An,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:C,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&C.trim()&&Pt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{Tt(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:Pt,disabled:!C.trim()||ct,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:ct?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function K2(){const[n,e]=A.useState([]),[t,s]=A.useState(!1),[r,i]=A.useState(null),[o,l]=A.useState(!1),[u,m]=A.useState(null),[d,f]=A.useState(""),[p,y]=A.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[C,v]=A.useState(!1);A.useEffect(()=>{w()},[]),A.useEffect(()=>{const N=()=>{B()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const w=async()=>{var N,V;try{n.length===0&&s(!0),i(null);const j=await mr.getAllContractors();e(j.map(S=>({id:S._id,rank:S.rank,companyName:S.companyName,name:S.name,position:S.position,process:S.process,contact:S.contact,accountNumber:S.accountNumber,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const S=j instanceof Error&&((V=(N=j.response)==null?void 0:N.data)==null?void 0:V.message);i(S||"   .")}finally{s(!1)}},B=N=>{if(N){m(N);let V="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const Ae of k)if(N.accountNumber.startsWith(Ae)){V=Ae,j=N.accountNumber.substring(Ae.length).trim();break}}let S=N.name,I=N.position||"";I||(I=nc(N.name),S=el(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:S,position:I,process:N.process,contact:N.contact||"",bankName:V,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},T=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async N=>{var j,S;if(N.preventDefault(),C)return;v(!0);const V=p.bankName&&p.accountNumber?`${p.bankName} ${p.accountNumber}`:p.accountNumber;try{const I={rank:p.rank,companyName:p.companyName,name:p.name,position:p.position,process:p.process,contact:p.contact,accountNumber:V,notes:p.notes};u?await mr.updateContractor(u.id,I):await mr.createContractor(I),await w(),T()}catch(I){console.error("Failed to save contractor:",I);const k=I instanceof Error&&((S=(j=I.response)==null?void 0:j.data)==null?void 0:S.message);alert(k||"  .")}finally{v(!1)}},re=async N=>{var V,j;if(window.confirm("   ?"))try{await mr.deleteContractor(N),await w()}catch(S){console.error("Failed to delete contractor:",S);const I=S instanceof Error&&((j=(V=S.response)==null?void 0:V.data)==null?void 0:j.message);alert(I||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",M=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,E=n.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,V)=>{const j=M(N.rank)-M(V.rank);if(j!==0)return j;const S=N.process.localeCompare(V.process,"ko");return S!==0?S:N.name.localeCompare(V.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Jg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):E.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):E.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:el(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||nc(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(Tm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(Si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):E.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):E.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:el(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(Tm,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(Si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||nc(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||nc(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:T,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(An,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:p.rank,onChange:N=>y({...p,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.companyName,onChange:N=>y({...p,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:p.name,onChange:N=>y({...p,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.position,onChange:N=>y({...p,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:p.process,onChange:N=>y({...p,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.contact,onChange:N=>y({...p,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:p.bankName,onChange:N=>y({...p,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:p.accountNumber,onChange:N=>y({...p,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:p.notes,onChange:N=>y({...p,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:C,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:C?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const G2=()=>{const[n,e]=A.useState([]),[t,s]=A.useState(null),[r,i]=A.useState(!1),o=A.useRef(null);A.useEffect(()=>(Te()?(console.log("[QuoteInquiry] Using Firestore subscription"),o.current=Fa.subscribeToQuoteInquiries(p=>{e(p),i(!1)}),i(!0)):l(),()=>{o.current&&o.current()}),[]);const l=async()=>{try{n.length===0&&i(!0);const p=await Fa.getAllQuoteInquiries();e(p)}catch(p){console.error("Failed to load inquiries:",p),oe.error("  ")}finally{i(!1)}},u=async p=>{try{await Fa.markAsRead(p),Te()||e(y=>y.map(C=>C.id===p?{...C,isRead:!0}:C)),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(y){console.error("Failed to mark as read:",y)}},m=p=>{s(p),p.isRead||u(p.id)},d=async(p,y)=>{if(y.stopPropagation(),!!confirm("  ?"))try{await Fa.deleteQuoteInquiry(p),Te()||e(C=>C.filter(v=>v.id!==p)),(t==null?void 0:t.id)===p&&s(null),oe.success(" ")}catch(C){console.error("Failed to delete inquiry:",C),oe.error("  ")}},f=n.filter(p=>!p.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:105,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:104,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",f>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:f},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:115,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:127,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:n.map(p=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===p.id?"bg-blue-50 border-l-4 border-blue-500":""} ${p.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>m(p),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:p.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:145,columnNumber:25},void 0),!p.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:147,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:144,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:$t(new Date(p.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:151,columnNumber:25},void 0),a.jsxDEV("button",{onClick:y=>d(p.id,y),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(Si,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:143,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(hp,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:165,columnNumber:23},void 0),p.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:p.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:169,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:139,columnNumber:19},void 0)},p.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:131,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:125,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:$t(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:197,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(ov,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(hp,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:210,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(av,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:215,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:216,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:214,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(lv,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:220,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:219,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:209,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:204,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(cv,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:231,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:237,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:236,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:243,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:242,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:234,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:229,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:253,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:254,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:252,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:202,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:261,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:111,columnNumber:5},void 0)},Q2=()=>{const{login:n}=si(),[e,t]=A.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:o}}=Ff(),l=async m=>{t(!0);try{await n(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(uv,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},Y2=A.lazy(()=>rr(()=>import("./Drawings-Bn-7R0VB.js"),__vite__mapDeps([0,1,2,3,4,5]))),X2=A.lazy(()=>rr(()=>import("./SiteLog-DzhApM2D.js"),__vite__mapDeps([6,1,4,2,3,5]))),J2=A.lazy(()=>rr(()=>import("./AfterService-DpQVOqyE.js"),__vite__mapDeps([7,1,2,4,3,5]))),Z2=A.lazy(()=>rr(()=>import("./AdditionalWork-Tn3r4k6p.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),eS=A.lazy(()=>rr(()=>import("./ConstructionPayment-Bxa0oIiF.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),tS=A.lazy(()=>rr(()=>import("./WorkRequest-CNsXMkBS.js"),__vite__mapDeps([11,1,2,4,3,5]))),nS=A.lazy(()=>rr(()=>import("./Specbook-Cu5WOUKv.js"),__vite__mapDeps([12,1,2,3,4,5]))),sS=A.lazy(()=>rr(()=>import("./EstimatePreview-BWtA_mZM.js"),__vite__mapDeps([13,1,2,3,4,5]))),rS=A.lazy(()=>rr(()=>import("./ExecutionHistory-DFjMqkVe.js"),__vite__mapDeps([14,1,4,2,3,5]))),iS=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),oS=new Yx({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function aS(){const[n,e]=A.useState(!1);return A.useEffect(()=>{const t=uD({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),oe.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{oe.dismiss(),oe.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});MC();const s=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(s,5e3);const r=setInterval(s,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Oa(u,{transports:["websocket","polling"]}),jr.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;HC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(Xx,{client:oS,children:a.jsxDEV(Gx,{children:a.jsxDEV(Yw,{children:[a.jsxDEV(A.Suspense,{fallback:a.jsxDEV(iS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(Qx,{children:[a.jsxDEV(Tn,{path:"/login",element:a.jsxDEV(Q2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Tn,{path:"/",element:a.jsxDEV(RC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Tn,{index:!0,element:a.jsxDEV(Qg,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Tn,{path:"dashboard",element:a.jsxDEV(h1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Tn,{path:"projects",element:a.jsxDEV(_1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Tn,{path:"schedule",element:a.jsxDEV(B2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Tn,{path:"drawings",element:a.jsxDEV(Y2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Tn,{path:"site-log",element:a.jsxDEV(X2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Tn,{path:"after-service",element:a.jsxDEV(J2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Tn,{path:"additional-work",element:a.jsxDEV(Z2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Tn,{path:"construction-payment",element:a.jsxDEV(eS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Tn,{path:"contractors",element:a.jsxDEV(K2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Tn,{path:"work-request",element:a.jsxDEV(tS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Tn,{path:"finish-check",element:a.jsxDEV(W2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Tn,{path:"specbook",element:a.jsxDEV(nS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Tn,{path:"estimate-preview",element:a.jsxDEV(sS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Tn,{path:"execution-history",element:a.jsxDEV(rS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Tn,{path:"payments",element:a.jsxDEV(z2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Tn,{path:"quote-inquiry",element:a.jsxDEV(G2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(g_,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(const e of n)e.update()});py(document.getElementById("root")).render(a.jsxDEV(A.StrictMode,{children:a.jsxDEV(aS,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{Ps as A,$2 as B,Ft as C,F2 as D,Em as P,be as T,Ie as a,Mu as b,Je as c,fe as d,ks as e,Ke as f,Ot as g,ns as h,Ln as i,a as j,Zt as k,Zs as l,Te as m,Xr as n,Jt as o,Ff as p,kt as q,kn as r,vd as s,TC as t,si as u,Qw as v,zn as w,gS as x,O2 as y,oe as z};
