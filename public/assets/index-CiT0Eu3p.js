const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-C8LqNsTa.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-DM95sHpr.js","assets/AfterService-BxBQxCmh.js","assets/AdditionalWork-D-RV4EV-.js","assets/additionalWorkService-BZAxvHzw.js","assets/ConstructionPayment-CuQX2b9z.js","assets/WorkRequest-DiZXZPE9.js","assets/Specbook-CDoFzdq_.js","assets/EstimatePreview-A9NKa9Pd.js","assets/ExecutionHistory-DKn2CLp-.js"])))=>i.map(i=>d[i]);
var sx=Object.defineProperty;var rx=(n,e,t)=>e in n?sx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var If=(n,e,t)=>rx(n,typeof e!="symbol"?e+"":e,t);import{r as E,b as ix,u as cg,d as ox,N as ug,e as _u,O as ax,R as lt,f as Fa,B as lx,h as cx,i as En}from"./vendor-react-DN7YJcfR.js";import{a as ux,c as Fm,Q as mx,b as dx}from"./vendor-data-DrLf5NIQ.js";import{B as Du,X as bn,C as mg,T as xi,a as fx,b as dg,W as px,c as hx,d as Ns,P as io,R as gx,e as yx,S as fg,f as bx,g as Nx,h as pg,i as xx,U as zu,I as ta,j as Wu,k as Tf,l as Sf,m as Pf,n as vx,M as _x,o as Dx,p as kx,L as Ex}from"./vendor-ui-D8A9iq7X.js";import{k as ku,l as Uo,m as Ho,n as Vx,o as Ax,p as Ht,q as Cx,r as Lf,s as wx,t as ot}from"./vendor-date-DbWJ9m7c.js";import{c as Ix,p as hg,l as Ec,s as xs,i as Tx,h as Sx,q as Om,a as qm,m as $m,b as Px,d as Vc,o as Ql,e as Lx,f as Yl,r as zm,g as Wm,j as Km,k as Gm,n as Qm,t as gg,u as yg,v as bg,w as Ng,x as xg,y as vg,z as _g,A as Dg,B as kg,C as Eg,D as Vg,E as Ag,F as jx,G as Rx,H as Bx,I as Ux,J as Hx,K as Mx,L as Fx}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Cg={exports:{}},Ku={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var n=E,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),w=Symbol.iterator,v="@@iterator";function C(x){if(x===null||typeof x!="object")return null;var L=w&&x[w]||x[v];return typeof L=="function"?L:null}var B=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function S(x){{for(var L=arguments.length,U=new Array(L>1?L-1:0),X=1;X<L;X++)U[X-1]=arguments[X];F("error",x,U)}}function F(x,L,U){{var X=B.ReactDebugCurrentFrame,G=X.getStackAddendum();G!==""&&(L+="%s",U=U.concat([G]));var Z=U.map(function(ie){return String(ie)});Z.unshift("Warning: "+L),Function.prototype.apply.call(console[x],console,Z)}}var re=!1,ee=!1,M=!1,V=!1,N=!1,A;A=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===m||x===d||V||x===y||re||ee||M||typeof x=="object"&&x!==null&&(x.$$typeof===h||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===A||x.getModuleId!==void 0))}function T(x,L,U){var X=x.displayName;if(X)return X;var G=L.displayName||L.name||"";return G!==""?U+"("+G+")":U}function I(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&S("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var L=x;return I(L)+".Consumer";case o:var U=x;return I(U._context)+".Provider";case u:return T(x,x.render,"ForwardRef");case f:var X=x.displayName||null;return X!==null?X:k(x.type)||"Memo";case h:{var G=x,Z=G._payload,ie=G._init;try{return k(ie(Z))}catch{return null}}}return null}var _e=Object.assign,Fe=0,he,Re,dt,Ot,Ut,ae,Oe;function me(){}me.__reactDisabledLog=!0;function Le(){{if(Fe===0){he=console.log,Re=console.info,dt=console.warn,Ot=console.error,Ut=console.group,ae=console.groupCollapsed,Oe=console.groupEnd;var x={configurable:!0,enumerable:!0,value:me,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}Fe++}}function Ke(){{if(Fe--,Fe===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:_e({},x,{value:he}),info:_e({},x,{value:Re}),warn:_e({},x,{value:dt}),error:_e({},x,{value:Ot}),group:_e({},x,{value:Ut}),groupCollapsed:_e({},x,{value:ae}),groupEnd:_e({},x,{value:Oe})})}Fe<0&&S("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=B.ReactCurrentDispatcher,it;function Vt(x,L,U){{if(it===void 0)try{throw Error()}catch(G){var X=G.stack.trim().match(/\n( *(at )?)/);it=X&&X[1]||""}return`
`+it+x}}var rt=!1,ut;{var un=typeof WeakMap=="function"?WeakMap:Map;ut=new un}function K(x,L){if(!x||rt)return"";{var U=ut.get(x);if(U!==void 0)return U}var X;rt=!0;var G=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Z;Z=bt.current,bt.current=null,Le();try{if(L){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Rt){X=Rt}Reflect.construct(x,[],ie)}else{try{ie.call()}catch(Rt){X=Rt}x.call(ie.prototype)}}else{try{throw Error()}catch(Rt){X=Rt}x()}}catch(Rt){if(Rt&&X&&typeof Rt.stack=="string"){for(var Ae=Rt.stack.split(`
`),Ye=X.stack.split(`
`),He=Ae.length-1,fe=Ye.length-1;He>=1&&fe>=0&&Ae[He]!==Ye[fe];)fe--;for(;He>=1&&fe>=0;He--,fe--)if(Ae[He]!==Ye[fe]){if(He!==1||fe!==1)do if(He--,fe--,fe<0||Ae[He]!==Ye[fe]){var $e=`
`+Ae[He].replace(" at new "," at ");return x.displayName&&$e.includes("<anonymous>")&&($e=$e.replace("<anonymous>",x.displayName)),typeof x=="function"&&ut.set(x,$e),$e}while(He>=1&&fe>=0);break}}}finally{rt=!1,bt.current=Z,Ke(),Error.prepareStackTrace=G}var an=x?x.displayName||x.name:"",$t=an?Vt(an):"";return typeof x=="function"&&ut.set(x,$t),$t}function Se(x,L,U){return K(x,!1)}function Be(x){var L=x.prototype;return!!(L&&L.isReactComponent)}function Ie(x,L,U){if(x==null)return"";if(typeof x=="function")return K(x,Be(x));if(typeof x=="string")return Vt(x);switch(x){case m:return Vt("Suspense");case d:return Vt("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return Se(x.render);case f:return Ie(x.type,L,U);case h:{var X=x,G=X._payload,Z=X._init;try{return Ie(Z(G),L,U)}catch{}}}return""}var Ge=Object.prototype.hasOwnProperty,At={},qt=B.ReactDebugCurrentFrame;function ct(x){if(x){var L=x._owner,U=Ie(x.type,x._source,L?L.type:null);qt.setExtraStackFrame(U)}else qt.setExtraStackFrame(null)}function P(x,L,U,X,G){{var Z=Function.call.bind(Ge);for(var ie in x)if(Z(x,ie)){var Ae=void 0;try{if(typeof x[ie]!="function"){var Ye=Error((X||"React class")+": "+U+" type `"+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[ie]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Ye.name="Invariant Violation",Ye}Ae=x[ie](L,ie,X,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(He){Ae=He}Ae&&!(Ae instanceof Error)&&(ct(G),S("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",X||"React class",U,ie,typeof Ae),ct(null)),Ae instanceof Error&&!(Ae.message in At)&&(At[Ae.message]=!0,ct(G),S("Failed %s type: %s",U,Ae.message),ct(null))}}}var q=Array.isArray;function te(x){return q(x)}function be(x){{var L=typeof Symbol=="function"&&Symbol.toStringTag,U=L&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ce(x){try{return de(x),!1}catch{return!0}}function de(x){return""+x}function we(x){if(ce(x))return S("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",be(x)),de(x)}var qe=B.ReactCurrentOwner,Je={key:!0,ref:!0,__self:!0,__source:!0},ke,Pn,jt;jt={};function ne(x){if(Ge.call(x,"ref")){var L=Object.getOwnPropertyDescriptor(x,"ref").get;if(L&&L.isReactWarning)return!1}return x.ref!==void 0}function Qe(x){if(Ge.call(x,"key")){var L=Object.getOwnPropertyDescriptor(x,"key").get;if(L&&L.isReactWarning)return!1}return x.key!==void 0}function O(x,L){if(typeof x.ref=="string"&&qe.current&&L&&qe.current.stateNode!==L){var U=k(qe.current.type);jt[U]||(S('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(qe.current.type),x.ref),jt[U]=!0)}}function Ne(x,L){{var U=function(){ke||(ke=!0,S("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function De(x,L){{var U=function(){Pn||(Pn=!0,S("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Pe=function(x,L,U,X,G,Z,ie){var Ae={$$typeof:e,type:x,key:L,ref:U,props:ie,_owner:Z};return Ae._store={},Object.defineProperty(Ae._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ae,"_self",{configurable:!1,enumerable:!1,writable:!1,value:X}),Object.defineProperty(Ae,"_source",{configurable:!1,enumerable:!1,writable:!1,value:G}),Object.freeze&&(Object.freeze(Ae.props),Object.freeze(Ae)),Ae};function ue(x,L,U,X,G){{var Z,ie={},Ae=null,Ye=null;U!==void 0&&(we(U),Ae=""+U),Qe(L)&&(we(L.key),Ae=""+L.key),ne(L)&&(Ye=L.ref,O(L,G));for(Z in L)Ge.call(L,Z)&&!Je.hasOwnProperty(Z)&&(ie[Z]=L[Z]);if(x&&x.defaultProps){var He=x.defaultProps;for(Z in He)ie[Z]===void 0&&(ie[Z]=He[Z])}if(Ae||Ye){var fe=typeof x=="function"?x.displayName||x.name||"Unknown":x;Ae&&Ne(ie,fe),Ye&&De(ie,fe)}return Pe(x,Ae,Ye,G,X,qe.current,ie)}}var xt=B.ReactCurrentOwner,yt=B.ReactDebugCurrentFrame;function Qt(x){if(x){var L=x._owner,U=Ie(x.type,x._source,L?L.type:null);yt.setExtraStackFrame(U)}else yt.setExtraStackFrame(null)}var _t;_t=!1;function mn(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function nn(){{if(xt.current){var x=k(xt.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Cn(x){{if(x!==void 0){var L=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+L+":"+U+"."}return""}}var ls={};function Wn(x){{var L=nn();if(!L){var U=typeof x=="string"?x:x.displayName||x.name;U&&(L=`

Check the top-level render call using <`+U+">.")}return L}}function cs(x,L){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=Wn(L);if(ls[U])return;ls[U]=!0;var X="";x&&x._owner&&x._owner!==xt.current&&(X=" It was passed a child from "+k(x._owner.type)+"."),Qt(x),S('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,X),Qt(null)}}function ei(x,L){{if(typeof x!="object")return;if(te(x))for(var U=0;U<x.length;U++){var X=x[U];mn(X)&&cs(X,L)}else if(mn(x))x._store&&(x._store.validated=!0);else if(x){var G=C(x);if(typeof G=="function"&&G!==x.entries)for(var Z=G.call(x),ie;!(ie=Z.next()).done;)mn(ie.value)&&cs(ie.value,L)}}}function Is(x){{var L=x.type;if(L==null||typeof L=="string")return;var U;if(typeof L=="function")U=L.propTypes;else if(typeof L=="object"&&(L.$$typeof===u||L.$$typeof===f))U=L.propTypes;else return;if(U){var X=k(L);P(U,x.props,"prop",X,x)}else if(L.PropTypes!==void 0&&!_t){_t=!0;var G=k(L);S("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",G||"Unknown")}typeof L.getDefaultProps=="function"&&!L.getDefaultProps.isReactClassApproved&&S("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Jn(x){{for(var L=Object.keys(x.props),U=0;U<L.length;U++){var X=L[U];if(X!=="children"&&X!=="key"){Qt(x),S("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",X),Qt(null);break}}x.ref!==null&&(Qt(x),S("Invalid attribute `ref` supplied to `React.Fragment`."),Qt(null))}}var D={};function Q(x,L,U,X,G,Z){{var ie=j(x);if(!ie){var Ae="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Ae+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Ye=Cn(G);Ye?Ae+=Ye:Ae+=nn();var He;x===null?He="null":te(x)?He="array":x!==void 0&&x.$$typeof===e?(He="<"+(k(x.type)||"Unknown")+" />",Ae=" Did you accidentally export a JSX literal instead of a component?"):He=typeof x,S("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",He,Ae)}var fe=ue(x,L,U,G,Z);if(fe==null)return fe;if(ie){var $e=L.children;if($e!==void 0)if(X)if(te($e)){for(var an=0;an<$e.length;an++)ei($e[an],x);Object.freeze&&Object.freeze($e)}else S("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ei($e,x)}if(Ge.call(L,"key")){var $t=k(x),Rt=Object.keys(L).filter(function(Un){return Un!=="key"}),St=Rt.length>0?"{key: someKey, "+Rt.join(": ..., ")+": ...}":"{key: someKey}";if(!D[$t+St]){var Ln=Rt.length>0?"{"+Rt.join(": ..., ")+": ...}":"{}";S(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,St,$t,Ln,$t),D[$t+St]=!0}}return x===s?Jn(fe):Is(fe),fe}}var R=Q;Ku.Fragment=s,Ku.jsxDEV=R})();Cg.exports=Ku;var a=Cg.exports,wg,jf=ix;{var Rf=jf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;wg=function(n,e){Rf.usingClientEntryPoint=!0;try{return jf.createRoot(n,e)}finally{Rf.usingClientEntryPoint=!1}}}const Ox="modulepreload",qx=function(n){return"/"+n},Bf={},Ws=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=qx(u),u in Bf)return;Bf[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":Ox,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let $x={data:""},zx=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||$x},Wx=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Kx=/\/\*[^]*?\*\/|  +/g,Uf=/\n+/g,Er=(n,e)=>{let t="",s="",r="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?Er(o,i):i+"{"+Er(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Er(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Er.p?Er.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},Gs={},Ig=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+Ig(n[t]);return e}return n},Gx=(n,e,t,s,r)=>{let i=Ig(n),o=Gs[i]||(Gs[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Gs[o]){let u=i!==n?n:(m=>{let d,f,h=[{}];for(;d=Wx.exec(m.replace(Kx,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Uf," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Uf," ").trim();return h[0]})(n);Gs[o]=Er(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Gs.g?Gs.g:null;return t&&(Gs.g=Gs[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Gs[o],e,s,l),o},Qx=(n,e,t)=>n.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Er(l,""):l===!1?"":l}return s+r+(o??"")},"");function Ac(n){let e=this||{},t=n.call?n(e.p):n;return Gx(t.unshift?t.raw?Qx(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,zx(e.target),e.g,e.o,e.k)}let Tg,Gu,Qu;Ac.bind({g:1});let tr=Ac.bind({k:1});function Yx(n,e,t,s){Er.p=e,Tg=n,Gu=t,Qu=s}function qr(n,e){let t=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:Gu&&Gu()},l),t.o=/ *go\d+/.test(u),l.className=Ac.apply(t,s)+(u?" "+u:"");let m=n;return n[0]&&(m=l.as||n,delete l.as),Qu&&m[0]&&Qu(l),Tg(m,l)}return r}}var Xx=n=>typeof n=="function",Xl=(n,e)=>Xx(n)?n(e):n,Jx=(()=>{let n=0;return()=>(++n).toString()})(),Sg=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),Zx=20,Ym="default",Pg=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return Pg(n,{type:n.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Il=[],Lg={toasts:[],pausedAt:void 0,settings:{toastLimit:Zx}},Rs={},jg=(n,e=Ym)=>{Rs[e]=Pg(Rs[e]||Lg,n),Il.forEach(([t,s])=>{t===e&&s(Rs[e])})},Rg=n=>Object.keys(Rs).forEach(e=>jg(n,e)),ev=n=>Object.keys(Rs).find(e=>Rs[e].toasts.some(t=>t.id===n)),Cc=(n=Ym)=>e=>{jg(e,n)},tv={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},nv=(n={},e=Ym)=>{let[t,s]=E.useState(Rs[e]||Lg),r=E.useRef(Rs[e]);E.useEffect(()=>(r.current!==Rs[e]&&s(Rs[e]),Il.push([e,s]),()=>{let o=Il.findIndex(([l])=>l===e);o>-1&&Il.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((l=n[o.type])==null?void 0:l.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((u=n[o.type])==null?void 0:u.duration)||(n==null?void 0:n.duration)||tv[o.type],style:{...n.style,...(m=n[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},sv=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Jx()}),Oa=n=>(e,t)=>{let s=sv(e,n,t);return Cc(s.toasterId||ev(s.id))({type:2,toast:s}),s.id},Vn=(n,e)=>Oa("blank")(n,e);Vn.error=Oa("error");Vn.success=Oa("success");Vn.loading=Oa("loading");Vn.custom=Oa("custom");Vn.dismiss=(n,e)=>{let t={type:3,toastId:n};e?Cc(e)(t):Rg(t)};Vn.dismissAll=n=>Vn.dismiss(void 0,n);Vn.remove=(n,e)=>{let t={type:4,toastId:n};e?Cc(e)(t):Rg(t)};Vn.removeAll=n=>Vn.remove(void 0,n);Vn.promise=(n,e,t)=>{let s=Vn.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(r=>{let i=e.success?Xl(e.success,r):void 0;return i?Vn.success(i,{id:s,...t,...t==null?void 0:t.success}):Vn.dismiss(s),r}).catch(r=>{let i=e.error?Xl(e.error,r):void 0;i?Vn.error(i,{id:s,...t,...t==null?void 0:t.error}):Vn.dismiss(s)}),n};var rv=1e3,iv=(n,e="default")=>{let{toasts:t,pausedAt:s}=nv(n,e),r=E.useRef(new Map).current,i=E.useCallback((f,h=rv)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,y)},[]);E.useEffect(()=>{if(s)return;let f=Date.now(),h=t.map(y=>{if(y.duration===1/0)return;let w=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(w<0){y.visible&&Vn.dismiss(y.id);return}return setTimeout(()=>Vn.dismiss(y.id,e),w)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[t,s,e]);let o=E.useCallback(Cc(e),[e]),l=E.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=E.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=E.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=E.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:w=8,defaultPosition:v}=h||{},C=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),B=C.findIndex(F=>F.id===f.id),S=C.filter((F,re)=>re<B&&F.visible).length;return C.filter(F=>F.visible).slice(...y?[S+1]:[0,S]).reduce((F,re)=>F+(re.height||0)+w,0)},[t]);return E.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},ov=tr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,av=tr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lv=tr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,cv=qr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ov} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${av} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${lv} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,uv=tr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,mv=qr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${uv} 1s linear infinite;
`,dv=tr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,fv=tr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,pv=qr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${fv} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hv=qr("div")`
  position: absolute;
`,gv=qr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,yv=tr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,bv=qr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${yv} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Nv=({toast:n})=>{let{icon:e,type:t,iconTheme:s}=n;return e!==void 0?typeof e=="string"?E.createElement(bv,null,e):e:t==="blank"?null:E.createElement(gv,null,E.createElement(mv,{...s}),t!=="loading"&&E.createElement(hv,null,t==="error"?E.createElement(cv,{...s}):E.createElement(pv,{...s})))},xv=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,vv=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,_v="0%{opacity:0;} 100%{opacity:1;}",Dv="0%{opacity:1;} 100%{opacity:0;}",kv=qr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ev=qr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Vv=(n,e)=>{let t=n.includes("top")?1:-1,[s,r]=Sg()?[_v,Dv]:[xv(t),vv(t)];return{animation:e?`${tr(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${tr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Av=E.memo(({toast:n,position:e,style:t,children:s})=>{let r=n.height?Vv(n.position||e||"top-center",n.visible):{opacity:0},i=E.createElement(Nv,{toast:n}),o=E.createElement(Ev,{...n.ariaProps},Xl(n.message,n));return E.createElement(kv,{className:n.className,style:{...r,...t,...n.style}},typeof s=="function"?s({icon:i,message:o}):E.createElement(E.Fragment,null,i,o))});Yx(E.createElement);var Cv=({id:n,className:e,style:t,onHeightUpdate:s,children:r})=>{let i=E.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;s(n,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return E.createElement("div",{ref:i,className:e,style:t},r)},wv=(n,e)=>{let t=n.includes("top"),s=t?{top:0}:{bottom:0},r=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Sg()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},Iv=Ac`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ll=16,Tv=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=iv(t,i);return E.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ll,left:ll,right:ll,bottom:ll,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:n,gutter:s,defaultPosition:e}),y=wv(f,h);return E.createElement(Cv,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?Iv:"",style:y},d.type==="custom"?Xl(d.message,d):r?r(d):E.createElement(Av,{toast:d,position:f}))}))},oe=Vn;const Os=Object.create(null);Os.open="0";Os.close="1";Os.ping="2";Os.pong="3";Os.message="4";Os.upgrade="5";Os.noop="6";const Tl=Object.create(null);Object.keys(Os).forEach(n=>{Tl[Os[n]]=n});const Yu={type:"error",data:"parser error"},Bg=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ug=typeof ArrayBuffer=="function",Hg=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Xm=({type:n,data:e},t,s)=>Bg&&e instanceof Blob?t?s(e):Hf(e,s):Ug&&(e instanceof ArrayBuffer||Hg(e))?t?s(e):Hf(new Blob([e]),s):s(Os[n]+(e||"")),Hf=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function Mf(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let Eu;function Sv(n,e){if(Bg&&n.data instanceof Blob)return n.data.arrayBuffer().then(Mf).then(e);if(Ug&&(n.data instanceof ArrayBuffer||Hg(n.data)))return e(Mf(n.data));Xm(n,!1,t=>{Eu||(Eu=new TextEncoder),e(Eu.encode(t))})}const Ff="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",na=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Ff.length;n++)na[Ff.charCodeAt(n)]=n;const Pv=n=>{let e=n.length*.75,t=n.length,s,r=0,i,o,l,u;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(s=0;s<t;s+=4)i=na[n.charCodeAt(s)],o=na[n.charCodeAt(s+1)],l=na[n.charCodeAt(s+2)],u=na[n.charCodeAt(s+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},Lv=typeof ArrayBuffer=="function",Jm=(n,e)=>{if(typeof n!="string")return{type:"message",data:Mg(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:jv(n.substring(1),e)}:Tl[t]?n.length>1?{type:Tl[t],data:n.substring(1)}:{type:Tl[t]}:Yu},jv=(n,e)=>{if(Lv){const t=Pv(n);return Mg(t,e)}else return{base64:!0,data:n}},Mg=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Fg="",Rv=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((i,o)=>{Xm(i,!1,l=>{s[o]=l,++r===t&&e(s.join(Fg))})})},Bv=(n,e)=>{const t=n.split(Fg),s=[];for(let r=0;r<t.length;r++){const i=Jm(t[r],e);if(s.push(i),i.type==="error")break}return s};function Uv(){return new TransformStream({transform(n,e){Sv(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Vu;function cl(n){return n.reduce((e,t)=>e+t.length,0)}function ul(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function Hv(n,e){Vu||(Vu=new TextDecoder);const t=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(s===0){if(cl(t)<1)break;const u=ul(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(cl(t)<2)break;const u=ul(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(cl(t)<8)break;const u=ul(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(Yu);break}r=d*Math.pow(2,32)+m.getUint32(4),s=3}else{if(cl(t)<r)break;const u=ul(t,r);l.enqueue(Jm(i?u:Vu.decode(u),e)),s=0}if(r===0||r>n){l.enqueue(Yu);break}}}})}const Og=4;function Nn(n){if(n)return Mv(n)}function Mv(n){for(var e in Nn.prototype)n[e]=Nn.prototype[e];return n}Nn.prototype.on=Nn.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};Nn.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};Nn.prototype.off=Nn.prototype.removeListener=Nn.prototype.removeAllListeners=Nn.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};Nn.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};Nn.prototype.emitReserved=Nn.prototype.emit;Nn.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};Nn.prototype.hasListeners=function(n){return!!this.listeners(n).length};const wc=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),us=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Fv="arraybuffer";function qg(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const Ov=us.setTimeout,qv=us.clearTimeout;function Ic(n,e){e.useNativeTimers?(n.setTimeoutFn=Ov.bind(us),n.clearTimeoutFn=qv.bind(us)):(n.setTimeoutFn=us.setTimeout.bind(us),n.clearTimeoutFn=us.clearTimeout.bind(us))}const $v=1.33;function zv(n){return typeof n=="string"?Wv(n):Math.ceil((n.byteLength||n.size)*$v)}function Wv(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function $g(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Kv(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function Gv(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let i=t[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class Qv extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class Zm extends Nn{constructor(e){super(),this.writable=!1,Ic(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new Qv(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Jm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Kv(e);return t.length?"?"+t:""}}class Yv extends Zm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Bv(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Rv(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=$g()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let zg=!1;try{zg=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Xv=zg;function Jv(){}class Zv extends Yv{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}let oo=class Sl extends Nn{constructor(e,t,s){super(),this.createRequest=e,Ic(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=qg(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Sl.requestsCount++,Sl.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Jv,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Sl.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};oo.requestsCount=0;oo.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Of);else if(typeof addEventListener=="function"){const n="onpagehide"in us?"pagehide":"unload";addEventListener(n,Of,!1)}}function Of(){for(let n in oo.requests)oo.requests.hasOwnProperty(n)&&oo.requests[n].abort()}const e_=function(){const n=Wg({xdomain:!1});return n&&n.responseType!==null}();class t_ extends Zv{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=e_&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new oo(Wg,this.uri(),e)}}function Wg(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Xv))return new XMLHttpRequest}catch{}if(!e)try{return new us[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Kg=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class n_ extends Zm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=Kg?{}:qg(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;Xm(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&wc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=$g()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Au=us.WebSocket||us.MozWebSocket;class s_ extends n_{createSocket(e,t,s){return Kg?new Au(e,t,s):t?new Au(e,t):new Au(e)}doWrite(e,t){this.ws.send(t)}}class r_ extends Zm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Hv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=Uv();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&wc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const i_={websocket:s_,webtransport:r_,polling:t_},o_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Xu(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=o_.exec(n||""),i={},o=14;for(;o--;)i[a_[o]]=r[o]||"";return t!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=l_(i,i.path),i.queryKey=c_(i,i.query),i}function l_(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function c_(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(t[r]=i)}),t}const Ju=typeof addEventListener=="function"&&typeof removeEventListener=="function",Pl=[];Ju&&addEventListener("offline",()=>{Pl.forEach(n=>n())},!1);class wr extends Nn{constructor(e,t){if(super(),this.binaryType=Fv,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=Xu(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=Xu(t.host).host);Ic(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Gv(this.opts.query)),Ju&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Pl.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Og,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&wr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",wr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=zv(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,wc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:t,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(wr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ju&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Pl.indexOf(this._offlineEventListener);s!==-1&&Pl.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}wr.protocol=Og;class u_ extends wr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;wr.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;wr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){s||(s=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let m_=class extends u_{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>i_[r]).filter(r=>!!r)),super(e,s)}};function d_(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=Xu(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(t&&t.port===s.port?"":":"+s.port),s}const f_=typeof ArrayBuffer=="function",p_=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Gg=Object.prototype.toString,h_=typeof Blob=="function"||typeof Blob<"u"&&Gg.call(Blob)==="[object BlobConstructor]",g_=typeof File=="function"||typeof File<"u"&&Gg.call(File)==="[object FileConstructor]";function ed(n){return f_&&(n instanceof ArrayBuffer||p_(n))||h_&&n instanceof Blob||g_&&n instanceof File}function Ll(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(Ll(n[t]))return!0;return!1}if(ed(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Ll(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&Ll(n[t]))return!0;return!1}function y_(n){const e=[],t=n.data,s=n;return s.data=Zu(t,e),s.attachments=e.length,{packet:s,buffers:e}}function Zu(n,e){if(!n)return n;if(ed(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=Zu(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=Zu(n[s],e));return t}return n}function b_(n,e){return n.data=em(n.data,e),delete n.attachments,n}function em(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=em(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=em(n[t],e));return n}const N_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],x_=5;var vt;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(vt||(vt={}));class v_{constructor(e){this.replacer=e}encode(e){return(e.type===vt.EVENT||e.type===vt.ACK)&&Ll(e)?this.encodeAsBinary({type:e.type===vt.EVENT?vt.BINARY_EVENT:vt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===vt.BINARY_EVENT||e.type===vt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=y_(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}function qf(n){return Object.prototype.toString.call(n)==="[object Object]"}class td extends Nn{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===vt.BINARY_EVENT;s||t.type===vt.BINARY_ACK?(t.type=s?vt.EVENT:vt.ACK,this.reconstructor=new __(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(ed(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(vt[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===vt.BINARY_EVENT||s.type===vt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(i,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(td.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case vt.CONNECT:return qf(t);case vt.DISCONNECT:return t===void 0;case vt.CONNECT_ERROR:return typeof t=="string"||qf(t);case vt.EVENT:case vt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&N_.indexOf(t[0])===-1);case vt.ACK:case vt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class __{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=b_(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const D_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:td,Encoder:v_,get PacketType(){return vt},protocol:x_},Symbol.toStringTag,{value:"Module"}));function ys(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const k_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Qg extends Nn{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ys(e,"open",this.onopen.bind(this)),ys(e,"packet",this.onpacket.bind(this)),ys(e,"error",this.onerror.bind(this)),ys(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,i;if(k_.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:vt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,r)=>{const i=(o,l)=>o?r(o):s(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:vt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case vt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case vt.EVENT:case vt.BINARY_EVENT:this.onevent(e);break;case vt.ACK:case vt.BINARY_ACK:this.onack(e);break;case vt.DISCONNECT:this.ondisconnect();break;case vt.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:vt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:vt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function ko(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}ko.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};ko.prototype.reset=function(){this.attempts=0};ko.prototype.setMin=function(n){this.ms=n};ko.prototype.setMax=function(n){this.max=n};ko.prototype.setJitter=function(n){this.jitter=n};class tm extends Nn{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Ic(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new ko({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||D_;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new m_(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=ys(t,"open",function(){s.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=ys(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ys(e,"ping",this.onping.bind(this)),ys(e,"data",this.ondata.bind(this)),ys(e,"error",this.onerror.bind(this)),ys(e,"close",this.onclose.bind(this)),ys(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){wc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Qg(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Mo={};function ca(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=d_(n,e.path||"/socket.io"),s=t.source,r=t.id,i=t.path,o=Mo[r]&&i in Mo[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new tm(s,e):(Mo[r]||(Mo[r]=new tm(s,e)),u=Mo[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(ca,{Manager:tm,Socket:Qg,io:ca,connect:ca});function E_(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=n;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Ws(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,l==null||l.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"?w.isExternal?y():!h&&(s==null||s()):w.isExternal?window.location.reload():!h&&(s==null||s()):w.isUpdate||s==null||s()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const V_=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},A_=V_(),Ce=ux.create({baseURL:A_,headers:{"Content-Type":"application/json"}});Ce.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));Ce.interceptors.response.use(n=>n,n=>{var e,t,s;return((e=n.response)==null?void 0:e.status)===401&&!((s=(t=n.config)==null?void 0:t.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(n)});const C_=10*60*1e3,w_=Fm((n,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<C_){console.log("[SpecbookStore]   , ");return}n({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await Ce.get("/specbook/library/meta");n({libraryItems:s.data,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.data.length," ")}catch(s){console.error("[SpecbookStore]   :",s),n({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await Ce.get("/specbook/categories");n({categories:s.data,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.data.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:s}=e();await Promise.all([t(),s()])},getLibraryItems:(t,s)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),s&&s.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return s.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:s}=e();return s.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const o=(await Ce.get(`/specbook/project/${t}/meta`)).data;return n(l=>{const u=new Map(l.projectItemsCache);return u.set(t,o),{projectItemsCache:u}}),o}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{n(s=>{const r=new Map(s.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{n({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?n(s=>({libraryItems:[t,...s.libraryItems]})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?n(s=>({libraryItems:s.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&n(s=>{const r=new Map(s.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,s,r)=>{s?n(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&n(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),Yg=E.createContext(void 0);function I_({children:n}){const[e,t]=E.useState(null),[s,r]=E.useState(!0),i=cg(),o=w_(f=>f.preloadAll);E.useEffect(()=>{l()},[]);const l=async()=>{var f;try{const h=localStorage.getItem("token");if(!h){r(!1);return}Ce.defaults.headers.common.Authorization=`Bearer ${h}`;const y=await Ce.get("/auth/me");y.data.success&&(t(y.data.user),o())}catch(h){if(((f=h.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete Ce.defaults.headers.common.Authorization;else{const w=localStorage.getItem("user");if(w)try{t(JSON.parse(w))}catch{}}}finally{r(!1)}},u=async(f,h)=>{var y,w;try{const v=await Ce.post("/auth/login",{username:f,password:h}),{token:C,user:B}=v.data;localStorage.setItem("token",C),localStorage.setItem("user",JSON.stringify(B)),Ce.defaults.headers.common.Authorization=`Bearer ${C}`,t(B),o(),oe.success(`${B.name}, !`);const S=sessionStorage.getItem("redirectAfterLogin");S?(sessionStorage.removeItem("redirectAfterLogin"),i(S)):i("/")}catch(v){const C=v;throw oe.error(((w=(y=C.response)==null?void 0:y.data)==null?void 0:w.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Ce.defaults.headers.common.Authorization,t(null),i("/login"),oe.success("")},d=f=>{t(f)};return a.jsxDEV(Yg.Provider,{value:{user:e,loading:s,login:u,logout:m,updateUser:d},children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:122,columnNumber:5},this)}function $r(){const n=E.useContext(Yg);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const T_={};function S_(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const Da=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return Da(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return Da(s)(t)}}}},P_=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:C=>C,version:0,merge:(C,B)=>({...B,...C}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return n((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...C)},s,r);const d=Da(i.serialize),f=()=>{const C=i.partialize({...s()});let B;const S=d({state:C,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{B=F});if(B)throw B;return S},h=r.setState;r.setState=(C,B)=>{h(C,B),f()};const y=n((...C)=>{t(...C),f()},s,r);let w;const v=()=>{var C;if(!m)return;o=!1,l.forEach(S=>S(s()));const B=((C=i.onRehydrateStorage)==null?void 0:C.call(i,s()))||void 0;return Da(m.getItem.bind(m))(i.name).then(S=>{if(S)return i.deserialize(S)}).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==i.version){if(i.migrate)return i.migrate(S.state,S.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return S.state}).then(S=>{var F;return w=i.merge(S,(F=s())!=null?F:y),t(w,!0),f()}).then(()=>{B==null||B(w,void 0),o=!0,u.forEach(S=>S(w))}).catch(S=>{B==null||B(void 0,S)})};return r.persist={setOptions:C=>{i={...i,...C},C.getStorage&&(m=C.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(u.add(C),()=>{u.delete(C)})},v(),w||y},L_=(n,e)=>(t,s,r)=>{let i={storage:S_(()=>localStorage),partialize:v=>v,version:0,merge:(v,C)=>({...C,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,C)=>{f(v,C),d()};const h=n((...v)=>{t(...v),d()},s,r);r.getInitialState=()=>h;let y;const w=()=>{var v,C;if(!m)return;o=!1,l.forEach(S=>{var F;return S((F=s())!=null?F:h)});const B=((C=i.onRehydrateStorage)==null?void 0:C.call(i,(v=s())!=null?v:h))||void 0;return Da(m.getItem.bind(m))(i.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==i.version){if(i.migrate)return[!0,i.migrate(S.state,S.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var F;const[re,ee]=S;if(y=i.merge(ee,(F=s())!=null?F:h),t(y,!0),re)return d()}).then(()=>{B==null||B(y,void 0),y=s(),o=!0,u.forEach(S=>S(y))}).catch(S=>{B==null||B(void 0,S)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||w(),y||h},j_=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((T_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),P_(n,e)):L_(n,e),Xg=j_,Jg=Fm()(Xg((n,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const s={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};n(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{n(s=>({notifications:s.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{n(t=>({notifications:t.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:t=>{n(s=>{const r=s.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:s.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{n({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:n=>({notifications:n.notifications,unreadCount:n.unreadCount})}));var R_={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},B_=function(e,t,s){var r,i=R_[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},U_={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},H_={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},M_={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},F_={date:ku({formats:U_,defaultWidth:"full"}),time:ku({formats:H_,defaultWidth:"full"}),dateTime:ku({formats:M_,defaultWidth:"full"})},O_={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},q_=function(e,t,s,r){return O_[e]},$_={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},z_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},W_={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},K_={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},G_={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},Q_={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},Y_=function(e,t){var s=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},X_={ordinalNumber:Y_,era:Uo({values:$_,defaultWidth:"wide"}),quarter:Uo({values:z_,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Uo({values:W_,defaultWidth:"wide"}),day:Uo({values:K_,defaultWidth:"wide"}),dayPeriod:Uo({values:G_,defaultWidth:"wide",formattingValues:Q_,defaultFormattingWidth:"wide"})},J_=/^(\d+)(|)?/i,Z_=/\d+/i,eD={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},tD={any:[/^(bc|)/i,/^(ad|)/i]},nD={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},sD={any:[/1/i,/2/i,/3/i,/4/i]},rD={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},iD={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},oD={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},aD={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},lD={any:/^(am|pm|||||||)/i},cD={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},uD={ordinalNumber:Vx({matchPattern:J_,parsePattern:Z_,valueCallback:function(e){return parseInt(e,10)}}),era:Ho({matchPatterns:eD,defaultMatchWidth:"wide",parsePatterns:tD,defaultParseWidth:"any"}),quarter:Ho({matchPatterns:nD,defaultMatchWidth:"wide",parsePatterns:sD,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Ho({matchPatterns:rD,defaultMatchWidth:"wide",parsePatterns:iD,defaultParseWidth:"any"}),day:Ho({matchPatterns:oD,defaultMatchWidth:"wide",parsePatterns:aD,defaultParseWidth:"any"}),dayPeriod:Ho({matchPatterns:lD,defaultMatchWidth:"any",parsePatterns:cD,defaultParseWidth:"any"})},yn={code:"ko",formatDistance:B_,formatLong:F_,formatRelative:q_,localize:X_,match:uD,options:{weekStartsOn:0,firstWeekContainsDate:1}};const mD=({isOpen:n,onClose:e})=>{const t=cg(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Jg();if(!n)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(hx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(px,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(dg,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(fx,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Du,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Du,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(mg,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(xi,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Du,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ax(new Date(h.createdAt),{addSuffix:!0,locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(bn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},dD={getAllWorkRequests:async()=>(await Ce.get("/workrequests")).data,getWorkRequestById:async n=>(await Ce.get(`/workrequests/${n}`)).data,createWorkRequest:async n=>{console.log("[workRequestService.createWorkRequest] Input data:",n);const e={project:n.project,requestType:n.requestType,description:n.description,requestDate:n.requestDate instanceof Date?n.requestDate.toISOString():n.requestDate,dueDate:n.dueDate instanceof Date?n.dueDate.toISOString():n.dueDate,requestedBy:n.requestedBy,assignedTo:n.assignedTo,priority:n.priority||"medium",status:n.status||"pending",notes:n.notes||""};return console.log("[workRequestService.createWorkRequest] Sending to backend:",e),(await Ce.post("/workrequests",e)).data},updateWorkRequest:async(n,e)=>{console.log("[workRequestService.updateWorkRequest] Input data:",e);const t={};return e.project!==void 0&&(t.project=e.project),e.requestType!==void 0&&(t.requestType=e.requestType),e.description!==void 0&&(t.description=e.description),e.requestDate!==void 0&&(t.requestDate=e.requestDate instanceof Date?e.requestDate.toISOString():e.requestDate),e.dueDate!==void 0&&(t.dueDate=e.dueDate instanceof Date?e.dueDate.toISOString():e.dueDate),e.requestedBy!==void 0&&(t.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(t.assignedTo=e.assignedTo),e.priority!==void 0&&(t.priority=e.priority),e.status!==void 0&&(t.status=e.status),e.notes!==void 0&&(t.notes=e.notes),e.completedDate!==void 0&&(t.completedDate=e.completedDate instanceof Date?e.completedDate.toISOString():e.completedDate),console.log("[workRequestService.updateWorkRequest] Sending to backend:",t),(await Ce.put(`/workrequests/${n}`,t)).data},deleteWorkRequest:async n=>{await Ce.delete(`/workrequests/${n}`)}},fD=()=>{};var $f={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},pD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ey={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,m=u?n[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(h=64)),s.push(t[d],t[f],t[h],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Zg(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new hD;const h=i<<2|l>>4;if(s.push(h),m!==64){const y=l<<4&240|m>>2;if(s.push(y),f!==64){const w=m<<6&192|f;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class hD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gD=function(n){const e=Zg(n);return ey.encodeByteArray(e,!0)},Jl=function(n){return gD(n).replace(/\./g,"")},yD=function(n){try{return ey.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=()=>ty().__FIREBASE_DEFAULTS__,ND=()=>{if(typeof process>"u"||typeof $f>"u")return;const n=$f.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&yD(n[1]);return e&&JSON.parse(e)},nd=()=>{try{return fD()||bD()||ND()||xD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vD=n=>{var e,t;return(t=(e=nd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},ny=n=>{const e=vD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},sy=()=>{var n;return(n=nd())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ry(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Jl(JSON.stringify(t)),Jl(JSON.stringify(o)),""].join(".")}const ua={};function DD(){const n={prod:[],emulator:[]};for(const e of Object.keys(ua))ua[e]?n.emulator.push(e):n.prod.push(e);return n}function kD(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let zf=!1;function oy(n,e){if(typeof window>"u"||typeof document>"u"||!Tc(window.location.host)||ua[n]===e||ua[n]||zf)return;ua[n]=e;function t(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=DD().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{zf=!0,o()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=kD(s),y=t("text"),w=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),C=document.getElementById(v)||document.createElement("a"),B=t("preprendIcon"),S=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const F=h.element;l(F),d(C,v);const re=m();u(S,B),F.append(S,w,C,re),document.body.appendChild(F)}i?(w.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ay(){var e;const n=(e=nd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ly(){return!ay()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cy(){return!ay()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function uy(){try{return typeof indexedDB=="object"}catch{return!1}}function ED(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="FirebaseError";class wi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=VD,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,my.prototype.create)}}class my{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?AD(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new wi(r,l,s)}}function AD(n,e){return n.replace(CD,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const CD=/\{\$([^}]+)}/g;function ec(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Wf(i)&&Wf(o)){if(!ec(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Wf(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(n){return n&&n._delegate?n._delegate:n}class lo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new _D;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TD(e))try{this.getOrInitializeService({instanceIdentifier:ii})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=ii){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ii){return this.instances.has(e)}getOptions(e=ii){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:ID(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ii){return this.component?this.component.multipleInstances?e:ii:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ID(n){return n===ii?void 0:n}function TD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Et||(Et={}));const PD={debug:Et.DEBUG,verbose:Et.VERBOSE,info:Et.INFO,warn:Et.WARN,error:Et.ERROR,silent:Et.SILENT},LD=Et.INFO,jD={[Et.DEBUG]:"log",[Et.VERBOSE]:"log",[Et.INFO]:"info",[Et.WARN]:"warn",[Et.ERROR]:"error"},RD=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=jD[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dy{constructor(e){this.name=e,this._logLevel=LD,this._logHandler=RD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Et.DEBUG,...e),this._logHandler(this,Et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Et.VERBOSE,...e),this._logHandler(this,Et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Et.INFO,...e),this._logHandler(this,Et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Et.WARN,...e),this._logHandler(this,Et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Et.ERROR,...e),this._logHandler(this,Et.ERROR,...e)}}const BD=(n,e)=>e.some(t=>n instanceof t);let Kf,Gf;function UD(){return Kf||(Kf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HD(){return Gf||(Gf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fy=new WeakMap,nm=new WeakMap,py=new WeakMap,Cu=new WeakMap,sd=new WeakMap;function MD(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Ir(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&fy.set(t,n)}).catch(()=>{}),sd.set(e,n),e}function FD(n){if(nm.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});nm.set(n,e)}let sm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return nm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||py.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ir(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function OD(n){sm=n(sm)}function qD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(wu(this),e,...t);return py.set(s,e.sort?e.sort():[e]),Ir(s)}:HD().includes(n)?function(...e){return n.apply(wu(this),e),Ir(fy.get(this))}:function(...e){return Ir(n.apply(wu(this),e))}}function $D(n){return typeof n=="function"?qD(n):(n instanceof IDBTransaction&&FD(n),BD(n,UD())?new Proxy(n,sm):n)}function Ir(n){if(n instanceof IDBRequest)return MD(n);if(Cu.has(n))return Cu.get(n);const e=$D(n);return e!==n&&(Cu.set(n,e),sd.set(e,n)),e}const wu=n=>sd.get(n);function zD(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Ir(o);return s&&o.addEventListener("upgradeneeded",u=>{s(Ir(o.result),u.oldVersion,u.newVersion,Ir(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const WD=["get","getKey","getAll","getAllKeys","count"],KD=["put","add","delete","clear"],Iu=new Map;function Qf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Iu.get(e))return Iu.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=KD.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||WD.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return s&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Iu.set(e,i),i}OD(n=>({...n,get:(e,t,s)=>Qf(e,t)||n.get(e,t,s),has:(e,t)=>!!Qf(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QD(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function QD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rm="@firebase/app",Yf="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new dy("@firebase/app"),YD="@firebase/app-compat",XD="@firebase/analytics-compat",JD="@firebase/analytics",ZD="@firebase/app-check-compat",ek="@firebase/app-check",tk="@firebase/auth",nk="@firebase/auth-compat",sk="@firebase/database",rk="@firebase/data-connect",ik="@firebase/database-compat",ok="@firebase/functions",ak="@firebase/functions-compat",lk="@firebase/installations",ck="@firebase/installations-compat",uk="@firebase/messaging",mk="@firebase/messaging-compat",dk="@firebase/performance",fk="@firebase/performance-compat",pk="@firebase/remote-config",hk="@firebase/remote-config-compat",gk="@firebase/storage",yk="@firebase/storage-compat",bk="@firebase/firestore",Nk="@firebase/ai",xk="@firebase/firestore-compat",vk="firebase",_k="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="[DEFAULT]",Dk={[rm]:"fire-core",[YD]:"fire-core-compat",[JD]:"fire-analytics",[XD]:"fire-analytics-compat",[ek]:"fire-app-check",[ZD]:"fire-app-check-compat",[tk]:"fire-auth",[nk]:"fire-auth-compat",[sk]:"fire-rtdb",[rk]:"fire-data-connect",[ik]:"fire-rtdb-compat",[ok]:"fire-fn",[ak]:"fire-fn-compat",[lk]:"fire-iid",[ck]:"fire-iid-compat",[uk]:"fire-fcm",[mk]:"fire-fcm-compat",[dk]:"fire-perf",[fk]:"fire-perf-compat",[pk]:"fire-rc",[hk]:"fire-rc-compat",[gk]:"fire-gcs",[yk]:"fire-gcs-compat",[bk]:"fire-fst",[xk]:"fire-fst-compat",[Nk]:"fire-vertex","fire-js":"fire-js",[vk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=new Map,kk=new Map,om=new Map;function Xf(n,e){try{n.container.addComponent(e)}catch(t){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ka(n){const e=n.name;if(om.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;om.set(e,n);for(const t of tc.values())Xf(t,n);for(const t of kk.values())Xf(t,n);return!0}function hy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function gy(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tr=new my("app","Firebase",Ek);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy=_k;function by(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:im,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Tr.create("bad-app-name",{appName:String(r)});if(t||(t=sy()),!t)throw Tr.create("no-options");const i=tc.get(r);if(i){if(ec(t,i.options)&&ec(s,i.config))return i;throw Tr.create("duplicate-app",{appName:r})}const o=new SD(r);for(const u of om.values())o.addComponent(u);const l=new Vk(t,s,o);return tc.set(r,l),l}function Ny(n=im){const e=tc.get(n);if(!e&&n===im&&sy())return by();if(!e)throw Tr.create("no-app",{appName:n});return e}function Sr(n,e,t){let s=Dk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(o.join(" "));return}ka(new lo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak="firebase-heartbeat-database",Ck=1,Ea="firebase-heartbeat-store";let Tu=null;function xy(){return Tu||(Tu=zD(Ak,Ck,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ea)}catch(t){console.warn(t)}}}}).catch(n=>{throw Tr.create("idb-open",{originalErrorMessage:n.message})})),Tu}async function wk(n){try{const t=(await xy()).transaction(Ea),s=await t.objectStore(Ea).get(vy(n));return await t.done,s}catch(e){if(e instanceof wi)nr.warn(e.message);else{const t=Tr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(t.message)}}}async function Jf(n,e){try{const s=(await xy()).transaction(Ea,"readwrite");await s.objectStore(Ea).put(e,vy(n)),await s.done}catch(t){if(t instanceof wi)nr.warn(t.message);else{const s=Tr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});nr.warn(s.message)}}}function vy(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik=1024,Tk=30;class Sk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Lk(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Zf();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>Tk){const o=jk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){nr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Zf(),{heartbeatsToSend:s,unsentEntries:r}=Pk(this._heartbeatsCache.heartbeats),i=Jl(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return nr.warn(t),""}}}function Zf(){return new Date().toISOString().substring(0,10)}function Pk(n,e=Ik){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),ep(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ep(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Lk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uy()?ED().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Jf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Jf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ep(n){return Jl(JSON.stringify({version:2,heartbeats:n})).length}function jk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(n){ka(new lo("platform-logger",e=>new GD(e),"PRIVATE")),ka(new lo("heartbeat",e=>new Sk(e),"PRIVATE")),Sr(rm,Yf,n),Sr(rm,Yf,"esm2020"),Sr("fire-js","")}Rk("");var Bk="firebase",Uk="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr(Bk,Uk,"app");var tp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pr,_y;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(V,N){function A(){}A.prototype=N.prototype,V.F=N.prototype,V.prototype=new A,V.prototype.constructor=V,V.D=function(j,T,I){for(var k=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)k[_e-2]=arguments[_e];return N.prototype[T].apply(j,k)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(V,N,A){A||(A=0);const j=Array(16);if(typeof N=="string")for(var T=0;T<16;++T)j[T]=N.charCodeAt(A++)|N.charCodeAt(A++)<<8|N.charCodeAt(A++)<<16|N.charCodeAt(A++)<<24;else for(T=0;T<16;++T)j[T]=N[A++]|N[A++]<<8|N[A++]<<16|N[A++]<<24;N=V.g[0],A=V.g[1],T=V.g[2];let I=V.g[3],k;k=N+(I^A&(T^I))+j[0]+3614090360&4294967295,N=A+(k<<7&4294967295|k>>>25),k=I+(T^N&(A^T))+j[1]+3905402710&4294967295,I=N+(k<<12&4294967295|k>>>20),k=T+(A^I&(N^A))+j[2]+606105819&4294967295,T=I+(k<<17&4294967295|k>>>15),k=A+(N^T&(I^N))+j[3]+3250441966&4294967295,A=T+(k<<22&4294967295|k>>>10),k=N+(I^A&(T^I))+j[4]+4118548399&4294967295,N=A+(k<<7&4294967295|k>>>25),k=I+(T^N&(A^T))+j[5]+1200080426&4294967295,I=N+(k<<12&4294967295|k>>>20),k=T+(A^I&(N^A))+j[6]+2821735955&4294967295,T=I+(k<<17&4294967295|k>>>15),k=A+(N^T&(I^N))+j[7]+4249261313&4294967295,A=T+(k<<22&4294967295|k>>>10),k=N+(I^A&(T^I))+j[8]+1770035416&4294967295,N=A+(k<<7&4294967295|k>>>25),k=I+(T^N&(A^T))+j[9]+2336552879&4294967295,I=N+(k<<12&4294967295|k>>>20),k=T+(A^I&(N^A))+j[10]+4294925233&4294967295,T=I+(k<<17&4294967295|k>>>15),k=A+(N^T&(I^N))+j[11]+2304563134&4294967295,A=T+(k<<22&4294967295|k>>>10),k=N+(I^A&(T^I))+j[12]+1804603682&4294967295,N=A+(k<<7&4294967295|k>>>25),k=I+(T^N&(A^T))+j[13]+4254626195&4294967295,I=N+(k<<12&4294967295|k>>>20),k=T+(A^I&(N^A))+j[14]+2792965006&4294967295,T=I+(k<<17&4294967295|k>>>15),k=A+(N^T&(I^N))+j[15]+1236535329&4294967295,A=T+(k<<22&4294967295|k>>>10),k=N+(T^I&(A^T))+j[1]+4129170786&4294967295,N=A+(k<<5&4294967295|k>>>27),k=I+(A^T&(N^A))+j[6]+3225465664&4294967295,I=N+(k<<9&4294967295|k>>>23),k=T+(N^A&(I^N))+j[11]+643717713&4294967295,T=I+(k<<14&4294967295|k>>>18),k=A+(I^N&(T^I))+j[0]+3921069994&4294967295,A=T+(k<<20&4294967295|k>>>12),k=N+(T^I&(A^T))+j[5]+3593408605&4294967295,N=A+(k<<5&4294967295|k>>>27),k=I+(A^T&(N^A))+j[10]+38016083&4294967295,I=N+(k<<9&4294967295|k>>>23),k=T+(N^A&(I^N))+j[15]+3634488961&4294967295,T=I+(k<<14&4294967295|k>>>18),k=A+(I^N&(T^I))+j[4]+3889429448&4294967295,A=T+(k<<20&4294967295|k>>>12),k=N+(T^I&(A^T))+j[9]+568446438&4294967295,N=A+(k<<5&4294967295|k>>>27),k=I+(A^T&(N^A))+j[14]+3275163606&4294967295,I=N+(k<<9&4294967295|k>>>23),k=T+(N^A&(I^N))+j[3]+4107603335&4294967295,T=I+(k<<14&4294967295|k>>>18),k=A+(I^N&(T^I))+j[8]+1163531501&4294967295,A=T+(k<<20&4294967295|k>>>12),k=N+(T^I&(A^T))+j[13]+2850285829&4294967295,N=A+(k<<5&4294967295|k>>>27),k=I+(A^T&(N^A))+j[2]+4243563512&4294967295,I=N+(k<<9&4294967295|k>>>23),k=T+(N^A&(I^N))+j[7]+1735328473&4294967295,T=I+(k<<14&4294967295|k>>>18),k=A+(I^N&(T^I))+j[12]+2368359562&4294967295,A=T+(k<<20&4294967295|k>>>12),k=N+(A^T^I)+j[5]+4294588738&4294967295,N=A+(k<<4&4294967295|k>>>28),k=I+(N^A^T)+j[8]+2272392833&4294967295,I=N+(k<<11&4294967295|k>>>21),k=T+(I^N^A)+j[11]+1839030562&4294967295,T=I+(k<<16&4294967295|k>>>16),k=A+(T^I^N)+j[14]+4259657740&4294967295,A=T+(k<<23&4294967295|k>>>9),k=N+(A^T^I)+j[1]+2763975236&4294967295,N=A+(k<<4&4294967295|k>>>28),k=I+(N^A^T)+j[4]+1272893353&4294967295,I=N+(k<<11&4294967295|k>>>21),k=T+(I^N^A)+j[7]+4139469664&4294967295,T=I+(k<<16&4294967295|k>>>16),k=A+(T^I^N)+j[10]+3200236656&4294967295,A=T+(k<<23&4294967295|k>>>9),k=N+(A^T^I)+j[13]+681279174&4294967295,N=A+(k<<4&4294967295|k>>>28),k=I+(N^A^T)+j[0]+3936430074&4294967295,I=N+(k<<11&4294967295|k>>>21),k=T+(I^N^A)+j[3]+3572445317&4294967295,T=I+(k<<16&4294967295|k>>>16),k=A+(T^I^N)+j[6]+76029189&4294967295,A=T+(k<<23&4294967295|k>>>9),k=N+(A^T^I)+j[9]+3654602809&4294967295,N=A+(k<<4&4294967295|k>>>28),k=I+(N^A^T)+j[12]+3873151461&4294967295,I=N+(k<<11&4294967295|k>>>21),k=T+(I^N^A)+j[15]+530742520&4294967295,T=I+(k<<16&4294967295|k>>>16),k=A+(T^I^N)+j[2]+3299628645&4294967295,A=T+(k<<23&4294967295|k>>>9),k=N+(T^(A|~I))+j[0]+4096336452&4294967295,N=A+(k<<6&4294967295|k>>>26),k=I+(A^(N|~T))+j[7]+1126891415&4294967295,I=N+(k<<10&4294967295|k>>>22),k=T+(N^(I|~A))+j[14]+2878612391&4294967295,T=I+(k<<15&4294967295|k>>>17),k=A+(I^(T|~N))+j[5]+4237533241&4294967295,A=T+(k<<21&4294967295|k>>>11),k=N+(T^(A|~I))+j[12]+1700485571&4294967295,N=A+(k<<6&4294967295|k>>>26),k=I+(A^(N|~T))+j[3]+2399980690&4294967295,I=N+(k<<10&4294967295|k>>>22),k=T+(N^(I|~A))+j[10]+4293915773&4294967295,T=I+(k<<15&4294967295|k>>>17),k=A+(I^(T|~N))+j[1]+2240044497&4294967295,A=T+(k<<21&4294967295|k>>>11),k=N+(T^(A|~I))+j[8]+1873313359&4294967295,N=A+(k<<6&4294967295|k>>>26),k=I+(A^(N|~T))+j[15]+4264355552&4294967295,I=N+(k<<10&4294967295|k>>>22),k=T+(N^(I|~A))+j[6]+2734768916&4294967295,T=I+(k<<15&4294967295|k>>>17),k=A+(I^(T|~N))+j[13]+1309151649&4294967295,A=T+(k<<21&4294967295|k>>>11),k=N+(T^(A|~I))+j[4]+4149444226&4294967295,N=A+(k<<6&4294967295|k>>>26),k=I+(A^(N|~T))+j[11]+3174756917&4294967295,I=N+(k<<10&4294967295|k>>>22),k=T+(N^(I|~A))+j[2]+718787259&4294967295,T=I+(k<<15&4294967295|k>>>17),k=A+(I^(T|~N))+j[9]+3951481745&4294967295,V.g[0]=V.g[0]+N&4294967295,V.g[1]=V.g[1]+(T+(k<<21&4294967295|k>>>11))&4294967295,V.g[2]=V.g[2]+T&4294967295,V.g[3]=V.g[3]+I&4294967295}s.prototype.v=function(V,N){N===void 0&&(N=V.length);const A=N-this.blockSize,j=this.C;let T=this.h,I=0;for(;I<N;){if(T==0)for(;I<=A;)r(this,V,I),I+=this.blockSize;if(typeof V=="string"){for(;I<N;)if(j[T++]=V.charCodeAt(I++),T==this.blockSize){r(this,j),T=0;break}}else for(;I<N;)if(j[T++]=V[I++],T==this.blockSize){r(this,j),T=0;break}}this.h=T,this.o+=N},s.prototype.A=function(){var V=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);V[0]=128;for(var N=1;N<V.length-8;++N)V[N]=0;N=this.o*8;for(var A=V.length-8;A<V.length;++A)V[A]=N&255,N/=256;for(this.v(V),V=Array(16),N=0,A=0;A<4;++A)for(let j=0;j<32;j+=8)V[N++]=this.g[A]>>>j&255;return V};function i(V,N){var A=l;return Object.prototype.hasOwnProperty.call(A,V)?A[V]:A[V]=N(V)}function o(V,N){this.h=N;const A=[];let j=!0;for(let T=V.length-1;T>=0;T--){const I=V[T]|0;j&&I==N||(A[T]=I,j=!1)}this.g=A}var l={};function u(V){return-128<=V&&V<128?i(V,function(N){return new o([N|0],N<0?-1:0)}):new o([V|0],V<0?-1:0)}function m(V){if(isNaN(V)||!isFinite(V))return f;if(V<0)return C(m(-V));const N=[];let A=1;for(let j=0;V>=A;j++)N[j]=V/A|0,A*=4294967296;return new o(N,0)}function d(V,N){if(V.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(V.charAt(0)=="-")return C(d(V.substring(1),N));if(V.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=m(Math.pow(N,8));let j=f;for(let I=0;I<V.length;I+=8){var T=Math.min(8,V.length-I);const k=parseInt(V.substring(I,I+T),N);T<8?(T=m(Math.pow(N,T)),j=j.j(T).add(m(k))):(j=j.j(A),j=j.add(m(k)))}return j}var f=u(0),h=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(v(this))return-C(this).m();let V=0,N=1;for(let A=0;A<this.g.length;A++){const j=this.i(A);V+=(j>=0?j:4294967296+j)*N,N*=4294967296}return V},n.toString=function(V){if(V=V||10,V<2||36<V)throw Error("radix out of range: "+V);if(w(this))return"0";if(v(this))return"-"+C(this).toString(V);const N=m(Math.pow(V,6));var A=this;let j="";for(;;){const T=re(A,N).g;A=B(A,T.j(N));let I=((A.g.length>0?A.g[0]:A.h)>>>0).toString(V);if(A=T,w(A))return I+j;for(;I.length<6;)I="0"+I;j=I+j}},n.i=function(V){return V<0?0:V<this.g.length?this.g[V]:this.h};function w(V){if(V.h!=0)return!1;for(let N=0;N<V.g.length;N++)if(V.g[N]!=0)return!1;return!0}function v(V){return V.h==-1}n.l=function(V){return V=B(this,V),v(V)?-1:w(V)?0:1};function C(V){const N=V.g.length,A=[];for(let j=0;j<N;j++)A[j]=~V.g[j];return new o(A,~V.h).add(h)}n.abs=function(){return v(this)?C(this):this},n.add=function(V){const N=Math.max(this.g.length,V.g.length),A=[];let j=0;for(let T=0;T<=N;T++){let I=j+(this.i(T)&65535)+(V.i(T)&65535),k=(I>>>16)+(this.i(T)>>>16)+(V.i(T)>>>16);j=k>>>16,I&=65535,k&=65535,A[T]=k<<16|I}return new o(A,A[A.length-1]&-2147483648?-1:0)};function B(V,N){return V.add(C(N))}n.j=function(V){if(w(this)||w(V))return f;if(v(this))return v(V)?C(this).j(C(V)):C(C(this).j(V));if(v(V))return C(this.j(C(V)));if(this.l(y)<0&&V.l(y)<0)return m(this.m()*V.m());const N=this.g.length+V.g.length,A=[];for(var j=0;j<2*N;j++)A[j]=0;for(j=0;j<this.g.length;j++)for(let T=0;T<V.g.length;T++){const I=this.i(j)>>>16,k=this.i(j)&65535,_e=V.i(T)>>>16,Fe=V.i(T)&65535;A[2*j+2*T]+=k*Fe,S(A,2*j+2*T),A[2*j+2*T+1]+=I*Fe,S(A,2*j+2*T+1),A[2*j+2*T+1]+=k*_e,S(A,2*j+2*T+1),A[2*j+2*T+2]+=I*_e,S(A,2*j+2*T+2)}for(V=0;V<N;V++)A[V]=A[2*V+1]<<16|A[2*V];for(V=N;V<2*N;V++)A[V]=0;return new o(A,0)};function S(V,N){for(;(V[N]&65535)!=V[N];)V[N+1]+=V[N]>>>16,V[N]&=65535,N++}function F(V,N){this.g=V,this.h=N}function re(V,N){if(w(N))throw Error("division by zero");if(w(V))return new F(f,f);if(v(V))return N=re(C(V),N),new F(C(N.g),C(N.h));if(v(N))return N=re(V,C(N)),new F(C(N.g),N.h);if(V.g.length>30){if(v(V)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var A=h,j=N;j.l(V)<=0;)A=ee(A),j=ee(j);var T=M(A,1),I=M(j,1);for(j=M(j,2),A=M(A,2);!w(j);){var k=I.add(j);k.l(V)<=0&&(T=T.add(A),I=k),j=M(j,1),A=M(A,1)}return N=B(V,T.j(N)),new F(T,N)}for(T=f;V.l(N)>=0;){for(A=Math.max(1,Math.floor(V.m()/N.m())),j=Math.ceil(Math.log(A)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),I=m(A),k=I.j(N);v(k)||k.l(V)>0;)A-=j,I=m(A),k=I.j(N);w(I)&&(I=h),T=T.add(I),V=B(V,k)}return new F(T,V)}n.B=function(V){return re(this,V).h},n.and=function(V){const N=Math.max(this.g.length,V.g.length),A=[];for(let j=0;j<N;j++)A[j]=this.i(j)&V.i(j);return new o(A,this.h&V.h)},n.or=function(V){const N=Math.max(this.g.length,V.g.length),A=[];for(let j=0;j<N;j++)A[j]=this.i(j)|V.i(j);return new o(A,this.h|V.h)},n.xor=function(V){const N=Math.max(this.g.length,V.g.length),A=[];for(let j=0;j<N;j++)A[j]=this.i(j)^V.i(j);return new o(A,this.h^V.h)};function ee(V){const N=V.g.length+1,A=[];for(let j=0;j<N;j++)A[j]=V.i(j)<<1|V.i(j-1)>>>31;return new o(A,V.h)}function M(V,N){const A=N>>5;N%=32;const j=V.g.length-A,T=[];for(let I=0;I<j;I++)T[I]=N>0?V.i(I+A)>>>N|V.i(I+A+1)<<32-N:V.i(I+A);return new o(T,V.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,_y=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Pr=o}).apply(typeof tp<"u"?tp:typeof self<"u"?self:typeof window<"u"?window:{});var ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dy,sa,ky,jl,am,Ey,Vy,Ay;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ml=="object"&&ml];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=t(this);function r(c,p){if(p)e:{var g=s;c=c.split(".");for(var _=0;_<c.length-1;_++){var z=c[_];if(!(z in g))break e;g=g[z]}c=c[c.length-1],_=g[c],p=p(_),p!=_&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],_;for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&g.push([_,p[_]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(_,z,J){for(var ve=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)ve[mt-2]=arguments[mt];return p.prototype[z].apply(_,ve)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let _=0;_<p;_++)g[_]=c[_];return g}return[]}function w(c,p){for(let _=1;_<arguments.length;_++){const z=arguments[_];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=c.length||0;const J=z.length||0;c.length=g+J;for(let ve=0;ve<J;ve++)c[g+ve]=z[ve]}else c.push(z)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function C(c){o.setTimeout(()=>{throw c},0)}function B(){var c=V;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class S{constructor(){this.h=this.g=null}add(p,g){const _=F.get();_.set(p,g),this.h?this.h.next=_:this.g=_,this.h=_}}var F=new v(()=>new re,c=>c.reset());class re{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,M=!1,V=new S,N=()=>{const c=Promise.resolve(void 0);ee=()=>{c.then(A)}};function A(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){C(g)}var p=F;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function _e(c,p){T.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(_e,T),_e.prototype.init=function(c,p){const g=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Fe="closure_listenable_"+(Math.random()*1e6|0),he=0;function Re(c,p,g,_,z){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!_,this.ha=z,this.key=++he,this.da=this.fa=!1}function dt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Ot(c,p,g){for(const _ in c)p.call(g,c[_],_,c)}function Ut(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(c,p){let g,_;for(let z=1;z<arguments.length;z++){_=arguments[z];for(g in _)c[g]=_[g];for(let J=0;J<Oe.length;J++)g=Oe[J],Object.prototype.hasOwnProperty.call(_,g)&&(c[g]=_[g])}}function Le(c){this.src=c,this.g={},this.h=0}Le.prototype.add=function(c,p,g,_,z){const J=c.toString();c=this.g[J],c||(c=this.g[J]=[],this.h++);const ve=bt(c,p,_,z);return ve>-1?(p=c[ve],g||(p.fa=!1)):(p=new Re(p,this.src,J,!!_,z),p.fa=g,c.push(p)),p};function Ke(c,p){const g=p.type;if(g in c.g){var _=c.g[g],z=Array.prototype.indexOf.call(_,p,void 0),J;(J=z>=0)&&Array.prototype.splice.call(_,z,1),J&&(dt(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function bt(c,p,g,_){for(let z=0;z<c.length;++z){const J=c[z];if(!J.da&&J.listener==p&&J.capture==!!g&&J.ha==_)return z}return-1}var it="closure_lm_"+(Math.random()*1e6|0),Vt={};function rt(c,p,g,_,z){if(Array.isArray(p)){for(let J=0;J<p.length;J++)rt(c,p[J],g,_,z);return null}return g=qt(g),c&&c[Fe]?c.J(p,g,l(_)?!!_.capture:!1,z):ut(c,p,g,!1,_,z)}function ut(c,p,g,_,z,J){if(!p)throw Error("Invalid event type");const ve=l(z)?!!z.capture:!!z;let mt=Ge(c);if(mt||(c[it]=mt=new Le(c)),g=mt.add(p,g,_,ve,J),g.proxy)return g;if(_=un(),g.proxy=_,_.src=c,_.listener=g,c.addEventListener)I||(z=ve),z===void 0&&(z=!1),c.addEventListener(p.toString(),_,z);else if(c.attachEvent)c.attachEvent(Be(p.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function un(){function c(g){return p.call(c.src,c.listener,g)}const p=Ie;return c}function K(c,p,g,_,z){if(Array.isArray(p))for(var J=0;J<p.length;J++)K(c,p[J],g,_,z);else _=l(_)?!!_.capture:!!_,g=qt(g),c&&c[Fe]?(c=c.i,J=String(p).toString(),J in c.g&&(p=c.g[J],g=bt(p,g,_,z),g>-1&&(dt(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[J],c.h--)))):c&&(c=Ge(c))&&(p=c.g[p.toString()],c=-1,p&&(c=bt(p,g,_,z)),(g=c>-1?p[c]:null)&&Se(g))}function Se(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Fe])Ke(p.i,c);else{var g=c.type,_=c.proxy;p.removeEventListener?p.removeEventListener(g,_,c.capture):p.detachEvent?p.detachEvent(Be(g),_):p.addListener&&p.removeListener&&p.removeListener(_),(g=Ge(p))?(Ke(g,c),g.h==0&&(g.src=null,p[it]=null)):dt(c)}}}function Be(c){return c in Vt?Vt[c]:Vt[c]="on"+c}function Ie(c,p){if(c.da)c=!0;else{p=new _e(p,this);const g=c.listener,_=c.ha||c.src;c.fa&&Se(c),c=g.call(_,p)}return c}function Ge(c){return c=c[it],c instanceof Le?c:null}var At="__closure_events_fn_"+(Math.random()*1e9>>>0);function qt(c){return typeof c=="function"?c:(c[At]||(c[At]=function(p){return c.handleEvent(p)}),c[At])}function ct(){j.call(this),this.i=new Le(this),this.M=this,this.G=null}f(ct,j),ct.prototype[Fe]=!0,ct.prototype.removeEventListener=function(c,p,g,_){K(this,c,p,g,_)};function P(c,p){var g,_=c.G;if(_)for(g=[];_;_=_.G)g.push(_);if(c=c.M,_=p.type||p,typeof p=="string")p=new T(p,c);else if(p instanceof T)p.target=p.target||c;else{var z=p;p=new T(_,c),me(p,z)}z=!0;let J,ve;if(g)for(ve=g.length-1;ve>=0;ve--)J=p.g=g[ve],z=q(J,_,!0,p)&&z;if(J=p.g=c,z=q(J,_,!0,p)&&z,z=q(J,_,!1,p)&&z,g)for(ve=0;ve<g.length;ve++)J=p.g=g[ve],z=q(J,_,!1,p)&&z}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let _=0;_<g.length;_++)dt(g[_]);delete c.g[p],c.h--}}this.G=null},ct.prototype.J=function(c,p,g,_){return this.i.add(String(c),p,!1,g,_)},ct.prototype.K=function(c,p,g,_){return this.i.add(String(c),p,!0,g,_)};function q(c,p,g,_){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let z=!0;for(let J=0;J<p.length;++J){const ve=p[J];if(ve&&!ve.da&&ve.capture==g){const mt=ve.listener,kn=ve.ha||ve.src;ve.fa&&Ke(c.i,ve),z=mt.call(kn,_)!==!1&&z}}return z&&!_.defaultPrevented}function te(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function be(c){c.g=te(()=>{c.g=null,c.i&&(c.i=!1,be(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ce extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:be(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(c){j.call(this),this.h=c,this.g={}}f(de,j);var we=[];function qe(c){Ot(c.g,function(p,g){this.g.hasOwnProperty(g)&&Se(p)},c),c.g={}}de.prototype.N=function(){de.Z.N.call(this),qe(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Je=o.JSON.stringify,ke=o.JSON.parse,Pn=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function jt(){}function ne(){}var Qe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function O(){T.call(this,"d")}f(O,T);function Ne(){T.call(this,"c")}f(Ne,T);var De={},Pe=null;function ue(){return Pe=Pe||new ct}De.Ia="serverreachability";function xt(c){T.call(this,De.Ia,c)}f(xt,T);function yt(c){const p=ue();P(p,new xt(p))}De.STAT_EVENT="statevent";function Qt(c,p){T.call(this,De.STAT_EVENT,c),this.stat=p}f(Qt,T);function _t(c){const p=ue();P(p,new Qt(p,c))}De.Ja="timingevent";function mn(c,p){T.call(this,De.Ja,c),this.size=p}f(mn,T);function nn(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Cn(){this.g=!0}Cn.prototype.ua=function(){this.g=!1};function ls(c,p,g,_,z,J){c.info(function(){if(c.g)if(J){var ve="",mt=J.split("&");for(let Gt=0;Gt<mt.length;Gt++){var kn=mt[Gt].split("=");if(kn.length>1){const wn=kn[0];kn=kn[1];const Ss=wn.split("_");ve=Ss.length>=2&&Ss[1]=="type"?ve+(wn+"="+kn+"&"):ve+(wn+"=redacted&")}}}else ve=null;else ve=J;return"XMLHTTP REQ ("+_+") [attempt "+z+"]: "+p+`
`+g+`
`+ve})}function Wn(c,p,g,_,z,J,ve){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+z+"]: "+p+`
`+g+`
`+J+" "+ve})}function cs(c,p,g,_){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Is(c,g)+(_?" "+_:"")})}function ei(c,p){c.info(function(){return"TIMEOUT: "+p})}Cn.prototype.info=function(){};function Is(c,p){if(!c.g)return p;if(!p)return null;try{const J=JSON.parse(p);if(J){for(c=0;c<J.length;c++)if(Array.isArray(J[c])){var g=J[c];if(!(g.length<2)){var _=g[1];if(Array.isArray(_)&&!(_.length<1)){var z=_[0];if(z!="noop"&&z!="stop"&&z!="close")for(let ve=1;ve<_.length;ve++)_[ve]=""}}}}return Je(J)}catch{return p}}var Jn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},D={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Q;function R(){}f(R,jt),R.prototype.g=function(){return new XMLHttpRequest},Q=new R;function x(c){return encodeURIComponent(String(c))}function L(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function U(c,p,g,_){this.j=c,this.i=p,this.l=g,this.S=_||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var G={},Z={};function ie(c,p,g){c.M=1,c.A=Ri(Yt(p)),c.u=g,c.R=!0,Ae(c,null)}function Ae(c,p){c.F=Date.now(),$e(c),c.B=Yt(c.A);var g=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),le(g.i,"t",_),c.C=0,g=c.j.L,c.h=new X,c.g=Vf(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ce(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,_=c.ba;var z="readystatechange";Array.isArray(z)||(z&&(we[0]=z.toString()),z=we);for(let J=0;J<z.length;J++){const ve=rt(g,z[J],_||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),yt(),ls(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const p=this.O;p&&gs(c)==3?p.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const mt=gs(this.g),kn=this.g.ya(),Gt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||hf(this.g)))){this.K||mt!=4||kn==7||(kn==8||Gt<=0?yt(3):yt(2)),$t(this);var p=this.g.ca();this.X=p;var g=Ye(this);if(this.o=p==200,Wn(this.i,this.v,this.B,this.l,this.S,mt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var _,z=this.g;if((_=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var J=_;break t}}J=null}if(c=J)cs(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ln(this,c);else{this.o=!1,this.m=3,_t(12),St(this),Rt(this);break e}}if(this.R){c=!0;let wn;for(;!this.K&&this.C<g.length;)if(wn=fe(this,g),wn==Z){mt==4&&(this.m=4,_t(14),c=!1),cs(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==G){this.m=4,_t(15),cs(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else cs(this.i,this.l,wn,null),Ln(this,wn);if(He(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||g.length!=0||this.h.h||(this.m=1,_t(16),c=!1),this.o=this.o&&c,!c)cs(this.i,this.l,g,"[Invalid Chunked Response]"),St(this),Rt(this);else if(g.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),xu(ve),ve.P=!0,_t(11))}}else cs(this.i,this.l,g,null),Ln(this,g);mt==4&&St(this),this.o&&!this.K&&(mt==4?_f(this.j,this):(this.o=!1,$e(this)))}else tx(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,_t(12)):(this.m=0,_t(13)),St(this),Rt(this)}}}catch{}finally{}};function Ye(c){if(!He(c))return c.g.la();const p=hf(c.g);if(p==="")return"";let g="";const _=p.length,z=gs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return St(c),Rt(c),"";c.h.i=new o.TextDecoder}for(let J=0;J<_;J++)c.h.h=!0,g+=c.h.i.decode(p[J],{stream:!(z&&J==_-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function He(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function fe(c,p){var g=c.C,_=p.indexOf(`
`,g);return _==-1?Z:(g=Number(p.substring(g,_)),isNaN(g)?G:(_+=1,_+g>p.length?Z:(p=p.slice(_,_+g),c.C=_+g,p)))}U.prototype.cancel=function(){this.K=!0,St(this)};function $e(c){c.T=Date.now()+c.H,an(c,c.H)}function an(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=nn(m(c.aa,c),p)}function $t(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(ei(this.i,this.B),this.M!=2&&(yt(),_t(17)),St(this),this.m=2,Rt(this)):an(this,this.T-c)};function Rt(c){c.j.I==0||c.K||_f(c.j,c)}function St(c){$t(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,qe(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Ln(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Xe(g.h,c))){if(!c.L&&Xe(g.h,c)&&g.I==3){try{var _=g.Ba.g.parse(p)}catch{_=null}if(Array.isArray(_)&&_.length==3){var z=_;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)il(g),sl(g);else break e;Nu(g),_t(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=nn(m(g.Va,g),6e3));Ve(g.h)<=1&&g.ta&&(g.ta=void 0)}else ti(g,11)}else if((c.L||g.g==c)&&il(g),!k(p))for(z=g.Ba.g.parse(p),p=0;p<z.length;p++){let Gt=z[p];const wn=Gt[0];if(!(wn<=g.K))if(g.K=wn,Gt=Gt[1],g.I==2)if(Gt[0]=="c"){g.M=Gt[1],g.ba=Gt[2];const Ss=Gt[3];Ss!=null&&(g.ka=Ss,g.j.info("VER="+g.ka));const ni=Gt[4];ni!=null&&(g.za=ni,g.j.info("SVER="+g.za));const fr=Gt[5];fr!=null&&typeof fr=="number"&&fr>0&&(_=1.5*fr,g.O=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const pr=c.g;if(pr){const al=pr.g?pr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(al){var J=_.h;J.g||al.indexOf("spdy")==-1&&al.indexOf("quic")==-1&&al.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ze(J,J.h),J.h=null))}if(_.G){const vu=pr.g?pr.g.getResponseHeader("X-HTTP-Session-Id"):null;vu&&(_.wa=vu,gt(_.J,_.G,vu))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),_=g;var ve=c;if(_.na=Ef(_,_.L?_.ba:null,_.W),ve.L){et(_.h,ve);var mt=ve,kn=_.O;kn&&(mt.H=kn),mt.D&&($t(mt),$e(mt)),_.g=ve}else xf(_);g.i.length>0&&rl(g)}else Gt[0]!="stop"&&Gt[0]!="close"||ti(g,7);else g.I==3&&(Gt[0]=="stop"||Gt[0]=="close"?Gt[0]=="stop"?ti(g,7):bu(g):Gt[0]!="noop"&&g.l&&g.l.qa(Gt),g.A=0)}}yt(4)}catch{}}var Un=class{constructor(c,p){this.g=c,this.map=p}};function zt(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ze(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ve(c){return c.h?1:c.g?c.g.size:0}function Xe(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Ze(c,p){c.g?c.g.add(p):c.h=p}function et(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}zt.prototype.cancel=function(){if(this.i=Me(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Me(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var tt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ct(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const _=c[g].indexOf("=");let z,J=null;_>=0?(z=c[g].substring(0,_),J=c[g].substring(_+1)):z=c[g],p(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function sn(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof sn?(this.l=c.l,ps(this,c.j),this.o=c.o,this.g=c.g,cr(this,c.u),this.h=c.h,Lo(this,ye(c.i)),this.m=c.m):c&&(p=String(c).match(tt))?(this.l=!1,ps(this,p[1]||"",!0),this.o=ur(p[2]||""),this.g=ur(p[3]||"",!0),cr(this,p[4]),this.h=ur(p[5]||"",!0),Lo(this,p[6]||"",!0),this.m=ur(p[7]||"")):(this.l=!1,this.i=new dr(null,this.l))}sn.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(mr(p,jo,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(mr(p,jo,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(mr(g,g.charAt(0)=="/"?pu:nl,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",mr(g,gu)),c.join("")},sn.prototype.resolve=function(c){const p=Yt(this);let g=!!c.j;g?ps(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var _=c.h;if(g)cr(p,c.u);else if(g=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var z=p.h.lastIndexOf("/");z!=-1&&(_=p.h.slice(0,z+1)+_)}if(z=_,z==".."||z==".")_="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){_=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let ve=0;ve<z.length;){const mt=z[ve++];mt=="."?_&&ve==z.length&&J.push(""):mt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&ve==z.length&&J.push("")):(J.push(mt),_=!0)}_=J.join("/")}else _=z}return g?p.h=_:g=c.i.toString()!=="",g?Lo(p,ye(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Yt(c){return new sn(c)}function ps(c,p,g){c.j=g?ur(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function cr(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Lo(c,p,g){p instanceof dr?(c.i=p,at(c.i,c.l)):(g||(p=mr(p,hu)),c.i=new dr(p,c.l))}function gt(c,p,g){c.i.set(p,g)}function Ri(c){return gt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function ur(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function mr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,tl),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function tl(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var jo=/[#\/\?@]/g,nl=/[#\?:]/g,pu=/[#\?]/g,hu=/[#\?@]/g,gu=/#/g;function dr(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&Ct(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=dr.prototype,n.add=function(c,p){b(this),this.i=null,c=ge(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function H(c,p){b(c),p=ge(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y(c,p){return b(c),p=ge(c,p),c.g.has(p)}n.forEach=function(c,p){b(this),this.g.forEach(function(g,_){g.forEach(function(z){c.call(p,z,_,this)},this)},this)};function W(c,p){b(c);let g=[];if(typeof p=="string")Y(c,p)&&(g=g.concat(c.g.get(ge(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}n.set=function(c,p){return b(this),this.i=null,c=ge(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},n.get=function(c,p){return c?(c=W(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){H(c,p),g.length>0&&(c.i=null,c.g.set(ge(c,p),y(g)),c.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let _=0;_<p.length;_++){var g=p[_];const z=x(g);g=W(this,g);for(let J=0;J<g.length;J++){let ve=z;g[J]!==""&&(ve+="="+x(g[J])),c.push(ve)}}return this.i=c.join("&")};function ye(c){const p=new dr;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ge(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function at(c,p){p&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,_){const z=_.toLowerCase();_!=z&&(H(this,_),le(this,z,g))},c)),c.j=p}function ft(c,p){const g=new Cn;if(o.Image){const _=new Image;_.onload=d(wt,g,"TestLoadImage: loaded",!0,p,_),_.onerror=d(wt,g,"TestLoadImage: error",!1,p,_),_.onabort=d(wt,g,"TestLoadImage: abort",!1,p,_),_.ontimeout=d(wt,g,"TestLoadImage: timeout",!1,p,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else p(!1)}function fn(c,p){const g=new Cn,_=new AbortController,z=setTimeout(()=>{_.abort(),wt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:_.signal}).then(J=>{clearTimeout(z),J.ok?wt(g,"TestPingServer: ok",!0,p):wt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(z),wt(g,"TestPingServer: error",!1,p)})}function wt(c,p,g,_,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),_(g)}catch{}}function It(){this.g=new Pn}function rn(c){this.i=c.Sb||null,this.h=c.ab||!1}f(rn,jt),rn.prototype.g=function(){return new Dn(this.i,this.h)};function Dn(c,p){ct.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Dn,ct),n=Dn.prototype,n.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,dn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Jt(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,dn(this)),this.g&&(this.readyState=3,dn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Dt(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Dt(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Jt(this):dn(this),this.readyState==3&&Dt(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,Jt(this))},n.Na=function(c){this.g&&(this.response=c,Jt(this))},n.ga=function(){this.g&&Jt(this)};function Jt(c){c.readyState=4,c.l=null,c.j=null,c.B=null,dn(c)}n.setRequestHeader=function(c,p){this.A.append(c,p)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function dn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Dn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Wt(c){let p="";return Ot(c,function(g,_){p+=_,p+=":",p+=g,p+=`\r
`}),p}function Kt(c,p,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Wt(g),typeof c=="string"?g!=null&&x(g):gt(c,p,g))}function pt(c){ct.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(pt,ct);var Xt=/^https?$/i,hs=["POST","PUT"];n=pt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,p,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Q.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(J){Ts(this,J);return}if(c=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var z in _)g.set(z,_[z]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())g.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(hs,p,void 0)>=0)||_||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ve]of g)this.g.setRequestHeader(J,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(J){Ts(this,J)}};function Ts(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Bi(c),Ui(c)}function Bi(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),Ui(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ui(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?yu(this):this.Xa())},n.Xa=function(){yu(this)};function yu(c){if(c.h&&typeof i<"u"){if(c.v&&gs(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),gs(c)==4){c.h=!1;try{const J=c.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var _;if(_=J===0){let ve=String(c.D).match(tt)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),_=!Xt.test(ve?ve.toLowerCase():"")}g=_}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var z=gs(c)>2?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.ca()+"]",Bi(c)}}finally{Ui(c)}}}}function Ui(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||P(c,"ready");try{g.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gs(c){return c.g?c.g.readyState:0}n.ca=function(){try{return gs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),ke(p)}};function hf(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function tx(c){const p={};c=(c.g&&gs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var g=L(c[_]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=p[z]||[];p[z]=J,J.push(g)}Ut(p,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ro(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function gf(c){this.za=0,this.i=[],this.j=new Cn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ro("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ro("baseRetryDelayMs",5e3,c),this.Za=Ro("retryDelaySeedMs",1e4,c),this.Ta=Ro("forwardChannelMaxRetries",2,c),this.va=Ro("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new zt(c&&c.concurrentRequestLimit),this.Ba=new It,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=gf.prototype,n.ka=8,n.I=1,n.connect=function(c,p,g,_){_t(0),this.W=c,this.H=p||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.J=Ef(this,null,this.W),rl(this)};function bu(c){if(yf(c),c.I==3){var p=c.V++,g=Yt(c.J);if(gt(g,"SID",c.M),gt(g,"RID",p),gt(g,"TYPE","terminate"),Bo(c,g),p=new U(c,c.j,p),p.M=2,p.A=Ri(Yt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Vf(p.j,null),p.g.ea(p.A)),p.F=Date.now(),$e(p)}kf(c)}function sl(c){c.g&&(xu(c),c.g.cancel(),c.g=null)}function yf(c){sl(c),c.v&&(o.clearTimeout(c.v),c.v=null),il(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function rl(c){if(!ze(c.h)&&!c.m){c.m=!0;var p=c.Ea;ee||N(),M||(ee(),M=!0),V.add(p,c),c.D=0}}function nx(c,p){return Ve(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=nn(m(c.Ea,c,p),Df(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const z=new U(this,this.j,c);let J=this.o;if(this.U&&(J?(J=ae(J),me(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(p+=_,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Nf(this,z,p),g=Yt(this.J),gt(g,"RID",c),gt(g,"CVER",22),this.G&&gt(g,"X-HTTP-Session-Id",this.G),Bo(this,g),J&&(this.R?p="headers="+x(Wt(J))+"&"+p:this.u&&Kt(g,this.u,J)),Ze(this.h,z),this.Ra&&gt(g,"TYPE","init"),this.S?(gt(g,"$req",p),gt(g,"SID","null"),z.U=!0,ie(z,g,null)):ie(z,g,p),this.I=2}}else this.I==3&&(c?bf(this,c):this.i.length==0||ze(this.h)||bf(this))};function bf(c,p){var g;p?g=p.l:g=c.V++;const _=Yt(c.J);gt(_,"SID",c.M),gt(_,"RID",g),gt(_,"AID",c.K),Bo(c,_),c.u&&c.o&&Kt(_,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=Nf(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Ze(c.h,g),ie(g,_,p)}function Bo(c,p){c.H&&Ot(c.H,function(g,_){gt(p,_,g)}),c.l&&Ot({},function(g,_){gt(p,_,g)})}function Nf(c,p,g){g=Math.min(c.i.length,g);const _=c.l?m(c.l.Ka,c.l,c):null;e:{var z=c.i;let mt=-1;for(;;){const kn=["count="+g];mt==-1?g>0?(mt=z[0].g,kn.push("ofs="+mt)):mt=0:kn.push("ofs="+mt);let Gt=!0;for(let wn=0;wn<g;wn++){var J=z[wn].g;const Ss=z[wn].map;if(J-=mt,J<0)mt=Math.max(0,z[wn].g-100),Gt=!1;else try{J="req"+J+"_"||"";try{var ve=Ss instanceof Map?Ss:Object.entries(Ss);for(const[ni,fr]of ve){let pr=fr;l(fr)&&(pr=Je(fr)),kn.push(J+ni+"="+encodeURIComponent(pr))}}catch(ni){throw kn.push(J+"type="+encodeURIComponent("_badmap")),ni}}catch{_&&_(Ss)}}if(Gt){ve=kn.join("&");break e}}ve=void 0}return c=c.i.splice(0,g),p.G=c,ve}function xf(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;ee||N(),M||(ee(),M=!0),V.add(p,c),c.A=0}}function Nu(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=nn(m(c.Da,c),Df(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,vf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=nn(m(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,_t(10),sl(this),vf(this))};function xu(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function vf(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Yt(c.na);gt(p,"RID","rpc"),gt(p,"SID",c.M),gt(p,"AID",c.K),gt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&gt(p,"TO",c.ia),gt(p,"TYPE","xmlhttp"),Bo(c,p),c.u&&c.o&&Kt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Ri(Yt(p)),g.u=null,g.R=!0,Ae(g,c)}n.Va=function(){this.C!=null&&(this.C=null,sl(this),Nu(this),_t(19))};function il(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function _f(c,p){var g=null;if(c.g==p){il(c),xu(c),c.g=null;var _=2}else if(Xe(c.h,p))g=p.G,et(c.h,p),_=1;else return;if(c.I!=0){if(p.o)if(_==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var z=c.D;_=ue(),P(_,new mn(_,g)),rl(c)}else xf(c);else if(z=p.m,z==3||z==0&&p.X>0||!(_==1&&nx(c,p)||_==2&&Nu(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),z){case 1:ti(c,5);break;case 4:ti(c,10);break;case 3:ti(c,6);break;default:ti(c,2)}}}function Df(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function ti(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),_=c.Ua;const z=!_;_=new sn(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ps(_,"https"),Ri(_),z?ft(_.toString(),g):fn(_.toString(),g)}else _t(2);c.I=0,c.l&&c.l.pa(p),kf(c),yf(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function kf(c){if(c.I=0,c.ja=[],c.l){const p=Me(c.h);(p.length!=0||c.i.length!=0)&&(w(c.ja,p),w(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function Ef(c,p,g){var _=g instanceof sn?Yt(g):new sn(g);if(_.g!="")p&&(_.g=p+"."+_.g),cr(_,_.u);else{var z=o.location;_=z.protocol,p=p?p+"."+z.hostname:z.hostname,z=+z.port;const J=new sn(null);_&&ps(J,_),p&&(J.g=p),z&&cr(J,z),g&&(J.h=g),_=J}return g=c.G,p=c.wa,g&&p&&gt(_,g,p),gt(_,"VER",c.ka),Bo(c,_),_}function Vf(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new pt(new rn({ab:g})):new pt(c.ma),p.Fa(c.L),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Af(){}n=Af.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ol(){}ol.prototype.g=function(c,p){return new ss(c,p)};function ss(c,p){ct.call(this),this.g=new gf(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Hi(this)}f(ss,ct),ss.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ss.prototype.close=function(){bu(this.g)},ss.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Je(c),c=g);p.i.push(new Un(p.Ya++,c)),p.I==3&&rl(p)},ss.prototype.N=function(){this.g.l=null,delete this.j,bu(this.g),delete this.g,ss.Z.N.call(this)};function Cf(c){O.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Cf,O);function wf(){Ne.call(this),this.status=1}f(wf,Ne);function Hi(c){this.g=c}f(Hi,Af),Hi.prototype.ra=function(){P(this.g,"a")},Hi.prototype.qa=function(c){P(this.g,new Cf(c))},Hi.prototype.pa=function(c){P(this.g,new wf)},Hi.prototype.oa=function(){P(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,ss.prototype.send=ss.prototype.o,ss.prototype.open=ss.prototype.m,ss.prototype.close=ss.prototype.close,Ay=function(){return new ol},Vy=function(){return ue()},Ey=De,am={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Jn.NO_ERROR=0,Jn.TIMEOUT=8,Jn.HTTP_ERROR=6,jl=Jn,D.COMPLETE="complete",ky=D,ne.EventType=Qe,Qe.OPEN="a",Qe.CLOSE="b",Qe.ERROR="c",Qe.MESSAGE="d",ct.prototype.listen=ct.prototype.J,sa=ne,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Dy=pt}).apply(typeof ml<"u"?ml:typeof self<"u"?self:typeof window<"u"?window:{});const np="@firebase/firestore",sp="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jn.UNAUTHENTICATED=new jn(null),jn.GOOGLE_CREDENTIALS=new jn("google-credentials-uid"),jn.FIRST_PARTY=new jn("first-party-uid"),jn.MOCK_USER=new jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eo="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=new dy("@firebase/firestore");function Yi(){return vi.logLevel}function pe(n,...e){if(vi.logLevel<=Et.DEBUG){const t=e.map(rd);vi.debug(`Firestore (${Eo}): ${n}`,...t)}}function Gn(n,...e){if(vi.logLevel<=Et.ERROR){const t=e.map(rd);vi.error(`Firestore (${Eo}): ${n}`,...t)}}function _i(n,...e){if(vi.logLevel<=Et.WARN){const t=e.map(rd);vi.warn(`Firestore (${Eo}): ${n}`,...t)}}function rd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,Cy(n,s,t)}function Cy(n,e,t){let s=`FIRESTORE (${Eo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Gn(s),new Error(s)}function Ue(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||Cy(e,r,s)}function st(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xe extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(jn.UNAUTHENTICATED))}shutdown(){}}class Mk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Fk{constructor(e){this.t=e,this.currentUser=jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ue(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,t(u)):Promise.resolve();let i=new Hs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Hs,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Hs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ue(typeof s.accessToken=="string",31837,{l:s}),new wy(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string",2055,{h:e}),new jn(e)}}class Ok{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=jn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qk{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Ok(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $k{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gy(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ue(this.o===void 0,3512);const s=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rp(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ue(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new rp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=zk(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function nt(n,e){return n<e?-1:n>e?1:0}function lm(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return Su(r)===Su(i)?nt(r,i):Su(r)?1:-1}return nt(n.length,e.length)}const Wk=55296,Kk=57343;function Su(n){const e=n.charCodeAt(0);return e>=Wk&&e<=Kk}function co(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function Iy(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="__name__";class Ls{constructor(e,t,s){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Te(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Ls.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return nt(e.length,t.length)}static compareSegments(e,t){const s=Ls.isNumericId(e),r=Ls.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Ls.extractNumericId(e).compare(Ls.extractNumericId(t)):lm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pr.fromString(e.substring(4,e.length-2))}}class Pt extends Ls{construct(e,t,s){return new Pt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new xe(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new Pt(t)}static emptyPath(){return new Pt([])}}const Gk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class on extends Ls{construct(e,t,s){return new on(e,t,s)}static isValidIdentifier(e){return Gk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),on.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ip}static keyField(){return new on([ip])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new xe(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new xe(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new xe(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new xe(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new on(t)}static emptyPath(){return new on([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Pt.fromString(e))}static fromName(e){return new Ee(Pt.fromString(e).popFirst(5))}static empty(){return new Ee(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(n,e,t){if(!t)throw new xe(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qk(n,e,t,s){if(e===!0&&s===!0)throw new xe(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function op(n){if(!Ee.isDocumentKey(n))throw new xe(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ap(n){if(Ee.isDocumentKey(n))throw new xe(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Sy(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Sc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Te(12329,{type:typeof n})}function Yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new xe(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Sc(n);throw new xe(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(n,e){const t={typeString:n};return e&&(t.value=e),t}function qa(n,e){if(!Sy(n))throw new xe(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new xe(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp=-62135596800,cp=1e6;class Lt{static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*cp);return new Lt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xe(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xe(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lp)throw new xe(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xe(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cp}_compareTo(e){return this.seconds===e.seconds?nt(this.nanoseconds,e.nanoseconds):nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qa(e,Lt._jsonSchema))return new Lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Lt._jsonSchemaVersion="firestore/timestamp/1.0",Lt._jsonSchema={type:xn("string",Lt._jsonSchemaVersion),seconds:xn("number"),nanoseconds:xn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{static fromTimestamp(e){return new We(e)}static min(){return new We(new Lt(0,0))}static max(){return new We(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=-1;class nc{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function cm(n){return n.fields.find(e=>e.kind===2)}function oi(n){return n.fields.filter(e=>e.kind!==2)}nc.UNKNOWN_ID=-1;class Rl{constructor(e,t){this.fieldPath=e,this.kind=t}}class Aa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Aa(0,as.min())}}function Yk(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=We.fromTimestamp(s===1e9?new Lt(t+1,0):new Lt(t,s));return new as(r,Ee.empty(),e)}function Py(n){return new as(n.readTime,n.key,Va)}class as{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new as(We.min(),Ee.empty(),Va)}static max(){return new as(We.max(),Ee.empty(),Va)}}function od(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:nt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ii(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==Ly)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$.reject(t)}static resolve(e){return new $((t,s)=>{t(e)})}static reject(e){return new $((t,s)=>{s(e)})}static waitFor(e){return new $((t,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>s(u))}),o=!0,i===r&&t()})}static or(e){let t=$.resolve(!1);for(const s of e)t=t.next(r=>r?$.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&s(o)},d=>r(d))}})}static doWhile(e,t){return new $((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="SimpleDb";class Pc{static open(e,t,s,r){try{return new Pc(t,e.transaction(r,s))}catch(i){throw new ma(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Hs,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ma(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=ad(s.target.error);this.S.reject(new ma(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(rs,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Jk(t)}}class Lr{static delete(e){return pe(rs,"Removing database:",e),li(ty().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!uy())return!1;if(Lr.F())return!0;const e=Zl(),t=Lr.M(e),s=0<t&&t<10,r=Ry(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,Lr.M(Zl())===12.2&&Gn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(rs,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new ma(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new xe(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new xe(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new ma(e,o))},r.onupgradeneeded=i=>{pe(rs,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next(()=>{pe(rs,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Pc.open(this.db,e,i?"readonly":"readwrite",s),u=r(l).next(m=>(l.C(),m)).catch(m=>(l.abort(m),$.reject(m))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,m=u.name!=="FirebaseError"&&o<3;if(pe(rs,"Transaction failed with error:",u.message,"Retrying:",m),this.close(),!m)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ry(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Xk{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return li(this.U.delete())}}class ma extends xe{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function zr(n){return n.name==="IndexedDbTransactionError"}class Jk{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(pe(rs,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(pe(rs,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),li(s)}add(e){return pe(rs,"ADD",this.store.name,e,e),li(this.store.add(e))}get(e){return li(this.store.get(e)).next(t=>(t===void 0&&(t=null),pe(rs,"GET",this.store.name,e,t),t))}delete(e){return pe(rs,"DELETE",this.store.name,e),li(this.store.delete(e))}count(){return pe(rs,"COUNT",this.store.name),li(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(s),o=[];return this.H(i,(l,u)=>{o.push(u)}).next(()=>o)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Z(e,t){pe(rs,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,l)=>l.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new $((s,r)=>{t.onerror=i=>{const o=ad(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}H(e,t){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new Xk(l),m=t(l.primaryKey,l.value,u);if(m instanceof $){const d=m.catch(f=>(u.done(),$.reject(f)));s.push(d)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}}).next(()=>$.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function li(n){return new $((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=ad(s.target.error);t(r)}})}let up=!1;function ad(n){const e=Lr.M(Zl());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new xe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return up||(up=!0,setTimeout(()=>{throw s},0)),s}}return n}const da="IndexBackfiller";class Zk{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(da,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();pe(da,`Documents written: ${t}`)}catch(t){zr(t)?pe(da,"Ignoring IndexedDB error during index backfill: ",t):await Ii(t)}await this.re(6e4)})}}class eE{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let r=t,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return pe(da,`Processing collection: ${o}`),this.oe(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>t-r)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(r,i)).next(l=>(pe(da,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}_e(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=Py(i);od(o,s)>0&&(s=o)}),new as(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ds.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi=-1;function Lc(n){return n==null}function Ca(n){return n===0&&1/n==-1/0}function tE(n){return typeof n=="number"&&Number.isInteger(n)&&!Ca(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc="";function $n(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=mp(e)),e=nE(n.get(t),e);return mp(e)}function nE(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case sc:t+="";break;default:t+=i}}return t}function mp(n){return n+sc+""}function Bs(n){const e=n.length;if(Ue(e>=2,64408,{path:n}),e===2)return Ue(n.charAt(0)===sc&&n.charAt(1)==="",56145,{path:n}),Pt.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf(sc,i);switch((o<0||o>t)&&Te(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),s.push(u);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:Te(61167,{path:n})}i=o+2}return new Pt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="remoteDocuments",$a="owner",Mi="owner",wa="mutationQueues",sE="userId",bs="mutations",dp="batchId",di="userMutationsIndex",fp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n,e){return[n,$n(e)]}function By(n,e,t){return[n,$n(e),t]}const rE={},uo="documentMutations",rc="remoteDocumentsV14",iE=["prefixPath","collectionGroup","readTime","documentId"],Ul="documentKeyIndex",oE=["prefixPath","collectionGroup","documentId"],Uy="collectionGroupIndex",aE=["collectionGroup","readTime","prefixPath","documentId"],Ia="remoteDocumentGlobal",um="remoteDocumentGlobalKey",mo="targets",Hy="queryTargetsIndex",lE=["canonicalId","targetId"],fo="targetDocuments",cE=["targetId","path"],ld="documentTargetsIndex",uE=["path","targetId"],ic="targetGlobalKey",hi="targetGlobal",Ta="collectionParents",mE=["collectionId","parent"],po="clientMetadata",dE="clientId",jc="bundles",fE="bundleId",Rc="namedQueries",pE="name",cd="indexConfiguration",hE="indexId",mm="collectionGroupIndex",gE="collectionGroup",fa="indexState",yE=["indexId","uid"],My="sequenceNumberIndex",bE=["uid","sequenceNumber"],pa="indexEntries",NE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fy="documentKeyIndex",xE=["indexId","uid","orderedDocumentKey"],Bc="documentOverlays",vE=["userId","collectionPath","documentId"],dm="collectionPathOverlayIndex",_E=["userId","collectionPath","largestBatchId"],Oy="collectionGroupOverlayIndex",DE=["userId","collectionGroup","largestBatchId"],ud="globals",kE="name",qy=[wa,bs,uo,ai,mo,$a,hi,fo,po,Ia,Ta,jc,Rc],EE=[...qy,Bc],$y=[wa,bs,uo,rc,mo,$a,hi,fo,po,Ia,Ta,jc,Rc,Bc],zy=$y,md=[...zy,cd,fa,pa],VE=md,Wy=[...md,ud],AE=Wy;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm extends jy{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function An(n,e){const t=st(n);return Lr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Ky(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this.comparator=e,this.root=t||Rn.EMPTY}insert(e,t){return new tn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rn.BLACK,null,null))}remove(e){return new tn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dl(this.root,e,this.comparator,!1)}getReverseIterator(){return new dl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dl(this.root,e,this.comparator,!0)}}class dl{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rn{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Rn.RED,this.left=r??Rn.EMPTY,this.right=i??Rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Rn(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Rn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Rn.EMPTY=null,Rn.RED=!0,Rn.BLACK=!1;Rn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new Rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hp(this.data.getIterator())}getIteratorFrom(e){return new hp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ft(this.comparator);return t.data=e,t}}class hp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.fields=e,e.sort(on.comparator)}static empty(){return new ns([])}unionWith(e){let t=new Ft(on.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new ns(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return co(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Gy("Invalid base64 string: "+i):i}}(e);return new _n(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new _n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const CE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sr(n){if(Ue(!!n,39018),typeof n=="string"){let e=0;const t=CE.exec(n);if(Ue(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:en(n.seconds),nanos:en(n.nanos)}}function en(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function rr(n){return typeof n=="string"?_n.fromBase64String(n):_n.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy="server_timestamp",Yy="__type__",Xy="__previous_value__",Jy="__local_write_time__";function dd(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Yy])==null?void 0:s.stringValue)===Qy}function Uc(n){const e=n.mapValue.fields[Xy];return dd(e)?Uc(e):e}function Sa(n){const e=sr(n.mapValue.fields[Jy].timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,t,s,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const oc="(default)";class Di{constructor(e,t){this.projectId=e,this.database=t||oc}static empty(){return new Di("","")}get isDefaultDatabase(){return this.database===oc}isEqual(e){return e instanceof Di&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd="__type__",Zy="__max__",Cr={mapValue:{fields:{__type__:{stringValue:Zy}}}},pd="__vector__",ho="value",Hl={nullValue:"NULL_VALUE"};function Br(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dd(n)?4:eb(n)?9007199254740991:Hc(n)?10:11:Te(28295,{value:n})}function qs(n,e){if(n===e)return!0;const t=Br(n);if(t!==Br(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sa(n).isEqual(Sa(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=sr(r.timestampValue),l=sr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return rr(r.bytesValue).isEqual(rr(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return en(r.geoPointValue.latitude)===en(i.geoPointValue.latitude)&&en(r.geoPointValue.longitude)===en(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return en(r.integerValue)===en(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=en(r.doubleValue),l=en(i.doubleValue);return o===l?Ca(o)===Ca(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return co(n.arrayValue.values||[],e.arrayValue.values||[],qs);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(pp(o)!==pp(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!qs(o[u],l[u])))return!1;return!0}(n,e);default:return Te(52216,{left:n})}}function Pa(n,e){return(n.values||[]).find(t=>qs(t,e))!==void 0}function Ur(n,e){if(n===e)return 0;const t=Br(n),s=Br(e);if(t!==s)return nt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return nt(n.booleanValue,e.booleanValue);case 2:return function(i,o){const l=en(i.integerValue||i.doubleValue),u=en(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(n,e);case 3:return gp(n.timestampValue,e.timestampValue);case 4:return gp(Sa(n),Sa(e));case 5:return lm(n.stringValue,e.stringValue);case 6:return function(i,o){const l=rr(i),u=rr(o);return l.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=nt(l[m],u[m]);if(d!==0)return d}return nt(l.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const l=nt(en(i.latitude),en(o.latitude));return l!==0?l:nt(en(i.longitude),en(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return yp(n.arrayValue,e.arrayValue);case 10:return function(i,o){var h,y,w,v;const l=i.fields||{},u=o.fields||{},m=(h=l[ho])==null?void 0:h.arrayValue,d=(y=u[ho])==null?void 0:y.arrayValue,f=nt(((w=m==null?void 0:m.values)==null?void 0:w.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:yp(m,d)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Cr.mapValue&&o===Cr.mapValue)return 0;if(i===Cr.mapValue)return 1;if(o===Cr.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=lm(u[f],d[f]);if(h!==0)return h;const y=Ur(l[u[f]],m[d[f]]);if(y!==0)return y}return nt(u.length,d.length)}(n.mapValue,e.mapValue);default:throw Te(23264,{he:t})}}function gp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return nt(n,e);const t=sr(n),s=sr(e),r=nt(t.seconds,s.seconds);return r!==0?r:nt(t.nanos,s.nanos)}function yp(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Ur(t[r],s[r]);if(i)return i}return nt(t.length,s.length)}function go(n){return pm(n)}function pm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=sr(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return rr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ee.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=pm(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${pm(t.fields[o])}`;return r+"}"}(n.mapValue):Te(61005,{value:n})}function Ml(n){switch(Br(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Uc(n);return e?16+Ml(e):16;case 5:return 2*n.stringValue.length;case 6:return rr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+Ml(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return Wr(s.fields,(i,o)=>{r+=i.length+Ml(o)}),r}(n.mapValue);default:throw Te(13486,{value:n})}}function La(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function hm(n){return!!n&&"integerValue"in n}function ja(n){return!!n&&"arrayValue"in n}function bp(n){return!!n&&"nullValue"in n}function Np(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fl(n){return!!n&&"mapValue"in n}function Hc(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[fd])==null?void 0:s.stringValue)===pd}function ha(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Wr(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=ha(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ha(n.arrayValue.values[t]);return e}return{...n}}function eb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Zy}const tb={mapValue:{fields:{[fd]:{stringValue:pd},[ho]:{arrayValue:{}}}}};function IE(n){return"nullValue"in n?Hl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?La(Di.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Hc(n)?tb:{mapValue:{}}:Te(35942,{value:n})}function TE(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?La(Di.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?tb:"mapValue"in n?Hc(n)?{mapValue:{}}:Cr:Te(61959,{value:n})}function xp(n,e){const t=Ur(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function vp(n,e){const t=Ur(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.value=e}static empty(){return new On({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Fl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ha(t)}setAll(e){let t=on.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=ha(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());Fl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Fl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Wr(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new On(ha(this.value))}}function nb(n){const e=[];return Wr(n.fields,(t,s)=>{const r=new on([t]);if(Fl(s)){const i=nb(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new ns(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ln(e,0,We.min(),We.min(),We.min(),On.empty(),0)}static newFoundDocument(e,t,s,r){return new ln(e,1,t,We.min(),s,r,0)}static newNoDocument(e,t){return new ln(e,2,t,We.min(),We.min(),On.empty(),0)}static newUnknownDocument(e,t){return new ln(e,3,t,We.min(),We.min(),On.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t){this.position=e,this.inclusive=t}}function _p(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=Ee.comparator(Ee.fromName(o.referenceValue),t.key):s=Ur(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Dp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t="asc"){this.field=e,this.dir=t}}function SE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{}class Nt extends sb{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new PE(e,t,s):t==="array-contains"?new RE(e,s):t==="in"?new cb(e,s):t==="not-in"?new BE(e,s):t==="array-contains-any"?new UE(e,s):new Nt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new LE(e,s):new jE(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ur(t,this.value)):t!==null&&Br(this.value)===Br(t)&&this.matchesComparison(Ur(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Mt extends sb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Mt(e,t)}matches(e){return bo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bo(n){return n.op==="and"}function gm(n){return n.op==="or"}function hd(n){return rb(n)&&bo(n)}function rb(n){for(const e of n.filters)if(e instanceof Mt)return!1;return!0}function ym(n){if(n instanceof Nt)return n.field.canonicalString()+n.op.toString()+go(n.value);if(hd(n))return n.filters.map(e=>ym(e)).join(",");{const e=n.filters.map(t=>ym(t)).join(",");return`${n.op}(${e})`}}function ib(n,e){return n instanceof Nt?function(s,r){return r instanceof Nt&&s.op===r.op&&s.field.isEqual(r.field)&&qs(s.value,r.value)}(n,e):n instanceof Mt?function(s,r){return r instanceof Mt&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&ib(o,r.filters[l]),!0):!1}(n,e):void Te(19439)}function ob(n,e){const t=n.filters.concat(e);return Mt.create(t,n.op)}function ab(n){return n instanceof Nt?function(t){return`${t.field.canonicalString()} ${t.op} ${go(t.value)}`}(n):n instanceof Mt?function(t){return t.op.toString()+" {"+t.getFilters().map(ab).join(" ,")+"}"}(n):"Filter"}class PE extends Nt{constructor(e,t,s){super(e,t,s),this.key=Ee.fromName(s.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class LE extends Nt{constructor(e,t){super(e,"in",t),this.keys=lb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jE extends Nt{constructor(e,t){super(e,"not-in",t),this.keys=lb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function lb(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(s=>Ee.fromName(s.referenceValue))}class RE extends Nt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ja(t)&&Pa(t.arrayValue,this.value)}}class cb extends Nt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Pa(this.value.arrayValue,t)}}class BE extends Nt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Pa(this.value.arrayValue,t)}}class UE extends Nt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ja(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Pa(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function bm(n,e=null,t=[],s=[],r=null,i=null,o=null){return new HE(n,e,t,s,r,i,o)}function ki(n){const e=st(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>ym(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Lc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>go(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>go(s)).join(",")),e.Te=t}return e.Te}function za(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!SE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ib(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Dp(n.startAt,e.startAt)&&Dp(n.endAt,e.endAt)}function ac(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function lc(n,e){return n.filters.filter(t=>t instanceof Nt&&t.field.isEqual(e))}function kp(n,e,t){let s=Hl,r=!0;for(const i of lc(n,e)){let o=Hl,l=!0;switch(i.op){case"<":case"<=":o=IE(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Hl}xp({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];xp({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function Ep(n,e,t){let s=Cr,r=!0;for(const i of lc(n,e)){let o=Cr,l=!0;switch(i.op){case">=":case">":o=TE(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Cr}vp({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];vp({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ME(n,e,t,s,r,i,o,l){return new Vo(n,e,t,s,r,i,o,l)}function Wa(n){return new Vo(n)}function Vp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ub(n){return n.collectionGroup!==null}function ga(n){const e=st(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ft(on.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ra(i,s))}),t.has(on.keyField().canonicalString())||e.Ie.push(new Ra(on.keyField(),s))}return e.Ie}function fs(n){const e=st(n);return e.Ee||(e.Ee=FE(e,ga(n))),e.Ee}function FE(n,e){if(n.limitType==="F")return bm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Ra(r.field,i)});const t=n.endAt?new yo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new yo(n.startAt.position,n.startAt.inclusive):null;return bm(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Nm(n,e){const t=n.filters.concat([e]);return new Vo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function xm(n,e,t){return new Vo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Mc(n,e){return za(fs(n),fs(e))&&n.limitType===e.limitType}function mb(n){return`${ki(fs(n))}|lt:${n.limitType}`}function Xi(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>ab(r)).join(", ")}]`),Lc(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>go(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>go(r)).join(",")),`Target(${s})`}(fs(n))}; limitType=${n.limitType})`}function Ka(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Ee.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of ga(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,l,u){const m=_p(o,l,u);return o.inclusive?m<=0:m<0}(s.startAt,ga(s),r)||s.endAt&&!function(o,l,u){const m=_p(o,l,u);return o.inclusive?m>=0:m>0}(s.endAt,ga(s),r))}(n,e)}function OE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function db(n){return(e,t)=>{let s=!1;for(const r of ga(n)){const i=qE(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function qE(n,e,t){const s=n.field.isKeyField()?Ee.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Ur(u,m):Te(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Te(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Wr(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return Ky(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=new tn(Ee.comparator);function os(){return $E}const fb=new tn(Ee.comparator);function ra(...n){let e=fb;for(const t of n)e=e.insert(t.key,t);return e}function pb(n){let e=fb;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Us(){return ya()}function hb(){return ya()}function ya(){return new ir(n=>n.toString(),(n,e)=>n.isEqual(e))}const zE=new tn(Ee.comparator),WE=new Ft(Ee.comparator);function ht(...n){let e=WE;for(const t of n)e=e.add(t);return e}const KE=new Ft(nt);function GE(){return KE}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ca(e)?"-0":e}}function gb(n){return{integerValue:""+n}}function QE(n,e){return tE(e)?gb(e):gd(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){this._=void 0}}function YE(n,e,t){return n instanceof Ba?function(r,i){const o={fields:{[Yy]:{stringValue:Qy},[Jy]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&dd(i)&&(i=Uc(i)),i&&(o.fields[Xy]=i),{mapValue:o}}(t,e):n instanceof No?bb(n,e):n instanceof xo?Nb(n,e):function(r,i){const o=yb(r,i),l=Ap(o)+Ap(r.Ae);return hm(o)&&hm(r.Ae)?gb(l):gd(r.serializer,l)}(n,e)}function XE(n,e,t){return n instanceof No?bb(n,e):n instanceof xo?Nb(n,e):t}function yb(n,e){return n instanceof Ua?function(s){return hm(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Ba extends Fc{}class No extends Fc{constructor(e){super(),this.elements=e}}function bb(n,e){const t=xb(e);for(const s of n.elements)t.some(r=>qs(r,s))||t.push(s);return{arrayValue:{values:t}}}class xo extends Fc{constructor(e){super(),this.elements=e}}function Nb(n,e){let t=xb(e);for(const s of n.elements)t=t.filter(r=>!qs(r,s));return{arrayValue:{values:t}}}class Ua extends Fc{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ap(n){return en(n.integerValue||n.doubleValue)}function xb(n){return ja(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,t){this.field=e,this.transform=t}}function ZE(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof No&&r instanceof No||s instanceof xo&&r instanceof xo?co(s.elements,r.elements,qs):s instanceof Ua&&r instanceof Ua?qs(s.Ae,r.Ae):s instanceof Ba&&r instanceof Ba}(n.transform,e.transform)}class eV{constructor(e,t){this.version=e,this.transformResults=t}}class qn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qn}static exists(e){return new qn(void 0,e)}static updateTime(e){return new qn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ol(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Oc{}function vb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new qc(n.key,qn.none()):new Ao(n.key,n.data,qn.none());{const t=n.data,s=On.empty();let r=new Ft(on.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new or(n.key,s,new ns(r.toArray()),qn.none())}}function tV(n,e,t){n instanceof Ao?function(r,i,o){const l=r.value.clone(),u=wp(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof or?function(r,i,o){if(!Ol(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=wp(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(_b(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ba(n,e,t,s){return n instanceof Ao?function(i,o,l,u){if(!Ol(i.precondition,o))return l;const m=i.value.clone(),d=Ip(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(n,e,t,s):n instanceof or?function(i,o,l,u){if(!Ol(i.precondition,o))return l;const m=Ip(i.fieldTransforms,u,o),d=o.data;return d.setAll(_b(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,o,l){return Ol(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function nV(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=yb(s.transform,r||null);i!=null&&(t===null&&(t=On.empty()),t.set(s.field,i))}return t||null}function Cp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&co(s,r,(i,o)=>ZE(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ao extends Oc{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class or extends Oc{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _b(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function wp(n,e,t){const s=new Map;Ue(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,XE(o,l,t[r]))}return s}function Ip(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,YE(i,o,e))}return s}class qc extends Oc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Db extends Oc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&tV(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=ba(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=ba(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=hb();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=vb(o,l);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(We.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ht())}isEqual(e){return this.batchId===e.batchId&&co(this.mutations,e.mutations,(t,s)=>Cp(t,s))&&co(this.baseMutations,e.baseMutations,(t,s)=>Cp(t,s))}}class bd{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Ue(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return zE}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new bd(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn,kt;function rV(n){switch(n){case se.OK:return Te(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Te(15467,{code:n})}}function kb(n){if(n===void 0)return Gn("GRPC error has no .code"),se.UNKNOWN;switch(n){case hn.OK:return se.OK;case hn.CANCELLED:return se.CANCELLED;case hn.UNKNOWN:return se.UNKNOWN;case hn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case hn.INTERNAL:return se.INTERNAL;case hn.UNAVAILABLE:return se.UNAVAILABLE;case hn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case hn.NOT_FOUND:return se.NOT_FOUND;case hn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case hn.ABORTED:return se.ABORTED;case hn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case hn.DATA_LOSS:return se.DATA_LOSS;default:return Te(39323,{code:n})}}(kt=hn||(hn={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=new Pr([4294967295,4294967295],0);function Tp(n){const e=iV().encode(n),t=new _y;return t.update(e),new Uint8Array(t.digest())}function Sp(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Pr([t,s],0),new Pr([r,i],0)]}class xd{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new ia(`Invalid padding: ${t}`);if(s<0)throw new ia(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new ia(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new ia(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Pr.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(Pr.fromNumber(s)));return r.compare(oV)===1&&(r=new Pr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Tp(e),[s,r]=Sp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new xd(i,r,t);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Tp(e),[s,r]=Sp(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class ia extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,Ga.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new $c(We.min(),r,new tn(nt),os(),ht())}}class Ga{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Ga(s,t,ht(),ht(),ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class Eb{constructor(e,t){this.targetId=e,this.Ce=t}}class Vb{constructor(e,t,s=_n.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Pp{constructor(){this.ve=0,this.Fe=Lp(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ht(),t=ht(),s=ht();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Te(38017,{changeType:i})}}),new Ga(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Lp()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class aV{constructor(e){this.Ge=e,this.ze=new Map,this.je=os(),this.Je=fl(),this.He=fl(),this.Ye=new tn(nt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(ac(i))if(s===0){const o=new Ee(i.path);this.et(t,o,ln.newNoDocument(o,We.min()))}else Ue(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=rr(s).toUint8Array()}catch(u){if(u instanceof Gy)return _i("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new xd(o,r,i)}catch(u){return _i(u instanceof ia?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&ac(l.target)){const u=new Ee(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,ln.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let s=ht();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new $c(e,t,this.Ye,this.je,s);return this.je=os(),this.Je=fl(),this.He=fl(),this.Ye=new tn(nt),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Pp,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ft(nt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ft(nt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Pp),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fl(){return new tn(Ee.comparator)}function Lp(){return new tn(Ee.comparator)}const lV={asc:"ASCENDING",desc:"DESCENDING"},cV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uV={and:"AND",or:"OR"};class mV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vm(n,e){return n.useProto3Json||Lc(e)?e:{value:e}}function vo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ab(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dV(n,e){return vo(n,e.toTimestamp())}function Xn(n){return Ue(!!n,49232),We.fromTimestamp(function(t){const s=sr(t);return new Lt(s.seconds,s.nanos)}(n))}function vd(n,e){return _m(n,e).canonicalString()}function _m(n,e){const t=function(r){return new Pt(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Cb(n){const e=Pt.fromString(n);return Ue(Bb(e),10190,{key:e.toString()}),e}function cc(n,e){return vd(n.databaseId,e.path)}function gi(n,e){const t=Cb(e);if(t.get(1)!==n.databaseId.projectId)throw new xe(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new xe(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(Tb(t))}function wb(n,e){return vd(n.databaseId,e)}function Ib(n){const e=Cb(n);return e.length===4?Pt.emptyPath():Tb(e)}function Dm(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Tb(n){return Ue(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function jp(n,e,t){return{name:cc(n,e),fields:t.value.mapValue.fields}}function fV(n,e,t){const s=gi(n,e.name),r=Xn(e.updateTime),i=e.createTime?Xn(e.createTime):We.min(),o=new On({mapValue:{fields:e.fields}}),l=ln.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function pV(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Te(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Ue(d===void 0||typeof d=="string",58123),_n.fromBase64String(d||"")):(Ue(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),_n.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?se.UNKNOWN:kb(m.code);return new xe(d,m.message||"")}(o);t=new Vb(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=gi(n,s.document.name),i=Xn(s.document.updateTime),o=s.document.createTime?Xn(s.document.createTime):We.min(),l=new On({mapValue:{fields:s.document.fields}}),u=ln.newFoundDocument(r,i,o,l),m=s.targetIds||[],d=s.removedTargetIds||[];t=new ql(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=gi(n,s.document),i=s.readTime?Xn(s.readTime):We.min(),o=ln.newNoDocument(r,i),l=s.removedTargetIds||[];t=new ql([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=gi(n,s.document),i=s.removedTargetIds||[];t=new ql([],i,r,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new sV(r,i),l=s.targetId;t=new Eb(l,o)}}return t}function uc(n,e){let t;if(e instanceof Ao)t={update:jp(n,e.key,e.value)};else if(e instanceof qc)t={delete:cc(n,e.key)};else if(e instanceof or)t={update:jp(n,e.key,e.data),updateMask:xV(e.fieldMask)};else{if(!(e instanceof Db))return Te(16599,{Vt:e.type});t={verify:cc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof Ba)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof No)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof xo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ua)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Te(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:dV(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Te(27497)}(n,e.precondition)),t}function km(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?qn.updateTime(Xn(i.updateTime)):i.exists!==void 0?qn.exists(i.exists):qn.none()}(e.currentDocument):qn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let u=null;if("setToServerValue"in l)Ue(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Ba;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new No(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new xo(d)}else"increment"in l?u=new Ua(o,l.increment):Te(16584,{proto:l});const m=on.fromServerFormat(l.fieldPath);return new JE(m,u)}(n,r)):[];if(e.update){e.update.name;const r=gi(n,e.update.name),i=new On({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const m=u.fieldPaths||[];return new ns(m.map(d=>on.fromServerFormat(d)))}(e.updateMask);return new or(r,i,o,t,s)}return new Ao(r,i,t,s)}if(e.delete){const r=gi(n,e.delete);return new qc(r,t)}if(e.verify){const r=gi(n,e.verify);return new Db(r,t)}return Te(1463,{proto:e})}function hV(n,e){return n&&n.length>0?(Ue(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?Xn(r.updateTime):Xn(i);return o.isEqual(We.min())&&(o=Xn(i)),new eV(o,r.transformResults||[])}(t,e))):[]}function Sb(n,e){return{documents:[wb(n,e.path)]}}function Pb(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=wb(n,r);const i=function(m){if(m.length!==0)return Rb(Mt.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Ji(h.field),direction:yV(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=vm(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function Lb(n){let e=Ib(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){Ue(s===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=jb(f);return h instanceof Mt&&hd(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(w){return new Ra(Zi(w.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Lc(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,y=f.values||[];return new yo(y,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,y=f.values||[];return new yo(y,h)}(t.endAt)),ME(e,r,o,i,l,"F",u,m)}function gV(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function jb(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Zi(t.unaryFilter.field);return Nt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Zi(t.unaryFilter.field);return Nt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zi(t.unaryFilter.field);return Nt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zi(t.unaryFilter.field);return Nt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(n):n.fieldFilter!==void 0?function(t){return Nt.create(Zi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Mt.create(t.compositeFilter.filters.map(s=>jb(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(t.compositeFilter.op))}(n):Te(30097,{filter:n})}function yV(n){return lV[n]}function bV(n){return cV[n]}function NV(n){return uV[n]}function Ji(n){return{fieldPath:n.canonicalString()}}function Zi(n){return on.fromServerFormat(n.fieldPath)}function Rb(n){return n instanceof Nt?function(t){if(t.op==="=="){if(Np(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NAN"}};if(bp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Np(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NOT_NAN"}};if(bp(t.value))return{unaryFilter:{field:Ji(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ji(t.field),op:bV(t.op),value:t.value}}}(n):n instanceof Mt?function(t){const s=t.getFilters().map(r=>Rb(r));return s.length===1?s[0]:{compositeFilter:{op:NV(t.op),filters:s}}}(n):Te(54877,{filter:n})}function xV(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Bb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t,s,r,i=We.min(),o=We.min(),l=_n.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Js(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Js(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e){this.yt=e}}function vV(n,e){let t;if(e.document)t=fV(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Ee.fromSegments(e.noDocument.path),r=Vi(e.noDocument.readTime);t=ln.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const s=Ee.fromSegments(e.unknownDocument.path),r=Vi(e.unknownDocument.version);t=ln.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(r){const i=new Lt(r[0],r[1]);return We.fromTimestamp(i)}(e.readTime)),t}function Rp(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:mc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:cc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:vo(i,o.version.toTimestamp()),createTime:vo(i,o.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Ei(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Ei(e.version)}}return s}function mc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ei(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Vi(n){const e=new Lt(n.seconds,n.nanoseconds);return We.fromTimestamp(e)}function ci(n,e){const t=(e.baseMutations||[]).map(i=>km(n.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>km(n.yt,i)),r=Lt.fromMillis(e.localWriteTimeMs);return new yd(e.batchId,r,t,s)}function oa(n){const e=Vi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Vi(n.lastLimboFreeSnapshotVersion):We.min();let s;return s=function(i){return i.documents!==void 0}(n.query)?function(i){const o=i.documents.length;return Ue(o===1,1966,{count:o}),fs(Wa(Ib(i.documents[0])))}(n.query):function(i){return fs(Lb(i))}(n.query),new Js(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,_n.fromBase64String(n.resumeToken))}function Hb(n,e){const t=Ei(e.snapshotVersion),s=Ei(e.lastLimboFreeSnapshotVersion);let r;r=ac(e.target)?Sb(n.yt,e.target):Pb(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ki(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Mb(n){const e=Lb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xm(e,e.limit,"L"):e}function Pu(n,e){return new Nd(e.largestBatchId,km(n.yt,e.overlayMutation))}function Bp(n,e){const t=e.path.lastSegment();return[n,$n(e.path.popLast()),t]}function Up(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ei(s.readTime),documentKey:$n(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{getBundleMetadata(e,t){return Hp(e).get(t).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Vi(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,t){return Hp(e).put(function(r){return{bundleId:r.id,createTime:Ei(Xn(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return Mp(e).get(t).next(s=>{if(s)return function(i){return{name:i.name,query:Mb(i.bundledQuery),readTime:Vi(i.readTime)}}(s)})}saveNamedQuery(e,t){return Mp(e).put(function(r){return{name:r.name,readTime:Ei(Xn(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function Hp(n){return An(n,jc)}function Mp(n){return An(n,Rc)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new zc(e,s)}getOverlay(e,t){return Fo(e).get(Bp(this.userId,t)).next(s=>s?Pu(this.serializer,s):null)}getOverlays(e,t){const s=Us();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const l=new Nd(t,o);r.push(this.St(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add($n(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(Fo(e).Z(dm,l))}),$.waitFor(i)}getOverlaysForCollection(e,t,s){const r=Us(),i=$n(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Fo(e).J(dm,o).next(l=>{for(const u of l){const m=Pu(this.serializer,u);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=Us();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fo(e).ee({index:Oy,range:l},(u,m,d)=>{const f=Pu(this.serializer,m);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}St(e,t){return Fo(e).put(function(r,i,o){const[l,u,m]=Bp(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:m,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:uc(r.yt,o.mutation)}}(this.serializer,this.userId,t))}}function Fo(n){return An(n,Bc)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{bt(e){return An(e,ud)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t==null?void 0:t.value;return s?_n.fromUint8Array(s):_n.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(en(e.integerValue));else if("doubleValue"in e){const s=en(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Ca(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=sr(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(rr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?eb(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Hc(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Te(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){var o,l;const s=e.fields||{};this.Ft(t,53);const r=ho,i=((l=(o=s[r].arrayValue)==null?void 0:o.values)==null?void 0:l.length)||0;this.Ft(t,15),t.Mt(en(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ui.Kt=new ui;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=255;function kV(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Fp(n){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=kV(255&s[i]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class EV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=Fp(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=Fp(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Oi),this.sn(255)}_n(){this.an(Oi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Oi?(this.sn(Oi),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Oi?(this.an(Oi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class VV{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class AV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Oo{constructor(){this.cn=new EV,this.ln=new VV(this.cn),this.hn=new AV(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new mi(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:$l(this.En),directionalValue:$l(this.dn),orderedDocumentKey:$l(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function hr(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=Op(n.En,e.En),t!==0?t:(t=Op(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function Op(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function $l(n){return cy()?function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s}(n):n}function qp(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(n)}class $p{constructor(e){this.mn=new Ft((t,s)=>on.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Ue(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=cm(e);if(t!==void 0&&!this.wn(t))return!1;const s=oi(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=s[i];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ft(on.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Rl(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Rl(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Rl(s.field,s.dir==="asc"?0:1)));return new nc(nc.UNKNOWN_ID,this.collectionId,t,Aa.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(n){var t,s;if(Ue(n instanceof Nt||n instanceof Mt,20012),n instanceof Nt){if(n instanceof cb){const r=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map(i=>Nt.create(n.field,"==",i)))||[];return Mt.create(r,"or")}return n}const e=n.filters.map(r=>Fb(r));return Mt.create(e,n.op)}function CV(n){if(n.getFilters().length===0)return[];const e=Am(Fb(n));return Ue(Ob(e),7391),Em(e)||Vm(e)?[e]:e.getFilters()}function Em(n){return n instanceof Nt}function Vm(n){return n instanceof Mt&&hd(n)}function Ob(n){return Em(n)||Vm(n)||function(t){if(t instanceof Mt&&gm(t)){for(const s of t.getFilters())if(!Em(s)&&!Vm(s))return!1;return!0}return!1}(n)}function Am(n){if(Ue(n instanceof Nt||n instanceof Mt,34018),n instanceof Nt)return n;if(n.filters.length===1)return Am(n.filters[0]);const e=n.filters.map(s=>Am(s));let t=Mt.create(e,n.op);return t=dc(t),Ob(t)?t:(Ue(t instanceof Mt,64498),Ue(bo(t),40251),Ue(t.filters.length>1,57927),t.filters.reduce((s,r)=>_d(s,r)))}function _d(n,e){let t;return Ue(n instanceof Nt||n instanceof Mt,38388),Ue(e instanceof Nt||e instanceof Mt,25473),t=n instanceof Nt?e instanceof Nt?function(r,i){return Mt.create([r,i],"and")}(n,e):zp(n,e):e instanceof Nt?zp(e,n):function(r,i){if(Ue(r.filters.length>0&&i.filters.length>0,48005),bo(r)&&bo(i))return ob(r,i.getFilters());const o=gm(r)?r:i,l=gm(r)?i:r,u=o.filters.map(m=>_d(m,l));return Mt.create(u,"or")}(n,e),dc(t)}function zp(n,e){if(bo(e))return ob(e,n.getFilters());{const t=e.filters.map(s=>_d(n,s));return Mt.create(t,"or")}}function dc(n){if(Ue(n instanceof Nt||n instanceof Mt,11850),n instanceof Nt)return n;const e=n.getFilters();if(e.length===1)return dc(e[0]);if(rb(n))return n;const t=e.map(r=>dc(r)),s=[];return t.forEach(r=>{r instanceof Nt?s.push(r):r instanceof Mt&&(r.op===n.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:Mt.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(){this.Cn=new Dd}addToCollectionParentIndex(e,t){return this.Cn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(as.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(as.min())}updateCollectionGroup(e,t,s){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class Dd{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Ft(Pt.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ft(Pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="IndexedDbIndexManager",pl=new Uint8Array(0);class IV{constructor(e,t){this.databaseId=t,this.vn=new Dd,this.Fn=new ir(s=>ki(s),(s,r)=>za(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:s,parent:$n(r)};return Kp(e).put(i)}return $.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[Iy(t),""],!1,!0);return Kp(e).J(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(Bs(o.parent))}return s})}addFieldIndex(e,t){const s=qo(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=$i(e);return i.next(l=>{o.put(Up(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=qo(e),r=$i(e),i=qi(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=qo(e),s=qi(e),r=$i(e);return t.Z().next(()=>s.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return $.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new $p(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const s=qi(e);let r=!0;const i=new Map;return $.forEach(this.Mn(t),o=>this.xn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=ht();const l=[];return $.forEach(i,(u,m)=>{pe(Wp,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(re=>`${re.fieldPath}:${re.kind}`).join(",")}`}(u)} to execute ${ki(t)}`);const d=function(F,re){const ee=cm(re);if(ee===void 0)return null;for(const M of lc(F,ee.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(m,u),f=function(F,re){const ee=new Map;for(const M of oi(re))for(const V of lc(F,M.fieldPath))switch(V.op){case"==":case"in":ee.set(M.fieldPath.canonicalString(),V.value);break;case"not-in":case"!=":return ee.set(M.fieldPath.canonicalString(),V.value),Array.from(ee.values())}return null}(m,u),h=function(F,re){const ee=[];let M=!0;for(const V of oi(re)){const N=V.kind===0?kp(F,V.fieldPath,F.startAt):Ep(F,V.fieldPath,F.startAt);ee.push(N.value),M&&(M=N.inclusive)}return new yo(ee,M)}(m,u),y=function(F,re){const ee=[];let M=!0;for(const V of oi(re)){const N=V.kind===0?Ep(F,V.fieldPath,F.endAt):kp(F,V.fieldPath,F.endAt);ee.push(N.value),M&&(M=N.inclusive)}return new yo(ee,M)}(m,u),w=this.On(u,m,h),v=this.On(u,m,y),C=this.Nn(u,m,f),B=this.Bn(u.indexId,d,w,h.inclusive,v,y.inclusive,C);return $.forEach(B,S=>s.Y(S,t.limit).next(F=>{F.forEach(re=>{const ee=Ee.fromSegments(re.documentKey);o.has(ee)||(o=o.add(ee),l.push(ee))})}))}).next(()=>l)}return $.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=CV(Mt.create(e.filters,"and")).map(s=>bm(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const u=(t!=null?t.length:1)*Math.max(s.length,i.length),m=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){const h=t?this.Ln(t[f/m]):pl,y=this.kn(e,h,s[f%m],r),w=this.qn(e,h,i[f%m],o),v=l.map(C=>this.kn(e,h,C,!0));d.push(...this.createRange(y,w,v))}return d}kn(e,t,s,r){const i=new mi(e,Ee.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new mi(e,Ee.empty(),t,s);return r?i.An():i}xn(e,t){const s=new $p(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let s=2;const r=this.Mn(t);return $.forEach(r,i=>this.xn(e,i).next(o=>{o?s!==0&&o.fields.length<function(u){let m=new Ft(on.comparator),d=!1;for(const f of u.filters)for(const h of f.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?d=!0:m=m.add(h.field));for(const f of u.orderBy)f.field.isKeyField()||(m=m.add(f.field));return m.size+(d?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&s===2?1:s)}Qn(e,t){const s=new Oo;for(const r of oi(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);ui.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new Oo;return ui.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new Oo;return ui.Kt.Dt(La(this.databaseId,t),s.Pn(function(i){const o=oi(i);return o.length===0?0:o[o.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new Oo);let i=0;for(const o of oi(e)){const l=s[i++];for(const u of r)if(this.Un(t,o.fieldPath)&&ja(l))r=this.Kn(r,o,l);else{const m=u.Pn(o.kind);ui.Kt.Dt(l,m)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const u=new Oo;u.seed(l.un()),ui.Kt.Dt(o,u.Pn(t.kind)),i.push(u)}return i}Un(e,t){return!!e.filters.find(s=>s instanceof Nt&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=qo(e),r=$i(e);return(t?s.J(mm,IDBKeyRange.bound(t,t)):s.J()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(u=>{o.push(function(d,f){const h=f?new Aa(f.sequenceNumber,new as(Vi(f.readTime),new Ee(Bs(f.documentKey)),f.largestBatchId)):Aa.empty(),y=d.fields.map(([w,v])=>new Rl(on.fromServerFormat(w),v));return new nc(d.indexId,d.collectionGroup,y,h)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:nt(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=qo(e),i=$i(e);return this.Gn(e).next(o=>r.J(mm,IDBKeyRange.bound(t,t)).next(l=>$.forEach(l,u=>i.put(Up(u.indexId,this.uid,o,s)))))}updateIndexEntries(e,t){const s=new Map;return $.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,u=>this.zn(e,r,u).next(m=>{const d=this.jn(i,u);return m.isEqual(d)?$.resolve():this.Jn(e,i,u,m,d)}))))})}Hn(e,t,s,r){return qi(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return qi(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=qi(e);let i=new Ft(hr);return r.ee({index:Fy,range:IDBKeyRange.only([s.indexId,this.uid,$l(this.$n(s,t))])},(o,l)=>{i=i.add(new mi(s.indexId,t,qp(l.arrayValue),qp(l.directionalValue)))}).next(()=>i)}jn(e,t){let s=new Ft(hr);const r=this.Qn(t,e);if(r==null)return s;const i=cm(t);if(i!=null){const o=e.data.field(i.fieldPath);if(ja(o))for(const l of o.arrayValue.values||[])s=s.add(new mi(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new mi(t.indexId,e.key,pl,r));return s}Jn(e,t,s,r,i){pe(Wp,"Updating index entries for document '%s'",t.key);const o=[];return function(u,m,d,f,h){const y=u.getIterator(),w=m.getIterator();let v=Fi(y),C=Fi(w);for(;v||C;){let B=!1,S=!1;if(v&&C){const F=d(v,C);F<0?S=!0:F>0&&(B=!0)}else v!=null?S=!0:B=!0;B?(f(C),C=Fi(w)):S?(h(v),v=Fi(y)):(v=Fi(y),C=Fi(w))}}(r,i,hr,l=>{o.push(this.Hn(e,t,s,l))},l=>{o.push(this.Yn(e,t,s,l))}),$.waitFor(o)}Gn(e){let t=1;return $i(e).ee({index:My,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,l)=>hr(o,l)).filter((o,l,u)=>!l||hr(o,u[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=hr(o,e),u=hr(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,pl,Ee.empty()),u=r[o+1].Vn(this.uid,pl,Ee.empty());i.push(IDBKeyRange.bound(l,u))}return i}Zn(e,t){return hr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Gp)}getMinOffset(e,t){return $.mapArray(this.Mn(t),s=>this.xn(e,s).next(r=>r||Te(44426))).next(Gp)}}function Kp(n){return An(n,Ta)}function qi(n){return An(n,pa)}function qo(n){return An(n,cd)}function $i(n){return An(n,fa)}function Gp(n){Ue(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;od(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new as(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qb=41943040;class Fn{static withCacheSize(e){return new Fn(e,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(n,e,t){const s=n.store(bs),r=n.store(uo),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=s.ee({range:o},(d,f,h)=>(l++,h.delete()));i.push(u.next(()=>{Ue(l===1,47070,{batchId:t.batchId})}));const m=[];for(const d of t.mutations){const f=By(e,d.key.path,t.batchId);i.push(r.delete(f)),m.push(d.key)}return $.waitFor(i).next(()=>m)}function fc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Te(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(qb,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);class Wc{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){Ue(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Wc(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gr(e).ee({index:di,range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=eo(e),o=gr(e);return o.add({}).next(l=>{Ue(typeof l=="number",49019);const u=new yd(l,t,s,r),m=function(y,w,v){const C=v.baseMutations.map(S=>uc(y.yt,S)),B=v.mutations.map(S=>uc(y.yt,S));return{userId:w,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:C,mutations:B}}(this.serializer,this.userId,u),d=[];let f=new Ft((h,y)=>nt(h.canonicalString(),y.canonicalString()));for(const h of r){const y=By(this.userId,h.key.path,l);f=f.add(h.key.path.popLast()),d.push(o.put(m)),d.push(i.put(y,rE))}return f.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Xn[l]=u.keys()}),$.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return gr(e).get(t).next(s=>s?(Ue(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),ci(this.serializer,s)):null)}er(e,t){return this.Xn[t]?$.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return gr(e).ee({index:di,range:r},(o,l,u)=>{l.userId===this.userId&&(Ue(l.batchId>=s,47524,{tr:s}),i=ci(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=pi;return gr(e).ee({index:di,range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,pi],[this.userId,Number.POSITIVE_INFINITY]);return gr(e).J(di,t).next(s=>s.map(r=>ci(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Bl(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return eo(e).ee({range:r},(o,l,u)=>{const[m,d,f]=o,h=Bs(d);if(m===this.userId&&t.path.isEqual(h))return gr(e).get(f).next(y=>{if(!y)throw Te(61480,{nr:o,batchId:f});Ue(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),i.push(ci(this.serializer,y))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ft(nt);const r=[];return t.forEach(i=>{const o=Bl(this.userId,i.path),l=IDBKeyRange.lowerBound(o),u=eo(e).ee({range:l},(m,d,f)=>{const[h,y,w]=m,v=Bs(y);h===this.userId&&i.path.isEqual(v)?s=s.add(w):f.done()});r.push(u)}),$.waitFor(r).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=Bl(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new Ft(nt);return eo(e).ee({range:o},(u,m,d)=>{const[f,h,y]=u,w=Bs(h);f===this.userId&&s.isPrefixOf(w)?w.length===r&&(l=l.add(y)):d.done()}).next(()=>this.rr(e,l))}rr(e,t){const s=[],r=[];return t.forEach(i=>{r.push(gr(e).get(i).next(o=>{if(o===null)throw Te(35274,{batchId:i});Ue(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(ci(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return $b(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return eo(e).ee({range:s},(i,o,l)=>{if(i[0]===this.userId){const u=Bs(i[1]);r.push(u)}else l.done()}).next(()=>{Ue(r.length===0,56720,{sr:r.map(i=>i.canonicalString())})})})}containsKey(e,t){return zb(e,this.userId,t)}_r(e){return Wb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:pi,lastStreamToken:""})}}function zb(n,e,t){const s=Bl(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return eo(n).ee({range:i,X:!0},(l,u,m)=>{const[d,f,h]=l;d===e&&f===r&&(o=!0),m.done()}).next(()=>o)}function gr(n){return An(n,bs)}function eo(n){return An(n,uo)}function Wb(n){return An(n,wa)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ai(0)}static cr(){return new Ai(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new Ai(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>We.fromTimestamp(new Lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>zi(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(Ue(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return zi(e).ee((o,l)=>{const u=oa(l);u.sequenceNumber<=t&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,t){return zi(e).ee((s,r)=>{const i=oa(r);t(i)})}lr(e){return Yp(e).get(ic).next(t=>(Ue(t!==null,2888),t))}hr(e,t){return Yp(e).put(ic,t)}Pr(e,t){return zi(e).put(Hb(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=ki(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return zi(e).ee({range:r,index:Hy},(o,l,u)=>{const m=oa(l);za(t,m.target)&&(i=m,u.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=Vr(e);return t.forEach(o=>{const l=$n(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,t,s){const r=Vr(e);return $.forEach(t,i=>{const o=$n(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=Vr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Vr(e);let i=ht();return r.ee({range:s,X:!0},(o,l,u)=>{const m=Bs(o[1]),d=new Ee(m);i=i.add(d)}).next(()=>i)}containsKey(e,t){const s=$n(t.path),r=IDBKeyRange.bound([s],[Iy(s)],!1,!0);let i=0;return Vr(e).ee({index:ld,X:!0,range:r},([o,l],u,m)=>{o!==0&&(i++,m.done())}).next(()=>i>0)}At(e,t){return zi(e).get(t).next(s=>s?oa(s):null)}}function zi(n){return An(n,mo)}function Yp(n){return An(n,hi)}function Vr(n){return An(n,fo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="LruGarbageCollector",SV=1048576;function Jp([n,e],[t,s]){const r=nt(n,t);return r===0?nt(e,s):r}class PV{constructor(e){this.Ir=e,this.buffer=new Ft(Jp),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Jp(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Kb{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(Xp,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){zr(t)?pe(Xp,"Ignoring IndexedDB error during garbage collection: ",t):await Ii(t)}await this.Vr(3e5)})}}class LV{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return $.resolve(ds.ce);const s=new PV(t);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(Qp)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qp):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(m=Date.now(),Yi()<=Et.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function Gb(n,e){return new LV(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,t){this.db=e,this.garbageCollector=Gb(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,r)=>t(r))}addReference(e,t,s){return hl(e,s)}removeReference(e,t,s){return hl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return hl(e,t)}br(e,t){return function(r,i){let o=!1;return Wb(r).te(l=>zb(r,l,i).next(u=>(u&&(o=!0),$.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.br(e,o).next(m=>{if(!m)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,We.min()),Vr(e).delete(function(f){return[0,$n(f.path)]}(o))))});r.push(u)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return hl(e,t)}Sr(e,t){const s=Vr(e);let r,i=ds.ce;return s.ee({index:ld},([o,l],{path:u,sequenceNumber:m})=>{o===0?(i!==ds.ce&&t(new Ee(Bs(r)),i),i=m,r=u):i=ds.ce}).next(()=>{i!==ds.ce&&t(new Ee(Bs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function hl(n,e){return Vr(n).put(function(s,r){return{targetId:0,path:$n(s.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.changes=new ir(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?$.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return si(e).put(s)}removeEntry(e,t,s){return si(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],mc(o),l[l.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=ln.newInvalidDocument(t);return si(e).ee({index:Ul,range:IDBKeyRange.only($o(t))},(r,i)=>{s=this.Cr(t,i)}).next(()=>s)}vr(e,t){let s={size:0,document:ln.newInvalidDocument(t)};return si(e).ee({index:Ul,range:IDBKeyRange.only($o(t))},(r,i)=>{s={document:this.Cr(t,i),size:fc(i)}}).next(()=>s)}getEntries(e,t){let s=os();return this.Fr(e,t,(r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)}).next(()=>s)}Mr(e,t){let s=os(),r=new tn(Ee.comparator);return this.Fr(e,t,(i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,fc(o))}).next(()=>({documents:s,Or:r}))}Fr(e,t,s){if(t.isEmpty())return $.resolve();let r=new Ft(th);t.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound($o(r.first()),$o(r.last())),o=r.getIterator();let l=o.getNext();return si(e).ee({index:Ul,range:i},(u,m,d)=>{const f=Ee.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;l&&th(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,m),l=o.hasNext()?o.getNext():null),l?d.j($o(l)):d.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),mc(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return si(e).J(IDBKeyRange.bound(l,u,!0)).next(m=>{i==null||i.incrementDocumentReadCount(m.length);let d=os();for(const f of m){const h=this.Cr(Ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h.isFoundDocument()&&(Ka(t,h)||r.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,t,s,r){let i=os();const o=eh(t,s),l=eh(t,as.max());return si(e).ee({index:Uy,range:IDBKeyRange.bound(o,l,!0)},(u,m,d)=>{const f=this.Cr(Ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);i=i.insert(f.key,f),i.size===r&&d.done()}).next(()=>i)}newChangeBuffer(e){return new BV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Zp(e).get(um).next(t=>(Ue(!!t,20021),t))}Dr(e,t){return Zp(e).put(um,t)}Cr(e,t){if(t){const s=vV(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(We.min())))return s}return ln.newInvalidDocument(e)}}function Yb(n){return new RV(n)}class BV extends Qb{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ir(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new Ft((i,o)=>nt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const u=Rp(this.Nr.serializer,o);r=r.add(i.path.popLast());const m=fc(u);s+=m-l.size,t.push(this.Nr.addEntry(e,i,u))}else if(s-=l.size,this.trackRemovals){const u=Rp(this.Nr.serializer,o.convertToNoDocument(We.min()));t.push(this.Nr.addEntry(e,i,u))}}),r.forEach(i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Nr.updateMetadata(e,s)),$.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:r})=>(r.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function Zp(n){return An(n,Ia)}function si(n){return An(n,rc)}function $o(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function eh(n,e){const t=e.documentKey.path.toArray();return[n,mc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function th(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=nt(t[i],s[i]),r)return r;return r=nt(t.length,s.length),r||(r=nt(t[t.length-2],s[s.length-2]),r||nt(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&ba(s.mutation,r,ns.empty(),Lt.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,ht()).next(()=>s))}getLocalViewOfDocuments(e,t,s=ht()){const r=Us();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=ra();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Us();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,ht()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,s,r){let i=os();const o=ya(),l=function(){return ya()}();return t.forEach((u,m)=>{const d=s.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof or)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),ba(d.mutation,m,d.mutation.getFieldMask(),Lt.now())):o.set(m.key,ns.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new UV(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const s=ya();let r=new tn((o,l)=>o-l),i=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=s.get(u)||ns.empty();d=l.applyToLocalView(m,d),s.set(u,d);const f=(r.get(l.batchId)||ht()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=hb();d.forEach(h=>{if(!i.has(h)){const y=vb(t.get(h),s.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ub(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):$.resolve(Us());let l=Va,u=i;return o.next(m=>$.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,ht())).next(d=>({batchId:l,changes:pb(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next(s=>{let r=ra();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=ra();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const m=function(f,h){return new Vo(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,s,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,ln.newInvalidDocument(d)))});let l=ra();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&ba(d.mutation,m,ns.empty(),Lt.now()),Ka(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return $.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Xn(r.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:Mb(r.bundledQuery),readTime:Xn(r.readTime)}}(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.overlays=new tn(Ee.comparator),this.qr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Us();return $.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),$.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(e,t,s){const r=Us(),i=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return $.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new tn((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>s){let d=i.get(m.largestBatchId);d===null&&(d=Us(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Us(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return $.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Nd(t,s));let i=this.qr.get(t);i===void 0&&(i=ht(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(){this.Qr=new Ft(Tn.$r),this.Ur=new Ft(Tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Tn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new Tn(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new Ee(new Pt([])),s=new Tn(t,e),r=new Tn(t,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Pt([])),s=new Tn(t,e),r=new Tn(t,e+1);let i=ht();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Tn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Tn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||nt(e.Yr,t.Yr)}static Kr(e,t){return nt(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ft(Tn.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yd(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Tn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,t){return $.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?pi:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Tn(t,0),r=new Tn(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ft(nt);return t.forEach(r=>{const i=new Tn(r,0),o=new Tn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{s=s.add(l.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;Ee.isDocumentKey(i)||(i=i.child(""));const o=new Tn(new Ee(i),0);let l=new Ft(nt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!s.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),$.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ue(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(t.mutations,r=>{const i=new Tn(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new Tn(t,0),r=this.Zr.firstAfterOrEqual(s);return $.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e){this.ri=e,this.docs=function(){return new tn(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return $.resolve(s?s.document.mutableCopy():ln.newInvalidDocument(t))}getEntries(e,t){let s=os();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ln.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=os();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||od(Py(d),s)<=0||(r.has(d.key)||Ka(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,t,s,r){Te(9500)}ii(e,t){return $.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new $V(this)}getSize(e){return $.resolve(this.size)}}class $V extends Qb{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),$.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e){this.persistence=e,this.si=new ir(t=>ki(t),za),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.oi=0,this._i=new kd,this.targetCount=0,this.ai=Ai.ur()}forEachTarget(e,t){return this.si.forEach((s,r)=>t(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),$.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ai(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Pr(t),$.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return $.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),$.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return $.resolve(s)}containsKey(e,t){return $.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t){this.ui={},this.overlays={},this.ci=new ds(0),this.li=!1,this.li=!0,this.hi=new FV,this.referenceDelegate=e(this),this.Pi=new zV(this),this.indexManager=new wV,this.remoteDocumentCache=function(r){return new qV(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new Ub(t),this.Ii=new HV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new MV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new OV(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe("MemoryPersistence","Starting transaction:",e);const r=new WV(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class WV extends jy{constructor(e){super(),this.currentSequenceNumber=e}}class Kc{constructor(e){this.persistence=e,this.Ri=new kd,this.Vi=null}static mi(e){return new Kc(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),$.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const r=Ee.fromPath(s);return this.gi(e,r).next(i=>{i||t.removeEntry(r,We.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return $.or([()=>$.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class pc{constructor(e,t){this.persistence=e,this.pi=new ir(s=>$n(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=Gb(this,t)}static mi(e,t){return new pc(e,t)}Ei(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return $.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?$.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(s++,i.removeEntry(o,We.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),$.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ml(e.data.value)),t}br(e,t,s){return $.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return $.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.serializer=e}k(e,t,s,r){const i=new Pc("createOrUpgrade",t);s<1&&r>=1&&(function(u){u.createObjectStore($a)}(e),function(u){u.createObjectStore(wa,{keyPath:sE}),u.createObjectStore(bs,{keyPath:dp,autoIncrement:!0}).createIndex(di,fp,{unique:!0}),u.createObjectStore(uo)}(e),nh(e),function(u){u.createObjectStore(ai)}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(u){u.deleteObjectStore(fo),u.deleteObjectStore(mo),u.deleteObjectStore(hi)}(e),nh(e)),o=o.next(()=>function(u){const m=u.store(hi),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:We.min().toTimestamp(),targetCount:0};return m.put(ic,d)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(u,m){return m.store(bs).J().next(f=>{u.deleteObjectStore(bs),u.createObjectStore(bs,{keyPath:dp,autoIncrement:!0}).createIndex(di,fp,{unique:!0});const h=m.store(bs),y=f.map(w=>h.put(w));return $.waitFor(y)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore(po,{keyPath:dE})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.yi(i))),s<6&&r>=6&&(o=o.next(()=>(function(u){u.createObjectStore(Ia)}(e),this.wi(i)))),s<7&&r>=7&&(o=o.next(()=>this.Si(i))),s<8&&r>=8&&(o=o.next(()=>this.bi(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Di(i))),s<11&&r>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(jc,{keyPath:fE})})(e),function(u){u.createObjectStore(Rc,{keyPath:pE})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(u){const m=u.createObjectStore(Bc,{keyPath:vE});m.createIndex(dm,_E,{unique:!1}),m.createIndex(Oy,DE,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(u){const m=u.createObjectStore(rc,{keyPath:iE});m.createIndex(Ul,oE),m.createIndex(Uy,aE)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(ai))),s<14&&r>=14&&(o=o.next(()=>this.Fi(e,i))),s<15&&r>=15&&(o=o.next(()=>function(u){u.createObjectStore(cd,{keyPath:hE,autoIncrement:!0}).createIndex(mm,gE,{unique:!1}),u.createObjectStore(fa,{keyPath:yE}).createIndex(My,bE,{unique:!1}),u.createObjectStore(pa,{keyPath:NE}).createIndex(Fy,xE,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{t.objectStore(fa).clear()}).next(()=>{t.objectStore(pa).clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(ud,{keyPath:kE})})(e)})),s<18&&r>=18&&cy()&&(o=o.next(()=>{t.objectStore(fa).clear()}).next(()=>{t.objectStore(pa).clear()})),o}wi(e){let t=0;return e.store(ai).ee((s,r)=>{t+=fc(r)}).next(()=>{const s={byteSize:t};return e.store(Ia).put(um,s)})}yi(e){const t=e.store(wa),s=e.store(bs);return t.J().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,pi],[i.userId,i.lastAcknowledgedBatchId]);return s.J(di,o).next(l=>$.forEach(l,u=>{Ue(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const m=ci(this.serializer,u);return $b(e,i.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(fo),s=e.store(ai);return e.store(hi).get(ic).next(r=>{const i=[];return s.ee((o,l)=>{const u=new Pt(o),m=function(f){return[0,$n(f)]}(u);i.push(t.get(m).next(d=>d?$.resolve():(f=>t.put({targetId:0,path:$n(f),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>$.waitFor(i))})}bi(e,t){e.createObjectStore(Ta,{keyPath:mE});const s=t.store(Ta),r=new Dd,i=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return s.put({collectionId:l,parent:$n(u)})}};return t.store(ai).ee({X:!0},(o,l)=>{const u=new Pt(o);return i(u.popLast())}).next(()=>t.store(uo).ee({X:!0},([o,l,u],m)=>{const d=Bs(l);return i(d.popLast())}))}Di(e){const t=e.store(mo);return t.ee((s,r)=>{const i=oa(r),o=Hb(this.serializer,i);return t.put(o)})}Ci(e,t){const s=t.store(ai),r=[];return s.ee((i,o)=>{const l=t.store(rc),u=function(f){return f.document?new Ee(Pt.fromString(f.document.name).popFirst(5)):f.noDocument?Ee.fromSegments(f.noDocument.path):f.unknownDocument?Ee.fromSegments(f.unknownDocument.path):Te(36783)}(o).path.toArray(),m={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(m))}).next(()=>$.waitFor(r))}Fi(e,t){const s=t.store(bs),r=Yb(this.serializer),i=new Ed(Kc.mi,this.serializer.yt);return s.J().next(o=>{const l=new Map;return o.forEach(u=>{let m=l.get(u.userId)??ht();ci(this.serializer,u).keys().forEach(d=>m=m.add(d)),l.set(u.userId,m)}),$.forEach(l,(u,m)=>{const d=new jn(m),f=zc.wt(this.serializer,d),h=i.getIndexManager(d),y=Wc.wt(d,this.serializer,h,i.referenceDelegate);return new Xb(r,y,f,h).recalculateAndSaveOverlaysForDocumentKeys(new fm(t,ds.ce),u).next()})})}}function nh(n){n.createObjectStore(fo,{keyPath:cE}).createIndex(ld,uE,{unique:!0}),n.createObjectStore(mo,{keyPath:"targetId"}).createIndex(Hy,lE,{unique:!0}),n.createObjectStore(hi)}const yr="IndexedDbPersistence",Lu=18e5,ju=5e3,Ru="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",GV="main";class Vd{constructor(e,t,s,r,i,o,l,u,m,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=m,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=h=>Promise.resolve(),!Vd.v())throw new xe(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jV(this,r),this.$i=t+GV,this.serializer=new Ub(u),this.Ui=new Lr(this.$i,this.Ni,new KV(this.serializer)),this.hi=new DV,this.Pi=new TV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Yb(this.serializer),this.Ii=new _V,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&Gn(yr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new xe(se.FAILED_PRECONDITION,Ru);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new ds(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>gl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(zr(e))return pe(yr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(yr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return zo(e).get(Mi).next(t=>$.resolve(this.es(t)))}ts(e){return gl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Lu)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=An(t,po);return s.J().next(r=>{const i=this.ss(r,Lu),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):zo(e).get(Mi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,ju)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new xe(se.FAILED_PRECONDITION,Ru);return!1}}return!(!this.networkEnabled||!this.inForeground)||gl(e).J().next(s=>this.ss(s,ju).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&pe(yr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[$a,po],e=>{const t=new fm(e,ds.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>gl(e).J().next(t=>this.ss(t,Lu).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Wc.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new IV(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return zc.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){pe(yr,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=function(u){return u===18?AE:u===17?Wy:u===16?VE:u===15?md:u===14?zy:u===13?$y:u===12?EE:u===11?qy:void Te(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,r,i,l=>(o=new fm(l,this.ci?this.ci.next():ds.ce),t==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw Gn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new xe(se.FAILED_PRECONDITION,Ly);return s(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Is(e){return zo(e).get(Mi).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,ju)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new xe(se.FAILED_PRECONDITION,Ru)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zo(e).put(Mi,t)}static v(){return Lr.v()}Zi(e){const t=zo(e);return t.get(Mi).next(s=>this.es(s)?(pe(yr,"Releasing primary lease."),t.delete(Mi)):$.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Gn(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;ly()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return pe(yr,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Gn(yr,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Gn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zo(n){return An(n,$a)}function gl(n){return An(n,po)}function QV(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=ht(),r=ht();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Ad(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return ly()?8:Ry(Zl())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new YV;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(Yi()<=Et.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Xi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(Yi()<=Et.DEBUG&&pe("QueryEngine","Query:",Xi(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Yi()<=Et.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Xi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fs(t))):$.resolve())}ys(e,t){if(Vp(t))return $.resolve(null);let s=fs(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=xm(t,null,"F"),s=fs(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=ht(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,xm(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,s,r){return Vp(t)||r.isEqual(We.min())?$.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?$.resolve(null):(Yi()<=Et.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Xi(t)),this.vs(e,o,t,Yk(r,Va)).next(l=>l))})}Ds(e,t){let s=new Ft(db(e));return t.forEach((r,i)=>{Ka(e,i)&&(s=s.add(i))}),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return Yi()<=Et.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Xi(t)),this.ps.getDocumentsMatchingQuery(e,t,as.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="LocalStore",XV=3e8;class JV{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new tn(nt),this.xs=new ir(i=>ki(i),za),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Xb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Zb(n,e,t,s){return new JV(n,e,t,s)}async function eN(n,e){const t=st(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let u=ht();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(s,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function ZV(n,e){const t=st(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let y=$.resolve();return h.forEach(w=>{y=y.next(()=>d.getEntry(u,w)).next(v=>{const C=m.docVersions.get(w);Ue(C!==null,48541),v.version.compareTo(C)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=ht();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function tN(n){const e=st(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function eA(n,e){const t=st(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(_n.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(v,C,B){return v.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=XV?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(h,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=os(),m=ht();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(tA(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!s.isEqual(We.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(d)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function tA(n,e,t){let s=ht(),r=ht();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=os();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(We.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):pe(Cd,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function nA(n,e){const t=st(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=pi),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function sA(n,e){const t=st(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Pi.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):t.Pi.allocateTargetId(s).next(o=>(r=new Js(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function Cm(n,e,t){const s=st(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!zr(o))throw o;pe(Cd,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function sh(n,e,t){const s=st(n);let r=We.min(),i=ht();return s.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=st(u),h=f.xs.get(d);return h!==void 0?$.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(s,o,fs(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:We.min(),t?i:ht())).next(l=>(rA(s,OE(e),l),{documents:l,Qs:i})))}function rA(n,e,t){let s=n.Os.get(e)||We.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Os.set(e,s)}class rh{constructor(){this.activeTargetIds=GE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nN{constructor(){this.Mo=new rh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new rh,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="ConnectivityMonitor";class oh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(ih,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(ih,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yl=null;function wm(){return yl===null?yl=function(){return 268435456+Math.round(2147483648*Math.random())}():yl++,"0x"+yl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu="RestConnection",oA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aA{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===oc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=wm(),l=this.zo(e,t.toUriEncodedString());pe(Bu,`Sending RPC '${e}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=Tc(m);return this.Jo(e,l,u,s,d).then(f=>(pe(Bu,`Received RPC '${e}' ${o}: `,f),f),f=>{throw _i(Bu,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Eo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const s=oA[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="WebChannelConnection";class cA extends aA{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=wm();return new Promise((l,u)=>{const m=new Dy;m.setWithCredentials(!0),m.listenOnce(ky.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case jl.NO_ERROR:const f=m.getResponseJson();pe(Hn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case jl.TIMEOUT:pe(Hn,`RPC '${e}' ${o} timed out`),u(new xe(se.DEADLINE_EXCEEDED,"Request time out"));break;case jl.HTTP_ERROR:const h=m.getStatus();if(pe(Hn,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const v=function(B){const S=B.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(S)>=0?S:se.UNKNOWN}(w.status);u(new xe(v,w.message))}else u(new xe(se.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new xe(se.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{pe(Hn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);pe(Hn,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,s,15)})}T_(e,t,s){const r=wm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ay(),l=Vy(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,s),u.encodeInitMessageHeaders=!0;const d=i.join("");pe(Hn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,y=!1;const w=new lA({Yo:C=>{y?pe(Hn,`Not sending because RPC '${e}' stream ${r} is closed:`,C):(h||(pe(Hn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),pe(Hn,`RPC '${e}' stream ${r} sending:`,C),f.send(C))},Zo:()=>f.close()}),v=(C,B,S)=>{C.listen(B,F=>{try{S(F)}catch(re){setTimeout(()=>{throw re},0)}})};return v(f,sa.EventType.OPEN,()=>{y||(pe(Hn,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),v(f,sa.EventType.CLOSE,()=>{y||(y=!0,pe(Hn,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(f))}),v(f,sa.EventType.ERROR,C=>{y||(y=!0,_i(Hn,`RPC '${e}' stream ${r} transport errored. Name:`,C.name,"Message:",C.message),w.a_(new xe(se.UNAVAILABLE,"The operation could not be completed")))}),v(f,sa.EventType.MESSAGE,C=>{var B;if(!y){const S=C.data[0];Ue(!!S,16349);const F=S,re=(F==null?void 0:F.error)||((B=F[0])==null?void 0:B.error);if(re){pe(Hn,`RPC '${e}' stream ${r} received error:`,re);const ee=re.status;let M=function(A){const j=hn[A];if(j!==void 0)return kb(j)}(ee),V=re.message;M===void 0&&(M=se.INTERNAL,V="Unknown error status: "+ee+" with message "+re.message),y=!0,w.a_(new xe(M,V)),f.close()}else pe(Hn,`RPC '${e}' stream ${r} received:`,S),w.u_(S)}}),v(l,Ey.STAT_EVENT,C=>{C.stat===am.PROXY?pe(Hn,`RPC '${e}' stream ${r} detected buffering proxy`):C.stat===am.NOPROXY&&pe(Hn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(){return typeof window<"u"?window:null}function zl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(n){return new mV(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="PersistentStream";class rN{constructor(e,t,s,r,i,o,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(Gn(t.toString()),Gn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===t&&this.G_(s,r)},s=>{e(()=>{const r=new xe(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(ah,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(pe(ah,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mA extends rN{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=pV(this.serializer,e),s=function(i){if(!("targetChange"in i))return We.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?We.min():o.readTime?Xn(o.readTime):We.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Dm(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=ac(u)?{documents:Sb(i,u)}:{query:Pb(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Ab(i,o.resumeToken);const m=vm(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(We.min())>0){l.readTime=vo(i,o.snapshotVersion.toTimestamp());const m=vm(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const s=gV(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Dm(this.serializer),t.removeTarget=e,this.q_(t)}}class dA extends rN{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=hV(e.writeResults,e.commitTime),s=Xn(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Dm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>uc(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{}class pA extends fA{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new xe(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,_m(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new xe(se.UNKNOWN,i.toString())})}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,_m(t,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new xe(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class hA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gn(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="RemoteStore";class gA{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{Ti(this)&&(pe(Ci,"Restarting streams for network reachability change."),await async function(u){const m=st(u);m.Ea.add(4),await Qa(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Qc(m)}(this))})}),this.Ra=new hA(s,r)}}async function Qc(n){if(Ti(n))for(const e of n.da)await e(!0)}async function Qa(n){for(const e of n.da)await e(!1)}function iN(n,e){const t=st(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Sd(t)?Td(t):Co(t).O_()&&Id(t,e))}function wd(n,e){const t=st(n),s=Co(t);t.Ia.delete(e),s.O_()&&oN(t,e),t.Ia.size===0&&(s.O_()?s.L_():Ti(t)&&t.Ra.set("Unknown"))}function Id(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Co(n).Y_(e)}function oN(n,e){n.Va.Ue(e),Co(n).Z_(e)}function Td(n){n.Va=new aV({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Co(n).start(),n.Ra.ua()}function Sd(n){return Ti(n)&&!Co(n).x_()&&n.Ia.size>0}function Ti(n){return st(n).Ea.size===0}function aN(n){n.Va=void 0}async function yA(n){n.Ra.set("Online")}async function bA(n){n.Ia.forEach((e,t)=>{Id(n,e)})}async function NA(n,e){aN(n),Sd(n)?(n.Ra.ha(e),Td(n)):n.Ra.set("Unknown")}async function xA(n,e,t){if(n.Ra.set("Online"),e instanceof Vb&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(n,e)}catch(s){pe(Ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await hc(n,s)}else if(e instanceof ql?n.Va.Ze(e):e instanceof Eb?n.Va.st(e):n.Va.tt(e),!t.isEqual(We.min()))try{const s=await tN(n.localStore);t.compareTo(s)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(_n.EMPTY_BYTE_STRING,d.snapshotVersion)),oN(i,u);const f=new Js(d.target,u,m,d.sequenceNumber);Id(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(s){pe(Ci,"Failed to raise snapshot:",s),await hc(n,s)}}async function hc(n,e,t){if(!zr(e))throw e;n.Ea.add(1),await Qa(n),n.Ra.set("Offline"),t||(t=()=>tN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(Ci,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Qc(n)})}function lN(n,e){return e().catch(t=>hc(n,t,e))}async function Ya(n){const e=st(n),t=Hr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:pi;for(;vA(e);)try{const r=await nA(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,_A(e,r)}catch(r){await hc(e,r)}cN(e)&&uN(e)}function vA(n){return Ti(n)&&n.Ta.length<10}function _A(n,e){n.Ta.push(e);const t=Hr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function cN(n){return Ti(n)&&!Hr(n).x_()&&n.Ta.length>0}function uN(n){Hr(n).start()}async function DA(n){Hr(n).ra()}async function kA(n){const e=Hr(n);for(const t of n.Ta)e.ea(t.mutations)}async function EA(n,e,t){const s=n.Ta.shift(),r=bd.from(s,e,t);await lN(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Ya(n)}async function VA(n,e){e&&Hr(n).X_&&await async function(s,r){if(function(o){return rV(o)&&o!==se.ABORTED}(r.code)){const i=s.Ta.shift();Hr(s).B_(),await lN(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ya(s)}}(n,e),cN(n)&&uN(n)}async function lh(n,e){const t=st(n);t.asyncQueue.verifyOperationInProgress(),pe(Ci,"RemoteStore received new credentials");const s=Ti(t);t.Ea.add(3),await Qa(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Qc(t)}async function AA(n,e){const t=st(n);e?(t.Ea.delete(2),await Qc(t)):e||(t.Ea.add(2),await Qa(t),t.Ra.set("Unknown"))}function Co(n){return n.ma||(n.ma=function(t,s,r){const i=st(t);return i.sa(),new mA(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:yA.bind(null,n),t_:bA.bind(null,n),r_:NA.bind(null,n),H_:xA.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),Sd(n)?Td(n):n.Ra.set("Unknown")):(await n.ma.stop(),aN(n))})),n.ma}function Hr(n){return n.fa||(n.fa=function(t,s,r){const i=st(t);return i.sa(),new dA(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:DA.bind(null,n),r_:VA.bind(null,n),ta:kA.bind(null,n),na:EA.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Ya(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(Ci,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new Pd(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new xe(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ld(n,e){if(Gn("AsyncQueue",`${e}: ${n}`),zr(n))return new xe(se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{static emptySet(e){return new ao(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ee.comparator(t.key,s.key):(t,s)=>Ee.comparator(t.key,s.key),this.keyedMap=ra(),this.sortedSet=new tn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ao)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new ao;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(){this.ga=new tn(Ee.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class _o{constructor(e,t,s,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new _o(e,t,ao.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wA{constructor(){this.queries=uh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=st(t),i=r.queries;r.queries=uh(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new xe(se.ABORTED,"Firestore shutting down"))}}function uh(){return new ir(n=>mb(n),Mc)}async function jd(n,e){const t=st(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new CA,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Ld(o,`Initialization of query '${Xi(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Bd(t)}async function Rd(n,e){const t=st(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function IA(n,e){const t=st(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&Bd(t)}function TA(n,e,t){const s=st(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function Bd(n){n.Ca.forEach(e=>{e.next()})}var Im,mh;(mh=Im||(Im={})).Ma="default",mh.Cache="cache";class Ud{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new _o(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Im.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.key=e}}class dN{constructor(e){this.key=e}}class SA{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ht(),this.mutatedKeys=ht(),this.eu=db(e),this.tu=new ao(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new ch,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=Ka(this.query,f)?f:null,w=!!h&&this.mutatedKeys.has(h.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let C=!1;h&&y?h.data.isEqual(y.data)?w!==v&&(s.track({type:3,doc:y}),C=!0):this.su(h,y)||(s.track({type:2,doc:y}),C=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!h&&y?(s.track({type:0,doc:y}),C=!0):h&&!y&&(s.track({type:1,doc:h}),C=!0,(u||m)&&(l=!0)),C&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,w){const v=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:C})}};return v(y)-v(w)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new _o(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ch,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ht(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new dN(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new mN(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=ht();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _o.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Hd="SyncEngine";class PA{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class LA{constructor(e){this.key=e,this.hu=!1}}class jA{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ir(l=>mb(l),Mc),this.Iu=new Map,this.Eu=new Set,this.du=new tn(Ee.comparator),this.Au=new Map,this.Ru=new kd,this.Vu={},this.mu=new Map,this.fu=Ai.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function RA(n,e,t=!0){const s=bN(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await fN(s,e,t,!0),r}async function BA(n,e){const t=bN(n);await fN(t,e,!0,!1)}async function fN(n,e,t,s){const r=await sA(n.localStore,fs(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await UA(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&iN(n.remoteStore,r),l}async function UA(n,e,t,s,r){n.pu=(f,h,y)=>async function(v,C,B,S){let F=C.view.ru(B);F.Cs&&(F=await sh(v.localStore,C.query,!1).then(({documents:V})=>C.view.ru(V,F)));const re=S&&S.targetChanges.get(C.targetId),ee=S&&S.targetMismatches.get(C.targetId)!=null,M=C.view.applyChanges(F,v.isPrimaryClient,re,ee);return fh(v,C.targetId,M.au),M.snapshot}(n,f,h,y);const i=await sh(n.localStore,e,!0),o=new SA(e,i.Qs),l=o.ru(i.documents),u=Ga.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),m=o.applyChanges(l,n.isPrimaryClient,u);fh(n,t,m.au);const d=new PA(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function HA(n,e,t){const s=st(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!Mc(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Cm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&wd(s.remoteStore,r.targetId),Tm(s,r.targetId)}).catch(Ii)):(Tm(s,r.targetId),await Cm(s.localStore,r.targetId,!0))}async function MA(n,e){const t=st(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),wd(t.remoteStore,s.targetId))}async function FA(n,e,t){const s=NN(n);try{const r=await function(o,l){const u=st(o),m=Lt.now(),d=l.reduce((y,w)=>y.add(w.key),ht());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let w=os(),v=ht();return u.Ns.getEntries(y,d).next(C=>{w=C,w.forEach((B,S)=>{S.isValidDocument()||(v=v.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,w)).next(C=>{f=C;const B=[];for(const S of l){const F=nV(S,f.get(S.key).overlayedDocument);F!=null&&B.push(new or(S.key,F,nb(F.value.mapValue),qn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,B,l)}).next(C=>{h=C;const B=C.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,C.batchId,B)})}).then(()=>({batchId:h.batchId,changes:pb(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new tn(nt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(s,r.batchId,t),await Xa(s,r.changes),await Ya(s.remoteStore)}catch(r){const i=Ld(r,"Failed to persist write");t.reject(i)}}async function pN(n,e){const t=st(n);try{const s=await eA(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Ue(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ue(o.hu,14607):r.removedDocuments.size>0&&(Ue(o.hu,42227),o.hu=!1))}),await Xa(t,s,e)}catch(s){await Ii(s)}}function dh(n,e,t){const s=st(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=st(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Bd(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function OA(n,e,t){const s=st(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new tn(Ee.comparator);o=o.insert(i,ln.newNoDocument(i,We.min()));const l=ht().add(i),u=new $c(We.min(),new Map,new tn(nt),o,l);await pN(s,u),s.du=s.du.remove(i),s.Au.delete(e),Md(s)}else await Cm(s.localStore,e,!1).then(()=>Tm(s,e,t)).catch(Ii)}async function qA(n,e){const t=st(n),s=e.batch.batchId;try{const r=await ZV(t.localStore,e);gN(t,s,null),hN(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Xa(t,r)}catch(r){await Ii(r)}}async function $A(n,e,t){const s=st(n);try{const r=await function(o,l){const u=st(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Ue(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(s.localStore,e);gN(s,e,t),hN(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Xa(s,r)}catch(r){await Ii(r)}}function hN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function gN(n,e,t){const s=st(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Tm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||yN(n,s)})}function yN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(wd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Md(n))}function fh(n,e,t){for(const s of t)s instanceof mN?(n.Ru.addReference(s.key,e),zA(n,s)):s instanceof dN?(pe(Hd,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||yN(n,s.key)):Te(19791,{wu:s})}function zA(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(pe(Hd,"New document in limbo: "+t),n.Eu.add(s),Md(n))}function Md(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ee(Pt.fromString(e)),s=n.fu.next();n.Au.set(s,new LA(t)),n.du=n.du.insert(t,s),iN(n.remoteStore,new Js(fs(Wa(t.path)),s,"TargetPurposeLimboResolution",ds.ce))}}async function Xa(n,e,t){const s=st(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{o.push(s.pu(u,e,t).then(m=>{var d;if((m||t)&&s.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=Ad.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(u,m){const d=st(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(m,h=>$.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>$.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!zr(f))throw f;pe(Cd,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),w=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(h,v)}}}(s.localStore,i))}async function WA(n,e){const t=st(n);if(!t.currentUser.isEqual(e)){pe(Hd,"User change. New user:",e.toKey());const s=await eN(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new xe(se.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Xa(t,s.Ls)}}function KA(n,e){const t=st(n),s=t.Au.get(e);if(s&&s.hu)return ht().add(s.key);{let r=ht();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function bN(n){const e=st(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OA.bind(null,e),e.Pu.H_=IA.bind(null,e.eventManager),e.Pu.yu=TA.bind(null,e.eventManager),e}function NN(n){const e=st(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$A.bind(null,e),e}class Ha{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Zb(this.persistence,new Jb,e.initialUser,this.serializer)}Cu(e){return new Ed(Kc.mi,this.serializer)}Du(e){return new nN}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ha.provider={build:()=>new Ha};class GA extends Ha{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ue(this.persistence.referenceDelegate instanceof pc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Kb(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new Ed(s=>pc.mi(s,t),this.serializer)}}class QA extends Ha{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await NN(this.xu.syncEngine),await Ya(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Zb(this.persistence,new Jb,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new Kb(s,e.asyncQueue,t)}Mu(e,t){const s=new eE(t,this.persistence);return new Zk(e.asyncQueue,s)}Cu(e){const t=QV(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new Vd(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,uA(),zl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new nN}}class gc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>dh(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=WA.bind(null,this.syncEngine),await AA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wA}()}createDatastore(e){const t=Gc(e.databaseInfo.databaseId),s=function(i){return new cA(i)}(e.databaseInfo);return function(i,o,l,u){return new pA(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,l){return new gA(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>dh(this.syncEngine,t,0),function(){return oh.v()?new oh:new iA}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new jA(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=st(r);pe(Ci,"RemoteStore shutting down."),i.Ea.add(5),await Qa(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}gc.provider={build:()=>new gc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class YA{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=jn.UNAUTHENTICATED,this.clientId=id.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{pe(Mr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(pe(Mr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ld(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Uu(n,e){n.asyncQueue.verifyOperationInProgress(),pe(Mr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await eN(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ph(n,e){n.asyncQueue.verifyOperationInProgress();const t=await XA(n);pe(Mr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>lh(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>lh(e.remoteStore,r)),n._onlineComponents=e}async function XA(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(Mr,"Using user provided OfflineComponentProvider");try{await Uu(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;_i("Error using user provided cache. Falling back to memory cache: "+t),await Uu(n,new Ha)}}else pe(Mr,"Using default OfflineComponentProvider"),await Uu(n,new GA(void 0));return n._offlineComponents}async function xN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(Mr,"Using user provided OnlineComponentProvider"),await ph(n,n._uninitializedComponentsProvider._online)):(pe(Mr,"Using default OnlineComponentProvider"),await ph(n,new gc))),n._onlineComponents}function JA(n){return xN(n).then(e=>e.syncEngine)}async function yc(n){const e=await xN(n),t=e.eventManager;return t.onListen=RA.bind(null,e.syncEngine),t.onUnlisten=HA.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=BA.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=MA.bind(null,e.syncEngine),t}function ZA(n,e,t={}){const s=new Hs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Fd({next:h=>{d.Nu(),o.enqueueAndForget(()=>Rd(i,f));const y=h.docs.has(l);!y&&h.fromCache?m.reject(new xe(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&u&&u.source==="server"?m.reject(new xe(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Ud(Wa(l.path),d,{includeMetadataChanges:!0,qa:!0});return jd(i,f)}(await yc(n),n.asyncQueue,e,t,s)),s.promise}function e1(n,e,t={}){const s=new Hs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new Fd({next:h=>{d.Nu(),o.enqueueAndForget(()=>Rd(i,f)),h.fromCache&&u.source==="server"?m.reject(new xe(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Ud(l,d,{includeMetadataChanges:!0,qa:!0});return jd(i,f)}(await yc(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N="firestore.googleapis.com",gh=!0;class yh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new xe(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_N,this.ssl=gh}else this.host=e.host,this.ssl=e.ssl??gh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SV)throw new xe(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vN(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yc{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xe(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new xe(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new Hk;switch(s.type){case"firstParty":return new qk(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new xe(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=hh.get(t);s&&(pe("ComponentProvider","Removing Datastore"),hh.delete(t),s.terminate())}(this),Promise.resolve()}}function t1(n,e,t,s={}){var m;n=Yn(n,Yc);const r=Tc(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(ry(`https://${l}`),oy("Firestore",!0)),i.host!==_N&&i.host!==l&&_i("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:s};if(!ec(u,o)&&(n._setSettings(u),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=jn.MOCK_USER;else{d=iy(s.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const h=s.mockUserToken.sub||s.mockUserToken.user_id;if(!h)throw new xe(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new jn(h)}n._authCredentials=new Mk(new wy(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Kr(this.firestore,e,this._query)}}class cn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cn(this.firestore,e,this._key)}toJSON(){return{type:cn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(qa(t,cn._jsonSchema))return new cn(e,s||null,new Ee(Pt.fromString(t.referencePath)))}}cn._jsonSchemaVersion="firestore/documentReference/1.0",cn._jsonSchema={type:xn("string",cn._jsonSchemaVersion),referencePath:xn("string")};class jr extends Kr{constructor(e,t,s){super(e,t,Wa(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cn(this.firestore,null,new Ee(e))}withConverter(e){return new jr(this.firestore,e,this._path)}}function Qn(n,e,...t){if(n=As(n),Ty("collection","path",e),n instanceof Yc){const s=Pt.fromString(e,...t);return ap(s),new jr(n,null,s)}{if(!(n instanceof cn||n instanceof jr))throw new xe(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Pt.fromString(e,...t));return ap(s),new jr(n.firestore,null,s)}}function Bn(n,e,...t){if(n=As(n),arguments.length===1&&(e=id.newId()),Ty("doc","path",e),n instanceof Yc){const s=Pt.fromString(e,...t);return op(s),new cn(n,null,new Ee(s))}{if(!(n instanceof cn||n instanceof jr))throw new xe(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Pt.fromString(e,...t));return op(s),new cn(n.firestore,n instanceof jr?n.converter:null,new Ee(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="AsyncQueue";class Nh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sN(this,"async_queue_retry"),this._c=()=>{const s=zl();s&&pe(bh,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=zl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=zl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Hs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!zr(e))throw e;pe(bh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Gn("INTERNAL UNHANDLED ERROR: ",xh(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Pd.createAndSchedule(this,e,t,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Te(47125,{Pc:xh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class $s extends Yc{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new Nh,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nh(e),this._firestoreClient=void 0,await e}}}function n1(n,e){const t=typeof n=="object"?n:Ny(),s=typeof n=="string"?n:oc,r=hy(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=ny("firestore");i&&t1(r,...i)}return r}function Xc(n){if(n._terminated)throw new xe(se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||DN(n),n._firestoreClient}function DN(n){var s,r,i;const e=n._freezeSettings(),t=function(l,u,m,d){return new wE(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,vN(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new YA(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(n._componentsProvider))}function s1(n,e){_i("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return r1(n,gc.provider,{build:s=>new QA(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function r1(n,e,t){if((n=Yn(n,$s))._firestoreClient||n._terminated)throw new xe(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new xe(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},DN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(_n.fromBase64String(e))}catch(t){throw new xe(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ms(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ms._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qa(e,ms._jsonSchema))return ms.fromBase64String(e.bytes)}}ms._jsonSchemaVersion="firestore/bytes/1.0",ms._jsonSchema={type:xn("string",ms._jsonSchemaVersion),bytes:xn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new xe(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new on(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xe(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xe(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nt(this._lat,e._lat)||nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ms._jsonSchemaVersion}}static fromJSON(e){if(qa(e,Ms._jsonSchema))return new Ms(e.latitude,e.longitude)}}Ms._jsonSchemaVersion="firestore/geoPoint/1.0",Ms._jsonSchema={type:xn("string",Ms._jsonSchemaVersion),latitude:xn("number"),longitude:xn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qa(e,Fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Fs(e.vectorValues);throw new xe(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fs._jsonSchemaVersion="firestore/vectorValue/1.0",Fs._jsonSchema={type:xn("string",Fs._jsonSchemaVersion),vectorValues:xn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1=/^__.*__$/;class o1{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new or(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ao(e,this.data,t,this.fieldTransforms)}}class kN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new or(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function EN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:n})}}class qd{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return bc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(EN(this.Ac)&&i1.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class a1{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Gc(e)}Cc(e,t,s,r=!1){return new qd({Ac:e,methodName:t,Dc:s,path:on.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zc(n){const e=n._freezeSettings(),t=Gc(n._databaseId);return new a1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function VN(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);$d("Data must be an object, but it was:",o,s);const l=AN(s,o);let u,m;if(i.merge)u=new ns(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=Sm(e,f,t);if(!o.contains(h))throw new xe(se.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);wN(d,h)||d.push(h)}u=new ns(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new o1(new On(l),u,m)}class eu extends Od{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof eu}}function l1(n,e,t,s){const r=n.Cc(1,e,t);$d("Data must be an object, but it was:",r,s);const i=[],o=On.empty();Wr(s,(u,m)=>{const d=zd(e,u,t);m=As(m);const f=r.yc(d);if(m instanceof eu)i.push(d);else{const h=Ja(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new ns(i);return new kN(o,l,r.fieldTransforms)}function c1(n,e,t,s,r,i){const o=n.Cc(1,e,t),l=[Sm(e,s,t)],u=[r];if(i.length%2!=0)throw new xe(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Sm(e,i[h])),u.push(i[h+1]);const m=[],d=On.empty();for(let h=l.length-1;h>=0;--h)if(!wN(m,l[h])){const y=l[h];let w=u[h];w=As(w);const v=o.yc(y);if(w instanceof eu)m.push(y);else{const C=Ja(w,v);C!=null&&(m.push(y),d.set(y,C))}}const f=new ns(m);return new kN(d,f,o.fieldTransforms)}function u1(n,e,t,s=!1){return Ja(t,n.Cc(s?4:3,e))}function Ja(n,e){if(CN(n=As(n)))return $d("Unsupported field value:",e,n),AN(n,e);if(n instanceof Od)return function(s,r){if(!EN(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let u=Ja(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=As(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return QE(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Lt.fromDate(s);return{timestampValue:vo(r.serializer,i)}}if(s instanceof Lt){const i=new Lt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:vo(r.serializer,i)}}if(s instanceof Ms)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ms)return{bytesValue:Ab(r.serializer,s._byteString)};if(s instanceof cn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:vd(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Fs)return function(o,l){return{mapValue:{fields:{[fd]:{stringValue:pd},[ho]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return gd(l.serializer,m)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${Sc(s)}`)}(n,e)}function AN(n,e){const t={};return Ky(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wr(n,(s,r)=>{const i=Ja(r,e.mc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function CN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Lt||n instanceof Ms||n instanceof ms||n instanceof cn||n instanceof Od||n instanceof Fs)}function $d(n,e,t){if(!CN(t)||!Sy(t)){const s=Sc(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Sm(n,e,t){if((e=As(e))instanceof Jc)return e._internalPath;if(typeof e=="string")return zd(n,e);throw bc("Field path arguments must be of type string or ",n,!1,void 0,t)}const m1=new RegExp("[~\\*/\\[\\]]");function zd(n,e,t){if(e.search(m1)>=0)throw bc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Jc(...e.split("."))._internalPath}catch{throw bc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function bc(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new xe(se.INVALID_ARGUMENT,l+n+u)}function wN(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new cn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new d1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class d1 extends IN{data(){return super.data()}}function tu(n,e){return typeof e=="string"?zd(n,e):e instanceof Jc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new xe(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wd{}class SN extends Wd{}function Zs(n,e,...t){let s=[];e instanceof Wd&&s.push(e),s=s.concat(t),function(i){const o=i.filter(u=>u instanceof Kd).length,l=i.filter(u=>u instanceof nu).length;if(o>1||o>0&&l>0)throw new xe(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class nu extends SN{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new nu(e,t,s)}_apply(e){const t=this._parse(e);return PN(e._query,t),new Kr(e.firestore,e.converter,Nm(e._query,t))}_parse(e){const t=Zc(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new xe(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Dh(f,d);const w=[];for(const v of f)w.push(_h(u,i,v));h={arrayValue:{values:w}}}else h=_h(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Dh(f,d),h=u1(l,o,f,d==="in"||d==="not-in");return Nt.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Pm(n,e,t){const s=e,r=tu("where",n);return nu._create(r,s,t)}class Kd extends Wd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Kd(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Mt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)PN(o,u),o=Nm(o,u)}(e._query,t),new Kr(e.firestore,e.converter,Nm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gd extends SN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Gd(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new xe(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new xe(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ra(i,o)}(e._query,this._field,this._direction);return new Kr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Vo(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Rr(n,e="asc"){const t=e,s=tu("orderBy",n);return Gd._create(s,t)}function _h(n,e,t){if(typeof(t=As(t))=="string"){if(t==="")throw new xe(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ub(e)&&t.indexOf("/")!==-1)throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Pt.fromString(t));if(!Ee.isDocumentKey(s))throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return La(n,new Ee(s))}if(t instanceof cn)return La(n,t._key);throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sc(t)}.`)}function Dh(n,e){if(!Array.isArray(n)||n.length===0)throw new xe(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PN(n,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new xe(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new xe(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class f1{convertValue(e,t="none"){switch(Br(e)){case 0:return null;case 1:return e.booleanValue;case 2:return en(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(rr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Wr(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var s,r,i;const t=(i=(r=(s=e.fields)==null?void 0:s[ho].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>en(o.doubleValue));return new Fs(t)}convertGeoPoint(e){return new Ms(en(e.latitude),en(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Uc(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Sa(e));default:return null}}convertTimestamp(e){const t=sr(e);return new Lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Pt.fromString(e);Ue(Bb(s),9688,{name:e});const r=new Di(s.get(1),s.get(3)),i=new Ee(s.popFirst(5));return r.isEqual(t)||Gn(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(n,e,t){let s;return s=n?n.toFirestore(e):e,s}class aa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yi extends IN{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(tu("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=yi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}yi._jsonSchemaVersion="firestore/documentSnapshot/1.0",yi._jsonSchema={type:xn("string",yi._jsonSchemaVersion),bundleSource:xn("string","DocumentSnapshot"),bundleName:xn("string"),bundle:xn("string")};class Wl extends yi{data(e={}){return super.data(e)}}class bi{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new aa(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Wl(this._firestore,this._userDataWriter,s.key,s,new aa(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new xe(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new Wl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new aa(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Wl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new aa(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:p1(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=bi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=id.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function p1(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(n){n=Yn(n,cn);const e=Yn(n.firestore,$s);return ZA(Xc(e),n._key).then(t=>jN(e,n,t))}bi._jsonSchemaVersion="firestore/querySnapshot/1.0",bi._jsonSchema={type:xn("string",bi._jsonSchemaVersion),bundleSource:xn("string","QuerySnapshot"),bundleName:xn("string"),bundle:xn("string")};class Yd extends f1{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cn(this.firestore,null,t)}}function Es(n){n=Yn(n,Kr);const e=Yn(n.firestore,$s),t=Xc(e),s=new Yd(e);return TN(n._query),e1(t,n._query).then(r=>new bi(e,s,n,r))}function Xd(n,e,t){n=Yn(n,cn);const s=Yn(n.firestore,$s),r=LN(n.converter,e);return su(s,[VN(Zc(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,qn.none())])}function so(n,e,t,...s){n=Yn(n,cn);const r=Yn(n.firestore,$s),i=Zc(r);let o;return o=typeof(e=As(e))=="string"||e instanceof Jc?c1(i,"updateDoc",n._key,e,t,s):l1(i,"updateDoc",n._key,e),su(r,[o.toMutation(n._key,qn.exists(!0))])}function Jd(n){return su(Yn(n.firestore,$s),[new qc(n._key,qn.none())])}function h1(n,e){const t=Yn(n.firestore,$s),s=Bn(n),r=LN(n.converter,e);return su(t,[VN(Zc(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,qn.exists(!1))]).then(()=>s)}function Nc(n,...e){var u,m,d;n=As(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||vh(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(vh(e[s])){const f=e[s];e[s]=(u=f.next)==null?void 0:u.bind(f),e[s+1]=(m=f.error)==null?void 0:m.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(n instanceof cn)o=Yn(n.firestore,$s),l=Wa(n._key.path),i={next:f=>{e[s]&&e[s](jN(o,n,f))},error:e[s+1],complete:e[s+2]};else{const f=Yn(n,Kr);o=Yn(f.firestore,$s),l=f._query;const h=new Yd(o);i={next:y=>{e[s]&&e[s](new bi(o,h,f,y))},error:e[s+1],complete:e[s+2]},TN(n._query)}return function(h,y,w,v){const C=new Fd(v),B=new Ud(y,C,w);return h.asyncQueue.enqueueAndForget(async()=>jd(await yc(h),B)),()=>{C.Nu(),h.asyncQueue.enqueueAndForget(async()=>Rd(await yc(h),B))}}(Xc(o),l,r,i)}function su(n,e){return function(s,r){const i=new Hs;return s.asyncQueue.enqueueAndForget(async()=>FA(await JA(s),r,i)),i.promise}(Xc(n),e)}function jN(n,e,t){const s=t.docs.get(e._key),r=new Yd(n);return new yi(n,r,e._key,s,new aa(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){Eo=r})(yy),ka(new lo("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new $s(new Fk(s.getProvider("auth-internal")),new $k(o,s.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new xe(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Di(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Sr(np,sp,e),Sr(np,sp,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN="firebasestorage.googleapis.com",g1="storageBucket",y1=2*60*1e3,b1=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks extends wi{constructor(e,t,s=0){super(Hu(e),`Firebase Storage: ${t} (${Hu(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ks.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hu(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(zs||(zs={}));function Hu(n){return"storage/"+n}function N1(){const n="An unknown error occurred, please check the error payload for server response.";return new Ks(zs.UNKNOWN,n)}function x1(){return new Ks(zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function v1(){return new Ks(zs.CANCELED,"User canceled the upload/download.")}function _1(n){return new Ks(zs.INVALID_URL,"Invalid URL '"+n+"'.")}function D1(n){return new Ks(zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function kh(n){return new Ks(zs.INVALID_ARGUMENT,n)}function BN(){return new Ks(zs.APP_DELETED,"The Firebase app was deleted.")}function k1(n){return new Ks(zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Vs.makeFromUrl(e,t)}catch{return new Vs(e,"")}if(s.path==="")return s;throw D1(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(re){re.path_=decodeURIComponent(re.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),w={bucket:1,path:3},v=t===RN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,C="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${C}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:y,indices:w,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let re=0;re<F.length;re++){const ee=F[re],M=ee.regex.exec(e);if(M){const V=M[ee.indices.bucket];let N=M[ee.indices.path];N||(N=""),s=new Vs(V,N),ee.postModify(s);break}}if(s==null)throw _1(e);return s}}class E1{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n,e,t){let s=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...C){m||(m=!0,e.apply(null,C))}function f(C){r=setTimeout(()=>{r=null,n(y,u())},C)}function h(){i&&clearTimeout(i)}function y(C,...B){if(m){h();return}if(C){h(),d.call(null,C,...B);return}if(u()||o){h(),d.call(null,C,...B);return}s<64&&(s*=2);let F;l===1?(l=2,F=0):F=(s+Math.random())*1e3,f(F)}let w=!1;function v(C){w||(w=!0,h(),!m&&(r!==null?(C||(l=2),clearTimeout(r),f(0)):C||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function A1(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(n){return n!==void 0}function Eh(n,e,t,s){if(s<e)throw kh(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw kh(`Invalid value for '${n}'. Expected ${t} or less.`)}function w1(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var xc;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(xc||(xc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,t,s,r,i,o,l,u,m,d,f,h=!0,y=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,v)=>{this.resolve_=w,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new bl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===xc.NO_ERROR,u=i.getStatus();if(!l||I1(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===xc.ABORT;s(!1,new bl(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;s(!0,new bl(m,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());C1(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=N1();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?BN():v1();o(u)}else{const u=x1();o(u)}};this.canceled_?t(!1,new bl(!1,null,!0)):this.backoffId_=V1(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&A1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class bl{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function S1(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function P1(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function L1(n,e){e&&(n["X-Firebase-GMPID"]=e)}function j1(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function R1(n,e,t,s,r,i,o=!0,l=!1){const u=w1(n.urlParams),m=n.url+u,d=Object.assign({},n.headers);return L1(d,e),S1(d,t),P1(d,i),j1(d,s),new T1(m,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function U1(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,t){this._service=e,t instanceof Vs?this._location=t:this._location=Vs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new vc(e,t)}get root(){const e=new Vs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return U1(this._location.path)}get storage(){return this._service}get parent(){const e=B1(this._location.path);if(e===null)return null;const t=new Vs(this._location.bucket,e);return new vc(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw k1(e)}}function Vh(n,e){const t=e==null?void 0:e[g1];return t==null?null:Vs.makeFromBucketSpec(t,n)}function H1(n,e,t,s={}){n.host=`${e}:${t}`;const r=Tc(e);r&&(ry(`https://${n.host}/b`),oy("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:iy(i,n.app.options.projectId))}class M1{constructor(e,t,s,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=RN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=y1,this._maxUploadRetryTime=b1,this._requests=new Set,r!=null?this._bucket=Vs.makeFromBucketSpec(r,this._host):this._bucket=Vh(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vs.makeFromBucketSpec(this._url,e):this._bucket=Vh(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Eh("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Eh("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(gy(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new vc(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new E1(BN());{const o=R1(e,this._appId,s,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const Ah="@firebase/storage",Ch="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="storage";function F1(n=Ny(),e){n=As(n);const s=hy(n,UN).getImmediate({identifier:e}),r=ny("storage");return r&&O1(s,...r),s}function O1(n,e,t,s={}){H1(n,e,t,s)}function q1(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new M1(t,s,r,e,yy)}function $1(){ka(new lo(UN,q1,"PUBLIC").setMultipleInstances(!0)),Sr(Ah,Ch,""),Sr(Ah,Ch,"esm2020")}$1();const z1={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},HN=by(z1),Tt=n1(HN);F1(HN);s1(Tt).catch(n=>{n.code==="failed-precondition"?console.warn(" :     "):n.code==="unimplemented"&&console.warn(" :   ")});const Bt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function II(n,e){const t=Qn(Tt,n);return(await h1(t,{...e,createdAt:Lt.now(),updatedAt:Lt.now()})).id}let Ni=new Map,to=null;async function br(){if(!(Ni.size>0))return to||(to=(async()=>{try{const n=Qn(Tt,Bt.PROJECTS);(await Es(n)).docs.forEach(t=>{const s=t.data();Ni.set(t.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",Ni.size,"")}catch(n){throw console.error("[paymentFirestoreService]    :",n),to=null,n}})(),to)}function Wo(n){const e=Ni.get(String(n.projectId))||{name:"",color:"#4A90E2"};return!e.name&&n.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:n.id,projectId:n.projectId,cacheSize:Ni.size,cacheKeys:Array.from(Ni.keys()).slice(0,5),vendorName:n.vendorName}),{id:n.id,project_id:n.projectId,project_name:e.name,project_color:e.color,user_id:n.userId||0,requester_name:"",approved_by:n.approvedBy||void 0,request_type:n.requestType||"material",vendor_name:n.vendorName||"",description:n.description||"",amount:n.amount||0,account_holder:n.accountHolder||"",bank_name:n.bankName||"",account_number:n.accountNumber||"",item_name:n.itemName||"",material_amount:n.materialAmount||0,labor_amount:n.laborAmount||0,original_material_amount:n.originalMaterialAmount||0,original_labor_amount:n.originalLaborAmount||0,apply_tax_deduction:n.applyTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,quick_text:n.quickText||"",images:n.images?JSON.stringify(n.images):"[]",notes:n.notes||"",status:n.status||"pending",created_at:n.createdAt||"",updated_at:n.updatedAt||"",paid_at:n.paidAt||void 0}}function wh(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.request_type!==void 0&&(e.requestType=n.request_type),n.category!==void 0&&(e.requestType=n.category),n.vendor_name!==void 0&&(e.vendorName=n.vendor_name),n.process!==void 0&&(e.vendorName=n.process),n.description!==void 0&&(e.description=n.description),n.purpose!==void 0&&(e.description=n.purpose),n.amount!==void 0&&(e.amount=n.amount),n.account_holder!==void 0&&(e.accountHolder=n.account_holder),n.bank_name!==void 0&&(e.bankName=n.bank_name),n.account_number!==void 0&&(e.accountNumber=n.account_number),n.notes!==void 0&&(e.notes=n.notes),n.itemName!==void 0&&(e.itemName=n.itemName),n.item_name!==void 0&&(e.itemName=n.item_name),n.materialAmount!==void 0&&(e.materialAmount=n.materialAmount),n.laborAmount!==void 0&&(e.laborAmount=n.laborAmount),n.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=n.originalMaterialAmount),n.originalLaborAmount!==void 0&&(e.originalLaborAmount=n.originalLaborAmount),n.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=n.applyTaxDeduction),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),n.quickText!==void 0&&(e.quickText=n.quickText),n.images!==void 0&&(e.images=Array.isArray(n.images)?n.images:[]),n.status!==void 0&&(e.status=n.status),e}const Zn={getAllPayments:async()=>{await br();const n=Qn(Tt,Bt.PAYMENTS),e=Zs(n,Rr("id","desc"));return(await Es(e)).docs.map(s=>{const r=s.data();return Wo({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async n=>{await br();const e=Bn(Tt,Bt.PAYMENTS,n),t=await Qd(e);if(t.exists()){const s=t.data();return Wo({...s,id:parseInt(t.id)||s.id})}return null},createPayment:async n=>{var m;await br();const e=Qn(Tt,Bt.PAYMENTS),t=await Es(e);let s=0;t.docs.forEach(d=>{const f=parseInt(d.id);!isNaN(f)&&f>s&&(s=f)});const r=s+1,i=wh(n),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:i.images||[],imageCount:((m=i.images)==null?void 0:m.length)||0},u=Bn(Tt,Bt.PAYMENTS,String(r));return await Xd(u,l),Wo(l)},updatePayment:async(n,e)=>{await br();const t=Bn(Tt,Bt.PAYMENTS,n),s=wh(e);await so(t,{...s,updatedAt:new Date().toISOString()});const r=await Zn.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(n,e)=>{await br();const t=Bn(Tt,Bt.PAYMENTS,n),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await so(t,r);const i=await Zn.getPaymentById(n);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(n,e,t)=>{await br();const s=Bn(Tt,Bt.PAYMENTS,n);await so(s,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await Zn.getPaymentById(n);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(n,e)=>{const t=Bn(Tt,Bt.PAYMENTS,n);return await so(t,{images:e,imageCount:e.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:e}},deletePayment:async n=>{const e=Bn(Tt,Bt.PAYMENTS,n);await Jd(e)},subscribeToPayments:n=>{let e=null;return br().then(()=>{const t=Qn(Tt,Bt.PAYMENTS),s=Zs(t,Rr("id","desc"));e=Nc(s,r=>{const i=r.docs.map(o=>{const l=o.data();return Wo({...l,id:parseInt(o.id)||l.id})});n(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async n=>{await br();const e=Qn(Tt,Bt.PAYMENTS),t=Zs(e,Pm("projectId","==",n),Rr("id","desc"));return(await Es(t)).docs.map(r=>{const i=r.data();return Wo({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{Ni.clear(),to=null}},W1=!0,Sn=()=>W1,Nr={getAllPayments:async()=>(await Ce.get("/payments")).data,getPaymentById:async n=>(await Ce.get(`/payments/${n}`)).data,createPayment:async n=>{var s,r,i;const e={project_id:n.projectId,request_type:n.category,vendor_name:n.process||"",description:n.purpose||"",amount:n.amount,account_holder:((s=n.bankInfo)==null?void 0:s.accountHolder)||"",bank_name:((r=n.bankInfo)==null?void 0:r.bankName)||"",account_number:((i=n.bankInfo)==null?void 0:i.accountNumber)||"",notes:n.notes||"",itemName:n.itemName||"",materialAmount:n.materialAmount??n.amount,laborAmount:n.laborAmount??0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};return console.log("[paymentService.createPayment] Sending to backend:",e),(await Ce.post("/payments",e)).data},updatePayment:async(n,e)=>{const t={};return e.projectId!==void 0&&(t.project=e.projectId),e.purpose!==void 0&&(t.description=e.purpose),e.amount!==void 0&&(t.amount=e.amount),e.process!==void 0&&(t.vendor_name=e.process),e.category!==void 0&&(t.request_type=e.category),e.itemName!==void 0&&(t.itemName=e.itemName),e.materialAmount!==void 0&&(t.materialAmount=e.materialAmount),e.laborAmount!==void 0&&(t.laborAmount=e.laborAmount),e.originalMaterialAmount!==void 0&&(t.originalMaterialAmount=e.originalMaterialAmount),e.originalLaborAmount!==void 0&&(t.originalLaborAmount=e.originalLaborAmount),e.applyTaxDeduction!==void 0&&(t.applyTaxDeduction=e.applyTaxDeduction),e.includesVAT!==void 0&&(t.includesVAT=e.includesVAT),e.notes!==void 0&&(t.notes=e.notes),e.requestDate!==void 0&&(t.requestDate=e.requestDate),e.bankInfo!==void 0&&(e.bankInfo.accountHolder&&(t.account_holder=e.bankInfo.accountHolder),e.bankInfo.bankName&&(t.bank_name=e.bankInfo.bankName),e.bankInfo.accountNumber&&(t.account_number=e.bankInfo.accountNumber)),(await Ce.put(`/payments/${n}`,t)).data},updatePaymentStatus:async(n,e)=>(await Ce.put(`/payments/${n}/status`,{status:e})).data,updatePaymentAmounts:async(n,e,t)=>(await Ce.patch(`/payments/${n}/amounts`,{materialAmount:e,laborAmount:t})).data,updatePaymentImages:async(n,e)=>(await Ce.put(`/payments/${n}/images`,{images:e})).data,deletePayment:async n=>{await Ce.delete(`/payments/${n}`)}},vs={getAllPayments:async()=>Sn()?(console.log("[paymentService] Using Firestore"),Zn.getAllPayments()):(console.log("[paymentService] Using Railway API"),Nr.getAllPayments()),getPaymentById:async n=>{if(Sn()){const e=await Zn.getPaymentById(n);if(!e)throw new Error("Payment not found");return e}return Nr.getPaymentById(n)},createPayment:async n=>Sn()?Zn.createPayment(n):Nr.createPayment(n),updatePayment:async(n,e)=>Sn()?Zn.updatePayment(n,e):Nr.updatePayment(n,e),updatePaymentStatus:async(n,e)=>Sn()?Zn.updatePaymentStatus(n,e):Nr.updatePaymentStatus(n,e),updatePaymentAmounts:async(n,e,t)=>Sn()?Zn.updatePaymentAmounts(n,e,t):Nr.updatePaymentAmounts(n,e,t),updatePaymentImages:async(n,e)=>Sn()?Zn.updatePaymentImages(n,e):Nr.updatePaymentImages(n,e),deletePayment:async n=>Sn()?Zn.deletePayment(n):Nr.deletePayment(n),subscribeToPayments:Zn.subscribeToPayments,getPaymentsByProject:Zn.getPaymentsByProject,clearProjectsCache:Zn.clearProjectsCache},la={getAllASRequests:async()=>(await Ce.get("/as-requests")).data,getASRequestById:async n=>(await Ce.get(`/as-requests/${n}`)).data,createASRequest:async n=>(await Ce.post("/as-requests",n)).data,updateASRequest:async(n,e)=>(await Ce.put(`/as-requests/${n}`,e)).data,deleteASRequest:async n=>{await Ce.delete(`/as-requests/${n}`)}};function Ko(n){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:n.id,id:parseInt(n.id)||0,name:n.name,client:{name:n.client||"",phone:"",address:n.address||""},location:{address:n.address||""},startDate:n.startDate||"",endDate:n.endDate||"",status:e[n.status]||"planning",budget:0,actualCost:0,manager:{_id:String(n.managerId||""),name:n.managerName||n.manager||"",username:n.managerUsername||""},fieldManagers:[],workers:[],colorCode:n.color||"#4A90E2",progress:0,description:n.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:n.createdAt||"",updatedAt:n.updatedAt||"",meetingNotes:n.meetingNotes||[],customerRequests:n.customerRequests||[],entrancePassword:n.entrancePassword||"",sitePassword:n.sitePassword||""}}function Ih(n){var t,s,r,i,o,l,u,m;const e={};if(n.name!==void 0&&(e.name=n.name),n.client!==void 0&&(e.client=typeof n.client=="string"?n.client:((t=n.client)==null?void 0:t.name)||""),n.location!==void 0&&(e.address=typeof n.location=="string"?n.location:((s=n.location)==null?void 0:s.address)||""),n.address!==void 0&&(e.address=n.address),n.startDate!==void 0&&(e.startDate=typeof n.startDate=="string"?n.startDate:((o=(i=(r=n.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),n.endDate!==void 0&&(e.endDate=typeof n.endDate=="string"?n.endDate:((m=(u=(l=n.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),n.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[n.status]||"planning"}return n.description!==void 0&&(e.description=n.description),n.manager!==void 0&&(e.manager=n.manager),n.meetingNotes!==void 0&&(e.meetingNotes=n.meetingNotes),n.customerRequests!==void 0&&(e.customerRequests=n.customerRequests),n.entrancePassword!==void 0&&(e.entrancePassword=n.entrancePassword),n.sitePassword!==void 0&&(e.sitePassword=n.sitePassword),n.color!==void 0&&(e.color=n.color),n.colorCode!==void 0&&(e.color=n.colorCode),e}const Dr={getAllProjects:async()=>{const n=Qn(Tt,Bt.PROJECTS),e=Zs(n,Rr("id","desc"));return(await Es(e)).docs.map(s=>{const r=s.data();return Ko({...r,id:s.id})})},getProjectById:async n=>{const e=Bn(Tt,Bt.PROJECTS,n),t=await Qd(e);if(t.exists()){const s=t.data();return Ko({...s,id:t.id})}return null},createProject:async n=>{const e=Qn(Tt,Bt.PROJECTS),t=await Es(e);let s=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=Ih(n),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Bn(Tt,Bt.PROJECTS,r);return await Xd(u,l),Ko(l)},updateProject:async(n,e)=>{const t=Bn(Tt,Bt.PROJECTS,n),s=Ih(e);await so(t,{...s,updatedAt:new Date().toISOString()});const r=await Dr.getProjectById(n);if(!r)throw new Error("Project not found after update");return r},deleteProject:async n=>{const e=Bn(Tt,Bt.PROJECTS,n);await Jd(e)},subscribeToProjects:n=>{const e=Qn(Tt,Bt.PROJECTS),t=Zs(e,Rr("id","desc"));return Nc(t,s=>{const r=s.docs.map(i=>{const o=i.data();return Ko({...o,id:i.id})});n(r)})},subscribeToProject:(n,e)=>{const t=Bn(Tt,Bt.PROJECTS,n);return Nc(t,s=>{if(s.exists()){const r=s.data();e(Ko({...r,id:s.id}))}else e(null)})}},Go={getAllProjects:async()=>(await Ce.get("/projects")).data,getProjectById:async n=>(await Ce.get(`/projects/${n}`)).data,createProject:async n=>{const e={name:n.name,client:typeof n.client=="string"?n.client:n.client.name,location:typeof n.location=="string"?n.location:n.location.address,status:n.status||"planning",manager:n.manager,description:n.description||""};if(n.startDate){const s=typeof n.startDate=="string"?new Date(n.startDate):n.startDate;e.startDate=s.toISOString().split("T")[0]}if(n.endDate){const s=typeof n.endDate=="string"?new Date(n.endDate):n.endDate;e.endDate=s.toISOString().split("T")[0]}return console.log("[projectService.createProject] Sending to backend:",e),(await Ce.post("/projects",e)).data},updateProject:async(n,e)=>{var s;const t={};if(e.name!==void 0&&(t.name=e.name),e.client!==void 0&&(t.client=typeof e.client=="string"?e.client:e.client.name),e.location!==void 0&&(t.location=typeof e.location=="string"?e.location:e.location.address),e.startDate!==void 0)if(typeof e.startDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.startDate))t.startDate=e.startDate;else{const r=typeof e.startDate=="string"?new Date(e.startDate):e.startDate;t.startDate=r.toISOString().split("T")[0]}if(e.endDate!==void 0)if(typeof e.endDate=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(e.endDate))t.endDate=e.endDate;else{const r=typeof e.endDate=="string"?new Date(e.endDate):e.endDate;t.endDate=r.toISOString().split("T")[0]}e.status!==void 0&&(t.status=e.status),e.manager!==void 0&&(t.manager=e.manager),e.description!==void 0&&(t.description=e.description),e.meetingNotes!==void 0&&(t.meetingNotes=e.meetingNotes),e.customerRequests!==void 0&&(t.customerRequests=e.customerRequests),e.entrancePassword!==void 0&&(t.entrancePassword=e.entrancePassword),e.sitePassword!==void 0&&(t.sitePassword=e.sitePassword),console.log("[projectService.updateProject] Sending to backend:",t);try{return(await Ce.put(`/projects/${n}`,t)).data}catch(r){const i=r;throw console.error("[projectService.updateProject] Error:",r),console.error("[projectService.updateProject] Error response:",(s=i.response)==null?void 0:s.data),r}},deleteProject:async n=>{await Ce.delete(`/projects/${n}`)}},ro={getAllProjects:async()=>Sn()?(console.log("[projectService] Using Firestore"),Dr.getAllProjects()):(console.log("[projectService] Using Railway API"),Go.getAllProjects()),getProjectById:async n=>{if(Sn()){const e=await Dr.getProjectById(n);if(!e)throw new Error("Project not found");return e}return Go.getProjectById(n)},createProject:async n=>Sn()?Dr.createProject(n):Go.createProject(n),updateProject:async(n,e)=>Sn()?Dr.updateProject(n,e):Go.updateProject(n,e),deleteProject:async n=>Sn()?Dr.deleteProject(n):Go.deleteProject(n),subscribeToProjects:Dr.subscribeToProjects,subscribeToProject:Dr.subscribeToProject},K1=()=>{if(typeof window<"u"){const n=window.location.hostname;if(n==="hvlab.app"||n.includes("hv-lab-app")||n.includes("firebaseapp.com"))return"https://api.hvlab.app"}return window.location.origin},G1=K1();class Q1{constructor(){If(this,"socket",null)}connect(e){return this.socket=ca(G1,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var s;(s=this.socket)==null||s.on(e,t)}emit(e,t){var s;(s=this.socket)==null||s.emit(e,t)}off(e,t){var s;(s=this.socket)==null||s.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const kr=new Q1,Y1=()=>{var ae,Oe;const{user:n,logout:e,loading:t}=$r(),[s,r]=E.useState(!1),[i,o]=E.useState(!1),[l,u]=E.useState(!1),m=ox(),{unreadCount:d}=Jg(),[f,h]=E.useState(0),[y,w]=E.useState(0),[v,C]=E.useState(0),[B,S]=E.useState(0),[F,re]=E.useState(!1),[ee,M]=E.useState(0),[V,N]=E.useState(!1),A=E.useRef(0),j=E.useRef(null),T=80,I=E.useCallback(me=>{if(window.scrollY>0)return!1;let Le=me;for(;Le&&Le!==document.body;){const bt=window.getComputedStyle(Le).overflowY;if((bt==="auto"||bt==="scroll")&&Le.scrollTop>0)return!1;Le=Le.parentElement}return!0},[]),k=E.useCallback(me=>{if(window.innerWidth>=768)return;const Le=me.target;I(Le)&&(A.current=me.touches[0].clientY,re(!0))},[I]),_e=E.useCallback(me=>{if(!F||V)return;const Le=me.target;if(!I(Le)){re(!1),M(0);return}const bt=me.touches[0].clientY-A.current;if(bt>0){const it=Math.min(bt*.5,120);M(it)}else re(!1),M(0)},[F,V,I]),Fe=E.useCallback(()=>{F&&(ee>=T&&!V?(N(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),re(!1))},[F,ee,V]);if(E.useEffect(()=>{u(!1)},[m.pathname]),E.useEffect(()=>{const me=Le=>{u(Le.detail.isOpen)};return window.addEventListener("mobileFormStateChange",me),()=>window.removeEventListener("mobileFormStateChange",me)},[]),E.useEffect(()=>{const me=()=>{S(Le=>Math.max(0,Le-1))};return window.addEventListener("quoteInquiryRead",me),()=>window.removeEventListener("quoteInquiryRead",me)},[]),E.useEffect(()=>{const me=()=>{w(Le=>Math.max(0,Le-1))};return window.addEventListener("paymentCompleted",me),()=>window.removeEventListener("paymentCompleted",me)},[]),E.useEffect(()=>{const me=kr.getSocket();if(!me||!n)return;const Le=async()=>{try{const[Ke,bt]=await Promise.all([vs.getAllPayments(),ro.getAllProjects()]);let it=Ke;if(n.name===""){const Vt=bt.map(rt=>rt.name);it=Ke.filter(rt=>Vt.includes(rt.project))}w(it.filter(Vt=>Vt.status==="pending").length)}catch(Ke){console.error("Failed to refresh payment count:",Ke)}};return me.on("payment:refresh",Le),()=>{me.off("payment:refresh",Le)}},[n]),E.useEffect(()=>{if(!n)return;const me=async()=>{try{const[Ke,bt,it,Vt]=await Promise.all([dD.getAllWorkRequests(),vs.getAllPayments(),la.getAllASRequests(),ro.getAllProjects()]);h(Ke.filter(ut=>ut.assignedTo===n.name&&ut.status==="pending").length);let rt=bt;if(n.name===""){const ut=Vt.map(un=>un.name);rt=bt.filter(un=>ut.includes(un.project))}if(w(rt.filter(ut=>ut.status==="pending").length),C(it.filter(ut=>ut.status==="in-progress").length),n.role==="admin"||n.role==="manager")try{const un=(await Ce.get("/quote-inquiries")).data.filter(K=>!K.isRead).length;S(un)}catch(ut){console.error("Failed to load quote inquiry count:",ut)}}catch(Ke){console.error("Failed to load badge counts:",Ke)}};me();const Le=setInterval(me,3e4);return()=>clearInterval(Le)},[n]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!n){const me=window.location.pathname+window.location.search;return me&&me!=="/login"&&me!=="/"&&sessionStorage.setItem("redirectAfterLogin",me),a.jsxDEV(ug,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const he=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],Re=he.filter(me=>!me.roles||me.roles.includes((n==null?void 0:n.role)||"")),dt=((ae=he.find(me=>me.href===m.pathname))==null?void 0:ae.name)||"",Ut=(()=>{const me=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(me)?()=>{const Ke=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Ke)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Ns("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Re.map(me=>a.jsxDEV(_u,{to:me.href,className:({isActive:Le})=>Ns("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Re.map(me=>a.jsxDEV(_u,{to:me.href,className:({isActive:Le})=>Ns("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),dt&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:dt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ut&&a.jsxDEV("button",{onClick:Ut,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(bn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(io,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:n==null?void 0:n.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Oe=n==null?void 0:n.name)==null?void 0:Oe.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Re.map(me=>a.jsxDEV(_u,{to:me.href,className:({isActive:Le})=>Ns("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Le?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:me.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),me.badge&&me.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:me.badge>99?"99+":me.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},me.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:_e,onTouchEnd:Fe,children:[ee>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Ns("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",V&&"animate-spin"),style:{transform:`rotate(${V?0:ee*2}deg)`,opacity:Math.min(ee/T,1)},children:a.jsxDEV(gx,{className:Ns("w-5 h-5",ee>=T?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(ax,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(mD,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},X1=n=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,s=n==="emergency"?5:3;let r=0;const i=()=>{if(r>=s)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=n==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<s&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},J1=n=>{if("vibrate"in navigator){const e=n==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},Z1=(n,e)=>{X1(n),J1(n),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},eC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Nl={getAllSchedules:async()=>(await Ce.get("/schedules")).data,getScheduleById:async n=>(await Ce.get(`/schedules/${n}`)).data,createSchedule:async n=>(await Ce.post("/schedules",{project:n.project,title:n.title,type:n.type||"other",phase:n.phase||"",startDate:n.startDate,endDate:n.endDate,allDay:n.allDay!==void 0?n.allDay:!0,assignedTo:n.assignedTo||[],description:n.description,location:n.location,priority:n.priority||"medium",progress:n.progress||0,isCompleted:n.isCompleted||!1,asRequestId:n.asRequestId,time:n.time})).data,updateSchedule:async(n,e)=>(await Ce.put(`/schedules/${n}`,e)).data,deleteSchedule:async n=>{await Ce.delete(`/schedules/${n}`)}},er={getAllContractors:async()=>(await Ce.get("/contractors")).data,getContractorById:async n=>(await Ce.get(`/contractors/${n}`)).data,createContractor:async n=>(await Ce.post("/contractors",n)).data,updateContractor:async(n,e)=>(await Ce.put(`/contractors/${n}`,e)).data,deleteContractor:async n=>{await Ce.delete(`/contractors/${n}`)}},xl={getAllConstructionPayments:async()=>(await Ce.get("/construction-payments")).data,getConstructionPaymentById:async n=>(await Ce.get(`/construction-payments/${n}`)).data,createConstructionPayment:async n=>(await Ce.post("/construction-payments",n)).data,updateConstructionPayment:async(n,e)=>(await Ce.put(`/construction-payments/${n}`,e)).data,deleteConstructionPayment:async n=>{await Ce.delete(`/construction-payments/${n}`)}};let Kl=new Map,Qo=null;async function tC(){if(!(Kl.size>0))return Qo||(Qo=(async()=>{try{const n=Qn(Tt,Bt.PROJECTS);(await Es(n)).docs.forEach(t=>{const s=t.data(),r=parseInt(t.id);!isNaN(r)&&s.name&&Kl.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",Kl.size,"")}catch(n){throw console.error("[executionRecordFirestoreService]    :",n),Qo=null,n}})(),Qo)}function Wi(n){return{id:n.id,project_id:n.projectId,project_name:n.projectName||"",author:n.author||"",date:n.date||"",process:n.process||"",item_name:n.itemName||"",material_cost:n.materialCost||0,labor_cost:n.laborCost||0,vat_amount:n.vatAmount||0,total_amount:n.totalAmount||0,notes:n.notes||"",images:n.images||[],payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction?1:0,includes_vat:n.includesVAT?1:0,created_at:n.createdAt||"",updated_at:n.updatedAt||""}}function Th(n){const e={};return n.project_id!==void 0&&(e.projectId=n.project_id),n.projectId!==void 0&&(e.projectId=n.projectId),n.project_name!==void 0&&(e.projectName=n.project_name),n.projectName!==void 0&&(e.projectName=n.projectName),n.author!==void 0&&(e.author=n.author),n.date!==void 0&&(e.date=n.date),n.process!==void 0&&(e.process=n.process),n.item_name!==void 0&&(e.itemName=n.item_name),n.itemName!==void 0&&(e.itemName=n.itemName),n.material_cost!==void 0&&(e.materialCost=n.material_cost),n.materialCost!==void 0&&(e.materialCost=n.materialCost),n.labor_cost!==void 0&&(e.laborCost=n.labor_cost),n.laborCost!==void 0&&(e.laborCost=n.laborCost),n.vat_amount!==void 0&&(e.vatAmount=n.vat_amount),n.vatAmount!==void 0&&(e.vatAmount=n.vatAmount),n.total_amount!==void 0&&(e.totalAmount=n.total_amount),n.totalAmount!==void 0&&(e.totalAmount=n.totalAmount),n.notes!==void 0&&(e.notes=n.notes),n.images!==void 0&&(e.images=n.images),n.payment_id!==void 0&&(e.paymentId=n.payment_id),n.paymentId!==void 0&&(e.paymentId=n.paymentId),n.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=n.includes_tax_deduction===!0||n.includes_tax_deduction===1),n.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=n.includesTaxDeduction),n.includes_vat!==void 0&&(e.includesVAT=n.includes_vat===!0||n.includes_vat===1),n.includesVAT!==void 0&&(e.includesVAT=n.includesVAT),e}const Xs={getAllRecords:async()=>{const n=Qn(Tt,Bt.EXECUTION_RECORDS),e=Zs(n,Rr("id","desc"));return(await Es(e)).docs.map(s=>{const r=s.data();return Wi({...r,id:parseInt(s.id)||r.id})})},getRecordById:async n=>{const e=Bn(Tt,Bt.EXECUTION_RECORDS,n),t=await Qd(e);if(t.exists()){const s=t.data();return Wi({...s,id:parseInt(t.id)||s.id})}return null},createRecord:async n=>{var f;await tC();const e=Qn(Tt,Bt.EXECUTION_RECORDS),t=await Es(e);let s=0;t.docs.forEach(h=>{const y=parseInt(h.id);!isNaN(y)&&y>s&&(s=y)});const r=s+1,i=Th(n),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const h=Kl.get(u);h?(l=h,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:i.images||[],imageCount:((f=i.images)==null?void 0:f.length)||0},d=Bn(Tt,Bt.EXECUTION_RECORDS,String(r));return await Xd(d,m),Wi(m)},updateRecord:async(n,e)=>{const t=Bn(Tt,Bt.EXECUTION_RECORDS,n),s=Th(e);await so(t,{...s,updatedAt:new Date().toISOString()});const r=await Xs.getRecordById(n);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async n=>{const e=Bn(Tt,Bt.EXECUTION_RECORDS,n);await Jd(e)},subscribeToRecords:n=>{const e=Qn(Tt,Bt.EXECUTION_RECORDS),t=Zs(e,Rr("id","desc"));return Nc(t,s=>{const r=s.docs.map(i=>{const o=i.data();return Wi({...o,id:parseInt(i.id)||o.id})});n(r)})},getRecordsByProject:async n=>{const e=Qn(Tt,Bt.EXECUTION_RECORDS),t=Zs(e,Pm("projectId","==",n),Rr("id","desc"));return(await Es(t)).docs.map(r=>{const i=r.data();return Wi({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async n=>{const e=Qn(Tt,Bt.EXECUTION_RECORDS),t=Zs(e,Pm("paymentId","==",n)),s=await Es(t);if(s.empty)return null;const r=s.docs[0],i=r.data();return Wi({...i,id:parseInt(r.id)||i.id})}},Yo={getAllRecords:async()=>(await Ce.get("/execution-records")).data,getRecordById:async n=>(await Ce.get(`/execution-records/${n}`)).data,createRecord:async n=>(console.log("[executionRecordService.createRecord] Creating:",n),(await Ce.post("/execution-records",n)).data),updateRecord:async(n,e)=>(await Ce.put(`/execution-records/${n}`,e)).data,deleteRecord:async n=>{await Ce.delete(`/execution-records/${n}`)}},vl={getAllRecords:async()=>Sn()?(console.log("[executionRecordService] Using Firestore"),Xs.getAllRecords()):(console.log("[executionRecordService] Using Railway API"),Yo.getAllRecords()),getRecordById:async n=>{if(Sn()){const e=await Xs.getRecordById(n);if(!e)throw new Error("Execution record not found");return e}return Yo.getRecordById(n)},createRecord:async n=>Sn()?Xs.createRecord(n):Yo.createRecord(n),updateRecord:async(n,e)=>Sn()?Xs.updateRecord(n,e):Yo.updateRecord(n,e),deleteRecord:async n=>Sn()?Xs.deleteRecord(n):Yo.deleteRecord(n),subscribeToRecords:Xs.subscribeToRecords,getRecordsByProject:Xs.getRecordsByProject,getRecordByPaymentId:Xs.getRecordByPaymentId},Fr=Fm()(Xg((n,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>n({projects:t}),addProject:t=>n(s=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(t,s)=>n(r=>({projects:r.projects.map(i=>i.id===t?{...i,...s}:i)})),deleteProject:t=>n(s=>({projects:s.projects.filter(r=>r.id!==t),constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>n({schedules:t}),addSchedule:t=>n(s=>({schedules:[t,...s.schedules]})),updateSchedule:(t,s)=>n(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...s}:i)})),deleteSchedule:t=>n(s=>({schedules:s.schedules.filter(r=>r.id!==t)})),setPayments:t=>n({payments:t}),addPayment:t=>n(s=>({payments:[t,...s.payments]})),updatePayment:(t,s)=>n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)})),deletePayment:t=>n(s=>({payments:s.payments.filter(r=>r.id!==t)})),setContractors:t=>n({contractors:t}),addContractor:t=>n(s=>({contractors:[t,...s.contractors]})),updateContractor:(t,s)=>n(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...s}:i)})),deleteContractor:t=>n(s=>({contractors:s.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>n({constructionPayments:t}),addConstructionPayment:t=>n(s=>({constructionPayments:[t,...s.constructionPayments]})),updateConstructionPayment:(t,s)=>n(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...s}:i)})),deleteConstructionPayment:t=>n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>n({asRequests:t}),addASRequest:t=>n(s=>({asRequests:[t,...s.asRequests]})),updateASRequest:(t,s)=>n(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...s}:i)})),deleteASRequest:t=>n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>n({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),n(s=>{const r=[t,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,s)=>n(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...s}:i)})),deleteExecutionRecord:t=>n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await vs.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const s=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(s.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(w=>w.id)),f=s.filter(w=>!d.has(w.id)),y=[...m.map(w=>({...w,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),n({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),n({payments:s})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const s=`temp_${Date.now()}`,r={...t,id:s,_addedAt:Date.now(),_tempId:s};n(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await vs.createPayment(u),d=String(m.id);return n(f=>({payments:f.payments.map(h=>h._tempId===s?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),n(o=>({payments:o.payments.filter(l=>l._tempId!==s)})),i}},updatePaymentInAPI:async(t,s)=>{try{if(s.status&&Object.keys(s).length===1)await vs.updatePaymentStatus(t,s.status);else{let r=s.project;if(s.project){const o=e().projects.find(l=>l.name===s.project);r=o?o.id:s.project}await vs.updatePayment(t,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}n(r=>({payments:r.payments.map(i=>i.id===t?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await vs.deletePayment(t),n(s=>({payments:s.payments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const t=await Nl.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const s=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),n({schedules:s})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const s=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:s};n(l=>({schedules:[...l.schedules,r]}));try{const l=await Nl.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};n(f=>({schedules:f.schedules.map(h=>h.id===s?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),n(u=>({schedules:u.schedules.filter(m=>m.id!==s)})),l}},updateScheduleInAPI:async(t,s)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:s});const l={};s.project!==void 0&&(l.project=s.project),s.title!==void 0&&(l.title=s.title),s.type!==void 0&&(l.type=s.type),s.start!==void 0&&(l.startDate=s.start),s.end!==void 0&&(l.endDate=s.end),s.location!==void 0&&(l.location=s.location),s.description!==void 0&&(l.description=s.description),s.attendees!==void 0&&(l.assignedTo=s.attendees),s.time!==void 0&&(l.time=s.time),console.log(" Sending update data:",l);const u=await Nl.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};n(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:s}=e(),r=s.find(o=>o.id===t);if(r){n(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await Nl.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&n(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const s=(await ro.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});n({projects:s})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var s,r;try{const i=await ro.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};n(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,s)=>{var r,i;try{const o=await ro.updateProject(t,s),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};n(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await ro.deleteProject(t),n(s=>({projects:s.projects.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await er.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));n({contractors:s})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const s=await er.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};n(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(t,s)=>{try{const r=await er.updateContractor(t,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};n(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await er.deleteContractor(t),n(s=>({contractors:s.contractors.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await xl.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});n({constructionPayments:s})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var s;try{const r=await xl.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};n(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,s)=>{var r;try{const i=await xl.updateConstructionPayment(t,s);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};n(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await xl.deleteConstructionPayment(t),n(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await la.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));n({asRequests:s})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const s=await la.createASRequest(t),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return n(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(t,s)=>{try{const r=await la.updateASRequest(t,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};n(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await la.deleteASRequest(t),n(s=>({asRequests:s.asRequests.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const t=await vl.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const s=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));n({executionRecords:s})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const s=await vl.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),n(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(t,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await vl.updateRecord(t,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),n(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...s,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await vl.deleteRecord(t),n(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==t)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:n=>({...n,payments:n.payments.map(e=>{const{images:t,...s}=e;return s}),executionRecords:n.executionRecords.map(e=>{const{images:t,...s}=e;return s})}),storage:{getItem:n=>{var u,m,d,f,h,y,w;const e=localStorage.getItem(n);if(!e)return null;const{state:t}=JSON.parse(e),s=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var C;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((C=v.payments)==null?void 0:C.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:s,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((w=t.executionRecords)==null?void 0:w.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(n,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(n,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:n=>localStorage.removeItem(n)}}));var Za=n=>n.type==="checkbox",fi=n=>n instanceof Date,Kn=n=>n==null;const MN=n=>typeof n=="object";var vn=n=>!Kn(n)&&!Array.isArray(n)&&MN(n)&&!fi(n),nC=n=>vn(n)&&n.target?Za(n.target)?n.target.checked:n.target.value:n,sC=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,rC=(n,e)=>n.has(sC(e)),iC=n=>{const e=n.constructor&&n.constructor.prototype;return vn(e)&&e.hasOwnProperty("isPrototypeOf")},Zd=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function In(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(Zd&&(n instanceof Blob||s))&&(t||vn(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!iC(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=In(n[r]));else return n;return e}var ru=n=>/^\w*$/.test(n),gn=n=>n===void 0,ef=n=>Array.isArray(n)?n.filter(Boolean):[],tf=n=>ef(n.replace(/["|']|\]/g,"").split(/\.|\[/)),je=(n,e,t)=>{if(!e||!vn(n))return t;const s=(ru(e)?[e]:tf(e)).reduce((r,i)=>Kn(r)?r:r[i],n);return gn(s)||s===n?gn(n[e])?t:n[e]:s},js=n=>typeof n=="boolean",Zt=(n,e,t)=>{let s=-1;const r=ru(e)?[e]:tf(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let u=t;if(s!==o){const m=n[l];u=vn(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=u,n=n[l]}};const Sh={BLUR:"blur",FOCUS_OUT:"focusout"},_s={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Qs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},oC=lt.createContext(null);oC.displayName="HookFormContext";var aC=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==_s.all&&(e._proxyFormState[o]=!s||_s.all),n[o]}});return r};const lC=typeof window<"u"?lt.useLayoutEffect:lt.useEffect;var is=n=>typeof n=="string",cC=(n,e,t,s,r)=>is(n)?(s&&e.watch.add(n),je(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),je(t,i))):(s&&(e.watchAll=!0),t),Lm=n=>Kn(n)||!MN(n);function Ar(n,e,t=new WeakSet){if(Lm(n)||Lm(e))return n===e;if(fi(n)&&fi(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(fi(o)&&fi(l)||vn(o)&&vn(l)||Array.isArray(o)&&Array.isArray(l)?!Ar(o,l,t):o!==l)return!1}}return!0}var uC=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},Na=n=>Array.isArray(n)?n:[n],Ph=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function FN(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&vn(r)&&i){const o=FN(r,i);vn(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var es=n=>vn(n)&&!Object.keys(n).length,nf=n=>n.type==="file",Ds=n=>typeof n=="function",_c=n=>{if(!Zd)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ON=n=>n.type==="select-multiple",sf=n=>n.type==="radio",mC=n=>sf(n)||Za(n),Mu=n=>_c(n)&&n.isConnected;function dC(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=gn(n)?s++:n[e[s++]];return n}function fC(n){for(const e in n)if(n.hasOwnProperty(e)&&!gn(n[e]))return!1;return!0}function pn(n,e){const t=Array.isArray(e)?e:ru(e)?[e]:tf(e),s=t.length===1?n:dC(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(vn(s)&&es(s)||Array.isArray(s)&&fC(s))&&pn(n,t.slice(0,-1)),n}var pC=n=>{for(const e in n)if(Ds(n[e]))return!0;return!1};function qN(n){return Array.isArray(n)||vn(n)&&!pC(n)}function jm(n,e={}){for(const t in n)qN(n[t])?(e[t]=Array.isArray(n[t])?[]:{},jm(n[t],e[t])):Kn(n[t])||(e[t]=!0);return e}function no(n,e,t){t||(t=jm(e));for(const s in n)qN(n[s])?gn(e)||Lm(t[s])?t[s]=jm(n[s],Array.isArray(n[s])?[]:{}):no(n[s],Kn(e)?{}:e[s],t[s]):t[s]=!Ar(n[s],e[s]);return t}const Lh={value:!1,isValid:!1},jh={value:!0,isValid:!0};var $N=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!gn(n[0].attributes.value)?gn(n[0].value)||n[0].value===""?jh:{value:n[0].value,isValid:!0}:jh:Lh}return Lh},zN=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>gn(n)?n:e?n===""?NaN:n&&+n:t&&is(n)?new Date(n):s?s(n):n;const Rh={isValid:!1,value:null};var WN=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Rh):Rh;function Bh(n){const e=n.ref;return nf(e)?e.files:sf(e)?WN(n.refs).value:ON(e)?[...e.selectedOptions].map(({value:t})=>t):Za(e)?$N(n.refs).value:zN(gn(e.value)?n.ref.value:e.value,n)}var hC=(n,e,t,s)=>{const r={};for(const i of n){const o=je(e,i);o&&Zt(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},Dc=n=>n instanceof RegExp,Xo=n=>gn(n)?n:Dc(n)?n.source:vn(n)?Dc(n.value)?n.value.source:n.value:n,Uh=n=>({isOnSubmit:!n||n===_s.onSubmit,isOnBlur:n===_s.onBlur,isOnChange:n===_s.onChange,isOnAll:n===_s.all,isOnTouch:n===_s.onTouched});const Hh="AsyncFunction";var gC=n=>!!n&&!!n.validate&&!!(Ds(n.validate)&&n.validate.constructor.name===Hh||vn(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===Hh)),yC=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),Mh=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const xa=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=je(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(xa(l,e))break}else if(vn(l)&&xa(l,e))break}}};function Fh(n,e,t){const s=je(n,t);if(s||ru(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=je(e,i),l=je(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var bC=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return es(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||_s.all))},NC=(n,e,t)=>!n||!e||n===e||Na(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),xC=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,vC=(n,e)=>!ef(je(n,e)).length&&pn(n,e),_C=(n,e,t)=>{const s=Na(je(n,t));return Zt(s,"root",e[t]),Zt(n,t,s),n};function Oh(n,e,t="validate"){if(is(n)||Array.isArray(n)&&n.every(is)||js(n)&&!n)return{type:t,message:is(n)?n:"",ref:e}}var Ki=n=>vn(n)&&!Dc(n)?n:{value:n,message:""},qh=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:y,validate:w,name:v,valueAsNumber:C,mount:B}=n._f,S=je(t,v);if(!B||e.has(v))return{};const F=l?l[0]:o,re=I=>{r&&F.reportValidity&&(F.setCustomValidity(js(I)?"":I||""),F.reportValidity())},ee={},M=sf(o),V=Za(o),N=M||V,A=(C||nf(o))&&gn(o.value)&&gn(S)||_c(o)&&o.value===""||S===""||Array.isArray(S)&&!S.length,j=uC.bind(null,v,s,ee),T=(I,k,_e,Fe=Qs.maxLength,he=Qs.minLength)=>{const Re=I?k:_e;ee[v]={type:I?Fe:he,message:Re,ref:o,...j(I?Fe:he,Re)}};if(i?!Array.isArray(S)||!S.length:u&&(!N&&(A||Kn(S))||js(S)&&!S||V&&!$N(l).isValid||M&&!WN(l).isValid)){const{value:I,message:k}=is(u)?{value:!!u,message:u}:Ki(u);if(I&&(ee[v]={type:Qs.required,message:k,ref:F,...j(Qs.required,k)},!s))return re(k),ee}if(!A&&(!Kn(f)||!Kn(h))){let I,k;const _e=Ki(h),Fe=Ki(f);if(!Kn(S)&&!isNaN(S)){const he=o.valueAsNumber||S&&+S;Kn(_e.value)||(I=he>_e.value),Kn(Fe.value)||(k=he<Fe.value)}else{const he=o.valueAsDate||new Date(S),Re=Ut=>new Date(new Date().toDateString()+" "+Ut),dt=o.type=="time",Ot=o.type=="week";is(_e.value)&&S&&(I=dt?Re(S)>Re(_e.value):Ot?S>_e.value:he>new Date(_e.value)),is(Fe.value)&&S&&(k=dt?Re(S)<Re(Fe.value):Ot?S<Fe.value:he<new Date(Fe.value))}if((I||k)&&(T(!!I,_e.message,Fe.message,Qs.max,Qs.min),!s))return re(ee[v].message),ee}if((m||d)&&!A&&(is(S)||i&&Array.isArray(S))){const I=Ki(m),k=Ki(d),_e=!Kn(I.value)&&S.length>+I.value,Fe=!Kn(k.value)&&S.length<+k.value;if((_e||Fe)&&(T(_e,I.message,k.message),!s))return re(ee[v].message),ee}if(y&&!A&&is(S)){const{value:I,message:k}=Ki(y);if(Dc(I)&&!S.match(I)&&(ee[v]={type:Qs.pattern,message:k,ref:o,...j(Qs.pattern,k)},!s))return re(k),ee}if(w){if(Ds(w)){const I=await w(S,t),k=Oh(I,F);if(k&&(ee[v]={...k,...j(Qs.validate,k.message)},!s))return re(k.message),ee}else if(vn(w)){let I={};for(const k in w){if(!es(I)&&!s)break;const _e=Oh(await w[k](S,t),F,k);_e&&(I={..._e,...j(k,_e.message)},re(_e.message),s&&(ee[v]=I))}if(!es(I)&&(ee[v]={ref:F,...I},!s))return ee}}return re(!0),ee};const DC={mode:_s.onSubmit,reValidateMode:_s.onChange,shouldFocusError:!0};function kC(n={}){let e={...DC,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ds(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=vn(e.defaultValues)||vn(e.values)?In(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:In(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:Ph(),state:Ph()},y=e.criteriaMode===_s.all,w=P=>q=>{clearTimeout(m),m=setTimeout(P,q)},v=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const q=e.resolver?es((await V()).errors):await A(s,!0);q!==t.isValid&&h.state.next({isValid:q})}},C=(P,q)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(te=>{te&&(q?Zt(t.validatingFields,te,q):pn(t.validatingFields,te))}),h.state.next({validatingFields:t.validatingFields,isValidating:!es(t.validatingFields)}))},B=(P,q=[],te,be,ce=!0,de=!0)=>{if(be&&te&&!e.disabled){if(o.action=!0,de&&Array.isArray(je(s,P))){const we=te(je(s,P),be.argA,be.argB);ce&&Zt(s,P,we)}if(de&&Array.isArray(je(t.errors,P))){const we=te(je(t.errors,P),be.argA,be.argB);ce&&Zt(t.errors,P,we),vC(t.errors,P)}if((d.touchedFields||f.touchedFields)&&de&&Array.isArray(je(t.touchedFields,P))){const we=te(je(t.touchedFields,P),be.argA,be.argB);ce&&Zt(t.touchedFields,P,we)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=no(r,i)),h.state.next({name:P,isDirty:T(P,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else Zt(i,P,q)},S=(P,q)=>{Zt(t.errors,P,q),h.state.next({errors:t.errors})},F=P=>{t.errors=P,h.state.next({errors:t.errors,isValid:!1})},re=(P,q,te,be)=>{const ce=je(s,P);if(ce){const de=je(i,P,gn(te)?je(r,P):te);gn(de)||be&&be.defaultChecked||q?Zt(i,P,q?de:Bh(ce._f)):_e(P,de),o.mount&&v()}},ee=(P,q,te,be,ce)=>{let de=!1,we=!1;const qe={name:P};if(!e.disabled){if(!te||be){(d.isDirty||f.isDirty)&&(we=t.isDirty,t.isDirty=qe.isDirty=T(),de=we!==qe.isDirty);const Je=Ar(je(r,P),q);we=!!je(t.dirtyFields,P),Je?pn(t.dirtyFields,P):Zt(t.dirtyFields,P,!0),qe.dirtyFields=t.dirtyFields,de=de||(d.dirtyFields||f.dirtyFields)&&we!==!Je}if(te){const Je=je(t.touchedFields,P);Je||(Zt(t.touchedFields,P,te),qe.touchedFields=t.touchedFields,de=de||(d.touchedFields||f.touchedFields)&&Je!==te)}de&&ce&&h.state.next(qe)}return de?qe:{}},M=(P,q,te,be)=>{const ce=je(t.errors,P),de=(d.isValid||f.isValid)&&js(q)&&t.isValid!==q;if(e.delayError&&te?(u=w(()=>S(P,te)),u(e.delayError)):(clearTimeout(m),u=null,te?Zt(t.errors,P,te):pn(t.errors,P)),(te?!Ar(ce,te):ce)||!es(be)||de){const we={...be,...de&&js(q)?{isValid:q}:{},errors:t.errors,name:P};t={...t,...we},h.state.next(we)}},V=async P=>{C(P,!0);const q=await e.resolver(i,e.context,hC(P||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return C(P),q},N=async P=>{const{errors:q}=await V(P);if(P)for(const te of P){const be=je(q,te);be?Zt(t.errors,te,be):pn(t.errors,te)}else t.errors=q;return q},A=async(P,q,te={valid:!0})=>{for(const be in P){const ce=P[be];if(ce){const{_f:de,...we}=ce;if(de){const qe=l.array.has(de.name),Je=ce._f&&gC(ce._f);Je&&d.validatingFields&&C([de.name],!0);const ke=await qh(ce,l.disabled,i,y,e.shouldUseNativeValidation&&!q,qe);if(Je&&d.validatingFields&&C([de.name]),ke[de.name]&&(te.valid=!1,q))break;!q&&(je(ke,de.name)?qe?_C(t.errors,ke,de.name):Zt(t.errors,de.name,ke[de.name]):pn(t.errors,de.name))}!es(we)&&await A(we,q,te)}}return te.valid},j=()=>{for(const P of l.unMount){const q=je(s,P);q&&(q._f.refs?q._f.refs.every(te=>!Mu(te)):!Mu(q._f.ref))&&it(P)}l.unMount=new Set},T=(P,q)=>!e.disabled&&(P&&q&&Zt(i,P,q),!Ar(Ut(),r)),I=(P,q,te)=>cC(P,l,{...o.mount?i:gn(q)?r:is(P)?{[P]:q}:q},te,q),k=P=>ef(je(o.mount?i:r,P,e.shouldUnregister?je(r,P,[]):[])),_e=(P,q,te={})=>{const be=je(s,P);let ce=q;if(be){const de=be._f;de&&(!de.disabled&&Zt(i,P,zN(q,de)),ce=_c(de.ref)&&Kn(q)?"":q,ON(de.ref)?[...de.ref.options].forEach(we=>we.selected=ce.includes(we.value)):de.refs?Za(de.ref)?de.refs.forEach(we=>{(!we.defaultChecked||!we.disabled)&&(Array.isArray(ce)?we.checked=!!ce.find(qe=>qe===we.value):we.checked=ce===we.value||!!ce)}):de.refs.forEach(we=>we.checked=we.value===ce):nf(de.ref)?de.ref.value="":(de.ref.value=ce,de.ref.type||h.state.next({name:P,values:In(i)})))}(te.shouldDirty||te.shouldTouch)&&ee(P,ce,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&Ot(P)},Fe=(P,q,te)=>{for(const be in q){if(!q.hasOwnProperty(be))return;const ce=q[be],de=P+"."+be,we=je(s,de);(l.array.has(P)||vn(ce)||we&&!we._f)&&!fi(ce)?Fe(de,ce,te):_e(de,ce,te)}},he=(P,q,te={})=>{const be=je(s,P),ce=l.array.has(P),de=In(q);Zt(i,P,de),ce?(h.array.next({name:P,values:In(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&te.shouldDirty&&h.state.next({name:P,dirtyFields:no(r,i),isDirty:T(P,de)})):be&&!be._f&&!Kn(de)?Fe(P,de,te):_e(P,de,te),Mh(P,l)&&h.state.next({...t,name:P}),h.state.next({name:o.mount?P:void 0,values:In(i)})},Re=async P=>{o.mount=!0;const q=P.target;let te=q.name,be=!0;const ce=je(s,te),de=Je=>{be=Number.isNaN(Je)||fi(Je)&&isNaN(Je.getTime())||Ar(Je,je(i,te,Je))},we=Uh(e.mode),qe=Uh(e.reValidateMode);if(ce){let Je,ke;const Pn=q.type?Bh(ce._f):nC(P),jt=P.type===Sh.BLUR||P.type===Sh.FOCUS_OUT,ne=!yC(ce._f)&&!e.resolver&&!je(t.errors,te)&&!ce._f.deps||xC(jt,je(t.touchedFields,te),t.isSubmitted,qe,we),Qe=Mh(te,l,jt);Zt(i,te,Pn),jt?(!q||!q.readOnly)&&(ce._f.onBlur&&ce._f.onBlur(P),u&&u(0)):ce._f.onChange&&ce._f.onChange(P);const O=ee(te,Pn,jt),Ne=!es(O)||Qe;if(!jt&&h.state.next({name:te,type:P.type,values:In(i)}),ne)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?jt&&v():jt||v()),Ne&&h.state.next({name:te,...Qe?{}:O});if(!jt&&Qe&&h.state.next({...t}),e.resolver){const{errors:De}=await V([te]);if(de(Pn),be){const Pe=Fh(t.errors,s,te),ue=Fh(De,s,Pe.name||te);Je=ue.error,te=ue.name,ke=es(De)}}else C([te],!0),Je=(await qh(ce,l.disabled,i,y,e.shouldUseNativeValidation))[te],C([te]),de(Pn),be&&(Je?ke=!1:(d.isValid||f.isValid)&&(ke=await A(s,!0)));be&&(ce._f.deps&&(!Array.isArray(ce._f.deps)||ce._f.deps.length>0)&&Ot(ce._f.deps),M(te,ke,Je,O))}},dt=(P,q)=>{if(je(t.errors,q)&&P.focus)return P.focus(),1},Ot=async(P,q={})=>{let te,be;const ce=Na(P);if(e.resolver){const de=await N(gn(P)?P:ce);te=es(de),be=P?!ce.some(we=>je(de,we)):te}else P?(be=(await Promise.all(ce.map(async de=>{const we=je(s,de);return await A(we&&we._f?{[de]:we}:we)}))).every(Boolean),!(!be&&!t.isValid)&&v()):be=te=await A(s);return h.state.next({...!is(P)||(d.isValid||f.isValid)&&te!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:te}:{},errors:t.errors}),q.shouldFocus&&!be&&xa(s,dt,P?ce:l.mount),be},Ut=(P,q)=>{let te={...o.mount?i:r};return q&&(te=FN(q.dirtyFields?t.dirtyFields:t.touchedFields,te)),gn(P)?te:is(P)?je(te,P):P.map(be=>je(te,be))},ae=(P,q)=>({invalid:!!je((q||t).errors,P),isDirty:!!je((q||t).dirtyFields,P),error:je((q||t).errors,P),isValidating:!!je(t.validatingFields,P),isTouched:!!je((q||t).touchedFields,P)}),Oe=P=>{P&&Na(P).forEach(q=>pn(t.errors,q)),h.state.next({errors:P?t.errors:{}})},me=(P,q,te)=>{const be=(je(s,P,{_f:{}})._f||{}).ref,ce=je(t.errors,P)||{},{ref:de,message:we,type:qe,...Je}=ce;Zt(t.errors,P,{...Je,...q,ref:be}),h.state.next({name:P,errors:t.errors,isValid:!1}),te&&te.shouldFocus&&be&&be.focus&&be.focus()},Le=(P,q)=>Ds(P)?h.state.subscribe({next:te=>"values"in te&&P(I(void 0,q),te)}):I(P,q,!0),Ke=P=>h.state.subscribe({next:q=>{NC(P.name,q.name,P.exact)&&bC(q,P.formState||d,At,P.reRenderRoot)&&P.callback({values:{...i},...t,...q,defaultValues:r})}}).unsubscribe,bt=P=>(o.mount=!0,f={...f,...P.formState},Ke({...P,formState:f})),it=(P,q={})=>{for(const te of P?Na(P):l.mount)l.mount.delete(te),l.array.delete(te),q.keepValue||(pn(s,te),pn(i,te)),!q.keepError&&pn(t.errors,te),!q.keepDirty&&pn(t.dirtyFields,te),!q.keepTouched&&pn(t.touchedFields,te),!q.keepIsValidating&&pn(t.validatingFields,te),!e.shouldUnregister&&!q.keepDefaultValue&&pn(r,te);h.state.next({values:In(i)}),h.state.next({...t,...q.keepDirty?{isDirty:T()}:{}}),!q.keepIsValid&&v()},Vt=({disabled:P,name:q})=>{(js(P)&&o.mount||P||l.disabled.has(q))&&(P?l.disabled.add(q):l.disabled.delete(q))},rt=(P,q={})=>{let te=je(s,P);const be=js(q.disabled)||js(e.disabled);return Zt(s,P,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:P}},name:P,mount:!0,...q}}),l.mount.add(P),te?Vt({disabled:js(q.disabled)?q.disabled:e.disabled,name:P}):re(P,!0,q.value),{...be?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Xo(q.min),max:Xo(q.max),minLength:Xo(q.minLength),maxLength:Xo(q.maxLength),pattern:Xo(q.pattern)}:{},name:P,onChange:Re,onBlur:Re,ref:ce=>{if(ce){rt(P,q),te=je(s,P);const de=gn(ce.value)&&ce.querySelectorAll&&ce.querySelectorAll("input,select,textarea")[0]||ce,we=mC(de),qe=te._f.refs||[];if(we?qe.find(Je=>Je===de):de===te._f.ref)return;Zt(s,P,{_f:{...te._f,...we?{refs:[...qe.filter(Mu),de,...Array.isArray(je(r,P))?[{}]:[]],ref:{type:de.type,name:P}}:{ref:de}}}),re(P,!1,void 0,de)}else te=je(s,P,{}),te._f&&(te._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(rC(l.array,P)&&o.action)&&l.unMount.add(P)}}},ut=()=>e.shouldFocusError&&xa(s,dt,l.mount),un=P=>{js(P)&&(h.state.next({disabled:P}),xa(s,(q,te)=>{const be=je(s,te);be&&(q.disabled=be._f.disabled||P,Array.isArray(be._f.refs)&&be._f.refs.forEach(ce=>{ce.disabled=be._f.disabled||P}))},0,!1))},K=(P,q)=>async te=>{let be;te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ce=In(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:we}=await V();t.errors=de,ce=In(we)}else await A(s);if(l.disabled.size)for(const de of l.disabled)pn(ce,de);if(pn(t.errors,"root"),es(t.errors)){h.state.next({errors:{}});try{await P(ce,te)}catch(de){be=de}}else q&&await q({...t.errors},te),ut(),setTimeout(ut);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:es(t.errors)&&!be,submitCount:t.submitCount+1,errors:t.errors}),be)throw be},Se=(P,q={})=>{je(s,P)&&(gn(q.defaultValue)?he(P,In(je(r,P))):(he(P,q.defaultValue),Zt(r,P,In(q.defaultValue))),q.keepTouched||pn(t.touchedFields,P),q.keepDirty||(pn(t.dirtyFields,P),t.isDirty=q.defaultValue?T(P,In(je(r,P))):T()),q.keepError||(pn(t.errors,P),d.isValid&&v()),h.state.next({...t}))},Be=(P,q={})=>{const te=P?In(P):r,be=In(te),ce=es(P),de=ce?r:be;if(q.keepDefaultValues||(r=te),!q.keepValues){if(q.keepDirtyValues){const we=new Set([...l.mount,...Object.keys(no(r,i))]);for(const qe of Array.from(we))je(t.dirtyFields,qe)?Zt(de,qe,je(i,qe)):he(qe,je(de,qe))}else{if(Zd&&gn(P))for(const we of l.mount){const qe=je(s,we);if(qe&&qe._f){const Je=Array.isArray(qe._f.refs)?qe._f.refs[0]:qe._f.ref;if(_c(Je)){const ke=Je.closest("form");if(ke){ke.reset();break}}}}if(q.keepFieldsRef)for(const we of l.mount)he(we,je(de,we));else s={}}i=e.shouldUnregister?q.keepDefaultValues?In(r):{}:In(de),h.array.next({values:{...de}}),h.state.next({values:{...de}})}l={mount:q.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!q.keepIsValid||!!q.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ce?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Ar(P,r)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ce?{}:q.keepDirtyValues?q.keepDefaultValues&&i?no(r,i):t.dirtyFields:q.keepDefaultValues&&P?no(r,P):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Ie=(P,q)=>Be(Ds(P)?P(i):P,q),Ge=(P,q={})=>{const te=je(s,P),be=te&&te._f;if(be){const ce=be.refs?be.refs[0]:be.ref;ce.focus&&(ce.focus(),q.shouldSelect&&Ds(ce.select)&&ce.select())}},At=P=>{t={...t,...P}},ct={control:{register:rt,unregister:it,getFieldState:ae,handleSubmit:K,setError:me,_subscribe:Ke,_runSchema:V,_focusError:ut,_getWatch:I,_getDirty:T,_setValid:v,_setFieldArray:B,_setDisabledField:Vt,_setErrors:F,_getFieldArray:k,_reset:Be,_resetDefaultValues:()=>Ds(e.defaultValues)&&e.defaultValues().then(P=>{Ie(P,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:un,_subjects:h,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:bt,trigger:Ot,register:rt,handleSubmit:K,watch:Le,setValue:he,getValues:Ut,reset:Ie,resetField:Se,clearErrors:Oe,unregister:it,setError:me,setFocus:Ge,getFieldState:ae};return{...ct,formControl:ct}}function rf(n={}){const e=lt.useRef(void 0),t=lt.useRef(void 0),[s,r]=lt.useState({isDirty:!1,isValidating:!1,isLoading:Ds(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Ds(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!Ds(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=kC(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,lC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),lt.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),lt.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),lt.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),lt.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),lt.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),lt.useEffect(()=>{n.values&&!Ar(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),lt.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=aC(s,i),e.current}const $h=["","","","","","",""],KN=({event:n,slotInfo:e,defaultProjectName:t,onClose:s,onSave:r,onDelete:i})=>{const[o,l]=E.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:y}=rf({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:w}=Fr(),[v,C]=E.useState([]),[B,S]=E.useState(""),[F,re]=E.useState(!1),[ee,M]=E.useState(""),[V,N]=E.useState(9),[A,j]=E.useState(0),[T,I]=E.useState(""),k=f("projectId");E.useEffect(()=>{if(k){const ae=w.find(Oe=>Oe.id===k||Oe.id===parseInt(k)||Oe.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,w,v]),E.useEffect(()=>{console.log(" Modal mount - initializing states"),C([]),I(""),S("")},[]),E.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!n,eventId:n==null?void 0:n.id,hasSlotInfo:!!e,hasMergedEvents:!!(n!=null&&n.mergedEventIds)}),n&&n.id){console.log(" ScheduleModal processing event:",{title:n.title,projectId:n.projectId,projectName:n.projectName,start:n.start,assignedTo:n.assignedTo,time:n.time});const ae=n.originalTitle||n.title,Oe=/ - (|) \d{1,2}$/,me=ae.replace(Oe,"");if(d("title",me,{shouldValidate:!1,shouldDirty:!1}),d("date",Ht(n.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",n.description||"",{shouldValidate:!1,shouldDirty:!1}),n.projectId&&n.projectId!==""&&n.projectId!=="undefined")console.log(" Setting projectId from event:",n.projectId),d("projectId",n.projectId,{shouldValidate:!1,shouldDirty:!1}),I("");else if(n.projectName){const Ke=w.find(bt=>bt.name===n.projectName);console.log(" Finding project by name:",n.projectName,"found:",Ke),Ke?(console.log(" Setting projectId from found project:",Ke.id),d("projectId",Ke.id,{shouldValidate:!1,shouldDirty:!1}),I("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I("");const Le=n.assignedTo||n.attendees||[];if(console.log(" Setting selectedMembers to:",Le),C(Array.isArray(Le)?Le:[]),n.time&&n.time!=="-"){console.log(" Setting time from event:",{eventTime:n.time,parsedHours:n.time.split(":")[0],parsedMinutes:n.time.split(":")[1]}),re(!0);const[Ke,bt]=n.time.split(":"),it=parseInt(Ke,10),Vt=parseInt(bt,10);it>=12?(M(""),N(it===12?12:it-12)):(M(""),N(it===0?12:it)),j(Vt),console.log(" Time state set:",{hasTime:!0,period:it>=12?"":"",hour:it>=12?it===12?12:it-12:it===0?12:it,minute:Vt})}else console.log(" No time in event, setting hasTime to false"),re(!1),M(""),N(9),j(0)}else if(e&&!n&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:Ht(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),C([]),I(""),t)){const ae=w.find(Oe=>Oe.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[n==null?void 0:n.id]);const _e=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),C(Oe=>{console.log(" Previous members in setState:",Oe);const me=Oe.includes(ae)?Oe.filter(Le=>Le!==ae):[...Oe,ae];return console.log(" Updated members after toggle:",me),me})},Fe=()=>{const ae="HV LAB";v.includes(ae)?C(Oe=>Oe.filter(me=>me!==ae)):C(Oe=>[...Oe.filter(me=>me!==""),ae])},he=()=>{const ae="";v.includes(ae)?C(Oe=>Oe.filter(me=>me!==ae)):C(Oe=>[...Oe,ae])},Re=()=>{const ae="";v.includes(ae)?C(Oe=>Oe.filter(me=>me!==ae)):C(Oe=>[...Oe,ae])},dt=()=>{B.trim()&&!v.includes(B.trim())&&(C(ae=>[...ae,B.trim()]),S(""))},Ot=ae=>{C(Oe=>Oe.filter(me=>me!==ae))},Ut=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",ee,"timeHour:",V,"timeMinute:",A),console.log(" Available projects:",w.map(rt=>({id:rt.id,name:rt.name,idType:typeof rt.id}))),console.log(" Merged event IDs:",n==null?void 0:n.mergedEventIds);const Oe=/ - (|) \d{1,2}$/,me=ae.title.replace(Oe,"").trim();let Le="",Ke="";if(ae.projectId){const rt=w.find(ut=>ut.id===ae.projectId||ut.id===parseInt(ae.projectId)||ut.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",rt),Le=(rt==null?void 0:rt.name)||"",Ke=ae.projectId}else Le="",Ke="";console.log(" Final projectId:",Ke,"projectName:",Le,"cleanedTitle:",me);const bt=new Date(ae.date);let it="-";if(F){let rt=V;ee===""&&V!==12?rt=V+12:ee===""&&V===12&&(rt=0),it=`${rt.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`,console.log(" Time calculated:",it)}else console.log(" No time set (hasTime is false)");const Vt={...n,title:me,start:bt,end:bt,projectId:Ke,projectName:Le,assignedTo:v,description:ae.description||"",time:it,mergedEventIds:n==null?void 0:n.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",Vt);try{await r(Vt),console.log(" onSave completed successfully")}catch(rt){throw console.error(" onSave failed:",rt),rt}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ut),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),w.filter(ae=>n!=null&&n.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>re(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:V,onChange:ae=>N(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:A,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:Fe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:he,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:Re,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),$h.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>_e(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!$h.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>Ot(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>S(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),dt())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:dt,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:n&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(n.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(xi,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Rm=n=>{if(!n||n==="-")return"";const[e,t]=n.split(":"),s=parseInt(e,10),r=parseInt(t,10),i=s>=12?"":"",o=s%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},kc=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],va=n=>{if(!n)return n;const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of kc)if(s===r)return t.slice(0,-1).join(" ").trim()}for(const s of kc)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},_l=n=>{const e=n.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const s=t[t.length-1];for(const r of kc)if(s===r)return r}for(const s of kc)if(e.endsWith(s))return s;return""},EC=["","","","","","",""],VC=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Fu=["","","/","","","","","","","","","","","","",""],AC={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},CC={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},zh=EC,wC=()=>{const{schedules:n,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:s}=Fr(),{user:r}=$r(),[i,o]=E.useState(!1),l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...zh.filter(d=>d!==l)]:zh,m=d=>{const f=n.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const C=new Set;return v.filter(B=>{const F=`${Ht(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return C.has(F)?!1:(C.add(F),!0)})},y=h(f.filter(v=>Lf(new Date(v.start)))),w=h(f.filter(v=>wx(new Date(v.start))&&!Lf(new Date(v.start))).sort((v,C)=>new Date(v.start).getTime()-new Date(C.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:w,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),y=f.length+h.length,w=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${w?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:113,columnNumber:21},void 0),w&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:112,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[w&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(io,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${w&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:131,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(dg,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:141,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:142,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:140,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((C,B)=>{const S=B.project||"-";return C[S]||(C[S]=[]),C[S].push(B),C},{});return Object.entries(v).map(([C,B])=>{const S=d===l;return a.jsxDEV("div",{className:`border-l-3 ${S?"border-gray-400":"border-gray-900"} ${S?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${S?"bg-amber-100":"bg-gray-100"} border-b ${S?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:164,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:163,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(F=>{const re=F.time&&F.time!=="-"?` - ${Rm(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,re]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:31},void 0)]},C,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:159,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(yx,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:188,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:189,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:187,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((C,B)=>{const S=Ht(new Date(B.start),"MM.dd",{locale:yn}),F=B.project||"-",re=`${S}|${F}`;return C[re]||(C[re]={date:S,project:F,schedules:[]}),C[re].schedules.push(B),C},{});return Object.values(v).map(({date:C,project:B,schedules:S})=>{const re=S.length>0&&Cx(new Date(S[0].start))?`${C} ()`:C;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:211,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:re},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:212,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:210,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:S.map(ee=>{const M=ee.time&&ee.time!=="-"?` - ${Rm(ee.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,M]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:214,columnNumber:31},void 0)]},`${C}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:209,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:186,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:234,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:109,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:101,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:100,columnNumber:7},void 0),i&&a.jsxDEV(KN,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:246,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:98,columnNumber:5},void 0)},iu=()=>{const{user:n}=$r(),{projects:e}=Fr();return E.useMemo(()=>n?n.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(l=>l.trim()):[]).includes(""),o=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||o}):e:[],[n,e])},IC=({value:n,detailValue:e="",onChange:t,onDetailChange:s,placeholder:r=" ",error:i})=>{const[o,l]=E.useState(!1),[u,m]=E.useState(n),[d,f]=E.useState(e),h=E.useRef(null);E.useEffect(()=>{const B=S=>{h.current&&!h.current.contains(S.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),E.useEffect(()=>{m(n)},[n]),E.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((B,S)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>B(!0),F.onerror=()=>S(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),w=B=>{const S=B.roadAddr||B.jibunAddr;m(S),t(S,d),l(!1)},v=B=>{const S=B.target.value;f(S),s&&s(S),u&&t(u,S)},C=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const S={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};w(S)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>C(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(fg,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:C,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},Wh=["","","","","","",""],TC=({project:n,onClose:e,onSave:t})=>{const{register:s,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=rf({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=E.useState([]),[d,f]=E.useState(""),[h,y]=E.useState(""),[w,v]=E.useState(""),[C,B]=E.useState(!1);E.useEffect(()=>{var M;if(n){const V=n.location?n.location.split(","):["",""],N=((M=V[0])==null?void 0:M.trim())||n.location||"",A=V.length>1?V.slice(1).join(",").trim():"";o({name:n.name,client:n.client||"",location:N,detailLocation:A,startDate:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:"",endDate:n.endDate?new Date(n.endDate).toISOString().split("T")[0]:""}),y(N),v(A);const j=n.manager?n.manager.split(",").map(T=>T.trim()).filter(T=>T&&T!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[n,o]);const S=M=>{m(V=>V.includes(M)?V.filter(N=>N!==M):[...V,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},re=M=>{m(V=>V.filter(N=>N!==M))},ee=async M=>{if(C)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const V=h&&w?`${h}, ${w}`:h||M.location,N={name:M.name,client:M.client,location:V,manager:u.join(", "),contractAmount:(n==null?void 0:n.contractAmount)??0,spent:(n==null?void 0:n.spent)??0,status:(n==null?void 0:n.status)??"planning",progress:(n==null?void 0:n.progress)??0,description:(n==null?void 0:n.description)??"",meetingNotes:(n==null?void 0:n.meetingNotes)??[],customerRequests:(n==null?void 0:n.customerRequests)??[],entrancePassword:(n==null?void 0:n.entrancePassword)??"",sitePassword:(n==null?void 0:n.sitePassword)??""};if(M.startDate&&M.startDate!=="")N.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(n!=null&&n.startDate){const A=typeof n.startDate=="string"&&n.startDate.includes("T")?n.startDate.split("T")[0]:n.startDate;N.startDate=A,console.log(" Keeping existing startDate:",N.startDate)}if(M.endDate&&M.endDate!=="")N.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(n!=null&&n.endDate){const A=typeof n.endDate=="string"&&n.endDate.includes("T")?n.endDate.split("T")[0]:n.endDate;N.endDate=A,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(A){throw B(!1),A}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:n?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(IC,{value:h,detailValue:w,onChange:(M,V)=>{y(M),v(V||""),i("location",M),i("detailLocation",V||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[Wh.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>S(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!Wh.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>re(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:C,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:C?" ...":n?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},SC=({projectName:n,meetingNotes:e,onClose:t,onSave:s,onDelete:r})=>{const[i,o]=E.useState(""),[l,u]=E.useState(new Date().toISOString().split("T")[0]),[m,d]=E.useState(!1),[f,h]=E.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},w=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await s(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},C=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:w,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ht(new Date(B.date),"yyyy.MM.dd (eee)",{locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>C(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},PC=({projectName:n,customerRequests:e,onClose:t,onSave:s,onToggleComplete:r,onDelete:i})=>{const[o,l]=E.useState(""),[u,m]=E.useState(new Date().toISOString().split("T")[0]),[d,f]=E.useState(!1),[h,y]=E.useState(!1),w=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await s(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},C=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=ee=>{window.confirm("  ?")&&i(ee)},S=ee=>{r(ee)},F=e.filter(ee=>!ee.completed),re=e.filter(ee=>ee.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:w,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:ee=>m(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:ee=>l(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:C,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(ee=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>S(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(bx,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ht(new Date(ee.createdAt),"yyyy.MM.dd",{locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),re.map(ee=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>S(ee.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(Nx,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ht(new Date(ee.createdAt),"yyyy.MM.dd",{locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},LC=({projectName:n,entrancePassword:e,sitePassword:t,onClose:s,onSave:r})=>{const[i,o]=E.useState(e||""),[l,u]=E.useState(t||""),[m,d]=E.useState(!1),[f,h]=E.useState(!1),y=()=>{d(!0)},w=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:C=>C.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:C=>o(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:C=>u(C.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:w,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},jC=({projectName:n,onClose:e})=>{var o;const[t,s]=E.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>s({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>s({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>s({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>s({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>s({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>s({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&s({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>s({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(pg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ht(new Date(t.startDate),"yyyy",{locale:yn}),"",Ht(new Date(t.startDate),"MM",{locale:yn}),"",Ht(new Date(t.startDate),"dd",{locale:yn})," ~ ",Ht(new Date(t.endDate),"yyyy",{locale:yn}),"",Ht(new Date(t.endDate),"MM",{locale:yn}),"",Ht(new Date(t.endDate),"dd",{locale:yn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},RC=()=>{const{loadProjectsFromAPI:n,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:s}=Fr(),{user:r}=$r(),i=iu(),[o,l]=E.useState("in-progress"),[u,m]=E.useState("grid"),[d,f]=E.useState(!1),[h,y]=E.useState(null),[w,v]=E.useState(!1),[C,B]=E.useState(!1),[S,F]=E.useState(!1),[re,ee]=E.useState(!1),[M,V]=E.useState(null),N=(K,Se)=>`lastViewed_${r==null?void 0:r.id}_${K}_${Se}`,A=(K,Se)=>{const Be=N(K,Se),Ie=localStorage.getItem(Be);return Ie?parseInt(Ie,10):0},j=(K,Se)=>{const Be=N(K,Se);localStorage.setItem(Be,Date.now().toString())},T=(K,Se)=>{const Be=A(K.id,Se);return Se==="meeting"?(K.meetingNotes||[]).some(Ge=>(Ge.createdAt?new Date(Ge.createdAt).getTime():new Date(Ge.date).getTime())>Be):(K.customerRequests||[]).some(Ge=>!Ge.completed)};E.useEffect(()=>{n().catch(K=>{console.error("Failed to load projects:",K),oe.error("   ")})},[n]),E.useEffect(()=>{const K=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const I=(K,Se)=>{if(!K||!Se)return 0;const Be=new Date,Ie=new Date(K),Ge=new Date(Se);if(Be<Ie)return 0;if(Be>Ge)return 100;const At=Math.ceil((Ge.getTime()-Ie.getTime())/(1e3*60*60*24)),qt=Math.ceil((Be.getTime()-Ie.getTime())/(1e3*60*60*24)),ct=Math.round(qt/At*100);return Math.min(100,Math.max(0,ct))},k=K=>{y(K),f(!0)},_e=async(K,Se)=>{if(window.confirm(`"${Se}"  ?

    .`))try{await s(K),oe.success(" ")}catch(Be){console.error("Failed to delete project:",Be),oe.error("  ")}},Fe=async K=>{try{if(h)await t(h.id,K),oe.success(" ");else{const Se={id:"",...K,team:K.team||[]};await e(Se),oe.success(" "),l(K.status||"planning")}f(!1),y(null)}catch(Se){console.error("Failed to save project:",Se),oe.error("  ")}},he=async(K,Se)=>{try{await t(K,{status:Se}),oe.success(" ")}catch(Be){console.error("Failed to update project status:",Be),oe.error("  ")}},Re=K=>{V(K),v(!0),j(K.id,"meeting")},dt=K=>{V(K),B(!0),j(K.id,"request")},Ot=K=>{V(K),F(!0)},Ut=K=>{V(K),ee(!0)},ae=async(K,Se)=>{if(!M)return;const Be=M.entrancePassword,Ie=M.sitePassword;V({...M,entrancePassword:K,sitePassword:Se});try{await t(M.id,{entrancePassword:K,sitePassword:Se}),oe.success(" ")}catch(Ge){console.error("Failed to save passwords:",Ge),oe.error("  "),V({...M,entrancePassword:Be,sitePassword:Ie})}},Oe=async(K,Se)=>{if(!M)return;const Be={id:Date.now().toString(),content:K,date:Se,createdAt:new Date},Ie=[...M.meetingNotes||[],Be];V({...M,meetingNotes:Ie});try{await t(M.id,{meetingNotes:Ie}),oe.success("  ")}catch(Ge){console.error("Failed to save meeting note:",Ge),oe.error("   "),V({...M,meetingNotes:M.meetingNotes||[]})}},me=async(K,Se)=>{if(!M)return;const Be={id:Date.now().toString(),content:K,completed:!1,createdAt:Se},Ie=[...M.customerRequests||[],Be];V({...M,customerRequests:Ie});try{await t(M.id,{customerRequests:Ie}),oe.success("  ")}catch(Ge){console.error("Failed to save customer request:",Ge),oe.error("   "),V({...M,customerRequests:M.customerRequests||[]})}},Le=async K=>{if(!M)return;const Se=M.customerRequests||[],Be=Se.map(Ie=>Ie.id===K?{...Ie,completed:!Ie.completed}:Ie);V({...M,customerRequests:Be});try{await t(M.id,{customerRequests:Be}),oe.success("  ")}catch(Ie){console.error("Failed to toggle request:",Ie),oe.error("  "),V({...M,customerRequests:Se})}},Ke=async K=>{if(!M)return;const Se=M.meetingNotes||[],Be=Se.filter(Ie=>Ie.id!==K);V({...M,meetingNotes:Be});try{await t(M.id,{meetingNotes:Be}),oe.success("  ")}catch(Ie){console.error("Failed to delete meeting note:",Ie),oe.error(" "),V({...M,meetingNotes:Se})}},bt=async K=>{if(!M)return;const Se=M.customerRequests||[],Be=Se.filter(Ie=>Ie.id!==K);V({...M,customerRequests:Be});try{await t(M.id,{customerRequests:Be}),oe.success("  ")}catch(Ie){console.error("Failed to delete customer request:",Ie),oe.error(" "),V({...M,customerRequests:Se})}},it=({project:K})=>{const Be={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:Ie=>he(K.id,Ie.target.value),className:Ns("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Be.color),onClick:Ie=>Ie.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},rt=(()=>{let K=i;return o!=="all"&&(K=K.filter(Se=>Se.status===o)),r!=null&&r.name&&(K=[...K].sort((Se,Be)=>{var At,qt;const Ie=Se.manager===r.name||((At=Se.team)==null?void 0:At.includes(r.name)),Ge=Be.manager===r.name||((qt=Be.team)==null?void 0:qt.includes(r.name));return Ie&&!Ge?-1:!Ie&&Ge?1:0})),K})(),ut={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},un=({project:K})=>{var Be,Ie,Ge;const Se=I(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ut(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${Ht(K.startDate,"MM.dd (eee)",{locale:yn})} - ${Ht(K.endDate,"MM.dd (eee)",{locale:yn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>Ot(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Se,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Se}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>Re(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Be=K.meetingNotes)==null?void 0:Be.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Ie=K.meetingNotes)==null?void 0:Ie.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),T(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ge=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Ge.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var ct;const At=((ct=K.customerRequests)==null?void 0:ct.filter(P=>!P.completed))||[],qt=At[At.length-1];return a.jsxDEV("div",{onClick:()=>dt(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",At.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",At.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),T(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),qt?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:qt.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>_e(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ut.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ut.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ut.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Ns("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Ns("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Ns("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Ns("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(io,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:rt.map(K=>a.jsxDEV(un,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:rt.map(K=>{var Be,Ie,Ge,At;const Se=I(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[Ht(K.startDate,"yyyy.MM.dd (eee)",{locale:yn})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ht(K.endDate,"yyyy.MM.dd (eee)",{locale:yn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ut(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>Ot(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Se}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Se,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>Re(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Be=K.meetingNotes)==null?void 0:Be.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Ie=K.meetingNotes)==null?void 0:Ie.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),T(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ge=K.meetingNotes)!=null&&Ge.length?((At=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:At.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const qt=((P=K.customerRequests)==null?void 0:P.filter(q=>!q.completed))||[],ct=qt[qt.length-1];return a.jsxDEV("div",{onClick:()=>dt(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",qt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",qt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),T(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:ct?ct.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>_e(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(TC,{project:h,onClose:()=>{f(!1),y(null)},onSave:Fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),w&&M&&a.jsxDEV(SC,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),V(null)},onSave:Oe,onDelete:Ke},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),C&&M&&a.jsxDEV(PC,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{B(!1),V(null)},onSave:me,onToggleComplete:Le,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),S&&M&&a.jsxDEV(LC,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),V(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),re&&M&&a.jsxDEV(jC,{projectName:M.name,onClose:()=>{ee(!1),V(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var of={},GN={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(GN);var zn=GN.exports,af={},QN={exports:{}},YN={exports:{}},XN={exports:{}},JN={exports:{}};(function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(JN);var wo=JN.exports,ZN={exports:{}};(function(n){var e=wo.default;function t(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var o=i.call(s,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(ZN);var BC=ZN.exports;(function(n){var e=wo.default,t=BC;function s(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(XN);var e0=XN.exports;(function(n){var e=e0;function t(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(YN);var t0=YN.exports;(function(n){var e=t0;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function s(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(QN);var Gr=QN.exports,n0={exports:{}},s0={exports:{}};(function(n){function e(t,s){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(s.indexOf(i)!==-1)continue;r[i]=t[i]}return r}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(s0);var UC=s0.exports;(function(n){var e=UC;function t(s,r){if(s==null)return{};var i,o,l=e(s,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(l[i]=s[i])}return l}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(n0);var lf=n0.exports,r0={exports:{}};(function(n){function e(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(r0);var Si=r0.exports,i0={exports:{}};(function(n){var e=e0;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function s(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(i0);var Pi=i0.exports,o0={exports:{}},a0={exports:{}};(function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(a0);var HC=a0.exports,l0={exports:{}};(function(n){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n.exports=e=function(){return!!t},n.exports.__esModule=!0,n.exports.default=n.exports)()}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(l0);var MC=l0.exports,c0={exports:{}},u0={exports:{}};(function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(u0);var FC=u0.exports;(function(n){var e=wo.default,t=FC;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}n.exports=s,n.exports.__esModule=!0,n.exports.default=n.exports})(c0);var OC=c0.exports;(function(n){var e=HC,t=MC,s=OC;function r(i,o,l){return o=e(o),s(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(o0);var Io=o0.exports,m0={exports:{}},d0={exports:{}};(function(n){function e(t,s){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,s)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(d0);var qC=d0.exports;(function(n){var e=qC;function t(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(m0);var To=m0.exports;const el=Fa(Ix);var ks={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.views=Do.navigate=void 0;Do.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Do.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var $C=zn.default;Object.defineProperty(ks,"__esModule",{value:!0});ks.views=ks.dateRangeFormat=ks.dateFormat=ks.accessor=ks.DayLayoutAlgorithmPropType=void 0;var ts=$C(hg),Kh=Do,Gh=Object.keys(Kh.views).map(function(n){return Kh.views[n]});ks.accessor=ts.default.oneOfType([ts.default.string,ts.default.func]);ks.dateFormat=ts.default.any;ks.dateRangeFormat=ts.default.func;ks.views=ts.default.oneOfType([ts.default.arrayOf(ts.default.oneOf(Gh)),ts.default.objectOf(function(n,e){var t=Gh.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return ts.default.elementType.apply(ts.default,[n,e].concat(r))})]);ks.DayLayoutAlgorithmPropType=ts.default.oneOfType([ts.default.oneOf(["overlap","no-overlap"]),ts.default.func]);var ou={},So={},zC=zn.default;Object.defineProperty(So,"__esModule",{value:!0});So.accessor=f0;So.wrapAccessor=void 0;var WC=zC(wo);function f0(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&(0,WC.default)(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}So.wrapAccessor=function(e){return function(t){return f0(t,e)}};var Li={},KC=zn.default;Object.defineProperty(Li,"__esModule",{value:!0});Li.DnDContext=void 0;var GC=KC(E);Li.DnDContext=GC.default.createContext();var ji=zn.default;Object.defineProperty(ou,"__esModule",{value:!0});ou.default=void 0;var QC=ji(Gr),YC=ji(Si),XC=ji(Pi),JC=ji(Io),ZC=ji(To),Gi=ji(E),Qh=ji(el),Yh=So,ew=Li,p0=function(n){function e(){var t;(0,YC.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,JC.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,QC.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,ZC.default)(e,n),(0,XC.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return Gi.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},Gi.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,o=s.continuesPrior,l=s.continuesAfter,u=s.resizable,m=this.props.children;if(r.__isPreview)return Gi.default.cloneElement(m,{className:(0,Qh.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,Yh.accessor)(r,f):!0;if(!y)return m;var w=u&&(h?!!(0,Yh.accessor)(r,h):!0);if(w||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(w){var C=null,B=null;i==="date"?(C=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(C=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),v.children=Gi.default.createElement("div",{className:"rbc-addons-dnd-resizable"},C,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Qh.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=Gi.default.cloneElement(m,v)}return m}}])}(Gi.default.Component);p0.contextType=ew.DnDContext;ou.default=p0;var au={},h0={exports:{}};(function(n){var e=wo.default;function t(s,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(n.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(h,y,f):h[y]=u[y]);return h},n.exports.__esModule=!0,n.exports.default=n.exports)(s,r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(h0);var g0=h0.exports;function cf(n,e,t,s){if(t===void 0&&(t=!1),s===void 0&&(s=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,s),n.dispatchEvent(r)}}function tw(n){var e=xs(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function nw(n,e,t){t===void 0&&(t=5);var s=!1,r=setTimeout(function(){s||cf(n,"transitionend",!0)},e+t),i=Ec(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function uf(n,e,t,s){t==null&&(t=tw(n)||0);var r=nw(n,t,s),i=Ec(n,"transitionend",e);return function(){r(),i()}}var Xh={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Jh(n){var e=n.node,t=n.properties,s=n.duration,r=s===void 0?200:s,i=n.easing,o=n.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var y=t[h];Tx(h)?m+=h+"("+y+") ":(u[h]=y,l.push(Sx(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(xs(e,Xh),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=uf(e,d,r);return e.clientLeft,xs(e,u),{cancel:function(){f(),xs(e,Xh)}}}function y0(n,e,t,s,r){if(!("nodeType"in n))return Jh(n);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Jh({node:n,properties:e,duration:t,easing:s,callback:r})}function b0(n,e,t){if(n){if(typeof t>"u")return n.getAttribute(e);!t&&t!==""?n.removeAttribute(e):n.setAttribute(e,String(t))}}function N0(n){return n?Array.from(n.children):[]}function x0(n){if(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}return null}var sw=Function.prototype.bind.call(Function.prototype.call,[].slice);function v0(n){return n?sw(n.childNodes):[]}function _0(n,e){return function(s){var r=s.currentTarget,i=s.target,o=Om(r,n);o.some(function(l){return qm(l,i)})&&e.call(this,s)}}function D0(n,e){return n&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(n,e.nextSibling):e.parentNode.appendChild(n),n):null}var rw=/^(?:input|select|textarea|button)$/i;function k0(n){return n?rw.test(n.nodeName):!1}function E0(n){return n?!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length):!1}function V0(n,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var s=[];n;n=n.nextElementSibling)if(n!==e){if(t&&$m(n,t))break;s.push(n)}return s}function A0(n,e){return V0(n,n,e)}function iw(n,e){var t=null,s=[];for(t=n?n[e]:null;t&&t.nodeType!==9;)s.push(t),t=t[e]||null;return s}function C0(n){return iw(n,"parentElement")}function w0(n,e){return n&&e?(e.firstElementChild?e.insertBefore(n,e.firstElementChild):e.appendChild(n),n):null}function I0(n){return n&&n.parentNode?(n.parentNode.removeChild(n),n):null}function mf(n,e){var t=xs(n,"position"),s=t==="absolute",r=n.ownerDocument;if(t==="fixed")return r||document;for(;(n=n.parentNode)&&!Px(n);){var i=s&&xs(n,"position")==="static",o=(xs(n,"overflow")||"")+(xs(n,"overflow-y")||"")+xs(n,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Vc(n)<n.scrollHeight))return n}return r||document}function T0(n,e){var t=Ql(n),s={top:0,left:0};if(n){var r=e||mf(n),i=Lx(r),o=Yl(r),l=Vc(r,!0);i||(s=Ql(r)),t={top:t.top-s.top,left:t.left-s.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=zm(function(){return Yl(r,o)});return function(){return Wm(f)}}}function S0(n){return V0(n&&n.parentElement?n.parentElement.firstElementChild:null,n)}var ow=/&nbsp;/gi,aw=/\xA0/g,lw=/\s+([^\s])/gm;function P0(n,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var s="";return n&&(s=(n.textContent||"").replace(ow," ").replace(aw," "),e&&(s=s.trim()),t&&(s=s.replace(lw," $1"))),s}function L0(n,e){n.classList?n.classList.toggle(e):Km(n,e)?Gm(n,e):Qm(n,e)}const cw={addEventListener:Ag,removeEventListener:Vg,triggerEvent:cf,animate:y0,filter:_0,listen:Ec,style:xs,getComputedStyle:Eg,attribute:b0,activeElement:kg,ownerDocument:Dg,ownerWindow:_g,requestAnimationFrame:zm,cancelAnimationFrame:Wm,matches:$m,height:Vc,width:vg,offset:Ql,offsetParent:xg,position:Ng,contains:qm,scrollbarSize:bg,scrollLeft:yg,scrollParent:mf,scrollTo:T0,scrollTop:Yl,querySelectorAll:Om,closest:gg,addClass:Qm,removeClass:Gm,hasClass:Km,toggleClass:L0,transitionEnd:uf,childNodes:v0,childElements:N0,nextUntil:A0,parents:C0,siblings:S0,clear:x0,insertAfter:D0,isInput:k0,isVisible:E0,prepend:w0,remove:I0,text:P0},uw=Object.freeze(Object.defineProperty({__proto__:null,activeElement:kg,addClass:Qm,addEventListener:Ag,animate:y0,attribute:b0,cancelAnimationFrame:Wm,childElements:N0,childNodes:v0,clear:x0,closest:gg,contains:qm,default:cw,filter:_0,getComputedStyle:Eg,hasClass:Km,height:Vc,insertAfter:D0,isInput:k0,isVisible:E0,listen:Ec,matches:$m,nextUntil:A0,offset:Ql,offsetParent:xg,ownerDocument:Dg,ownerWindow:_g,parents:C0,position:Ng,prepend:w0,querySelectorAll:Om,remove:I0,removeClass:Gm,removeEventListener:Vg,requestAnimationFrame:zm,scrollLeft:yg,scrollParent:mf,scrollTo:T0,scrollTop:Yl,scrollbarSize:bg,siblings:S0,style:xs,text:P0,toggleClass:L0,transitionEnd:uf,triggerEvent:cf,width:vg},Symbol.toStringTag,{value:"Module"})),mw=Fa(uw);var Bm={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return t(r.querySelectorAll(i))}n.exports=e.default})(Bm,Bm.exports);var dw=Bm.exports,Cs={};const fw=Fa(jx),pw=Fa(Rx),hw=Fa(Bx);var Po=zn.default;Object.defineProperty(Cs,"__esModule",{value:!0});Cs.default=void 0;Cs.getBoundsForNode=Ma;Cs.getEventNodeFromPoint=R0;Cs.getShowMoreNodeFromPoint=B0;Cs.isEvent=vw;Cs.isShowMore=_w;Cs.objectsCollide=Hm;var gw=Po(wo),yw=Po(Si),bw=Po(Pi),Um=Po(fw),j0=Po(pw),Nw=Po(hw);function Mn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,Nw.default)(t,n,e,{passive:!1})}function xw(n,e,t){return!n||(0,Um.default)(n,document.elementFromPoint(e,t))}function R0(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,j0.default)(r,".rbc-event",n)}function B0(n,e){var t=e.clientX,s=e.clientY,r=document.elementFromPoint(t,s);return(0,j0.default)(r,".rbc-show-more",n)}function vw(n,e){return!!R0(n,e)}function _w(n,e){return!!B0(n,e)}function Jo(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Zh=5,Dw=250,kw=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.global,r=s===void 0?!1:s,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,yw.default)(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Mn("touchmove",function(){},window),this._removeKeyDownListener=Mn("keydown",this._keyListener),this._removeKeyUpListener=Mn("keyup",this._keyListener),this._removeDropFromOutsideListener=Mn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Mn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,bw.default)(n,[{key:"on",value:function(t,s){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(s),{remove:function(){var o=r.indexOf(s);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var s=this._selectRect;return!s||!this.selecting?!1:Hm(s,Ma(t))}},{key:"filter",value:function(t){var s=this._selectRect;return!s||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,s){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=Mn("touchmove",function(){return d()}),l=Mn("touchend",function(){return d()})},m=Mn("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return s&&u(s),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,s=Mn("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Mn("mousedown",t._handleInitialEvent)}),r=Mn("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var s=Jo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var s=Jo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var s=Jo(t),r=s.clientX,i=s.clientY,o=s.pageX,l=s.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!xw(u,r,i))){if(!this.globalMouse&&u&&!(0,Um.default)(u,t.target)){var f=Ew(0),h=f.top,y=f.left,w=f.bottom,v=f.right;if(d=Ma(u),m=Hm({top:d.top-h,left:d.left-y,bottom:d.bottom+w,right:d.right+v},{top:l,left:o}),!m)return}var C=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(C!==!1)switch(t.type){case"mousedown":this._removeEndListener=Mn("mouseup",this._handleTerminatingEvent),this._onEscListener=Mn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Mn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Mn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Mn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var s=t.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var s=this.selecting,r=this._selectRect;if(!s&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Um.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!s&&i?this._handleClickEvent(t):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var s=Jo(t),r=s.pageX,i=s.pageY,o=s.clientX,l=s.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<Dw?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,o=Jo(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),y=this.selecting,w=this.isClick(l,u);w&&!y&&!(m||d)||(!y&&!w&&this.emit("selectStart",this._initialEventData),w||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,s){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Zh&&Math.abs(s-o)<=Zh}}])}();function Ew(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,gw.default)(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function Hm(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=Ma(n),r=s.top,i=s.left,o=s.right,l=o===void 0?i:o,u=s.bottom,m=u===void 0?r:u,d=Ma(e),f=d.top,h=d.left,y=d.right,w=y===void 0?h:y,v=d.bottom,C=v===void 0?f:v;return!(m-t<f||r+t>C||l-t<h||i+t>w)}function Ma(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+eg("left"),s=e.top+eg("top");return{top:s,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+s}}function eg(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}Cs.default=kw;var lu={},cu=zn.default;Object.defineProperty(lu,"__esModule",{value:!0});lu.default=void 0;var Vw=cu(t0),tg=cu(Gr),Aw=cu(el),Zo=cu(E);function Dl(n){return typeof n=="string"?n:n+"%"}function Cw(n){var e=n.style,t=n.className,s=n.event,r=n.accessors,i=n.rtl,o=n.selected,l=n.label,u=n.continuesPrior,m=n.continuesAfter,d=n.getters,f=n.onClick,h=n.onDoubleClick,y=n.isBackgroundEvent,w=n.onKeyPress,v=n.components,C=v.event,B=v.eventWrapper,S=r.title(s),F=r.tooltip(s),re=r.end(s),ee=r.start(s),M=d.eventProp(s,ee,re,o),V=[Zo.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Zo.default.createElement("div",{key:"2",className:"rbc-event-content"},C?Zo.default.createElement(C,{event:s,title:S}):S)],N=e.height,A=e.top,j=e.width,T=e.xOffset,I=(0,tg.default)((0,tg.default)({},M.style),{},(0,Vw.default)({top:Dl(A),height:Dl(N),width:Dl(j)},i?"right":"left",Dl(T)));return Zo.default.createElement(B,Object.assign({type:"time"},n),Zo.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:I,onKeyDown:w,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,Aw.default)(y?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},V))}lu.default=Cw;var ar={},U0=zn.default;Object.defineProperty(ar,"__esModule",{value:!0});ar.dragAccessors=void 0;ar.eventTimes=Rw;ar.mergeComponents=Lw;ar.pointInColumn=jw;var ww=U0(Gr),Iw=U0(lf),ng=So,Tw=E,Sw=["children"];ar.dragAccessors={start:(0,ng.wrapAccessor)(function(n){return n.start}),end:(0,ng.wrapAccessor)(function(n){return n.end})};function Pw(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s=function(i){var o=i.children,l=(0,Iw.default)(i,Sw);return e.filter(Boolean).reduceRight(function(u,m){return(0,Tw.createElement)(m,l,u)},o)};return s}function Lw(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),s=(0,ww.default)({},n);return t.forEach(function(r){s[r]=n[r]?Pw(n[r],e[r]):e[r]}),s}function jw(n,e){var t=n.left,s=n.right,r=n.top,i=e.x,o=e.y;return i<s+10&&i>t&&o>r}function Rw(n,e,t){var s=e.start(n),r=e.end(n),i=t.eq(s,r,"minutes")&&t.diff(s,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(s,r,"milliseconds");return{start:s,end:r,duration:o}}var Bw=g0.default,Qr=zn.default;Object.defineProperty(au,"__esModule",{value:!0});au.default=void 0;var xr=Qr(Gr),Uw=Qr(Si),Hw=Qr(Pi),Mw=Qr(Io),Fw=Qr(To),Ou=mw,Ow=Qr(dw),ri=Qr(E),qw=Li,vr=Bw(Cs),$w=Qr(lu),Ys=ar,H0=function(n){function e(){var t;(0,Uw.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,Mw.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,Ys.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,Ys.eventTimes)(u,d,t.props.localizer),w=y.duration,v=t.props.localizer.add(h,w,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,Ys.eventTimes)(f,u,d),y=h.duration,w=m.nextSlot(o),v=!isNaN(y);if(v){var C=d.add(o,y,"milliseconds");w=new Date(Math.max(C,w))}return w},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,Ow.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Ou.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Ou.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new vr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Ou.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,Ys.pointInColumn)((0,vr.getBoundsForNode)(l),f);var y=(0,vr.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,vr.getBoundsForNode)(y).top}),m.on("selecting",function(f){var h=(0,vr.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,vr.getBoundsForNode)(l);(0,Ys.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,vr.getBoundsForNode)(l);if(!(0,Ys.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,vr.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,Ys.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=ri.default.createRef(),t}return(0,Fw.default)(e,n),(0,Hw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,xr.default)((0,xr.default)({},s),{},{start:i,end:o})})}},{key:"handleResize",value:function(s,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(s,r),y=(0,Ys.eventTimes)(d,o,u),w=y.start,v=y.end,C;if(f==="UP"){var B=u.min(h,l.closestSlotFromDate(v,-1));C=l.getRange(B,v),C=(0,xr.default)((0,xr.default)({},C),{},{endDate:v})}else if(f==="DOWN"){var S=u.max(h,l.closestSlotFromDate(w));C=l.getRange(w,S),C=(0,xr.default)((0,xr.default)({},C),{},{startDate:w})}this.update(d,C)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,o=s.components,l=s.getters,u=s.slotMetrics,m=s.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var w=r.props.children,v=f.start,C=f.end,B,S="eventTimeRangeFormat",F=u.startsBeforeDay(v),re=u.startsAfterDay(C);return F?S="eventTimeRangeEndFormat":re&&(S="eventTimeRangeStartFormat"),F&&re?B=m.messages.allDay:B=m.format({start:v,end:C},S),ri.default.cloneElement(r,{children:ri.default.createElement(ri.default.Fragment,null,w,f&&ri.default.createElement($w.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:l,components:o,accessors:(0,xr.default)((0,xr.default)({},i),Ys.dragAccessors),continuesPrior:F,continuesAfter:re}))})}},{key:"render",value:function(){return ri.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(ri.default.Component);H0.contextType=qw.DnDContext;au.default=H0;var uu={},M0={exports:{}},F0={exports:{}},O0={exports:{}};(function(n){function e(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,i=Array(s);r<s;r++)i[r]=t[r];return i}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(O0);var q0=O0.exports;(function(n){var e=q0;function t(s){if(Array.isArray(s))return e(s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(F0);var zw=F0.exports,$0={exports:{}};(function(n){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})($0);var Ww=$0.exports,z0={exports:{}};(function(n){var e=q0;function t(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(z0);var Kw=z0.exports,W0={exports:{}};(function(n){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(W0);var Gw=W0.exports;(function(n){var e=zw,t=Ww,s=Kw,r=Gw;function i(o){return e(o)||t(o)||s(o)||r()}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})(M0);var K0=M0.exports,mu={},du={},fu={},Yr=zn.default;Object.defineProperty(fu,"__esModule",{value:!0});fu.default=void 0;var sg=Yr(Gr),Qw=Yr(lf),Yw=Yr(Si),Xw=Yr(Pi),Jw=Yr(Io),Zw=Yr(To),ea=Yr(E),e2=Yr(el),t2=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],n2=function(n){function e(){return(0,Yw.default)(this,e),(0,Jw.default)(this,e,arguments)}return(0,Zw.default)(e,n),(0,Xw.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,o=s.event,l=s.selected,u=s.isAllDay,m=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,h=s.localizer,y=s.continuesPrior,w=s.continuesAfter,v=s.accessors,C=s.getters,B=s.children,S=s.components,F=S.event,re=S.eventWrapper,ee=s.slotStart,M=s.slotEnd,V=(0,Qw.default)(s,t2);delete V.resizable;var N=v.title(o),A=v.tooltip(o),j=v.end(o),T=v.start(o),I=v.allDay(o),k=u||I||h.diff(T,h.ceil(j,"day"),"day")>1,_e=C.eventProp(o,T,j,l),Fe=ea.default.createElement("div",{className:"rbc-event-content",title:A||void 0},F?ea.default.createElement(F,{event:o,continuesPrior:y,continuesAfter:w,title:N,isAllDay:I,localizer:h,slotStart:ee,slotEnd:M}):N);return ea.default.createElement(re,Object.assign({},this.props,{type:"date"}),ea.default.createElement("div",Object.assign({},V,{style:(0,sg.default)((0,sg.default)({},_e.style),r),className:(0,e2.default)("rbc-event",i,_e.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":w}),onClick:function(Re){return m&&m(o,Re)},onDoubleClick:function(Re){return d&&d(o,Re)},onKeyDown:function(Re){return f&&f(o,Re)}}),typeof B=="function"?B(Fe):Fe))}}])}(ea.default.Component);fu.default=n2;var Xr={},s2=zn.default;Object.defineProperty(Xr,"__esModule",{value:!0});Xr.dateCellSelection=a2;Xr.getSlotAtX=G0;Xr.isSelected=i2;Xr.pointInBox=o2;Xr.slotWidth=df;var r2=s2(Ux);function i2(n,e){return!n||e==null?!1:(0,r2.default)(n,e)}function df(n,e){var t=n.right-n.left,s=t/e;return s}function G0(n,e,t,s){var r=df(n,s);return t?s-1-Math.floor((e-n.left)/r):Math.floor((e-n.left)/r)}function o2(n,e){var t=e.x,s=e.y;return s>=n.top&&s<=n.bottom&&t>=n.left&&t<=n.right}function a2(n,e,t,s,r){var i=-1,o=-1,l=s-1,u=df(e,s),m=G0(e,t.x,r,s),d=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,h=n.y>e.bottom,y=e.top>n.y,w=t.top<e.top&&t.bottom>e.bottom;return w&&(i=0,o=l),d&&(y?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((n.x-e.left)/u):Math.floor((n.x-e.left)/u),d?m<i?i=m:o=m:n.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var ff=zn.default;Object.defineProperty(du,"__esModule",{value:!0});du.default=void 0;var Ps=ff(hg),rg=ff(E),l2=ff(fu),c2=Xr;du.default={propTypes:{slotMetrics:Ps.default.object.isRequired,selected:Ps.default.object,isAllDay:Ps.default.bool,accessors:Ps.default.object.isRequired,localizer:Ps.default.object.isRequired,components:Ps.default.object.isRequired,getters:Ps.default.object.isRequired,onSelect:Ps.default.func,onDoubleClick:Ps.default.func,onKeyPress:Ps.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(t),w=d.continuesAfter(t);return rg.default.createElement(l2.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:w,slotStart:d.first,slotEnd:d.last,selected:(0,c2.isSelected)(t,s),resizable:h})},renderSpan:function(e,t,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return rg.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Jr=zn.default;Object.defineProperty(mu,"__esModule",{value:!0});mu.default=void 0;var u2=Jr(Gr),m2=Jr(Si),d2=Jr(Pi),f2=Jr(Io),p2=Jr(To),h2=Jr(el),ig=Jr(E),Gl=Jr(du),Q0=function(n){function e(){return(0,m2.default)(this,e),(0,f2.default)(this,e,arguments)}return(0,p2.default)(e,n),(0,d2.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return ig.default.createElement("div",{className:(0,h2.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,y=d.left,w=d.right,v=d.span,C="_lvl_"+f,B=y-u,S=Gl.default.renderEvent(s.props,h);return B&&m.push(Gl.default.renderSpan(o,B,"".concat(C,"_gap"))),m.push(Gl.default.renderSpan(o,v,C,S)),u=w+1,m},[]))}}])}(ig.default.Component);Q0.defaultProps=(0,u2.default)({},Gl.default.defaultProps);mu.default=Q0;var lr={},Y0=zn.default;Object.defineProperty(lr,"__esModule",{value:!0});lr.endOfRange=X0;lr.eventLevels=b2;lr.eventSegments=y2;lr.inRange=N2;lr.segsOverlap=J0;lr.sortEvents=Mm;lr.sortWeekEvents=x2;var qu=Y0(K0),g2=Y0(Hx);function X0(n){var e=n.dateRange,t=n.unit,s=t===void 0?"day":t,r=n.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function y2(n,e,t,s){var r=X0({dateRange:e,localizer:s}),i=r.first,o=r.last,l=s.diff(i,o,"day"),u=s.max(s.startOf(t.start(n),"day"),i),m=s.min(s.ceil(t.end(n),"day"),o),d=(0,g2.default)(e,function(h){return s.isSameDate(h,u)}),f=s.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-s.segmentOffset,1),{event:n,span:f,left:d+1,right:Math.max(d+f,1)}}function b2(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,s,r,i=[],o=[];for(t=0;t<n.length;t++){for(r=n[t],s=0;s<i.length&&J0(r,i[s]);s++);s>=e?o.push(r):(i[s]||(i[s]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function N2(n,e,t,s,r){var i={start:s.start(n),end:s.end(n)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function J0(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function x2(n,e,t){var s=(0,qu.default)(n),r=[],i=[];s.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return Mm(u,m,e,t)}),l=i.sort(function(u,m){return Mm(u,m,e,t)});return[].concat((0,qu.default)(o),(0,qu.default)(l))}function Mm(n,e,t,s){var r={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var v2=g0.default,Zr=zn.default;Object.defineProperty(uu,"__esModule",{value:!0});uu.default=void 0;var kl=Zr(Gr),_2=Zr(K0),D2=Zr(Si),k2=Zr(Pi),E2=Zr(Io),V2=Zr(To),El=Zr(E),A2=Zr(mu),Qi=v2(Cs),C2=lr,_r=Xr,Vl=ar,w2=Li,Z0=function(n){function e(){var t;(0,D2.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=(0,E2.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,_r.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,w=d.localizer,v=(0,_r.getSlotAtX)(l,o.x,y,h.slots),C=h.getDateForSlot(v),B=(0,Vl.eventTimes)(m,f,w),S=B.start,F=B.duration;S=w.merge(C,S);var re=w.add(S,F,"milliseconds");t.update(m,S,re)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,_r.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Qi.default(function(){return l},{validContainers:(0,_2.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,y=(0,Qi.getBoundsForNode)(o),w=(0,_r.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||w)}),m.on("selecting",function(d){var f=(0,Qi.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Qi.getBoundsForNode)(o);t.state.segment&&((0,_r.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Qi.getBoundsForNode)(o);(0,_r.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Qi.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=El.default.createRef(),t}return(0,V2.default)(e,n),(0,k2.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var o=(0,C2.eventSegments)((0,kl.default)((0,kl.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Vl.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,y=(0,Vl.eventTimes)(o,m,h),w=y.start,v=y.end,C=(0,_r.getSlotAtX)(r,s.x,f,d.slots),B=d.getDateForSlot(C),S=(0,_r.pointInBox)(r,s);if(l==="RIGHT"){if(S){if(d.last<w)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(B,1,"day"):v=B}else if(h.inRange(w,d.first,d.last)||r.bottom<s.y&&+d.first>+w)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=h.merge(v,F),h.lt(v,w)&&(v=F)}else if(l==="LEFT"){if(S){if(d.first>v)return this.reset();w=B}else if(h.inRange(v,d.first,d.last)||r.top>s.y&&h.lt(d.last,v))w=h.add(d.first,-1,"milliseconds");else{this.reset();return}var re=m.start(o);w=h.merge(w,re),h.gt(w,v)&&(w=re)}this.update(o,w,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,o=this.state.segment;return El.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&El.default.createElement(A2.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,kl.default)((0,kl.default)({},i),Vl.dragAccessors)})))}}])}(El.default.Component);Z0.contextType=w2.DnDContext;uu.default=Z0;var ws=zn.default;Object.defineProperty(af,"__esModule",{value:!0});af.default=O2;var Al=ws(Gr),I2=ws(lf),T2=ws(Si),S2=ws(Pi),P2=ws(Io),L2=ws(To),$u=ws(E),j2=ws(el),R2=ws(ou),B2=ws(au),U2=ws(uu),H2=ar,M2=Li,F2=["selectable","elementProps","components"];function O2(n){var e=function(t){function s(){var r;(0,T2.default)(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,P2.default)(this,s,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,y=h.onEventDrop,w=h.onEventResize;d==="move"&&y&&y(u),d==="resize"&&w&&w(u)}},r.state={interacting:!1},r}return(0,L2.default)(s,t),(0,S2.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,I2.default)(i,F2),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,H2.mergeComponents)(u,{eventWrapper:R2.default,eventContainerWrapper:B2.default,weekWrapper:U2.default});var f=this.props.onDropFromOutside?(0,Al.default)((0,Al.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,j2.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return $u.default.createElement(M2.DnDContext.Provider,{value:h},$u.default.createElement(n,Object.assign({},m,{elementProps:f,components:this.components})))}}])}($u.default.Component);return e.defaultProps=(0,Al.default)((0,Al.default)({},n.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var q2=zn.default;Object.defineProperty(of,"__esModule",{value:!0});var ex=of.default=void 0,$2=q2(af);ex=of.default=$2.default;const z2=ex(Mx),W2=VC;ot.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:n=>n<12?"":"",week:{dow:0,doy:1}});ot.locale("ko");const K2=Fx(ot),og=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],G2=lt.memo(({onSave:n,onCancel:e,processList:t})=>{const[s,r]=E.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=E.useState(i);E.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:m=>r(m.target.value),onBlur:()=>{s.trim()?n(s.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?s.trim()?n(s.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),ag=n=>n,_a={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},Q2=lt.memo(({date:n,label:e,filteredEvents:t,selectedDate:s,user:r,isMobileView:i})=>{const o=ot(n).format("YYYY-MM-DD"),l=_a[o],u=!!_a[o],m=s&&ot(n).isSame(s,"day"),d=t.filter(M=>ot(M.start).isSame(n,"day")),f=d.length,h=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,w=e.replace(/^0/,""),v=n.getDay()===0,C=n.getDay()===6;let B="#000000";u||v?B="#dc2626":C&&(B="#3b82f6");const S=ot(n).isSame(ot(),"day");let F="#d1d5db";u||v?F="#fecaca":C&&(F="#bfdbfe");const re=w.length===2,ee=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:S?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:S?"700":"400",paddingLeft:re?"0px":"4px",...S&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:ee,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((M,V)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${V}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((M,V)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${V}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:ee,children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),Y2=lt.memo(({event:n,user:e,filterProject:t,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",y=n.assignedTo||[],[w,v]=E.useState(!1),C=lt.useRef(null),B=()=>{const he=window.innerWidth,Re=window.innerHeight;return he>=768&&he<1024||he>=1024&&Re>he},[S,F]=E.useState(B),[re,ee]=E.useState(!1);lt.useRef(null),lt.useRef(!1);const[M,V]=E.useState(r||""),N=lt.useRef(s);E.useEffect(()=>{s&&!N.current&&r!==void 0&&V(r),N.current=s},[s,r]);const A=e!=null&&e.name?e.name.slice(-2):null,j=A&&["",""].includes(A),T=A&&["","",""].includes(A),I=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&T||y.includes("")&&j);E.useEffect(()=>{const he=()=>{F(B())};return window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)},[]);const k=he=>{V(he)},_e=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},Fe=he=>{he.stopPropagation(),(he.key==="Enter"||he.key==="Escape")&&he.currentTarget.blur()};return S?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),v(!0)},onMouseLeave:()=>{ee(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[w&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:C,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!n.isASVisit&&n.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",ag(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((he,Re)=>{const dt=he==="HV LAB"||he===""&&j||he===""&&T||he===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:dt?"bold":"normal"},children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Re<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:he=>k(he.target.value),onBlur:_e,onKeyDown:Fe,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:n.title,children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),re&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),n.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",n.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!n.isASVisit&&n.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",ag(n.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:he=>k(he.target.value),onBlur:_e,onKeyDown:Fe,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:n.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((he,Re)=>{const dt=he==="HV LAB"||he===""&&j||he===""&&T||he===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{className:dt?"font-bold":"",children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Re<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),w&&h&&m&&!n.isASVisit&&!n.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:C,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(he=>a.jsxDEV("option",{value:he},he,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),X2=()=>{const{schedules:n,setSchedules:e,addSchedule:t,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=Fr(),{user:y}=$r(),w=iu(),[v,C]=E.useState(!1);E.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;C(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const B=b=>!b||b==="-"?"":v?b:Rm(b),S=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",S);const F=lt.useRef(!1);E.useEffect(()=>{F.current||(F.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),oe.error("  ")}))},[r]);const[re,ee]=E.useState([]);E.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Y=H.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(re.length>0){H.preventDefault();const W=re[re.length-1];try{const le=W.type==="as_visit"||W.type==="expected_payment"?"other":W.type;await i({id:"",title:W.originalTitle||W.title,start:W.start,end:W.end,type:le,project:W.originalProjectName||W.projectName,attendees:W.assignedTo||[],time:W.time,description:W.description}),ee(ye=>ye.slice(0,-1)),oe.success(" ")}catch(le){console.error("  :",le),oe.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[re,i]);const[M,V]=E.useState([]),[N,A]=E.useState(!1),[j,T]=E.useState(""),[I,k]=E.useState(null),[_e,Fe]=E.useState(""),[he,Re]=E.useState(!1),[dt,Ot]=E.useState(null),[Ut,ae]=E.useState(null),Oe=E.useCallback(async()=>{Re(!0);try{const b=await Ce.get("/processes");V(b.data)}catch(b){console.error("   :",b),V([])}finally{Re(!1)}},[]);E.useEffect(()=>{Oe()},[Oe]);const me=E.useMemo(()=>M.length>0?M.map(b=>b.name):W2,[M]),Le=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)T(""),Oe(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},Ke=async()=>{if(!(!I||!_e.trim()))try{const b=await fetch(`/api/processes/${I.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_e.trim()})});if(b.ok)k(null),Fe(""),Oe(),oe.success(" ");else{const H=await b.json();oe.error(H.error||"  ")}}catch(b){console.error("  :",b),oe.error("  ")}},bt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)Oe(),oe.success(" ");else{const Y=await H.json();oe.error(Y.error||"  ")}}catch(H){console.error("  :",H),oe.error("  ")}},it=b=>{Ot(b)},Vt=(b,H)=>{b.preventDefault(),dt!==null&&dt!==H&&ae(H)},rt=async()=>{if(dt!==null&&Ut!==null&&dt!==Ut){const b=[...M],[H]=b.splice(dt,1);b.splice(Ut,0,H),V(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(W=>({id:W.id}))})})).ok||(Oe(),oe.error("  "))}catch(Y){console.error("  :",Y),Oe(),oe.error("  ")}}Ot(null),ae(null)},ut=b=>{const H=w.findIndex(Y=>Y.name===b);return H>=0?og[H%og.length]:"#e8e2ea"},un=w.map(b=>b.name),K=n.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||un.includes(b.project):!0).map(b=>{const H=w.find(ge=>ge.name===b.project);let Y=b.project===""?"[]":b.project;if(H&&b.project!==""){const ge=H.name.length>2?H.name.substring(0,2):H.name,ft=(H.location||"").match(/([A-Za-z]?\d+)/),fn=ft?ft[1]:"";Y=fn?`${ge}_${fn}`:ge}const W=b.time,le=W&&W!=="-"?` - ${B(W)}`:"",ye=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Y||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:ye,priority:"medium",allDay:!W||W==="-",color:ut(b.project||""),isASVisit:!1,time:W,description:b.description}}),Se=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?un.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Y=H&&H!=="-"?` - ${B(H)}`:"",W=w.find(ge=>ge.name===b.project);let le=b.project;if(W){const ge=W.name.length>2?W.name.substring(0,2):W.name,ft=(W.location||"").match(/([A-Za-z]?\d+)/),fn=ft?ft[1]:"";le=fn?`${ge}_${fn}`:ge}const ye=`[AS] ${le}`;return{id:`as-${b.id}`,title:ye+Y,originalTitle:ye,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(W==null?void 0:W.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(ge=>ge.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),Be=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var ye,ge,at,ft,fn,wt,It,rn;const H=w.find(Dn=>Dn.name===b.project);if(!H){const Dn=[],Dt=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),Jt=new Set(b.payments.flatMap(dn=>{var Wt;return((Wt=dn.type)==null?void 0:Wt.split(", ").map(Kt=>Kt.trim()))||[]}));return!Jt.has("")&&((ye=b.expectedPaymentDates)!=null&&ye.contract)&&Dn.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Dt*.1).toLocaleString()}`}),!Jt.has("")&&((ge=b.expectedPaymentDates)!=null&&ge.start)&&Dn.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Dt*.4).toLocaleString()}`}),!Jt.has("")&&((at=b.expectedPaymentDates)!=null&&at.middle)&&Dn.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Dt*.4).toLocaleString()}`}),!Jt.has("")&&((ft=b.expectedPaymentDates)!=null&&ft.final)&&Dn.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Dt*.1).toLocaleString()}`}),Dn}if(!H.startDate||!H.endDate)return[];const Y=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),W=new Set(b.payments.flatMap(Dn=>{var Dt;return((Dt=Dn.type)==null?void 0:Dt.split(", ").map(Jt=>Jt.trim()))||[]})),le=[];return!W.has("")&&((fn=b.expectedPaymentDates)!=null&&fn.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!W.has("")&&((wt=b.expectedPaymentDates)!=null&&wt.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((It=b.expectedPaymentDates)!=null&&It.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((rn=b.expectedPaymentDates)!=null&&rn.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],Ie=[...K,...Se,...Be],Ge=E.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Y=y.name.slice(-2),W=["",""].includes(Y),le=["","",""].includes(Y);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&le||H.includes("")&&W},[y==null?void 0:y.name]),At=(b,H)=>{if(!H)return[...b].sort((le,ye)=>{const ge=Ge(le),at=Ge(ye);return ge&&!at?-1:!ge&&at?1:le.start.getTime()-ye.start.getTime()});const Y=new Map;b.forEach(le=>{const ye=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ye){const ge=`single_${le.id}`;Y.set(ge,[le])}else{const ge=le.start.toISOString().split("T")[0],at=[...le.assignedTo].sort().join(","),ft=`${ge}_${le.projectName}_${at}`;Y.has(ft)||Y.set(ft,[]),Y.get(ft).push(le)}});const W=[];return Y.forEach(le=>{if(le.length===1)W.push(le[0]);else{const ye=le[0],ge=le.map(It=>It.originalTitle||It.title),at=[...new Set(ge)],ft=le.map(It=>{const rn=It.originalTitle||It.title;return rn.startsWith(ye.projectName+" - ")?rn.substring(ye.projectName.length+3):rn}),fn=[...new Set(ft)],wt={...ye,id:le[0].id,title:fn.join(", "),originalTitle:at.join(", "),description:le.map(It=>It.description||It.originalTitle||It.title).join(`
`),assignedTo:[...new Set(le.flatMap(It=>It.assignedTo))],mergedEventIds:le.map(It=>It.id)};W.push(wt)}}),W.sort((le,ye)=>{const ge=Ge(le),at=Ge(ye);return ge&&!at?-1:!ge&&at?1:le.start.getTime()-ye.start.getTime()})},[qt,ct]=E.useState("month"),[P,q]=E.useState(new Date),[te,be]=E.useState(!1),[ce,de]=E.useState(null),[we,qe]=E.useState(null),Je=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[ke,Pn]=E.useState(()=>{const b=localStorage.getItem(Je);return b||((y==null?void 0:y.name)===""&&w.length>0?w[0].name:"all")});E.useEffect(()=>{localStorage.setItem(Je,ke)},[ke,Je]),E.useCallback(()=>{document.body.classList.add("printing-schedule");const b=ke==="all"?" ":ke,H=ot(P).format("YYYY MM"),Y=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[ke,P]);const jt=At(Ie,ke==="all"),[ne,Qe]=E.useState(window.innerWidth<768?new Date:null),[O,Ne]=E.useState(null),De=lt.useRef(null),Pe=lt.useRef(!1),[ue,xt]=E.useState(null),yt=lt.useRef(!1),Qt=lt.useRef(!1);E.useEffect(()=>{const b=W=>{W.key==="Control"&&(Qt.current=!0)},H=W=>{W.key==="Control"&&(Qt.current=!1)},Y=()=>{Qt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Y)}},[]),E.useEffect(()=>{if(!O)return;let b=null;const H=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy")},Y=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy");const at=ye.target.closest(".rbc-day-bg");b&&b!==at&&(b.style.backgroundColor=""),at&&(at.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=at)},W=()=>{b&&(b.style.backgroundColor="",b=null)},le=ye=>{ye.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Y),document.addEventListener("dragend",W),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",W),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[O]);const[_t,mn]=E.useState(null),[nn,Cn]=E.useState(null),[ls,Wn]=E.useState(""),[cs,ei]=E.useState(!1),[Is,Jn]=E.useState(null),[D,Q]=E.useState(!1),[R,x]=E.useState(""),[L,U]=E.useState(null),[X,G]=E.useState({x:0,y:0}),[Z,ie]=E.useState({x:0,y:0}),[Ae,Ye]=E.useState(!1),He=8;E.useEffect(()=>{if(!L)return;const b=Y=>{G({x:Y.clientX,y:Y.clientY});const W=Math.abs(Y.clientX-Z.x),le=Math.abs(Y.clientY-Z.y);(W>He||le>He)&&Ye(!0)},H=()=>{U(null),Ye(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[L,Z]);const fe=lt.useRef(!1),$e=E.useCallback(async({event:b,start:H,end:Y})=>{if(b.isASVisit||b.isExpectedPayment){oe.error("    ");return}const W=H instanceof Date?H:new Date(H),le=Y instanceof Date?Y:new Date(Y);if(Qt.current)try{const ge=b.mergedEventIds||[b.id],at=n.filter(ft=>ge.includes(ft.id));for(const ft of at)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:ft.title,start:W,end:le,project:ft.project,attendees:ft.attendees||[],time:ft.time,priority:ft.priority||"medium"});oe.success(" ")}catch(ge){console.error("  :",ge),oe.error("  ")}else{const ge=b.mergedEventIds||[b.id];try{for(const at of ge)await o(at,{start:W,end:le})}catch(at){console.error("  :",at),oe.error("  "),r()}}},[n,o,i,r]),an=E.useCallback(({event:b,action:H})=>{var W;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((W=le.textContent)!=null&&W.includes(b.originalTitle||b.title)){const ye=le.getBoundingClientRect();ie({x:ye.left,y:ye.top}),G({x:ye.left,y:ye.top});break}Ye(!1),U(b)},[]),$t=E.useCallback(async(b,H,Y=!1)=>{if(ke==="all"){oe.error("  ");return}const W={id:"",title:b,start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(W)}catch(le){console.error("  :",le),oe.error("  ")}},[ke,i,y]),Rt=E.useCallback(({start:b})=>{const H=O||De.current;H&&ke!=="all"&&(Pe.current=!0,yt.current=!0,requestAnimationFrame(()=>{yt.current=!1}),mn(null),Cn(null),Wn(""),$t(H,b),requestAnimationFrame(()=>{Ne(null),De.current=null,Pe.current=!1}))},[O,ke,$t]),St=E.useCallback(()=>{const b=O||De.current;return b?{title:b}:null},[O]),Ln=E.useCallback(async b=>{if(!b.trim()||!_t||ke==="all"){mn(null);return}const H=_t;mn(null);const Y={id:"",title:b.trim(),start:H,end:H,type:"construction",project:ke,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}},[_t,ke,i,y]),Un=E.useCallback(()=>{mn(null)},[]),zt=E.useCallback(async()=>{var b;if(!nn||!ls.trim()){Cn(null),Wn("");return}try{const H=((b=nn.mergedEventIds)==null?void 0:b[0])||nn.id;await o(H,{title:ls.trim()})}catch(H){console.error("  :",H),oe.error("  ")}Cn(null),Wn("")},[nn,ls,o]),ze=E.useCallback(async b=>{ee(Y=>[...Y,b]);const H=b.mergedEventIds||[b.id];oe.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),oe.error("  "),ee(W=>W.slice(0,-1))}Cn(null),Wn("")},[l]),Ve=ke==="all"?jt:jt.filter(b=>(b.originalProjectName||b.projectName)===ke),Xe=lt.useMemo(()=>{const b=ke!=="all",H=new Map;Ve.forEach(W=>{const le=ot(W.start).format("YYYY-MM-DD");H.has(le)||H.set(le,[]),H.get(le).push(W)});const Y=[];return H.forEach(W=>{if(b)W.forEach((le,ye)=>{const ge=ot(le.start).startOf("day").add(ye,"milliseconds").toDate();Y.push({...le,start:ge,allDay:!1})});else{const le=[],ye=[];W.forEach(ge=>{Ge(ge)?le.push(ge):ye.push(ge)}),le.forEach((ge,at)=>{const ft=ot(ge.start).startOf("day").add(at,"milliseconds").toDate();Y.push({...ge,start:ft,allDay:!1})}),ye.forEach((ge,at)=>{const ft=ot(ge.start).startOf("day").add(1e3+at,"milliseconds").toDate();Y.push({...ge,start:ft,allDay:!1})})}}),Y.sort((W,le)=>W.start.getTime()-le.start.getTime())},[Ve,Ge,ke]),Ze=lt.useMemo(()=>{if(_t&&ke!=="all"){const b=ot(_t).format("YYYY-MM-DD"),H=Xe.filter(ye=>ot(ye.start).format("YYYY-MM-DD")===b),Y=H.length>0?Math.max(...H.map(ye=>ye.start.getTime())):ot(_t).startOf("day").valueOf(),W=new Date(Y+1),le={id:"__inline_add__",title:"",start:W,end:W,projectId:"",projectName:ke,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Xe,le]}return Xe},[Xe,_t,ke]);E.useEffect(()=>{(y==null?void 0:y.name)===""&&w.length>0&&(ke==="all"||!w.find(b=>b.name===ke))&&Pn(w[0].name)},[w,y]),E.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.opacity="0",ge.style.pointerEvents="none",ge.style.position="absolute",ge.style.left="-9999px",ge.style.top="-9999px",ge.style.zIndex="-1"})};b();const H=new MutationObserver(b),Y=document.querySelector(".rbc-calendar");Y&&H.observe(Y,{childList:!0,subtree:!0});const W=new MutationObserver(b);return W.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),W.disconnect()}},[qt,P]);const[et,Me]=E.useState({date:null,projectId:"",title:""}),tt=lt.useRef(!1),Ct=lt.useRef(null),sn=b=>{if(fe.current){fe.current=!1;return}if(b.id==="__inline_add__")return;tt.current=!0,Ct.current&&clearTimeout(Ct.current);const H=ke!=="all",Y=window.innerWidth<768;if(H&&!Y&&!b.isASVisit&&!b.isExpectedPayment)mn(null),Cn(b),Wn(b.originalTitle||b.title);else{const W={...b,title:b.originalTitle||b.title};qe(null),de(W),be(!0)}Ct.current=setTimeout(()=>{tt.current=!1,Ct.current=null},300)},Yt=b=>{const H=window.innerWidth,Y=H<768,W=H>=768&&H<1024,le=ke==="all";if(yt.current)return;if(Y){if(b.start){Qe(b.start);const ge=document.querySelector(".md\\:hidden.mt-3.bg-white");ge&&ge.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ye=b.action==="click"||b.action==="select";if(!(W&&!ye)){if(le){tt.current=!1,Cn(null),Wn(""),mn(null),qe(b),de(null),be(!0);return}if(!tt.current){if(ue){$t(ue,b.start,!0);return}Cn(null),Wn(""),mn(b.start)}}},ps=async()=>{if(!et.projectId||!et.title.trim()){alert("  ");return}const b=w.find(H=>H.id===et.projectId);if(!(!b||!et.date))try{await i({id:Date.now().toString(),title:et.title,start:et.date,end:et.date,type:"other",project:b.name,location:"",attendees:[],description:""}),Me({date:null,projectId:"",title:""}),Qe(null)}catch(H){console.error("Failed to add schedule:",H),oe.error("  ")}},cr=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Y="#1f2937";if(b.isASVisit)H="#E8F5E9",Y="#1f2937";else{const W=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&S&&["",""].includes(S),ye=b.assignedTo&&b.assignedTo.includes("")&&S&&["","",""].includes(S);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||W||le||ye?(H="#FEF3C7",Y="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},Lo=lt.useCallback(b=>{const H=ot(b).format("YYYY-MM-DD"),Y=!!_a[H],W=ne&&ot(b).isSame(ne,"day"),le=window.innerWidth<768;let ye="";W&&(ye+="selected-date "),Y&&(ye+="holiday-date ");const ge=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ye.trim(),style:ge}},[ne]),[gt,Ri]=E.useState(window.innerWidth<768);E.useEffect(()=>{const b=()=>{Ri(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),E.useEffect(()=>{const b=()=>{const H=ne||new Date;qe({start:H,end:H}),de(null),be(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ne]);const ur=lt.useCallback(({date:b,label:H})=>a.jsxDEV(Q2,{date:b,label:H,filteredEvents:Ze,selectedDate:ne,user:y,isMobileView:gt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[Ze,ne,y,gt]),mr=lt.useRef(ls);mr.current=ls;const tl=lt.useCallback(b=>{Wn(b)},[]),jo=lt.useCallback(()=>{Cn(null),Wn("")},[]),nl=lt.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(G2,{onSave:Ln,onCancel:Un,processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(nn==null?void 0:nn.id)===b.id||(nn==null?void 0:nn.mergedEventIds)&&nn.mergedEventIds.includes(b.id);return a.jsxDEV(Y2,{event:b,user:y,filterProject:ke,isEditing:H,editTitle:H?mr.current:void 0,onEditTitleChange:H?tl:void 0,onEditSave:H?zt:void 0,onEditDelete:H?()=>ze(b):void 0,onEditCancel:H?jo:void 0,onHoverDelete:()=>ze(b),onDeleteAction:()=>{fe.current=!0},processList:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,ke,nn,zt,ze,Ln,Un,tl,jo,me]),pu=({onNavigate:b})=>{const[H,Y]=lt.useState(!1),[W,le]=lt.useState(ot(P).year()),[ye,ge]=lt.useState(ot(P).month()),at=window.innerWidth<768,ft=()=>{le(ot(P).year()),ge(ot(P).month()),Y(!0)},fn=()=>{q(ot().year(W).month(ye).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${at?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:ft,children:[a.jsxDEV("span",{children:ot(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",ke==="all"?" ":ke]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:ke,onChange:wt=>{Pn(wt.target.value),xt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),w.filter(wt=>wt.status!=="completed").map(wt=>a.jsxDEV("option",{value:wt.name,children:wt.name},wt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(W-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[W,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(W+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(wt=>{const It=ye===wt-1,rn=ot().year()===W&&ot().month()===wt-1;return a.jsxDEV("button",{onClick:()=>ge(wt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${It?"bg-gray-900 text-white":rn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[wt,""]},wt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{q(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:fn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},hu=()=>null,gu=E.useMemo(()=>({toolbar:pu,event:nl,month:{dateHeader:ur,showMore:hu}}),[ur,nl]),dr=lt.useMemo(()=>{if(!ne)return[];let b;if(gt)b=Ze.filter(Y=>ot(Y.start).isSame(ne,"day"));else{const Y=ot(ne).startOf("week"),W=ot(ne).endOf("week");b=Ze.filter(le=>{const ye=ot(le.start);return ye.isSameOrAfter(Y,"day")&&ye.isSameOrBefore(W,"day")})}const H=[...b].sort((Y,W)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),ye=Y.assignedTo&&Y.assignedTo.includes("")&&S&&["",""].includes(S),ge=Y.assignedTo&&Y.assignedTo.includes("")&&S&&["","",""].includes(S),at=Y.assignedTo&&S&&Y.assignedTo.includes(S)||Y.assignedTo&&(y==null?void 0:y.name)&&Y.assignedTo.includes(y.name)||le||ye||ge,ft=W.assignedTo&&W.assignedTo.includes("HV LAB"),fn=W.assignedTo&&W.assignedTo.includes("")&&S&&["",""].includes(S),wt=W.assignedTo&&W.assignedTo.includes("")&&S&&["","",""].includes(S),It=W.assignedTo&&S&&W.assignedTo.includes(S)||W.assignedTo&&(y==null?void 0:y.name)&&W.assignedTo.includes(y.name)||ft||fn||wt;return at&&!It?-1:!at&&It?1:new Date(Y.start).getTime()-new Date(W.start).getTime()});return console.log("Sorted events:",H.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:y==null?void 0:y.name,userShort:S}))),H},[ne,Ze,y,S,gt]);return E.useEffect(()=>{const H=setTimeout(()=>{const Y=gt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),W=document.querySelectorAll(".rbc-month-row"),le=[];W.forEach((Dt,Jt)=>{const dn=Dt.querySelectorAll(".rbc-date-cell");let Wt=0;dn.forEach(Kt=>{const pt=Kt.querySelector("button");let Xt=pt==null?void 0:pt.textContent;if(!Xt){const hs=Kt.querySelector("span");Xt=hs==null?void 0:hs.textContent}if(Xt&&!isNaN(parseInt(Xt))){const hs=ot(P).date(parseInt(Xt)),Ts=Ze.filter(Bi=>ot(Bi.start).isSame(hs,"day"));Wt=Math.max(Wt,Ts.length)}}),le.push(Wt)});const ye=ke&&ke!=="all",ge=100,at=ye?60:18,ft=25,fn=Math.floor((ge-ft)/at),wt=le.length,It=ge*wt,rn=le.map(Dt=>Dt<=fn?ge:ft+Dt*at+10),Dn=rn.reduce((Dt,Jt)=>Dt+Jt,0);if(Dn>It){const Dt=rn.map((Wt,Kt)=>({index:Kt,height:Wt,overflow:Wt>ge})),Jt=Dt.filter(Wt=>Wt.overflow).reduce((Wt,Kt)=>Wt+(Kt.height-ge),0),dn=Dt.filter(Wt=>!Wt.overflow);if(dn.length>0){const Wt=It-Jt-dn.length*ge,Kt=Math.max(50,ge+Wt/dn.length);W.forEach((pt,Xt)=>{const Ts=rn[Xt]>ge?rn[Xt]:Kt;pt.style.height=`${Ts}px`,pt.style.minHeight=`${Ts}px`})}else{const Wt=It/Dn;W.forEach((Kt,pt)=>{const Xt=Math.max(80,rn[pt]*Wt);Kt.style.height=`${Xt}px`,Kt.style.minHeight=`${Xt}px`})}}else{const Dt=rn.reduce((Kt,pt)=>Kt+(pt>ge?pt:0),0),Jt=rn.filter(Kt=>Kt<=ge).length,dn=It-Dt,Wt=Jt>0?dn/Jt:ge;W.forEach((Kt,pt)=>{const Xt=rn[pt]>ge?rn[pt]:Wt;Kt.style.height=`${Xt}px`,Kt.style.minHeight=`${Xt}px`})}Y.forEach(Dt=>{const Jt=Dt.querySelector("button");let dn=Jt==null?void 0:Jt.textContent;if(!dn){const Xt=Dt.querySelector("span");dn=Xt==null?void 0:Xt.textContent}if(!dn||isNaN(parseInt(dn)))return;const Wt=ot(P).date(parseInt(dn)),Kt=Ze.filter(Xt=>ot(Xt.start).isSame(Wt,"day"));Kt.length>0?Dt.setAttribute("data-event-count",Kt.length.toString()):Dt.removeAttribute("data-event-count");const pt=Wt.clone().toDate();if(ne&&ot(pt).isSame(ne,"day")?Dt.classList.add("selected-date"):Dt.classList.remove("selected-date"),gt){const Xt=Dt,hs=Xt._mobileClickHandler;hs&&Dt.removeEventListener("click",hs);const Ts=Bi=>{if(Bi.target.closest(".rbc-event"))return;const Ui=Wt.clone().toDate();Qe(Ui);const gs=document.querySelector(".md\\:hidden.mt-3.bg-white");gs&&gs.scrollIntoView({behavior:"smooth",block:"nearest"})};Xt._mobileClickHandler=Ts,Dt.addEventListener("click",Ts,!0),Dt.style.cursor="pointer",Dt.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),gt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(W=>{const le=W,ye=le._mobileClickHandler;ye&&(W.removeEventListener("click",ye),delete le._mobileClickHandler)})}},[Ze,P,gt,ne,ke]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[et.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:ot(et.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:et.projectId,onChange:b=>Me({...et,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:w.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:et.title,onChange:b=>Me({...et,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&ps()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:ps,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Me({date:null,projectId:"",title:""}),Qe(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[ke!=="all"&&!gt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>A(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:me.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{xt(ue===b?null:b)},onDragStart:H=>{Pe.current=!1,xt(null),Ne(b),De.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Pe.current||(Ne(null),De.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===b?"bg-blue-500 text-white ring-2 ring-blue-300":O===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${ke!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(z2,{localizer:K2,events:Ze,startAccessor:"start",endAccessor:"end",view:qt,onView:ct,date:P,onNavigate:q,onSelectEvent:sn,onSelectSlot:Yt,onEventDrop:ke!=="all"?$e:void 0,onDragStart:ke!=="all"?an:void 0,onDropFromOutside:ke!=="all"?Rt:void 0,dragFromOutsideItem:ke!=="all"?St:void 0,draggableAccessor:b=>ke!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:cr,dayPropGetter:Lo,components:gu,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${ke}-${(ne==null?void 0:ne.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ne&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:gt?ot(ne).format("MM DD (ddd)"):`${ot(ne).startOf("week").format("MM DD")} - ${ot(ne).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),_a[ot(ne).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:_a[ot(ne).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[ke!=="all"&&a.jsxDEV("button",{onClick:()=>Q(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Qe(null),Jn(null),Q(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:dr.length===0?a.jsxDEV("div",{className:"p-4",children:ke!=="all"&&D?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=dr.reduce((Y,W)=>{const le=ot(W.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(W),Y},{});return Object.keys(b).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!gt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:ot(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Y].map(W=>{const le=W.assignedTo&&W.assignedTo.includes("HV LAB"),ye=W.assignedTo&&W.assignedTo.includes("")&&S&&["",""].includes(S),ge=W.assignedTo&&W.assignedTo.includes("")&&S&&["","",""].includes(S),ft=W.assignedTo&&(W.assignedTo.includes((y==null?void 0:y.name)||"")||S&&W.assignedTo.includes(S))||le||ye||ge,fn=!W.color&&!ft,wt=!W.isASVisit&&!W.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const It={...W,title:W.originalTitle||W.title};sn(It)},className:`p-3 cursor-pointer ${ft?"bg-yellow-50":""}`,style:fn?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:ft?"#FEF3C7":W.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:W.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),W.assignedTo&&W.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Dn=>W.assignedTo.includes(Dn))?"":W.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),W.projectName&&ke==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:W.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),wt?a.jsxDEV("button",{onClick:It=>{It.stopPropagation(),Jn(W)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),ke!=="all"&&D&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&R.trim()){const H=ne||new Date,Y={id:"",title:R.trim(),start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{Q(!1),x("")}).catch(W=>{console.error("  :",W),oe.error("  ")})}else b.key==="Escape"&&(Q(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(R.trim()){const b=ne||new Date,H={id:"",title:R.trim(),start:b,end:b,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{Q(!1),x("")}).catch(Y=>{console.error("  :",Y),oe.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Q(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),gt&&ke!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:me.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=ne||new Date;if(ke!=="all"){const Y={id:"",title:b,start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Y)}catch(W){console.error("  :",W),oe.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),te&&a.jsxDEV(KN,{event:ce,slotInfo:we,defaultProjectName:ke!=="all"?ke:void 0,onClose:()=>{be(!1),de(null),qe(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ce)if(ce.id.startsWith("as-")){const H=ce.id.replace("as-","");let Y="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Y=b.assignedTo.join(", "):ce.assignedTo&&Array.isArray(ce.assignedTo)?Y=ce.assignedTo.join(", "):typeof ce.assignedTo=="string"&&(Y=ce.assignedTo),await m(H,{project:b.title||ce.title,assignedTo:Y,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ce.time}),await d(),be(!1)}else if(ce.id.startsWith("payment-")){const H=ce.id.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};ye[W]=b.start,await h(Y,{expectedPaymentDates:ye})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Y,""),ce.mergedEventIds&&ce.mergedEventIds.length>0){console.log(" Updating merged schedules:",ce.mergedEventIds);const W=(ce.originalTitle||ce.title).split(", "),le=H.split(", ");for(let ye=0;ye<ce.mergedEventIds.length;ye++){const ge=ce.mergedEventIds[ye],at=le[ye]||W[ye]||H;await o(ge,{title:at.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ce.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}be(!1)}catch(H){console.error("Failed to save schedule:",H),oe.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};delete ye[W],await h(Y,{expectedPaymentDates:ye})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=jt.find(Y=>Y.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Y of H.mergedEventIds)await l(Y)}else await l(b)}be(!1)}catch(H){console.error("Failed to delete schedule:",H),oe.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),L&&Ae&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:X.x-50,top:X.y-15,backgroundColor:L.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:L.originalTitle||L.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Is&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>Jn(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Is.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>Jn(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=Is.mergedEventIds||[Is.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),oe.error(" ")}Jn(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{A(!1),k(null),T("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{A(!1),k(null),T("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>T(b.target.value),onKeyDown:b=>b.key==="Enter"&&Le(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Le,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:he?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((b,H)=>a.jsxDEV("div",{draggable:(I==null?void 0:I.id)!==b.id,onDragStart:()=>it(H),onDragOver:Y=>Vt(Y,H),onDragEnd:rt,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${dt===H?"opacity-50 bg-gray-100":""} ${Ut===H?"border-t-2 border-gray-400":""} ${(I==null?void 0:I.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(I==null?void 0:I.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:_e,onChange:Y=>Fe(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Ke(),Y.key==="Escape"&&(k(null),Fe(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:Ke,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),Fe("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),Fe(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>bt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},J2=({projectName:n,onClose:e,type:t="cash"})=>{const s=t==="cash",r=s?"":"",i=s?"      .":"      .",[o,l]=E.useState({receiptDate:Ht(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],w=["","","","","","","","","",""];let v="",C=0;for(;f>0;){const B=f%1e4;if(B>0){let S="",F=B,re=0;for(;F>0;){const ee=F%10;ee>0&&(S=w[ee]+y[re]+S),F=Math.floor(F/10),re++}v=S+h[C]+v}f=Math.floor(f/1e4),C++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(bn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(pg,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ht(new Date(o.receiptDate),"yyyy MM dd",{locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:n},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ht(new Date(o.receiptDate),"yyyy MM dd",{locale:yn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Z2="HVLabImageDB",eI=1,Or="paymentRecordImages";let Cl=null;const pf=()=>new Promise((n,e)=>{if(Cl){n(Cl);return}const t=indexedDB.open(Z2,eI);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{Cl=t.result,n(Cl)},t.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(Or)||r.createObjectStore(Or,{keyPath:"id"})}}),tI=async()=>{try{const n=await pf();return new Promise((e,t)=>{const i=n.transaction(Or,"readonly").objectStore(Or).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(n){console.error("IndexedDB , localStorage :",n);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},nI=async(n,e)=>{try{const t=await pf();return new Promise((s,r)=>{const l=t.transaction(Or,"readwrite").objectStore(Or).put({id:n,images:e});l.onsuccess=()=>s(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},sI=async n=>{try{const e=await pf();return new Promise((t,s)=>{const r=e.transaction(Or,"readwrite"),i=r.objectStore(Or);i.clear(),Object.entries(n).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},rI=async()=>{try{const n=localStorage.getItem("paymentRecordImages");if(n){const e=JSON.parse(n);Object.keys(e).length>0&&(await sI(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(n){console.error(" :",n)}},wl=n=>{if(!n)return 0;try{const t=new Date(n).getTime();return isNaN(t)?0:t}catch{return 0}},lg=(n,e,t)=>{if(!n)return null;try{const s=new Date(n);return isNaN(s.getTime())?null:Ht(s,e,t)}catch{return null}},iI=()=>{const{payments:n,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=Fr(),{user:l}=$r(),u=iu(),[m,d]=E.useState(""),[f,h]=E.useState(null),[y,w]=E.useState(null),[v,C]=E.useState(!1),[B,S]=E.useState(!1),[F,re]=E.useState(!1),[ee,M]=E.useState(!1),[V,N]=E.useState(""),[A,j]=E.useState("form"),[T,I]=E.useState(!1),[k,_e]=E.useState(!1),Fe=E.useRef(null),[he,Re]=E.useState("pending"),[dt,Ot]=E.useState("all"),[Ut,ae]=E.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Oe,me]=E.useState(!1),[Le,Ke]=E.useState(null),[bt,it]=E.useState(!1),[Vt,rt]=E.useState(""),[ut,un]=E.useState(!1),K=E.useRef(!1),Se=E.useRef(!1),Be=E.useRef(null),[Ie,Ge]=E.useState([]),[At,qt]=E.useState([]),[ct,P]=E.useState(null),[q,te]=E.useState([]),[be,ce]=E.useState([]),[de,we]=E.useState(!1),[qe,Je]=E.useState({}),[ke,Pn]=E.useState(!1),jt=()=>{const D=localStorage.getItem("lastSelectedProject"),Q=u.filter(R=>R.status!=="completed");return D&&Q.some(R=>R.name===D)?D:Q.length>0?Q[0].name:""},[ne,Qe]=E.useState({project:"",date:Ht(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});E.useEffect(()=>{(async()=>{try{const Q=await er.getAllContractors();Ge(Q.map(R=>({id:R._id||R.id,rank:R.rank,companyName:R.companyName,name:R.name,process:R.process,contact:R.contact,accountNumber:R.accountNumber,bankName:R.bankName,notes:R.notes,createdAt:new Date(R.createdAt),updatedAt:new Date(R.updatedAt)})))}catch(Q){console.error("Failed to load contractors:",Q)}})()},[]),E.useEffect(()=>{Ot("all"),t().catch(Q=>{console.error("Failed to load projects:",Q)}),e().catch(Q=>{console.error("Failed to load payments:",Q)});const D=()=>{I(window.innerWidth<1024)};if(D(),window.addEventListener("resize",D),u.length>0&&!ne.project&&!Se.current){const Q=jt();Q&&(Qe(R=>({...R,project:Q})),localStorage.setItem("lastSelectedProject",Q))}return()=>window.removeEventListener("resize",D)},[]),E.useEffect(()=>{const D=setInterval(()=>{if(Be.current){console.log("[ ]     - ");return}console.log("[ ]    ..."),e().catch(R=>{console.error("[ ] :",R)})},3e4),Q=()=>{if(document.visibilityState==="visible"){if(Be.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(R=>{console.error("[ ] :",R)})}};return document.addEventListener("visibilitychange",Q),()=>{clearInterval(D),document.removeEventListener("visibilitychange",Q)}},[e]),E.useEffect(()=>{let D=kr.getSocket(),Q=0,R=null;const x=U=>{if(console.log(" [ ]    :",U),Be.current&&String(U.paymentId)===Be.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(X=>{console.error("[ ]  :",X)})},L=()=>(D=kr.getSocket(),D?(console.log(" [Payments] Socket  , payment:refresh  "),D.on("payment:refresh",x),R&&(clearInterval(R),R=null),!0):!1);return L()||(console.log(" [Payments] Socket  ..."),R=setInterval(()=>{Q++,(L()||Q>=10)&&(R&&(clearInterval(R),R=null),Q>=10&&!kr.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{R&&clearInterval(R);const U=kr.getSocket();U&&U.off("payment:refresh",x)}},[e]),E.useEffect(()=>{(async()=>{var x,L,U,X;if(K.current)return;const Q=new URLSearchParams(window.location.search),R=Q.get("complete")||Q.get("c");if(R){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",R),window.history.replaceState({},"","/payments"),Se.current=!0,j("list"),Re("completed"),Ot("all"),Qe(G=>({...G,project:""})),o(String(R),{status:"completed",completionDate:new Date}),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(R),{status:"completed"}),await e();const G=kr.getSocket();G&&G.emit("payment:refresh",{paymentId:R,status:"completed",updatedAt:new Date().toISOString()})}catch(G){console.error("[ ]  :",G),o(String(R),{status:"pending",completionDate:void 0}),Re("pending");let Z="  ";((x=G.response)==null?void 0:x.status)===401?Z=" .  ":((L=G.response)==null?void 0:L.status)===404?Z="     (ID: "+R+")":(X=(U=G.response)==null?void 0:U.data)!=null&&X.error?Z=G.response.data.error:G.message&&(Z+=": "+G.message),oe.error(Z)}}})()},[e,i,o,l]),E.useEffect(()=>{if(ne.process){const D=new Set(n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).map(L=>L.bankInfo.accountHolder.trim().toLowerCase())),Q=(L,U)=>{const X=L.toLowerCase(),G=U.toLowerCase();if(X.includes(G)||G.includes(X))return!0;const Z=X.split("/").map(Ae=>Ae.trim()),ie=G.replace(/$/,"").trim();for(const Ae of Z)if(Ae===ie||ie.includes(Ae)||Ae.includes(ie))return!0;return!1},x=Ie.filter(L=>{if(!Q(ne.process,L.process))return!1;const X=L.accountNumber&&L.accountNumber.trim()!=="",G=L.name.trim().toLowerCase(),Z=D.has(G);return X||Z}).sort((L,U)=>{const X=L.accountNumber&&L.accountNumber.trim()!=="",G=U.accountNumber&&U.accountNumber.trim()!=="";return X&&!G?-1:!X&&G?1:0});qt(x)}else qt([])},[ne.process,Ie,n]),E.useEffect(()=>{if(ne.process){const D=(x,L)=>{if(!L)return!1;const U=x.toLowerCase(),X=L.toLowerCase();if(U.includes(X)||X.includes(U))return!0;const G=U.split("/").map(ie=>ie.trim()),Z=X.replace(/$/,"").trim();for(const ie of G)if(ie===Z||Z.includes(ie)||ie.includes(Z))return!0;return!1},Q=n.filter(x=>{var L,U,X;return x.status==="completed"&&x.process&&D(ne.process,x.process)&&((L=x.bankInfo)==null?void 0:L.accountHolder)&&((U=x.bankInfo)==null?void 0:U.bankName)&&((X=x.bankInfo)==null?void 0:X.accountNumber)}),R=new Map;Q.forEach(x=>{const L=`${x.bankInfo.accountHolder}_${x.bankInfo.bankName}_${x.bankInfo.accountNumber}`;R.has(L)||R.set(L,{accountHolder:x.bankInfo.accountHolder,bankName:x.bankInfo.bankName,accountNumber:x.bankInfo.accountNumber,itemName:x.itemName||"",amount:x.amount||0})}),te(Array.from(R.values()))}else te([])},[ne.process,n]),E.useEffect(()=>{var Q;const D=((Q=ne.accountHolder)==null?void 0:Q.trim())||"";if(D.length>=1&&de){const R=[],x=new Set;Ie.filter(L=>L.accountNumber&&L.accountNumber.trim()!=="").forEach(L=>{const U=L.name.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankName||"",accountNumber:L.accountNumber||"",source:"contractor"}))}),n.filter(L=>{var U;return L.status==="completed"&&((U=L.bankInfo)==null?void 0:U.accountHolder)}).forEach(L=>{const U=L.bankInfo.accountHolder.trim(),X=U.toLowerCase(),G=D.toLowerCase();X.startsWith(G)&&!x.has(X)&&(x.add(X),R.push({name:U,bankName:L.bankInfo.bankName||"",accountNumber:L.bankInfo.accountNumber||"",source:"payment"}))}),ce(R)}else ce([])},[ne.accountHolder,de,Ie,n]);const O=D=>{const Q=D.split(`
`).map(G=>G.trim()).filter(G=>G),R={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},x=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],L=G=>{const Z=["","","","","","","",""];for(const ie of Z)if(G.endsWith(ie)&&G.length>ie.length+1)return G.slice(0,-ie.length);return G},U=G=>{if(!G||G.length<2||G.length>5||!/^[-]{2,5}$/.test(G)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(G))return!1;if(G.length>=2){const Ae=G.charAt(0),Ye=G.substring(0,2);if(["","","","","","",""].includes(Ye)||x.includes(Ae))return!0}return G.length>=2&&G.length<=4},X=Q.some(G=>G.includes(" ")||G.includes(""));if(Q.forEach((G,Z)=>{if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.itemName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountHolder=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.bankName=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*(.+)/);ie&&(R.bankInfo.accountNumber=ie[1].trim())}if(G.includes("")&&G.includes(":")){const ie=G.match(/\s*:\s*([\d,]+)?/);ie&&(R.amounts.total=parseInt(ie[1].replace(/,/g,"")))}}),!X){let G=-1;if(Q.forEach(Z=>{const ie=Z.match(/\[([^\]]+)\]/);ie&&!R.itemName&&(R.itemName=ie[1].trim())}),Q.forEach((Z,ie)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){R.includeVat=!0;const ze=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),Ve=Z.match(/(\d+)\s*\s*?/),Xe=Z.match(/([\d,]+)\s*/);if(ze){const Ze=parseInt(ze[1])*1e4+parseInt(ze[2])*1e3;R.amounts.total=Ze}else if(Ve){const Ze=parseInt(Ve[1])*1e4;R.amounts.total=Ze}else if(Xe){const Ze=parseInt(Xe[1].replace(/,/g,""));Ze>=1e3&&(R.amounts.total=Ze)}return}const Ye=Z.match(/=\s*([\d,]+)\s*?/);let He=null;if(Ye){const ze=parseInt(Ye[1].replace(/,/g,""));ze>=1e3&&(R.amounts.total=ze)}else{const ze=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(ze){const Ve=parseInt(ze[1])*1e4,Xe=parseInt(ze[2])*1e3,Ze=Ve+Xe;Z.includes("")||Z.includes("")?R.amounts.material=Ze:Z.includes("")||Z.includes("")?R.amounts.labor=Ze:R.amounts.total||(R.amounts.total=Ze),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),He=ze}else if(He=Z.match(/(\d+)\s*\s*?/),He){const Ve=parseInt(He[1])*1e4;Z.includes("")||Z.includes("")?R.amounts.material=Ve:Z.includes("")||Z.includes("")?R.amounts.labor=Ve:R.amounts.total||(R.amounts.total=Ve),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(Ve=>{const Xe=Ve.trim();Xe.startsWith("[")||Xe.endsWith("]")||(/^[\d\-]+$/.test(Xe)&&Xe.replace(/\-/g,"").length>=10?R.bankInfo.accountNumber||(R.bankInfo.accountNumber=Xe):U(Xe)&&!R.bankInfo.accountHolder&&(R.bankInfo.accountHolder=Xe))});const fe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let $e="",an=-1;for(const ze of fe){const Ve=Z.match(ze);if(Ve&&!R.bankInfo.accountNumber){$e=Ve[0],an=Ve.index||-1,R.bankInfo.accountNumber=Ve[0].trim().replace(/\s+/g,"-");const Ze=Z.substring(an+$e.length).trim().split(/\s+/);for(const et of Ze){if(et.startsWith("[")||et.endsWith("]"))continue;const Me=L(et);if(U(Me)){R.bankInfo.accountHolder=Me;break}}if(!R.bankInfo.accountHolder&&ie>0){const Me=Q[ie-1].split(/\s+/);for(const tt of Me){if(tt.startsWith("[")||tt.endsWith("]"))continue;const Ct=L(tt);if(U(Ct)){R.bankInfo.accountHolder=Ct;break}}}if(!R.bankInfo.accountHolder&&ie+1<Q.length){const et=Q[ie+1],Me=et.split(/\s+/);for(const tt of Me){if(tt.startsWith("[")||tt.endsWith("]"))continue;const Ct=L(tt);if(U(Ct)){R.bankInfo.accountHolder=Ct;break}}if(!R.bankInfo.accountHolder){const tt=et.match(/^([-]{2,6})/);if(tt){const Ct=L(tt[1].trim());U(Ct)&&(R.bankInfo.accountHolder=Ct)}}}break}}const $t=Z.match(/[\d,]+/g);if($t){const ze=$e?$e.split(/[\s\-]+/).filter(Ve=>Ve):[];$t.forEach(Ve=>{const Xe=parseInt(Ve.replace(/,/g,"")),Ze=Ve.replace(/,/g,""),et=ze.some(Me=>Me===Ze);!R.bankInfo.accountNumber&&Ze.length>=10&&Ze.length<=20?(R.bankInfo.accountNumber=Ze,$e=Ze):Xe>=1e3&&!He&&!et&&(Z.includes("")||Z.includes("")?R.amounts.material=Xe:Z.includes("")||Z.includes("")?R.amounts.labor=Xe:R.amounts.total||(R.amounts.total=Xe))})}const Rt={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},St=Object.keys(Rt).sort((ze,Ve)=>Ve.length-ze.length);for(const ze of St)if(Z.includes(ze)){const Ve=Rt[ze];R.bankInfo.bankName=Ve,G=ie;const Xe=new RegExp(`${ze}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),Ze=Z.match(Xe);if(Ze){const et=L(Ze[1]);et&&!/^\d+$/.test(et)&&et!==""&&(R.bankInfo.accountHolder=et)}break}if(!R.bankInfo.bankName){const ze=Z.match(/([-]+)(|)/);ze&&(R.bankInfo.bankName=ze[0])}const Ln=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const ze of Ln){const Ve=Z.match(ze);if(Ve&&!R.bankInfo.accountHolder){R.bankInfo.accountHolder=Ve[0].trim();break}}const Un=Z.match(/\(([-]{2,5})\)/);if(Un&&!R.bankInfo.accountHolder){const ze=Un[1];U(ze)&&!["","",""].includes(ze)&&(R.bankInfo.accountHolder=ze)}if(!R.bankInfo.accountHolder){const ze=/[-]{2,6}/g,Ve=Z.match(ze);if(Ve){const Xe=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),Ze=Z.match(/||||/);Ve.forEach(et=>{const Me=L(et),tt=D.split(`
`)[ie];if(tt&&tt.includes(`[${et}]`)||!U(Me)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Me))return;const sn=Z.indexOf(et);if(sn>0){const Yt=Z[sn-1];if(/[-]/.test(Yt))return}if(sn+et.length<Z.length){const Yt=Z[sn+et.length];if(/[-]/.test(Yt))return}if(!(Un&&Me===Un[1])){if((Xe||Ze)&&!R.bankInfo.accountHolder)R.bankInfo.accountHolder=Me;else if(!R.bankInfo.accountHolder){const Yt=/||||/,ps=/\d{6,}/;(ie>0&&(ps.test(Q[ie-1])||Yt.test(Q[ie-1]))||ie<Q.length-1&&(ps.test(Q[ie+1])||Yt.test(Q[ie+1]))||Yt.test(Z))&&(R.bankInfo.accountHolder=Me)}}})}}const zt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[ze,Ve]of Object.entries(zt))if(Z.includes(ze)){R.vendor=Ve;break}if(ie===0&&!R.itemName){const ze=Z.replace(/[\[\]{}()<>]/g,"").trim();ze&&!ze.includes(" ")&&(U(ze)||(R.itemName=ze.substring(0,50)))}}),G>=0&&G+1<Q.length){const Z=Q[G+1],ie=Z.trim();if(/^[-]{2,5}$/.test(ie)&&U(ie))R.bankInfo.accountHolder=ie;else{const Ae=Z.split(/\s+/);for(const Ye of Ae){const He=L(Ye);if(U(He)){R.bankInfo.accountHolder=He;break}}}}}if(R.itemName&&R.itemName.includes("")&&(R.vendor=""),R.itemName){const G=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=R.itemName.toLowerCase(),ie=G.some(fe=>Z===fe.toLowerCase()||Z.startsWith(fe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Ae=/^[\d\-\s]/.test(R.itemName),Ye=/^\d{2,}[\s\-]?\d+/.test(R.itemName.replace(/[-]/g,"").trim()),He=R.bankInfo.accountHolder&&(R.itemName===R.bankInfo.accountHolder||R.itemName.includes(R.bankInfo.accountHolder));(ie||Ae||Ye||He)&&(R.itemName=void 0)}return R},Ne=async()=>{var D,Q,R,x,L,U,X,G,Z,ie,Ae;try{const Ye=ne.quickText;if(!Ye.trim())return;let He=n;n.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(Ve=>setTimeout(Ve,100)),He=Fr.getState().payments,console.log("payments  :",He.length,""));const fe=O(Ye);console.log("  :",fe);const $e={project:ne.project,date:ne.date,quickText:ne.quickText,quickImages:ne.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),S(!1),re(!1);let an=0;fe.amounts.material&&(an+=fe.amounts.material),fe.amounts.labor&&(an+=fe.amounts.labor),fe.amounts.total&&!fe.amounts.material&&!fe.amounts.labor&&(an=fe.amounts.total),an>0&&($e.amount=an),fe.bankInfo.bankName&&($e.bankName=fe.bankInfo.bankName),fe.bankInfo.accountHolder&&($e.accountHolder=fe.bankInfo.accountHolder),fe.bankInfo.accountNumber&&($e.accountNumber=fe.bankInfo.accountNumber);const $t=Ve=>Ve?Ve.replace(/[^0-9]/g,""):"",Rt=(Ve,Xe)=>{if(!Ve||!Xe)return!1;const Ze=$t(Ve),et=$t(Xe);if(!Ze||!et)return!1;const Me=6;return Ze.length<Me||et.length<Me?Ze===et:et.includes(Ze)||Ze.includes(et)},St=$t(fe.bankInfo.accountNumber||""),Ln=fe.bankInfo.accountHolder||"";let Un=!1;console.log("===    ==="),console.log(" :",fe.bankInfo.accountNumber),console.log(" :",St),console.log(" :",Ln),console.log(" :",Ie.length),console.log("  :",He.filter(Ve=>Ve.status==="completed").length);let zt=Ie.find(Ve=>{const Xe=$t(Ve.accountNumber||"");return Xe&&Xe===St});if(!zt&&St&&(zt=Ie.find(Ve=>{const Xe=$t(Ve.accountNumber||"");return Rt(St,Xe)})),zt&&(Un=!0),!zt&&Ln&&(zt=Ie.find(Ve=>Ve.name===Ln),zt)){console.log("  :",zt.name);const Ve=((D=zt.accountNumber)==null?void 0:D.replace(/[-\s]/g,""))||"";St&&!Rt(St,Ve)?(console.log("    ( ) -  "),Un=!1):Un=!0}if(zt&&(zt.name&&($e.accountHolder=zt.name,console.log("  :",zt.name)),zt.bankName?$e.bankName=zt.bankName:fe.bankInfo.bankName&&($e.bankName=fe.bankInfo.bankName),Un&&($e.accountNumber=zt.accountNumber||fe.bankInfo.accountNumber),P(zt.id||zt._id||null),zt.process&&($e.process=zt.process)),!zt){let Ve=!1;console.log("===     ==="),console.log("  payments :",He.length,""),console.log(" :",St),console.log(" :",Ln);const Xe=He.filter(tt=>tt.status==="completed");console.log(" :",Xe.length);const Ze=[...new Set(Xe.map(tt=>{var Ct;return(Ct=tt.bankInfo)==null?void 0:Ct.accountHolder}).filter(Boolean))];console.log("   ( 20):",Ze.slice(0,20)),console.log("  ():",St);const et=Xe.filter(tt=>{var Ct;return(Ct=tt.bankInfo)==null?void 0:Ct.accountNumber}).map(tt=>{var Ct,sn,Yt;return{holder:(Ct=tt.bankInfo)==null?void 0:Ct.accountHolder,account:(sn=tt.bankInfo)==null?void 0:sn.accountNumber,clean:$t(((Yt=tt.bankInfo)==null?void 0:Yt.accountNumber)||"")}}).filter(tt=>tt.clean.includes(St.substring(0,6))||St.includes(tt.clean.substring(0,6)));console.log("  :",et);let Me=He.find(tt=>{var Yt;const Ct=$t(((Yt=tt.bankInfo)==null?void 0:Yt.accountNumber)||"");return Ct&&Ct===St&&tt.status==="completed"});if(Me&&console.log("   :",(Q=Me.bankInfo)==null?void 0:Q.accountHolder,Me.process),!Me&&St&&(Me=He.find(tt=>{var sn;const Ct=$t(((sn=tt.bankInfo)==null?void 0:sn.accountNumber)||"");return Rt(St,Ct)&&tt.status==="completed"}),Me&&console.log("   :",(R=Me.bankInfo)==null?void 0:R.accountHolder,Me.process)),Me&&(Ve=!0),!Me&&Ln&&(Me=He.find(tt=>{var Ct;return((Ct=tt.bankInfo)==null?void 0:Ct.accountHolder)===Ln&&tt.status==="completed"}),Me)){console.log("    :",(x=Me.bankInfo)==null?void 0:x.accountHolder,":",Me.process);const tt=$t(((L=Me.bankInfo)==null?void 0:L.accountNumber)||"");St&&!Rt(St,tt)?(console.log("    ( ) -  "),Ve=!1):Ve=!0}Me?(console.log(" :",{accountHolder:(U=Me.bankInfo)==null?void 0:U.accountHolder,accountNumber:(X=Me.bankInfo)==null?void 0:X.accountNumber,bankName:(G=Me.bankInfo)==null?void 0:G.bankName,process:Me.process,status:Me.status,paymentMatchedByAccountNumber:Ve}),(Z=Me.bankInfo)!=null&&Z.accountHolder&&($e.accountHolder=Me.bankInfo.accountHolder,console.log("  :",Me.bankInfo.accountHolder)),(ie=Me.bankInfo)!=null&&ie.bankName?$e.bankName=Me.bankInfo.bankName:fe.bankInfo.bankName&&($e.bankName=fe.bankInfo.bankName),Ve&&($e.accountNumber=((Ae=Me.bankInfo)==null?void 0:Ae.accountNumber)||fe.bankInfo.accountNumber),Me.process&&!$e.process?($e.process=Me.process,console.log("    :",Me.process)):console.log("   - process:",Me.process,"updatedFormData.process:",$e.process)):console.log("  ")}if(fe.vendor&&($e.process=fe.vendor),!$e.process){const Ve=Ye.toLowerCase();for(const Xe of Fu)if(Ve.includes(Xe.toLowerCase())){$e.process=Xe;break}}fe.itemName&&($e.itemName=fe.itemName),Qe($e),fe.includeVat&&(S(!0),re(!1));const ze=[];if(fe.amounts.material||fe.amounts.labor||fe.amounts.total){const Ve=[];fe.amounts.material&&Ve.push(`: ${fe.amounts.material.toLocaleString()}`),fe.amounts.labor&&Ve.push(`: ${fe.amounts.labor.toLocaleString()}`),fe.amounts.total&&!fe.amounts.material&&!fe.amounts.labor&&Ve.push(`: ${fe.amounts.total.toLocaleString()}`),ze.push(Ve.join(", "))}if(fe.bankInfo.bankName||fe.bankInfo.accountHolder){const Ve=[];fe.bankInfo.bankName&&Ve.push(fe.bankInfo.bankName),fe.bankInfo.accountHolder&&Ve.push(fe.bankInfo.accountHolder),fe.bankInfo.accountNumber&&Ve.push(fe.bankInfo.accountNumber),Ve.length>0&&ze.push(`: ${Ve.join(" ")}`)}fe.vendor&&ze.push(`: ${fe.vendor}`),fe.includeVat&&ze.push("  "),ze.length>0?oe.success(`  !
${ze.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):oe.info("  ...    .")}catch(Ye){console.error(" :",Ye),oe.error("   .")}};E.useEffect(()=>{(async()=>{try{await rI();const Q=await tI();Je(Q),Pn(!0)}catch(Q){console.error("  :",Q),Pn(!0)}})()},[]);const De=E.useRef({});E.useEffect(()=>{ke&&(Object.entries(qe).forEach(([D,Q])=>{JSON.stringify(De.current[D])!==JSON.stringify(Q)&&nI(D,Q).catch(R=>{console.error("  :",R),oe.error("  ")})}),De.current={...qe})},[qe,ke]);const Pe=E.useCallback(async D=>{var x;const Q=(x=D.clipboardData)==null?void 0:x.items;if(!Q)return;let R=!1;for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){R=!0;break}if(R){if(!f){const L=document.activeElement;(L==null?void 0:L.tagName)==="INPUT"||(L==null?void 0:L.tagName)==="TEXTAREA"||(L==null?void 0:L.classList.contains("form-input"))||oe.error("  ");return}for(let L=0;L<Q.length;L++)if(Q[L].type.indexOf("image")!==-1){D.preventDefault();const U=Q[L].getAsFile();if(U){const X=new FileReader;X.onload=async G=>{var ie;const Z=(ie=G.target)==null?void 0:ie.result;if(Z)try{const Ae=n.find(fe=>fe.id===f),He=[...(Ae==null?void 0:Ae.images)||qe[f]||[],Z];await vs.updatePaymentImages(f,He),Je(fe=>({...fe,[f]:He})),await e(),oe.success(" ")}catch(Ae){console.error("  :",Ae),oe.error("  ")}},X.readAsDataURL(U)}}}},[f,n,qe,e]);E.useEffect(()=>(document.addEventListener("paste",Pe),()=>document.removeEventListener("paste",Pe)),[Pe]);const xt=[...(l==null?void 0:l.name)===""?n.filter(D=>u.some(Q=>Q.name===D.project)):n].sort((D,Q)=>new Date(Q.requestDate).getTime()-new Date(D.requestDate).getTime()),yt=xt.filter(D=>{var U,X,G;if(!D||!D.id)return!1;const Q=m===""||((U=D.purpose)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((X=D.itemName)==null?void 0:X.toLowerCase().includes(m.toLowerCase()))||((G=D.process)==null?void 0:G.toLowerCase().includes(m.toLowerCase())),R=he==="pending"?D.status!=="completed":D.status==="completed",x=dt==="all"||!dt||D.project===dt,L=!Ut||he!=="completed"||D.requestedBy===(l==null?void 0:l.name);return Q&&R&&x&&L}).sort((D,Q)=>!D&&!Q?0:D?Q?he==="completed"?wl(Q.completionDate)-wl(D.completionDate):wl(Q.requestDate)-wl(D.requestDate):-1:1),Qt=D=>{const Q=D.id||D._id||null;if(ct===Q){P(null);const U=document.querySelector('input[placeholder=" "]');U&&setTimeout(()=>{U.focus()},100);return}P(Q);const R=va(D.name);let x=D.bankName||"",L=D.accountNumber||"";if(L&&!x){const U=L.trim().split(/\s+/);if(U.length>=2){const X=U[0];(X.includes("")||X.includes("")||X.includes("")||X.includes("")||X.includes(""))&&(x=X,L=U.slice(1).join(""))}}Qe(U=>({...U,accountHolder:R,bankName:x,accountNumber:L}))};yt.reduce((D,Q)=>{const R=Q.materialAmount||0,x=Q.laborAmount||0,L=Q.amount||0;let U=R,X=x,G=0;return R===0&&x===0&&L>0?Q.includesVAT?(U=Math.round(L/1.1),G=L-U):(U=L,G=0):Q.includesVAT?(R>0&&(U=Math.round(R/1.1)),x>0&&(X=Math.round(x/1.1)),G=L-(U+X)):G=0,D.material+=U,D.labor+=X,D.vat+=G,D.total+=L,D},{material:0,labor:0,vat:0,total:0});const _t=async()=>{var Q;if(ut){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ne),!ne.project){oe.error(" ");return}if(!ne.itemName){oe.error(" ");return}const D=Number(ne.amount)||0;if(D===0){oe.error(" ");return}un(!0);try{const R=F?Math.round(D*.967):D,x=new Date;if(y){const L={project:ne.project,requestDate:new Date(ne.date),purpose:ne.itemName,amount:R,category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,updatedAt:x};console.log(" Updating payment:",L),await i(y,L),oe.success(" "),w(null)}else{const L=ne.project||"",U={id:`payment_${Date.now()}`,project:L,requestDate:new Date(ne.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:ne.itemName,amount:R,status:"pending",category:"material",urgency:"normal",process:ne.process,itemName:ne.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:R,laborAmount:0,originalLaborAmount:0,accountHolder:ne.accountHolder,bank:ne.bankName,accountNumber:ne.accountNumber,bankInfo:ne.accountHolder||ne.bankName||ne.accountNumber?{accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber}:void 0,quickText:ne.quickText||"",images:ne.quickImages,attachments:[],createdAt:x,updatedAt:x};console.log(" Creating payment:",U),console.log(" Images in payment:",((Q=ne.quickImages)==null?void 0:Q.length)||0,"");const X=await s(U);if(Be.current=X,setTimeout(()=>{Be.current=null},1e4),oe.success(" "),ne.accountHolder&&ne.bankName&&ne.accountNumber){const G=B||F?"01074088864":"01089423283";try{await Ce.post("/payments/send-toss-payment-sms",{recipientPhone:G,accountHolder:ne.accountHolder,bankName:ne.bankName,accountNumber:ne.accountNumber,amount:R,projectName:L,itemName:ne.itemName,process:ne.process,paymentId:X}),oe.success("   ")}catch(Z){console.error("SMS  :",Z)}}}Qe(L=>({project:L.project,date:Ht(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),S(!1),re(!1),P(null),window.innerWidth<768&&j("list")}catch(R){console.error(" Payment save error:",R),oe.error("  : "+R.message)}finally{un(!1)}},mn=D=>{var Q,R,x,L;try{console.log("[handleEdit] Starting edit for payment:",D.id);const U=D.originalMaterialAmount!==void 0?D.originalMaterialAmount:D.materialAmount||0,X=D.originalLaborAmount!==void 0?D.originalLaborAmount:D.laborAmount||0,G={project:D.project||"",date:D.requestDate?Ht(new Date(D.requestDate),"yyyy-MM-dd"):Ht(new Date,"yyyy-MM-dd"),process:D.process||"",itemName:D.itemName||D.purpose||"",materialCost:U>0?U.toString():"",laborCost:X>0?X.toString():"",amount:((Q=D.amount)==null?void 0:Q.toString())||"",accountHolder:((R=D.bankInfo)==null?void 0:R.accountHolder)||"",bankName:((x=D.bankInfo)==null?void 0:x.bankName)||"",accountNumber:((L=D.bankInfo)==null?void 0:L.accountNumber)||"",images:D.attachments||[],quickText:D.quickText||"",quickImages:D.images||[]};console.log("[handleEdit] Setting form data:",G),Qe(G),S(D.includesVAT||!1),re(D.applyTaxDeduction||!1),h(D.id),w(D.id),T&&j("form"),console.log("[handleEdit] Edit setup complete"),oe.success("  ")}catch(U){console.error("[handleEdit] Error:",U),oe.error("     ")}},nn=async D=>{var Q,R,x;try{const L=((Q=D.bankInfo)==null?void 0:Q.accountHolder)||D.accountHolder,U=((R=D.bankInfo)==null?void 0:R.bankName)||D.bank,X=((x=D.bankInfo)==null?void 0:x.accountNumber)||D.accountNumber;if(!L||!U||!X){oe.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}`))return;const Z=X.replace(/[-\s]/g,""),ie=CC[U]||U,Ae=AC[U]||"004",Ye="",He=`supertoss://send?amount=${D.amount}&bankCode=${Ae}&bank=${encodeURIComponent(ie)}&accountNo=${Z}&receiverName=${encodeURIComponent(Ye)}&toName=${encodeURIComponent(Ye)}`;let fe=!1;try{window.location.href=He,fe=!0,oe.success("  ...",{duration:3e3}),setTimeout(()=>{const $e=/iPhone|iPad|iPod/i.test(navigator.userAgent),an=/Android/i.test(navigator.userAgent);($e||an)&&oe(`      .

: 
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch($e){console.error("   :",$e),oe(`   .

: 
: ${U}
: ${X}
: ${D.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(L){console.error(" :",L),oe.error(`   : ${L.message}`)}},Cn=async D=>{const Q=n.find(R=>R.id===D);if(Q&&Q.quickText){const R=localStorage.getItem("executionMemos"),x=R?JSON.parse(R):{};x[D]=Q.quickText,localStorage.setItem("executionMemos",JSON.stringify(x))}o(D,{status:"completed",completionDate:new Date}),me(!1),Re("completed"),oe.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(D,{status:"completed"});const R=kr.getSocket();R&&R.emit("payment:refresh",{paymentId:D,status:"completed"})}catch(R){console.error(" API :",R),o(D,{status:"pending",completionDate:void 0}),Re("pending"),oe.error("   -  ")}},ls=async D=>{var x;if(!f){oe.error("  ");return}const R=Array.from(((x=D.target)==null?void 0:x.files)||[]).filter(L=>L.type.startsWith("image/"));if(R.length!==0){try{const L=await Promise.all(R.map(Z=>new Promise((ie,Ae)=>{const Ye=new FileReader;Ye.onload=He=>{var $e;const fe=($e=He.target)==null?void 0:$e.result;fe?ie(fe):Ae(new Error("  "))},Ye.onerror=()=>Ae(new Error("FileReader ")),Ye.readAsDataURL(Z)}))),U=n.find(Z=>Z.id===f),G=[...(U==null?void 0:U.images)||qe[f]||[],...L];await vs.updatePaymentImages(f,G),Je(Z=>({...Z,[f]:G})),await e(),oe.success(`${L.length}  `)}catch(L){console.error("  :",L),oe.error("  ")}D.target.value=""}},Wn=async D=>{if(f)try{const Q=n.find(L=>L.id===f),x=((Q==null?void 0:Q.images)||qe[f]||[]).filter((L,U)=>U!==D);await vs.updatePaymentImages(f,x),Je(L=>({...L,[f]:x})),await e()}catch(Q){console.error("  :",Q),oe.error("  ")}},cs=D=>{N(D),M(!0)},ei=D=>{D.preventDefault(),C(!0)},Is=D=>{D.preventDefault(),C(!1)},Jn=async D=>{if(D.preventDefault(),C(!1),!f){oe.error("  ");return}const R=Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/"));if(R.length!==0)try{const x=await Promise.all(R.map(G=>new Promise((Z,ie)=>{const Ae=new FileReader;Ae.onload=Ye=>{var fe;const He=(fe=Ye.target)==null?void 0:fe.result;He?Z(He):ie(new Error("  "))},Ae.onerror=()=>ie(new Error("FileReader ")),Ae.readAsDataURL(G)}))),L=n.find(G=>G.id===f),X=[...(L==null?void 0:L.images)||qe[f]||[],...x];await vs.updatePaymentImages(f,X),Je(G=>({...G,[f]:X})),await e(),oe.success(`${x.length}  `)}catch(x){console.error("  :",x),oe.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ne.project,onChange:D=>{Qe({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2463,columnNumber:35},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2465,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2453,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2452,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2474,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2484,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2473,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2472,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2471,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${A!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ne.project,onChange:D=>{Qe({...ne,project:D.target.value}),D.target.value&&localStorage.setItem("lastSelectedProject",D.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2529,columnNumber:43},void 0),u.filter(D=>D.status!=="completed").map(D=>a.jsxDEV("option",{value:D.name,children:D.name},D.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2531,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2519,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Qe({...ne,bankName:D.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2539,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2540,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2541,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2543,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2544,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2546,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2550,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2551,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2518,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2517,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ne.quickText,onChange:D=>Qe({...ne,quickText:D.target.value}),onPaste:D=>{var R;const Q=(R=D.clipboardData)==null?void 0:R.items;if(Q){for(let x=0;x<Q.length;x++)if(Q[x].type.indexOf("image")!==-1){D.preventDefault();const L=Q[x].getAsFile();if(L){const U=new FileReader;U.onload=X=>{var Z;const G=(Z=X.target)==null?void 0:Z.result;Qe(ie=>({...ie,quickImages:[...ie.quickImages,G]}))},U.readAsDataURL(L)}break}}},onDragOver:D=>{D.preventDefault(),D.stopPropagation()},onDrop:D=>{D.preventDefault(),D.stopPropagation(),Array.from(D.dataTransfer.files).filter(x=>x.type.startsWith("image/")).forEach(x=>{const L=new FileReader;L.onload=U=>{var G;const X=(G=U.target)==null?void 0:G.result;Qe(Z=>({...Z,quickImages:[...Z.quickImages,X]}))},L.readAsDataURL(x)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:T?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:15},void 0),ne.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ne.quickImages.map((D,Q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:D,alt:` ${Q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Qe(R=>({...R,quickImages:R.quickImages.filter((x,L)=>L!==Q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2618,columnNumber:23},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D=>{Array.from(D.target.files||[]).forEach(R=>{const x=new FileReader;x.onload=L=>{var X;const U=(X=L.target)==null?void 0:X.result;Qe(G=>({...G,quickImages:[...G.quickImages,U]}))},x.readAsDataURL(R)}),D.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2637,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2658,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2636,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:Ne,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2662,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ne.date&&`(${Ht(new Date(ne.date),"E",{locale:yn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2675,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ne.date,onChange:D=>Qe({...ne,date:D.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2678,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2674,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2694,columnNumber:17},void 0),a.jsxDEV("button",{ref:Fe,type:"button",onClick:()=>_e(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ne.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2701,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2695,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2693,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ne.itemName,onChange:D=>Qe({...ne,itemName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2709,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2707,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2720,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ne.amount?Number(ne.amount).toLocaleString():"",onChange:D=>{const Q=D.target.value.replace(/[^0-9]/g,"");Qe({...ne,amount:Q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2733,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2719,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{B||re(!1),S(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2751,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2753,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2739,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:D=>D.preventDefault(),onClick:()=>{F||S(!1),re(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2718,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(At.length>0||q.length>0&&!ct)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${At.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:At.map(D=>{const Q=D.id||D._id,R=ct===Q;return a.jsxDEV("button",{type:"button",onClick:()=>Qt(D),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${R?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:va(D.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2803,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName||""," ",D.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2806,columnNumber:29},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2793,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2788,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${q.length===0||ct?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2819,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:q.map((D,Q)=>a.jsxDEV("button",{type:"button",onClick:()=>{Qe(R=>({...R,accountHolder:D.accountHolder,bankName:D.bankName,accountNumber:D.accountNumber})),te([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:D.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2836,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[D.bankName," ",D.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2839,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2822,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountHolder,onChange:D=>Qe({...ne,accountHolder:D.target.value}),onFocus:()=>we(!0),onBlur:()=>setTimeout(()=>we(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:17},void 0),de&&be.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:be.map((D,Q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:R=>R.preventDefault(),onClick:()=>{let R=D.bankName||"",x=D.accountNumber||"";const L=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],U={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const X of L)if(x.includes(X)){R||(R=U[X]||X),x=x.replace(X,"").trim();break}for(const X of L)if(R.includes(X)){const G=U[X]||X,Z=R.replace(X,"").trim();Z&&/\d/.test(Z)&&(x=Z),R=G;break}x=x.replace(/[^\d\-]/g,"").trim(),Qe({...ne,accountHolder:D.name,bankName:R||ne.bankName,accountNumber:x||ne.accountNumber}),we(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:D.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2952,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:D.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2953,columnNumber:25},void 0)]},`${D.name}-${Q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2865,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2863,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2964,columnNumber:17},void 0),a.jsxDEV("select",{value:ne.bankName,onChange:D=>Qe({...ne,bankName:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2970,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2971,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2972,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2973,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2974,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2975,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2976,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2977,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2978,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2979,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2980,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2981,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2983,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2984,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2985,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2986,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2987,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2988,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2989,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2990,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2991,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2992,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2965,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2963,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2997,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ne.accountNumber,onChange:D=>Qe({...ne,accountNumber:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2998,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2996,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const D=Number(ne.amount)||0;let Q=D;return F&&(Q=Math.round(D*.967)),Q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{w(null),Qe(D=>({project:D.project,date:Ht(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),S(!1),re(!1),P(null),oe.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),a.jsxDEV("button",{onClick:D=>{console.log(" Payment button clicked!",D),console.log(" Button element:",D.currentTarget),console.log(" Form data:",ne),_t()},disabled:ut,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ut?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ut?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2779,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2515,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2512,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${A!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>Re("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:xt.filter(D=>D&&D.id&&D.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3103,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3094,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Re("completed"),Qe(D=>({...D,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:xt.filter(D=>D&&D.id&&D.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3122,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3109,columnNumber:17},void 0),he==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ut,onChange:D=>{ae(D.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(D.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3131,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3130,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3093,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3092,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3091,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3146,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:yt.length>0?a.jsxDEV("div",{className:"space-y-4",children:yt.map(D=>{var X,G,Z;const Q=D.amount||0,R=((X=D.bankInfo)==null?void 0:X.accountHolder)||D.accountHolder||"",x=((G=D.bankInfo)==null?void 0:G.bankName)||D.bank||"",L=((Z=D.bankInfo)==null?void 0:Z.accountNumber)||D.accountNumber||"",U=R&&x&&L?`${R} | ${x} ${L}`:" ";return a.jsxDEV("div",{onClick:()=>h(D.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===D.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[D.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",D.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3178,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:D.purpose||D.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3180,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:D.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3184,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[Q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3187,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[D.requestedBy||"-","  ",lg(D.requestDate,"MM/dd",{locale:yn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3190,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3174,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3198,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3199,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(D.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3200,columnNumber:25},void 0),D.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:27},void 0),D.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3210,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3208,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3197,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:U},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3217,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),mn(D)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(xx,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3221,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async ie=>{ie.stopPropagation(),window.confirm("  ?")&&(await r(D.id),oe.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(xi,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3242,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3231,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:23},void 0),he==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:ie=>{if(ie.stopPropagation(),D.status==="completed"){oe.info("   ");return}nn(D)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${D.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:D.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:27},void 0),a.jsxDEV("button",{onClick:ie=>{ie.stopPropagation(),Cn(D.id)},disabled:D.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${D.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:D.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:ie=>{D.status!=="completed"&&(ie.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3269,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:25},void 0)]},D.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3164,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3150,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3300,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3148,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3087,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${A!=="image"?"hidden lg:flex":""}`,onDragOver:ei,onDragLeave:Is,onDrop:Jn,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:ls,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3316,columnNumber:11},void 0),T&&f&&A==="image"&&(()=>{const D=xt.find(Q=>Q.id===f);return D?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:D.purpose||D.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3333,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[D.process||"-","  ",lg(D.requestDate,"yyyy.MM.dd",{locale:yn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3334,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3332,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(D.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3338,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3331,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3330,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:D=>{var R;const Q=D.target;if(!Q.closest("img")&&!Q.closest("button")&&f){const x=xt.find(G=>G.id===f),L=(x==null?void 0:x.images)||[],U=qe[f]||[];(L.length>0?L:U).length>0&&((R=document.getElementById("image-file-input"))==null||R.click())}},children:f?(()=>{const D=xt.find(L=>L.id===f),Q=(D==null?void 0:D.images)||[],R=qe[f]||[],x=Q.length>0?Q:R;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3374,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(D==null?void 0:D.quickText)||(D==null?void 0:D.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3375,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3373,columnNumber:19},void 0),x.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:x.map((L,U)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:L,alt:` ${U+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:X=>{X.stopPropagation(),cs(L)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3389,columnNumber:27},void 0),a.jsxDEV("button",{onClick:X=>{X.stopPropagation(),Wn(U)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(bn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3398,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[U+1,"/",x.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3407,columnNumber:27},void 0)]},U,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${x.length>0?"":"flex-1"}`,onClick:L=>L.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${x.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(zu,{className:`mx-auto text-gray-400 mb-1 ${x.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3426,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:x.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3427,columnNumber:23},void 0),x.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3431,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3421,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3416,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3371,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(ta,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3440,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3441,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3439,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3348,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3308,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2509,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(bn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3457,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Fu.map(D=>a.jsxDEV("button",{onClick:()=>{Qe({...ne,process:D}),_e(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3466,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Qe({...ne,process:""}),_e(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3485,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3465,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3454,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>_e(!1),children:a.jsxDEV("div",{onClick:D=>D.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:Fe.current?`${Fe.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:Fe.current?`${Fe.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(bn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3510,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3508,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Fu.map(D=>a.jsxDEV("button",{onClick:()=>{Qe({...ne,process:D}),_e(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ne.process===D?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:D},D,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3519,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Qe({...ne,process:""}),_e(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3500,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3451,columnNumber:9},void 0),ee&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:D=>{D.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(bn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3567,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3560,columnNumber:13},void 0),a.jsxDEV("img",{src:V,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:D=>D.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3569,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3559,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3555,columnNumber:9},void 0),bt&&a.jsxDEV(J2,{projectName:Vt,onClose:()=>it(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2450,columnNumber:5},void 0)},oI=()=>{var ne,Qe;const{user:n}=$r(),{loadProjectsFromAPI:e,projects:t}=Fr(),s=iu(),[r,i]=E.useState([]),[o,l]=E.useState(!0),[u,m]=E.useState(null),[d,f]=E.useState([]),[h,y]=E.useState(!1),[w,v]=E.useState(""),[C,B]=E.useState(""),[S,F]=E.useState(null),[re,ee]=E.useState(null),[M,V]=E.useState(""),[N,A]=E.useState(null),[j,T]=E.useState(""),[I,k]=E.useState(null),[_e,Fe]=E.useState(new Set),he=E.useRef(null),[Re,dt]=E.useState(window.innerWidth<768),[Ot,Ut]=E.useState(!1),[ae,Oe]=E.useState(null),[me,Le]=E.useState(new Set),[Ke,bt]=E.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[it,Vt]=E.useState(!1),[rt,ut]=E.useState(!1),[un,K]=E.useState(new Set);E.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Ke))},[Ke]),E.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const Ne=()=>{dt(window.innerWidth<768)};return window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]),E.useEffect(()=>{o||Se()},[s,o]),E.useEffect(()=>{u!==null&&Be()},[u]),E.useEffect(()=>{u!==null&&(n!=null&&n.id)&&localStorage.setItem(`finishCheck_selectedProject_${n.id}`,u.toString())},[u,n==null?void 0:n.id]),E.useEffect(()=>{if(!Re&&I){const O=async Ne=>{var Pe;const De=(Pe=Ne.clipboardData)==null?void 0:Pe.items;if(De){for(let ue=0;ue<De.length;ue++)if(De[ue].type.indexOf("image")!==-1){Ne.preventDefault();const xt=De[ue].getAsFile();xt&&await we(I,xt)}}};return document.addEventListener("paste",O),()=>document.removeEventListener("paste",O)}},[I,Re]);const Se=async()=>{try{const O=s.map(De=>({id:De.id,title:De.name}));i(O);const Ne=n!=null&&n.id?localStorage.getItem(`finishCheck_selectedProject_${n.id}`):null;Ne&&O.some(De=>De.id===Number(Ne))?m(Number(Ne)):O.length>0&&m(O[0].id)}catch(O){console.error("Failed to load projects:",O),oe.error("   ")}},Be=async()=>{try{d.length===0&&y(!0);const O=u?`/finish-check/spaces?project_id=${u}`:"/finish-check/spaces",De=(await Ce.get(O)).data.map(Pe=>({...Pe,items:Pe.items.map(ue=>({...ue,images:ue.images||[]}))}));f(De)}catch(O){console.error("Failed to load spaces:",O),oe.error("   ")}finally{y(!1)}},Ie=async O=>{if(un.has(O))return null;try{K(Pe=>new Set(Pe).add(O));const De=(await Ce.get(`/finish-check/images/${O}`)).data.image_data;return f(Pe=>Pe.map(ue=>({...ue,items:ue.items.map(xt=>({...xt,images:xt.images.map(yt=>yt.id===O?{...yt,image_data:De}:yt)}))}))),De}catch(Ne){return console.error("   :",Ne),null}finally{K(Ne=>{const De=new Set(Ne);return De.delete(O),De})}},Ge=async O=>{const Ne=d.find(ue=>ue.items.some(xt=>xt.id===O)),De=Ne==null?void 0:Ne.items.find(ue=>ue.id===O);if(!De)return;const Pe=De.images.filter(ue=>!ue.image_data);await Promise.all(Pe.map(ue=>Ie(ue.id)))},At=async()=>{if(!rt){if(!w.trim()){oe.error("  ");return}if(!u){oe.error(" ");return}ut(!0);try{const O=await Ce.post("/finish-check/spaces",{name:w.trim(),project_id:u}),Ne={...O.data,items:O.data.items||[]};f([...d,Ne]),v(""),Vt(!1),oe.success(" ")}catch(O){console.error("Failed to add space:",O),oe.error("  ")}finally{ut(!1)}}},qt=async(O,Ne)=>{if(!Ne.trim()){oe.error("  ");return}try{await Ce.put(`/finish-check/spaces/${O}`,{name:Ne.trim()}),f(d.map(De=>De.id===O?{...De,name:Ne.trim()}:De)),ee(null),V(""),oe.success("  ")}catch(De){console.error("Failed to update space:",De),oe.error("  ")}},ct=O=>{Oe(O),Le(new Set)},P=async()=>{if(ae!==null){if(me.size===0){oe.error("  ");return}try{await Promise.all(Array.from(me).map(O=>Ce.delete(`/finish-check/items/${O}`))),f(d.map(O=>O.id===ae?{...O,items:O.items.filter(Ne=>!me.has(Ne.id))}:O)),oe.success(`${me.size}  `),Oe(null),Le(new Set)}catch(O){console.error("Failed to delete items:",O),oe.error("  ")}}},q=async()=>{if(ae===null)return;const O=d.find(Ne=>Ne.id===ae);if(O&&confirm(`"${O.name}"  ?

        .`))try{await Ce.delete(`/finish-check/spaces/${ae}`),f(d.filter(Ne=>Ne.id!==ae)),oe.success(" "),Oe(null),Le(new Set)}catch(Ne){console.error("Failed to delete space:",Ne),oe.error("  ")}},te=async O=>{if(!C.trim()){oe.error("  ");return}const Ne=-Date.now(),De={id:Ne,space_id:O,content:C.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(ue=>ue.id===O?{...ue,items:[...ue.items,De]}:ue));const Pe=C.trim();B(""),F(null);try{const ue=await Ce.post("/finish-check/items",{space_id:O,content:Pe});f(xt=>xt.map(yt=>yt.id===O?{...yt,items:yt.items.map(Qt=>Qt.id===Ne?{...ue.data,images:[]}:Qt)}:yt))}catch(ue){console.error("Failed to add item:",ue),f(xt=>xt.map(yt=>yt.id===O?{...yt,items:yt.items.filter(Qt=>Qt.id!==Ne)}:yt)),oe.error("  ")}},be=async O=>{try{const Ne=await Ce.put(`/finish-check/items/${O}/toggle`);f(d.map(De=>({...De,items:De.items.map(Pe=>Pe.id===O?{...Pe,...Ne.data}:Pe)})))}catch(Ne){console.error("Failed to toggle item:",Ne),oe.error("   ")}},ce=async O=>{try{const Ne=await Ce.put(`/finish-check/items/${O}/toggle-priority`);f(d.map(De=>({...De,items:De.items.map(Pe=>Pe.id===O?{...Pe,is_priority:Ne.data.is_priority}:Pe)})))}catch(Ne){console.error("Failed to toggle priority:",Ne),oe.error("  ")}},de=O=>new Promise((Ne,De)=>{const Pe=new FileReader;Pe.readAsDataURL(O),Pe.onload=()=>Ne(Pe.result),Pe.onerror=ue=>De(ue)}),we=async(O,Ne)=>{var ue,xt;if(!["image/jpeg","image/png","image/webp"].includes(Ne.type)){oe.error("JPEG, PNG, WebP    ");return}const Pe=5*1024*1024;if(Ne.size>Pe){oe.error("  5MB  ");return}try{Fe(_t=>new Set([..._t,O]));const yt=await de(Ne),Qt=await Ce.post(`/finish-check/items/${O}/images`,{image_data:yt,filename:Ne.name});f(d.map(_t=>({..._t,items:_t.items.map(mn=>mn.id===O?{...mn,images:[...mn.images,Qt.data]}:mn)}))),oe.success(" ")}catch(yt){console.error("Failed to upload image:",yt),oe.error(((xt=(ue=yt.response)==null?void 0:ue.data)==null?void 0:xt.error)||"  ")}finally{Fe(yt=>{const Qt=new Set(yt);return Qt.delete(O),Qt})}},qe=async(O,Ne)=>{const De=Ne.target.files;if(!(!De||De.length===0)){for(let Pe=0;Pe<De.length;Pe++)await we(O,De[Pe]);he.current&&(he.current.value="")}},Je=async(O,Ne)=>{if(confirm("  ?"))try{await Ce.delete(`/finish-check/images/${Ne}`),f(d.map(De=>({...De,items:De.items.map(Pe=>Pe.id===O?{...Pe,images:Pe.images.filter(ue=>ue.id!==Ne)}:Pe)}))),oe.success(" ")}catch(De){console.error("Failed to delete image:",De),oe.error("  ")}},ke=async(O,Ne)=>{O.preventDefault(),O.stopPropagation();const De=O.dataTransfer.files;if(!(!De||De.length===0))for(let Pe=0;Pe<De.length;Pe++)De[Pe].type.startsWith("image/")&&await we(Ne,De[Pe])},Pn=O=>{O.preventDefault(),O.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:613,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:7},void 0);const jt=I?d.flatMap(O=>O.items).find(O=>O.id===I):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:he,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:O=>{I&&qe(I,O)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:625,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Re?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:O=>{const Ne=O.target.value?Number(O.target.value):null;m(Ne)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:655,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:646,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:665,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>Vt(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(io,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:683,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:678,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:644,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:691,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:O=>{const Ne=O.target.value?Number(O.target.value):null;m(Ne)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:700,columnNumber:43},void 0),r.map(O=>a.jsxDEV("option",{value:O.id,children:O.title},O.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:702,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:692,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:690,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:711,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&At()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:713,columnNumber:19},void 0),a.jsxDEV("button",{onClick:At,disabled:rt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(io,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:731,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:725,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:710,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:738,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:737,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:641,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:757,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((O,Ne)=>{const De=O.items.filter(ue=>!ue.is_completed).sort((ue,xt)=>(xt.is_priority||0)-(ue.is_priority||0)),Pe=O.items.filter(ue=>ue.is_completed);return Ke&&De.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[re===O.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:ue=>V(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?qt(O.id,M):ue.key==="Escape"&&(ee(null),V(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:776,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>qt(O.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(mg,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:795,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:791,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{ee(null),V("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(bn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:797,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:775,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:Ne+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0),O.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:810,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Pe.length,"/",O.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:816,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:809,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{S===O.id?(F(null),B("")):F(O.id)},className:`p-1 transition-colors ${S===O.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(io,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:837,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{ee(O.id),V(O.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(Wu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:839,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>ct(O.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:849,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:808,columnNumber:23},void 0),S===O.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:C,onChange:ue=>B(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&C.trim()&&te(O.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:864,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>te(O.id),disabled:!C.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:877,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:863,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:862,columnNumber:23},void 0),De.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:De.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>be(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:897,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Re&&I===ue.id?"font-semibold":""}`,onClick:async()=>{Re||(k(ue.id),ue.images&&ue.images.length>0&&await Ge(ue.id))},style:{cursor:Re?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:918,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:904,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),Re&&Ut(!0),ue.images&&ue.images.length>0&&await Ge(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(ta,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:942,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Tf,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:953,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:944,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:923,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:893,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:891,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:890,columnNumber:23},void 0),!Ke&&Pe.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Pe.map(ue=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>be(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:971,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Re&&I===ue.id?"font-semibold":""}`,onClick:async()=>{Re||(k(ue.id),ue.images&&ue.images.length>0&&await Ge(ue.id))},style:{cursor:Re?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:992,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:978,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(ue.id),Re&&Ut(!0),ue.images&&ue.images.length>0&&await Ge(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(ta,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1016,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:998,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ce(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Tf,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1027,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1018,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:997,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:967,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:965,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:964,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:772,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:755,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:639,columnNumber:7},void 0),!Re&&I&&jt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1048,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(bn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1054,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1047,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1057,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=he.current)==null?void 0:O.click()},disabled:_e.has(I),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(zu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1063,columnNumber:15},void 0),_e.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1066,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1046,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:O=>ke(O,I),onDragOver:Pn,children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(ta,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(O=>a.jsxDEV("div",{className:"relative group",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1086,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1093,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1092,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>Je(I,O.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Sf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:21},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1084,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1082,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1071,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1045,columnNumber:9},void 0),Re&&Ot&&I&&jt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ut(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(bn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1130,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1121,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1133,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var O;return(O=he.current)==null?void 0:O.click()},disabled:_e.has(I),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(zu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1139,columnNumber:17},void 0),_e.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1120,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(ta,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(O=>a.jsxDEV("div",{className:"relative",children:[O.image_data?a.jsxDEV("img",{src:O.image_data,alt:O.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1155,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1162,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1161,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Je(I,O.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Sf,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1169,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1165,columnNumber:23},void 0),O.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:O.filename,children:O.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1172,columnNumber:25},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1153,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ne=d.find(O=>O.id===ae))==null?void 0:ne.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1191,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Oe(null),Le(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(bn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1201,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1194,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1189,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1207,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Qe=d.find(O=>O.id===ae))==null?void 0:Qe.items.map(O=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const Ne=new Set(me);Ne.has(O.id)?Ne.delete(O.id):Ne.add(O.id),Le(Ne)},children:[a.jsxDEV("input",{type:"checkbox",checked:me.has(O.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1227,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${O.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:O.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:23},void 0)]},O.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1214,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1210,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:me.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",me.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1242,columnNumber:15},void 0),a.jsxDEV("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1249,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{Oe(null),Le(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1255,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1241,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1188,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1187,columnNumber:9},void 0),it&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1275,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Vt(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(bn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1283,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1276,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1274,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1290,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:w,onChange:O=>v(O.target.value),onKeyPress:O=>{O.key==="Enter"&&w.trim()&&At()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1291,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1289,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{Vt(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1307,columnNumber:17},void 0),a.jsxDEV("button",{onClick:At,disabled:!w.trim()||rt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:rt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1316,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1306,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1288,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1272,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1271,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:623,columnNumber:5},void 0)};function aI(){const[n,e]=E.useState([]),[t,s]=E.useState(!1),[r,i]=E.useState(null),[o,l]=E.useState(!1),[u,m]=E.useState(null),[d,f]=E.useState(""),[h,y]=E.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[w,v]=E.useState(!1);E.useEffect(()=>{C()},[]),E.useEffect(()=>{const N=()=>{B()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const C=async()=>{var N,A;try{n.length===0&&s(!0),i(null);const j=await er.getAllContractors();e(j.map(T=>({id:T._id,rank:T.rank,companyName:T.companyName,name:T.name,position:T.position,process:T.process,contact:T.contact,accountNumber:T.accountNumber,notes:T.notes,createdAt:new Date(T.createdAt),updatedAt:new Date(T.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const T=j instanceof Error&&((A=(N=j.response)==null?void 0:N.data)==null?void 0:A.message);i(T||"   .")}finally{s(!1)}},B=N=>{if(N){m(N);let A="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const _e of k)if(N.accountNumber.startsWith(_e)){A=_e,j=N.accountNumber.substring(_e.length).trim();break}}let T=N.name,I=N.position||"";I||(I=_l(N.name),T=va(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:T,position:I,process:N.process,contact:N.contact||"",bankName:A,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},S=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async N=>{var j,T;if(N.preventDefault(),w)return;v(!0);const A=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const I={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:A,notes:h.notes};u?await er.updateContractor(u.id,I):await er.createContractor(I),await C(),S()}catch(I){console.error("Failed to save contractor:",I);const k=I instanceof Error&&((T=(j=I.response)==null?void 0:j.data)==null?void 0:T.message);alert(k||"  .")}finally{v(!1)}},re=async N=>{var A,j;if(window.confirm("   ?"))try{await er.deleteContractor(N),await C()}catch(T){console.error("Failed to delete contractor:",T);const I=T instanceof Error&&((j=(A=T.response)==null?void 0:A.data)==null?void 0:j.message);alert(I||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",M=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,V=n.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,A)=>{const j=M(N.rank)-M(A.rank);if(j!==0)return j;const T=N.process.localeCompare(A.process,"ko");return T!==0?T:N.name.localeCompare(A.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(fg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:C,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):V.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):V.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:va(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||_l(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(Wu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:C,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):V.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):V.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:va(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(Wu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>re(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||_l(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||_l(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:S,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(bn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:N=>y({...h,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:N=>y({...h,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:N=>y({...h,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:N=>y({...h,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:N=>y({...h,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:N=>y({...h,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:N=>y({...h,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:N=>y({...h,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:N=>y({...h,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:S,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:w?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const lI=()=>{const[n,e]=E.useState([]),[t,s]=E.useState(null),[r,i]=E.useState(!1);E.useEffect(()=>{o()},[]);const o=async()=>{try{n.length===0&&i(!0);const f=await Ce.get("/quote-inquiries");e(f.data)}catch(f){console.error("Failed to load inquiries:",f),oe.error("  ")}finally{i(!1)}},l=async f=>{try{await Ce.put(`/quote-inquiries/${f}/read`),e(h=>h.map(y=>y.id===f?{...y,isRead:!0}:y)),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{s(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await Ce.delete(`/quote-inquiries/${f}`),e(y=>y.filter(w=>w.id!==f)),(t==null?void 0:t.id)===f&&s(null),oe.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),oe.error("  ")}},d=n.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:93,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:92,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:106,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:103,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:115,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:n.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:135,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ht(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:139,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(xi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:147,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:142,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Pf,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:157,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:127,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:121,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:101,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ht(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(vx,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:194,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:193,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Pf,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(_x,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:204,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:202,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Dx,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:208,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:209,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:207,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:197,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:192,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(kx,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:219,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:218,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:225,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:224,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:231,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:217,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:241,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:240,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:249,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:169,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:99,columnNumber:5},void 0)},cI=()=>{const{login:n}=$r(),[e,t]=E.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:o}}=rf(),l=async m=>{t(!0);try{await n(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(Ex,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},uI=E.lazy(()=>Ws(()=>import("./Drawings-C8LqNsTa.js"),__vite__mapDeps([0,1,2,3,4,5]))),mI=E.lazy(()=>Ws(()=>import("./SiteLog-DM95sHpr.js"),__vite__mapDeps([6,1,4,2,3,5]))),dI=E.lazy(()=>Ws(()=>import("./AfterService-BxBQxCmh.js"),__vite__mapDeps([7,1,2,4,3,5]))),fI=E.lazy(()=>Ws(()=>import("./AdditionalWork-D-RV4EV-.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),pI=E.lazy(()=>Ws(()=>import("./ConstructionPayment-CuQX2b9z.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),hI=E.lazy(()=>Ws(()=>import("./WorkRequest-DiZXZPE9.js"),__vite__mapDeps([11,1,2,4,3,5]))),gI=E.lazy(()=>Ws(()=>import("./Specbook-CDoFzdq_.js"),__vite__mapDeps([12,1,2,3,4,5]))),yI=E.lazy(()=>Ws(()=>import("./EstimatePreview-A9NKa9Pd.js"),__vite__mapDeps([13,1,2,3,4,5]))),bI=E.lazy(()=>Ws(()=>import("./ExecutionHistory-DKn2CLp-.js"),__vite__mapDeps([14,1,4,2,3,5]))),NI=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),xI=new mx({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function vI(){const[n,e]=E.useState(!1);return E.useEffect(()=>{const t=E_({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),oe.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{oe.dismiss(),oe.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});eC();const s=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(s,5e3);const r=setInterval(s,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=ca(u,{transports:["websocket","polling"]}),kr.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;Z1(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(dx,{client:xI,children:a.jsxDEV(lx,{children:a.jsxDEV(I_,{children:[a.jsxDEV(E.Suspense,{fallback:a.jsxDEV(NI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(cx,{children:[a.jsxDEV(En,{path:"/login",element:a.jsxDEV(cI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(En,{path:"/",element:a.jsxDEV(Y1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(En,{index:!0,element:a.jsxDEV(ug,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(En,{path:"dashboard",element:a.jsxDEV(wC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(En,{path:"projects",element:a.jsxDEV(RC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(En,{path:"schedule",element:a.jsxDEV(X2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(En,{path:"drawings",element:a.jsxDEV(uI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(En,{path:"site-log",element:a.jsxDEV(mI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(En,{path:"after-service",element:a.jsxDEV(dI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(En,{path:"additional-work",element:a.jsxDEV(fI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(En,{path:"construction-payment",element:a.jsxDEV(pI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(En,{path:"contractors",element:a.jsxDEV(aI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(En,{path:"work-request",element:a.jsxDEV(hI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(En,{path:"finish-check",element:a.jsxDEV(oI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(En,{path:"specbook",element:a.jsxDEV(gI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(En,{path:"estimate-preview",element:a.jsxDEV(yI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(En,{path:"execution-history",element:a.jsxDEV(bI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(En,{path:"payments",element:a.jsxDEV(iI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(En,{path:"quote-inquiry",element:a.jsxDEV(lI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(Tv,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(const e of n)e.update()});wg(document.getElementById("root")).render(a.jsxDEV(E.StrictMode,{children:a.jsxDEV(vI,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{Bt as C,Fu as P,Ce as a,iu as b,Fr as c,rf as d,w_ as e,Rm as f,II as g,tI as h,a as j,yn as l,rI as m,vs as p,nI as s,$r as u,dD as w,oe as z};
