const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-DwsPuwcG.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-C155bt_A.js","assets/AfterService-D0Tj0DIC.js","assets/AdditionalWork-bh7tr_w7.js","assets/additionalWorkService-CiapU9F7.js","assets/ConstructionPayment-CSsuV3aI.js","assets/WorkRequest-Cu8eJYud.js","assets/Specbook-BF5osAiO.js","assets/EstimatePreview-Cegu7oxY.js","assets/ExecutionHistory-D_LA_JKA.js"])))=>i.map(i=>d[i]);
import{r as k,b as yb,u as op,d as bb,N as ap,e as mc,O as Nb,R as it,f as na,B as xb,h as vb,i as Vn}from"./vendor-react-DN7YJcfR.js";import{a as _b,c as ym,Q as Db,b as kb}from"./vendor-data-DrLf5NIQ.js";import{B as uc,X as Nn,C as lp,T as ni,a as Ab,b as cp,W as Eb,c as Vb,d as vs,P as Hi,R as Cb,e as wb,S as mp,f as Sb,g as Ib,h as up,i as Pb,U as Lc,I as Eo,j as Tc,k as Yu,l as Gu,m as Xu,n as Lb,M as Tb,o as jb,p as Rb,L as Bb}from"./vendor-ui-D8A9iq7X.js";import{k as dc,l as mo,m as uo,n as Ub,o as Hb,p as Mt,q as Mb,r as Ju,s as Fb,t as et}from"./vendor-date-DbWJ9m7c.js";import{c as Ob,p as dp,l as _l,s as _s,i as qb,h as $b,q as bm,a as Nm,m as xm,b as Wb,d as Dl,o as el,e as zb,f as tl,r as vm,g as _m,j as Dm,k as km,n as Am,t as fp,u as pp,v as hp,w as gp,x as yp,y as bp,z as Np,A as xp,B as vp,C as _p,D as Dp,E as kp,F as Kb,G as Qb,H as Yb,I as Gb,J as Xb,K as Jb,L as Zb}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var Ap={exports:{}},jc={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var t=k,e=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),C=Symbol.iterator,v="@@iterator";function S(g){if(g===null||typeof g!="object")return null;var R=C&&g[C]||g[v];return typeof R=="function"?R:null}var B=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function L(g){{for(var R=arguments.length,w=new Array(R>1?R-1:0),M=1;M<R;M++)w[M-1]=arguments[M];W("error",g,w)}}function W(g,R,w){{var M=B.ReactDebugCurrentFrame,H=M.getStackAddendum();H!==""&&(R+="%s",w=w.concat([H]));var G=w.map(function(q){return String(q)});G.unshift("Warning: "+R),Function.prototype.apply.call(console[g],console,G)}}var ie=!1,ee=!1,F=!1,A=!1,x=!1,E;E=Symbol.for("react.module.reference");function j(g){return!!(typeof g=="string"||typeof g=="function"||g===s||g===i||x||g===r||g===u||g===d||A||g===b||ie||ee||F||typeof g=="object"&&g!==null&&(g.$$typeof===p||g.$$typeof===h||g.$$typeof===a||g.$$typeof===c||g.$$typeof===m||g.$$typeof===E||g.getModuleId!==void 0))}function I(g,R,w){var M=g.displayName;if(M)return M;var H=R.displayName||R.name||"";return H!==""?w+"("+H+")":w}function P(g){return g.displayName||"Context"}function D(g){if(g==null)return null;if(typeof g.tag=="number"&&L("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case s:return"Fragment";case n:return"Portal";case i:return"Profiler";case r:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case c:var R=g;return P(R)+".Consumer";case a:var w=g;return P(w._context)+".Provider";case m:return I(g,g.render,"ForwardRef");case h:var M=g.displayName||null;return M!==null?M:D(g.type)||"Memo";case p:{var H=g,G=H._payload,q=H._init;try{return D(q(G))}catch{return null}}}return null}var Ae=Object.assign,Ue=0,ge,Se,tt,Ut,Ht,ae,Me;function fe(){}fe.__reactDisabledLog=!0;function Ie(){{if(Ue===0){ge=console.log,Se=console.info,tt=console.warn,Ut=console.error,Ht=console.group,ae=console.groupCollapsed,Me=console.groupEnd;var g={configurable:!0,enumerable:!0,value:fe,writable:!0};Object.defineProperties(console,{info:g,log:g,warn:g,error:g,group:g,groupCollapsed:g,groupEnd:g})}Ue++}}function ze(){{if(Ue--,Ue===0){var g={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Ae({},g,{value:ge}),info:Ae({},g,{value:Se}),warn:Ae({},g,{value:tt}),error:Ae({},g,{value:Ut}),group:Ae({},g,{value:Ht}),groupCollapsed:Ae({},g,{value:ae}),groupEnd:Ae({},g,{value:Me})})}Ue<0&&L("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=B.ReactCurrentDispatcher,nt;function Ct(g,R,w){{if(nt===void 0)try{throw Error()}catch(H){var M=H.stack.trim().match(/\n( *(at )?)/);nt=M&&M[1]||""}return`
`+nt+g}}var ot=!1,Nt;{var Xt=typeof WeakMap=="function"?WeakMap:Map;Nt=new Xt}function Q(g,R){if(!g||ot)return"";{var w=Nt.get(g);if(w!==void 0)return w}var M;ot=!0;var H=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var G;G=bt.current,bt.current=null,Ie();try{if(R){var q=function(){throw Error()};if(Object.defineProperty(q.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(q,[])}catch(He){M=He}Reflect.construct(g,[],q)}else{try{q.call()}catch(He){M=He}g.call(q.prototype)}}else{try{throw Error()}catch(He){M=He}g()}}catch(He){if(He&&M&&typeof He.stack=="string"){for(var O=He.stack.split(`
`),Z=M.stack.split(`
`),re=O.length-1,we=Z.length-1;re>=1&&we>=0&&O[re]!==Z[we];)we--;for(;re>=1&&we>=0;re--,we--)if(O[re]!==Z[we]){if(re!==1||we!==1)do if(re--,we--,we<0||O[re]!==Z[we]){var Ye=`
`+O[re].replace(" at new "," at ");return g.displayName&&Ye.includes("<anonymous>")&&(Ye=Ye.replace("<anonymous>",g.displayName)),typeof g=="function"&&Nt.set(g,Ye),Ye}while(re>=1&&we>=0);break}}}finally{ot=!1,bt.current=G,ze(),Error.prepareStackTrace=H}var at=g?g.displayName||g.name:"",xe=at?Ct(at):"";return typeof g=="function"&&Nt.set(g,xe),xe}function Pe(g,R,w){return Q(g,!1)}function qe(g){var R=g.prototype;return!!(R&&R.isReactComponent)}function Le(g,R,w){if(g==null)return"";if(typeof g=="function")return Q(g,qe(g));if(typeof g=="string")return Ct(g);switch(g){case u:return Ct("Suspense");case d:return Ct("SuspenseList")}if(typeof g=="object")switch(g.$$typeof){case m:return Pe(g.render);case h:return Le(g.type,R,w);case p:{var M=g,H=M._payload,G=M._init;try{return Le(G(H),R,w)}catch{}}}return""}var $e=Object.prototype.hasOwnProperty,gt={},Ot=B.ReactDebugCurrentFrame;function ct(g){if(g){var R=g._owner,w=Le(g.type,g._source,R?R.type:null);Ot.setExtraStackFrame(w)}else Ot.setExtraStackFrame(null)}function T(g,R,w,M,H){{var G=Function.call.bind($e);for(var q in g)if(G(g,q)){var O=void 0;try{if(typeof g[q]!="function"){var Z=Error((M||"React class")+": "+w+" type `"+q+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof g[q]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Z.name="Invariant Violation",Z}O=g[q](R,q,M,w,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(re){O=re}O&&!(O instanceof Error)&&(ct(H),L("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",M||"React class",w,q,typeof O),ct(null)),O instanceof Error&&!(O.message in gt)&&(gt[O.message]=!0,ct(H),L("Failed %s type: %s",w,O.message),ct(null))}}}var $=Array.isArray;function X(g){return $(g)}function ye(g){{var R=typeof Symbol=="function"&&Symbol.toStringTag,w=R&&g[Symbol.toStringTag]||g.constructor.name||"Object";return w}}function le(g){try{return de(g),!1}catch{return!0}}function de(g){return""+g}function Ee(g){if(le(g))return L("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ye(g)),de(g)}var Ke=B.ReactCurrentOwner,Ze={key:!0,ref:!0,__self:!0,__source:!0},Ne,fn,Pt;Pt={};function st(g){if($e.call(g,"ref")){var R=Object.getOwnPropertyDescriptor(g,"ref").get;if(R&&R.isReactWarning)return!1}return g.ref!==void 0}function sn(g){if($e.call(g,"key")){var R=Object.getOwnPropertyDescriptor(g,"key").get;if(R&&R.isReactWarning)return!1}return g.key!==void 0}function V(g,R){if(typeof g.ref=="string"&&Ke.current&&R&&Ke.current.stateNode!==R){var w=D(Ke.current.type);Pt[w]||(L('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',D(Ke.current.type),g.ref),Pt[w]=!0)}}function oe(g,R){{var w=function(){Ne||(Ne=!0,L("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};w.isReactWarning=!0,Object.defineProperty(g,"key",{get:w,configurable:!0})}}function De(g,R){{var w=function(){fn||(fn=!0,L("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};w.isReactWarning=!0,Object.defineProperty(g,"ref",{get:w,configurable:!0})}}var Be=function(g,R,w,M,H,G,q){var O={$$typeof:e,type:g,key:R,ref:w,props:q,_owner:G};return O._store={},Object.defineProperty(O._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(O,"_self",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.defineProperty(O,"_source",{configurable:!1,enumerable:!1,writable:!1,value:H}),Object.freeze&&(Object.freeze(O.props),Object.freeze(O)),O};function ue(g,R,w,M,H){{var G,q={},O=null,Z=null;w!==void 0&&(Ee(w),O=""+w),sn(R)&&(Ee(R.key),O=""+R.key),st(R)&&(Z=R.ref,V(R,H));for(G in R)$e.call(R,G)&&!Ze.hasOwnProperty(G)&&(q[G]=R[G]);if(g&&g.defaultProps){var re=g.defaultProps;for(G in re)q[G]===void 0&&(q[G]=re[G])}if(O||Z){var we=typeof g=="function"?g.displayName||g.name||"Unknown":g;O&&oe(q,we),Z&&De(q,we)}return Be(g,O,Z,H,M,Ke.current,q)}}var Lt=B.ReactCurrentOwner,yt=B.ReactDebugCurrentFrame;function zt(g){if(g){var R=g._owner,w=Le(g.type,g._source,R?R.type:null);yt.setExtraStackFrame(w)}else yt.setExtraStackFrame(null)}var dt;dt=!1;function Jt(g){return typeof g=="object"&&g!==null&&g.$$typeof===e}function Zt(){{if(Lt.current){var g=D(Lt.current.type);if(g)return`

Check the render method of \``+g+"`."}return""}}function In(g){{if(g!==void 0){var R=g.fileName.replace(/^.*[\\\/]/,""),w=g.lineNumber;return`

Check your code at `+R+":"+w+"."}return""}}var fs={};function Qn(g){{var R=Zt();if(!R){var w=typeof g=="string"?g:g.displayName||g.name;w&&(R=`

Check the top-level render call using <`+w+">.")}return R}}function ps(g,R){{if(!g._store||g._store.validated||g.key!=null)return;g._store.validated=!0;var w=Qn(R);if(fs[w])return;fs[w]=!0;var M="";g&&g._owner&&g._owner!==Lt.current&&(M=" It was passed a child from "+D(g._owner.type)+"."),zt(g),L('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',w,M),zt(null)}}function $r(g,R){{if(typeof g!="object")return;if(X(g))for(var w=0;w<g.length;w++){var M=g[w];Jt(M)&&ps(M,R)}else if(Jt(g))g._store&&(g._store.validated=!0);else if(g){var H=S(g);if(typeof H=="function"&&H!==g.entries)for(var G=H.call(g),q;!(q=G.next()).done;)Jt(q.value)&&ps(q.value,R)}}}function ws(g){{var R=g.type;if(R==null||typeof R=="string")return;var w;if(typeof R=="function")w=R.propTypes;else if(typeof R=="object"&&(R.$$typeof===m||R.$$typeof===h))w=R.propTypes;else return;if(w){var M=D(R);T(w,g.props,"prop",M,g)}else if(R.PropTypes!==void 0&&!dt){dt=!0;var H=D(R);L("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",H||"Unknown")}typeof R.getDefaultProps=="function"&&!R.getDefaultProps.isReactClassApproved&&L("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ts(g){{for(var R=Object.keys(g.props),w=0;w<R.length;w++){var M=R[w];if(M!=="children"&&M!=="key"){zt(g),L("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",M),zt(null);break}}g.ref!==null&&(zt(g),L("Invalid attribute `ref` supplied to `React.Fragment`."),zt(null))}}var Ss={};function Bn(g,R,w,M,H,G){{var q=j(g);if(!q){var O="";(g===void 0||typeof g=="object"&&g!==null&&Object.keys(g).length===0)&&(O+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Z=In(H);Z?O+=Z:O+=Zt();var re;g===null?re="null":X(g)?re="array":g!==void 0&&g.$$typeof===e?(re="<"+(D(g.type)||"Unknown")+" />",O=" Did you accidentally export a JSX literal instead of a component?"):re=typeof g,L("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",re,O)}var we=ue(g,R,w,H,G);if(we==null)return we;if(q){var Ye=R.children;if(Ye!==void 0)if(M)if(X(Ye)){for(var at=0;at<Ye.length;at++)$r(Ye[at],g);Object.freeze&&Object.freeze(Ye)}else L("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else $r(Ye,g)}if($e.call(R,"key")){var xe=D(g),He=Object.keys(R).filter(function(ns){return ns!=="key"}),Qt=He.length>0?"{key: someKey, "+He.join(": ..., ")+": ...}":"{key: someKey}";if(!Ss[xe+Qt]){var mn=He.length>0?"{"+He.join(": ..., ")+": ...}":"{}";L(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Qt,xe,mn,xe),Ss[xe+Qt]=!0}}return g===s?ts(we):ws(we),we}}var Pn=Bn;jc.Fragment=s,jc.jsxDEV=Pn})();Ap.exports=jc;var o=Ap.exports,Ep,Zu=yb;{var ed=Zu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ep=function(t,e){ed.usingClientEntryPoint=!0;try{return Zu.createRoot(t,e)}finally{ed.usingClientEntryPoint=!1}}}const eN="modulepreload",tN=function(t){return"/"+t},td={},$s=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(m=>{if(m=tN(m),m in td)return;td[m]=!0;const u=m.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":eN,u||(h.as="script"),h.crossOrigin="",h.href=m,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((p,b)=>{h.addEventListener("load",p),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return r.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};let nN={data:""},sN=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||nN},rN=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,iN=/\/\*[^]*?\*\/|  +/g,nd=/\n+/g,hr=(t,e)=>{let n="",s="",r="";for(let i in t){let a=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+a+";":s+=i[1]=="f"?hr(a,i):i+"{"+hr(a,i[1]=="k"?"":e)+"}":typeof a=="object"?s+=hr(a,e?e.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,c):c?c+" "+m:m)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=hr.p?hr.p(i,a):i+":"+a+";")}return n+(e&&r?e+"{"+r+"}":r)+s},Ws={},Vp=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Vp(t[n]);return e}return t},oN=(t,e,n,s,r)=>{let i=Vp(t),a=Ws[i]||(Ws[i]=(m=>{let u=0,d=11;for(;u<m.length;)d=101*d+m.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Ws[a]){let m=i!==t?t:(u=>{let d,h,p=[{}];for(;d=rN.exec(u.replace(iN,""));)d[4]?p.shift():d[3]?(h=d[3].replace(nd," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][d[1]]=d[2].replace(nd," ").trim();return p[0]})(t);Ws[a]=hr(r?{["@keyframes "+a]:m}:m,n?"":"."+a)}let c=n&&Ws.g?Ws.g:null;return n&&(Ws.g=Ws[a]),((m,u,d,h)=>{h?u.data=u.data.replace(h,m):u.data.indexOf(m)===-1&&(u.data=d?m+u.data:u.data+m)})(Ws[a],e,s,c),a},aN=(t,e,n)=>t.reduce((s,r,i)=>{let a=e[i];if(a&&a.call){let c=a(n),m=c&&c.props&&c.props.className||/^go/.test(c)&&c;a=m?"."+m:c&&typeof c=="object"?c.props?"":hr(c,""):c===!1?"":c}return s+r+(a??"")},"");function kl(t){let e=this||{},n=t.call?t(e.p):t;return oN(n.unshift?n.raw?aN(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,sN(e.target),e.g,e.o,e.k)}let Cp,Rc,Bc;kl.bind({g:1});let Xs=kl.bind({k:1});function lN(t,e,n,s){hr.p=e,Cp=t,Rc=n,Bc=s}function Lr(t,e){let n=this||{};return function(){let s=arguments;function r(i,a){let c=Object.assign({},i),m=c.className||r.className;n.p=Object.assign({theme:Rc&&Rc()},c),n.o=/ *go\d+/.test(m),c.className=kl.apply(n,s)+(m?" "+m:"");let u=t;return t[0]&&(u=c.as||t,delete c.as),Bc&&u[0]&&Bc(c),Cp(u,c)}return r}}var cN=t=>typeof t=="function",nl=(t,e)=>cN(t)?t(e):t,mN=(()=>{let t=0;return()=>(++t).toString()})(),wp=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),uN=20,Em="default",Sp=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:s}=e;return Sp(t,{type:t.toasts.find(a=>a.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},$a=[],Ip={toasts:[],pausedAt:void 0,settings:{toastLimit:uN}},Rs={},Pp=(t,e=Em)=>{Rs[e]=Sp(Rs[e]||Ip,t),$a.forEach(([n,s])=>{n===e&&s(Rs[e])})},Lp=t=>Object.keys(Rs).forEach(e=>Pp(t,e)),dN=t=>Object.keys(Rs).find(e=>Rs[e].toasts.some(n=>n.id===t)),Al=(t=Em)=>e=>{Pp(e,t)},fN={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},pN=(t={},e=Em)=>{let[n,s]=k.useState(Rs[e]||Ip),r=k.useRef(Rs[e]);k.useEffect(()=>(r.current!==Rs[e]&&s(Rs[e]),$a.push([e,s]),()=>{let a=$a.findIndex(([c])=>c===e);a>-1&&$a.splice(a,1)}),[e]);let i=n.toasts.map(a=>{var c,m,u;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((c=t[a.type])==null?void 0:c.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((m=t[a.type])==null?void 0:m.duration)||(t==null?void 0:t.duration)||fN[a.type],style:{...t.style,...(u=t[a.type])==null?void 0:u.style,...a.style}}});return{...n,toasts:i}},hN=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||mN()}),sa=t=>(e,n)=>{let s=hN(e,t,n);return Al(s.toasterId||dN(s.id))({type:2,toast:s}),s.id},Cn=(t,e)=>sa("blank")(t,e);Cn.error=sa("error");Cn.success=sa("success");Cn.loading=sa("loading");Cn.custom=sa("custom");Cn.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Al(e)(n):Lp(n)};Cn.dismissAll=t=>Cn.dismiss(void 0,t);Cn.remove=(t,e)=>{let n={type:4,toastId:t};e?Al(e)(n):Lp(n)};Cn.removeAll=t=>Cn.remove(void 0,t);Cn.promise=(t,e,n)=>{let s=Cn.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let i=e.success?nl(e.success,r):void 0;return i?Cn.success(i,{id:s,...n,...n==null?void 0:n.success}):Cn.dismiss(s),r}).catch(r=>{let i=e.error?nl(e.error,r):void 0;i?Cn.error(i,{id:s,...n,...n==null?void 0:n.error}):Cn.dismiss(s)}),t};var gN=1e3,yN=(t,e="default")=>{let{toasts:n,pausedAt:s}=pN(t,e),r=k.useRef(new Map).current,i=k.useCallback((h,p=gN)=>{if(r.has(h))return;let b=setTimeout(()=>{r.delete(h),a({type:4,toastId:h})},p);r.set(h,b)},[]);k.useEffect(()=>{if(s)return;let h=Date.now(),p=n.map(b=>{if(b.duration===1/0)return;let C=(b.duration||0)+b.pauseDuration-(h-b.createdAt);if(C<0){b.visible&&Cn.dismiss(b.id);return}return setTimeout(()=>Cn.dismiss(b.id,e),C)});return()=>{p.forEach(b=>b&&clearTimeout(b))}},[n,s,e]);let a=k.useCallback(Al(e),[e]),c=k.useCallback(()=>{a({type:5,time:Date.now()})},[a]),m=k.useCallback((h,p)=>{a({type:1,toast:{id:h,height:p}})},[a]),u=k.useCallback(()=>{s&&a({type:6,time:Date.now()})},[s,a]),d=k.useCallback((h,p)=>{let{reverseOrder:b=!1,gutter:C=8,defaultPosition:v}=p||{},S=n.filter(W=>(W.position||v)===(h.position||v)&&W.height),B=S.findIndex(W=>W.id===h.id),L=S.filter((W,ie)=>ie<B&&W.visible).length;return S.filter(W=>W.visible).slice(...b?[L+1]:[0,L]).reduce((W,ie)=>W+(ie.height||0)+C,0)},[n]);return k.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=r.get(h.id);p&&(clearTimeout(p),r.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:m,startPause:c,endPause:u,calculateOffset:d}}},bN=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,NN=Xs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xN=Xs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,vN=Lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${bN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${NN} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${xN} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_N=Xs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,DN=Lr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${_N} 1s linear infinite;
`,kN=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,AN=Xs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,EN=Lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${kN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${AN} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,VN=Lr("div")`
  position: absolute;
`,CN=Lr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wN=Xs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,SN=Lr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wN} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,IN=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?k.createElement(SN,null,e):e:n==="blank"?null:k.createElement(CN,null,k.createElement(DN,{...s}),n!=="loading"&&k.createElement(VN,null,n==="error"?k.createElement(vN,{...s}):k.createElement(EN,{...s})))},PN=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,LN=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,TN="0%{opacity:0;} 100%{opacity:1;}",jN="0%{opacity:1;} 100%{opacity:0;}",RN=Lr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,BN=Lr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,UN=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=wp()?[TN,jN]:[PN(n),LN(n)];return{animation:e?`${Xs(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Xs(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},HN=k.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?UN(t.position||e||"top-center",t.visible):{opacity:0},i=k.createElement(IN,{toast:t}),a=k.createElement(BN,{...t.ariaProps},nl(t.message,t));return k.createElement(RN,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:i,message:a}):k.createElement(k.Fragment,null,i,a))});lN(k.createElement);var MN=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let i=k.useCallback(a=>{if(a){let c=()=>{let m=a.getBoundingClientRect().height;s(t,m)};c(),new MutationObserver(c).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return k.createElement("div",{ref:i,className:e,style:n},r)},FN=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:wp()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},ON=kl`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Da=16,qN=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,toasterId:i,containerStyle:a,containerClassName:c})=>{let{toasts:m,handlers:u}=yN(n,i);return k.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Da,left:Da,right:Da,bottom:Da,pointerEvents:"none",...a},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},m.map(d=>{let h=d.position||e,p=u.calculateOffset(d,{reverseOrder:t,gutter:s,defaultPosition:e}),b=FN(h,p);return k.createElement(MN,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?ON:"",style:b},d.type==="custom"?nl(d.message,d):r?r(d):k.createElement(HN,{toast:d,position:h}))}))},te=Cn;function $N(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:a}=t;let c,m,u;const d=async(p=!0)=>{await m,await(u==null?void 0:u())};async function h(){if("serviceWorker"in navigator){if(c=await $s(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{a==null||a(p)}),!c)return;u=async()=>{await(c==null?void 0:c.messageSkipWaiting())};{let p=!1;const b=()=>{p=!0,c==null||c.addEventListener("controlling",C=>{C.isUpdate&&window.location.reload()}),n==null||n()};c.addEventListener("installed",C=>{typeof C.isUpdate>"u"?typeof C.isExternal<"u"?C.isExternal?b():!p&&(s==null||s()):C.isExternal?window.location.reload():!p&&(s==null||s()):C.isUpdate||s==null||s()}),c.addEventListener("waiting",b),c.addEventListener("externalwaiting",b)}c.register({immediate:e}).then(p=>{i?i("/sw.js",p):r==null||r(p)}).catch(p=>{a==null||a(p)})}}return m=h(),d}const WN=()=>{if(typeof window<"u"){const t=window.location.hostname;if(t==="hvlab.app"||t.includes("hv-lab-app")||t.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},zN=WN(),Oo=_b.create({baseURL:zN,headers:{"Content-Type":"application/json"}});Oo.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));Oo.interceptors.response.use(t=>t,t=>{var e,n,s;return((e=t.response)==null?void 0:e.status)===401&&!((s=(n=t.config)==null?void 0:n.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)});const KN=()=>{};var sd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},QN=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],a=t[n++],c=t[n++],m=((r&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const i=t[n++],a=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},jp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],a=r+1<t.length,c=a?t[r+1]:0,m=r+2<t.length,u=m?t[r+2]:0,d=i>>2,h=(i&3)<<4|c>>4;let p=(c&15)<<2|u>>6,b=u&63;m||(b=64,a||(p=64)),s.push(n[d],n[h],n[p],n[b])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Tp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):QN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],c=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||c==null||u==null||h==null)throw new YN;const p=i<<2|c>>4;if(s.push(p),u!==64){const b=c<<4&240|u>>2;if(s.push(b),h!==64){const C=u<<6&192|h;s.push(C)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GN=function(t){const e=Tp(t);return jp.encodeByteArray(e,!0)},sl=function(t){return GN(t).replace(/\./g,"")},XN=function(t){try{return jp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=()=>JN().__FIREBASE_DEFAULTS__,e0=()=>{if(typeof process>"u"||typeof sd>"u")return;const t=sd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},t0=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XN(t[1]);return e&&JSON.parse(e)},Vm=()=>{try{return KN()||ZN()||e0()||t0()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n0=t=>{var e,n;return(n=(e=Vm())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Rp=t=>{const e=n0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Bp=()=>{var t;return(t=Vm())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Up(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sl(JSON.stringify(n)),sl(JSON.stringify(a)),""].join(".")}const Po={};function r0(){const t={prod:[],emulator:[]};for(const e of Object.keys(Po))Po[e]?t.emulator.push(e):t.prod.push(e);return t}function i0(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let rd=!1;function Mp(t,e){if(typeof window>"u"||typeof document>"u"||!ra(window.location.host)||Po[t]===e||Po[t]||rd)return;Po[t]=e;function n(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=r0().prod.length>0;function a(){const p=document.getElementById(s);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function m(p,b){p.setAttribute("width","24"),p.setAttribute("id",b),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{rd=!0,a()},p}function d(p,b){p.setAttribute("id",b),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function h(){const p=i0(s),b=n("text"),C=document.getElementById(b)||document.createElement("span"),v=n("learnmore"),S=document.getElementById(v)||document.createElement("a"),B=n("preprendIcon"),L=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const W=p.element;c(W),d(S,v);const ie=u();m(L,B),W.append(L,C,S,ie),document.body.appendChild(W)}i?(C.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a0(){var e;const t=(e=Vm())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l0(){return!a0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function c0(){try{return typeof indexedDB=="object"}catch{return!1}}function m0(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="FirebaseError";class ai extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=u0,Object.setPrototypeOf(this,ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fp.prototype.create)}}class Fp{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?d0(i,s):"Error",c=`${this.serviceName}: ${a} (${r}).`;return new ai(r,c,s)}}function d0(t,e){return t.replace(f0,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const f0=/\{\$([^}]+)}/g;function rl(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],a=e[r];if(id(i)&&id(a)){if(!rl(i,a))return!1}else if(i!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function id(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t){return t&&t._delegate?t._delegate:t}class Fi{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new s0;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(g0(e))try{this.getOrInitializeService({instanceIdentifier:Gr})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Gr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gr){return this.instances.has(e)}getOptions(e=Gr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);s===c&&a.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:h0(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Gr){return this.component?this.component.multipleInstances?e:Gr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h0(t){return t===Gr?void 0:t}function g0(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new p0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Et||(Et={}));const b0={debug:Et.DEBUG,verbose:Et.VERBOSE,info:Et.INFO,warn:Et.WARN,error:Et.ERROR,silent:Et.SILENT},N0=Et.INFO,x0={[Et.DEBUG]:"log",[Et.VERBOSE]:"log",[Et.INFO]:"info",[Et.WARN]:"warn",[Et.ERROR]:"error"},v0=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=x0[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Op{constructor(e){this.name=e,this._logLevel=N0,this._logHandler=v0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Et.DEBUG,...e),this._logHandler(this,Et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Et.VERBOSE,...e),this._logHandler(this,Et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Et.INFO,...e),this._logHandler(this,Et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Et.WARN,...e),this._logHandler(this,Et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Et.ERROR,...e),this._logHandler(this,Et.ERROR,...e)}}const _0=(t,e)=>e.some(n=>t instanceof n);let od,ad;function D0(){return od||(od=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k0(){return ad||(ad=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qp=new WeakMap,Uc=new WeakMap,$p=new WeakMap,fc=new WeakMap,Cm=new WeakMap;function A0(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Nr(t.result)),r()},a=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&qp.set(n,t)}).catch(()=>{}),Cm.set(e,t),e}function E0(t){if(Uc.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),r()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Uc.set(t,e)}let Hc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$p.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function V0(t){Hc=t(Hc)}function C0(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(pc(this),e,...n);return $p.set(s,e.sort?e.sort():[e]),Nr(s)}:k0().includes(t)?function(...e){return t.apply(pc(this),e),Nr(qp.get(this))}:function(...e){return Nr(t.apply(pc(this),e))}}function w0(t){return typeof t=="function"?C0(t):(t instanceof IDBTransaction&&E0(t),_0(t,D0())?new Proxy(t,Hc):t)}function Nr(t){if(t instanceof IDBRequest)return A0(t);if(fc.has(t))return fc.get(t);const e=w0(t);return e!==t&&(fc.set(t,e),Cm.set(e,t)),e}const pc=t=>Cm.get(t);function S0(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(t,e),c=Nr(a);return s&&a.addEventListener("upgradeneeded",m=>{s(Nr(a.result),m.oldVersion,m.newVersion,Nr(a.transaction),m)}),n&&a.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),c.then(m=>{i&&m.addEventListener("close",()=>i()),r&&m.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}const I0=["get","getKey","getAll","getAllKeys","count"],P0=["put","add","delete","clear"],hc=new Map;function ld(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hc.get(e))return hc.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=P0.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||I0.includes(n)))return;const i=async function(a,...c){const m=this.transaction(a,r?"readwrite":"readonly");let u=m.store;return s&&(u=u.index(c.shift())),(await Promise.all([u[n](...c),r&&m.done]))[0]};return hc.set(e,i),i}V0(t=>({...t,get:(e,n,s)=>ld(e,n)||t.get(e,n,s),has:(e,n)=>!!ld(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(T0(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function T0(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mc="@firebase/app",cd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new Op("@firebase/app"),j0="@firebase/app-compat",R0="@firebase/analytics-compat",B0="@firebase/analytics",U0="@firebase/app-check-compat",H0="@firebase/app-check",M0="@firebase/auth",F0="@firebase/auth-compat",O0="@firebase/database",q0="@firebase/data-connect",$0="@firebase/database-compat",W0="@firebase/functions",z0="@firebase/functions-compat",K0="@firebase/installations",Q0="@firebase/installations-compat",Y0="@firebase/messaging",G0="@firebase/messaging-compat",X0="@firebase/performance",J0="@firebase/performance-compat",Z0="@firebase/remote-config",ex="@firebase/remote-config-compat",tx="@firebase/storage",nx="@firebase/storage-compat",sx="@firebase/firestore",rx="@firebase/ai",ix="@firebase/firestore-compat",ox="firebase",ax="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc="[DEFAULT]",lx={[Mc]:"fire-core",[j0]:"fire-core-compat",[B0]:"fire-analytics",[R0]:"fire-analytics-compat",[H0]:"fire-app-check",[U0]:"fire-app-check-compat",[M0]:"fire-auth",[F0]:"fire-auth-compat",[O0]:"fire-rtdb",[q0]:"fire-data-connect",[$0]:"fire-rtdb-compat",[W0]:"fire-fn",[z0]:"fire-fn-compat",[K0]:"fire-iid",[Q0]:"fire-iid-compat",[Y0]:"fire-fcm",[G0]:"fire-fcm-compat",[X0]:"fire-perf",[J0]:"fire-perf-compat",[Z0]:"fire-rc",[ex]:"fire-rc-compat",[tx]:"fire-gcs",[nx]:"fire-gcs-compat",[sx]:"fire-fst",[ix]:"fire-fst-compat",[rx]:"fire-vertex","fire-js":"fire-js",[ox]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new Map,cx=new Map,Oc=new Map;function md(t,e){try{t.container.addComponent(e)}catch(n){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $o(t){const e=t.name;if(Oc.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;Oc.set(e,t);for(const n of qo.values())md(n,t);for(const n of cx.values())md(n,t);return!0}function Wp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zp(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new Fp("app","Firebase",mx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp=ax;function Qp(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Fc,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw xr.create("bad-app-name",{appName:String(r)});if(n||(n=Bp()),!n)throw xr.create("no-options");const i=qo.get(r);if(i){if(rl(n,i.options)&&rl(s,i.config))return i;throw xr.create("duplicate-app",{appName:r})}const a=new y0(r);for(const m of Oc.values())a.addComponent(m);const c=new ux(n,s,a);return qo.set(r,c),c}function Yp(t=Fc){const e=qo.get(t);if(!e&&t===Fc&&Bp())return Qp();if(!e)throw xr.create("no-app",{appName:t});return e}function ud(){return Array.from(qo.values())}function vr(t,e,n){let s=lx[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(a.join(" "));return}$o(new Fi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="firebase-heartbeat-database",fx=1,Wo="firebase-heartbeat-store";let gc=null;function Gp(){return gc||(gc=S0(dx,fx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(n){console.warn(n)}}}}).catch(t=>{throw xr.create("idb-open",{originalErrorMessage:t.message})})),gc}async function px(t){try{const n=(await Gp()).transaction(Wo),s=await n.objectStore(Wo).get(Xp(t));return await n.done,s}catch(e){if(e instanceof ai)Js.warn(e.message);else{const n=xr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Js.warn(n.message)}}}async function dd(t,e){try{const s=(await Gp()).transaction(Wo,"readwrite");await s.objectStore(Wo).put(e,Xp(t)),await s.done}catch(n){if(n instanceof ai)Js.warn(n.message);else{const s=xr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Js.warn(s.message)}}}function Xp(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=1024,gx=30;class yx{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Nx(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>gx){const a=xx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fd(),{heartbeatsToSend:s,unsentEntries:r}=bx(this._heartbeatsCache.heartbeats),i=sl(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Js.warn(n),""}}}function fd(){return new Date().toISOString().substring(0,10)}function bx(t,e=hx){const n=[];let s=t.slice();for(const r of t){const i=n.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),pd(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),pd(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Nx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c0()?m0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await px(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function pd(t){return sl(JSON.stringify({version:2,heartbeats:t})).length}function xx(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t){$o(new Fi("platform-logger",e=>new L0(e),"PRIVATE")),$o(new Fi("heartbeat",e=>new yx(e),"PRIVATE")),vr(Mc,cd,t),vr(Mc,cd,"esm2020"),vr("fire-js","")}vx("");var _x="firebase",Dx="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vr(_x,Dx,"app");var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _r,Jp;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,x){function E(){}E.prototype=x.prototype,A.F=x.prototype,A.prototype=new E,A.prototype.constructor=A,A.D=function(j,I,P){for(var D=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)D[Ae-2]=arguments[Ae];return x.prototype[I].apply(j,D)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,x,E){E||(E=0);const j=Array(16);if(typeof x=="string")for(var I=0;I<16;++I)j[I]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(I=0;I<16;++I)j[I]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=A.g[0],E=A.g[1],I=A.g[2];let P=A.g[3],D;D=x+(P^E&(I^P))+j[0]+3614090360&4294967295,x=E+(D<<7&4294967295|D>>>25),D=P+(I^x&(E^I))+j[1]+3905402710&4294967295,P=x+(D<<12&4294967295|D>>>20),D=I+(E^P&(x^E))+j[2]+606105819&4294967295,I=P+(D<<17&4294967295|D>>>15),D=E+(x^I&(P^x))+j[3]+3250441966&4294967295,E=I+(D<<22&4294967295|D>>>10),D=x+(P^E&(I^P))+j[4]+4118548399&4294967295,x=E+(D<<7&4294967295|D>>>25),D=P+(I^x&(E^I))+j[5]+1200080426&4294967295,P=x+(D<<12&4294967295|D>>>20),D=I+(E^P&(x^E))+j[6]+2821735955&4294967295,I=P+(D<<17&4294967295|D>>>15),D=E+(x^I&(P^x))+j[7]+4249261313&4294967295,E=I+(D<<22&4294967295|D>>>10),D=x+(P^E&(I^P))+j[8]+1770035416&4294967295,x=E+(D<<7&4294967295|D>>>25),D=P+(I^x&(E^I))+j[9]+2336552879&4294967295,P=x+(D<<12&4294967295|D>>>20),D=I+(E^P&(x^E))+j[10]+4294925233&4294967295,I=P+(D<<17&4294967295|D>>>15),D=E+(x^I&(P^x))+j[11]+2304563134&4294967295,E=I+(D<<22&4294967295|D>>>10),D=x+(P^E&(I^P))+j[12]+1804603682&4294967295,x=E+(D<<7&4294967295|D>>>25),D=P+(I^x&(E^I))+j[13]+4254626195&4294967295,P=x+(D<<12&4294967295|D>>>20),D=I+(E^P&(x^E))+j[14]+2792965006&4294967295,I=P+(D<<17&4294967295|D>>>15),D=E+(x^I&(P^x))+j[15]+1236535329&4294967295,E=I+(D<<22&4294967295|D>>>10),D=x+(I^P&(E^I))+j[1]+4129170786&4294967295,x=E+(D<<5&4294967295|D>>>27),D=P+(E^I&(x^E))+j[6]+3225465664&4294967295,P=x+(D<<9&4294967295|D>>>23),D=I+(x^E&(P^x))+j[11]+643717713&4294967295,I=P+(D<<14&4294967295|D>>>18),D=E+(P^x&(I^P))+j[0]+3921069994&4294967295,E=I+(D<<20&4294967295|D>>>12),D=x+(I^P&(E^I))+j[5]+3593408605&4294967295,x=E+(D<<5&4294967295|D>>>27),D=P+(E^I&(x^E))+j[10]+38016083&4294967295,P=x+(D<<9&4294967295|D>>>23),D=I+(x^E&(P^x))+j[15]+3634488961&4294967295,I=P+(D<<14&4294967295|D>>>18),D=E+(P^x&(I^P))+j[4]+3889429448&4294967295,E=I+(D<<20&4294967295|D>>>12),D=x+(I^P&(E^I))+j[9]+568446438&4294967295,x=E+(D<<5&4294967295|D>>>27),D=P+(E^I&(x^E))+j[14]+3275163606&4294967295,P=x+(D<<9&4294967295|D>>>23),D=I+(x^E&(P^x))+j[3]+4107603335&4294967295,I=P+(D<<14&4294967295|D>>>18),D=E+(P^x&(I^P))+j[8]+1163531501&4294967295,E=I+(D<<20&4294967295|D>>>12),D=x+(I^P&(E^I))+j[13]+2850285829&4294967295,x=E+(D<<5&4294967295|D>>>27),D=P+(E^I&(x^E))+j[2]+4243563512&4294967295,P=x+(D<<9&4294967295|D>>>23),D=I+(x^E&(P^x))+j[7]+1735328473&4294967295,I=P+(D<<14&4294967295|D>>>18),D=E+(P^x&(I^P))+j[12]+2368359562&4294967295,E=I+(D<<20&4294967295|D>>>12),D=x+(E^I^P)+j[5]+4294588738&4294967295,x=E+(D<<4&4294967295|D>>>28),D=P+(x^E^I)+j[8]+2272392833&4294967295,P=x+(D<<11&4294967295|D>>>21),D=I+(P^x^E)+j[11]+1839030562&4294967295,I=P+(D<<16&4294967295|D>>>16),D=E+(I^P^x)+j[14]+4259657740&4294967295,E=I+(D<<23&4294967295|D>>>9),D=x+(E^I^P)+j[1]+2763975236&4294967295,x=E+(D<<4&4294967295|D>>>28),D=P+(x^E^I)+j[4]+1272893353&4294967295,P=x+(D<<11&4294967295|D>>>21),D=I+(P^x^E)+j[7]+4139469664&4294967295,I=P+(D<<16&4294967295|D>>>16),D=E+(I^P^x)+j[10]+3200236656&4294967295,E=I+(D<<23&4294967295|D>>>9),D=x+(E^I^P)+j[13]+681279174&4294967295,x=E+(D<<4&4294967295|D>>>28),D=P+(x^E^I)+j[0]+3936430074&4294967295,P=x+(D<<11&4294967295|D>>>21),D=I+(P^x^E)+j[3]+3572445317&4294967295,I=P+(D<<16&4294967295|D>>>16),D=E+(I^P^x)+j[6]+76029189&4294967295,E=I+(D<<23&4294967295|D>>>9),D=x+(E^I^P)+j[9]+3654602809&4294967295,x=E+(D<<4&4294967295|D>>>28),D=P+(x^E^I)+j[12]+3873151461&4294967295,P=x+(D<<11&4294967295|D>>>21),D=I+(P^x^E)+j[15]+530742520&4294967295,I=P+(D<<16&4294967295|D>>>16),D=E+(I^P^x)+j[2]+3299628645&4294967295,E=I+(D<<23&4294967295|D>>>9),D=x+(I^(E|~P))+j[0]+4096336452&4294967295,x=E+(D<<6&4294967295|D>>>26),D=P+(E^(x|~I))+j[7]+1126891415&4294967295,P=x+(D<<10&4294967295|D>>>22),D=I+(x^(P|~E))+j[14]+2878612391&4294967295,I=P+(D<<15&4294967295|D>>>17),D=E+(P^(I|~x))+j[5]+4237533241&4294967295,E=I+(D<<21&4294967295|D>>>11),D=x+(I^(E|~P))+j[12]+1700485571&4294967295,x=E+(D<<6&4294967295|D>>>26),D=P+(E^(x|~I))+j[3]+2399980690&4294967295,P=x+(D<<10&4294967295|D>>>22),D=I+(x^(P|~E))+j[10]+4293915773&4294967295,I=P+(D<<15&4294967295|D>>>17),D=E+(P^(I|~x))+j[1]+2240044497&4294967295,E=I+(D<<21&4294967295|D>>>11),D=x+(I^(E|~P))+j[8]+1873313359&4294967295,x=E+(D<<6&4294967295|D>>>26),D=P+(E^(x|~I))+j[15]+4264355552&4294967295,P=x+(D<<10&4294967295|D>>>22),D=I+(x^(P|~E))+j[6]+2734768916&4294967295,I=P+(D<<15&4294967295|D>>>17),D=E+(P^(I|~x))+j[13]+1309151649&4294967295,E=I+(D<<21&4294967295|D>>>11),D=x+(I^(E|~P))+j[4]+4149444226&4294967295,x=E+(D<<6&4294967295|D>>>26),D=P+(E^(x|~I))+j[11]+3174756917&4294967295,P=x+(D<<10&4294967295|D>>>22),D=I+(x^(P|~E))+j[2]+718787259&4294967295,I=P+(D<<15&4294967295|D>>>17),D=E+(P^(I|~x))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+x&4294967295,A.g[1]=A.g[1]+(I+(D<<21&4294967295|D>>>11))&4294967295,A.g[2]=A.g[2]+I&4294967295,A.g[3]=A.g[3]+P&4294967295}s.prototype.v=function(A,x){x===void 0&&(x=A.length);const E=x-this.blockSize,j=this.C;let I=this.h,P=0;for(;P<x;){if(I==0)for(;P<=E;)r(this,A,P),P+=this.blockSize;if(typeof A=="string"){for(;P<x;)if(j[I++]=A.charCodeAt(P++),I==this.blockSize){r(this,j),I=0;break}}else for(;P<x;)if(j[I++]=A[P++],I==this.blockSize){r(this,j),I=0;break}}this.h=I,this.o+=x},s.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var x=1;x<A.length-8;++x)A[x]=0;x=this.o*8;for(var E=A.length-8;E<A.length;++E)A[E]=x&255,x/=256;for(this.v(A),A=Array(16),x=0,E=0;E<4;++E)for(let j=0;j<32;j+=8)A[x++]=this.g[E]>>>j&255;return A};function i(A,x){var E=c;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=x(A)}function a(A,x){this.h=x;const E=[];let j=!0;for(let I=A.length-1;I>=0;I--){const P=A[I]|0;j&&P==x||(E[I]=P,j=!1)}this.g=E}var c={};function m(A){return-128<=A&&A<128?i(A,function(x){return new a([x|0],x<0?-1:0)}):new a([A|0],A<0?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return h;if(A<0)return S(u(-A));const x=[];let E=1;for(let j=0;A>=E;j++)x[j]=A/E|0,E*=4294967296;return new a(x,0)}function d(A,x){if(A.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(A.charAt(0)=="-")return S(d(A.substring(1),x));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=u(Math.pow(x,8));let j=h;for(let P=0;P<A.length;P+=8){var I=Math.min(8,A.length-P);const D=parseInt(A.substring(P,P+I),x);I<8?(I=u(Math.pow(x,I)),j=j.j(I).add(u(D))):(j=j.j(E),j=j.add(u(D)))}return j}var h=m(0),p=m(1),b=m(16777216);t=a.prototype,t.m=function(){if(v(this))return-S(this).m();let A=0,x=1;for(let E=0;E<this.g.length;E++){const j=this.i(E);A+=(j>=0?j:4294967296+j)*x,x*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(C(this))return"0";if(v(this))return"-"+S(this).toString(A);const x=u(Math.pow(A,6));var E=this;let j="";for(;;){const I=ie(E,x).g;E=B(E,I.j(x));let P=((E.g.length>0?E.g[0]:E.h)>>>0).toString(A);if(E=I,C(E))return P+j;for(;P.length<6;)P="0"+P;j=P+j}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function C(A){if(A.h!=0)return!1;for(let x=0;x<A.g.length;x++)if(A.g[x]!=0)return!1;return!0}function v(A){return A.h==-1}t.l=function(A){return A=B(this,A),v(A)?-1:C(A)?0:1};function S(A){const x=A.g.length,E=[];for(let j=0;j<x;j++)E[j]=~A.g[j];return new a(E,~A.h).add(p)}t.abs=function(){return v(this)?S(this):this},t.add=function(A){const x=Math.max(this.g.length,A.g.length),E=[];let j=0;for(let I=0;I<=x;I++){let P=j+(this.i(I)&65535)+(A.i(I)&65535),D=(P>>>16)+(this.i(I)>>>16)+(A.i(I)>>>16);j=D>>>16,P&=65535,D&=65535,E[I]=D<<16|P}return new a(E,E[E.length-1]&-2147483648?-1:0)};function B(A,x){return A.add(S(x))}t.j=function(A){if(C(this)||C(A))return h;if(v(this))return v(A)?S(this).j(S(A)):S(S(this).j(A));if(v(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return u(this.m()*A.m());const x=this.g.length+A.g.length,E=[];for(var j=0;j<2*x;j++)E[j]=0;for(j=0;j<this.g.length;j++)for(let I=0;I<A.g.length;I++){const P=this.i(j)>>>16,D=this.i(j)&65535,Ae=A.i(I)>>>16,Ue=A.i(I)&65535;E[2*j+2*I]+=D*Ue,L(E,2*j+2*I),E[2*j+2*I+1]+=P*Ue,L(E,2*j+2*I+1),E[2*j+2*I+1]+=D*Ae,L(E,2*j+2*I+1),E[2*j+2*I+2]+=P*Ae,L(E,2*j+2*I+2)}for(A=0;A<x;A++)E[A]=E[2*A+1]<<16|E[2*A];for(A=x;A<2*x;A++)E[A]=0;return new a(E,0)};function L(A,x){for(;(A[x]&65535)!=A[x];)A[x+1]+=A[x]>>>16,A[x]&=65535,x++}function W(A,x){this.g=A,this.h=x}function ie(A,x){if(C(x))throw Error("division by zero");if(C(A))return new W(h,h);if(v(A))return x=ie(S(A),x),new W(S(x.g),S(x.h));if(v(x))return x=ie(A,S(x)),new W(S(x.g),x.h);if(A.g.length>30){if(v(A)||v(x))throw Error("slowDivide_ only works with positive integers.");for(var E=p,j=x;j.l(A)<=0;)E=ee(E),j=ee(j);var I=F(E,1),P=F(j,1);for(j=F(j,2),E=F(E,2);!C(j);){var D=P.add(j);D.l(A)<=0&&(I=I.add(E),P=D),j=F(j,1),E=F(E,1)}return x=B(A,I.j(x)),new W(I,x)}for(I=h;A.l(x)>=0;){for(E=Math.max(1,Math.floor(A.m()/x.m())),j=Math.ceil(Math.log(E)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),P=u(E),D=P.j(x);v(D)||D.l(A)>0;)E-=j,P=u(E),D=P.j(x);C(P)&&(P=p),I=I.add(P),A=B(A,D)}return new W(I,A)}t.B=function(A){return ie(this,A).h},t.and=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)&A.i(j);return new a(E,this.h&A.h)},t.or=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)|A.i(j);return new a(E,this.h|A.h)},t.xor=function(A){const x=Math.max(this.g.length,A.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)^A.i(j);return new a(E,this.h^A.h)};function ee(A){const x=A.g.length+1,E=[];for(let j=0;j<x;j++)E[j]=A.i(j)<<1|A.i(j-1)>>>31;return new a(E,A.h)}function F(A,x){const E=x>>5;x%=32;const j=A.g.length-E,I=[];for(let P=0;P<j;P++)I[P]=x>0?A.i(P+E)>>>x|A.i(P+E+1)<<32-x:A.i(P+E);return new a(I,A.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,Jp=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=d,_r=a}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zp,Vo,eh,Wa,qc,th,nh,sh;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ka=="object"&&ka];for(var f=0;f<l.length;++f){var y=l[f];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var s=n(this);function r(l,f){if(f)e:{var y=s;l=l.split(".");for(var _=0;_<l.length-1;_++){var z=l[_];if(!(z in y))break e;y=y[z]}l=l[l.length-1],_=y[l],f=f(_),f!=_&&f!=null&&e(y,l,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(l){return l||function(f){var y=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&y.push([_,f[_]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function c(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function m(l,f,y){return l.call.apply(l.bind,arguments)}function u(l,f,y){return u=m,u.apply(null,arguments)}function d(l,f){var y=Array.prototype.slice.call(arguments,1);return function(){var _=y.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function h(l,f){function y(){}y.prototype=f.prototype,l.Z=f.prototype,l.prototype=new y,l.prototype.constructor=l,l.Ob=function(_,z,J){for(var _e=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)_e[ut-2]=arguments[ut];return f.prototype[z].apply(_,_e)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function b(l){const f=l.length;if(f>0){const y=Array(f);for(let _=0;_<f;_++)y[_]=l[_];return y}return[]}function C(l,f){for(let _=1;_<arguments.length;_++){const z=arguments[_];var y=typeof z;if(y=y!="object"?y:z?Array.isArray(z)?"array":y:"null",y=="array"||y=="object"&&typeof z.length=="number"){y=l.length||0;const J=z.length||0;l.length=y+J;for(let _e=0;_e<J;_e++)l[y+_e]=z[_e]}else l.push(z)}}class v{constructor(f,y){this.i=f,this.j=y,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function S(l){a.setTimeout(()=>{throw l},0)}function B(){var l=A;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class L{constructor(){this.h=this.g=null}add(f,y){const _=W.get();_.set(f,y),this.h?this.h.next=_:this.g=_,this.h=_}}var W=new v(()=>new ie,l=>l.reset());class ie{constructor(){this.next=this.g=this.h=null}set(f,y){this.h=f,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,F=!1,A=new L,x=()=>{const l=Promise.resolve(void 0);ee=()=>{l.then(E)}};function E(){for(var l;l=B();){try{l.h.call(l.g)}catch(y){S(y)}var f=W;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}F=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const y=()=>{};a.addEventListener("test",y,f),a.removeEventListener("test",y,f)}catch{}return l}();function D(l){return/^[\s\xa0]*$/.test(l)}function Ae(l,f){I.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}h(Ae,I),Ae.prototype.init=function(l,f){const y=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(y=="mouseover"?f=l.fromElement:y=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Ae.Z.h.call(this)},Ae.prototype.h=function(){Ae.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Ue="closure_listenable_"+(Math.random()*1e6|0),ge=0;function Se(l,f,y,_,z){this.listener=l,this.proxy=null,this.src=f,this.type=y,this.capture=!!_,this.ha=z,this.key=++ge,this.da=this.fa=!1}function tt(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ut(l,f,y){for(const _ in l)f.call(y,l[_],_,l)}function Ht(l,f){for(const y in l)f.call(void 0,l[y],y,l)}function ae(l){const f={};for(const y in l)f[y]=l[y];return f}const Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(l,f){let y,_;for(let z=1;z<arguments.length;z++){_=arguments[z];for(y in _)l[y]=_[y];for(let J=0;J<Me.length;J++)y=Me[J],Object.prototype.hasOwnProperty.call(_,y)&&(l[y]=_[y])}}function Ie(l){this.src=l,this.g={},this.h=0}Ie.prototype.add=function(l,f,y,_,z){const J=l.toString();l=this.g[J],l||(l=this.g[J]=[],this.h++);const _e=bt(l,f,_,z);return _e>-1?(f=l[_e],y||(f.fa=!1)):(f=new Se(f,this.src,J,!!_,z),f.fa=y,l.push(f)),f};function ze(l,f){const y=f.type;if(y in l.g){var _=l.g[y],z=Array.prototype.indexOf.call(_,f,void 0),J;(J=z>=0)&&Array.prototype.splice.call(_,z,1),J&&(tt(f),l.g[y].length==0&&(delete l.g[y],l.h--))}}function bt(l,f,y,_){for(let z=0;z<l.length;++z){const J=l[z];if(!J.da&&J.listener==f&&J.capture==!!y&&J.ha==_)return z}return-1}var nt="closure_lm_"+(Math.random()*1e6|0),Ct={};function ot(l,f,y,_,z){if(Array.isArray(f)){for(let J=0;J<f.length;J++)ot(l,f[J],y,_,z);return null}return y=Ot(y),l&&l[Ue]?l.J(f,y,c(_)?!!_.capture:!1,z):Nt(l,f,y,!1,_,z)}function Nt(l,f,y,_,z,J){if(!f)throw Error("Invalid event type");const _e=c(z)?!!z.capture:!!z;let ut=$e(l);if(ut||(l[nt]=ut=new Ie(l)),y=ut.add(f,y,_,_e,J),y.proxy)return y;if(_=Xt(),y.proxy=_,_.src=l,_.listener=y,l.addEventListener)P||(z=_e),z===void 0&&(z=!1),l.addEventListener(f.toString(),_,z);else if(l.attachEvent)l.attachEvent(qe(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return y}function Xt(){function l(y){return f.call(l.src,l.listener,y)}const f=Le;return l}function Q(l,f,y,_,z){if(Array.isArray(f))for(var J=0;J<f.length;J++)Q(l,f[J],y,_,z);else _=c(_)?!!_.capture:!!_,y=Ot(y),l&&l[Ue]?(l=l.i,J=String(f).toString(),J in l.g&&(f=l.g[J],y=bt(f,y,_,z),y>-1&&(tt(f[y]),Array.prototype.splice.call(f,y,1),f.length==0&&(delete l.g[J],l.h--)))):l&&(l=$e(l))&&(f=l.g[f.toString()],l=-1,f&&(l=bt(f,y,_,z)),(y=l>-1?f[l]:null)&&Pe(y))}function Pe(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Ue])ze(f.i,l);else{var y=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(y,_,l.capture):f.detachEvent?f.detachEvent(qe(y),_):f.addListener&&f.removeListener&&f.removeListener(_),(y=$e(f))?(ze(y,l),y.h==0&&(y.src=null,f[nt]=null)):tt(l)}}}function qe(l){return l in Ct?Ct[l]:Ct[l]="on"+l}function Le(l,f){if(l.da)l=!0;else{f=new Ae(f,this);const y=l.listener,_=l.ha||l.src;l.fa&&Pe(l),l=y.call(_,f)}return l}function $e(l){return l=l[nt],l instanceof Ie?l:null}var gt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ot(l){return typeof l=="function"?l:(l[gt]||(l[gt]=function(f){return l.handleEvent(f)}),l[gt])}function ct(){j.call(this),this.i=new Ie(this),this.M=this,this.G=null}h(ct,j),ct.prototype[Ue]=!0,ct.prototype.removeEventListener=function(l,f,y,_){Q(this,l,f,y,_)};function T(l,f){var y,_=l.G;if(_)for(y=[];_;_=_.G)y.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new I(f,l);else if(f instanceof I)f.target=f.target||l;else{var z=f;f=new I(_,l),fe(f,z)}z=!0;let J,_e;if(y)for(_e=y.length-1;_e>=0;_e--)J=f.g=y[_e],z=$(J,_,!0,f)&&z;if(J=f.g=l,z=$(J,_,!0,f)&&z,z=$(J,_,!1,f)&&z,y)for(_e=0;_e<y.length;_e++)J=f.g=y[_e],z=$(J,_,!1,f)&&z}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const y=l.g[f];for(let _=0;_<y.length;_++)tt(y[_]);delete l.g[f],l.h--}}this.G=null},ct.prototype.J=function(l,f,y,_){return this.i.add(String(l),f,!1,y,_)},ct.prototype.K=function(l,f,y,_){return this.i.add(String(l),f,!0,y,_)};function $(l,f,y,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let z=!0;for(let J=0;J<f.length;++J){const _e=f[J];if(_e&&!_e.da&&_e.capture==y){const ut=_e.listener,En=_e.ha||_e.src;_e.fa&&ze(l.i,_e),z=ut.call(En,_)!==!1&&z}}return z&&!_.defaultPrevented}function X(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:a.setTimeout(l,f||0)}function ye(l){l.g=X(()=>{l.g=null,l.i&&(l.i=!1,ye(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class le extends j{constructor(f,y){super(),this.m=f,this.l=y,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(l){j.call(this),this.h=l,this.g={}}h(de,j);var Ee=[];function Ke(l){Ut(l.g,function(f,y){this.g.hasOwnProperty(y)&&Pe(f)},l),l.g={}}de.prototype.N=function(){de.Z.N.call(this),Ke(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ze=a.JSON.stringify,Ne=a.JSON.parse,fn=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Pt(){}function st(){}var sn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function V(){I.call(this,"d")}h(V,I);function oe(){I.call(this,"c")}h(oe,I);var De={},Be=null;function ue(){return Be=Be||new ct}De.Ia="serverreachability";function Lt(l){I.call(this,De.Ia,l)}h(Lt,I);function yt(l){const f=ue();T(f,new Lt(f))}De.STAT_EVENT="statevent";function zt(l,f){I.call(this,De.STAT_EVENT,l),this.stat=f}h(zt,I);function dt(l){const f=ue();T(f,new zt(f,l))}De.Ja="timingevent";function Jt(l,f){I.call(this,De.Ja,l),this.size=f}h(Jt,I);function Zt(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function In(){this.g=!0}In.prototype.ua=function(){this.g=!1};function fs(l,f,y,_,z,J){l.info(function(){if(l.g)if(J){var _e="",ut=J.split("&");for(let $t=0;$t<ut.length;$t++){var En=ut[$t].split("=");if(En.length>1){const Ln=En[0];En=En[1];const Ps=Ln.split("_");_e=Ps.length>=2&&Ps[1]=="type"?_e+(Ln+"="+En+"&"):_e+(Ln+"=redacted&")}}}else _e=null;else _e=J;return"XMLHTTP REQ ("+_+") [attempt "+z+"]: "+f+`
`+y+`
`+_e})}function Qn(l,f,y,_,z,J,_e){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+z+"]: "+f+`
`+y+`
`+J+" "+_e})}function ps(l,f,y,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+ws(l,y)+(_?" "+_:"")})}function $r(l,f){l.info(function(){return"TIMEOUT: "+f})}In.prototype.info=function(){};function ws(l,f){if(!l.g)return f;if(!f)return null;try{const J=JSON.parse(f);if(J){for(l=0;l<J.length;l++)if(Array.isArray(J[l])){var y=J[l];if(!(y.length<2)){var _=y[1];if(Array.isArray(_)&&!(_.length<1)){var z=_[0];if(z!="noop"&&z!="stop"&&z!="close")for(let _e=1;_e<_.length;_e++)_[_e]=""}}}}return Ze(J)}catch{return f}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ss={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bn;function Pn(){}h(Pn,Pt),Pn.prototype.g=function(){return new XMLHttpRequest},Bn=new Pn;function g(l){return encodeURIComponent(String(l))}function R(l){var f=1;l=l.split(":");const y=[];for(;f>0&&l.length;)y.push(l.shift()),f--;return l.length&&y.push(l.join(":")),y}function w(l,f,y,_){this.j=l,this.i=f,this.l=y,this.S=_||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new M}function M(){this.i=null,this.g="",this.h=!1}var H={},G={};function q(l,f,y){l.M=1,l.A=Wr(We(f)),l.u=y,l.R=!0,O(l,null)}function O(l,f){l.F=Date.now(),Ye(l),l.B=We(l.A);var y=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),ce(y.i,"t",_),l.C=0,y=l.j.L,l.h=new M,l.g=Wu(l.j,y?f:null,!l.u),l.P>0&&(l.O=new le(u(l.Y,l,l.g),l.P)),f=l.V,y=l.g,_=l.ba;var z="readystatechange";Array.isArray(z)||(z&&(Ee[0]=z.toString()),z=Ee);for(let J=0;J<z.length;J++){const _e=ot(y,z[J],_||f.handleEvent,!1,f.h||f);if(!_e)break;f.g[_e.key]=_e}f=l.J?ae(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),yt(),fs(l.i,l.v,l.B,l.l,l.S,l.u)}w.prototype.ba=function(l){l=l.target;const f=this.O;f&&Ns(l)==3?f.j():this.Y(l)},w.prototype.Y=function(l){try{if(l==this.g)e:{const ut=Ns(this.g),En=this.g.ya(),$t=this.g.ca();if(!(ut<3)&&(ut!=3||this.g&&(this.h.h||this.g.la()||Tu(this.g)))){this.K||ut!=4||En==7||(En==8||$t<=0?yt(3):yt(2)),xe(this);var f=this.g.ca();this.X=f;var y=Z(this);if(this.o=f==200,Qn(this.i,this.v,this.B,this.l,this.S,ut,f),this.o){if(this.U&&!this.L){t:{if(this.g){var _,z=this.g;if((_=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(_)){var J=_;break t}}J=null}if(l=J)ps(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,mn(this,l);else{this.o=!1,this.m=3,dt(12),Qt(this),He(this);break e}}if(this.R){l=!0;let Ln;for(;!this.K&&this.C<y.length;)if(Ln=we(this,y),Ln==G){ut==4&&(this.m=4,dt(14),l=!1),ps(this.i,this.l,null,"[Incomplete Response]");break}else if(Ln==H){this.m=4,dt(15),ps(this.i,this.l,y,"[Invalid Chunk]"),l=!1;break}else ps(this.i,this.l,Ln,null),mn(this,Ln);if(re(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ut!=4||y.length!=0||this.h.h||(this.m=1,dt(16),l=!1),this.o=this.o&&l,!l)ps(this.i,this.l,y,"[Invalid Chunked Response]"),Qt(this),He(this);else if(y.length>0&&!this.W){this.W=!0;var _e=this.j;_e.g==this&&_e.aa&&!_e.P&&(_e.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),lc(_e),_e.P=!0,dt(11))}}else ps(this.i,this.l,y,null),mn(this,y);ut==4&&Qt(this),this.o&&!this.K&&(ut==4?Fu(this.j,this):(this.o=!1,Ye(this)))}else hb(this.g),f==400&&y.indexOf("Unknown SID")>0?(this.m=3,dt(12)):(this.m=0,dt(13)),Qt(this),He(this)}}}catch{}finally{}};function Z(l){if(!re(l))return l.g.la();const f=Tu(l.g);if(f==="")return"";let y="";const _=f.length,z=Ns(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Qt(l),He(l),"";l.h.i=new a.TextDecoder}for(let J=0;J<_;J++)l.h.h=!0,y+=l.h.i.decode(f[J],{stream:!(z&&J==_-1)});return f.length=0,l.h.g+=y,l.C=0,l.h.g}function re(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function we(l,f){var y=l.C,_=f.indexOf(`
`,y);return _==-1?G:(y=Number(f.substring(y,_)),isNaN(y)?H:(_+=1,_+y>f.length?G:(f=f.slice(_,_+y),l.C=_+y,f)))}w.prototype.cancel=function(){this.K=!0,Qt(this)};function Ye(l){l.T=Date.now()+l.H,at(l,l.H)}function at(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Zt(u(l.aa,l),f)}function xe(l){l.D&&(a.clearTimeout(l.D),l.D=null)}w.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?($r(this.i,this.B),this.M!=2&&(yt(),dt(17)),Qt(this),this.m=2,He(this)):at(this,this.T-l)};function He(l){l.j.I==0||l.K||Fu(l.j,l)}function Qt(l){xe(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Ke(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function mn(l,f){try{var y=l.j;if(y.I!=0&&(y.g==l||Tt(y.h,l))){if(!l.L&&Tt(y.h,l)&&y.I==3){try{var _=y.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var z=_;if(z[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<l.F)xa(y),ba(y);else break e;ac(y),dt(18)}}else y.xa=z[1],0<y.xa-y.K&&z[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Zt(u(y.Va,y),6e3));Gn(y.h)<=1&&y.ta&&(y.ta=void 0)}else zr(y,11)}else if((l.L||y.g==l)&&xa(y),!D(f))for(z=y.Ba.g.parse(f),f=0;f<z.length;f++){let $t=z[f];const Ln=$t[0];if(!(Ln<=y.K))if(y.K=Ln,$t=$t[1],y.I==2)if($t[0]=="c"){y.M=$t[1],y.ba=$t[2];const Ps=$t[3];Ps!=null&&(y.ka=Ps,y.j.info("VER="+y.ka));const Kr=$t[4];Kr!=null&&(y.za=Kr,y.j.info("SVER="+y.za));const ar=$t[5];ar!=null&&typeof ar=="number"&&ar>0&&(_=1.5*ar,y.O=_,y.j.info("backChannelRequestTimeoutMs_="+_)),_=y;const lr=l.g;if(lr){const _a=lr.g?lr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_a){var J=_.h;J.g||_a.indexOf("spdy")==-1&&_a.indexOf("quic")==-1&&_a.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Te(J,J.h),J.h=null))}if(_.G){const cc=lr.g?lr.g.getResponseHeader("X-HTTP-Session-Id"):null;cc&&(_.wa=cc,lt(_.J,_.G,cc))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-l.F,y.j.info("Handshake RTT: "+y.T+"ms")),_=y;var _e=l;if(_.na=$u(_,_.L?_.ba:null,_.W),_e.L){ve(_.h,_e);var ut=_e,En=_.O;En&&(ut.H=En),ut.D&&(xe(ut),Ye(ut)),_.g=_e}else Hu(_);y.i.length>0&&Na(y)}else $t[0]!="stop"&&$t[0]!="close"||zr(y,7);else y.I==3&&($t[0]=="stop"||$t[0]=="close"?$t[0]=="stop"?zr(y,7):oc(y):$t[0]!="noop"&&y.l&&y.l.qa($t),y.A=0)}}yt(4)}catch{}}var ns=class{constructor(l,f){this.g=l,this.map=f}};function en(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Yn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Gn(l){return l.h?1:l.g?l.g.size:0}function Tt(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Te(l,f){l.g?l.g.add(f):l.h=f}function ve(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}en.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Xe(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const y of l.g.values())f=f.concat(y.G);return f}return b(l.i)}var ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mt(l,f){if(l){l=l.split("&");for(let y=0;y<l.length;y++){const _=l[y].indexOf("=");let z,J=null;_>=0?(z=l[y].substring(0,_),J=l[y].substring(_+1)):z=l[y],f(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function je(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof je?(this.l=l.l,Dt(this,l.j),this.o=l.o,this.g=l.g,Dn(this,l.u),this.h=l.h,kn(this,he(l.i)),this.m=l.m):l&&(f=String(l).match(ft))?(this.l=!1,Dt(this,f[1]||"",!0),this.o=rr(f[2]||""),this.g=rr(f[3]||"",!0),Dn(this,f[4]),this.h=rr(f[5]||"",!0),kn(this,f[6]||"",!0),this.m=rr(f[7]||"")):(this.l=!1,this.i=new or(null,this.l))}je.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(ir(f,ao,!0),":");var y=this.g;return(y||f=="file")&&(l.push("//"),(f=this.o)&&l.push(ir(f,ao,!0),"@"),l.push(g(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&l.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&l.push("/"),l.push(ir(y,y.charAt(0)=="/"?nc:ya,!0))),(y=this.i.toString())&&l.push("?",y),(y=this.m)&&l.push("#",ir(y,rc)),l.join("")},je.prototype.resolve=function(l){const f=We(this);let y=!!l.j;y?Dt(f,l.j):y=!!l.o,y?f.o=l.o:y=!!l.g,y?f.g=l.g:y=l.u!=null;var _=l.h;if(y)Dn(f,l.u);else if(y=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var z=f.h.lastIndexOf("/");z!=-1&&(_=f.h.slice(0,z+1)+_)}if(z=_,z==".."||z==".")_="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){_=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let _e=0;_e<z.length;){const ut=z[_e++];ut=="."?_&&_e==z.length&&J.push(""):ut==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),_&&_e==z.length&&J.push("")):(J.push(ut),_=!0)}_=J.join("/")}else _=z}return y?f.h=_:y=l.i.toString()!=="",y?kn(f,he(l.i)):y=!!l.m,y&&(f.m=l.m),f};function We(l){return new je(l)}function Dt(l,f,y){l.j=y?rr(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Dn(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function kn(l,f,y){f instanceof or?(l.i=f,rt(l.i,l.l)):(y||(f=ir(f,sc)),l.i=new or(f,l.l))}function lt(l,f,y){l.i.set(f,y)}function Wr(l){return lt(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function rr(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ir(l,f,y){return typeof l=="string"?(l=encodeURI(l).replace(f,ga),y&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function ga(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ao=/[#\/\?@]/g,ya=/[#\?:]/g,nc=/[#\?]/g,sc=/[#\?@]/g,rc=/#/g;function or(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function N(l){l.g||(l.g=new Map,l.h=0,l.i&&mt(l.i,function(f,y){l.add(decodeURIComponent(f.replace(/\+/g," ")),y)}))}t=or.prototype,t.add=function(l,f){N(this),this.i=null,l=pe(this,l);let y=this.g.get(l);return y||this.g.set(l,y=[]),y.push(f),this.h+=1,this};function U(l,f){N(l),f=pe(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Y(l,f){return N(l),f=pe(l,f),l.g.has(f)}t.forEach=function(l,f){N(this),this.g.forEach(function(y,_){y.forEach(function(z){l.call(f,z,_,this)},this)},this)};function K(l,f){N(l);let y=[];if(typeof f=="string")Y(l,f)&&(y=y.concat(l.g.get(pe(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)y=y.concat(l[f]);return y}t.set=function(l,f){return N(this),this.i=null,l=pe(this,l),Y(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=K(this,l),l.length>0?String(l[0]):f):f};function ce(l,f,y){U(l,f),y.length>0&&(l.i=null,l.g.set(pe(l,f),b(y)),l.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var y=f[_];const z=g(y);y=K(this,y);for(let J=0;J<y.length;J++){let _e=z;y[J]!==""&&(_e+="="+g(y[J])),l.push(_e)}}return this.i=l.join("&")};function he(l){const f=new or;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function pe(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function rt(l,f){f&&!l.j&&(N(l),l.i=null,l.g.forEach(function(y,_){const z=_.toLowerCase();_!=z&&(U(this,_),ce(this,z,y))},l)),l.j=f}function pt(l,f){const y=new In;if(a.Image){const _=new Image;_.onload=d(wt,y,"TestLoadImage: loaded",!0,f,_),_.onerror=d(wt,y,"TestLoadImage: error",!1,f,_),_.onabort=d(wt,y,"TestLoadImage: abort",!1,f,_),_.ontimeout=d(wt,y,"TestLoadImage: timeout",!1,f,_),a.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function pn(l,f){const y=new In,_=new AbortController,z=setTimeout(()=>{_.abort(),wt(y,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(J=>{clearTimeout(z),J.ok?wt(y,"TestPingServer: ok",!0,f):wt(y,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(z),wt(y,"TestPingServer: error",!1,f)})}function wt(l,f,y,_,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),_(y)}catch{}}function St(){this.g=new fn}function tn(l){this.i=l.Sb||null,this.h=l.ab||!1}h(tn,Pt),tn.prototype.g=function(){return new An(this.i,this.h)};function An(l,f){ct.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(An,ct),t=An.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,un(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||a).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yt(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,un(this)),this.g&&(this.readyState=3,un(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kt(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function kt(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Yt(this):un(this),this.readyState==3&&kt(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Yt(this))},t.Na=function(l){this.g&&(this.response=l,Yt(this))},t.ga=function(){this.g&&Yt(this)};function Yt(l){l.readyState=4,l.l=null,l.j=null,l.B=null,un(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var y=f.next();!y.done;)y=y.value,l.push(y[0]+": "+y[1]),y=f.next();return l.join(`\r
`)};function un(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(An.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Ft(l){let f="";return Ut(l,function(y,_){f+=_,f+=":",f+=y,f+=`\r
`}),f}function qt(l,f,y){e:{for(_ in y){var _=!1;break e}_=!0}_||(y=Ft(y),typeof l=="string"?y!=null&&g(y):lt(l,f,y))}function ht(l){ct.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(ht,ct);var Kt=/^https?$/i,bs=["POST","PUT"];t=ht.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,y,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bn.g(),this.g.onreadystatechange=p(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(J){Is(this,J);return}if(l=y||"",y=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var z in _)y.set(z,_[z]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const J of _.keys())y.set(J,_.get(J));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(y.keys()).find(J=>J.toLowerCase()=="content-type"),z=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(bs,f,void 0)>=0)||_||z||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,_e]of y)this.g.setRequestHeader(J,_e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(J){Is(this,J)}};function Is(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,pi(l),hi(l)}function pi(l){l.A||(l.A=!0,T(l,"complete"),T(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,T(this,"complete"),T(this,"abort"),hi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hi(this,!0)),ht.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ic(this):this.Xa())},t.Xa=function(){ic(this)};function ic(l){if(l.h&&typeof i<"u"){if(l.v&&Ns(l)==4)setTimeout(l.Ca.bind(l),0);else if(T(l,"readystatechange"),Ns(l)==4){l.h=!1;try{const J=l.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var y;if(!(y=f)){var _;if(_=J===0){let _e=String(l.D).match(ft)[1]||null;!_e&&a.self&&a.self.location&&(_e=a.self.location.protocol.slice(0,-1)),_=!Kt.test(_e?_e.toLowerCase():"")}y=_}if(y)T(l,"complete"),T(l,"success");else{l.o=6;try{var z=Ns(l)>2?l.g.statusText:""}catch{z=""}l.l=z+" ["+l.ca()+"]",pi(l)}}finally{hi(l)}}}}function hi(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const y=l.g;l.g=null,f||T(l,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ns(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Ns(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Ne(f)}};function Tu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function hb(l){const f={};l=(l.g&&Ns(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(D(l[_]))continue;var y=R(l[_]);const z=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const J=f[z]||[];f[z]=J,J.push(y)}Ht(f,function(_){return _.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(l,f,y){return y&&y.internalChannelParams&&y.internalChannelParams[l]||f}function ju(l){this.za=0,this.i=[],this.j=new In,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=lo("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=lo("baseRetryDelayMs",5e3,l),this.Za=lo("retryDelaySeedMs",1e4,l),this.Ta=lo("forwardChannelMaxRetries",2,l),this.va=lo("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new en(l&&l.concurrentRequestLimit),this.Ba=new St,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ju.prototype,t.ka=8,t.I=1,t.connect=function(l,f,y,_){dt(0),this.W=l,this.H=f||{},y&&_!==void 0&&(this.H.OSID=y,this.H.OAID=_),this.F=this.X,this.J=$u(this,null,this.W),Na(this)};function oc(l){if(Ru(l),l.I==3){var f=l.V++,y=We(l.J);if(lt(y,"SID",l.M),lt(y,"RID",f),lt(y,"TYPE","terminate"),co(l,y),f=new w(l,l.j,f),f.M=2,f.A=Wr(We(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(f.A.toString(),"")}catch{}!y&&a.Image&&(new Image().src=f.A,y=!0),y||(f.g=Wu(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Ye(f)}qu(l)}function ba(l){l.g&&(lc(l),l.g.cancel(),l.g=null)}function Ru(l){ba(l),l.v&&(a.clearTimeout(l.v),l.v=null),xa(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function Na(l){if(!Yn(l.h)&&!l.m){l.m=!0;var f=l.Ea;ee||x(),F||(ee(),F=!0),A.add(f,l),l.D=0}}function gb(l,f){return Gn(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Zt(u(l.Ea,l,f),Ou(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const z=new w(this,this.j,l);let J=this.o;if(this.U&&(J?(J=ae(J),fe(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var f=0,y=0;y<this.i.length;y++){t:{var _=this.i[y];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=y;break e}if(f===4096||y===this.i.length-1){f=y+1;break e}}f=1e3}else f=1e3;f=Uu(this,z,f),y=We(this.J),lt(y,"RID",l),lt(y,"CVER",22),this.G&&lt(y,"X-HTTP-Session-Id",this.G),co(this,y),J&&(this.R?f="headers="+g(Ft(J))+"&"+f:this.u&&qt(y,this.u,J)),Te(this.h,z),this.Ra&&lt(y,"TYPE","init"),this.S?(lt(y,"$req",f),lt(y,"SID","null"),z.U=!0,q(z,y,null)):q(z,y,f),this.I=2}}else this.I==3&&(l?Bu(this,l):this.i.length==0||Yn(this.h)||Bu(this))};function Bu(l,f){var y;f?y=f.l:y=l.V++;const _=We(l.J);lt(_,"SID",l.M),lt(_,"RID",y),lt(_,"AID",l.K),co(l,_),l.u&&l.o&&qt(_,l.u,l.o),y=new w(l,l.j,y,l.D+1),l.u===null&&(y.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Uu(l,y,1e3),y.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Te(l.h,y),q(y,_,f)}function co(l,f){l.H&&Ut(l.H,function(y,_){lt(f,_,y)}),l.l&&Ut({},function(y,_){lt(f,_,y)})}function Uu(l,f,y){y=Math.min(l.i.length,y);const _=l.l?u(l.l.Ka,l.l,l):null;e:{var z=l.i;let ut=-1;for(;;){const En=["count="+y];ut==-1?y>0?(ut=z[0].g,En.push("ofs="+ut)):ut=0:En.push("ofs="+ut);let $t=!0;for(let Ln=0;Ln<y;Ln++){var J=z[Ln].g;const Ps=z[Ln].map;if(J-=ut,J<0)ut=Math.max(0,z[Ln].g-100),$t=!1;else try{J="req"+J+"_"||"";try{var _e=Ps instanceof Map?Ps:Object.entries(Ps);for(const[Kr,ar]of _e){let lr=ar;c(ar)&&(lr=Ze(ar)),En.push(J+Kr+"="+encodeURIComponent(lr))}}catch(Kr){throw En.push(J+"type="+encodeURIComponent("_badmap")),Kr}}catch{_&&_(Ps)}}if($t){_e=En.join("&");break e}}_e=void 0}return l=l.i.splice(0,y),f.G=l,_e}function Hu(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;ee||x(),F||(ee(),F=!0),A.add(f,l),l.A=0}}function ac(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Zt(u(l.Da,l),Ou(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Mu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Zt(u(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,dt(10),ba(this),Mu(this))};function lc(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function Mu(l){l.g=new w(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=We(l.na);lt(f,"RID","rpc"),lt(f,"SID",l.M),lt(f,"AID",l.K),lt(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&lt(f,"TO",l.ia),lt(f,"TYPE","xmlhttp"),co(l,f),l.u&&l.o&&qt(f,l.u,l.o),l.O&&(l.g.H=l.O);var y=l.g;l=l.ba,y.M=1,y.A=Wr(We(f)),y.u=null,y.R=!0,O(y,l)}t.Va=function(){this.C!=null&&(this.C=null,ba(this),ac(this),dt(19))};function xa(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Fu(l,f){var y=null;if(l.g==f){xa(l),lc(l),l.g=null;var _=2}else if(Tt(l.h,f))y=f.G,ve(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){y=f.u?f.u.length:0,f=Date.now()-f.F;var z=l.D;_=ue(),T(_,new Jt(_,y)),Na(l)}else Hu(l);else if(z=f.m,z==3||z==0&&f.X>0||!(_==1&&gb(l,f)||_==2&&ac(l)))switch(y&&y.length>0&&(f=l.h,f.i=f.i.concat(y)),z){case 1:zr(l,5);break;case 4:zr(l,10);break;case 3:zr(l,6);break;default:zr(l,2)}}}function Ou(l,f){let y=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(y*=2),y*f}function zr(l,f){if(l.j.info("Error code "+f),f==2){var y=u(l.bb,l),_=l.Ua;const z=!_;_=new je(_||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Dt(_,"https"),Wr(_),z?pt(_.toString(),y):pn(_.toString(),y)}else dt(2);l.I=0,l.l&&l.l.pa(f),qu(l),Ru(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),dt(2)):(this.j.info("Failed to ping google.com"),dt(1))};function qu(l){if(l.I=0,l.ja=[],l.l){const f=Xe(l.h);(f.length!=0||l.i.length!=0)&&(C(l.ja,f),C(l.ja,l.i),l.h.i.length=0,b(l.i),l.i.length=0),l.l.oa()}}function $u(l,f,y){var _=y instanceof je?We(y):new je(y);if(_.g!="")f&&(_.g=f+"."+_.g),Dn(_,_.u);else{var z=a.location;_=z.protocol,f=f?f+"."+z.hostname:z.hostname,z=+z.port;const J=new je(null);_&&Dt(J,_),f&&(J.g=f),z&&Dn(J,z),y&&(J.h=y),_=J}return y=l.G,f=l.wa,y&&f&&lt(_,y,f),lt(_,"VER",l.ka),co(l,_),_}function Wu(l,f,y){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new ht(new tn({ab:y})):new ht(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}t=zu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function va(){}va.prototype.g=function(l,f){return new as(l,f)};function as(l,f){ct.call(this),this.g=new ju(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!D(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!D(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new gi(this)}h(as,ct),as.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},as.prototype.close=function(){oc(this.g)},as.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var y={};y.__data__=l,l=y}else this.v&&(y={},y.__data__=Ze(l),l=y);f.i.push(new ns(f.Ya++,l)),f.I==3&&Na(f)},as.prototype.N=function(){this.g.l=null,delete this.j,oc(this.g),delete this.g,as.Z.N.call(this)};function Ku(l){V.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const y in f){l=y;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}h(Ku,V);function Qu(){oe.call(this),this.status=1}h(Qu,oe);function gi(l){this.g=l}h(gi,zu),gi.prototype.ra=function(){T(this.g,"a")},gi.prototype.qa=function(l){T(this.g,new Ku(l))},gi.prototype.pa=function(l){T(this.g,new Qu)},gi.prototype.oa=function(){T(this.g,"b")},va.prototype.createWebChannel=va.prototype.g,as.prototype.send=as.prototype.o,as.prototype.open=as.prototype.m,as.prototype.close=as.prototype.close,sh=function(){return new va},nh=function(){return ue()},th=De,qc={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,Wa=ts,Ss.COMPLETE="complete",eh=Ss,st.EventType=sn,sn.OPEN="a",sn.CLOSE="b",sn.ERROR="c",sn.MESSAGE="d",ct.prototype.listen=ct.prototype.J,Vo=st,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,Zp=ht}).apply(typeof ka<"u"?ka:typeof self<"u"?self:typeof window<"u"?window:{});const gd="@firebase/firestore",yd="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gi="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new Op("@firebase/firestore");function Pi(){return si.logLevel}function Ve(t,...e){if(si.logLevel<=Et.DEBUG){const n=e.map(wm);si.debug(`Firestore (${Gi}): ${t}`,...n)}}function Zs(t,...e){if(si.logLevel<=Et.ERROR){const n=e.map(wm);si.error(`Firestore (${Gi}): ${t}`,...n)}}function Oi(t,...e){if(si.logLevel<=Et.WARN){const n=e.map(wm);si.warn(`Firestore (${Gi}): ${t}`,...n)}}function wm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,rh(t,s,n)}function rh(t,e,n){let s=`FIRESTORE (${Gi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Zs(s),new Error(s)}function Bt(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||rh(e,r,s)}function Ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends ai{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Wn.UNAUTHENTICATED))}shutdown(){}}class Ax{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Ex{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Bt(this.o===void 0,42304);let s=this.i;const r=m=>this.i!==s?(s=this.i,n(m)):Promise.resolve();let i=new Gs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gs,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const m=i;e.enqueueRetryable(async()=>{await m.promise,await r(this.currentUser)})},c=m=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(m=>c(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?c(m):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gs)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Bt(typeof s.accessToken=="string",31837,{l:s}),new ih(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Bt(e===null||typeof e=="string",2055,{h:e}),new Wn(e)}}class Vx{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Cx{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new Vx(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wx{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Bt(this.o===void 0,3512);const s=i=>{i.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Bt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new bd(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Sx(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function vt(t,e){return t<e?-1:t>e?1:0}function $c(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return yc(r)===yc(i)?vt(r,i):yc(r)?1:-1}return vt(t.length,e.length)}const Ix=55296,Px=57343;function yc(t){const e=t.charCodeAt(0);return e>=Ix&&e<=Px}function qi(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="__name__";class Ts{constructor(e,n,s){n===void 0?n=0:n>e.length&&Qe(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&Qe(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Ts.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ts?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=Ts.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return vt(e.length,n.length)}static compareSegments(e,n){const s=Ts.isNumericId(e),r=Ts.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Ts.extractNumericId(e).compare(Ts.extractNumericId(n)):$c(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _r.fromString(e.substring(4,e.length-2))}}class Wt extends Ts{construct(e,n,s){return new Wt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new ke(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Wt(n)}static emptyPath(){return new Wt([])}}const Lx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mn extends Ts{construct(e,n,s){return new Mn(e,n,s)}static isValidIdentifier(e){return Lx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Nd}static keyField(){return new Mn([Nd])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new ke(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let a=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new ke(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[r+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new ke(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(s+=c,r++):(i(),r++)}if(i(),a)throw new ke(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mn(n)}static emptyPath(){return new Mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(Wt.fromString(e))}static fromName(e){return new Oe(Wt.fromString(e).popFirst(5))}static empty(){return new Oe(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Wt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new Wt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(t,e,n){if(!n)throw new ke(se.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Tx(t,e,n,s){if(e===!0&&s===!0)throw new ke(se.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function xd(t){if(!Oe.isDocumentKey(t))throw new ke(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vd(t){if(Oe.isDocumentKey(t))throw new ke(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ah(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function El(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Qe(12329,{type:typeof t})}function wn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ke(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=El(t);throw new ke(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t,e){const n={typeString:t};return e&&(n.value=e),n}function ia(t,e){if(!ah(t))throw new ke(se.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const a=t[s];if(r&&typeof a!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new ke(se.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d=-62135596800,Dd=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(e){return be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Dd);return new be(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ke(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ke(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<_d)throw new ke(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Dd}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ia(e,be._jsonSchema))return new be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_d;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:vn("string",be._jsonSchemaVersion),seconds:vn("number"),nanoseconds:vn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new be(0,0))}static max(){return new Je(new be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=-1;function jx(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=Je.fromTimestamp(s===1e9?new be(n+1,0):new be(n,s));return new Ar(r,Oe.empty(),e)}function Rx(t){return new Ar(t.readTime,t.key,zo)}class Ar{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Ar(Je.min(),Oe.empty(),zo)}static max(){return new Ar(Je.max(),Oe.empty(),zo)}}function Bx(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Oe.comparator(t.documentKey,e.documentKey),n!==0?n:vt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xi(t){if(t.code!==se.FAILED_PRECONDITION||t.message!==Ux)throw t;Ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new me((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof me?n:me.resolve(n)}catch(n){return me.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):me.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):me.reject(n)}static resolve(e){return new me((n,s)=>{n(e)})}static reject(e){return new me((n,s)=>{s(e)})}static waitFor(e){return new me((n,s)=>{let r=0,i=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++i,a&&i===r&&n()},m=>s(m))}),a=!0,i===r&&n()})}static or(e){let n=me.resolve(!1);for(const s of e)n=n.next(r=>r?me.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new me((s,r)=>{const i=e.length,a=new Array(i);let c=0;for(let m=0;m<i;m++){const u=m;n(e[u]).next(d=>{a[u]=d,++c,c===i&&s(a)},d=>r(d))}})}static doWhile(e,n){return new me((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function Mx(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ji(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Vl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=-1;function Cl(t){return t==null}function il(t){return t===0&&1/t==-1/0}function Fx(t){return typeof t=="number"&&Number.isInteger(t)&&!il(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="";function Ox(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=kd(e)),e=qx(t.get(n),e);return kd(e)}function qx(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case lh:n+="";break;default:n+=i}}return n}function kd(t){return t+lh+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Tr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ch(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,n){this.comparator=e,this.root=n||Un.EMPTY}insert(e,n){return new nn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Un.BLACK,null,null))}remove(e){return new nn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Un.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Aa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Aa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Aa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Aa(this.root,e,this.comparator,!0)}}class Aa{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Un{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Un.RED,this.left=r??Un.EMPTY,this.right=i??Un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Un(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Un.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Qe(27949);return e+(this.isRed()?0:1)}}Un.EMPTY=null,Un.RED=!0,Un.BLACK=!1;Un.EMPTY=new class{constructor(){this.size=0}get key(){throw Qe(57766)}get value(){throw Qe(16141)}get color(){throw Qe(16727)}get left(){throw Qe(29726)}get right(){throw Qe(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new Un(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.comparator=e,this.data=new nn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ed(this.data.getIterator())}getIteratorFrom(e){return new Ed(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Sn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Sn(this.comparator);return n.data=e,n}}class Ed{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.fields=e,e.sort(Mn.comparator)}static empty(){return new cs([])}unionWith(e){let n=new Sn(Mn.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new cs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qi(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mh("Invalid base64 string: "+i):i}}(e);return new On(n)}static fromUint8Array(e){const n=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new On(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}On.EMPTY_BYTE_STRING=new On("");const $x=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Er(t){if(Bt(!!t,39018),typeof t=="string"){let e=0;const n=$x.exec(t);if(Bt(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:dn(t.seconds),nanos:dn(t.nanos)}}function dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Vr(t){return typeof t=="string"?On.fromBase64String(t):On.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="server_timestamp",dh="__type__",fh="__previous_value__",ph="__local_write_time__";function Pm(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dh])==null?void 0:s.stringValue)===uh}function wl(t){const e=t.mapValue.fields[fh];return Pm(e)?wl(e):e}function Ko(t){const e=Er(t.mapValue.fields[ph].timestampValue);return new be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,s,r,i,a,c,m,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=m,this.useFetchStreams=u,this.isUsingEmulator=d}}const ol="(default)";class Qo{constructor(e,n){this.projectId=e,this.database=n||ol}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===ol}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="__type__",zx="__max__",Ea={mapValue:{}},gh="__vector__",al="value";function Cr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pm(t)?4:Qx(t)?9007199254740991:Kx(t)?10:11:Qe(28295,{value:t})}function qs(t,e){if(t===e)return!0;const n=Cr(t);if(n!==Cr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ko(t).isEqual(Ko(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Er(r.timestampValue),c=Er(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Vr(r.bytesValue).isEqual(Vr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return dn(r.geoPointValue.latitude)===dn(i.geoPointValue.latitude)&&dn(r.geoPointValue.longitude)===dn(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return dn(r.integerValue)===dn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=dn(r.doubleValue),c=dn(i.doubleValue);return a===c?il(a)===il(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return qi(t.arrayValue.values||[],e.arrayValue.values||[],qs);case 10:case 11:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(Ad(a)!==Ad(c))return!1;for(const m in a)if(a.hasOwnProperty(m)&&(c[m]===void 0||!qs(a[m],c[m])))return!1;return!0}(t,e);default:return Qe(52216,{left:t})}}function Yo(t,e){return(t.values||[]).find(n=>qs(n,e))!==void 0}function $i(t,e){if(t===e)return 0;const n=Cr(t),s=Cr(e);if(n!==s)return vt(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return vt(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=dn(i.integerValue||i.doubleValue),m=dn(a.integerValue||a.doubleValue);return c<m?-1:c>m?1:c===m?0:isNaN(c)?isNaN(m)?0:-1:1}(t,e);case 3:return Vd(t.timestampValue,e.timestampValue);case 4:return Vd(Ko(t),Ko(e));case 5:return $c(t.stringValue,e.stringValue);case 6:return function(i,a){const c=Vr(i),m=Vr(a);return c.compareTo(m)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),m=a.split("/");for(let u=0;u<c.length&&u<m.length;u++){const d=vt(c[u],m[u]);if(d!==0)return d}return vt(c.length,m.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=vt(dn(i.latitude),dn(a.latitude));return c!==0?c:vt(dn(i.longitude),dn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Cd(t.arrayValue,e.arrayValue);case 10:return function(i,a){var p,b,C,v;const c=i.fields||{},m=a.fields||{},u=(p=c[al])==null?void 0:p.arrayValue,d=(b=m[al])==null?void 0:b.arrayValue,h=vt(((C=u==null?void 0:u.values)==null?void 0:C.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return h!==0?h:Cd(u,d)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ea.mapValue&&a===Ea.mapValue)return 0;if(i===Ea.mapValue)return 1;if(a===Ea.mapValue)return-1;const c=i.fields||{},m=Object.keys(c),u=a.fields||{},d=Object.keys(u);m.sort(),d.sort();for(let h=0;h<m.length&&h<d.length;++h){const p=$c(m[h],d[h]);if(p!==0)return p;const b=$i(c[m[h]],u[d[h]]);if(b!==0)return b}return vt(m.length,d.length)}(t.mapValue,e.mapValue);default:throw Qe(23264,{he:n})}}function Vd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return vt(t,e);const n=Er(t),s=Er(e),r=vt(n.seconds,s.seconds);return r!==0?r:vt(n.nanos,s.nanos)}function Cd(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=$i(n[r],s[r]);if(i)return i}return vt(n.length,s.length)}function Wi(t){return Wc(t)}function Wc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=Er(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Vr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=Wc(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const a of s)i?i=!1:r+=",",r+=`${a}:${Wc(n.fields[a])}`;return r+"}"}(t.mapValue):Qe(61005,{value:t})}function za(t){switch(Cr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wl(t);return e?16+za(e):16;case 5:return 2*t.stringValue.length;case 6:return Vr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+za(i),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Tr(s.fields,(i,a)=>{r+=i.length+za(a)}),r}(t.mapValue);default:throw Qe(13486,{value:t})}}function wd(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function zc(t){return!!t&&"integerValue"in t}function Lm(t){return!!t&&"arrayValue"in t}function Sd(t){return!!t&&"nullValue"in t}function Id(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ka(t){return!!t&&"mapValue"in t}function Kx(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[hh])==null?void 0:s.stringValue)===gh}function Lo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Tr(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Lo(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lo(t.arrayValue.values[n]);return e}return{...t}}function Qx(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===zx}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.value=e}static empty(){return new os({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Ka(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lo(n)}setAll(e){let n=Mn.emptyPath(),s={},r=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const m=this.getFieldsMap(n);this.applyChanges(m,s,r),s={},r=[],n=c.popLast()}a?s[c.lastSegment()]=Lo(a):r.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Ka(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return qs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Ka(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Tr(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new os(Lo(this.value))}}function yh(t){const e=[];return Tr(t.fields,(n,s)=>{const r=new Mn([n]);if(Ka(s)){const i=yh(s.mapValue).fields;if(i.length===0)e.push(r);else for(const a of i)e.push(r.child(a))}else e.push(r)}),new cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n,s,r,i,a,c){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new zn(e,0,Je.min(),Je.min(),Je.min(),os.empty(),0)}static newFoundDocument(e,n,s,r){return new zn(e,1,n,Je.min(),s,r,0)}static newNoDocument(e,n){return new zn(e,2,n,Je.min(),Je.min(),os.empty(),0)}static newUnknownDocument(e,n){return new zn(e,3,n,Je.min(),Je.min(),os.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n){this.position=e,this.inclusive=n}}function Pd(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],a=t.position[r];if(i.field.isKeyField()?s=Oe.comparator(Oe.fromName(a.referenceValue),n.key):s=$i(a,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Ld(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!qs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n="asc"){this.field=e,this.dir=n}}function Yx(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{}class xn extends bh{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new Xx(e,n,s):n==="array-contains"?new ev(e,s):n==="in"?new tv(e,s):n==="not-in"?new nv(e,s):n==="array-contains-any"?new sv(e,s):new xn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new Jx(e,s):new Zx(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison($i(n,this.value)):n!==null&&Cr(this.value)===Cr(n)&&this.matchesComparison($i(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends bh{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Es(e,n)}matches(e){return Nh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nh(t){return t.op==="and"}function xh(t){return Gx(t)&&Nh(t)}function Gx(t){for(const e of t.filters)if(e instanceof Es)return!1;return!0}function Kc(t){if(t instanceof xn)return t.field.canonicalString()+t.op.toString()+Wi(t.value);if(xh(t))return t.filters.map(e=>Kc(e)).join(",");{const e=t.filters.map(n=>Kc(n)).join(",");return`${t.op}(${e})`}}function vh(t,e){return t instanceof xn?function(s,r){return r instanceof xn&&s.op===r.op&&s.field.isEqual(r.field)&&qs(s.value,r.value)}(t,e):t instanceof Es?function(s,r){return r instanceof Es&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,a,c)=>i&&vh(a,r.filters[c]),!0):!1}(t,e):void Qe(19439)}function _h(t){return t instanceof xn?function(n){return`${n.field.canonicalString()} ${n.op} ${Wi(n.value)}`}(t):t instanceof Es?function(n){return n.op.toString()+" {"+n.getFilters().map(_h).join(" ,")+"}"}(t):"Filter"}class Xx extends xn{constructor(e,n,s){super(e,n,s),this.key=Oe.fromName(s.referenceValue)}matches(e){const n=Oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class Jx extends xn{constructor(e,n){super(e,"in",n),this.keys=Dh("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Zx extends xn{constructor(e,n){super(e,"not-in",n),this.keys=Dh("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Dh(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(s=>Oe.fromName(s.referenceValue))}class ev extends xn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lm(n)&&Yo(n.arrayValue,this.value)}}class tv extends xn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yo(this.value.arrayValue,n)}}class nv extends xn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Yo(this.value.arrayValue,n)}}class sv extends xn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Yo(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n=null,s=[],r=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Td(t,e=null,n=[],s=[],r=null,i=null,a=null){return new rv(t,e,n,s,r,i,a)}function Tm(t){const e=Ge(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Kc(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Cl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Wi(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Wi(s)).join(",")),e.Te=n}return e.Te}function jm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Yx(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ld(t.startAt,e.startAt)&&Ld(t.endAt,e.endAt)}function Qc(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n=null,s=[],r=[],i=null,a="F",c=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iv(t,e,n,s,r,i,a,c){return new Zi(t,e,n,s,r,i,a,c)}function Sl(t){return new Zi(t)}function jd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kh(t){return t.collectionGroup!==null}function To(t){const e=Ge(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Sn(Mn.comparator);return a.filters.forEach(m=>{m.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Go(i,s))}),n.has(Mn.keyField().canonicalString())||e.Ie.push(new Go(Mn.keyField(),s))}return e.Ie}function Us(t){const e=Ge(t);return e.Ee||(e.Ee=ov(e,To(t))),e.Ee}function ov(t,e){if(t.limitType==="F")return Td(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Go(r.field,i)});const n=t.endAt?new ll(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ll(t.startAt.position,t.startAt.inclusive):null;return Td(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function Yc(t,e){const n=t.filters.concat([e]);return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gc(t,e,n){return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Il(t,e){return jm(Us(t),Us(e))&&t.limitType===e.limitType}function Ah(t){return`${Tm(Us(t))}|lt:${t.limitType}`}function Li(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>_h(r)).join(", ")}]`),Cl(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>Wi(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>Wi(r)).join(",")),`Target(${s})`}(Us(t))}; limitType=${t.limitType})`}function Pl(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Oe.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of To(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(a,c,m){const u=Pd(a,c,m);return a.inclusive?u<=0:u<0}(s.startAt,To(s),r)||s.endAt&&!function(a,c,m){const u=Pd(a,c,m);return a.inclusive?u>=0:u>0}(s.endAt,To(s),r))}(t,e)}function av(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Eh(t){return(e,n)=>{let s=!1;for(const r of To(t)){const i=lv(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function lv(t,e,n){const s=t.field.isKeyField()?Oe.comparator(e.key,n.key):function(i,a,c){const m=a.data.field(i),u=c.data.field(i);return m!==null&&u!==null?$i(m,u):Qe(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Qe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Tr(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return ch(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv=new nn(Oe.comparator);function er(){return cv}const Vh=new nn(Oe.comparator);function Co(...t){let e=Vh;for(const n of t)e=e.insert(n.key,n);return e}function Ch(t){let e=Vh;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Xr(){return jo()}function wh(){return jo()}function jo(){return new li(t=>t.toString(),(t,e)=>t.isEqual(e))}const mv=new nn(Oe.comparator),uv=new Sn(Oe.comparator);function _t(...t){let e=uv;for(const n of t)e=e.add(n);return e}const dv=new Sn(vt);function fv(){return dv}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:il(e)?"-0":e}}function Sh(t){return{integerValue:""+t}}function pv(t,e){return Fx(e)?Sh(e):Rm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this._=void 0}}function hv(t,e,n){return t instanceof Xo?function(r,i){const a={fields:{[dh]:{stringValue:uh},[ph]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Pm(i)&&(i=wl(i)),i&&(a.fields[fh]=i),{mapValue:a}}(n,e):t instanceof Jo?Ph(t,e):t instanceof Zo?Lh(t,e):function(r,i){const a=Ih(r,i),c=Rd(a)+Rd(r.Ae);return zc(a)&&zc(r.Ae)?Sh(c):Rm(r.serializer,c)}(t,e)}function gv(t,e,n){return t instanceof Jo?Ph(t,e):t instanceof Zo?Lh(t,e):n}function Ih(t,e){return t instanceof cl?function(s){return zc(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Xo extends Ll{}class Jo extends Ll{constructor(e){super(),this.elements=e}}function Ph(t,e){const n=Th(e);for(const s of t.elements)n.some(r=>qs(r,s))||n.push(s);return{arrayValue:{values:n}}}class Zo extends Ll{constructor(e){super(),this.elements=e}}function Lh(t,e){let n=Th(e);for(const s of t.elements)n=n.filter(r=>!qs(r,s));return{arrayValue:{values:n}}}class cl extends Ll{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Rd(t){return dn(t.integerValue||t.doubleValue)}function Th(t){return Lm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,n){this.field=e,this.transform=n}}function bv(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof Jo&&r instanceof Jo||s instanceof Zo&&r instanceof Zo?qi(s.elements,r.elements,qs):s instanceof cl&&r instanceof cl?qs(s.Ae,r.Ae):s instanceof Xo&&r instanceof Xo}(t.transform,e.transform)}class Nv{constructor(e,n){this.version=e,this.transformResults=n}}class es{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new es}static exists(e){return new es(void 0,e)}static updateTime(e){return new es(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tl{}function jh(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jl(t.key,es.none()):new oa(t.key,t.data,es.none());{const n=t.data,s=os.empty();let r=new Sn(Mn.comparator);for(let i of e.fields)if(!r.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?s.delete(i):s.set(i,a),r=r.add(i)}return new jr(t.key,s,new cs(r.toArray()),es.none())}}function xv(t,e,n){t instanceof oa?function(r,i,a){const c=r.value.clone(),m=Ud(r.fieldTransforms,i,a.transformResults);c.setAll(m),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof jr?function(r,i,a){if(!Qa(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Ud(r.fieldTransforms,i,a.transformResults),m=i.data;m.setAll(Rh(r)),m.setAll(c),i.convertToFoundDocument(a.version,m).setHasCommittedMutations()}(t,e,n):function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Ro(t,e,n,s){return t instanceof oa?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=i.value.clone(),d=Hd(i.fieldTransforms,m,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof jr?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=Hd(i.fieldTransforms,m,a),d=a.data;return d.setAll(Rh(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,s):function(i,a,c){return Qa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function vv(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Ih(s.transform,r||null);i!=null&&(n===null&&(n=os.empty()),n.set(s.field,i))}return n||null}function Bd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&qi(s,r,(i,a)=>bv(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class oa extends Tl{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class jr extends Tl{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Rh(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function Ud(t,e,n){const s=new Map;Bt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],a=i.transform,c=e.data.field(i.field);s.set(i.field,gv(a,c,n[r]))}return s}function Hd(t,e,n){const s=new Map;for(const r of t){const i=r.transform,a=n.data.field(r.field);s.set(r.field,hv(i,a,e))}return s}class jl extends Tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _v extends Tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&xv(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Ro(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Ro(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=wh();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(r.key)?null:c;const m=jh(a,c);m!==null&&s.set(r.key,m),a.isValidDocument()||a.convertToNoDocument(Je.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),_t())}isEqual(e){return this.batchId===e.batchId&&qi(this.mutations,e.mutations,(n,s)=>Bd(n,s))&&qi(this.baseMutations,e.baseMutations,(n,s)=>Bd(n,s))}}class Bm{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Bt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return mv}();const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,s[a].version);return new Bm(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gn,At;function Ev(t){switch(t){case se.OK:return Qe(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Qe(15467,{code:t})}}function Bh(t){if(t===void 0)return Zs("GRPC error has no .code"),se.UNKNOWN;switch(t){case gn.OK:return se.OK;case gn.CANCELLED:return se.CANCELLED;case gn.UNKNOWN:return se.UNKNOWN;case gn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case gn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case gn.INTERNAL:return se.INTERNAL;case gn.UNAVAILABLE:return se.UNAVAILABLE;case gn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case gn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case gn.NOT_FOUND:return se.NOT_FOUND;case gn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case gn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case gn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case gn.ABORTED:return se.ABORTED;case gn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case gn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case gn.DATA_LOSS:return se.DATA_LOSS;default:return Qe(39323,{code:t})}}(At=gn||(gn={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv=new _r([4294967295,4294967295],0);function Md(t){const e=Vv().encode(t),n=new Jp;return n.update(e),new Uint8Array(n.digest())}function Fd(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new _r([n,s],0),new _r([r,i],0)]}class Um{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new wo(`Invalid padding: ${n}`);if(s<0)throw new wo(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new wo(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new wo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=_r.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(_r.fromNumber(s)));return r.compare(Cv)===1&&(r=new _r([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Md(e),[s,r]=Fd(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);if(!this.we(a))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Um(i,r,n);return s.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const n=Md(e),[s,r]=Fd(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);this.Se(a)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,aa.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Rl(Je.min(),r,new nn(vt),er(),_t())}}class aa{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new aa(s,n,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class Uh{constructor(e,n){this.targetId=e,this.Ce=n}}class Hh{constructor(e,n,s=On.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class Od{constructor(){this.ve=0,this.Fe=qd(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),n=_t(),s=_t();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:Qe(38017,{changeType:i})}}),new aa(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=qd()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Bt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wv{constructor(e){this.Ge=e,this.ze=new Map,this.je=er(),this.Je=Va(),this.He=Va(),this.Ye=new nn(vt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:Qe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(Qc(i))if(s===0){const a=new Oe(i.path);this.et(n,a,zn.newNoDocument(a,Je.min()))}else Bt(s===1,20013,{expectedCount:s});else{const a=this._t(n);if(a!==s){const c=this.ut(e),m=c?this.ct(c,e,a):1;if(m!==0){this.it(n);const u=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let a,c;try{a=Vr(s).toUint8Array()}catch(m){if(m instanceof mh)return Oi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{c=new Um(a,r,i)}catch(m){return Oi(m instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return c.ge===0?null:c}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Qc(c.target)){const m=new Oe(c.target.path);this.It(m).has(a)||this.Et(a,m)||this.et(a,m,zn.newNoDocument(m,e))}i.Be&&(n.set(a,i.ke()),i.qe())}});let s=_t();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(m=>{const u=this.ot(m);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(s=s.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const r=new Rl(e,n,this.Ye,this.je,s);return this.je=er(),this.Je=Va(),this.He=Va(),this.Ye=new nn(vt),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Od,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Sn(vt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Sn(vt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ve("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Od),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Va(){return new nn(Oe.comparator)}function qd(){return new nn(Oe.comparator)}const Sv={asc:"ASCENDING",desc:"DESCENDING"},Iv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pv={and:"AND",or:"OR"};class Lv{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xc(t,e){return t.useProto3Json||Cl(e)?e:{value:e}}function ml(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Tv(t,e){return ml(t,e.toTimestamp())}function Hs(t){return Bt(!!t,49232),Je.fromTimestamp(function(n){const s=Er(n);return new be(s.seconds,s.nanos)}(t))}function Hm(t,e){return Jc(t,e).canonicalString()}function Jc(t,e){const n=function(r){return new Wt(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Fh(t){const e=Wt.fromString(t);return Bt(zh(e),10190,{key:e.toString()}),e}function Zc(t,e){return Hm(t.databaseId,e.path)}function bc(t,e){const n=Fh(e);if(n.get(1)!==t.databaseId.projectId)throw new ke(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ke(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Oe(qh(n))}function Oh(t,e){return Hm(t.databaseId,e)}function jv(t){const e=Fh(t);return e.length===4?Wt.emptyPath():qh(e)}function em(t){return new Wt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qh(t){return Bt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $d(t,e,n){return{name:Zc(t,e),fields:n.value.mapValue.fields}}function Rv(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Qe(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Bt(d===void 0||typeof d=="string",58123),On.fromBase64String(d||"")):(Bt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),On.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(u){const d=u.code===void 0?se.UNKNOWN:Bh(u.code);return new ke(d,u.message||"")}(a);n=new Hh(s,r,i,c||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=bc(t,s.document.name),i=Hs(s.document.updateTime),a=s.document.createTime?Hs(s.document.createTime):Je.min(),c=new os({mapValue:{fields:s.document.fields}}),m=zn.newFoundDocument(r,i,a,c),u=s.targetIds||[],d=s.removedTargetIds||[];n=new Ya(u,d,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=bc(t,s.document),i=s.readTime?Hs(s.readTime):Je.min(),a=zn.newNoDocument(r,i),c=s.removedTargetIds||[];n=new Ya([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=bc(t,s.document),i=s.removedTargetIds||[];n=new Ya([],i,r,null)}else{if(!("filter"in e))return Qe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,a=new Av(r,i),c=s.targetId;n=new Uh(c,a)}}return n}function Bv(t,e){let n;if(e instanceof oa)n={update:$d(t,e.key,e.value)};else if(e instanceof jl)n={delete:Zc(t,e.key)};else if(e instanceof jr)n={update:$d(t,e.key,e.data),updateMask:zv(e.fieldMask)};else{if(!(e instanceof _v))return Qe(16599,{Vt:e.type});n={verify:Zc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,a){const c=a.transform;if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Jo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof cl)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Qe(20930,{transform:a.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:Tv(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Qe(27497)}(t,e.precondition)),n}function Uv(t,e){return t&&t.length>0?(Bt(e!==void 0,14353),t.map(n=>function(r,i){let a=r.updateTime?Hs(r.updateTime):Hs(i);return a.isEqual(Je.min())&&(a=Hs(i)),new Nv(a,r.transformResults||[])}(n,e))):[]}function Hv(t,e){return{documents:[Oh(t,e.path)]}}function Mv(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Oh(t,r);const i=function(u){if(u.length!==0)return Wh(Es.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ti(p.field),direction:qv(p.dir)}}(d))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=Xc(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:r}}function Fv(t){let e=jv(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Bt(s===1,65062);const d=n.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const p=$h(h);return p instanceof Es&&xh(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(p=>function(C){return new Go(ji(C.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(h){let p;return p=typeof h=="object"?h.value:h,Cl(p)?null:p}(n.limit));let m=null;n.startAt&&(m=function(h){const p=!!h.before,b=h.values||[];return new ll(b,p)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const p=!h.before,b=h.values||[];return new ll(b,p)}(n.endAt)),iv(e,r,a,i,c,"F",m,u)}function Ov(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qe(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $h(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=ji(n.unaryFilter.field);return xn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ji(n.unaryFilter.field);return xn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ji(n.unaryFilter.field);return xn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ji(n.unaryFilter.field);return xn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Qe(61313);default:return Qe(60726)}}(t):t.fieldFilter!==void 0?function(n){return xn.create(ji(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Qe(58110);default:return Qe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Es.create(n.compositeFilter.filters.map(s=>$h(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Qe(1026)}}(n.compositeFilter.op))}(t):Qe(30097,{filter:t})}function qv(t){return Sv[t]}function $v(t){return Iv[t]}function Wv(t){return Pv[t]}function Ti(t){return{fieldPath:t.canonicalString()}}function ji(t){return Mn.fromServerFormat(t.fieldPath)}function Wh(t){return t instanceof xn?function(n){if(n.op==="=="){if(Id(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NAN"}};if(Sd(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Id(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NAN"}};if(Sd(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(n.field),op:$v(n.op),value:n.value}}}(t):t instanceof Es?function(n){const s=n.getFilters().map(r=>Wh(r));return s.length===1?s[0]:{compositeFilter:{op:Wv(n.op),filters:s}}}(t):Qe(54877,{filter:t})}function zv(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function zh(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,s,r,i=Je.min(),a=Je.min(),c=On.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=m}withSequenceNumber(e){return new br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this.yt=e}}function Qv(t){const e=Fv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(){this.Cn=new Gv}addToCollectionParentIndex(e,n){return this.Cn.add(n),me.resolve()}getCollectionParents(e,n){return me.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return me.resolve()}deleteFieldIndex(e,n){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,n){return me.resolve()}getDocumentsMatchingTarget(e,n){return me.resolve(null)}getIndexType(e,n){return me.resolve(0)}getFieldIndexes(e,n){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,n){return me.resolve(Ar.min())}getMinOffsetFromCollectionGroup(e,n){return me.resolve(Ar.min())}updateCollectionGroup(e,n,s){return me.resolve()}updateIndexEntries(e,n){return me.resolve()}}class Gv{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Sn(Wt.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Sn(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kh=41943040;class rs{static withCacheSize(e){return new rs(e,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs.DEFAULT_COLLECTION_PERCENTILE=10,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rs.DEFAULT=new rs(Kh,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rs.DISABLED=new rs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zi(0)}static cr(){return new zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="LruGarbageCollector",Xv=1048576;function Kd([t,e],[n,s]){const r=vt(t,n);return r===0?vt(e,s):r}class Jv{constructor(e){this.Ir=e,this.buffer=new Sn(Kd),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();Kd(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Zv{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(zd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ji(n)?Ve(zd,"Ignoring IndexedDB error during garbage collection: ",n):await Xi(n)}await this.Vr(3e5)})}}class e_{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return me.resolve(Vl.ce);const s=new Jv(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),me.resolve(Wd)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wd):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,a,c,m,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,a=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,c=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,m=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(u=Date.now(),Pi()<=Et.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${r} in `+(c-a)+`ms
	Removed ${i} targets in `+(m-c)+`ms
	Removed ${h} documents in `+(u-m)+`ms
Total Duration: ${u-d}ms`),me.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}function t_(t,e){return new e_(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this.changes=new li(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,zn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?me.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Ro(s.mutation,r,cs.empty(),be.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,_t()).next(()=>s))}getLocalViewOfDocuments(e,n,s=_t()){const r=Xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let a=Co();return i.forEach((c,m)=>{a=a.insert(c,m.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const s=Xr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,_t()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,s,r){let i=er();const a=jo(),c=function(){return jo()}();return n.forEach((m,u)=>{const d=s.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof jr)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),Ro(d.mutation,u,d.mutation.getFieldMask(),be.now())):a.set(u.key,cs.empty())}),this.recalculateAndSaveOverlays(e,i).next(m=>(m.forEach((u,d)=>a.set(u,d)),n.forEach((u,d)=>c.set(u,new s_(d,a.get(u)??null))),c))}recalculateAndSaveOverlays(e,n){const s=jo();let r=new nn((a,c)=>a-c),i=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(m=>{const u=n.get(m);if(u===null)return;let d=s.get(m)||cs.empty();d=c.applyToLocalView(u,d),s.set(m,d);const h=(r.get(c.batchId)||_t()).add(m);r=r.insert(c.batchId,h)})}).next(()=>{const a=[],c=r.getReverseIterator();for(;c.hasNext();){const m=c.getNext(),u=m.key,d=m.value,h=wh();d.forEach(p=>{if(!i.has(p)){const b=jh(n.get(p),s.get(p));b!==null&&h.set(p,b),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return me.waitFor(a)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(a){return Oe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):kh(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):me.resolve(Xr());let c=zo,m=i;return a.next(u=>me.forEach(u,(d,h)=>(c<h.largestBatchId&&(c=h.largestBatchId),i.get(d)?me.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{m=m.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,m,u,_t())).next(d=>({batchId:c,changes:Ch(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Oe(n)).next(s=>{let r=Co();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let a=Co();return this.indexManager.getCollectionParents(e,i).next(c=>me.forEach(c,m=>{const u=function(h,p){return new Zi(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,m.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(a=>{i.forEach((m,u)=>{const d=u.getKey();a.get(d)===null&&(a=a.insert(d,zn.newInvalidDocument(d)))});let c=Co();return a.forEach((m,u)=>{const d=i.get(m);d!==void 0&&Ro(d.mutation,u,cs.empty(),be.now()),Pl(n,u)&&(c=c.insert(m,u))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return me.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Hs(r.createTime)}}(n)),me.resolve()}getNamedQuery(e,n){return me.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:Qv(r.bundledQuery),readTime:Hs(r.readTime)}}(n)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(){this.overlays=new nn(Oe.comparator),this.qr=new Map}getOverlay(e,n){return me.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Xr();return me.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),me.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),me.resolve()}getOverlaysForCollection(e,n,s){const r=Xr(),i=n.length+1,a=new Oe(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const m=c.getNext().value,u=m.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&m.largestBatchId>s&&r.set(m.getKey(),m)}return me.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new nn((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let d=i.get(u.largestBatchId);d===null&&(d=Xr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const c=Xr(),m=i.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((u,d)=>c.set(u,d)),!(c.size()>=r)););return me.resolve(c)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new kv(n,s));let i=this.qr.get(n);i===void 0&&(i=_t(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(){this.Qr=new Sn(jn.$r),this.Ur=new Sn(jn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new jn(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new jn(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new Oe(new Wt([])),s=new jn(n,e),r=new jn(n,e+1),i=[];return this.Ur.forEachInRange([s,r],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Oe(new Wt([])),s=new jn(n,e),r=new jn(n,e+1);let i=_t();return this.Ur.forEachInRange([s,r],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new jn(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class jn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Oe.comparator(e.key,n.key)||vt(e.Yr,n.Yr)}static Kr(e,n){return vt(e.Yr,n.Yr)||Oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Sn(jn.$r)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Dv(i,n,s,r);this.mutationQueue.push(a);for(const c of r)this.Zr=this.Zr.add(new jn(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return me.resolve(a)}lookupMutationBatch(e,n){return me.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return me.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?Im:this.tr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new jn(n,0),r=new jn(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],a=>{const c=this.Xr(a.Yr);i.push(c)}),me.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Sn(vt);return n.forEach(r=>{const i=new jn(r,0),a=new jn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{s=s.add(c.Yr)})}),me.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;Oe.isDocumentKey(i)||(i=i.child(""));const a=new jn(new Oe(i),0);let c=new Sn(vt);return this.Zr.forEachWhile(m=>{const u=m.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(c=c.add(m.Yr)),!0)},a),me.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Bt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return me.forEach(n.mutations,r=>{const i=new jn(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new jn(n,0),r=this.Zr.firstAfterOrEqual(s);return me.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.ri=e,this.docs=function(){return new nn(Oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,a=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return me.resolve(s?s.document.mutableCopy():zn.newInvalidDocument(n))}getEntries(e,n){let s=er();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():zn.newInvalidDocument(r))}),me.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=er();const a=n.path,c=new Oe(a.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(c);for(;m.hasNext();){const{key:u,value:{document:d}}=m.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Bx(Rx(d),s)<=0||(r.has(d.key)||Pl(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return me.resolve(i)}getAllFromCollectionGroup(e,n,s,r){Qe(9500)}ii(e,n){return me.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new m_(this)}getSize(e){return me.resolve(this.size)}}class m_ extends n_{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),me.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.persistence=e,this.si=new li(n=>Tm(n),jm),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.oi=0,this._i=new Mm,this.targetCount=0,this.ai=zi.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),me.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new zi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,me.resolve()}updateTargetData(e,n){return this.Pr(n),me.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=n&&s.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),me.waitFor(i).next(()=>r)}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return me.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),me.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(a=>{i.push(r.markPotentiallyOrphaned(e,a))}),me.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),me.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return me.resolve(s)}containsKey(e,n){return me.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.ui={},this.overlays={},this.ci=new Vl(0),this.li=!1,this.li=!0,this.hi=new a_,this.referenceDelegate=e(this),this.Pi=new u_(this),this.indexManager=new Yv,this.remoteDocumentCache=function(r){return new c_(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new Kv(n),this.Ii=new i_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new o_,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new l_(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){Ve("MemoryPersistence","Starting transaction:",e);const r=new d_(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return me.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class d_ extends Hx{constructor(e){super(),this.currentSequenceNumber=e}}class Fm{constructor(e){this.persistence=e,this.Ri=new Mm,this.Vi=null}static mi(e){return new Fm(e)}get fi(){if(this.Vi)return this.Vi;throw Qe(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),me.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),me.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),me.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.fi,s=>{const r=Oe.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,Je.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return me.or([()=>me.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ul{constructor(e,n){this.persistence=e,this.pi=new li(s=>Ox(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=t_(this,n)}static mi(e,n){return new ul(e,n)}Ei(){}di(e){return me.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return me.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?me.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,n).next(c=>{c||(s++,i.removeEntry(a,Je.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),me.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),me.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=za(e.data.value)),n}br(e,n,s){return me.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return me.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=_t(),r=_t();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Om(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return l0()?8:Mx(o0())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new f_;return this.Ss(e,n,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,a,c.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(Pi()<=Et.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",Li(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),me.resolve()):(Pi()<=Et.DEBUG&&Ve("QueryEngine","Query:",Li(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Pi()<=Et.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",Li(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Us(n))):me.resolve())}ys(e,n){if(jd(n))return me.resolve(null);let s=Us(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Gc(n,null,"F"),s=Us(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const a=_t(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,s).next(m=>{const u=this.Ds(n,c);return this.Cs(n,u,a,m.readTime)?this.ys(e,Gc(n,null,"F")):this.vs(e,u,n,m)}))})))}ws(e,n,s,r){return jd(n)||r.isEqual(Je.min())?me.resolve(null):this.ps.getDocuments(e,s).next(i=>{const a=this.Ds(n,i);return this.Cs(n,a,s,r)?me.resolve(null):(Pi()<=Et.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Li(n)),this.vs(e,a,n,jx(r,zo)).next(c=>c))})}Ds(e,n){let s=new Sn(Eh(e));return n.forEach((r,i)=>{Pl(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Pi()<=Et.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",Li(n)),this.ps.getDocumentsMatchingQuery(e,n,Ar.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="LocalStore",h_=3e8;class g_{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new nn(vt),this.xs=new li(i=>Tm(i),jm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function y_(t,e,n,s){return new g_(t,e,n,s)}async function Yh(t,e){const n=Ge(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const a=[],c=[];let m=_t();for(const u of r){a.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}for(const u of i){c.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}return n.localDocuments.getDocuments(s,m).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:c}))})})}function b_(t,e){const n=Ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,m,u,d){const h=u.batch,p=h.keys();let b=me.resolve();return p.forEach(C=>{b=b.next(()=>d.getEntry(m,C)).next(v=>{const S=u.docVersions.get(C);Bt(S!==null,48541),v.version.compareTo(S)<0&&(h.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(m,h))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(c){let m=_t();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(m=m.add(c.batch.mutations[u].key));return m}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function Gh(t){const e=Ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function N_(t,e){const n=Ge(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const c=[];e.targetChanges.forEach((d,h)=>{const p=r.get(h);if(!p)return;c.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,h)));let b=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?b=b.withResumeToken(On.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):d.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(d.resumeToken,s)),r=r.insert(h,b),function(v,S,B){return v.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=h_?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(p,b,d)&&c.push(n.Pi.updateTargetData(i,b))});let m=er(),u=_t();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),c.push(x_(i,a,e.documentUpdates).next(d=>{m=d.ks,u=d.qs})),!s.isEqual(Je.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(h=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));c.push(d)}return me.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,m,u)).next(()=>m)}).then(i=>(n.Ms=r,i))}function x_(t,e,n){let s=_t(),r=_t();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let a=er();return n.forEach((c,m)=>{const u=i.get(c);m.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),m.isNoDocument()&&m.version.isEqual(Je.min())?(e.removeEntry(c,m.readTime),a=a.insert(c,m)):!u.isValidDocument()||m.version.compareTo(u.version)>0||m.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(m),a=a.insert(c,m)):Ve(qm,"Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",m.version)}),{ks:a,qs:r}})}function v_(t,e){const n=Ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Im),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function __(t,e){const n=Ge(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,me.resolve(r)):n.Pi.allocateTargetId(s).next(a=>(r=new br(e,a,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function tm(t,e,n){const s=Ge(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,a=>s.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Ji(a))throw a;Ve(qm,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Qd(t,e,n){const s=Ge(t);let r=Je.min(),i=_t();return s.persistence.runTransaction("Execute query","readwrite",a=>function(m,u,d){const h=Ge(m),p=h.xs.get(d);return p!==void 0?me.resolve(h.Ms.get(p)):h.Pi.getTargetData(u,d)}(s,a,Us(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,c.targetId).next(m=>{i=m})}).next(()=>s.Fs.getDocumentsMatchingQuery(a,e,n?r:Je.min(),n?i:_t())).next(c=>(D_(s,av(e),c),{documents:c,Qs:i})))}function D_(t,e,n){let s=t.Os.get(e)||Je.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class Yd{constructor(){this.activeTargetIds=fv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class k_{constructor(){this.Mo=new Yd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Yd,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd="ConnectivityMonitor";class Xd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Gd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Gd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ca=null;function nm(){return Ca===null?Ca=function(){return 268435456+Math.round(2147483648*Math.random())}():Ca++,"0x"+Ca.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="RestConnection",E_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class V_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===ol?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const a=nm(),c=this.zo(e,n.toUriEncodedString());Ve(Nc,`Sending RPC '${e}' ${a}:`,c,s);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,r,i);const{host:u}=new URL(c),d=ra(u);return this.Jo(e,c,m,s,d).then(h=>(Ve(Nc,`Received RPC '${e}' ${a}: `,h),h),h=>{throw Oi(Nc,`RPC '${e}' ${a} failed with error: `,h,"url: ",c,"request:",s),h})}Ho(e,n,s,r,i,a){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=E_[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="WebChannelConnection";class w_ extends V_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const a=nm();return new Promise((c,m)=>{const u=new Zp;u.setWithCredentials(!0),u.listenOnce(eh.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Wa.NO_ERROR:const h=u.getResponseJson();Ve(qn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),c(h);break;case Wa.TIMEOUT:Ve(qn,`RPC '${e}' ${a} timed out`),m(new ke(se.DEADLINE_EXCEEDED,"Request time out"));break;case Wa.HTTP_ERROR:const p=u.getStatus();if(Ve(qn,`RPC '${e}' ${a} failed with status:`,p,"response text:",u.getResponseText()),p>0){let b=u.getResponseJson();Array.isArray(b)&&(b=b[0]);const C=b==null?void 0:b.error;if(C&&C.status&&C.message){const v=function(B){const L=B.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(L)>=0?L:se.UNKNOWN}(C.status);m(new ke(v,C.message))}else m(new ke(se.UNKNOWN,"Server responded with status "+u.getStatus()))}else m(new ke(se.UNAVAILABLE,"Connection failed."));break;default:Qe(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ve(qn,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(r);Ve(qn,`RPC '${e}' ${a} sending request:`,r),u.send(n,"POST",d,s,15)})}T_(e,n,s){const r=nm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=sh(),c=nh(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(m.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,s),m.encodeInitMessageHeaders=!0;const d=i.join("");Ve(qn,`Creating RPC '${e}' stream ${r}: ${d}`,m);const h=a.createWebChannel(d,m);this.I_(h);let p=!1,b=!1;const C=new C_({Yo:S=>{b?Ve(qn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(p||(Ve(qn,`Opening RPC '${e}' stream ${r} transport.`),h.open(),p=!0),Ve(qn,`RPC '${e}' stream ${r} sending:`,S),h.send(S))},Zo:()=>h.close()}),v=(S,B,L)=>{S.listen(B,W=>{try{L(W)}catch(ie){setTimeout(()=>{throw ie},0)}})};return v(h,Vo.EventType.OPEN,()=>{b||(Ve(qn,`RPC '${e}' stream ${r} transport opened.`),C.o_())}),v(h,Vo.EventType.CLOSE,()=>{b||(b=!0,Ve(qn,`RPC '${e}' stream ${r} transport closed`),C.a_(),this.E_(h))}),v(h,Vo.EventType.ERROR,S=>{b||(b=!0,Oi(qn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),C.a_(new ke(se.UNAVAILABLE,"The operation could not be completed")))}),v(h,Vo.EventType.MESSAGE,S=>{var B;if(!b){const L=S.data[0];Bt(!!L,16349);const W=L,ie=(W==null?void 0:W.error)||((B=W[0])==null?void 0:B.error);if(ie){Ve(qn,`RPC '${e}' stream ${r} received error:`,ie);const ee=ie.status;let F=function(E){const j=gn[E];if(j!==void 0)return Bh(j)}(ee),A=ie.message;F===void 0&&(F=se.INTERNAL,A="Unknown error status: "+ee+" with message "+ie.message),b=!0,C.a_(new ke(F,A)),h.close()}else Ve(qn,`RPC '${e}' stream ${r} received:`,L),C.u_(L)}}),v(c,th.STAT_EVENT,S=>{S.stat===qc.PROXY?Ve(qn,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===qc.NOPROXY&&Ve(qn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function xc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(t){return new Lv(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&Ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="PersistentStream";class Jh{constructor(e,n,s,r,i,a,c,m){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Xh(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===se.RESOURCE_EXHAUSTED?(Zs(n.toString()),Zs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new ke(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ve(Jd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Ve(Jd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class S_ extends Jh{constructor(e,n,s,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Rv(this.serializer,e),s=function(i){if(!("targetChange"in i))return Je.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Je.min():a.readTime?Hs(a.readTime):Je.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=em(this.serializer),n.addTarget=function(i,a){let c;const m=a.target;if(c=Qc(m)?{documents:Hv(i,m)}:{query:Mv(i,m).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Mh(i,a.resumeToken);const u=Xc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}else if(a.snapshotVersion.compareTo(Je.min())>0){c.readTime=ml(i,a.snapshotVersion.toTimestamp());const u=Xc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);const s=Ov(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=em(this.serializer),n.removeTarget=e,this.q_(n)}}class I_ extends Jh{constructor(e,n,s,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Uv(e.writeResults,e.commitTime),s=Hs(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=em(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Bv(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{}class L_ extends P_{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ke(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,Jc(n,s),r,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ke(se.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,Jc(n,s),r,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ke(se.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class T_{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zs(n),this.aa=!1):Ve("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="RemoteStore";class j_{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{s.enqueueAndForget(async()=>{ci(this)&&(Ve(ri,"Restarting streams for network reachability change."),await async function(m){const u=Ge(m);u.Ea.add(4),await eo(u),u.Ra.set("Unknown"),u.Ea.delete(4),await la(u)}(this))})}),this.Ra=new T_(s,r)}}async function la(t){if(ci(t))for(const e of t.da)await e(!0)}async function eo(t){for(const e of t.da)await e(!1)}function Zh(t,e){const n=Ge(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Km(n)?zm(n):to(n).O_()&&Wm(n,e))}function $m(t,e){const n=Ge(t),s=to(n);n.Ia.delete(e),s.O_()&&eg(n,e),n.Ia.size===0&&(s.O_()?s.L_():ci(n)&&n.Ra.set("Unknown"))}function Wm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}to(t).Y_(e)}function eg(t,e){t.Va.Ue(e),to(t).Z_(e)}function zm(t){t.Va=new wv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),to(t).start(),t.Ra.ua()}function Km(t){return ci(t)&&!to(t).x_()&&t.Ia.size>0}function ci(t){return Ge(t).Ea.size===0}function tg(t){t.Va=void 0}async function R_(t){t.Ra.set("Online")}async function B_(t){t.Ia.forEach((e,n)=>{Wm(t,e)})}async function U_(t,e){tg(t),Km(t)?(t.Ra.ha(e),zm(t)):t.Ra.set("Unknown")}async function H_(t,e,n){if(t.Ra.set("Online"),e instanceof Hh&&e.state===2&&e.cause)try{await async function(r,i){const a=i.cause;for(const c of i.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,a),r.Ia.delete(c),r.Va.removeTarget(c))}(t,e)}catch(s){Ve(ri,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await dl(t,s)}else if(e instanceof Ya?t.Va.Ze(e):e instanceof Uh?t.Va.st(e):t.Va.tt(e),!n.isEqual(Je.min()))try{const s=await Gh(t.localStore);n.compareTo(s)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((m,u)=>{if(m.resumeToken.approximateByteSize()>0){const d=i.Ia.get(u);d&&i.Ia.set(u,d.withResumeToken(m.resumeToken,a))}}),c.targetMismatches.forEach((m,u)=>{const d=i.Ia.get(m);if(!d)return;i.Ia.set(m,d.withResumeToken(On.EMPTY_BYTE_STRING,d.snapshotVersion)),eg(i,m);const h=new br(d.target,m,u,d.sequenceNumber);Wm(i,h)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(s){Ve(ri,"Failed to raise snapshot:",s),await dl(t,s)}}async function dl(t,e,n){if(!Ji(e))throw e;t.Ea.add(1),await eo(t),t.Ra.set("Offline"),n||(n=()=>Gh(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ve(ri,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await la(t)})}function ng(t,e){return e().catch(n=>dl(t,n,e))}async function Ul(t){const e=Ge(t),n=wr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Im;for(;M_(e);)try{const r=await v_(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,F_(e,r)}catch(r){await dl(e,r)}sg(e)&&rg(e)}function M_(t){return ci(t)&&t.Ta.length<10}function F_(t,e){t.Ta.push(e);const n=wr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function sg(t){return ci(t)&&!wr(t).x_()&&t.Ta.length>0}function rg(t){wr(t).start()}async function O_(t){wr(t).ra()}async function q_(t){const e=wr(t);for(const n of t.Ta)e.ea(n.mutations)}async function $_(t,e,n){const s=t.Ta.shift(),r=Bm.from(s,e,n);await ng(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Ul(t)}async function W_(t,e){e&&wr(t).X_&&await async function(s,r){if(function(a){return Ev(a)&&a!==se.ABORTED}(r.code)){const i=s.Ta.shift();wr(s).B_(),await ng(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ul(s)}}(t,e),sg(t)&&rg(t)}async function Zd(t,e){const n=Ge(t);n.asyncQueue.verifyOperationInProgress(),Ve(ri,"RemoteStore received new credentials");const s=ci(n);n.Ea.add(3),await eo(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await la(n)}async function z_(t,e){const n=Ge(t);e?(n.Ea.delete(2),await la(n)):e||(n.Ea.add(2),await eo(n),n.Ra.set("Unknown"))}function to(t){return t.ma||(t.ma=function(n,s,r){const i=Ge(n);return i.sa(),new S_(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:R_.bind(null,t),t_:B_.bind(null,t),r_:U_.bind(null,t),H_:H_.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Km(t)?zm(t):t.Ra.set("Unknown")):(await t.ma.stop(),tg(t))})),t.ma}function wr(t){return t.fa||(t.fa=function(n,s,r){const i=Ge(n);return i.sa(),new I_(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:O_.bind(null,t),r_:W_.bind(null,t),ta:q_.bind(null,t),na:$_.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ul(t)):(await t.fa.stop(),t.Ta.length>0&&(Ve(ri,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const a=Date.now()+s,c=new Qm(e,n,a,r,i);return c.start(s),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ym(t,e){if(Zs("AsyncQueue",`${e}: ${t}`),Ji(t))return new ke(se.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{static emptySet(e){return new Mi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Oe.comparator(n.key,s.key):(n,s)=>Oe.comparator(n.key,s.key),this.keyedMap=Co(),this.sortedSet=new nn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Mi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(){this.ga=new nn(Oe.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Qe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class Ki{constructor(e,n,s,r,i,a,c,m,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=m,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new Ki(e,n,Mi.emptySet(n),a,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Il(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Q_{constructor(){this.queries=tf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=Ge(n),i=r.queries;r.queries=tf(),i.forEach((a,c)=>{for(const m of c.Sa)m.onError(s)})})(this,new ke(se.ABORTED,"Firestore shutting down"))}}function tf(){return new li(t=>Ah(t),Il)}async function Gm(t,e){const n=Ge(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new K_,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const c=Ym(a,`Initialization of query '${Li(e.query)}' failed`);return void e.onError(c)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Jm(n)}async function Xm(t,e){const n=Ge(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function Y_(t,e){const n=Ge(t);let s=!1;for(const r of e){const i=r.query,a=n.queries.get(i);if(a){for(const c of a.Sa)c.Fa(r)&&(s=!0);a.wa=r}}s&&Jm(n)}function G_(t,e,n){const s=Ge(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function Jm(t){t.Ca.forEach(e=>{e.next()})}var sm,nf;(nf=sm||(sm={})).Ma="default",nf.Cache="cache";class Zm{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Ki(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e){this.key=e}}class og{constructor(e){this.key=e}}class X_{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=Eh(e),this.tu=new Mi(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new ef,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,a=r,c=!1;const m=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,h)=>{const p=r.get(d),b=Pl(this.query,h)?h:null,C=!!p&&this.mutatedKeys.has(p.key),v=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;p&&b?p.data.isEqual(b.data)?C!==v&&(s.track({type:3,doc:b}),S=!0):this.su(p,b)||(s.track({type:2,doc:b}),S=!0,(m&&this.eu(b,m)>0||u&&this.eu(b,u)<0)&&(c=!0)):!p&&b?(s.track({type:0,doc:b}),S=!0):p&&!b&&(s.track({type:1,doc:p}),S=!0,(m||u)&&(c=!0)),S&&(b?(a=a.add(b),i=v?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:a,iu:s,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((d,h)=>function(b,C){const v=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qe(20277,{Rt:S})}};return v(b)-v(C)}(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(s),r=r??!1;const c=n&&!r?this._u():[],m=this.Xa.size===0&&this.current&&!r?1:0,u=m!==this.Za;return this.Za=m,a.length!==0||u?{snapshot:new Ki(this.query,e.tu,i,a,e.mutatedKeys,m===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ef,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new og(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new ig(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=_t();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ki.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const eu="SyncEngine";class J_{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class Z_{constructor(e){this.key=e,this.hu=!1}}class eD{constructor(e,n,s,r,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new li(c=>Ah(c),Il),this.Iu=new Map,this.Eu=new Set,this.du=new nn(Oe.comparator),this.Au=new Map,this.Ru=new Mm,this.Vu={},this.mu=new Map,this.fu=zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function tD(t,e,n=!0){const s=dg(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await ag(s,e,n,!0),r}async function nD(t,e){const n=dg(t);await ag(n,e,!0,!1)}async function ag(t,e,n,s){const r=await __(t.localStore,Us(e)),i=r.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return s&&(c=await sD(t,e,i,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&Zh(t.remoteStore,r),c}async function sD(t,e,n,s,r){t.pu=(h,p,b)=>async function(v,S,B,L){let W=S.view.ru(B);W.Cs&&(W=await Qd(v.localStore,S.query,!1).then(({documents:A})=>S.view.ru(A,W)));const ie=L&&L.targetChanges.get(S.targetId),ee=L&&L.targetMismatches.get(S.targetId)!=null,F=S.view.applyChanges(W,v.isPrimaryClient,ie,ee);return rf(v,S.targetId,F.au),F.snapshot}(t,h,p,b);const i=await Qd(t.localStore,e,!0),a=new X_(e,i.Qs),c=a.ru(i.documents),m=aa.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=a.applyChanges(c,t.isPrimaryClient,m);rf(t,n,u.au);const d=new J_(e,n,a);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function rD(t,e,n){const s=Ge(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(a=>!Il(a,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await tm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&$m(s.remoteStore,r.targetId),rm(s,r.targetId)}).catch(Xi)):(rm(s,r.targetId),await tm(s.localStore,r.targetId,!0))}async function iD(t,e){const n=Ge(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),$m(n.remoteStore,s.targetId))}async function oD(t,e,n){const s=fD(t);try{const r=await function(a,c){const m=Ge(a),u=be.now(),d=c.reduce((b,C)=>b.add(C.key),_t());let h,p;return m.persistence.runTransaction("Locally write mutations","readwrite",b=>{let C=er(),v=_t();return m.Ns.getEntries(b,d).next(S=>{C=S,C.forEach((B,L)=>{L.isValidDocument()||(v=v.add(B))})}).next(()=>m.localDocuments.getOverlayedDocuments(b,C)).next(S=>{h=S;const B=[];for(const L of c){const W=vv(L,h.get(L.key).overlayedDocument);W!=null&&B.push(new jr(L.key,W,yh(W.value.mapValue),es.exists(!0)))}return m.mutationQueue.addMutationBatch(b,u,B,c)}).next(S=>{p=S;const B=S.applyToLocalDocumentSet(h,v);return m.documentOverlayCache.saveOverlays(b,S.batchId,B)})}).then(()=>({batchId:p.batchId,changes:Ch(h)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(a,c,m){let u=a.Vu[a.currentUser.toKey()];u||(u=new nn(vt)),u=u.insert(c,m),a.Vu[a.currentUser.toKey()]=u}(s,r.batchId,n),await ca(s,r.changes),await Ul(s.remoteStore)}catch(r){const i=Ym(r,"Failed to persist write");n.reject(i)}}async function lg(t,e){const n=Ge(t);try{const s=await N_(n.localStore,e);e.targetChanges.forEach((r,i)=>{const a=n.Au.get(i);a&&(Bt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Bt(a.hu,14607):r.removedDocuments.size>0&&(Bt(a.hu,42227),a.hu=!1))}),await ca(n,s,e)}catch(s){await Xi(s)}}function sf(t,e,n){const s=Ge(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){const m=Ge(a);m.onlineState=c;let u=!1;m.queries.forEach((d,h)=>{for(const p of h.Sa)p.va(c)&&(u=!0)}),u&&Jm(m)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function aD(t,e,n){const s=Ge(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let a=new nn(Oe.comparator);a=a.insert(i,zn.newNoDocument(i,Je.min()));const c=_t().add(i),m=new Rl(Je.min(),new Map,new nn(vt),a,c);await lg(s,m),s.du=s.du.remove(i),s.Au.delete(e),tu(s)}else await tm(s.localStore,e,!1).then(()=>rm(s,e,n)).catch(Xi)}async function lD(t,e){const n=Ge(t),s=e.batch.batchId;try{const r=await b_(n.localStore,e);mg(n,s,null),cg(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await ca(n,r)}catch(r){await Xi(r)}}async function cD(t,e,n){const s=Ge(t);try{const r=await function(a,c){const m=Ge(a);return m.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return m.mutationQueue.lookupMutationBatch(u,c).next(h=>(Bt(h!==null,37113),d=h.keys(),m.mutationQueue.removeMutationBatch(u,h))).next(()=>m.mutationQueue.performConsistencyCheck(u)).next(()=>m.documentOverlayCache.removeOverlaysForBatchId(u,d,c)).next(()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>m.localDocuments.getDocuments(u,d))})}(s.localStore,e);mg(s,e,n),cg(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await ca(s,r)}catch(r){await Xi(r)}}function cg(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function mg(t,e,n){const s=Ge(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function rm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||ug(t,s)})}function ug(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&($m(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),tu(t))}function rf(t,e,n){for(const s of n)s instanceof ig?(t.Ru.addReference(s.key,e),mD(t,s)):s instanceof og?(Ve(eu,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||ug(t,s.key)):Qe(19791,{wu:s})}function mD(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(Ve(eu,"New document in limbo: "+n),t.Eu.add(s),tu(t))}function tu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Oe(Wt.fromString(e)),s=t.fu.next();t.Au.set(s,new Z_(n)),t.du=t.du.insert(n,s),Zh(t.remoteStore,new br(Us(Sl(n.path)),s,"TargetPurposeLimboResolution",Vl.ce))}}async function ca(t,e,n){const s=Ge(t),r=[],i=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach((c,m)=>{a.push(s.pu(m,e,n).then(u=>{var d;if((u||n)&&s.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(m.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(m.targetId,h?"current":"not-current")}if(u){r.push(u);const h=Om.As(m.targetId,u);i.push(h)}}))}),await Promise.all(a),s.Pu.H_(r),await async function(m,u){const d=Ge(m);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>me.forEach(u,p=>me.forEach(p.Es,b=>d.persistence.referenceDelegate.addReference(h,p.targetId,b)).next(()=>me.forEach(p.ds,b=>d.persistence.referenceDelegate.removeReference(h,p.targetId,b)))))}catch(h){if(!Ji(h))throw h;Ve(qm,"Failed to update sequence numbers: "+h)}for(const h of u){const p=h.targetId;if(!h.fromCache){const b=d.Ms.get(p),C=b.snapshotVersion,v=b.withLastLimboFreeSnapshotVersion(C);d.Ms=d.Ms.insert(p,v)}}}(s.localStore,i))}async function uD(t,e){const n=Ge(t);if(!n.currentUser.isEqual(e)){Ve(eu,"User change. New user:",e.toKey());const s=await Yh(n.localStore,e);n.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(m=>{m.reject(new ke(se.CANCELLED,a))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ca(n,s.Ls)}}function dD(t,e){const n=Ge(t),s=n.Au.get(e);if(s&&s.hu)return _t().add(s.key);{let r=_t();const i=n.Iu.get(e);if(!i)return r;for(const a of i){const c=n.Tu.get(a);r=r.unionWith(c.view.nu)}return r}}function dg(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=lg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aD.bind(null,e),e.Pu.H_=Y_.bind(null,e.eventManager),e.Pu.yu=G_.bind(null,e.eventManager),e}function fD(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cD.bind(null,e),e}class fl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return y_(this.persistence,new p_,e.initialUser,this.serializer)}Cu(e){return new Qh(Fm.mi,this.serializer)}Du(e){return new k_}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fl.provider={build:()=>new fl};class pD extends fl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Bt(this.persistence.referenceDelegate instanceof ul,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Zv(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?rs.withCacheSize(this.cacheSizeBytes):rs.DEFAULT;return new Qh(s=>ul.mi(s,n),this.serializer)}}class im{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>sf(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=uD.bind(null,this.syncEngine),await z_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Q_}()}createDatastore(e){const n=Bl(e.databaseInfo.databaseId),s=function(i){return new w_(i)}(e.databaseInfo);return function(i,a,c,m){return new L_(i,a,c,m)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,a,c){return new j_(s,r,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>sf(this.syncEngine,n,0),function(){return Xd.v()?new Xd:new A_}())}createSyncEngine(e,n){return function(r,i,a,c,m,u,d){const h=new eD(r,i,a,c,m,u);return d&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=Ge(r);Ve(ri,"RemoteStore shutting down."),i.Ea.add(5),await eo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}im.provider={build:()=>new im};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr="FirestoreClient";class hD{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Wn.UNAUTHENTICATED,this.clientId=Sm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async a=>{Ve(Sr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(s,a=>(Ve(Sr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Ym(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function vc(t,e){t.asyncQueue.verifyOperationInProgress(),Ve(Sr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Yh(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function of(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fg(t);Ve(Sr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Zd(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>Zd(e.remoteStore,r)),t._onlineComponents=e}async function fg(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ve(Sr,"Using user provided OfflineComponentProvider");try{await vc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Oi("Error using user provided cache. Falling back to memory cache: "+n),await vc(t,new fl)}}else Ve(Sr,"Using default OfflineComponentProvider"),await vc(t,new pD(void 0));return t._offlineComponents}async function su(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ve(Sr,"Using user provided OnlineComponentProvider"),await of(t,t._uninitializedComponentsProvider._online)):(Ve(Sr,"Using default OnlineComponentProvider"),await of(t,new im))),t._onlineComponents}function pg(t){return fg(t).then(e=>e.persistence)}function hg(t){return su(t).then(e=>e.remoteStore)}function gD(t){return su(t).then(e=>e.syncEngine)}async function pl(t){const e=await su(t),n=e.eventManager;return n.onListen=tD.bind(null,e.syncEngine),n.onUnlisten=rD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=nD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=iD.bind(null,e.syncEngine),n}function yD(t){return t.asyncQueue.enqueue(async()=>{const e=await pg(t),n=await hg(t);return e.setNetworkEnabled(!0),function(r){const i=Ge(r);return i.Ea.delete(0),la(i)}(n)})}function bD(t){return t.asyncQueue.enqueue(async()=>{const e=await pg(t),n=await hg(t);return e.setNetworkEnabled(!1),async function(r){const i=Ge(r);i.Ea.add(0),await eo(i),i.Ra.set("Offline")}(n)})}function ND(t,e,n={}){const s=new Gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new nu({next:p=>{d.Nu(),a.enqueueAndForget(()=>Xm(i,h));const b=p.docs.has(c);!b&&p.fromCache?u.reject(new ke(se.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&p.fromCache&&m&&m.source==="server"?u.reject(new ke(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new Zm(Sl(c.path),d,{includeMetadataChanges:!0,qa:!0});return Gm(i,h)}(await pl(t),t.asyncQueue,e,n,s)),s.promise}function gg(t,e,n={}){const s=new Gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new nu({next:p=>{d.Nu(),a.enqueueAndForget(()=>Xm(i,h)),p.fromCache&&m.source==="server"?u.reject(new ke(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new Zm(c,d,{includeMetadataChanges:!0,qa:!0});return Gm(i,h)}(await pl(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg="firestore.googleapis.com",lf=!0;class cf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ke(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bg,this.ssl=lf}else this.host=e.host,this.ssl=e.ssl??lf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Kh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Xv)throw new ke(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yg(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ke(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ke(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ke(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hl{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new kx;switch(s.type){case"firstParty":return new Cx(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ke(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=af.get(n);s&&(Ve("ComponentProvider","Removing Datastore"),af.delete(n),s.terminate())}(this),Promise.resolve()}}function xD(t,e,n,s={}){var u;t=wn(t,Hl);const r=ra(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;r&&(Up(`https://${c}`),Mp("Firestore",!0)),i.host!==bg&&i.host!==c&&Oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...i,host:c,ssl:r,emulatorOptions:s};if(!rl(m,a)&&(t._setSettings(m),s.mockUserToken)){let d,h;if(typeof s.mockUserToken=="string")d=s.mockUserToken,h=Wn.MOCK_USER;else{d=Hp(s.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new ke(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Wn(p)}t._authCredentials=new Ax(new ih(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new tr(this.firestore,e,this._query)}}class on{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}toJSON(){return{type:on._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(ia(n,on._jsonSchema))return new on(e,s||null,new Oe(Wt.fromString(n.referencePath)))}}on._jsonSchemaVersion="firestore/documentReference/1.0",on._jsonSchema={type:vn("string",on._jsonSchemaVersion),referencePath:vn("string")};class Dr extends tr{constructor(e,n,s){super(e,n,Sl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Oe(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function Fe(t,e,...n){if(t=Fn(t),oh("collection","path",e),t instanceof Hl){const s=Wt.fromString(e,...n);return vd(s),new Dr(t,null,s)}{if(!(t instanceof on||t instanceof Dr))throw new ke(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Wt.fromString(e,...n));return vd(s),new Dr(t.firestore,null,s)}}function Ce(t,e,...n){if(t=Fn(t),arguments.length===1&&(e=Sm.newId()),oh("doc","path",e),t instanceof Hl){const s=Wt.fromString(e,...n);return xd(s),new on(t,null,new Oe(s))}{if(!(t instanceof on||t instanceof Dr))throw new ke(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Wt.fromString(e,...n));return xd(s),new on(t.firestore,t instanceof Dr?t.converter:null,new Oe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="AsyncQueue";class uf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Xh(this,"async_queue_retry"),this._c=()=>{const s=xc();s&&Ve(mf,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=xc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=xc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Gs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ji(e))throw e;Ve(mf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Zs("INTERNAL UNHANDLED ERROR: ",df(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Qm.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Qe(47125,{Pc:df(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function df(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class us extends Hl{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new uf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uf(e),this._firestoreClient=void 0,await e}}}function vD(t,e){const n=typeof t=="object"?t:Yp(),s=typeof t=="string"?t:ol,r=Wp(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Rp("firestore");i&&xD(r,...i)}return r}function Rr(t){if(t._terminated)throw new ke(se.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||_D(t),t._firestoreClient}function _D(t){var s,r,i;const e=t._freezeSettings(),n=function(c,m,u,d){return new Wx(c,m,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,yg(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new hD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const m=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(m),_online:m}}(t._componentsProvider))}function DD(t){return yD(Rr(t=wn(t,us)))}function kD(t){return bD(Rr(t=wn(t,us)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ys(On.fromBase64String(e))}catch(n){throw new ke(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ys(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ys._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ia(e,ys._jsonSchema))return ys.fromBase64String(e.bytes)}}ys._jsonSchemaVersion="firestore/bytes/1.0",ys._jsonSchema={type:vn("string",ys._jsonSchemaVersion),bytes:vn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ke(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ke(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ke(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ms._jsonSchemaVersion}}static fromJSON(e){if(ia(e,Ms._jsonSchema))return new Ms(e.latitude,e.longitude)}}Ms._jsonSchemaVersion="firestore/geoPoint/1.0",Ms._jsonSchema={type:vn("string",Ms._jsonSchemaVersion),latitude:vn("number"),longitude:vn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ia(e,Fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Fs(e.vectorValues);throw new ke(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fs._jsonSchemaVersion="firestore/vectorValue/1.0",Fs._jsonSchema={type:vn("string",Fs._jsonSchemaVersion),vectorValues:vn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=/^__.*__$/;class ED{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new jr(e,this.data,this.fieldMask,n,this.fieldTransforms):new oa(e,this.data,n,this.fieldTransforms)}}class Ng{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new jr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function xg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qe(40011,{Ac:t})}}class ru{constructor(e,n,s,r,i,a){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ru({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return hl(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(xg(this.Ac)&&AD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class VD{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Bl(e)}Cc(e,n,s,r=!1){return new ru({Ac:e,methodName:n,Dc:s,path:Mn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ua(t){const e=t._freezeSettings(),n=Bl(t._databaseId);return new VD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function iu(t,e,n,s,r,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);au("Data must be an object, but it was:",a,s);const c=Dg(s,a);let m,u;if(i.merge)m=new cs(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const p=om(e,h,n);if(!a.contains(p))throw new ke(se.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Ag(d,p)||d.push(p)}m=new cs(d),u=a.fieldTransforms.filter(h=>m.covers(h.field))}else m=null,u=a.fieldTransforms;return new ED(new os(c),m,u)}class Fl extends Ml{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fl}}class ou extends Ml{_toFieldTransform(e){return new yv(e.path,new Xo)}isEqual(e){return e instanceof ou}}function vg(t,e,n,s){const r=t.Cc(1,e,n);au("Data must be an object, but it was:",r,s);const i=[],a=os.empty();Tr(s,(m,u)=>{const d=lu(e,m,n);u=Fn(u);const h=r.yc(d);if(u instanceof Fl)i.push(d);else{const p=da(u,h);p!=null&&(i.push(d),a.set(d,p))}});const c=new cs(i);return new Ng(a,c,r.fieldTransforms)}function _g(t,e,n,s,r,i){const a=t.Cc(1,e,n),c=[om(e,s,n)],m=[r];if(i.length%2!=0)throw new ke(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)c.push(om(e,i[p])),m.push(i[p+1]);const u=[],d=os.empty();for(let p=c.length-1;p>=0;--p)if(!Ag(u,c[p])){const b=c[p];let C=m[p];C=Fn(C);const v=a.yc(b);if(C instanceof Fl)u.push(b);else{const S=da(C,v);S!=null&&(u.push(b),d.set(b,S))}}const h=new cs(u);return new Ng(d,h,a.fieldTransforms)}function CD(t,e,n,s=!1){return da(n,t.Cc(s?4:3,e))}function da(t,e){if(kg(t=Fn(t)))return au("Unsupported field value:",e,t),Dg(t,e);if(t instanceof Ml)return function(s,r){if(!xg(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let a=0;for(const c of s){let m=da(c,r.wc(a));m==null&&(m={nullValue:"NULL_VALUE"}),i.push(m),a++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Fn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return pv(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=be.fromDate(s);return{timestampValue:ml(r.serializer,i)}}if(s instanceof be){const i=new be(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ml(r.serializer,i)}}if(s instanceof Ms)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ys)return{bytesValue:Mh(r.serializer,s._byteString)};if(s instanceof on){const i=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(i))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Hm(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Fs)return function(a,c){return{mapValue:{fields:{[hh]:{stringValue:gh},[al]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Sc("VectorValues must only contain numeric values.");return Rm(c.serializer,u)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${El(s)}`)}(t,e)}function Dg(t,e){const n={};return ch(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Tr(t,(s,r)=>{const i=da(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function kg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof be||t instanceof Ms||t instanceof ys||t instanceof on||t instanceof Ml||t instanceof Fs)}function au(t,e,n){if(!kg(n)||!ah(n)){const s=El(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function om(t,e,n){if((e=Fn(e))instanceof ma)return e._internalPath;if(typeof e=="string")return lu(t,e);throw hl("Field path arguments must be of type string or ",t,!1,void 0,n)}const wD=new RegExp("[~\\*/\\[\\]]");function lu(t,e,n){if(e.search(wD)>=0)throw hl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ma(...e.split("."))._internalPath}catch{throw hl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function hl(t,e,n,s,r){const i=s&&!s.isEmpty(),a=r!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let m="";return(i||a)&&(m+=" (found",i&&(m+=` in field ${s}`),a&&(m+=` in document ${r}`),m+=")"),new ke(se.INVALID_ARGUMENT,c+t+m)}function Ag(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ol("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SD extends Eg{data(){return super.data()}}function Ol(t,e){return typeof e=="string"?lu(t,e):e instanceof ma?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ke(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cu{}class Cg extends cu{}function xt(t,e,...n){let s=[];e instanceof cu&&s.push(e),s=s.concat(n),function(i){const a=i.filter(m=>m instanceof mu).length,c=i.filter(m=>m instanceof ql).length;if(a>1||a>0&&c>0)throw new ke(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class ql extends Cg{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new ql(e,n,s)}_apply(e){const n=this._parse(e);return wg(e._query,n),new tr(e.firestore,e.converter,Yc(e._query,n))}_parse(e){const n=ua(e.firestore);return function(i,a,c,m,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ke(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){hf(h,d);const C=[];for(const v of h)C.push(pf(m,i,v));p={arrayValue:{values:C}}}else p=pf(m,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||hf(h,d),p=CD(c,a,h,d==="in"||d==="not-in");return xn.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Rn(t,e,n){const s=e,r=Ol("where",t);return ql._create(r,s,n)}class mu extends cu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new mu(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:Es.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const m of c)wg(a,m),a=Yc(a,m)}(e._query,n),new tr(e.firestore,e.converter,Yc(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uu extends Cg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new uu(e,n)}_apply(e){const n=function(r,i,a){if(r.startAt!==null)throw new ke(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ke(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Go(i,a)}(e._query,this._field,this._direction);return new tr(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Zi(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function an(t,e="asc"){const n=e,s=Ol("orderBy",t);return uu._create(s,n)}function pf(t,e,n){if(typeof(n=Fn(n))=="string"){if(n==="")throw new ke(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kh(e)&&n.indexOf("/")!==-1)throw new ke(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(Wt.fromString(n));if(!Oe.isDocumentKey(s))throw new ke(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return wd(t,new Oe(s))}if(n instanceof on)return wd(t,n._key);throw new ke(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${El(n)}.`)}function hf(t,e){if(!Array.isArray(t)||t.length===0)throw new ke(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wg(t,e){const n=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ke(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ID{convertValue(e,n="none"){switch(Cr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Qe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Tr(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var s,r,i;const n=(i=(r=(s=e.fields)==null?void 0:s[al].arrayValue)==null?void 0:r.values)==null?void 0:i.map(a=>dn(a.doubleValue));return new Fs(n)}convertGeoPoint(e){return new Ms(dn(e.latitude),dn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=wl(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Ko(e));default:return null}}convertTimestamp(e){const n=Er(e);return new be(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Wt.fromString(e);Bt(zh(s),9688,{name:e});const r=new Qo(s.get(1),s.get(3)),i=new Oe(s.popFirst(5));return r.isEqual(n)||Zs(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class So{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zr extends Eg{constructor(e,n,s,r,i,a){super(e,n,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Ol("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Zr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Zr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zr._jsonSchema={type:vn("string",Zr._jsonSchemaVersion),bundleSource:vn("string","DocumentSnapshot"),bundleName:vn("string"),bundle:vn("string")};class Ga extends Zr{data(e={}){return super.data(e)}}class kr{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new So(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Ga(this._firestore,this._userDataWriter,s.key,s,new So(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ke(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new So(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:m,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new So(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,d=-1;return c.type!==0&&(u=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:PD(c.type),doc:m,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=kr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(t){t=wn(t,on);const e=wn(t.firestore,us);return ND(Rr(e),t._key).then(n=>Sg(e,t,n))}kr._jsonSchemaVersion="firestore/querySnapshot/1.0",kr._jsonSchema={type:vn("string",kr._jsonSchemaVersion),bundleSource:vn("string","QuerySnapshot"),bundleName:vn("string"),bundle:vn("string")};class $l extends ID{constructor(e){super(),this.firestore=e}convertBytes(e){return new ys(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,n)}}function Vt(t){t=wn(t,tr);const e=wn(t.firestore,us),n=Rr(e),s=new $l(e);return Vg(t._query),gg(n,t._query).then(r=>new kr(e,s,t,r))}function LD(t){t=wn(t,tr);const e=wn(t.firestore,us),n=Rr(e),s=new $l(e);return gg(n,t._query,{source:"server"}).then(r=>new kr(e,s,t,r))}function ii(t,e,n){t=wn(t,on);const s=wn(t.firestore,us),r=du(t.converter,e,n);return fa(s,[iu(ua(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,es.none())])}function Rt(t,e,n,...s){t=wn(t,on);const r=wn(t.firestore,us),i=ua(r);let a;return a=typeof(e=Fn(e))=="string"||e instanceof ma?_g(i,"updateDoc",t._key,e,n,s):vg(i,"updateDoc",t._key,e),fa(r,[a.toMutation(t._key,es.exists(!0))])}function Hn(t){return fa(wn(t.firestore,us),[new jl(t._key,es.none())])}function Os(t,e){const n=wn(t.firestore,us),s=Ce(t),r=du(t.converter,e);return fa(n,[iu(ua(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,es.exists(!1))]).then(()=>s)}function ds(t,...e){var m,u,d;t=Fn(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||ff(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(ff(e[s])){const h=e[s];e[s]=(m=h.next)==null?void 0:m.bind(h),e[s+1]=(u=h.error)==null?void 0:u.bind(h),e[s+2]=(d=h.complete)==null?void 0:d.bind(h)}let i,a,c;if(t instanceof on)a=wn(t.firestore,us),c=Sl(t._key.path),i={next:h=>{e[s]&&e[s](Sg(a,t,h))},error:e[s+1],complete:e[s+2]};else{const h=wn(t,tr);a=wn(h.firestore,us),c=h._query;const p=new $l(a);i={next:b=>{e[s]&&e[s](new kr(a,p,h,b))},error:e[s+1],complete:e[s+2]},Vg(t._query)}return function(p,b,C,v){const S=new nu(v),B=new Zm(b,S,C);return p.asyncQueue.enqueueAndForget(async()=>Gm(await pl(p),B)),()=>{S.Nu(),p.asyncQueue.enqueueAndForget(async()=>Xm(await pl(p),B))}}(Rr(a),c,r,i)}function fa(t,e){return function(s,r){const i=new Gs;return s.asyncQueue.enqueueAndForget(async()=>oD(await gD(s),r,i)),i.promise}(Rr(t),e)}function Sg(t,e,n){const s=n.docs.get(e._key),r=new $l(t);return new Zr(t,r,e._key,s,new So(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ua(e)}set(e,n,s){this._verifyNotCommitted();const r=_c(e,this._firestore),i=du(r.converter,n,s),a=iu(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(a.toMutation(r._key,es.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=_c(e,this._firestore);let a;return a=typeof(n=Fn(n))=="string"||n instanceof ma?_g(this._dataReader,"WriteBatch.update",i._key,n,s,r):vg(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,es.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=_c(e,this._firestore);return this._mutations=this._mutations.concat(new jl(n._key,es.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ke(se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _c(t,e){if((t=Fn(t)).firestore!==e)throw new ke(se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function rn(){return new ou("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(t){return Rr(t=wn(t,us)),new TD(t,e=>fa(t,e))}(function(e,n=!0){(function(r){Gi=r})(Kp),$o(new Fi("firestore",(s,{instanceIdentifier:r,options:i})=>{const a=s.getProvider("app").getImmediate(),c=new us(new Ex(s.getProvider("auth-internal")),new wx(a,s.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ke(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(u.options.projectId,d)}(a,r),a);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),vr(gd,yd,e),vr(gd,yd,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="firebasestorage.googleapis.com",Pg="storageBucket",RD=2*60*1e3,BD=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn extends ai{constructor(e,n,s=0){super(Dc(e),`Firebase Storage: ${n} (${Dc(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ln;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ln||(ln={}));function Dc(t){return"storage/"+t}function fu(){const t="An unknown error occurred, please check the error payload for server response.";return new cn(ln.UNKNOWN,t)}function UD(t){return new cn(ln.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function HD(t){return new cn(ln.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function MD(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new cn(ln.UNAUTHENTICATED,t)}function FD(){return new cn(ln.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function OD(t){return new cn(ln.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function qD(){return new cn(ln.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $D(){return new cn(ln.CANCELED,"User canceled the upload/download.")}function WD(t){return new cn(ln.INVALID_URL,"Invalid URL '"+t+"'.")}function zD(t){return new cn(ln.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function KD(){return new cn(ln.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Pg+"' property when initializing the app?")}function QD(){return new cn(ln.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YD(){return new cn(ln.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function GD(t){return new cn(ln.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function am(t){return new cn(ln.INVALID_ARGUMENT,t)}function Lg(){return new cn(ln.APP_DELETED,"The Firebase app was deleted.")}function XD(t){return new cn(ln.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bo(t,e){return new cn(ln.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function fo(t){throw new cn(ln.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=ms.makeFromUrl(e,n)}catch{return new ms(e,"")}if(s.path==="")return s;throw zD(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+r+a,"i"),m={bucket:1,path:3};function u(ie){ie.path_=decodeURIComponent(ie.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",b=new RegExp(`^https?://${h}/${d}/b/${r}/o${p}`,"i"),C={bucket:1,path:3},v=n===Ig?"(?:storage.googleapis.com|storage.cloud.google.com)":n,S="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${S}`,"i"),W=[{regex:c,indices:m,postModify:i},{regex:b,indices:C,postModify:u},{regex:B,indices:{bucket:1,path:2},postModify:u}];for(let ie=0;ie<W.length;ie++){const ee=W[ie],F=ee.regex.exec(e);if(F){const A=F[ee.indices.bucket];let x=F[ee.indices.path];x||(x=""),s=new ms(A,x),ee.postModify(s);break}}if(s==null)throw WD(e);return s}}class JD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(t,e,n){let s=1,r=null,i=null,a=!1,c=0;function m(){return c===2}let u=!1;function d(...S){u||(u=!0,e.apply(null,S))}function h(S){r=setTimeout(()=>{r=null,t(b,m())},S)}function p(){i&&clearTimeout(i)}function b(S,...B){if(u){p();return}if(S){p(),d.call(null,S,...B);return}if(m()||a){p(),d.call(null,S,...B);return}s<64&&(s*=2);let W;c===1?(c=2,W=0):W=(s+Math.random())*1e3,h(W)}let C=!1;function v(S){C||(C=!0,p(),!u&&(r!==null?(S||(c=2),clearTimeout(r),h(0)):S||(c=1)))}return h(0),i=setTimeout(()=>{a=!0,v(!0)},n),v}function ek(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(t){return t!==void 0}function nk(t){return typeof t=="object"&&!Array.isArray(t)}function pu(t){return typeof t=="string"||t instanceof String}function gf(t){return hu()&&t instanceof Blob}function hu(){return typeof Blob<"u"}function yf(t,e,n,s){if(s<e)throw am(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw am(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function Tg(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var ei;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ei||(ei={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,n,s,r,i,a,c,m,u,d,h,p=!0,b=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=m,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,v)=>{this.resolve_=C,this.reject_=v,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new wa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const m=c.loaded,u=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===ei.NO_ERROR,m=i.getStatus();if(!c||sk(m,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ei.ABORT;s(!1,new wa(!1,null,d));return}const u=this.successCodes_.indexOf(m)!==-1;s(!0,new wa(u,i))})},n=(s,r)=>{const i=this.resolve_,a=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const m=this.callback_(c,c.getResponse());tk(m)?i(m):i()}catch(m){a(m)}else if(c!==null){const m=fu();m.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,m)):a(m)}else if(r.canceled){const m=this.appDelete_?Lg():$D();a(m)}else{const m=qD();a(m)}};this.canceled_?n(!1,new wa(!1,null,!0)):this.backoffId_=ZD(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ek(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wa{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function ik(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function ok(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ak(t,e){e&&(t["X-Firebase-GMPID"]=e)}function lk(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ck(t,e,n,s,r,i,a=!0,c=!1){const m=Tg(t.urlParams),u=t.url+m,d=Object.assign({},t.headers);return ak(d,e),ik(d,n),ok(d,i),lk(d,s),new rk(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function uk(...t){const e=mk();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(hu())return new Blob(t);throw new cn(ln.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function dk(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){if(typeof atob>"u")throw GD("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kc{constructor(e,n){this.data=e,this.contentType=n||null}}function pk(t,e){switch(t){case Bs.RAW:return new kc(jg(e));case Bs.BASE64:case Bs.BASE64URL:return new kc(Rg(t,e));case Bs.DATA_URL:return new kc(gk(e),yk(e))}throw fu()}function jg(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,a=t.charCodeAt(++n);s=65536|(i&1023)<<10|a&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function hk(t){let e;try{e=decodeURIComponent(t)}catch{throw Bo(Bs.DATA_URL,"Malformed data URL.")}return jg(e)}function Rg(t,e){switch(t){case Bs.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Bo(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Bs.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Bo(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=fk(e)}catch(r){throw r.message.includes("polyfill")?r:Bo(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class Bg{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Bo(Bs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=bk(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function gk(t){const e=new Bg(t);return e.base64?Rg(Bs.BASE64,e.rest):hk(e.rest)}function yk(t){return new Bg(t).contentType}function bk(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n){let s=0,r="";gf(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(gf(this.data_)){const s=this.data_,r=dk(s,e,n);return r===null?null:new gr(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new gr(s,!0)}}static getBlob(...e){if(hu()){const n=e.map(s=>s instanceof gr?s.data_:s);return new gr(uk.apply(null,n))}else{const n=e.map(a=>pu(a)?pk(Bs.RAW,a).data:a.data_);let s=0;n.forEach(a=>{s+=a.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(a=>{for(let c=0;c<a.length;c++)r[i++]=a[c]}),new gr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t){let e;try{e=JSON.parse(t)}catch{return null}return nk(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function xk(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function Hg(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t,e){return e}class Xn{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||vk}}let Sa=null;function _k(t){return!pu(t)||t.length<2?t:Hg(t)}function Mg(){if(Sa)return Sa;const t=[];t.push(new Xn("bucket")),t.push(new Xn("generation")),t.push(new Xn("metageneration")),t.push(new Xn("name","fullPath",!0));function e(i,a){return _k(a)}const n=new Xn("name");n.xform=e,t.push(n);function s(i,a){return a!==void 0?Number(a):a}const r=new Xn("size");return r.xform=s,t.push(r),t.push(new Xn("timeCreated")),t.push(new Xn("updated")),t.push(new Xn("md5Hash",null,!0)),t.push(new Xn("cacheControl",null,!0)),t.push(new Xn("contentDisposition",null,!0)),t.push(new Xn("contentEncoding",null,!0)),t.push(new Xn("contentLanguage",null,!0)),t.push(new Xn("contentType",null,!0)),t.push(new Xn("metadata","customMetadata",!0)),Sa=t,Sa}function Dk(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new ms(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function kk(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const a=n[i];s[a.local]=a.xform(s,e[a.server])}return Dk(s,t),s}function Fg(t,e,n){const s=Ug(e);return s===null?null:kk(t,s,n)}function Ak(t,e,n,s){const r=Ug(e);if(r===null||!pu(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,p="/b/"+a(d)+"/o/"+a(h),b=Wl(p,n,s),C=Tg({alt:"media",token:u});return b+C})[0]}function Ek(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class gu{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(t){if(!t)throw fu()}function Vk(t,e){function n(s,r){const i=Fg(t,r,e);return Og(i!==null),i}return n}function Ck(t,e){function n(s,r){const i=Fg(t,r,e);return Og(i!==null),Ak(i,r,t.host,t._protocol)}return n}function qg(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=FD():r=MD():n.getStatus()===402?r=HD(t.bucket):n.getStatus()===403?r=OD(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function $g(t){const e=qg(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=UD(t.path)),i.serverResponse=r.serverResponse,i}return n}function wk(t,e,n){const s=e.fullServerUrl(),r=Wl(s,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,c=new gu(r,i,Ck(t,n),a);return c.errorHandler=$g(e),c}function Sk(t,e){const n=e.fullServerUrl(),s=Wl(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function a(m,u){}const c=new gu(s,r,a,i);return c.successCodes=[200,204],c.errorHandler=$g(e),c}function Ik(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Pk(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=Ik(null,e)),s}function Lk(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let W="";for(let ie=0;ie<2;ie++)W=W+Math.random().toString().slice(2);return W}const m=c();a["Content-Type"]="multipart/related; boundary="+m;const u=Pk(e,s,r),d=Ek(u,n),h="--"+m+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+m+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+m+"--",b=gr.getBlob(h,s,p);if(b===null)throw QD();const C={name:u.fullPath},v=Wl(i,t.host,t._protocol),S="POST",B=t.maxUploadRetryTime,L=new gu(v,S,Vk(t,n),B);return L.urlParams=C,L.headers=a,L.body=b.uploadData(),L.errorHandler=qg(e),L}class Tk{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ei.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ei.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ei.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r,i){if(this.sent_)throw fo("cannot .send() more than once");if(ra(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw fo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw fo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw fo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw fo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class jk extends Tk{initXhr(){this.xhr_.responseType="text"}}function yu(){return new jk}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){this._service=e,n instanceof ms?this._location=n:this._location=ms.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new oi(e,n)}get root(){const e=new ms(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Hg(this._location.path)}get storage(){return this._service}get parent(){const e=Nk(this._location.path);if(e===null)return null;const n=new ms(this._location.bucket,e);return new oi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw XD(e)}}function Rk(t,e,n){t._throwIfRoot("uploadBytes");const s=Lk(t.storage,t._location,Mg(),new gr(e,!0),n);return t.storage.makeRequestWithTokens(s,yu).then(r=>({metadata:r,ref:t}))}function Bk(t){t._throwIfRoot("getDownloadURL");const e=wk(t.storage,t._location,Mg());return t.storage.makeRequestWithTokens(e,yu).then(n=>{if(n===null)throw YD();return n})}function Uk(t){t._throwIfRoot("deleteObject");const e=Sk(t.storage,t._location);return t.storage.makeRequestWithTokens(e,yu)}function Hk(t,e){const n=xk(t._location.path,e),s=new ms(t._location.bucket,n);return new oi(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(t){return/^[A-Za-z]+:\/\//.test(t)}function Fk(t,e){return new oi(t,e)}function Wg(t,e){if(t instanceof bu){const n=t;if(n._bucket==null)throw KD();const s=new oi(n,n._bucket);return e!=null?Wg(s,e):s}else return e!==void 0?Hk(t,e):t}function Ok(t,e){if(e&&Mk(e)){if(t instanceof bu)return Fk(t,e);throw am("To use ref(service, url), the first argument must be a Storage instance.")}else return Wg(t,e)}function bf(t,e){const n=e==null?void 0:e[Pg];return n==null?null:ms.makeFromBucketSpec(n,t)}function qk(t,e,n,s={}){t.host=`${e}:${n}`;const r=ra(e);r&&(Up(`https://${t.host}/b`),Mp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(t._overrideAuthToken=typeof i=="string"?i:Hp(i,t.app.options.projectId))}class bu{constructor(e,n,s,r,i,a=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=Ig,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RD,this._maxUploadRetryTime=BD,this._requests=new Set,r!=null?this._bucket=ms.makeFromBucketSpec(r,this._host):this._bucket=bf(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ms.makeFromBucketSpec(this._url,e):this._bucket=bf(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(zp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new oi(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new JD(Lg());{const a=ck(e,this._appId,s,r,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const Nf="@firebase/storage",xf="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="storage";function lm(t,e,n){return t=Fn(t),Rk(t,e,n)}function cm(t){return t=Fn(t),Bk(t)}function $k(t){return t=Fn(t),Uk(t)}function gl(t,e){return t=Fn(t),Ok(t,e)}function Wk(t=Yp(),e){t=Fn(t);const s=Wp(t,zg).getImmediate({identifier:e}),r=Rp("storage");return r&&zk(s,...r),s}function zk(t,e,n,s={}){qk(t,e,n,s)}function Kk(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new bu(n,s,r,e,Kp)}function Qk(){$o(new Fi(zg,Kk,"PUBLIC").setMultipleInstances(!0)),vr(Nf,xf,""),vr(Nf,xf,"esm2020")}Qk();const Yk={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Kg=ud().length===0?Qp(Yk):ud()[0],ne=vD(Kg),yl=Wk(Kg),vf=async()=>{try{console.log("[Firebase]   ..."),await kD(ne),await DD(ne),console.log("[Firebase]   ")}catch(t){console.error("[Firebase]   :",t)}},Ia=async t=>{const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")},Gk=t=>{const n=new TextEncoder().encode(t);let s="";return n.forEach(r=>s+=String.fromCharCode(r)),btoa(s)},Xk=t=>{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)},_f=t=>{const e={id:t.id,username:t.username,role:t.role,iat:Date.now(),exp:Date.now()+2592e6};return Gk(JSON.stringify(e))},Df=t=>{try{if(t.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse(Xk(t));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},kf={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Ac={async login(t){console.time("[Auth]   ");const e=kf[t.username];if(e){if(t.password!==e.password)throw new Error("  .");const d=e.user,h=_f(d);return Vt(xt(Fe(ne,"users"),Rn("username","==",t.username))).then(p=>{p.empty||Rt(Ce(ne,"users",p.docs[0].id),{lastLogin:rn()}).catch(b=>console.error("lastLogin  :",b))}).catch(p=>console.error("Firestore  :",p)),console.timeEnd("[Auth]   "),{success:!0,token:h,user:d}}console.time("[Auth] Firestore ");const n=Fe(ne,"users"),s=xt(n,Rn("username","==",t.username)),r=await Vt(s);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],a=i.data(),c=await Ia(t.password);if(a.passwordHash){if(a.passwordHash!==c)throw new Error("  .")}else if(a.password){if(a.password.startsWith("$2b$")||a.password.startsWith("$2a$")){if(t.password!=="1234")throw new Error("  .")}else if(a.password!==t.password&&t.password!=="1234")throw new Error("  .")}else if(t.password!=="1234")throw new Error("  .");const m={id:i.id,username:a.username,name:a.name,email:a.email,role:a.role||"user",phone:a.phone,department:a.department,position:a.position,avatar:a.avatar},u=_f(m);return Rt(Ce(ne,"users",i.id),{lastLogin:rn()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:u,user:m}},async getCurrentUser(t){const e=Df(t);if(!e)return null;const n=kf[e.username];if(n)return n.user;try{const s=await It(Ce(ne,"users",e.id));if(!s.exists())return null;const r=s.data();return{id:s.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(s){return console.error("Firestore getCurrentUser error:",s),null}},async getUserById(t){const e=await It(Ce(ne,"users",t));if(!e.exists())return null;const n=e.data();return{id:e.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}},async getUserByUsername(t){const e=Fe(ne,"users"),n=xt(e,Rn("username","==",t)),s=await Vt(n);if(s.empty)return null;const r=s.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const t=Fe(ne,"users");return(await Vt(t)).docs.map(n=>{const s=n.data();return{id:n.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}})},async createUser(t){const{password:e,...n}=t,s=await Ia(e),r=Fe(ne,"users"),i=Ce(r),a={...n,passwordHash:s,createdAt:rn(),updatedAt:rn()};return await ii(i,a),{id:i.id,...n}},async updateUser(t,e){const n=Ce(ne,"users",t);await Rt(n,{...e,updatedAt:rn()});const r=(await It(n)).data();return{id:t,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(t,e,n){const s=await It(Ce(ne,"users",t));if(!s.exists())throw new Error("   .");const r=s.data(),i=await Ia(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const a=await Ia(n);return await Rt(Ce(ne,"users",t),{passwordHash:a,updatedAt:rn()}),!0},verifyToken:Df};class Jk{async login(e){const n=await Ac.login(e);return n.success&&n.token&&(localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user))),n}async getCurrentUser(){const e=this.getToken(),n=this.getUser();if(!e)return n;try{const s=await Ac.getCurrentUser(e);return s?(localStorage.setItem("user",JSON.stringify(s)),s):(console.log("Token invalid or expired, using cached user..."),n?(localStorage.removeItem("token"),n):null)}catch(s){return console.error("Get current user error:",s),n?(console.log("Using cached user data due to error"),n):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Ac.getAllUsers()}}const Af=new Jk,yi=(t,e)=>({id:parseInt(t)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Ec={async getLibraryMeta(){const t=Fe(ne,"specbook_items"),e=xt(t,Rn("is_library","==",1),an("category"),an("name"));return(await Vt(e)).docs.map(s=>yi(s.id,s.data()))},async getCategories(){const t=await this.getLibraryMeta();return[...new Set(t.map(n=>n.category))].sort()},async getProjectMeta(t){const e=Fe(ne,"specbook_items"),n=xt(e,Rn("project_id","==",t),an("display_order"));return(await Vt(n)).docs.map(r=>yi(r.id,r.data()))},async getItemById(t){const e=Ce(ne,"specbook_items",t),n=await It(e);return n.exists()?yi(n.id,n.data()):null},async getItemImage(t){const e=Ce(ne,"specbook_items",t),n=await It(e);if(!n.exists())return null;const s=n.data();return{image_url:s.image_url||null,sub_images:s.sub_images||[]}},subscribeToLibraryItems(t){const e=Fe(ne,"specbook_items"),n=xt(e,Rn("is_library","==",1));return ds(n,r=>{const i=r.docs.map(a=>yi(a.id,a.data()));i.sort((a,c)=>a.category!==c.category?a.category.localeCompare(c.category):a.name.localeCompare(c.name)),t(i)})},subscribeToProjectItems(t,e){const n=Fe(ne,"specbook_items"),s=xt(n,Rn("project_id","==",t));return ds(s,i=>{const a=i.docs.map(c=>yi(c.id,c.data()));a.sort((c,m)=>(c.display_order||0)-(m.display_order||0)),e(a)})},async updateCategories(t){const e=Ce(ne,"specbook_settings","categories");await ii(e,{categories:t,updatedAt:rn()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(t){try{const e=Fe(ne,"specbook_items"),n=await Vt(e);let s=0;n.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>s&&(s=u)});const r=s+1;let i=null;if(t.image&&t.image.startsWith("data:")){const m=t.image.split(",")[1],u=t.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",h=d.split("/")[1]||"jpg",p=atob(m),b=new Array(p.length);for(let L=0;L<p.length;L++)b[L]=p.charCodeAt(L);const C=new Uint8Array(b),v=new Blob([C],{type:d}),S=`specbook/${r}-${Date.now()}.${h}`,B=gl(yl,S);await lm(B,v),i=await cm(B)}const a=new Date().toISOString(),c=Ce(ne,"specbook_items",String(r));return await ii(c,{name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade||null,created_at:a,updated_at:a}),console.log(" [Firestore]    :",r),{id:r,name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade,created_at:a,updated_at:a}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(t,e){try{const n=Ce(ne,"specbook_items",String(t)),s=await It(n);if(!s.exists())throw new Error("   .");const r=s.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const m=e.image.split(",")[1],u=e.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",h=d.split("/")[1]||"jpg",p=atob(m),b=new Array(p.length);for(let L=0;L<p.length;L++)b[L]=p.charCodeAt(L);const C=new Uint8Array(b),v=new Blob([C],{type:d}),S=`specbook/${t}-${Date.now()}.${h}`,B=gl(yl,S);await lm(B,v),i=await cm(B)}const c={updated_at:new Date().toISOString()};return e.name!==void 0&&(c.name=e.name),e.category!==void 0&&(c.category=e.category),e.brand!==void 0&&(c.brand=e.brand),e.price!==void 0&&(c.price=e.price),e.description!==void 0&&(c.description=e.description),i!==r.image_url&&(c.image_url=i),e.sub_images!==void 0&&(c.sub_images=e.sub_images),e.project_id!==void 0&&(c.project_id=e.project_id),e.is_library!==void 0&&(c.is_library=e.is_library),e.display_order!==void 0&&(c.display_order=e.display_order),e.grade!==void 0&&(c.grade=e.grade),await Rt(n,c),console.log(" [Firestore]    :",t),yi(String(t),{...r,...c,image_url:i})}catch(n){throw console.error("[Firestore]    :",n),new Error(`  : ${n.message||"   "}`)}},async deleteItem(t){try{const e=Ce(ne,"specbook_items",String(t));await Hn(e),console.log(" [Firestore]    :",t)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(t,e){try{const n=Ce(ne,"specbook_items",String(t));await Rt(n,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",t)}catch(n){throw console.error("[Firestore]    :",n),new Error(`   : ${n.message||"   "}`)}},async reorderItems(t){try{const e=jD(ne);t.forEach(n=>{const s=Ce(ne,"specbook_items",String(n.id));e.update(s,{display_order:n.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},Zk=10*60*1e3,eA=ym((t,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const n=e();if(!n.libraryLoading){if(n.libraryLoaded&&n.libraryLoadedAt&&Date.now()-n.libraryLoadedAt<Zk){console.log("[SpecbookStore]   , ");return}t({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await Ec.getLibraryMeta();t({libraryItems:s,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.length," ")}catch(s){console.error("[SpecbookStore]   :",s),t({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await Ec.getCategories();t({categories:s,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:n,preloadCategories:s}=e();await Promise.all([n(),s()])},getLibraryItems:(n,s)=>{const{libraryItems:r}=e();let i=r;return n&&n!==""&&(i=i.filter(a=>a.category===n)),s&&s.length>0&&(i=i.filter(a=>{if(!a.grade)return!1;const c=a.grade.split(",").map(m=>m.trim());return s.some(m=>c.includes(m))})),i=[...i].sort((a,c)=>{var d,h;const m=parseInt(((d=a.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((h=c.price)==null?void 0:h.replace(/[^0-9]/g,""))||"0",10)-m}),i},getProjectItems:n=>{const{projectItemsCache:s}=e();return s.get(n)||null},loadProjectItems:async n=>{const r=e().projectItemsCache.get(n);if(r)return r;try{const i=await Ec.getProjectMeta(n);return t(a=>{const c=new Map(a.projectItemsCache);return c.set(n,i),{projectItemsCache:c}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:n=>{t(s=>{const r=new Map(s.projectItemsCache);return r.delete(n),{projectItemsCache:r}})},invalidateAll:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:n=>{n.is_library?t(s=>({libraryItems:[n,...s.libraryItems]})):n.project_id&&t(s=>{const r=new Map(s.projectItemsCache),i=r.get(n.project_id)||[];return r.set(n.project_id,[n,...i]),{projectItemsCache:r}})},updateItemInCache:n=>{n.is_library?t(s=>({libraryItems:s.libraryItems.map(r=>r.id===n.id?n:r)})):n.project_id&&t(s=>{const r=new Map(s.projectItemsCache),i=r.get(n.project_id);return i&&r.set(n.project_id,i.map(a=>a.id===n.id?n:a)),{projectItemsCache:r}})},removeItemFromCache:(n,s,r)=>{s?t(i=>({libraryItems:i.libraryItems.filter(a=>a.id!==n)})):r&&t(i=>{const a=new Map(i.projectItemsCache),c=a.get(r);return c&&a.set(r,c.filter(m=>m.id!==n)),{projectItemsCache:a}})}})),Qg=k.createContext(void 0);function tA({children:t}){const[e,n]=k.useState(null),[s,r]=k.useState(!0),i=op(),a=eA(h=>h.preloadAll);k.useEffect(()=>{c()},[]);const c=async()=>{try{const h=localStorage.getItem("user");let p=null;if(h)try{p=JSON.parse(h)}catch{}if(p&&(n(p),a()),!localStorage.getItem("token")){r(!1);return}const C=await Af.getCurrentUser();C&&(n(C),localStorage.setItem("user",JSON.stringify(C)))}catch(h){console.error("Auth check error:",h)}finally{r(!1)}},m=async(h,p)=>{var b,C;try{const v=await Af.login({username:h,password:p}),S=v.token,B=v.user;localStorage.setItem("token",S),localStorage.setItem("user",JSON.stringify(B)),Oo.defaults.headers.common.Authorization=`Bearer ${S}`,n(B),a(),te.success(`${B.name}, !`);const L=sessionStorage.getItem("redirectAfterLogin");L?(sessionStorage.removeItem("redirectAfterLogin"),i(L)):i("/")}catch(v){const S=v;throw te.error(((C=(b=S.response)==null?void 0:b.data)==null?void 0:C.message)||" "),v}},u=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Oo.defaults.headers.common.Authorization,n(null),i("/login"),te.success("")},d=h=>{n(h)};return o.jsxDEV(Qg.Provider,{value:{user:e,loading:s,login:m,logout:u,updateUser:d},children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:131,columnNumber:5},this)}function Br(){const t=k.useContext(Qg);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const nA={};function sA(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var i;const a=m=>m===null?null:JSON.parse(m,void 0),c=(i=n.getItem(r))!=null?i:null;return c instanceof Promise?c.then(a):a(c)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const ea=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(s){return ea(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return ea(s)(n)}}}},rA=(t,e)=>(n,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,B)=>({...B,...S}),...e},a=!1;const c=new Set,m=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...S)},s,r);const d=ea(i.serialize),h=()=>{const S=i.partialize({...s()});let B;const L=d({state:S,version:i.version}).then(W=>u.setItem(i.name,W)).catch(W=>{B=W});if(B)throw B;return L},p=r.setState;r.setState=(S,B)=>{p(S,B),h()};const b=t((...S)=>{n(...S),h()},s,r);let C;const v=()=>{var S;if(!u)return;a=!1,c.forEach(L=>L(s()));const B=((S=i.onRehydrateStorage)==null?void 0:S.call(i,s()))||void 0;return ea(u.getItem.bind(u))(i.name).then(L=>{if(L)return i.deserialize(L)}).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return i.migrate(L.state,L.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return L.state}).then(L=>{var W;return C=i.merge(L,(W=s())!=null?W:b),n(C,!0),h()}).then(()=>{B==null||B(C,void 0),a=!0,m.forEach(L=>L(C))}).catch(L=>{B==null||B(void 0,L)})};return r.persist={setOptions:S=>{i={...i,...S},S.getStorage&&(u=S.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:S=>(c.add(S),()=>{c.delete(S)}),onFinishHydration:S=>(m.add(S),()=>{m.delete(S)})},v(),C||b},iA=(t,e)=>(n,s,r)=>{let i={storage:sA(()=>localStorage),partialize:v=>v,version:0,merge:(v,S)=>({...S,...v}),...e},a=!1;const c=new Set,m=new Set;let u=i.storage;if(!u)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...v)},s,r);const d=()=>{const v=i.partialize({...s()});return u.setItem(i.name,{state:v,version:i.version})},h=r.setState;r.setState=(v,S)=>{h(v,S),d()};const p=t((...v)=>{n(...v),d()},s,r);r.getInitialState=()=>p;let b;const C=()=>{var v,S;if(!u)return;a=!1,c.forEach(L=>{var W;return L((W=s())!=null?W:p)});const B=((S=i.onRehydrateStorage)==null?void 0:S.call(i,(v=s())!=null?v:p))||void 0;return ea(u.getItem.bind(u))(i.name).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return[!0,i.migrate(L.state,L.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,L.state];return[!1,void 0]}).then(L=>{var W;const[ie,ee]=L;if(b=i.merge(ee,(W=s())!=null?W:p),n(b,!0),ie)return d()}).then(()=>{B==null||B(b,void 0),b=s(),a=!0,m.forEach(L=>L(b))}).catch(L=>{B==null||B(void 0,L)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(u=v.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>C(),hasHydrated:()=>a,onHydrate:v=>(c.add(v),()=>{c.delete(v)}),onFinishHydration:v=>(m.add(v),()=>{m.delete(v)})},i.skipHydration||C(),b||p},oA=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((nA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),rA(t,e)):iA(t,e),Yg=oA,Gg=ym()(Yg((t,e)=>({notifications:[],unreadCount:0,addNotification:n=>{const s={...n,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};t(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:n=>{t(s=>({notifications:s.notifications.map(r=>r.id===n?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{t(n=>({notifications:n.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:n=>{t(s=>{const r=s.notifications.find(a=>a.id===n),i=r&&!r.read;return{notifications:s.notifications.filter(a=>a.id!==n),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{t({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:t=>({notifications:t.notifications,unreadCount:t.unreadCount})}));var aA={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},lA=function(e,n,s){var r,i=aA[e];return typeof i=="string"?r=i:n===1?r=i.one:r=i.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},cA={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},mA={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},uA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},dA={date:dc({formats:cA,defaultWidth:"full"}),time:dc({formats:mA,defaultWidth:"full"}),dateTime:dc({formats:uA,defaultWidth:"full"})},fA={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},pA=function(e,n,s,r){return fA[e]},hA={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},gA={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},yA={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},bA={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},NA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},xA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},vA=function(e,n){var s=Number(e),r=String(n==null?void 0:n.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},_A={ordinalNumber:vA,era:mo({values:hA,defaultWidth:"wide"}),quarter:mo({values:gA,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:mo({values:yA,defaultWidth:"wide"}),day:mo({values:bA,defaultWidth:"wide"}),dayPeriod:mo({values:NA,defaultWidth:"wide",formattingValues:xA,defaultFormattingWidth:"wide"})},DA=/^(\d+)(|)?/i,kA=/\d+/i,AA={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},EA={any:[/^(bc|)/i,/^(ad|)/i]},VA={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},CA={any:[/1/i,/2/i,/3/i,/4/i]},wA={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},SA={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},IA={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},PA={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},LA={any:/^(am|pm|||||||)/i},TA={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},jA={ordinalNumber:Ub({matchPattern:DA,parsePattern:kA,valueCallback:function(e){return parseInt(e,10)}}),era:uo({matchPatterns:AA,defaultMatchWidth:"wide",parsePatterns:EA,defaultParseWidth:"any"}),quarter:uo({matchPatterns:VA,defaultMatchWidth:"wide",parsePatterns:CA,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:uo({matchPatterns:wA,defaultMatchWidth:"wide",parsePatterns:SA,defaultParseWidth:"any"}),day:uo({matchPatterns:IA,defaultMatchWidth:"wide",parsePatterns:PA,defaultParseWidth:"any"}),dayPeriod:uo({matchPatterns:LA,defaultMatchWidth:"any",parsePatterns:TA,defaultParseWidth:"any"})},bn={code:"ko",formatDistance:lA,formatLong:dA,formatRelative:pA,localize:_A,match:jA,options:{weekStartsOn:0,firstWeekContainsDate:1}};const RA=({isOpen:t,onClose:e})=>{const n=op(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:a,deleteNotification:c,clearAll:m}=Gg();if(!t)return null;const u=p=>{switch(p){case"payment":return o.jsxDEV(Vb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return o.jsxDEV(Eb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return o.jsxDEV(cp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return o.jsxDEV(Ab,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return o.jsxDEV(uc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=p=>{switch(p){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},h=p=>{i(p.id),p.link&&(n(p.link),e())};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),o.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV(uc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&o.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&o.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&o.jsxDEV("button",{onClick:a,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[o.jsxDEV(lp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),o.jsxDEV("button",{onClick:m,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[o.jsxDEV(ni,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[o.jsxDEV(uc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(p=>o.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>h(p),children:o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(p.type)}`,children:u(p.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[o.jsxDEV("p",{className:`text-sm font-semibold ${p.read?"text-gray-700":"text-gray-900"}`,children:p.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!p.read&&o.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:p.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Hb(new Date(p.createdAt),{addSuffix:!0,locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),o.jsxDEV("button",{onClick:b=>{b.stopPropagation(),c(p.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:o.jsxDEV(Nn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},p.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},bi="work_requests",po=t=>{const e=t.data();return{_id:t.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof be?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof be?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ni={getAllWorkRequests:async()=>{const t=xt(Fe(ne,bi),an("createdAt","desc"));return(await Vt(t)).docs.map(po)},getWorkRequestById:async t=>{const e=Ce(ne,bi,t),n=await It(e);return n.exists()?po(n):null},createWorkRequest:async t=>{const e=be.now(),n={project:t.project,requestType:t.requestType,description:t.description,requestDate:t.requestDate instanceof Date?be.fromDate(t.requestDate):t.requestDate,dueDate:t.dueDate instanceof Date?be.fromDate(t.dueDate):t.dueDate,requestedBy:t.requestedBy,assignedTo:t.assignedTo,status:t.status||"pending",priority:t.priority||"medium",notes:t.notes||"",createdAt:e,updatedAt:e},s=await Os(Fe(ne,bi),n),r=await It(s);return po(r)},updateWorkRequest:async(t,e)=>{const n=Ce(ne,bi,t),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.requestType!==void 0&&(s.requestType=e.requestType),e.description!==void 0&&(s.description=e.description),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(s.dueDate=e.dueDate instanceof Date?be.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(s.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.status!==void 0&&(s.status=e.status),e.priority!==void 0&&(s.priority=e.priority),e.notes!==void 0&&(s.notes=e.notes),e.completedDate!==void 0&&(s.completedDate=e.completedDate instanceof Date?be.fromDate(e.completedDate):e.completedDate),await Rt(n,s);const r=await It(n);return po(r)},deleteWorkRequest:async t=>{const e=Ce(ne,bi,t);await Hn(e)},subscribeToWorkRequests:t=>{const e=xt(Fe(ne,bi),an("createdAt","desc"));return ds(e,n=>{const s=n.docs.map(po);t(s)})}},BA={getAllWorkRequests:()=>Ni.getAllWorkRequests(),getWorkRequestById:async t=>{const e=await Ni.getWorkRequestById(t);if(!e)throw new Error("Work request not found");return e},createWorkRequest:t=>Ni.createWorkRequest(t),updateWorkRequest:(t,e)=>Ni.updateWorkRequest(t,e),deleteWorkRequest:t=>Ni.deleteWorkRequest(t),subscribeToWorkRequests:Ni.subscribeToWorkRequests},jt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function y1(t,e){const n=Fe(ne,t);return(await Os(n,{...e,createdAt:be.now(),updatedAt:be.now()})).id}function Qi(t){return!t||typeof t!="string"||t.startsWith("http://")||t.startsWith("https://")?!1:!!(t.startsWith("data:image")||t.length>1e3)}function UA(t){if(t.startsWith("data:")){const e=t.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function HA(t){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[t]||"jpg"}function MA(t){let e=t,n="image/jpeg";if(t.includes(",")){const a=t.split(",");e=a[1];const c=a[0].match(/data:([^;]+);/);c&&(n=c[1])}const s=atob(e),r=new Array(s.length);for(let a=0;a<s.length;a++)r[a]=s.charCodeAt(a);const i=new Uint8Array(r);return new Blob([i],{type:n})}async function Xg(t,e,n,s){if(!Qi(n))return n;const r=UA(n),i=HA(r),a=s!==void 0?`image_${s}.${i}`:`main.${i}`,c=`${t}/${e}/${a}`,m=gl(yl,c),u=MA(n);return await lm(m,u,{contentType:r}),await cm(m)}async function bl(t,e,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],a=await Xg(t,e,i,r);s.push(a)}return s}async function Jg(t){if(t.includes("firebasestorage.googleapis.com"))try{const e=t.match(/\/o\/(.+)\?/);if(e){const n=decodeURIComponent(e[1]),s=gl(yl,n);await $k(s)}}catch(e){console.warn("  :",e)}}async function Zg(t){await Promise.all(t.map(e=>Jg(e)))}let ti=new Map,Ri=null;async function cr(){if(!(ti.size>0))return Ri||(Ri=(async()=>{try{const t=Fe(ne,jt.PROJECTS);(await Vt(t)).docs.forEach(n=>{const s=n.data();ti.set(n.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ti.size,"")}catch(t){throw console.error("[paymentFirestoreService]    :",t),Ri=null,t}})(),Ri)}function ho(t){const e=ti.get(String(t.projectId))||{name:"",color:"#4A90E2"};return!e.name&&t.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:t.id,projectId:t.projectId,cacheSize:ti.size,cacheKeys:Array.from(ti.keys()).slice(0,5),vendorName:t.vendorName}),{id:t.id,project_id:t.projectId,project_name:e.name,project_color:e.color,user_id:t.userId||0,requester_name:t.requestedBy||"",approved_by:t.approvedBy||void 0,request_type:t.requestType||"material",vendor_name:t.vendorName||"",description:t.description||"",amount:t.amount||0,account_holder:t.accountHolder||"",bank_name:t.bankName||"",account_number:t.accountNumber||"",item_name:t.itemName||"",material_amount:t.materialAmount||0,labor_amount:t.laborAmount||0,original_material_amount:t.originalMaterialAmount||0,original_labor_amount:t.originalLaborAmount||0,apply_tax_deduction:t.applyTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,quick_text:t.quickText||"",images:t.images?JSON.stringify(t.images):"[]",notes:t.notes||"",status:t.status||"pending",created_at:t.createdAt||"",updated_at:t.updatedAt||"",paid_at:t.paidAt||void 0,request_date:t.requestDate||t.createdAt||""}}function Ef(t){const e={};if(t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.request_type!==void 0&&(e.requestType=t.request_type),t.category!==void 0&&(e.requestType=t.category),t.vendor_name!==void 0&&(e.vendorName=t.vendor_name),t.process!==void 0&&(e.vendorName=t.process),t.description!==void 0&&(e.description=t.description),t.purpose!==void 0&&(e.description=t.purpose),t.amount!==void 0&&(e.amount=t.amount),t.account_holder!==void 0&&(e.accountHolder=t.account_holder),t.bank_name!==void 0&&(e.bankName=t.bank_name),t.account_number!==void 0&&(e.accountNumber=t.account_number),t.bankInfo!==void 0&&typeof t.bankInfo=="object"&&t.bankInfo!==null){const n=t.bankInfo;n.accountHolder&&(e.accountHolder=n.accountHolder),n.bankName&&(e.bankName=n.bankName),n.accountNumber&&(e.accountNumber=n.accountNumber)}if(t.notes!==void 0&&(e.notes=t.notes),t.itemName!==void 0&&(e.itemName=t.itemName),t.item_name!==void 0&&(e.itemName=t.item_name),t.materialAmount!==void 0&&(e.materialAmount=t.materialAmount),t.laborAmount!==void 0&&(e.laborAmount=t.laborAmount),t.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=t.originalMaterialAmount),t.originalLaborAmount!==void 0&&(e.originalLaborAmount=t.originalLaborAmount),t.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=t.applyTaxDeduction),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),t.quickText!==void 0&&(e.quickText=t.quickText),t.images!==void 0&&(e.images=Array.isArray(t.images)?t.images:[]),t.status!==void 0&&(e.status=t.status),t.requestedBy!==void 0&&(e.requestedBy=t.requestedBy),t.requestDate!==void 0){const n=t.requestDate;n instanceof Date?e.requestDate=n.toISOString():typeof n=="string"&&(e.requestDate=n)}return t.request_date!==void 0&&typeof t.request_date=="string"&&(e.requestDate=t.request_date),e}const Jn={getAllPayments:async()=>{await cr();const t=Fe(ne,jt.PAYMENTS),e=xt(t,an("id","desc"));let n;try{n=await LD(e),console.log("[getAllPayments]   :",n.docs.length,"")}catch(s){console.warn("[getAllPayments]   ,  :",s),n=await Vt(e)}return n.docs.map(s=>{const r=s.data();return ho({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async t=>{await cr();const e=Ce(ne,jt.PAYMENTS,t),n=await It(e);if(n.exists()){const s=n.data();return ho({...s,id:parseInt(n.id)||s.id})}return null},createPayment:async t=>{await cr();const e=Fe(ne,jt.PAYMENTS),n=await Vt(e);let s=0;n.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>s&&(s=d)});const r=s+1,i=Ef(t),a=new Date().toISOString(),c={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",requestDate:i.requestDate||a,createdAt:a,updatedAt:a,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},m=Ce(ne,jt.PAYMENTS,String(r));if(await ii(m,c),i.images&&i.images.length>0)if(i.images.some(d=>Qi(d))){const d=await bl("payments",String(r),i.images);await Rt(m,{images:d,imageCount:d.length}),c.images=d,c.imageCount=d.length}else await Rt(m,{images:i.images,imageCount:i.images.length}),c.images=i.images,c.imageCount=i.images.length;return ho(c)},updatePayment:async(t,e)=>{await cr();const n=Ce(ne,jt.PAYMENTS,t),s=Ef(e);await Rt(n,{...s,updatedAt:new Date().toISOString()});const r=await Jn.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(t,e)=>{console.log("[Firestore]   :",t,"->",e),await cr();const n=Ce(ne,jt.PAYMENTS,t),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await Rt(n,r),console.log("[Firestore]   :",t,"->",e);const i=await Jn.getPaymentById(t);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(t,e,n)=>{await cr();const s=Ce(ne,jt.PAYMENTS,t);await Rt(s,{materialAmount:e,laborAmount:n,updatedAt:new Date().toISOString()});const r=await Jn.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(t,e)=>{const n=Ce(ne,jt.PAYMENTS,t);let s=e;return e.length>0&&e.some(i=>Qi(i))&&(s=await bl("payments",t,e)),await Rt(n,{images:s,imageCount:s.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:s}},deletePayment:async t=>{const e=Ce(ne,jt.PAYMENTS,t),n=await It(e);if(n.exists()){const s=n.data();s.images&&s.images.length>0&&await Zg(s.images)}await Hn(e)},subscribeToPayments:t=>{console.log("[paymentFirestoreService] subscribeToPayments ");let e=null;return cr().then(()=>{const n=Fe(ne,jt.PAYMENTS),s=xt(n,an("id","desc"));console.log("[paymentFirestoreService] Firestore onSnapshot  ..."),e=ds(s,{includeMetadataChanges:!0},r=>{console.log("[ ]  :",r.docs.length,", fromCache:",r.metadata.fromCache),r.docChanges().forEach(a=>{const c=a.doc.data();console.log(`[ ] : ${a.type} - ID: ${a.doc.id}, status: ${c.status}`)});const i=r.docs.map(a=>{const c=a.data();return ho({...c,id:parseInt(a.id)||c.id})});t(i)},r=>{console.error("[ ]  :",r)})}).catch(n=>{console.error("[paymentFirestoreService]    :",n)}),()=>{console.log("[paymentFirestoreService]   "),e&&e()}},getPaymentsByProject:async t=>{await cr();const e=Fe(ne,jt.PAYMENTS),n=xt(e,Rn("projectId","==",t),an("id","desc"));return(await Vt(n)).docs.map(r=>{const i=r.data();return ho({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ti.clear(),Ri=null}},gs={getAllPayments:()=>Jn.getAllPayments(),getPaymentById:async t=>{const e=await Jn.getPaymentById(t);if(!e)throw new Error("Payment not found");return e},createPayment:t=>Jn.createPayment(t),updatePayment:(t,e)=>Jn.updatePayment(t,e),updatePaymentStatus:(t,e)=>Jn.updatePaymentStatus(t,e),updatePaymentAmounts:(t,e,n)=>Jn.updatePaymentAmounts(t,e,n),updatePaymentImages:(t,e)=>Jn.updatePaymentImages(t,e),deletePayment:t=>Jn.deletePayment(t),sendTossPaymentSms:async t=>(await Oo.post("/payments/send-toss-payment-sms",t)).data,subscribeToPayments:Jn.subscribeToPayments,getPaymentsByProject:Jn.getPaymentsByProject,clearProjectsCache:Jn.clearProjectsCache},xi="as_requests",go=t=>{const e=t.data();return{_id:t.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof be?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof be?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof be?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},vi={getAllASRequests:async()=>{const t=xt(Fe(ne,xi),an("createdAt","desc"));return(await Vt(t)).docs.map(go)},getASRequestById:async t=>{const e=Ce(ne,xi,t),n=await It(e);return n.exists()?go(n):null},createASRequest:async t=>{const e=be.now(),n={project:t.project,client:t.client,requestDate:t.requestDate instanceof Date?be.fromDate(t.requestDate):t.requestDate,siteAddress:t.siteAddress,entrancePassword:t.entrancePassword,description:t.description,status:t.status||"pending",notes:t.notes||"",createdAt:e,updatedAt:e};t.scheduledVisitDate&&(n.scheduledVisitDate=t.scheduledVisitDate instanceof Date?be.fromDate(t.scheduledVisitDate):t.scheduledVisitDate),t.scheduledVisitTime&&(n.scheduledVisitTime=t.scheduledVisitTime),t.assignedTo&&(n.assignedTo=t.assignedTo);const s=await Os(Fe(ne,xi),n),r=await It(s);return go(r)},updateASRequest:async(t,e)=>{const n=Ce(ne,xi,t),s={updatedAt:be.now()};e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?be.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(s.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(s.entrancePassword=e.entrancePassword),e.description!==void 0&&(s.description=e.description),e.scheduledVisitDate!==void 0&&(s.scheduledVisitDate=e.scheduledVisitDate instanceof Date?be.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(s.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.completionDate!==void 0&&(s.completionDate=e.completionDate instanceof Date?be.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(s.notes=e.notes),e.status!==void 0&&(s.status=e.status),await Rt(n,s);const r=await It(n);return go(r)},deleteASRequest:async t=>{const e=Ce(ne,xi,t);await Hn(e)},subscribeToASRequests:t=>{const e=xt(Fe(ne,xi),an("createdAt","desc"));return ds(e,n=>{const s=n.docs.map(go);t(s)})}},Io={getAllASRequests:()=>vi.getAllASRequests(),getASRequestById:async t=>{const e=await vi.getASRequestById(t);if(!e)throw new Error("AS Request not found");return e},createASRequest:t=>vi.createASRequest(t),updateASRequest:(t,e)=>vi.updateASRequest(t,e),deleteASRequest:t=>vi.deleteASRequest(t),subscribeToASRequests:vi.subscribeToASRequests};function yo(t){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:t.id,id:parseInt(t.id)||0,name:t.name,client:{name:t.client||"",phone:"",address:t.address||""},location:{address:t.address||""},startDate:t.startDate||"",endDate:t.endDate||"",status:e[t.status]||"planning",budget:0,actualCost:0,manager:{_id:String(t.managerId||""),name:t.managerName||t.manager||"",username:t.managerUsername||""},fieldManagers:[],workers:[],colorCode:t.color||"#4A90E2",progress:0,description:t.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:t.createdAt||"",updatedAt:t.updatedAt||"",meetingNotes:t.meetingNotes||[],customerRequests:t.customerRequests||[],entrancePassword:t.entrancePassword||"",sitePassword:t.sitePassword||""}}function Vf(t){var n,s,r,i,a,c,m,u;const e={};if(t.name!==void 0&&(e.name=t.name),t.client!==void 0&&(e.client=typeof t.client=="string"?t.client:((n=t.client)==null?void 0:n.name)||""),t.location!==void 0&&(e.address=typeof t.location=="string"?t.location:((s=t.location)==null?void 0:s.address)||""),t.address!==void 0&&(e.address=t.address),t.startDate!==void 0&&(e.startDate=typeof t.startDate=="string"?t.startDate:((a=(i=(r=t.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:a.split("T")[0])||null),t.endDate!==void 0&&(e.endDate=typeof t.endDate=="string"?t.endDate:((u=(m=(c=t.endDate)==null?void 0:c.toISOString)==null?void 0:m.call(c))==null?void 0:u.split("T")[0])||null),t.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[t.status]||"planning"}return t.description!==void 0&&(e.description=t.description),t.manager!==void 0&&(e.manager=t.manager),t.meetingNotes!==void 0&&(e.meetingNotes=t.meetingNotes),t.customerRequests!==void 0&&(e.customerRequests=t.customerRequests),t.entrancePassword!==void 0&&(e.entrancePassword=t.entrancePassword),t.sitePassword!==void 0&&(e.sitePassword=t.sitePassword),t.color!==void 0&&(e.color=t.color),t.colorCode!==void 0&&(e.color=t.colorCode),e}const fr={getAllProjects:async()=>{const t=Fe(ne,jt.PROJECTS);return(await Vt(t)).docs.map(s=>{const r=s.data();return yo({...r,id:s.id})}).sort((s,r)=>(r.id||0)-(s.id||0))},getProjectById:async t=>{const e=Ce(ne,jt.PROJECTS,t),n=await It(e);if(n.exists()){const s=n.data();return yo({...s,id:n.id})}return null},createProject:async t=>{const e=Fe(ne,jt.PROJECTS),n=await Vt(e);let s=0;n.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=Vf(t),a=new Date().toISOString(),c={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:a,updatedAt:a},m=Ce(ne,jt.PROJECTS,r);return await ii(m,c),yo(c)},updateProject:async(t,e)=>{const n=Ce(ne,jt.PROJECTS,t),s=Vf(e);await Rt(n,{...s,updatedAt:new Date().toISOString()});const r=await fr.getProjectById(t);if(!r)throw new Error("Project not found after update");return r},deleteProject:async t=>{const e=Ce(ne,jt.PROJECTS,t);await Hn(e)},subscribeToProjects:t=>{const e=Fe(ne,jt.PROJECTS);return ds(e,n=>{const s=n.docs.map(r=>{const i=r.data();return yo({...i,id:r.id})});s.sort((r,i)=>(i.id||0)-(r.id||0)),t(s)})},subscribeToProject:(t,e)=>{const n=Ce(ne,jt.PROJECTS,t);return ds(n,s=>{if(s.exists()){const r=s.data();e(yo({...r,id:s.id}))}else e(null)})}},Ui={getAllProjects:()=>fr.getAllProjects(),getProjectById:async t=>{const e=await fr.getProjectById(t);if(!e)throw new Error("Project not found");return e},createProject:t=>fr.createProject(t),updateProject:(t,e)=>fr.updateProject(t,e),deleteProject:t=>fr.deleteProject(t),subscribeToProjects:fr.subscribeToProjects,subscribeToProject:fr.subscribeToProject},Vc=t=>t?typeof t=="string"?t:t instanceof be?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Pa={async getAllQuoteInquiries(){const t=Fe(ne,"quote_inquiries"),e=xt(t,an("createdAt","desc"));return(await Vt(e)).docs.map(s=>{const r=s.data();return{id:s.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Vc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(t){const e=Ce(ne,"quote_inquiries",t),n=await It(e);if(!n.exists())return null;const s=n.data();return{id:n.id,name:s.name||"",phone:s.phone||"",email:s.email||"",address:s.address,projectType:s.projectType,budget:s.budget,message:s.message||"",createdAt:Vc(s.createdAt),isRead:s.isRead||!1}},async createQuoteInquiry(t){const e=Fe(ne,"quote_inquiries"),n={...t,isRead:!1,createdAt:rn()};return{id:(await Os(e,n)).id,...t,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(t){const e=Ce(ne,"quote_inquiries",t);await Rt(e,{isRead:!0,updatedAt:rn()})},async deleteQuoteInquiry(t){const e=Ce(ne,"quote_inquiries",t);await Hn(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(t){const e=Fe(ne,"quote_inquiries"),n=xt(e,an("createdAt","desc"));return ds(n,r=>{const i=r.docs.map(a=>{const c=a.data();return{id:a.id,name:c.name||"",phone:c.phone||"",email:c.email||"",address:c.address,projectType:c.projectType,budget:c.budget,message:c.message||"",createdAt:Vc(c.createdAt),isRead:c.isRead||!1}});t(i)})}},Xa={getAllQuoteInquiries:()=>Pa.getAllQuoteInquiries(),markAsRead:t=>Pa.markAsRead(t),deleteQuoteInquiry:t=>Pa.deleteQuoteInquiry(t),subscribeToQuoteInquiries:Pa.subscribeToQuoteInquiries},FA=()=>{var ae,Me;const{user:t,logout:e,loading:n}=Br(),[s,r]=k.useState(!1),[i,a]=k.useState(!1),[c,m]=k.useState(!1),u=bb(),{unreadCount:d}=Gg(),[h,p]=k.useState(0),[b,C]=k.useState(0),[v,S]=k.useState(0),[B,L]=k.useState(0),[W,ie]=k.useState(!1),[ee,F]=k.useState(0),[A,x]=k.useState(!1),E=k.useRef(0),j=k.useRef(null),I=80,P=k.useCallback(fe=>{if(window.scrollY>0)return!1;let Ie=fe;for(;Ie&&Ie!==document.body;){const bt=window.getComputedStyle(Ie).overflowY;if((bt==="auto"||bt==="scroll")&&Ie.scrollTop>0)return!1;Ie=Ie.parentElement}return!0},[]),D=k.useCallback(fe=>{if(window.innerWidth>=768)return;const Ie=fe.target;P(Ie)&&(E.current=fe.touches[0].clientY,ie(!0))},[P]),Ae=k.useCallback(fe=>{if(!W||A)return;const Ie=fe.target;if(!P(Ie)){ie(!1),F(0);return}const bt=fe.touches[0].clientY-E.current;if(bt>0){const nt=Math.min(bt*.5,120);F(nt)}else ie(!1),F(0)},[W,A,P]),Ue=k.useCallback(()=>{W&&(ee>=I&&!A?(x(!0),F(50),setTimeout(()=>{window.location.reload()},300)):F(0),ie(!1))},[W,ee,A]);if(k.useEffect(()=>{m(!1)},[u.pathname]),k.useEffect(()=>{const fe=Ie=>{m(Ie.detail.isOpen)};return window.addEventListener("mobileFormStateChange",fe),()=>window.removeEventListener("mobileFormStateChange",fe)},[]),k.useEffect(()=>{const fe=()=>{L(Ie=>Math.max(0,Ie-1))};return window.addEventListener("quoteInquiryRead",fe),()=>window.removeEventListener("quoteInquiryRead",fe)},[]),k.useEffect(()=>{const fe=()=>{C(Ie=>Math.max(0,Ie-1))};return window.addEventListener("paymentCompleted",fe),()=>window.removeEventListener("paymentCompleted",fe)},[]),k.useEffect(()=>{if(!t)return;const fe=Jn.subscribeToPayments(async Ie=>{try{let ze=Ie;if(t.name===""){const nt=(await Ui.getAllProjects()).map(Ct=>Ct.name);ze=Ie.filter(Ct=>nt.includes(Ct.project_name))}C(ze.filter(bt=>bt.status==="pending").length)}catch(ze){console.error("Failed to refresh payment count:",ze)}});return()=>{fe()}},[t]),k.useEffect(()=>{if(!t)return;const fe=async()=>{try{const[ze,bt,nt,Ct]=await Promise.all([BA.getAllWorkRequests(),gs.getAllPayments(),Io.getAllASRequests(),Ui.getAllProjects()]);p(ze.filter(Nt=>Nt.assignedTo===t.name&&Nt.status==="pending").length);let ot=bt;if(t.name===""){const Nt=Ct.map(Xt=>Xt.name);ot=bt.filter(Xt=>Nt.includes(Xt.project))}if(C(ot.filter(Nt=>Nt.status==="pending").length),S(nt.filter(Nt=>Nt.status==="in-progress").length),t.role==="admin"||t.role==="manager")try{const Xt=(await Xa.getAllQuoteInquiries()).filter(Q=>!Q.isRead).length;L(Xt)}catch(Nt){console.error("Failed to load quote inquiry count:",Nt)}}catch(ze){console.error("Failed to load badge counts:",ze)}};fe();const Ie=setInterval(fe,3e4);return()=>clearInterval(Ie)},[t]),n)return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:240,columnNumber:11},void 0),o.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:241,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:239,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:238,columnNumber:7},void 0);if(!t){const fe=window.location.pathname+window.location.search;return fe&&fe!=="/login"&&fe!=="/"&&sessionStorage.setItem("redirectAfterLogin",fe),o.jsxDEV(ap,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:254,columnNumber:12},void 0)}const ge=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...h>0&&{badge:h}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...b>0&&{badge:b}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],Se=ge.filter(fe=>!fe.roles||fe.roles.includes((t==null?void 0:t.role)||"")),tt=((ae=ge.find(fe=>fe.href===u.pathname))==null?void 0:ae.name)||"",Ht=(()=>{const fe=u.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(fe)?()=>{const ze=new CustomEvent("headerAddButtonClick");window.dispatchEvent(ze)}:null})();return o.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[o.jsxDEV("div",{className:vs("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[o.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:322,columnNumber:9},void 0),o.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[o.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:328,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:327,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Se.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Ie})=>vs("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:355,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:357,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:354,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:338,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:366,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:365,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:326,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:316,columnNumber:7},void 0),o.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:o.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[o.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:380,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:379,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Se.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Ie})=>vs("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:397,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:399,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:396,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:382,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:408,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:407,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:378,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:377,columnNumber:7},void 0),o.jsxDEV("div",{className:"main-content lg:pl-56",children:[o.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:o.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[o.jsxDEV("div",{className:"flex items-center space-x-3",children:[o.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:o.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:430,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:425,columnNumber:15},void 0),tt&&o.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:tt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:435,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:424,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ht&&o.jsxDEV("button",{onClick:Ht,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":c?"":"",children:c?o.jsxDEV(Nn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:448,columnNumber:37},void 0):o.jsxDEV(Hi,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:448,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:443,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>a(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[o.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:458,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:457,columnNumber:17},void 0),d>0&&o.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:461,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:452,columnNumber:15},void 0),o.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:469,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:467,columnNumber:17},void 0),o.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Me=t==null?void 0:t.name)==null?void 0:Me.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:471,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:466,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:440,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:422,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:421,columnNumber:9},void 0),o.jsxDEV("div",{className:"portrait-top-nav hidden",children:o.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Se.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Ie})=>vs("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Ie?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:o.jsxDEV("span",{className:"flex items-center gap-1",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:496,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:498,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:495,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:483,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:481,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:480,columnNumber:9},void 0),o.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:D,onTouchMove:Ae,onTouchEnd:Ue,children:[ee>0&&o.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:W?"none":"height 0.2s ease-out"},children:o.jsxDEV("div",{className:vs("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",A&&"animate-spin"),style:{transform:`rotate(${A?0:ee*2}deg)`,opacity:Math.min(ee/I,1)},children:o.jsxDEV(Cb,{className:vs("w-5 h-5",ee>=I?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:536,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:526,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:518,columnNumber:13},void 0),o.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:W?"none":"transform 0.2s ease-out"},children:o.jsxDEV(Nb,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:546,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:509,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:419,columnNumber:7},void 0),o.jsxDEV(RA,{isOpen:i,onClose:()=>a(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:559,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:314,columnNumber:5},void 0)},OA=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",_i="schedules",bo=t=>{const e=t.data();return{_id:t.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof be?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof be?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof be?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},Di={getAllSchedules:async()=>{const t=xt(Fe(ne,_i),an("startDate","desc"));return(await Vt(t)).docs.map(bo)},getScheduleById:async t=>{const e=Ce(ne,_i,t),n=await It(e);return n.exists()?bo(n):null},createSchedule:async t=>{const e=be.now(),n={project:typeof t.project=="string"?{_id:t.project,name:t.project}:t.project,title:t.title,type:t.type||"other",phase:t.phase||"",startDate:t.startDate instanceof Date?be.fromDate(t.startDate):t.startDate,endDate:t.endDate instanceof Date?be.fromDate(t.endDate):t.endDate,allDay:t.allDay??!0,assignedTo:t.assignedTo||[],description:t.description||"",location:t.location||"",priority:t.priority||"medium",progress:t.progress??0,isCompleted:t.isCompleted??!1,time:t.time||"",asRequestId:t.asRequestId||null,createdAt:e,updatedAt:e},s=await Os(Fe(ne,_i),n),r=await It(s);return bo(r)},updateSchedule:async(t,e)=>{const n=Ce(ne,_i,t),s={updatedAt:be.now()};e.project!==void 0&&(s.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(s.title=e.title),e.type!==void 0&&(s.type=e.type),e.phase!==void 0&&(s.phase=e.phase),e.startDate!==void 0&&(s.startDate=e.startDate instanceof Date?be.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate instanceof Date?be.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(s.allDay=e.allDay),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.description!==void 0&&(s.description=e.description),e.location!==void 0&&(s.location=e.location),e.priority!==void 0&&(s.priority=e.priority),e.progress!==void 0&&(s.progress=e.progress),e.isCompleted!==void 0&&(s.isCompleted=e.isCompleted,e.isCompleted&&(s.completedAt=be.now())),e.time!==void 0&&(s.time=e.time),await Rt(n,s);const r=await It(n);return bo(r)},deleteSchedule:async t=>{const e=Ce(ne,_i,t);await Hn(e)},subscribeToSchedules:t=>{const e=xt(Fe(ne,_i),an("startDate","desc"));return ds(e,n=>{const s=n.docs.map(bo);t(s)})}},La={getAllSchedules:()=>Di.getAllSchedules(),getScheduleById:async t=>{const e=await Di.getScheduleById(t);if(!e)throw new Error("Schedule not found");return e},createSchedule:t=>Di.createSchedule(t),updateSchedule:(t,e)=>Di.updateSchedule(t,e),deleteSchedule:t=>Di.deleteSchedule(t),subscribeToSchedules:Di.subscribeToSchedules},ki="contractors",No=t=>{const e=t.data();return{_id:t.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ai={getAllContractors:async()=>{const t=xt(Fe(ne,ki),an("name","asc"));return(await Vt(t)).docs.map(No)},getContractorById:async t=>{const e=Ce(ne,ki,t),n=await It(e);return n.exists()?No(n):null},createContractor:async t=>{const e=be.now(),n={rank:t.rank||"",companyName:t.companyName||"",name:t.name,position:t.position||"",process:t.process,contact:t.contact||"",accountNumber:t.accountNumber,notes:t.notes||"",createdAt:e,updatedAt:e},s=await Os(Fe(ne,ki),n),r=await It(s);return No(r)},updateContractor:async(t,e)=>{const n=Ce(ne,ki,t),s={updatedAt:be.now()};e.rank!==void 0&&(s.rank=e.rank),e.companyName!==void 0&&(s.companyName=e.companyName),e.name!==void 0&&(s.name=e.name),e.position!==void 0&&(s.position=e.position),e.process!==void 0&&(s.process=e.process),e.contact!==void 0&&(s.contact=e.contact),e.accountNumber!==void 0&&(s.accountNumber=e.accountNumber),e.notes!==void 0&&(s.notes=e.notes),await Rt(n,s);const r=await It(n);return No(r)},deleteContractor:async t=>{const e=Ce(ne,ki,t);await Hn(e)},subscribeToContractors:t=>{const e=xt(Fe(ne,ki),an("name","asc"));return ds(e,n=>{const s=n.docs.map(No);t(s)})}},Ys={getAllContractors:()=>Ai.getAllContractors(),getContractorById:async t=>{const e=await Ai.getContractorById(t);if(!e)throw new Error("Contractor not found");return e},createContractor:t=>Ai.createContractor(t),updateContractor:(t,e)=>Ai.updateContractor(t,e),deleteContractor:t=>Ai.deleteContractor(t),subscribeToContractors:Ai.subscribeToContractors},Ei="construction_payments",xo=t=>{const e=t.data();let n=e.payments||[];if(typeof n=="string")try{n=JSON.parse(n)}catch{n=[]}Array.isArray(n)||(n=[]);const s=n.map(i=>{let a=i.types||[];if(typeof a=="string")try{a=JSON.parse(a)}catch{a=[a]}return Array.isArray(a)||(a=[]),{types:a,type:a[0]||i.type||"",amount:i.amount||0,date:i.date instanceof be?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof be?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof be?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof be?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof be?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:t.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:s,expectedPaymentDates:r,createdAt:e.createdAt instanceof be?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof be?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Vi={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const t=await Vt(Fe(ne,Ei));console.log("[ConstructionPayment] Firestore :",t.size," ");const e=t.docs.map(xo).filter(n=>n.project&&n.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(t){return console.error("[ConstructionPayment] Firestore  :",t),[]}},getConstructionPaymentById:async t=>{const e=Ce(ne,Ei,t),n=await It(e);return n.exists()?xo(n):null},createConstructionPayment:async t=>{const e=be.now(),n=(t.payments||[]).map(c=>({types:c.types,amount:c.amount,date:c.date instanceof Date?be.fromDate(c.date):c.date,method:c.method,notes:c.notes||""})),s={};t.expectedPaymentDates&&(t.expectedPaymentDates.contract&&(s.contract=t.expectedPaymentDates.contract instanceof Date?be.fromDate(t.expectedPaymentDates.contract):t.expectedPaymentDates.contract),t.expectedPaymentDates.start&&(s.start=t.expectedPaymentDates.start instanceof Date?be.fromDate(t.expectedPaymentDates.start):t.expectedPaymentDates.start),t.expectedPaymentDates.middle&&(s.middle=t.expectedPaymentDates.middle instanceof Date?be.fromDate(t.expectedPaymentDates.middle):t.expectedPaymentDates.middle),t.expectedPaymentDates.final&&(s.final=t.expectedPaymentDates.final instanceof Date?be.fromDate(t.expectedPaymentDates.final):t.expectedPaymentDates.final));const r={project:t.project,client:t.client,totalAmount:t.totalAmount,vatType:t.vatType,vatPercentage:t.vatPercentage,vatAmount:t.vatAmount,payments:n,expectedPaymentDates:s,createdAt:e,updatedAt:e},i=await Os(Fe(ne,Ei),r),a=await It(i);return xo(a)},updateConstructionPayment:async(t,e)=>{const n=Ce(ne,Ei,t),s={updatedAt:be.now()};if(e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.totalAmount!==void 0&&(s.totalAmount=e.totalAmount),e.vatType!==void 0&&(s.vatType=e.vatType),e.vatPercentage!==void 0&&(s.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(s.vatAmount=e.vatAmount),e.payments!==void 0&&(s.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?be.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?be.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?be.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?be.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?be.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),s.expectedPaymentDates=i}await Rt(n,s);const r=await It(n);return xo(r)},deleteConstructionPayment:async t=>{const e=Ce(ne,Ei,t);await Hn(e)},subscribeToConstructionPayments:t=>{const e=xt(Fe(ne,Ei),an("createdAt","desc"));return ds(e,n=>{const s=n.docs.map(xo);t(s)})}},Ta={getAllConstructionPayments:()=>Vi.getAllConstructionPayments(),getConstructionPaymentById:async t=>{const e=await Vi.getConstructionPaymentById(t);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:t=>Vi.createConstructionPayment(t),updateConstructionPayment:(t,e)=>Vi.updateConstructionPayment(t,e),deleteConstructionPayment:t=>Vi.deleteConstructionPayment(t),subscribeToConstructionPayments:Vi.subscribeToConstructionPayments};let Ja=new Map,vo=null;async function qA(){if(!(Ja.size>0))return vo||(vo=(async()=>{try{const t=Fe(ne,jt.PROJECTS);(await Vt(t)).docs.forEach(n=>{const s=n.data(),r=parseInt(n.id);!isNaN(r)&&s.name&&Ja.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",Ja.size,"")}catch(t){throw console.error("[executionRecordFirestoreService]    :",t),vo=null,t}})(),vo)}function Ci(t){return{id:t.id,project_id:t.projectId,project_name:t.projectName||"",author:t.author||"",date:t.date||"",process:t.process||"",item_name:t.itemName||"",material_cost:t.materialCost||0,labor_cost:t.laborCost||0,vat_amount:t.vatAmount||0,total_amount:t.totalAmount||0,notes:t.notes||"",images:t.images||[],payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,created_at:t.createdAt||"",updated_at:t.updatedAt||""}}function Cf(t){const e={};return t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.project_name!==void 0&&(e.projectName=t.project_name),t.projectName!==void 0&&(e.projectName=t.projectName),t.author!==void 0&&(e.author=t.author),t.date!==void 0&&(e.date=t.date),t.process!==void 0&&(e.process=t.process),t.item_name!==void 0&&(e.itemName=t.item_name),t.itemName!==void 0&&(e.itemName=t.itemName),t.material_cost!==void 0&&(e.materialCost=t.material_cost),t.materialCost!==void 0&&(e.materialCost=t.materialCost),t.labor_cost!==void 0&&(e.laborCost=t.labor_cost),t.laborCost!==void 0&&(e.laborCost=t.laborCost),t.vat_amount!==void 0&&(e.vatAmount=t.vat_amount),t.vatAmount!==void 0&&(e.vatAmount=t.vatAmount),t.total_amount!==void 0&&(e.totalAmount=t.total_amount),t.totalAmount!==void 0&&(e.totalAmount=t.totalAmount),t.notes!==void 0&&(e.notes=t.notes),t.images!==void 0&&(e.images=t.images),t.payment_id!==void 0&&(e.paymentId=t.payment_id),t.paymentId!==void 0&&(e.paymentId=t.paymentId),t.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=t.includes_tax_deduction===!0||t.includes_tax_deduction===1),t.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=t.includesTaxDeduction),t.includes_vat!==void 0&&(e.includesVAT=t.includes_vat===!0||t.includes_vat===1),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),e}const Qs={getAllRecords:async()=>{const t=Fe(ne,jt.EXECUTION_RECORDS),e=xt(t,an("id","desc"));return(await Vt(e)).docs.map(s=>{const r=s.data();return Ci({...r,id:parseInt(s.id)||r.id})})},getRecordById:async t=>{const e=Ce(ne,jt.EXECUTION_RECORDS,t),n=await It(e);if(n.exists()){const s=n.data();return Ci({...s,id:parseInt(n.id)||s.id})}return null},createRecord:async t=>{await qA();const e=Fe(ne,jt.EXECUTION_RECORDS),n=await Vt(e);let s=0;n.docs.forEach(h=>{const p=parseInt(h.id);!isNaN(p)&&p>s&&(s=p)});const r=s+1,i=Cf(t),a=new Date().toISOString();let c=i.projectId||0;const m=i.projectName||"";if((!c||c===0)&&m){const h=Ja.get(m);h?(c=h,console.log("[executionRecordFirestoreService]  ID :",m,"->",c)):console.warn("[executionRecordFirestoreService]   ID   :",m)}const u={id:r,projectId:c,projectName:m,author:i.author||"",date:i.date||a.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:a,updatedAt:a,images:[],imageCount:0},d=Ce(ne,jt.EXECUTION_RECORDS,String(r));if(await ii(d,u),i.images&&i.images.length>0)if(i.images.some(p=>Qi(p))){const p=await bl("execution_records",String(r),i.images);await Rt(d,{images:p,imageCount:p.length}),u.images=p,u.imageCount=p.length}else await Rt(d,{images:i.images,imageCount:i.images.length}),u.images=i.images,u.imageCount=i.images.length;return Ci(u)},updateRecord:async(t,e)=>{const n=Ce(ne,jt.EXECUTION_RECORDS,t),s=Cf(e);s.images!==void 0&&(s.images.some(a=>Qi(a))&&(s.images=await bl("execution_records",t,s.images)),s.imageCount=s.images.length),await Rt(n,{...s,updatedAt:new Date().toISOString()});const r=await Qs.getRecordById(t);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async t=>{const e=Ce(ne,jt.EXECUTION_RECORDS,t),n=await It(e);if(n.exists()){const s=n.data();s.images&&s.images.length>0&&await Zg(s.images)}await Hn(e)},subscribeToRecords:t=>{const e=Fe(ne,jt.EXECUTION_RECORDS),n=xt(e,an("id","desc"));return ds(n,s=>{const r=s.docs.map(i=>{const a=i.data();return Ci({...a,id:parseInt(i.id)||a.id})});t(r)})},getRecordsByProject:async t=>{const e=Fe(ne,jt.EXECUTION_RECORDS),n=xt(e,Rn("projectId","==",t),an("id","desc"));return(await Vt(n)).docs.map(r=>{const i=r.data();return Ci({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async t=>{const e=Fe(ne,jt.EXECUTION_RECORDS),n=xt(e,Rn("paymentId","==",t)),s=await Vt(n);if(s.empty)return null;const r=s.docs[0],i=r.data();return Ci({...i,id:parseInt(r.id)||i.id})}},ja={getAllRecords:()=>Qs.getAllRecords(),getRecordById:async t=>{const e=await Qs.getRecordById(t);if(!e)throw new Error("Execution record not found");return e},createRecord:t=>Qs.createRecord(t),updateRecord:(t,e)=>Qs.updateRecord(t,e),deleteRecord:t=>Qs.deleteRecord(t),subscribeToRecords:Qs.subscribeToRecords,getRecordsByProject:Qs.getRecordsByProject,getRecordByPaymentId:Qs.getRecordByPaymentId},Ir=ym()(Yg((t,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:n=>t({projects:n}),addProject:n=>t(s=>{const r={id:n.id,project:n.name,client:n.client,totalAmount:n.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[n,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(n,s)=>t(r=>({projects:r.projects.map(i=>i.id===n?{...i,...s}:i)})),deleteProject:n=>t(s=>({projects:s.projects.filter(r=>r.id!==n),constructionPayments:s.constructionPayments.filter(r=>r.id!==n)})),setSchedules:n=>t({schedules:n}),addSchedule:n=>t(s=>({schedules:[n,...s.schedules]})),updateSchedule:(n,s)=>t(r=>({schedules:r.schedules.map(i=>i.id===n?{...i,...s}:i)})),deleteSchedule:n=>t(s=>({schedules:s.schedules.filter(r=>r.id!==n)})),setPayments:n=>t({payments:n}),addPayment:n=>t(s=>({payments:[n,...s.payments]})),updatePayment:(n,s)=>t(r=>({payments:r.payments.map(i=>i.id===n?{...i,...s}:i)})),deletePayment:n=>t(s=>({payments:s.payments.filter(r=>r.id!==n)})),setContractors:n=>t({contractors:n}),addContractor:n=>t(s=>({contractors:[n,...s.contractors]})),updateContractor:(n,s)=>t(r=>({contractors:r.contractors.map(i=>i.id===n?{...i,...s}:i)})),deleteContractor:n=>t(s=>({contractors:s.contractors.filter(r=>r.id!==n)})),setConstructionPayments:n=>t({constructionPayments:n}),addConstructionPayment:n=>t(s=>({constructionPayments:[n,...s.constructionPayments]})),updateConstructionPayment:(n,s)=>t(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===n?{...i,...s}:i)})),deleteConstructionPayment:n=>t(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==n)})),setASRequests:n=>t({asRequests:n}),addASRequest:n=>t(s=>({asRequests:[n,...s.asRequests]})),updateASRequest:(n,s)=>t(r=>({asRequests:r.asRequests.map(i=>i.id===n?{...i,...s}:i)})),deleteASRequest:n=>t(s=>({asRequests:s.asRequests.filter(r=>r.id!==n)})),setExecutionRecords:n=>t({executionRecords:n}),addExecutionRecord:n=>{console.log("[dataStore]  :",n.id,n.itemName),t(s=>{const r=[n,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(n,s)=>t(r=>({executionRecords:r.executionRecords.map(i=>i.id===n?{...i,...s}:i)})),deleteExecutionRecord:n=>t(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==n)})),loadPaymentsFromAPI:async()=>{try{const n=await gs.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",n[0]);const s=n.map(d=>{var h;return{id:String(d.id),project:typeof d.project=="object"&&((h=d.project)!=null&&h.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const p=JSON.parse(d.images);return Array.isArray(p)?p:[]}catch(p){return console.error("  :",p),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.request_date||d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const h=i.get(d.id);h!=null&&h.completionDate?d.completionDate=h.completionDate:d.completionDate=new Date}});const a=new Set(s.map(d=>d.id)),c=3e4,m=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const u=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(a.has(d.id))return!1;const h=d._addedAt;return h&&m-h<c?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(m-h)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",u.length),console.log("[loadPaymentsFromAPI]   ID:",u.map(d=>d.id)),u.length>0){console.log(`[loadPaymentsFromAPI]  ${u.length}  `);const d=new Set(u.map(C=>C.id)),h=s.filter(C=>!d.has(C.id)),b=[...u.map(C=>({...C,_addedAt:Date.now()})),...h];console.log("[loadPaymentsFromAPI]   :",b.length),t({payments:b})}else console.log("[loadPaymentsFromAPI]    - API  "),t({payments:s})}catch(n){throw console.error("Failed to load payments from API:",n),n}},addPaymentToAPI:async n=>{const s=`temp_${Date.now()}`,r={...n,id:s,_addedAt:Date.now(),_tempId:s};t(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const a=e().projects.find(h=>h.name===n.project),m={projectId:a?a.id:n.project,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,status:n.status||"pending",category:n.category,urgency:n.urgency,requestedBy:n.requestedBy,bankInfo:n.bankInfo,notes:n.notes,attachments:[],materialAmount:n.materialAmount||0,laborAmount:n.laborAmount||0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};console.log("[addPaymentToAPI] Sending payment data:",m);const u=await gs.createPayment(m),d=String(u.id);return t(h=>({payments:h.payments.map(p=>p._tempId===s?{...p,id:d,_addedAt:Date.now()}:p)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),t(a=>({payments:a.payments.filter(c=>c._tempId!==s)})),i}},updatePaymentInAPI:async(n,s)=>{try{if(s.status&&Object.keys(s).length===1)await gs.updatePaymentStatus(n,s.status);else{let r=s.project;if(s.project){const a=e().projects.find(c=>c.name===s.project);r=a?a.id:s.project}await gs.updatePayment(n,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}t(r=>({payments:r.payments.map(i=>i.id===n?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async n=>{try{await gs.deletePayment(n),t(s=>({payments:s.payments.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const n=await La.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",n[0]);const s=n.map(r=>{var a;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(c=>c.trim()):[r.assigneeNames]:((a=r.assignedTo)==null?void 0:a.map(c=>typeof c=="object"?c.name:c))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const a=parseInt(r.id)||0,c=parseInt(i.id)||0;return a-c}),t({schedules:s})}catch(n){throw console.error("Failed to load schedules from API:",n),n}},addScheduleToAPI:async n=>{var i,a;const s=(i=n.id)!=null&&i.startsWith("temp_")?n.id:`temp_${Date.now()}`,r={...n,id:s};t(c=>({schedules:[...c.schedules,r]}));try{const c=await La.createSchedule({project:n.project||"",title:n.title,type:n.type,startDate:n.start,endDate:n.end,allDay:!n.time||n.time==="-",location:n.location,assignedTo:n.attendees||[],description:n.description,asRequestId:n.asRequestId,time:n.time}),m=n.attendees||[];let u=c.assigneeNames||((a=c.assignedTo)==null?void 0:a.map(h=>typeof h=="object"?h.name:h))||[];m.length>0&&u.length>m.length&&(u=m);const d={id:c._id,title:c.title,start:new Date(c.startDate),end:new Date(c.endDate),type:c.type,project:typeof c.project=="object"?c.project.name:c.project,location:c.location,attendees:u,description:c.description,time:c.time};t(h=>({schedules:h.schedules.map(p=>p.id===s?d:p)}))}catch(c){throw console.error("Failed to add schedule to API:",c),t(m=>({schedules:m.schedules.filter(u=>u.id!==s)})),c}},updateScheduleInAPI:async(n,s)=>{var r,i,a;try{console.log(" updateScheduleInAPI called with:",{id:n,updatedSchedule:s});const c={};s.project!==void 0&&(c.project=s.project),s.title!==void 0&&(c.title=s.title),s.type!==void 0&&(c.type=s.type),s.start!==void 0&&(c.startDate=s.start),s.end!==void 0&&(c.endDate=s.end),s.location!==void 0&&(c.location=s.location),s.description!==void 0&&(c.description=s.description),s.attendees!==void 0&&(c.assignedTo=s.attendees),s.time!==void 0&&(c.time=s.time),console.log(" Sending update data:",c);const m=await La.updateSchedule(n,c);console.log(" updateScheduleInAPI response:",m);const u={id:m._id,title:m.title,start:new Date(m.startDate),end:new Date(m.endDate),type:m.type,project:typeof m.project=="object"?m.project.name:m.project,location:m.location,attendees:m.assigneeNames||((r=m.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:m.description,time:m.time};t(d=>({schedules:d.schedules.map(h=>h.id===n?u:h)}))}catch(c){throw console.error("Failed to update schedule in API:",c),console.error("Error details:",{message:c instanceof Error?c.message:"Unknown error",response:c&&typeof c=="object"&&"response"in c?(i=c.response)==null?void 0:i.data:void 0,status:c&&typeof c=="object"&&"response"in c?(a=c.response)==null?void 0:a.status:void 0}),c}},deleteScheduleFromAPI:async n=>{var i;const{schedules:s}=e(),r=s.find(a=>a.id===n);if(r){t(a=>({schedules:a.schedules.filter(c=>c.id!==n)}));try{n.startsWith("temp_")||await La.deleteSchedule(n)}catch(a){const c=a,m=(i=c==null?void 0:c.response)==null?void 0:i.status;if(m===404||m===502||m===503||m===504){console.log("Schedule delete - ignoring error (status:",m,"):",n);return}throw console.error("Failed to delete schedule from API:",a),r&&t(u=>({schedules:[...u.schedules,r]})),a}}},loadProjectsFromAPI:async()=>{try{const s=(await Ui.getAllProjects()).map(r=>{var i,a;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((a=r.customerRequests)==null?void 0:a.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});t({projects:s})}catch(n){throw console.error("Failed to load projects from API:",n),n}},addProjectToAPI:async n=>{var s,r;try{const i=await Ui.createProject({name:n.name,client:n.client,location:n.location,startDate:n.startDate,endDate:n.endDate,status:n.status,contractAmount:n.contractAmount,spent:n.spent,manager:n.manager,team:n.team,progress:n.progress,description:n.description}),a={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};t(c=>({projects:[a,...c.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(n,s)=>{var r,i;try{const a=await Ui.updateProject(n,s),c={id:a._id||a.id,name:a.name,client:typeof a.client=="object"?a.client.name:a.client||"",location:typeof a.location=="object"?a.location.address:a.location||a.address||"",status:a.status==="inProgress"?"in-progress":a.status==="onHold"?"on-hold":a.status,progress:a.progress||0,startDate:a.startDate||a.start_date?new Date(a.startDate||a.start_date):void 0,endDate:a.endDate||a.end_date?new Date(a.endDate||a.end_date):void 0,contractAmount:a.budget||a.contractAmount||0,spent:a.actualCost||a.spent||0,manager:typeof a.manager=="object"&&a.manager!==null?a.manager.name||"":a.manager||"",team:[],description:a.description||"",meetingNotes:((r=a.meetingNotes)==null?void 0:r.map(m=>({id:m.id,content:m.content,date:new Date(m.date)})))||[],customerRequests:((i=a.customerRequests)==null?void 0:i.map(m=>({id:m.id,content:m.content,completed:m.completed,createdAt:new Date(m.createdAt)})))||[],entrancePassword:a.entrancePassword||"",sitePassword:a.sitePassword||""};t(m=>({projects:m.projects.map(u=>u.id===n?c:u)}))}catch(a){throw console.error("Failed to update project in API:",a),a}},deleteProjectFromAPI:async n=>{try{await Ui.deleteProject(n),t(s=>({projects:s.projects.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await Ys.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));t({contractors:s})}catch(n){throw console.error("Failed to load contractors from API:",n),n}},addContractorToAPI:async n=>{try{const s=await Ys.createContractor({rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};t(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(n,s)=>{try{const r=await Ys.updateContractor(n,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};t(a=>({contractors:a.contractors.map(c=>c.id===n?i:c)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async n=>{try{await Ys.deleteContractor(n),t(s=>({contractors:s.contractors.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await Ta.getAllConstructionPayments()).map(r=>{var a;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((a=r.payments)==null?void 0:a.map(c=>{var d;const m=c.date?new Date(c.date):new Date,u=isNaN(m.getTime())?new Date:m;return{type:c.type||((d=c.types)==null?void 0:d[0])||"",amount:c.amount,date:u,method:c.method,notes:c.notes}}))||[]}});t({constructionPayments:s})}catch(n){throw console.error("Failed to load construction payments from API:",n),n}},addConstructionPaymentToAPI:async n=>{var s;try{const r=await Ta.createConstructionPayment(n),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(a=>{var u;const c=a.date?new Date(a.date):new Date,m=isNaN(c.getTime())?new Date:c;return{type:a.type||((u=a.types)==null?void 0:u[0])||"",amount:a.amount,date:m,method:a.method,notes:a.notes}}))||[]};t(a=>({constructionPayments:[i,...a.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(n,s)=>{var r;try{const i=await Ta.updateConstructionPayment(n,s);let a;i.expectedPaymentDates&&(a={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const c={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:a,payments:((r=i.payments)==null?void 0:r.map(m=>{var u;return{type:m.type||((u=m.types)==null?void 0:u[0])||"",amount:m.amount,date:new Date(m.date),method:m.method,notes:m.notes}}))||[]};t(m=>({constructionPayments:m.constructionPayments.map(u=>u.id===n?c:u)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async n=>{try{await Ta.deleteConstructionPayment(n),t(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await Io.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));t({asRequests:s})}catch(n){throw console.error("Failed to load AS requests from API:",n),n}},addASRequestToAPI:async n=>{try{const s=await Io.createASRequest(n),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return t(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(n,s)=>{try{const r=await Io.updateASRequest(n,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};t(a=>({asRequests:a.asRequests.map(c=>c.id===n?i:c)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async n=>{try{await Io.deleteASRequest(n),t(s=>({asRequests:s.asRequests.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const n=await ja.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",n.length,"records");const s=n.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));t({executionRecords:s})}catch(n){throw console.error("Failed to load execution records from API:",n),n}},addExecutionRecordToAPI:async n=>{try{console.log("[addExecutionRecordToAPI] Adding:",n.itemName,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat);const s=await ja.createRecord({project_name:n.project,author:n.author,date:n.date.toISOString().split("T")[0],process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),t(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(n,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",n,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await ja.updateRecord(n,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),t(i=>({executionRecords:i.executionRecords.map(a=>a.id===n?{...a,...s,updatedAt:new Date}:a)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async n=>{try{await ja.deleteRecord(n),t(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:t=>({...t,payments:t.payments.map(e=>{const{images:n,...s}=e;return s}),executionRecords:t.executionRecords.map(e=>{const{images:n,...s}=e;return s})}),storage:{getItem:t=>{var m,u,d,h,p,b,C;const e=localStorage.getItem(t);if(!e)return null;const{state:n}=JSON.parse(e),s=((m=n.projects)==null?void 0:m.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((u=n.constructionPayments)==null?void 0:u.map(v=>{var S;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((S=v.payments)==null?void 0:S.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),a=s.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),c=[...r,...a];return{state:{...n,projects:s,schedules:((d=n.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((h=n.payments)==null?void 0:h.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((p=n.contractors)==null?void 0:p.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:c,asRequests:((b=n.asRequests)==null?void 0:b.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((C=n.executionRecords)==null?void 0:C.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(t,e)=>{try{const n=JSON.stringify(e);localStorage.setItem(t,n)}catch(n){console.error("[dataStore] localStorage  :",n),n instanceof DOMException&&n.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:t=>localStorage.removeItem(t)}}));var pa=t=>t.type==="checkbox",Jr=t=>t instanceof Date,Zn=t=>t==null;const ey=t=>typeof t=="object";var _n=t=>!Zn(t)&&!Array.isArray(t)&&ey(t)&&!Jr(t),$A=t=>_n(t)&&t.target?pa(t.target)?t.target.checked:t.target.value:t,WA=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,zA=(t,e)=>t.has(WA(e)),KA=t=>{const e=t.constructor&&t.constructor.prototype;return _n(e)&&e.hasOwnProperty("isPrototypeOf")},Nu=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Tn(t){let e;const n=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(Nu&&(t instanceof Blob||s))&&(n||_n(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!KA(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=Tn(t[r]));else return t;return e}var zl=t=>/^\w*$/.test(t),yn=t=>t===void 0,xu=t=>Array.isArray(t)?t.filter(Boolean):[],vu=t=>xu(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Re=(t,e,n)=>{if(!e||!_n(t))return n;const s=(zl(e)?[e]:vu(e)).reduce((r,i)=>Zn(r)?r:r[i],t);return yn(s)||s===t?yn(t[e])?n:t[e]:s},js=t=>typeof t=="boolean",Gt=(t,e,n)=>{let s=-1;const r=zl(e)?[e]:vu(e),i=r.length,a=i-1;for(;++s<i;){const c=r[s];let m=n;if(s!==a){const u=t[c];m=_n(u)||Array.isArray(u)?u:isNaN(+r[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=m,t=t[c]}};const wf={BLUR:"blur",FOCUS_OUT:"focusout"},Ds={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},zs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},QA=it.createContext(null);QA.displayName="HookFormContext";var YA=(t,e,n,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(r,i,{get:()=>{const a=i;return e._proxyFormState[a]!==Ds.all&&(e._proxyFormState[a]=!s||Ds.all),t[a]}});return r};const GA=typeof window<"u"?it.useLayoutEffect:it.useEffect;var ls=t=>typeof t=="string",XA=(t,e,n,s,r)=>ls(t)?(s&&e.watch.add(t),Re(n,t,r)):Array.isArray(t)?t.map(i=>(s&&e.watch.add(i),Re(n,i))):(s&&(e.watchAll=!0),n),mm=t=>Zn(t)||!ey(t);function yr(t,e,n=new WeakSet){if(mm(t)||mm(e))return t===e;if(Jr(t)&&Jr(e))return t.getTime()===e.getTime();const s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of s){const a=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const c=e[i];if(Jr(a)&&Jr(c)||_n(a)&&_n(c)||Array.isArray(a)&&Array.isArray(c)?!yr(a,c,n):a!==c)return!1}}return!0}var JA=(t,e,n,s,r)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[s]:r||!0}}:{},Uo=t=>Array.isArray(t)?t:[t],Sf=()=>{let t=[];return{get observers(){return t},next:r=>{for(const i of t)i.next&&i.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(i=>i!==r)}}),unsubscribe:()=>{t=[]}}};function ty(t,e){const n={};for(const s in t)if(t.hasOwnProperty(s)){const r=t[s],i=e[s];if(r&&_n(r)&&i){const a=ty(r,i);_n(a)&&(n[s]=a)}else t[s]&&(n[s]=i)}return n}var ss=t=>_n(t)&&!Object.keys(t).length,_u=t=>t.type==="file",ks=t=>typeof t=="function",Nl=t=>{if(!Nu)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ny=t=>t.type==="select-multiple",Du=t=>t.type==="radio",ZA=t=>Du(t)||pa(t),Cc=t=>Nl(t)&&t.isConnected;function eE(t,e){const n=e.slice(0,-1).length;let s=0;for(;s<n;)t=yn(t)?s++:t[e[s++]];return t}function tE(t){for(const e in t)if(t.hasOwnProperty(e)&&!yn(t[e]))return!1;return!0}function hn(t,e){const n=Array.isArray(e)?e:zl(e)?[e]:vu(e),s=n.length===1?t:eE(t,n),r=n.length-1,i=n[r];return s&&delete s[i],r!==0&&(_n(s)&&ss(s)||Array.isArray(s)&&tE(s))&&hn(t,n.slice(0,-1)),t}var nE=t=>{for(const e in t)if(ks(t[e]))return!0;return!1};function sy(t){return Array.isArray(t)||_n(t)&&!nE(t)}function um(t,e={}){for(const n in t)sy(t[n])?(e[n]=Array.isArray(t[n])?[]:{},um(t[n],e[n])):Zn(t[n])||(e[n]=!0);return e}function Bi(t,e,n){n||(n=um(e));for(const s in t)sy(t[s])?yn(e)||mm(n[s])?n[s]=um(t[s],Array.isArray(t[s])?[]:{}):Bi(t[s],Zn(e)?{}:e[s],n[s]):n[s]=!yr(t[s],e[s]);return n}const If={value:!1,isValid:!1},Pf={value:!0,isValid:!0};var ry=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!yn(t[0].attributes.value)?yn(t[0].value)||t[0].value===""?Pf:{value:t[0].value,isValid:!0}:Pf:If}return If},iy=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:s})=>yn(t)?t:e?t===""?NaN:t&&+t:n&&ls(t)?new Date(t):s?s(t):t;const Lf={isValid:!1,value:null};var oy=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,Lf):Lf;function Tf(t){const e=t.ref;return _u(e)?e.files:Du(e)?oy(t.refs).value:ny(e)?[...e.selectedOptions].map(({value:n})=>n):pa(e)?ry(t.refs).value:iy(yn(e.value)?t.ref.value:e.value,t)}var sE=(t,e,n,s)=>{const r={};for(const i of t){const a=Re(e,i);a&&Gt(r,i,a._f)}return{criteriaMode:n,names:[...t],fields:r,shouldUseNativeValidation:s}},xl=t=>t instanceof RegExp,_o=t=>yn(t)?t:xl(t)?t.source:_n(t)?xl(t.value)?t.value.source:t.value:t,jf=t=>({isOnSubmit:!t||t===Ds.onSubmit,isOnBlur:t===Ds.onBlur,isOnChange:t===Ds.onChange,isOnAll:t===Ds.all,isOnTouch:t===Ds.onTouched});const Rf="AsyncFunction";var rE=t=>!!t&&!!t.validate&&!!(ks(t.validate)&&t.validate.constructor.name===Rf||_n(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Rf)),iE=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Bf=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const Ho=(t,e,n,s)=>{for(const r of n||Object.keys(t)){const i=Re(t,r);if(i){const{_f:a,...c}=i;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],r)&&!s)return!0;if(a.ref&&e(a.ref,a.name)&&!s)return!0;if(Ho(c,e))break}else if(_n(c)&&Ho(c,e))break}}};function Uf(t,e,n){const s=Re(t,n);if(s||zl(n))return{error:s,name:n};const r=n.split(".");for(;r.length;){const i=r.join("."),a=Re(e,i),c=Re(t,i);if(a&&!Array.isArray(a)&&n!==i)return{name:n};if(c&&c.type)return{name:i,error:c};if(c&&c.root&&c.root.type)return{name:`${i}.root`,error:c.root};r.pop()}return{name:n}}var oE=(t,e,n,s)=>{n(t);const{name:r,...i}=t;return ss(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(a=>e[a]===(!s||Ds.all))},aE=(t,e,n)=>!t||!e||t===e||Uo(t).some(s=>s&&(n?s===e:s.startsWith(e)||e.startsWith(s))),lE=(t,e,n,s,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(e||t):(n?s.isOnBlur:r.isOnBlur)?!t:(n?s.isOnChange:r.isOnChange)?t:!0,cE=(t,e)=>!xu(Re(t,e)).length&&hn(t,e),mE=(t,e,n)=>{const s=Uo(Re(t,n));return Gt(s,"root",e[n]),Gt(t,n,s),t};function Hf(t,e,n="validate"){if(ls(t)||Array.isArray(t)&&t.every(ls)||js(t)&&!t)return{type:n,message:ls(t)?t:"",ref:e}}var wi=t=>_n(t)&&!xl(t)?t:{value:t,message:""},Mf=async(t,e,n,s,r,i)=>{const{ref:a,refs:c,required:m,maxLength:u,minLength:d,min:h,max:p,pattern:b,validate:C,name:v,valueAsNumber:S,mount:B}=t._f,L=Re(n,v);if(!B||e.has(v))return{};const W=c?c[0]:a,ie=P=>{r&&W.reportValidity&&(W.setCustomValidity(js(P)?"":P||""),W.reportValidity())},ee={},F=Du(a),A=pa(a),x=F||A,E=(S||_u(a))&&yn(a.value)&&yn(L)||Nl(a)&&a.value===""||L===""||Array.isArray(L)&&!L.length,j=JA.bind(null,v,s,ee),I=(P,D,Ae,Ue=zs.maxLength,ge=zs.minLength)=>{const Se=P?D:Ae;ee[v]={type:P?Ue:ge,message:Se,ref:a,...j(P?Ue:ge,Se)}};if(i?!Array.isArray(L)||!L.length:m&&(!x&&(E||Zn(L))||js(L)&&!L||A&&!ry(c).isValid||F&&!oy(c).isValid)){const{value:P,message:D}=ls(m)?{value:!!m,message:m}:wi(m);if(P&&(ee[v]={type:zs.required,message:D,ref:W,...j(zs.required,D)},!s))return ie(D),ee}if(!E&&(!Zn(h)||!Zn(p))){let P,D;const Ae=wi(p),Ue=wi(h);if(!Zn(L)&&!isNaN(L)){const ge=a.valueAsNumber||L&&+L;Zn(Ae.value)||(P=ge>Ae.value),Zn(Ue.value)||(D=ge<Ue.value)}else{const ge=a.valueAsDate||new Date(L),Se=Ht=>new Date(new Date().toDateString()+" "+Ht),tt=a.type=="time",Ut=a.type=="week";ls(Ae.value)&&L&&(P=tt?Se(L)>Se(Ae.value):Ut?L>Ae.value:ge>new Date(Ae.value)),ls(Ue.value)&&L&&(D=tt?Se(L)<Se(Ue.value):Ut?L<Ue.value:ge<new Date(Ue.value))}if((P||D)&&(I(!!P,Ae.message,Ue.message,zs.max,zs.min),!s))return ie(ee[v].message),ee}if((u||d)&&!E&&(ls(L)||i&&Array.isArray(L))){const P=wi(u),D=wi(d),Ae=!Zn(P.value)&&L.length>+P.value,Ue=!Zn(D.value)&&L.length<+D.value;if((Ae||Ue)&&(I(Ae,P.message,D.message),!s))return ie(ee[v].message),ee}if(b&&!E&&ls(L)){const{value:P,message:D}=wi(b);if(xl(P)&&!L.match(P)&&(ee[v]={type:zs.pattern,message:D,ref:a,...j(zs.pattern,D)},!s))return ie(D),ee}if(C){if(ks(C)){const P=await C(L,n),D=Hf(P,W);if(D&&(ee[v]={...D,...j(zs.validate,D.message)},!s))return ie(D.message),ee}else if(_n(C)){let P={};for(const D in C){if(!ss(P)&&!s)break;const Ae=Hf(await C[D](L,n),W,D);Ae&&(P={...Ae,...j(D,Ae.message)},ie(Ae.message),s&&(ee[v]=P))}if(!ss(P)&&(ee[v]={ref:W,...P},!s))return ee}}return ie(!0),ee};const uE={mode:Ds.onSubmit,reValidateMode:Ds.onChange,shouldFocusError:!0};function dE(t={}){let e={...uE,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:ks(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=_n(e.defaultValues)||_n(e.values)?Tn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Tn(r),a={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},m,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const p={array:Sf(),state:Sf()},b=e.criteriaMode===Ds.all,C=T=>$=>{clearTimeout(u),u=setTimeout(T,$)},v=async T=>{if(!e.disabled&&(d.isValid||h.isValid||T)){const $=e.resolver?ss((await A()).errors):await E(s,!0);$!==n.isValid&&p.state.next({isValid:$})}},S=(T,$)=>{!e.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((T||Array.from(c.mount)).forEach(X=>{X&&($?Gt(n.validatingFields,X,$):hn(n.validatingFields,X))}),p.state.next({validatingFields:n.validatingFields,isValidating:!ss(n.validatingFields)}))},B=(T,$=[],X,ye,le=!0,de=!0)=>{if(ye&&X&&!e.disabled){if(a.action=!0,de&&Array.isArray(Re(s,T))){const Ee=X(Re(s,T),ye.argA,ye.argB);le&&Gt(s,T,Ee)}if(de&&Array.isArray(Re(n.errors,T))){const Ee=X(Re(n.errors,T),ye.argA,ye.argB);le&&Gt(n.errors,T,Ee),cE(n.errors,T)}if((d.touchedFields||h.touchedFields)&&de&&Array.isArray(Re(n.touchedFields,T))){const Ee=X(Re(n.touchedFields,T),ye.argA,ye.argB);le&&Gt(n.touchedFields,T,Ee)}(d.dirtyFields||h.dirtyFields)&&(n.dirtyFields=Bi(r,i)),p.state.next({name:T,isDirty:I(T,$),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Gt(i,T,$)},L=(T,$)=>{Gt(n.errors,T,$),p.state.next({errors:n.errors})},W=T=>{n.errors=T,p.state.next({errors:n.errors,isValid:!1})},ie=(T,$,X,ye)=>{const le=Re(s,T);if(le){const de=Re(i,T,yn(X)?Re(r,T):X);yn(de)||ye&&ye.defaultChecked||$?Gt(i,T,$?de:Tf(le._f)):Ae(T,de),a.mount&&v()}},ee=(T,$,X,ye,le)=>{let de=!1,Ee=!1;const Ke={name:T};if(!e.disabled){if(!X||ye){(d.isDirty||h.isDirty)&&(Ee=n.isDirty,n.isDirty=Ke.isDirty=I(),de=Ee!==Ke.isDirty);const Ze=yr(Re(r,T),$);Ee=!!Re(n.dirtyFields,T),Ze?hn(n.dirtyFields,T):Gt(n.dirtyFields,T,!0),Ke.dirtyFields=n.dirtyFields,de=de||(d.dirtyFields||h.dirtyFields)&&Ee!==!Ze}if(X){const Ze=Re(n.touchedFields,T);Ze||(Gt(n.touchedFields,T,X),Ke.touchedFields=n.touchedFields,de=de||(d.touchedFields||h.touchedFields)&&Ze!==X)}de&&le&&p.state.next(Ke)}return de?Ke:{}},F=(T,$,X,ye)=>{const le=Re(n.errors,T),de=(d.isValid||h.isValid)&&js($)&&n.isValid!==$;if(e.delayError&&X?(m=C(()=>L(T,X)),m(e.delayError)):(clearTimeout(u),m=null,X?Gt(n.errors,T,X):hn(n.errors,T)),(X?!yr(le,X):le)||!ss(ye)||de){const Ee={...ye,...de&&js($)?{isValid:$}:{},errors:n.errors,name:T};n={...n,...Ee},p.state.next(Ee)}},A=async T=>{S(T,!0);const $=await e.resolver(i,e.context,sE(T||c.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return S(T),$},x=async T=>{const{errors:$}=await A(T);if(T)for(const X of T){const ye=Re($,X);ye?Gt(n.errors,X,ye):hn(n.errors,X)}else n.errors=$;return $},E=async(T,$,X={valid:!0})=>{for(const ye in T){const le=T[ye];if(le){const{_f:de,...Ee}=le;if(de){const Ke=c.array.has(de.name),Ze=le._f&&rE(le._f);Ze&&d.validatingFields&&S([de.name],!0);const Ne=await Mf(le,c.disabled,i,b,e.shouldUseNativeValidation&&!$,Ke);if(Ze&&d.validatingFields&&S([de.name]),Ne[de.name]&&(X.valid=!1,$))break;!$&&(Re(Ne,de.name)?Ke?mE(n.errors,Ne,de.name):Gt(n.errors,de.name,Ne[de.name]):hn(n.errors,de.name))}!ss(Ee)&&await E(Ee,$,X)}}return X.valid},j=()=>{for(const T of c.unMount){const $=Re(s,T);$&&($._f.refs?$._f.refs.every(X=>!Cc(X)):!Cc($._f.ref))&&nt(T)}c.unMount=new Set},I=(T,$)=>!e.disabled&&(T&&$&&Gt(i,T,$),!yr(Ht(),r)),P=(T,$,X)=>XA(T,c,{...a.mount?i:yn($)?r:ls(T)?{[T]:$}:$},X,$),D=T=>xu(Re(a.mount?i:r,T,e.shouldUnregister?Re(r,T,[]):[])),Ae=(T,$,X={})=>{const ye=Re(s,T);let le=$;if(ye){const de=ye._f;de&&(!de.disabled&&Gt(i,T,iy($,de)),le=Nl(de.ref)&&Zn($)?"":$,ny(de.ref)?[...de.ref.options].forEach(Ee=>Ee.selected=le.includes(Ee.value)):de.refs?pa(de.ref)?de.refs.forEach(Ee=>{(!Ee.defaultChecked||!Ee.disabled)&&(Array.isArray(le)?Ee.checked=!!le.find(Ke=>Ke===Ee.value):Ee.checked=le===Ee.value||!!le)}):de.refs.forEach(Ee=>Ee.checked=Ee.value===le):_u(de.ref)?de.ref.value="":(de.ref.value=le,de.ref.type||p.state.next({name:T,values:Tn(i)})))}(X.shouldDirty||X.shouldTouch)&&ee(T,le,X.shouldTouch,X.shouldDirty,!0),X.shouldValidate&&Ut(T)},Ue=(T,$,X)=>{for(const ye in $){if(!$.hasOwnProperty(ye))return;const le=$[ye],de=T+"."+ye,Ee=Re(s,de);(c.array.has(T)||_n(le)||Ee&&!Ee._f)&&!Jr(le)?Ue(de,le,X):Ae(de,le,X)}},ge=(T,$,X={})=>{const ye=Re(s,T),le=c.array.has(T),de=Tn($);Gt(i,T,de),le?(p.array.next({name:T,values:Tn(i)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&X.shouldDirty&&p.state.next({name:T,dirtyFields:Bi(r,i),isDirty:I(T,de)})):ye&&!ye._f&&!Zn(de)?Ue(T,de,X):Ae(T,de,X),Bf(T,c)&&p.state.next({...n,name:T}),p.state.next({name:a.mount?T:void 0,values:Tn(i)})},Se=async T=>{a.mount=!0;const $=T.target;let X=$.name,ye=!0;const le=Re(s,X),de=Ze=>{ye=Number.isNaN(Ze)||Jr(Ze)&&isNaN(Ze.getTime())||yr(Ze,Re(i,X,Ze))},Ee=jf(e.mode),Ke=jf(e.reValidateMode);if(le){let Ze,Ne;const fn=$.type?Tf(le._f):$A(T),Pt=T.type===wf.BLUR||T.type===wf.FOCUS_OUT,st=!iE(le._f)&&!e.resolver&&!Re(n.errors,X)&&!le._f.deps||lE(Pt,Re(n.touchedFields,X),n.isSubmitted,Ke,Ee),sn=Bf(X,c,Pt);Gt(i,X,fn),Pt?(!$||!$.readOnly)&&(le._f.onBlur&&le._f.onBlur(T),m&&m(0)):le._f.onChange&&le._f.onChange(T);const V=ee(X,fn,Pt),oe=!ss(V)||sn;if(!Pt&&p.state.next({name:X,type:T.type,values:Tn(i)}),st)return(d.isValid||h.isValid)&&(e.mode==="onBlur"?Pt&&v():Pt||v()),oe&&p.state.next({name:X,...sn?{}:V});if(!Pt&&sn&&p.state.next({...n}),e.resolver){const{errors:De}=await A([X]);if(de(fn),ye){const Be=Uf(n.errors,s,X),ue=Uf(De,s,Be.name||X);Ze=ue.error,X=ue.name,Ne=ss(De)}}else S([X],!0),Ze=(await Mf(le,c.disabled,i,b,e.shouldUseNativeValidation))[X],S([X]),de(fn),ye&&(Ze?Ne=!1:(d.isValid||h.isValid)&&(Ne=await E(s,!0)));ye&&(le._f.deps&&(!Array.isArray(le._f.deps)||le._f.deps.length>0)&&Ut(le._f.deps),F(X,Ne,Ze,V))}},tt=(T,$)=>{if(Re(n.errors,$)&&T.focus)return T.focus(),1},Ut=async(T,$={})=>{let X,ye;const le=Uo(T);if(e.resolver){const de=await x(yn(T)?T:le);X=ss(de),ye=T?!le.some(Ee=>Re(de,Ee)):X}else T?(ye=(await Promise.all(le.map(async de=>{const Ee=Re(s,de);return await E(Ee&&Ee._f?{[de]:Ee}:Ee)}))).every(Boolean),!(!ye&&!n.isValid)&&v()):ye=X=await E(s);return p.state.next({...!ls(T)||(d.isValid||h.isValid)&&X!==n.isValid?{}:{name:T},...e.resolver||!T?{isValid:X}:{},errors:n.errors}),$.shouldFocus&&!ye&&Ho(s,tt,T?le:c.mount),ye},Ht=(T,$)=>{let X={...a.mount?i:r};return $&&(X=ty($.dirtyFields?n.dirtyFields:n.touchedFields,X)),yn(T)?X:ls(T)?Re(X,T):T.map(ye=>Re(X,ye))},ae=(T,$)=>({invalid:!!Re(($||n).errors,T),isDirty:!!Re(($||n).dirtyFields,T),error:Re(($||n).errors,T),isValidating:!!Re(n.validatingFields,T),isTouched:!!Re(($||n).touchedFields,T)}),Me=T=>{T&&Uo(T).forEach($=>hn(n.errors,$)),p.state.next({errors:T?n.errors:{}})},fe=(T,$,X)=>{const ye=(Re(s,T,{_f:{}})._f||{}).ref,le=Re(n.errors,T)||{},{ref:de,message:Ee,type:Ke,...Ze}=le;Gt(n.errors,T,{...Ze,...$,ref:ye}),p.state.next({name:T,errors:n.errors,isValid:!1}),X&&X.shouldFocus&&ye&&ye.focus&&ye.focus()},Ie=(T,$)=>ks(T)?p.state.subscribe({next:X=>"values"in X&&T(P(void 0,$),X)}):P(T,$,!0),ze=T=>p.state.subscribe({next:$=>{aE(T.name,$.name,T.exact)&&oE($,T.formState||d,gt,T.reRenderRoot)&&T.callback({values:{...i},...n,...$,defaultValues:r})}}).unsubscribe,bt=T=>(a.mount=!0,h={...h,...T.formState},ze({...T,formState:h})),nt=(T,$={})=>{for(const X of T?Uo(T):c.mount)c.mount.delete(X),c.array.delete(X),$.keepValue||(hn(s,X),hn(i,X)),!$.keepError&&hn(n.errors,X),!$.keepDirty&&hn(n.dirtyFields,X),!$.keepTouched&&hn(n.touchedFields,X),!$.keepIsValidating&&hn(n.validatingFields,X),!e.shouldUnregister&&!$.keepDefaultValue&&hn(r,X);p.state.next({values:Tn(i)}),p.state.next({...n,...$.keepDirty?{isDirty:I()}:{}}),!$.keepIsValid&&v()},Ct=({disabled:T,name:$})=>{(js(T)&&a.mount||T||c.disabled.has($))&&(T?c.disabled.add($):c.disabled.delete($))},ot=(T,$={})=>{let X=Re(s,T);const ye=js($.disabled)||js(e.disabled);return Gt(s,T,{...X||{},_f:{...X&&X._f?X._f:{ref:{name:T}},name:T,mount:!0,...$}}),c.mount.add(T),X?Ct({disabled:js($.disabled)?$.disabled:e.disabled,name:T}):ie(T,!0,$.value),{...ye?{disabled:$.disabled||e.disabled}:{},...e.progressive?{required:!!$.required,min:_o($.min),max:_o($.max),minLength:_o($.minLength),maxLength:_o($.maxLength),pattern:_o($.pattern)}:{},name:T,onChange:Se,onBlur:Se,ref:le=>{if(le){ot(T,$),X=Re(s,T);const de=yn(le.value)&&le.querySelectorAll&&le.querySelectorAll("input,select,textarea")[0]||le,Ee=ZA(de),Ke=X._f.refs||[];if(Ee?Ke.find(Ze=>Ze===de):de===X._f.ref)return;Gt(s,T,{_f:{...X._f,...Ee?{refs:[...Ke.filter(Cc),de,...Array.isArray(Re(r,T))?[{}]:[]],ref:{type:de.type,name:T}}:{ref:de}}}),ie(T,!1,void 0,de)}else X=Re(s,T,{}),X._f&&(X._f.mount=!1),(e.shouldUnregister||$.shouldUnregister)&&!(zA(c.array,T)&&a.action)&&c.unMount.add(T)}}},Nt=()=>e.shouldFocusError&&Ho(s,tt,c.mount),Xt=T=>{js(T)&&(p.state.next({disabled:T}),Ho(s,($,X)=>{const ye=Re(s,X);ye&&($.disabled=ye._f.disabled||T,Array.isArray(ye._f.refs)&&ye._f.refs.forEach(le=>{le.disabled=ye._f.disabled||T}))},0,!1))},Q=(T,$)=>async X=>{let ye;X&&(X.preventDefault&&X.preventDefault(),X.persist&&X.persist());let le=Tn(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:Ee}=await A();n.errors=de,le=Tn(Ee)}else await E(s);if(c.disabled.size)for(const de of c.disabled)hn(le,de);if(hn(n.errors,"root"),ss(n.errors)){p.state.next({errors:{}});try{await T(le,X)}catch(de){ye=de}}else $&&await $({...n.errors},X),Nt(),setTimeout(Nt);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ss(n.errors)&&!ye,submitCount:n.submitCount+1,errors:n.errors}),ye)throw ye},Pe=(T,$={})=>{Re(s,T)&&(yn($.defaultValue)?ge(T,Tn(Re(r,T))):(ge(T,$.defaultValue),Gt(r,T,Tn($.defaultValue))),$.keepTouched||hn(n.touchedFields,T),$.keepDirty||(hn(n.dirtyFields,T),n.isDirty=$.defaultValue?I(T,Tn(Re(r,T))):I()),$.keepError||(hn(n.errors,T),d.isValid&&v()),p.state.next({...n}))},qe=(T,$={})=>{const X=T?Tn(T):r,ye=Tn(X),le=ss(T),de=le?r:ye;if($.keepDefaultValues||(r=X),!$.keepValues){if($.keepDirtyValues){const Ee=new Set([...c.mount,...Object.keys(Bi(r,i))]);for(const Ke of Array.from(Ee))Re(n.dirtyFields,Ke)?Gt(de,Ke,Re(i,Ke)):ge(Ke,Re(de,Ke))}else{if(Nu&&yn(T))for(const Ee of c.mount){const Ke=Re(s,Ee);if(Ke&&Ke._f){const Ze=Array.isArray(Ke._f.refs)?Ke._f.refs[0]:Ke._f.ref;if(Nl(Ze)){const Ne=Ze.closest("form");if(Ne){Ne.reset();break}}}}if($.keepFieldsRef)for(const Ee of c.mount)ge(Ee,Re(de,Ee));else s={}}i=e.shouldUnregister?$.keepDefaultValues?Tn(r):{}:Tn(de),p.array.next({values:{...de}}),p.state.next({values:{...de}})}c={mount:$.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!d.isValid||!!$.keepIsValid||!!$.keepDirtyValues,a.watch=!!e.shouldUnregister,p.state.next({submitCount:$.keepSubmitCount?n.submitCount:0,isDirty:le?!1:$.keepDirty?n.isDirty:!!($.keepDefaultValues&&!yr(T,r)),isSubmitted:$.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:le?{}:$.keepDirtyValues?$.keepDefaultValues&&i?Bi(r,i):n.dirtyFields:$.keepDefaultValues&&T?Bi(r,T):$.keepDirty?n.dirtyFields:{},touchedFields:$.keepTouched?n.touchedFields:{},errors:$.keepErrors?n.errors:{},isSubmitSuccessful:$.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Le=(T,$)=>qe(ks(T)?T(i):T,$),$e=(T,$={})=>{const X=Re(s,T),ye=X&&X._f;if(ye){const le=ye.refs?ye.refs[0]:ye.ref;le.focus&&(le.focus(),$.shouldSelect&&ks(le.select)&&le.select())}},gt=T=>{n={...n,...T}},ct={control:{register:ot,unregister:nt,getFieldState:ae,handleSubmit:Q,setError:fe,_subscribe:ze,_runSchema:A,_focusError:Nt,_getWatch:P,_getDirty:I,_setValid:v,_setFieldArray:B,_setDisabledField:Ct,_setErrors:W,_getFieldArray:D,_reset:qe,_resetDefaultValues:()=>ks(e.defaultValues)&&e.defaultValues().then(T=>{Le(T,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:Xt,_subjects:p,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return a},set _state(T){a=T},get _defaultValues(){return r},get _names(){return c},set _names(T){c=T},get _formState(){return n},get _options(){return e},set _options(T){e={...e,...T}}},subscribe:bt,trigger:Ut,register:ot,handleSubmit:Q,watch:Ie,setValue:ge,getValues:Ht,reset:Le,resetField:Pe,clearErrors:Me,unregister:nt,setError:fe,setFocus:$e,getFieldState:ae};return{...ct,formControl:ct}}function ku(t={}){const e=it.useRef(void 0),n=it.useRef(void 0),[s,r]=it.useState({isDirty:!1,isValidating:!1,isLoading:ks(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ks(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:s},t.defaultValues&&!ks(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:a,...c}=dE(t);e.current={...c,formState:s}}const i=e.current.control;return i._options=t,GA(()=>{const a=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(c=>({...c,isReady:!0})),i._formState.isReady=!0,a},[i]),it.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),it.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),it.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),it.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),it.useEffect(()=>{if(i._proxyFormState.isDirty){const a=i._getDirty();a!==s.isDirty&&i._subjects.state.next({isDirty:a})}},[i,s.isDirty]),it.useEffect(()=>{t.values&&!yr(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),n.current=t.values,r(a=>({...a}))):i._resetDefaultValues()},[i,t.values]),it.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=YA(s,i),e.current}const Ff=["","","","","","",""],ay=({event:t,slotInfo:e,defaultProjectName:n,onClose:s,onSave:r,onDelete:i})=>{const[a,c]=k.useState(!1),{register:m,handleSubmit:u,setValue:d,watch:h,formState:{errors:p},reset:b}=ku({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:C}=Ir(),[v,S]=k.useState([]),[B,L]=k.useState(""),[W,ie]=k.useState(!1),[ee,F]=k.useState(""),[A,x]=k.useState(9),[E,j]=k.useState(0),[I,P]=k.useState(""),D=h("projectId");k.useEffect(()=>{if(D){const ae=C.find(Me=>Me.id===D||Me.id===parseInt(D)||Me.id.toString()===D.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[D,C,v]),k.useEffect(()=>{console.log(" Modal mount - initializing states"),S([]),P(""),L("")},[]),k.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!t,eventId:t==null?void 0:t.id,hasSlotInfo:!!e,hasMergedEvents:!!(t!=null&&t.mergedEventIds)}),t&&t.id){console.log(" ScheduleModal processing event:",{title:t.title,projectId:t.projectId,projectName:t.projectName,start:t.start,assignedTo:t.assignedTo,time:t.time});const ae=t.originalTitle||t.title,Me=/ - (|) \d{1,2}$/,fe=ae.replace(Me,"");if(d("title",fe,{shouldValidate:!1,shouldDirty:!1}),d("date",Mt(t.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",t.description||"",{shouldValidate:!1,shouldDirty:!1}),t.projectId&&t.projectId!==""&&t.projectId!=="undefined")console.log(" Setting projectId from event:",t.projectId),d("projectId",t.projectId,{shouldValidate:!1,shouldDirty:!1}),P("");else if(t.projectName){const ze=C.find(bt=>bt.name===t.projectName);console.log(" Finding project by name:",t.projectName,"found:",ze),ze?(console.log(" Setting projectId from found project:",ze.id),d("projectId",ze.id,{shouldValidate:!1,shouldDirty:!1}),P("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),P(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),P("");const Ie=t.assignedTo||t.attendees||[];if(console.log(" Setting selectedMembers to:",Ie),S(Array.isArray(Ie)?Ie:[]),t.time&&t.time!=="-"){console.log(" Setting time from event:",{eventTime:t.time,parsedHours:t.time.split(":")[0],parsedMinutes:t.time.split(":")[1]}),ie(!0);const[ze,bt]=t.time.split(":"),nt=parseInt(ze,10),Ct=parseInt(bt,10);nt>=12?(F(""),x(nt===12?12:nt-12)):(F(""),x(nt===0?12:nt)),j(Ct),console.log(" Time state set:",{hasTime:!0,period:nt>=12?"":"",hour:nt>=12?nt===12?12:nt-12:nt===0?12:nt,minute:Ct})}else console.log(" No time in event, setting hasTime to false"),ie(!1),F(""),x(9),j(0)}else if(e&&!t&&(console.log(" New schedule from slot:",e),b({projectId:"",title:"",date:Mt(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),S([]),P(""),n)){const ae=C.find(Me=>Me.name===n);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[t==null?void 0:t.id]);const Ae=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),S(Me=>{console.log(" Previous members in setState:",Me);const fe=Me.includes(ae)?Me.filter(Ie=>Ie!==ae):[...Me,ae];return console.log(" Updated members after toggle:",fe),fe})},Ue=()=>{const ae="HV LAB";v.includes(ae)?S(Me=>Me.filter(fe=>fe!==ae)):S(Me=>[...Me.filter(fe=>fe!==""),ae])},ge=()=>{const ae="";v.includes(ae)?S(Me=>Me.filter(fe=>fe!==ae)):S(Me=>[...Me,ae])},Se=()=>{const ae="";v.includes(ae)?S(Me=>Me.filter(fe=>fe!==ae)):S(Me=>[...Me,ae])},tt=()=>{B.trim()&&!v.includes(B.trim())&&(S(ae=>[...ae,B.trim()]),L(""))},Ut=ae=>{S(Me=>Me.filter(fe=>fe!==ae))},Ht=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",W),console.log(" timePeriod:",ee,"timeHour:",A,"timeMinute:",E),console.log(" Available projects:",C.map(ot=>({id:ot.id,name:ot.name,idType:typeof ot.id}))),console.log(" Merged event IDs:",t==null?void 0:t.mergedEventIds);const Me=/ - (|) \d{1,2}$/,fe=ae.title.replace(Me,"").trim();let Ie="",ze="";if(ae.projectId){const ot=C.find(Nt=>Nt.id===ae.projectId||Nt.id===parseInt(ae.projectId)||Nt.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",ot),Ie=(ot==null?void 0:ot.name)||"",ze=ae.projectId}else Ie="",ze="";console.log(" Final projectId:",ze,"projectName:",Ie,"cleanedTitle:",fe);const bt=new Date(ae.date);let nt="-";if(W){let ot=A;ee===""&&A!==12?ot=A+12:ee===""&&A===12&&(ot=0),nt=`${ot.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`,console.log(" Time calculated:",nt)}else console.log(" No time set (hasTime is false)");const Ct={...t,title:fe,start:bt,end:bt,projectId:ze,projectName:Ie,assignedTo:v,description:ae.description||"",time:nt,mergedEventIds:t==null?void 0:t.mergedEventIds};if(!a){c(!0),console.log(" Calling onSave with newEvent:",Ct);try{await r(Ct),console.log(" onSave completed successfully")}catch(ot){throw console.error(" onSave failed:",ot),ot}finally{c(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:u(Ht),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),o.jsxDEV("select",{...m("projectId"),className:"input w-full",children:[o.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),C.filter(ae=>t!=null&&t.isASVisit?!0:ae.status!=="completed").map(ae=>o.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),o.jsxDEV("input",{...m("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),p.title&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),o.jsxDEV("input",{...m("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),p.date&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(p.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),o.jsxDEV("div",{className:"mb-2",children:o.jsxDEV("button",{type:"button",onClick:()=>ie(!W),className:`px-3 py-1.5 text-xs rounded border transition-colors ${W?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:W?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),W&&o.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsxDEV("div",{className:"flex gap-1",children:[o.jsxDEV("button",{type:"button",onClick:()=>F(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),o.jsxDEV("button",{type:"button",onClick:()=>F(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),o.jsxDEV("select",{value:A,onChange:ae=>x(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>o.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),o.jsxDEV("select",{value:E,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>o.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[o.jsxDEV("button",{type:"button",onClick:Ue,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:ge,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:Se,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Ff.map(ae=>o.jsxDEV("button",{type:"button",onClick:()=>Ae(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!Ff.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>o.jsxDEV("button",{type:"button",onClick:()=>Ut(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:B,onChange:ae=>L(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),tt())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:tt,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),o.jsxDEV("textarea",{...m("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[o.jsxDEV("div",{children:t&&o.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(t.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[o.jsxDEV(ni,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[o.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),o.jsxDEV("button",{type:"submit",disabled:a,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:a?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},dm=t=>{if(!t||t==="-")return"";const[e,n]=t.split(":"),s=parseInt(e,10),r=parseInt(n,10),i=s>=12?"":"",a=s%12||12;return r>0?`${i} ${a} ${r}`:`${i} ${a}`},vl=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Mo=t=>{if(!t)return t;const e=t.replace(/$/g,"").trim(),n=e.split(" ");if(n.length>=2){const s=n[n.length-1];for(const r of vl)if(s===r)return n.slice(0,-1).join(" ").trim()}for(const s of vl)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},Ra=t=>{const e=t.replace(/$/g,"").trim(),n=e.split(" ");if(n.length>=2){const s=n[n.length-1];for(const r of vl)if(s===r)return r}for(const s of vl)if(e.endsWith(s))return s;return""},fE=["","","","","","",""],pE=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],wc=["","","/","","","","","","","","","","","","",""],hE={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},gE={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Of=fE,yE=()=>{const{schedules:t,loadSchedulesFromAPI:e,addScheduleToAPI:n,deleteScheduleFromAPI:s}=Ir(),{user:r}=Br(),[i,a]=k.useState(!1);k.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const c=r!=null&&r.name?r.name.slice(-2):null,m=(r==null?void 0:r.name)===""?[""]:c?[c,...Of.filter(d=>d!==c)]:Of,u=d=>{const h=t.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),p=v=>{const S=new Set;return v.filter(B=>{const W=`${Mt(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return S.has(W)?!1:(S.add(W),!0)})},b=p(h.filter(v=>Ju(new Date(v.start)))),C=p(h.filter(v=>Fb(new Date(v.start))&&!Ju(new Date(v.start))).sort((v,S)=>new Date(v.start).getTime()-new Date(S.start).getTime())).slice(0,3);return{todaySchedules:b,upcomingSchedules:C,member:d}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[o.jsxDEV("div",{children:o.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:m.map(d=>{const{todaySchedules:h,upcomingSchedules:p}=u(d),b=h.length+p.length,C=d===c;return o.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${C?"ring-1 ring-gray-300":""}`,children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),C&&o.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[C&&o.jsxDEV("button",{onClick:()=>a(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:o.jsxDEV(Hi,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),o.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${C&&h.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),o.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[p.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),h.length>0&&o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(cp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((S,B)=>{const L=B.project||"-";return S[L]||(S[L]=[]),S[L].push(B),S},{});return Object.entries(v).map(([S,B])=>{const L=d===c;return o.jsxDEV("div",{className:`border-l-3 ${L?"border-gray-400":"border-gray-900"} ${L?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[o.jsxDEV("div",{className:`px-3 py-1 ${L?"bg-amber-100":"bg-gray-100"} border-b ${L?"border-amber-200":"border-gray-200"}`,children:o.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:S},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(W=>{const ie=W.time&&W.time!=="-"?` - ${dm(W.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",W.title,ie]},W.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},S,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),p.length>0&&o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(wb,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=p.reduce((S,B)=>{const L=Mt(new Date(B.start),"MM.dd",{locale:bn}),W=B.project||"-",ie=`${L}|${W}`;return S[ie]||(S[ie]={date:L,project:W,schedules:[]}),S[ie].schedules.push(B),S},{});return Object.values(v).map(({date:S,project:B,schedules:L})=>{const ie=L.length>0&&Mb(new Date(L[0].start))?`${S} ()`:S;return o.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[o.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:ie},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:L.map(ee=>{const F=ee.time&&ee.time!=="-"?` - ${dm(ee.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,F]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${S}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),b===0&&o.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&o.jsxDEV(ay,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>a(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await n({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),a(!1)}catch(h){console.error("Failed to add schedule:",h),alert("  : "+(h instanceof Error?h.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),a(!1)}catch(h){console.error("Failed to delete schedule:",h),alert("  : "+(h instanceof Error?h.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},Kl=()=>{const{user:t}=Br(),{projects:e}=Ir();return k.useMemo(()=>t?t.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(c=>c.trim()):[]).includes(""),a=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||a}):e:[],[t,e])},bE=({value:t,detailValue:e="",onChange:n,onDetailChange:s,placeholder:r=" ",error:i})=>{const[a,c]=k.useState(!1),[m,u]=k.useState(t),[d,h]=k.useState(e),p=k.useRef(null);k.useEffect(()=>{const B=L=>{p.current&&!p.current.contains(L.target)&&c(!1)};return a&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[a]),k.useEffect(()=>{u(t)},[t]),k.useEffect(()=>{h(e)},[e]);const b=()=>new Promise((B,L)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const W=document.createElement("script");W.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",W.async=!0,W.onload=()=>B(!0),W.onerror=()=>L(new Error("Kakao Postcode   ")),document.head.appendChild(W)}),C=B=>{const L=B.roadAddr||B.jibunAddr;u(L),n(L,d),c(!1)},v=B=>{const L=B.target.value;h(L),s&&s(L),m&&n(m,L)},S=async()=>{try{(!window.daum||!window.daum.Postcode)&&await b(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const L={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};C(L)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("div",{className:"relative flex-1",children:[o.jsxDEV("input",{type:"text",value:m,onClick:()=>S(),onChange:B=>{u(B.target.value),n(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),o.jsxDEV(mp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),o.jsxDEV("button",{type:"button",onClick:S,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),o.jsxDEV("div",{children:o.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!m},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),m&&o.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsxDEV("p",{className:"text-sm text-gray-600",children:[o.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",m,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),o.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},qf=["","","","","","",""],NE=({project:t,onClose:e,onSave:n})=>{const{register:s,handleSubmit:r,setValue:i,reset:a,formState:{errors:c}}=ku({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[m,u]=k.useState([]),[d,h]=k.useState(""),[p,b]=k.useState(""),[C,v]=k.useState(""),[S,B]=k.useState(!1);k.useEffect(()=>{var F;if(t){const A=t.location?t.location.split(","):["",""],x=((F=A[0])==null?void 0:F.trim())||t.location||"",E=A.length>1?A.slice(1).join(",").trim():"";a({name:t.name,client:t.client||"",location:x,detailLocation:E,startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate?new Date(t.endDate).toISOString().split("T")[0]:""}),b(x),v(E);const j=t.manager?t.manager.split(",").map(I=>I.trim()).filter(I=>I&&I!==""):[];u(j)}else a({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),b(""),v(""),u([])},[t,a]);const L=F=>{u(A=>A.includes(F)?A.filter(x=>x!==F):[...A,F])},W=()=>{d.trim()&&!m.includes(d.trim())&&(u(F=>[...F,d.trim()]),h(""))},ie=F=>{u(A=>A.filter(x=>x!==F))},ee=async F=>{if(S)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",F);const A=p&&C?`${p}, ${C}`:p||F.location,x={name:F.name,client:F.client,location:A,manager:m.join(", "),contractAmount:(t==null?void 0:t.contractAmount)??0,spent:(t==null?void 0:t.spent)??0,status:(t==null?void 0:t.status)??"planning",progress:(t==null?void 0:t.progress)??0,description:(t==null?void 0:t.description)??"",meetingNotes:(t==null?void 0:t.meetingNotes)??[],customerRequests:(t==null?void 0:t.customerRequests)??[],entrancePassword:(t==null?void 0:t.entrancePassword)??"",sitePassword:(t==null?void 0:t.sitePassword)??""};if(F.startDate&&F.startDate!=="")x.startDate=F.startDate,console.log(" Setting startDate from form:",F.startDate);else if(t!=null&&t.startDate){const E=typeof t.startDate=="string"&&t.startDate.includes("T")?t.startDate.split("T")[0]:t.startDate;x.startDate=E,console.log(" Keeping existing startDate:",x.startDate)}if(F.endDate&&F.endDate!=="")x.endDate=F.endDate,console.log(" Setting endDate from form:",F.endDate);else if(t!=null&&t.endDate){const E=typeof t.endDate=="string"&&t.endDate.includes("T")?t.endDate.split("T")[0]:t.endDate;x.endDate=E,console.log(" Keeping existing endDate:",x.endDate)}console.log(" ProjectModal onSubmit - Final formData:",x);try{await n(x)}catch(E){throw B(!1),E}};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),o.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),c.name&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(c.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),o.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),o.jsxDEV(bE,{value:p,detailValue:C,onChange:(F,A)=>{b(F),v(A||""),i("location",F),i("detailLocation",A||"")},onDetailChange:F=>{v(F),i("detailLocation",F)},placeholder:"  ",required:!0,error:c.location?String(c.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),o.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),o.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[qf.map(F=>o.jsxDEV("button",{type:"button",onClick:()=>L(F),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${m.includes(F)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F},F,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),m.filter(F=>!qf.includes(F)).map(F=>o.jsxDEV("button",{type:"button",onClick:()=>ie(F),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[F," "]},F,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:d,onChange:F=>h(F.target.value),onKeyPress:F=>{F.key==="Enter"&&(F.preventDefault(),W())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:W,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[o.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:S,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:S?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},xE=({projectName:t,meetingNotes:e,onClose:n,onSave:s,onDelete:r})=>{const[i,a]=k.useState(""),[c,m]=k.useState(new Date().toISOString().split("T")[0]),[u,d]=k.useState(!1),[h,p]=k.useState(!1),b=()=>{d(!0),a(""),m(new Date().toISOString().split("T")[0])},C=async()=>{if(!h){if(!i.trim()){alert(" ");return}if(!c){alert(" ");return}p(!0);try{await s(i.trim(),new Date(c)),a(""),m(new Date().toISOString().split("T")[0]),d(!1)}finally{p(!1)}}},v=()=>{a(""),m(new Date().toISOString().split("T")[0]),d(!1)},S=B=>{window.confirm("   ?")&&r(B)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!u&&o.jsxDEV("button",{onClick:b,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),u&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:c,onChange:B=>m(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),o.jsxDEV("textarea",{value:i,onChange:B=>a(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:C,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),o.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-3",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>o.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Mt(new Date(B.date),"yyyy.MM.dd (eee)",{locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>S(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},vE=({projectName:t,customerRequests:e,onClose:n,onSave:s,onToggleComplete:r,onDelete:i})=>{const[a,c]=k.useState(""),[m,u]=k.useState(new Date().toISOString().split("T")[0]),[d,h]=k.useState(!1),[p,b]=k.useState(!1),C=()=>{h(!0),c(""),u(new Date().toISOString().split("T")[0])},v=async()=>{if(!p){if(!a.trim()){alert(" ");return}if(!m){alert(" ");return}b(!0);try{await s(a.trim(),new Date(m)),c(""),u(new Date().toISOString().split("T")[0]),h(!1)}finally{b(!1)}}},S=()=>{c(""),u(new Date().toISOString().split("T")[0]),h(!1)},B=ee=>{window.confirm("  ?")&&i(ee)},L=ee=>{r(ee)},W=e.filter(ee=>!ee.completed),ie=e.filter(ee=>ee.completed);return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&o.jsxDEV("button",{onClick:C,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:m,onChange:ee=>u(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),o.jsxDEV("textarea",{value:a,onChange:ee=>c(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:v,disabled:p,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:p?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),o.jsxDEV("button",{onClick:S,disabled:p,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):o.jsxDEV(o.Fragment,{children:[W.map(ee=>o.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>L(ee.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Sb,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Mt(new Date(ee.createdAt),"yyyy.MM.dd",{locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),ie.map(ee=>o.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>L(ee.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Ib,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Mt(new Date(ee.createdAt),"yyyy.MM.dd",{locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>B(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},_E=({projectName:t,entrancePassword:e,sitePassword:n,onClose:s,onSave:r})=>{const[i,a]=k.useState(e||""),[c,m]=k.useState(n||""),[u,d]=k.useState(!1),[h,p]=k.useState(!1),b=()=>{d(!0)},C=async()=>{if(!h){p(!0);try{await r(i,c),d(!1)}finally{p(!1)}}},v=()=>{a(e||""),m(n||""),d(!1)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:S=>S.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:i,onChange:S=>a(S.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:c,onChange:S=>m(S.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:c?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:u?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:C,disabled:h,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),o.jsxDEV("button",{onClick:v,disabled:h,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},DE=({projectName:t,onClose:e})=>{var a;const[n,s]=k.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=c=>{const m=Number(c.replace(/,/g,""));return isNaN(m)?"":m.toLocaleString()};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.clientName,onChange:c=>s({...n,clientName:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.phoneNumber,onChange:c=>s({...n,phoneNumber:c.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.address,onChange:c=>s({...n,address:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:n.startDate,onChange:c=>s({...n,startDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:n.endDate,onChange:c=>s({...n,endDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.area,onChange:c=>s({...n,area:c.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:i(n.designFee),onChange:c=>{const m=c.target.value.replace(/,/g,"");/^\d*$/.test(m)&&s({...n,designFee:m})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.bankAccount,onChange:c=>s({...n,bankAccount:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),o.jsxDEV("button",{onClick:r,disabled:!n.clientName||!n.phoneNumber||!n.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(up,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-16",children:o.jsxDEV("div",{className:"space-y-16",children:[o.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.startDate&&n.endDate?o.jsxDEV(o.Fragment,{children:[Mt(new Date(n.startDate),"yyyy",{locale:bn}),"",Mt(new Date(n.startDate),"MM",{locale:bn}),"",Mt(new Date(n.startDate),"dd",{locale:bn})," ~ ",Mt(new Date(n.endDate),"yyyy",{locale:bn}),"",Mt(new Date(n.endDate),"MM",{locale:bn}),"",Mt(new Date(n.endDate),"dd",{locale:bn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),o.jsxDEV("span",{className:"flex-1",children:[n.designFee?`${i(n.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),n.bankAccount&&o.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:n.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-20 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",n.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",(a=n.clientName)==null?void 0:a.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),o.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",n.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),o.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",n.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),o.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:o.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),o.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),o.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},kE=()=>{const{loadProjectsFromAPI:t,addProjectToAPI:e,updateProjectInAPI:n,deleteProjectFromAPI:s}=Ir(),{user:r}=Br(),i=Kl(),[a,c]=k.useState("in-progress"),[m,u]=k.useState("grid"),[d,h]=k.useState(!1),[p,b]=k.useState(null),[C,v]=k.useState(!1),[S,B]=k.useState(!1),[L,W]=k.useState(!1),[ie,ee]=k.useState(!1),[F,A]=k.useState(null),x=(Q,Pe)=>`lastViewed_${r==null?void 0:r.id}_${Q}_${Pe}`,E=(Q,Pe)=>{const qe=x(Q,Pe),Le=localStorage.getItem(qe);return Le?parseInt(Le,10):0},j=(Q,Pe)=>{const qe=x(Q,Pe);localStorage.setItem(qe,Date.now().toString())},I=(Q,Pe)=>{const qe=E(Q.id,Pe);return Pe==="meeting"?(Q.meetingNotes||[]).some($e=>($e.createdAt?new Date($e.createdAt).getTime():new Date($e.date).getTime())>qe):(Q.customerRequests||[]).some($e=>!$e.completed)};k.useEffect(()=>{t().catch(Q=>{console.error("Failed to load projects:",Q),te.error("   ")})},[t]),k.useEffect(()=>{const Q=()=>{b(null),h(!0)};return window.addEventListener("headerAddButtonClick",Q),()=>window.removeEventListener("headerAddButtonClick",Q)},[]);const P=(Q,Pe)=>{if(!Q||!Pe)return 0;const qe=new Date,Le=new Date(Q),$e=new Date(Pe);if(qe<Le)return 0;if(qe>$e)return 100;const gt=Math.ceil(($e.getTime()-Le.getTime())/(1e3*60*60*24)),Ot=Math.ceil((qe.getTime()-Le.getTime())/(1e3*60*60*24)),ct=Math.round(Ot/gt*100);return Math.min(100,Math.max(0,ct))},D=Q=>{b(Q),h(!0)},Ae=async(Q,Pe)=>{if(window.confirm(`"${Pe}"  ?

    .`))try{await s(Q),te.success(" ")}catch(qe){console.error("Failed to delete project:",qe),te.error("  ")}},Ue=async Q=>{try{if(p)await n(p.id,Q),te.success(" ");else{const Pe={id:"",...Q,team:Q.team||[]};await e(Pe),te.success(" "),c(Q.status||"planning")}h(!1),b(null)}catch(Pe){console.error("Failed to save project:",Pe),te.error("  ")}},ge=async(Q,Pe)=>{try{await n(Q,{status:Pe}),te.success(" ")}catch(qe){console.error("Failed to update project status:",qe),te.error("  ")}},Se=Q=>{A(Q),v(!0),j(Q.id,"meeting")},tt=Q=>{A(Q),B(!0),j(Q.id,"request")},Ut=Q=>{A(Q),W(!0)},Ht=Q=>{A(Q),ee(!0)},ae=async(Q,Pe)=>{if(!F)return;const qe=F.entrancePassword,Le=F.sitePassword;A({...F,entrancePassword:Q,sitePassword:Pe});try{await n(F.id,{entrancePassword:Q,sitePassword:Pe}),te.success(" ")}catch($e){console.error("Failed to save passwords:",$e),te.error("  "),A({...F,entrancePassword:qe,sitePassword:Le})}},Me=async(Q,Pe)=>{if(!F)return;const qe={id:Date.now().toString(),content:Q,date:Pe,createdAt:new Date},Le=[...F.meetingNotes||[],qe];A({...F,meetingNotes:Le});try{await n(F.id,{meetingNotes:Le}),te.success("  ")}catch($e){console.error("Failed to save meeting note:",$e),te.error("   "),A({...F,meetingNotes:F.meetingNotes||[]})}},fe=async(Q,Pe)=>{if(!F)return;const qe={id:Date.now().toString(),content:Q,completed:!1,createdAt:Pe},Le=[...F.customerRequests||[],qe];A({...F,customerRequests:Le});try{await n(F.id,{customerRequests:Le}),te.success("  ")}catch($e){console.error("Failed to save customer request:",$e),te.error("   "),A({...F,customerRequests:F.customerRequests||[]})}},Ie=async Q=>{if(!F)return;const Pe=F.customerRequests||[],qe=Pe.map(Le=>Le.id===Q?{...Le,completed:!Le.completed}:Le);A({...F,customerRequests:qe});try{await n(F.id,{customerRequests:qe}),te.success("  ")}catch(Le){console.error("Failed to toggle request:",Le),te.error("  "),A({...F,customerRequests:Pe})}},ze=async Q=>{if(!F)return;const Pe=F.meetingNotes||[],qe=Pe.filter(Le=>Le.id!==Q);A({...F,meetingNotes:qe});try{await n(F.id,{meetingNotes:qe}),te.success("  ")}catch(Le){console.error("Failed to delete meeting note:",Le),te.error(" "),A({...F,meetingNotes:Pe})}},bt=async Q=>{if(!F)return;const Pe=F.customerRequests||[],qe=Pe.filter(Le=>Le.id!==Q);A({...F,customerRequests:qe});try{await n(F.id,{customerRequests:qe}),te.success("  ")}catch(Le){console.error("Failed to delete customer request:",Le),te.error(" "),A({...F,customerRequests:Pe})}},nt=({project:Q})=>{const qe={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[Q.status];return o.jsxDEV("select",{value:Q.status,onChange:Le=>ge(Q.id,Le.target.value),className:vs("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",qe.color),onClick:Le=>Le.stopPropagation(),children:[o.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),o.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),o.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),o.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},ot=(()=>{let Q=i;return a!=="all"&&(Q=Q.filter(Pe=>Pe.status===a)),r!=null&&r.name&&(Q=[...Q].sort((Pe,qe)=>{var gt,Ot;const Le=Pe.manager===r.name||((gt=Pe.team)==null?void 0:gt.includes(r.name)),$e=qe.manager===r.name||((Ot=qe.team)==null?void 0:Ot.includes(r.name));return Le&&!$e?-1:!Le&&$e?1:0})),Q})(),Nt={planning:i.filter(Q=>Q.status==="planning").length,inProgress:i.filter(Q=>Q.status==="in-progress").length,completed:i.filter(Q=>Q.status==="completed").length,onHold:i.filter(Q=>Q.status==="on-hold").length},Xt=({project:Q})=>{var qe,Le,$e;const Pe=P(Q.startDate,Q.endDate);return o.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&o.jsxDEV("button",{onClick:()=>Ht(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),o.jsxDEV(nt,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>D(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),o.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.startDate&&Q.endDate?`${Mt(Q.startDate,"MM.dd (eee)",{locale:bn})} - ${Mt(Q.endDate,"MM.dd (eee)",{locale:bn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),o.jsxDEV("div",{className:"mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:o.jsxDEV("button",{onClick:()=>Ut(Q),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[o.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),o.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),o.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:o.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),o.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[o.jsxDEV("div",{onClick:()=>Se(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((qe=Q.meetingNotes)==null?void 0:qe.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Le=Q.meetingNotes)==null?void 0:Le.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),I(Q,"meeting")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),Q.meetingNotes&&Q.meetingNotes.length>0?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:(($e=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:$e.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var ct;const gt=((ct=Q.customerRequests)==null?void 0:ct.filter(T=>!T.completed))||[],Ot=gt[gt.length-1];return o.jsxDEV("div",{onClick:()=>tt(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",gt.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",gt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),I(Q,"request")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Ot?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Ot.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("div",{className:"flex justify-end pt-1",children:o.jsxDEV("button",{onClick:()=>Ae(Q.id,Q.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:Nt.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:Nt.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:Nt.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(Q=>o.jsxDEV("button",{onClick:()=>c(Q.id),className:vs("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",a===Q.id?`border-gray-700 ${Q.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[Q.label,o.jsxDEV("span",{className:vs("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",a===Q.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:Q.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[o.jsxDEV("button",{onClick:()=>u("grid"),className:vs("px-3 md:px-4 py-2 text-xs md:text-sm",m==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>u("list"),className:vs("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",m==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{b(null),h(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[o.jsxDEV(Hi,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),o.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),m==="grid"||window.innerWidth<768?o.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:ot.map(Q=>o.jsxDEV(Xt,{project:Q},Q.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):o.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:o.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsxDEV("thead",{className:"bg-gray-50",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:ot.map(Q=>{var qe,Le,$e,gt;const Pe=P(Q.startDate,Q.endDate);return o.jsxDEV("tr",{className:"hover:bg-gray-50",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{children:[o.jsxDEV("p",{className:"font-medium",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:Q.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("p",{className:"text-sm",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q.startDate&&Q.endDate?o.jsxDEV(o.Fragment,{children:[Mt(Q.startDate,"yyyy.MM.dd (eee)",{locale:bn})," -",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Mt(Q.endDate,"yyyy.MM.dd (eee)",{locale:bn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&o.jsxDEV("button",{onClick:()=>Ht(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),o.jsxDEV(nt,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("button",{onClick:()=>Ut(Q),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:o.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-sm",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[o.jsxDEV("div",{onClick:()=>Se(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((qe=Q.meetingNotes)==null?void 0:qe.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Le=Q.meetingNotes)==null?void 0:Le.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),I(Q,"meeting")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:($e=Q.meetingNotes)!=null&&$e.length?((gt=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:gt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var T;const Ot=((T=Q.customerRequests)==null?void 0:T.filter($=>!$.completed))||[],ct=Ot[Ot.length-1];return o.jsxDEV("div",{onClick:()=>tt(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Ot.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",Ot.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),I(Q,"request")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:ct?ct.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),o.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[o.jsxDEV("button",{onClick:()=>D(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("button",{onClick:()=>Ae(Q.id,Q.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&o.jsxDEV(NE,{project:p,onClose:()=>{h(!1),b(null)},onSave:Ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),C&&F&&o.jsxDEV(xE,{projectName:F.name,meetingNotes:F.meetingNotes||[],onClose:()=>{v(!1),A(null)},onSave:Me,onDelete:ze},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),S&&F&&o.jsxDEV(vE,{projectName:F.name,customerRequests:F.customerRequests||[],onClose:()=>{B(!1),A(null)},onSave:fe,onToggleComplete:Ie,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),L&&F&&o.jsxDEV(_E,{projectName:F.name,entrancePassword:F.entrancePassword||"",sitePassword:F.sitePassword||"",onClose:()=>{W(!1),A(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),ie&&F&&o.jsxDEV(DE,{projectName:F.name,onClose:()=>{ee(!1),A(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var Au={},ly={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ly);var Kn=ly.exports,Eu={},cy={exports:{}},my={exports:{}},uy={exports:{}},dy={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(dy);var no=dy.exports,fy={exports:{}};(function(t){var e=no.default;function n(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,r||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(fy);var AE=fy.exports;(function(t){var e=no.default,n=AE;function s(r){var i=n(r,"string");return e(i)=="symbol"?i:i+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(uy);var py=uy.exports;(function(t){var e=py;function n(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(my);var hy=my.exports;(function(t){var e=hy;function n(r,i){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);i&&(c=c.filter(function(m){return Object.getOwnPropertyDescriptor(r,m).enumerable})),a.push.apply(a,c)}return a}function s(r){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?n(Object(a),!0).forEach(function(c){e(r,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(a,c))})}return r}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(cy);var Ur=cy.exports,gy={exports:{}},yy={exports:{}};(function(t){function e(n,s){if(n==null)return{};var r={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(s.indexOf(i)!==-1)continue;r[i]=n[i]}return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(yy);var EE=yy.exports;(function(t){var e=EE;function n(s,r){if(s==null)return{};var i,a,c=e(s,r);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(s);for(a=0;a<m.length;a++)i=m[a],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(c[i]=s[i])}return c}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(gy);var Vu=gy.exports,by={exports:{}};(function(t){function e(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(by);var mi=by.exports,Ny={exports:{}};(function(t){var e=py;function n(r,i){for(var a=0;a<i.length;a++){var c=i[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(r,e(c.key),c)}}function s(r,i,a){return i&&n(r.prototype,i),a&&n(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(Ny);var ui=Ny.exports,xy={exports:{}},vy={exports:{}};(function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(vy);var VE=vy.exports,_y={exports:{}};(function(t){function e(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!n},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(_y);var CE=_y.exports,Dy={exports:{}},ky={exports:{}};(function(t){function e(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ky);var wE=ky.exports;(function(t){var e=no.default,n=wE;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n(r)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(Dy);var SE=Dy.exports;(function(t){var e=VE,n=CE,s=SE;function r(i,a,c){return a=e(a),s(i,n()?Reflect.construct(a,c||[],e(i).constructor):a.apply(i,c))}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(xy);var so=xy.exports,Ay={exports:{}},Ey={exports:{}};(function(t){function e(n,s){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Ey);var IE=Ey.exports;(function(t){var e=IE;function n(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Ay);var ro=Ay.exports;const ha=na(Ob);var As={},Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.views=Yi.navigate=void 0;Yi.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Yi.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var PE=Kn.default;Object.defineProperty(As,"__esModule",{value:!0});As.views=As.dateRangeFormat=As.dateFormat=As.accessor=As.DayLayoutAlgorithmPropType=void 0;var is=PE(dp),$f=Yi,Wf=Object.keys($f.views).map(function(t){return $f.views[t]});As.accessor=is.default.oneOfType([is.default.string,is.default.func]);As.dateFormat=is.default.any;As.dateRangeFormat=is.default.func;As.views=is.default.oneOfType([is.default.arrayOf(is.default.oneOf(Wf)),is.default.objectOf(function(t,e){var n=Wf.indexOf(e)!==-1&&typeof t[e]=="boolean";if(n)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return is.default.elementType.apply(is.default,[t,e].concat(r))})]);As.DayLayoutAlgorithmPropType=is.default.oneOfType([is.default.oneOf(["overlap","no-overlap"]),is.default.func]);var Ql={},io={},LE=Kn.default;Object.defineProperty(io,"__esModule",{value:!0});io.accessor=Vy;io.wrapAccessor=void 0;var TE=LE(no);function Vy(t,e){var n=null;return typeof e=="function"?n=e(t):typeof e=="string"&&(0,TE.default)(t)==="object"&&t!=null&&e in t&&(n=t[e]),n}io.wrapAccessor=function(e){return function(n){return Vy(n,e)}};var di={},jE=Kn.default;Object.defineProperty(di,"__esModule",{value:!0});di.DnDContext=void 0;var RE=jE(k);di.DnDContext=RE.default.createContext();var fi=Kn.default;Object.defineProperty(Ql,"__esModule",{value:!0});Ql.default=void 0;var BE=fi(Ur),UE=fi(mi),HE=fi(ui),ME=fi(so),FE=fi(ro),Si=fi(k),zf=fi(ha),Kf=io,OE=di,Cy=function(t){function e(){var n;(0,UE.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,ME.default)(this,e,[].concat(r)),n.handleResizeUp=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","UP")},n.handleResizeDown=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","DOWN")},n.handleResizeLeft=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","LEFT")},n.handleResizeRight=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","RIGHT")},n.handleStartDragging=function(a){var c;if(a.button===0){var m=(c=a.target.getAttribute("class"))===null||c===void 0?void 0:c.includes("rbc-addons-dnd-resize");if(!m){var u=(0,BE.default)({},n.props.event);u.sourceResource=n.props.resource,n.context.draggable.onBeginAction(n.props.event,"move")}}},n}return(0,FE.default)(e,t),(0,HE.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return Si.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},Si.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,a=s.continuesPrior,c=s.continuesAfter,m=s.resizable,u=this.props.children;if(r.__isPreview)return Si.default.cloneElement(u,{className:(0,zf.default)(u.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,h=d.draggableAccessor,p=d.resizableAccessor,b=h?!!(0,Kf.accessor)(r,h):!0;if(!b)return u;var C=m&&(p?!!(0,Kf.accessor)(r,p):!0);if(C||b){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(C){var S=null,B=null;i==="date"?(S=!a&&this.renderAnchor("Left"),B=!c&&this.renderAnchor("Right")):(S=!a&&this.renderAnchor("Up"),B=!c&&this.renderAnchor("Down")),v.children=Si.default.createElement("div",{className:"rbc-addons-dnd-resizable"},S,u.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,zf.default)(u.props.className,"rbc-addons-dnd-dragged-event")),u=Si.default.cloneElement(u,v)}return u}}])}(Si.default.Component);Cy.contextType=OE.DnDContext;Ql.default=Cy;var Yl={},wy={exports:{}};(function(t){var e=no.default;function n(s,r){if(typeof WeakMap=="function")var i=new WeakMap,a=new WeakMap;return(t.exports=n=function(m,u){if(!u&&m&&m.__esModule)return m;var d,h,p={__proto__:null,default:m};if(m===null||e(m)!="object"&&typeof m!="function")return p;if(d=u?a:i){if(d.has(m))return d.get(m);d.set(m,p)}for(var b in m)b!=="default"&&{}.hasOwnProperty.call(m,b)&&((h=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(m,b))&&(h.get||h.set)?d(p,b,h):p[b]=m[b]);return p},t.exports.__esModule=!0,t.exports.default=t.exports)(s,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(wy);var Sy=wy.exports;function Cu(t,e,n,s){if(n===void 0&&(n=!1),s===void 0&&(s=!0),t){var r=document.createEvent("HTMLEvents");r.initEvent(e,n,s),t.dispatchEvent(r)}}function qE(t){var e=_s(t,"transitionDuration")||"",n=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*n}function $E(t,e,n){n===void 0&&(n=5);var s=!1,r=setTimeout(function(){s||Cu(t,"transitionend",!0)},e+n),i=_l(t,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function wu(t,e,n,s){n==null&&(n=qE(t)||0);var r=$E(t,n,s),i=_l(t,"transitionend",e);return function(){r(),i()}}var Qf={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Yf(t){var e=t.node,n=t.properties,s=t.duration,r=s===void 0?200:s,i=t.easing,a=t.callback,c=[],m={},u="";Object.keys(n).forEach(function(p){var b=n[p];qb(p)?u+=p+"("+b+") ":(m[p]=b,c.push($b(p)))}),u&&(m.transform=u,c.push("transform"));function d(p){p.target===p.currentTarget&&(_s(e,Qf),a&&a.call(this,p))}r>0&&(m.transition=c.join(", "),m["transition-duration"]=r/1e3+"s",m["transition-delay"]="0s",m["transition-timing-function"]=i||"linear");var h=wu(e,d,r);return e.clientLeft,_s(e,m),{cancel:function(){h(),_s(e,Qf)}}}function Iy(t,e,n,s,r){if(!("nodeType"in t))return Yf(t);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Yf({node:t,properties:e,duration:n,easing:s,callback:r})}function Py(t,e,n){if(t){if(typeof n>"u")return t.getAttribute(e);!n&&n!==""?t.removeAttribute(e):t.setAttribute(e,String(n))}}function Ly(t){return t?Array.from(t.children):[]}function Ty(t){if(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}return null}var WE=Function.prototype.bind.call(Function.prototype.call,[].slice);function jy(t){return t?WE(t.childNodes):[]}function Ry(t,e){return function(s){var r=s.currentTarget,i=s.target,a=bm(r,t);a.some(function(c){return Nm(c,i)})&&e.call(this,s)}}function By(t,e){return t&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t):null}var zE=/^(?:input|select|textarea|button)$/i;function Uy(t){return t?zE.test(t.nodeName):!1}function Hy(t){return t?!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length):!1}function My(t,e,n){e===void 0&&(e=null),n===void 0&&(n=null);for(var s=[];t;t=t.nextElementSibling)if(t!==e){if(n&&xm(t,n))break;s.push(t)}return s}function Fy(t,e){return My(t,t,e)}function KE(t,e){var n=null,s=[];for(n=t?t[e]:null;n&&n.nodeType!==9;)s.push(n),n=n[e]||null;return s}function Oy(t){return KE(t,"parentElement")}function qy(t,e){return t&&e?(e.firstElementChild?e.insertBefore(t,e.firstElementChild):e.appendChild(t),t):null}function $y(t){return t&&t.parentNode?(t.parentNode.removeChild(t),t):null}function Su(t,e){var n=_s(t,"position"),s=n==="absolute",r=t.ownerDocument;if(n==="fixed")return r||document;for(;(t=t.parentNode)&&!Wb(t);){var i=s&&_s(t,"position")==="static",a=(_s(t,"overflow")||"")+(_s(t,"overflow-y")||"")+_s(t,"overflow-x");if(!i&&/(auto|scroll)/.test(a)&&(e||Dl(t)<t.scrollHeight))return t}return r||document}function Wy(t,e){var n=el(t),s={top:0,left:0};if(t){var r=e||Su(t),i=zb(r),a=tl(r),c=Dl(r,!0);i||(s=el(r)),n={top:n.top-s.top,left:n.left-s.left,height:n.height,width:n.width};var m=n.height,u=n.top+(i?0:a),d=u+m;a=a>u?u:d>a+c?d-c:a;var h=vm(function(){return tl(r,a)});return function(){return _m(h)}}}function zy(t){return My(t&&t.parentElement?t.parentElement.firstElementChild:null,t)}var QE=/&nbsp;/gi,YE=/\xA0/g,GE=/\s+([^\s])/gm;function Ky(t,e,n){e===void 0&&(e=!0),n===void 0&&(n=!0);var s="";return t&&(s=(t.textContent||"").replace(QE," ").replace(YE," "),e&&(s=s.trim()),n&&(s=s.replace(GE," $1"))),s}function Qy(t,e){t.classList?t.classList.toggle(e):Dm(t,e)?km(t,e):Am(t,e)}const XE={addEventListener:kp,removeEventListener:Dp,triggerEvent:Cu,animate:Iy,filter:Ry,listen:_l,style:_s,getComputedStyle:_p,attribute:Py,activeElement:vp,ownerDocument:xp,ownerWindow:Np,requestAnimationFrame:vm,cancelAnimationFrame:_m,matches:xm,height:Dl,width:bp,offset:el,offsetParent:yp,position:gp,contains:Nm,scrollbarSize:hp,scrollLeft:pp,scrollParent:Su,scrollTo:Wy,scrollTop:tl,querySelectorAll:bm,closest:fp,addClass:Am,removeClass:km,hasClass:Dm,toggleClass:Qy,transitionEnd:wu,childNodes:jy,childElements:Ly,nextUntil:Fy,parents:Oy,siblings:zy,clear:Ty,insertAfter:By,isInput:Uy,isVisible:Hy,prepend:qy,remove:$y,text:Ky},JE=Object.freeze(Object.defineProperty({__proto__:null,activeElement:vp,addClass:Am,addEventListener:kp,animate:Iy,attribute:Py,cancelAnimationFrame:_m,childElements:Ly,childNodes:jy,clear:Ty,closest:fp,contains:Nm,default:XE,filter:Ry,getComputedStyle:_p,hasClass:Dm,height:Dl,insertAfter:By,isInput:Uy,isVisible:Hy,listen:_l,matches:xm,nextUntil:Fy,offset:el,offsetParent:yp,ownerDocument:xp,ownerWindow:Np,parents:Oy,position:gp,prepend:qy,querySelectorAll:bm,remove:$y,removeClass:km,removeEventListener:Dp,requestAnimationFrame:vm,scrollLeft:pp,scrollParent:Su,scrollTo:Wy,scrollTop:tl,scrollbarSize:hp,siblings:zy,style:_s,text:Ky,toggleClass:Qy,transitionEnd:wu,triggerEvent:Cu,width:bp},Symbol.toStringTag,{value:"Module"})),ZE=na(JE);var fm={exports:{}};(function(t,e){e.__esModule=!0,e.default=s;var n=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return n(r.querySelectorAll(i))}t.exports=e.default})(fm,fm.exports);var eV=fm.exports,Vs={};const tV=na(Kb),nV=na(Qb),sV=na(Yb);var oo=Kn.default;Object.defineProperty(Vs,"__esModule",{value:!0});Vs.default=void 0;Vs.getBoundsForNode=ta;Vs.getEventNodeFromPoint=Gy;Vs.getShowMoreNodeFromPoint=Xy;Vs.isEvent=cV;Vs.isShowMore=mV;Vs.objectsCollide=hm;var rV=oo(no),iV=oo(mi),oV=oo(ui),pm=oo(tV),Yy=oo(nV),aV=oo(sV);function $n(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,aV.default)(n,t,e,{passive:!1})}function lV(t,e,n){return!t||(0,pm.default)(t,document.elementFromPoint(e,n))}function Gy(t,e){var n=e.clientX,s=e.clientY,r=document.elementFromPoint(n,s);return(0,Yy.default)(r,".rbc-event",t)}function Xy(t,e){var n=e.clientX,s=e.clientY,r=document.elementFromPoint(n,s);return(0,Yy.default)(r,".rbc-show-more",t)}function cV(t,e){return!!Gy(t,e)}function mV(t,e){return!!Xy(t,e)}function Do(t){var e=t;return t.touches&&t.touches.length&&(e=t.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Gf=5,uV=250,dV=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.global,r=s===void 0?!1:s,i=n.longPressThreshold,a=i===void 0?250:i,c=n.validContainers,m=c===void 0?[]:c;(0,iV.default)(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=a,this.validContainers=m,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=$n("touchmove",function(){},window),this._removeKeyDownListener=$n("keydown",this._keyListener),this._removeKeyUpListener=$n("keyup",this._keyListener),this._removeDropFromOutsideListener=$n("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=$n("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,oV.default)(t,[{key:"on",value:function(n,s){var r=this._listeners[n]||(this._listeners[n]=[]);return r.push(s),{remove:function(){var a=r.indexOf(s);a!==-1&&r.splice(a,1)}}}},{key:"emit",value:function(n){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var a,c=this._listeners[n]||[];return c.forEach(function(m){a===void 0&&(a=m.apply(void 0,r))}),a}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(n){var s=this._selectRect;return!s||!this.selecting?!1:hm(s,ta(n))}},{key:"filter",value:function(n){var s=this._selectRect;return!s||!this.selecting?[]:n.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(n,s){var r=this,i=null,a=null,c=null,m=function(p){i=setTimeout(function(){d(),n(p)},r.longPressThreshold),a=$n("touchmove",function(){return d()}),c=$n("touchend",function(){return d()})},u=$n("touchstart",m),d=function(){i&&clearTimeout(i),a&&a(),c&&c(),i=null,a=null,c=null};return s&&m(s),function(){d(),u()}}},{key:"_addInitialEventListener",value:function(){var n=this,s=$n("mousedown",function(i){n._removeInitialEventListener(),n._handleInitialEvent(i),n._removeInitialEventListener=$n("mousedown",n._handleInitialEvent)}),r=$n("touchstart",function(i){n._removeInitialEventListener(),n._removeInitialEventListener=n._addLongPressListener(n._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:a,clientY:c}),n.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:a,clientY:c}),n.preventDefault()}},{key:"_handleInitialEvent",value:function(n){if(this._initialEvent=n,!this.isDetached){var s=Do(n),r=s.clientX,i=s.clientY,a=s.pageX,c=s.pageY,m=this.container(),u,d;if(!(n.which===3||n.button===2||!lV(m,r,i))){if(!this.globalMouse&&m&&!(0,pm.default)(m,n.target)){var h=fV(0),p=h.top,b=h.left,C=h.bottom,v=h.right;if(d=ta(m),u=hm({top:d.top-p,left:d.left-b,bottom:d.bottom+C,right:d.right+v},{top:c,left:a}),!u)return}var S=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(n.type),x:a,y:c,clientX:r,clientY:i});if(S!==!1)switch(n.type){case"mousedown":this._removeEndListener=$n("mouseup",this._handleTerminatingEvent),this._onEscListener=$n("keydown",this._handleTerminatingEvent),this._removeMoveListener=$n("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(n),this._removeEndListener=$n("touchend",this._handleTerminatingEvent),this._removeMoveListener=$n("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(n){var s=n.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(n){var s=this.selecting,r=this._selectRect;if(!s&&n.type.includes("key")&&(n=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!n){var i=!this.container||(0,pm.default)(this.container(),n.target),a=this._isWithinValidContainer(n);return n.key==="Escape"||!a?this.emit("reset"):!s&&i?this._handleClickEvent(n):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY,m=new Date().getTime();return this._lastClickData&&m-this._lastClickData.timestamp<uV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:a,clientY:c})):(this._lastClickData={timestamp:m},this.emit("click",{x:r,y:i,clientX:a,clientY:c}))}},{key:"_handleMoveEvent",value:function(n){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,a=Do(n),c=a.pageX,m=a.pageY,u=Math.abs(r-c),d=Math.abs(i-m),h=Math.min(c,r),p=Math.min(m,i),b=this.selecting,C=this.isClick(c,m);C&&!b&&!(u||d)||(!b&&!C&&this.emit("selectStart",this._initialEventData),C||(this.selecting=!0,this._selectRect={top:p,left:h,x:c,y:m,right:h+u,bottom:p+d},this.emit("selecting",this._selectRect)),n.preventDefault())}}},{key:"_keyListener",value:function(n){this.ctrl=n.metaKey||n.ctrlKey}},{key:"isClick",value:function(n,s){var r=this._initialEventData,i=r.x,a=r.y,c=r.isTouch;return!c&&Math.abs(n-i)<=Gf&&Math.abs(s-a)<=Gf}}])}();function fV(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,rV.default)(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function hm(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=ta(t),r=s.top,i=s.left,a=s.right,c=a===void 0?i:a,m=s.bottom,u=m===void 0?r:m,d=ta(e),h=d.top,p=d.left,b=d.right,C=b===void 0?p:b,v=d.bottom,S=v===void 0?h:v;return!(u-n<h||r+n>S||c-n<p||i+n>C)}function ta(t){if(!t.getBoundingClientRect)return t;var e=t.getBoundingClientRect(),n=e.left+Xf("left"),s=e.top+Xf("top");return{top:s,left:n,right:(t.offsetWidth||0)+n,bottom:(t.offsetHeight||0)+s}}function Xf(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}Vs.default=dV;var Gl={},Xl=Kn.default;Object.defineProperty(Gl,"__esModule",{value:!0});Gl.default=void 0;var pV=Xl(hy),Jf=Xl(Ur),hV=Xl(ha),ko=Xl(k);function Ba(t){return typeof t=="string"?t:t+"%"}function gV(t){var e=t.style,n=t.className,s=t.event,r=t.accessors,i=t.rtl,a=t.selected,c=t.label,m=t.continuesPrior,u=t.continuesAfter,d=t.getters,h=t.onClick,p=t.onDoubleClick,b=t.isBackgroundEvent,C=t.onKeyPress,v=t.components,S=v.event,B=v.eventWrapper,L=r.title(s),W=r.tooltip(s),ie=r.end(s),ee=r.start(s),F=d.eventProp(s,ee,ie,a),A=[ko.default.createElement("div",{key:"1",className:"rbc-event-label"},c),ko.default.createElement("div",{key:"2",className:"rbc-event-content"},S?ko.default.createElement(S,{event:s,title:L}):L)],x=e.height,E=e.top,j=e.width,I=e.xOffset,P=(0,Jf.default)((0,Jf.default)({},F.style),{},(0,pV.default)({top:Ba(E),height:Ba(x),width:Ba(j)},i?"right":"left",Ba(I)));return ko.default.createElement(B,Object.assign({type:"time"},t),ko.default.createElement("div",{role:"button",tabIndex:0,onClick:h,onDoubleClick:p,style:P,onKeyDown:C,title:W?(typeof c=="string"?c+": ":"")+W:void 0,className:(0,hV.default)(b?"rbc-background-event":"rbc-event",n,F.className,{"rbc-selected":a,"rbc-event-continues-earlier":m,"rbc-event-continues-later":u})},A))}Gl.default=gV;var nr={},Jy=Kn.default;Object.defineProperty(nr,"__esModule",{value:!0});nr.dragAccessors=void 0;nr.eventTimes=kV;nr.mergeComponents=_V;nr.pointInColumn=DV;var yV=Jy(Ur),bV=Jy(Vu),Zf=io,NV=k,xV=["children"];nr.dragAccessors={start:(0,Zf.wrapAccessor)(function(t){return t.start}),end:(0,Zf.wrapAccessor)(function(t){return t.end})};function vV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s=function(i){var a=i.children,c=(0,bV.default)(i,xV);return e.filter(Boolean).reduceRight(function(m,u){return(0,NV.createElement)(u,c,m)},a)};return s}function _V(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=Object.keys(e),s=(0,yV.default)({},t);return n.forEach(function(r){s[r]=t[r]?vV(t[r],e[r]):e[r]}),s}function DV(t,e){var n=t.left,s=t.right,r=t.top,i=e.x,a=e.y;return i<s+10&&i>n&&a>r}function kV(t,e,n){var s=e.start(t),r=e.end(t),i=n.eq(s,r,"minutes")&&n.diff(s,r,"minutes")===0;i&&(r=n.add(r,1,"day"));var a=n.diff(s,r,"milliseconds");return{start:s,end:r,duration:a}}var AV=Sy.default,Hr=Kn.default;Object.defineProperty(Yl,"__esModule",{value:!0});Yl.default=void 0;var mr=Hr(Ur),EV=Hr(mi),VV=Hr(ui),CV=Hr(so),wV=Hr(ro),Sc=ZE,SV=Hr(eV),Qr=Hr(k),IV=di,ur=AV(Vs),PV=Hr(Gl),Ks=nr,Zy=function(t){function e(){var n;(0,EV.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,CV.default)(this,e,[].concat(r)),n.handleMove=function(a,c){if(!(0,Ks.pointInColumn)(c,a))return n.reset();var m=n.context.draggable.dragAndDropAction.event,u=n.props,d=u.accessors,h=u.slotMetrics,p=h.closestSlotFromPoint({y:a.y-n.eventOffsetTop,x:a.x},c),b=(0,Ks.eventTimes)(m,d,n.props.localizer),C=b.duration,v=n.props.localizer.add(p,C,"milliseconds");n.update(m,h.getRange(p,v,!1,!0))},n.handleDropFromOutside=function(a,c){var m=n.props,u=m.slotMetrics,d=m.resource,h=u.closestSlotFromPoint({y:a.y,x:a.x},c),p=n._calculateDnDEnd(h);n.context.draggable.onDropFromOutside({start:h,end:p,allDay:!1,resource:d}),n.reset()},n.handleDragOverFromOutside=function(a,c){var m=n.props.slotMetrics,u=m.closestSlotFromPoint({y:a.y,x:a.x},c),d=n._calculateDnDEnd(u),h=n.context.draggable.dragFromOutsideItem();n.update(h,m.getRange(u,d,!1,!0))},n._calculateDnDEnd=function(a){var c=n.props,m=c.accessors,u=c.slotMetrics,d=c.localizer,h=n.context.draggable.dragFromOutsideItem(),p=(0,Ks.eventTimes)(h,m,d),b=p.duration,C=u.nextSlot(a),v=!isNaN(b);if(v){var S=d.add(a,b,"milliseconds");C=new Date(Math.max(S,C))}return C},n.updateParentScroll=function(a,c){setTimeout(function(){var m=(0,SV.default)(c,".rbc-addons-dnd-drag-preview")[0];m&&(m.offsetTop<a.scrollTop?(0,Sc.scrollTop)(a,Math.max(m.offsetTop,0)):m.offsetTop+m.offsetHeight>a.scrollTop+a.clientHeight&&(0,Sc.scrollTop)(a,Math.min(m.offsetTop-a.offsetHeight+m.offsetHeight,a.scrollHeight)))})},n._selectable=function(){var a=n.ref.current,c=a.children[0],m=!1,u=n._selector=new ur.default(function(){return a.closest(".rbc-time-view")}),d=(0,Sc.scrollParent)(a);u.on("beforeSelect",function(h){var p=n.context.draggable.dragAndDropAction;if(!p.action)return!1;if(p.action==="resize")return(0,Ks.pointInColumn)((0,ur.getBoundsForNode)(c),h);var b=(0,ur.getEventNodeFromPoint)(c,h);if(!b)return!1;n.eventOffsetTop=h.y-(0,ur.getBoundsForNode)(b).top}),u.on("selecting",function(h){var p=(0,ur.getBoundsForNode)(c),b=n.context.draggable.dragAndDropAction;b.action==="move"&&(n.updateParentScroll(d,c),n.handleMove(h,p)),b.action==="resize"&&(n.updateParentScroll(d,c),n.handleResize(h,p))}),u.on("dropFromOutside",function(h){if(n.context.draggable.onDropFromOutside){var p=(0,ur.getBoundsForNode)(c);(0,Ks.pointInColumn)(p,h)&&n.handleDropFromOutside(h,p)}}),u.on("dragOverFromOutside",function(h){var p=n.context.draggable.dragFromOutsideItem?n.context.draggable.dragFromOutsideItem():null;if(p){var b=(0,ur.getBoundsForNode)(c);if(!(0,Ks.pointInColumn)(b,h))return n.reset();n.handleDragOverFromOutside(h,b)}}),u.on("selectStart",function(){m=!0,n.context.draggable.onStart()}),u.on("select",function(h){var p=(0,ur.getBoundsForNode)(c);m=!1;var b=n.context.draggable.dragAndDropAction;if(b.action==="resize")n.handleInteractionEnd();else{if(!n.state.event||!(0,Ks.pointInColumn)(p,h))return;n.handleInteractionEnd()}}),u.on("click",function(){m&&n.reset(),n.context.draggable.onEnd(null)}),u.on("reset",function(){n.reset(),n.context.draggable.onEnd(null)})},n.handleInteractionEnd=function(){var a=n.props.resource,c=n.state.event;n.reset(),n.context.draggable.onEnd({start:c.start,end:c.end,resourceId:a})},n._teardownSelectable=function(){n._selector&&(n._selector.teardown(),n._selector=null)},n.state={},n.ref=Qr.default.createRef(),n}return(0,wV.default)(e,t),(0,VV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,a=r.endDate,c=r.top,m=r.height,u=this.state.event;u&&i===u.start&&a===u.end||this.setState({top:c,height:m,event:(0,mr.default)((0,mr.default)({},s),{},{start:i,end:a})})}},{key:"handleResize",value:function(s,r){var i=this.props,a=i.accessors,c=i.slotMetrics,m=i.localizer,u=this.context.draggable.dragAndDropAction,d=u.event,h=u.direction,p=c.closestSlotFromPoint(s,r),b=(0,Ks.eventTimes)(d,a,m),C=b.start,v=b.end,S;if(h==="UP"){var B=m.min(p,c.closestSlotFromDate(v,-1));S=c.getRange(B,v),S=(0,mr.default)((0,mr.default)({},S),{},{endDate:v})}else if(h==="DOWN"){var L=m.max(p,c.closestSlotFromDate(C));S=c.getRange(C,L),S=(0,mr.default)((0,mr.default)({},S),{},{startDate:C})}this.update(d,S)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,a=s.components,c=s.getters,m=s.slotMetrics,u=s.localizer,d=this.state,h=d.event,p=d.top,b=d.height;if(!h)return r;var C=r.props.children,v=h.start,S=h.end,B,L="eventTimeRangeFormat",W=m.startsBeforeDay(v),ie=m.startsAfterDay(S);return W?L="eventTimeRangeEndFormat":ie&&(L="eventTimeRangeStartFormat"),W&&ie?B=u.messages.allDay:B=u.format({start:v,end:S},L),Qr.default.cloneElement(r,{children:Qr.default.createElement(Qr.default.Fragment,null,C,h&&Qr.default.createElement(PV.default,{event:h,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:p,height:b,width:100},getters:c,components:a,accessors:(0,mr.default)((0,mr.default)({},i),Ks.dragAccessors),continuesPrior:W,continuesAfter:ie}))})}},{key:"render",value:function(){return Qr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Qr.default.Component);Zy.contextType=IV.DnDContext;Yl.default=Zy;var Jl={},eb={exports:{}},tb={exports:{}},nb={exports:{}};(function(t){function e(n,s){(s==null||s>n.length)&&(s=n.length);for(var r=0,i=Array(s);r<s;r++)i[r]=n[r];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(nb);var sb=nb.exports;(function(t){var e=sb;function n(s){if(Array.isArray(s))return e(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(tb);var LV=tb.exports,rb={exports:{}};(function(t){function e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(rb);var TV=rb.exports,ib={exports:{}};(function(t){var e=sb;function n(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ib);var jV=ib.exports,ob={exports:{}};(function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ob);var RV=ob.exports;(function(t){var e=LV,n=TV,s=jV,r=RV;function i(a){return e(a)||n(a)||s(a)||r()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports})(eb);var ab=eb.exports,Zl={},ec={},tc={},Mr=Kn.default;Object.defineProperty(tc,"__esModule",{value:!0});tc.default=void 0;var ep=Mr(Ur),BV=Mr(Vu),UV=Mr(mi),HV=Mr(ui),MV=Mr(so),FV=Mr(ro),Ao=Mr(k),OV=Mr(ha),qV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],$V=function(t){function e(){return(0,UV.default)(this,e),(0,MV.default)(this,e,arguments)}return(0,FV.default)(e,t),(0,HV.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,a=s.event,c=s.selected,m=s.isAllDay,u=s.onSelect,d=s.onDoubleClick,h=s.onKeyPress,p=s.localizer,b=s.continuesPrior,C=s.continuesAfter,v=s.accessors,S=s.getters,B=s.children,L=s.components,W=L.event,ie=L.eventWrapper,ee=s.slotStart,F=s.slotEnd,A=(0,BV.default)(s,qV);delete A.resizable;var x=v.title(a),E=v.tooltip(a),j=v.end(a),I=v.start(a),P=v.allDay(a),D=m||P||p.diff(I,p.ceil(j,"day"),"day")>1,Ae=S.eventProp(a,I,j,c),Ue=Ao.default.createElement("div",{className:"rbc-event-content",title:E||void 0},W?Ao.default.createElement(W,{event:a,continuesPrior:b,continuesAfter:C,title:x,isAllDay:P,localizer:p,slotStart:ee,slotEnd:F}):x);return Ao.default.createElement(ie,Object.assign({},this.props,{type:"date"}),Ao.default.createElement("div",Object.assign({},A,{style:(0,ep.default)((0,ep.default)({},Ae.style),r),className:(0,OV.default)("rbc-event",i,Ae.className,{"rbc-selected":c,"rbc-event-allday":D,"rbc-event-continues-prior":b,"rbc-event-continues-after":C}),onClick:function(Se){return u&&u(a,Se)},onDoubleClick:function(Se){return d&&d(a,Se)},onKeyDown:function(Se){return h&&h(a,Se)}}),typeof B=="function"?B(Ue):Ue))}}])}(Ao.default.Component);tc.default=$V;var Fr={},WV=Kn.default;Object.defineProperty(Fr,"__esModule",{value:!0});Fr.dateCellSelection=YV;Fr.getSlotAtX=lb;Fr.isSelected=KV;Fr.pointInBox=QV;Fr.slotWidth=Iu;var zV=WV(Gb);function KV(t,e){return!t||e==null?!1:(0,zV.default)(t,e)}function Iu(t,e){var n=t.right-t.left,s=n/e;return s}function lb(t,e,n,s){var r=Iu(t,s);return n?s-1-Math.floor((e-t.left)/r):Math.floor((e-t.left)/r)}function QV(t,e){var n=e.x,s=e.y;return s>=t.top&&s<=t.bottom&&n>=t.left&&n<=t.right}function YV(t,e,n,s,r){var i=-1,a=-1,c=s-1,m=Iu(e,s),u=lb(e,n.x,r,s),d=e.top<n.y&&e.bottom>n.y,h=e.top<t.y&&e.bottom>t.y,p=t.y>e.bottom,b=e.top>t.y,C=n.top<e.top&&n.bottom>e.bottom;return C&&(i=0,a=c),d&&(b?(i=0,a=u):p&&(i=u,a=c)),h&&(i=a=r?c-Math.floor((t.x-e.left)/m):Math.floor((t.x-e.left)/m),d?u<i?i=u:a=u:t.y<n.y?a=c:i=0),{startIdx:i,endIdx:a}}var Pu=Kn.default;Object.defineProperty(ec,"__esModule",{value:!0});ec.default=void 0;var Ls=Pu(dp),tp=Pu(k),GV=Pu(tc),XV=Fr;ec.default={propTypes:{slotMetrics:Ls.default.object.isRequired,selected:Ls.default.object,isAllDay:Ls.default.bool,accessors:Ls.default.object.isRequired,localizer:Ls.default.object.isRequired,components:Ls.default.object.isRequired,getters:Ls.default.object.isRequired,onSelect:Ls.default.func,onDoubleClick:Ls.default.func,onKeyPress:Ls.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,n){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,a=e.onSelect,c=e.onDoubleClick,m=e.onKeyPress,u=e.localizer,d=e.slotMetrics,h=e.components,p=e.resizable,b=d.continuesPrior(n),C=d.continuesAfter(n);return tp.default.createElement(GV.default,{event:n,getters:i,localizer:u,accessors:r,components:h,onSelect:a,onDoubleClick:c,onKeyPress:m,continuesPrior:b,continuesAfter:C,slotStart:d.first,slotEnd:d.last,selected:(0,XV.isSelected)(n,s),resizable:p})},renderSpan:function(e,n,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(n)/e*100+"%";return tp.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Or=Kn.default;Object.defineProperty(Zl,"__esModule",{value:!0});Zl.default=void 0;var JV=Or(Ur),ZV=Or(mi),eC=Or(ui),tC=Or(so),nC=Or(ro),sC=Or(ha),np=Or(k),Za=Or(ec),cb=function(t){function e(){return(0,ZV.default)(this,e),(0,tC.default)(this,e,arguments)}return(0,nC.default)(e,t),(0,eC.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,a=r.slotMetrics.slots,c=r.className,m=1;return np.default.createElement("div",{className:(0,sC.default)(c,"rbc-row")},i.reduce(function(u,d,h){var p=d.event,b=d.left,C=d.right,v=d.span,S="_lvl_"+h,B=b-m,L=Za.default.renderEvent(s.props,p);return B&&u.push(Za.default.renderSpan(a,B,"".concat(S,"_gap"))),u.push(Za.default.renderSpan(a,v,S,L)),m=C+1,u},[]))}}])}(np.default.Component);cb.defaultProps=(0,JV.default)({},Za.default.defaultProps);Zl.default=cb;var sr={},mb=Kn.default;Object.defineProperty(sr,"__esModule",{value:!0});sr.endOfRange=ub;sr.eventLevels=oC;sr.eventSegments=iC;sr.inRange=aC;sr.segsOverlap=db;sr.sortEvents=gm;sr.sortWeekEvents=lC;var Ic=mb(ab),rC=mb(Xb);function ub(t){var e=t.dateRange,n=t.unit,s=n===void 0?"day":n,r=t.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function iC(t,e,n,s){var r=ub({dateRange:e,localizer:s}),i=r.first,a=r.last,c=s.diff(i,a,"day"),m=s.max(s.startOf(n.start(t),"day"),i),u=s.min(s.ceil(n.end(t),"day"),a),d=(0,rC.default)(e,function(p){return s.isSameDate(p,m)}),h=s.diff(m,u,"day");return h=Math.min(h,c),h=Math.max(h-s.segmentOffset,1),{event:t,span:h,left:d+1,right:Math.max(d+h,1)}}function oC(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,n,s,r,i=[],a=[];for(n=0;n<t.length;n++){for(r=t[n],s=0;s<i.length&&db(r,i[s]);s++);s>=e?a.push(r):(i[s]||(i[s]=[])).push(r)}for(n=0;n<i.length;n++)i[n].sort(function(c,m){return c.left-m.left});return{levels:i,extra:a}}function aC(t,e,n,s,r){var i={start:s.start(t),end:s.end(t)},a={start:e,end:n};return r.inEventRange({event:i,range:a})}function db(t,e){return e.some(function(n){return n.left<=t.right&&n.right>=t.left})}function lC(t,e,n){var s=(0,Ic.default)(t),r=[],i=[];s.forEach(function(m){var u=e.start(m),d=e.end(m);n.daySpan(u,d)>1?r.push(m):i.push(m)});var a=r.sort(function(m,u){return gm(m,u,e,n)}),c=i.sort(function(m,u){return gm(m,u,e,n)});return[].concat((0,Ic.default)(a),(0,Ic.default)(c))}function gm(t,e,n,s){var r={start:n.start(t),end:n.end(t),allDay:n.allDay(t)},i={start:n.start(e),end:n.end(e),allDay:n.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var cC=Sy.default,qr=Kn.default;Object.defineProperty(Jl,"__esModule",{value:!0});Jl.default=void 0;var Ua=qr(Ur),mC=qr(ab),uC=qr(mi),dC=qr(ui),fC=qr(so),pC=qr(ro),Ha=qr(k),hC=qr(Zl),Ii=cC(Vs),gC=sr,dr=Fr,Ma=nr,yC=di,fb=function(t){function e(){var n;(0,uC.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,fC.default)(this,e,[].concat(r)),n.handleMove=function(a,c,m){if(!(0,dr.pointInBox)(c,a))return n.reset();var u=n.context.draggable.dragAndDropAction.event||m,d=n.props,h=d.accessors,p=d.slotMetrics,b=d.rtl,C=d.localizer,v=(0,dr.getSlotAtX)(c,a.x,b,p.slots),S=p.getDateForSlot(v),B=(0,Ma.eventTimes)(u,h,C),L=B.start,W=B.duration;L=C.merge(S,L);var ie=C.add(L,W,"milliseconds");n.update(u,L,ie)},n.handleDropFromOutside=function(a,c){if(n.context.draggable.onDropFromOutside){var m=n.props,u=m.slotMetrics,d=m.rtl,h=m.localizer,p=(0,dr.getSlotAtX)(c,a.x,d,u.slots),b=u.getDateForSlot(p);n.context.draggable.onDropFromOutside({start:b,end:h.add(b,1,"day"),allDay:!1})}},n.handleDragOverFromOutside=function(a,c){var m=n.context.draggable.dragFromOutsideItem?n.context.draggable.dragFromOutsideItem():null;m&&n.handleMove(a,c,m)},n._selectable=function(){var a=n.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),c=a.closest(".rbc-month-view, .rbc-time-view"),m=a.classList.contains("rbc-month-row"),u=n._selector=new Ii.default(function(){return c},{validContainers:(0,mC.default)(m?[]:[".rbc-day-slot",".rbc-allday-cell"])});u.on("beforeSelect",function(d){var h=n.props.isAllDay,p=n.context.draggable.dragAndDropAction.action,b=(0,Ii.getBoundsForNode)(a),C=(0,dr.pointInBox)(b,d);return p==="move"||p==="resize"&&(!h||C)}),u.on("selecting",function(d){var h=(0,Ii.getBoundsForNode)(a),p=n.context.draggable.dragAndDropAction;p.action==="move"&&n.handleMove(d,h),p.action==="resize"&&n.handleResize(d,h)}),u.on("selectStart",function(){return n.context.draggable.onStart()}),u.on("select",function(d){var h=(0,Ii.getBoundsForNode)(a);n.state.segment&&((0,dr.pointInBox)(h,d)?n.handleInteractionEnd():n.reset())}),u.on("dropFromOutside",function(d){if(n.context.draggable.onDropFromOutside){var h=(0,Ii.getBoundsForNode)(a);(0,dr.pointInBox)(h,d)&&n.handleDropFromOutside(d,h)}}),u.on("dragOverFromOutside",function(d){if(n.context.draggable.dragFromOutsideItem){var h=(0,Ii.getBoundsForNode)(a);n.handleDragOverFromOutside(d,h)}}),u.on("click",function(){return n.context.draggable.onEnd(null)}),u.on("reset",function(){n.reset(),n.context.draggable.onEnd(null)})},n.handleInteractionEnd=function(){var a=n.props,c=a.resourceId,m=a.isAllDay,u=n.state.segment.event;n.reset(),n.context.draggable.onEnd({start:u.start,end:u.end,resourceId:c,isAllDay:m})},n._teardownSelectable=function(){n._selector&&(n._selector.teardown(),n._selector=null)},n.state={},n.ref=Ha.default.createRef(),n}return(0,pC.default)(e,t),(0,dC.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var a=(0,gC.eventSegments)((0,Ua.default)((0,Ua.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Ma.dragAccessors,this.props.localizer),c=this.state.segment;c&&a.span===c.span&&a.left===c.left&&a.right===c.right||this.setState({segment:a})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,a=i.event,c=i.direction,m=this.props,u=m.accessors,d=m.slotMetrics,h=m.rtl,p=m.localizer,b=(0,Ma.eventTimes)(a,u,p),C=b.start,v=b.end,S=(0,dr.getSlotAtX)(r,s.x,h,d.slots),B=d.getDateForSlot(S),L=(0,dr.pointInBox)(r,s);if(c==="RIGHT"){if(L){if(d.last<C)return this.reset();p.eq(p.startOf(v,"day"),v)?v=p.add(B,1,"day"):v=B}else if(p.inRange(C,d.first,d.last)||r.bottom<s.y&&+d.first>+C)v=p.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var W=u.end(a);v=p.merge(v,W),p.lt(v,C)&&(v=W)}else if(c==="LEFT"){if(L){if(d.first>v)return this.reset();C=B}else if(p.inRange(v,d.first,d.last)||r.top>s.y&&p.lt(d.last,v))C=p.add(d.first,-1,"milliseconds");else{this.reset();return}var ie=u.start(a);C=p.merge(C,ie),p.gt(C,v)&&(C=ie)}this.update(a,C,v)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,a=this.state.segment;return Ha.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,a&&Ha.default.createElement(hC.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[a],accessors:(0,Ua.default)((0,Ua.default)({},i),Ma.dragAccessors)})))}}])}(Ha.default.Component);fb.contextType=yC.DnDContext;Jl.default=fb;var Cs=Kn.default;Object.defineProperty(Eu,"__esModule",{value:!0});Eu.default=SC;var Fa=Cs(Ur),bC=Cs(Vu),NC=Cs(mi),xC=Cs(ui),vC=Cs(so),_C=Cs(ro),Pc=Cs(k),DC=Cs(ha),kC=Cs(Ql),AC=Cs(Yl),EC=Cs(Jl),VC=nr,CC=di,wC=["selectable","elementProps","components"];function SC(t){var e=function(n){function s(){var r;(0,NC.default)(this,s);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return r=(0,vC.default)(this,s,[].concat(a)),r.defaultOnDragOver=function(m){m.preventDefault()},r.handleBeginAction=function(m,u,d){r.setState({event:m,action:u,direction:d});var h=r.props.onDragStart;h&&h({event:m,action:u,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(m){var u=r.state,d=u.action,h=u.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),m!=null)){m.event=h;var p=r.props,b=p.onEventDrop,C=p.onEventResize;d==="move"&&b&&b(m),d==="resize"&&C&&C(m)}},r.state={interacting:!1},r}return(0,_C.default)(s,n),(0,xC.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,a=i.selectable,c=i.elementProps,m=i.components,u=(0,bC.default)(i,wC),d=this.state.interacting;delete u.onEventDrop,delete u.onEventResize,u.selectable=a?"ignoreEvents":!1,this.components=(0,VC.mergeComponents)(m,{eventWrapper:kC.default,eventContainerWrapper:AC.default,weekWrapper:EC.default});var h=this.props.onDropFromOutside?(0,Fa.default)((0,Fa.default)({},c),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):c;u.className=(0,DC.default)(u.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var p=this.getDnDContextValue();return Pc.default.createElement(CC.DnDContext.Provider,{value:p},Pc.default.createElement(t,Object.assign({},u,{elementProps:h,components:this.components})))}}])}(Pc.default.Component);return e.defaultProps=(0,Fa.default)((0,Fa.default)({},t.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var IC=Kn.default;Object.defineProperty(Au,"__esModule",{value:!0});var pb=Au.default=void 0,PC=IC(Eu);pb=Au.default=PC.default;const pr={async getAllProcesses(){try{const t=Fe(ne,"processes"),e=xt(t,an("order","asc")),n=await Vt(e);return n.empty?this.getDefaultProcesses():n.docs.map(s=>{const r=s.data();return{id:parseInt(s.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(t){return console.error("[Firestore]    :",t),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,n)=>({id:n+1,name:e,order:n,isDefault:!0}))},async createProcess(t,e){try{const n=Fe(ne,"processes"),s=await Vt(n);let r=0;s.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>r&&(r=u)});const i=r+1,a=Ce(ne,"processes",String(i)),c=new Date().toISOString();return await ii(a,{name:t,order:e,isDefault:!1,createdAt:c,updatedAt:rn()}),console.log(" [Firestore]   :",i),{id:i,name:t,order:e,isDefault:!1,createdAt:c}}catch(n){throw console.error("[Firestore]   :",n),new Error(`  : ${n.message||"   "}`)}},async updateProcess(t,e){try{const n=Ce(ne,"processes",String(t)),s=await It(n);if(!s.exists())throw new Error("   .");const r=s.data(),i={updatedAt:rn()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Rt(n,i),console.log(" [Firestore]   :",t),{id:t,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(n){throw console.error("[Firestore]   :",n),new Error(`  : ${n.message||"   "}`)}},async deleteProcess(t){try{const e=Ce(ne,"processes",String(t));await Hn(e),console.log(" [Firestore]   :",t)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(t){try{const e=t.map((n,s)=>{const r=Ce(ne,"processes",String(n));return Rt(r,{order:s,updatedAt:rn()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(t){const e=Fe(ne,"processes"),n=xt(e,an("order","asc"));return ds(n,r=>{if(r.empty){t(pr.getDefaultProcesses());return}const i=r.docs.map(a=>{const c=a.data();return{id:parseInt(a.id)||0,name:c.name||"",order:c.order||0,isDefault:c.isDefault||!1}});t(i)})}},LC={getAllProcesses:()=>pr.getAllProcesses(),createProcess:(t,e)=>pr.createProcess(t,e),updateProcess:(t,e)=>pr.updateProcess(t,e),deleteProcess:t=>pr.deleteProcess(t),reorderProcesses:t=>pr.reorderProcesses(t),subscribeToProcesses:pr.subscribeToProcesses,getDefaultProcesses:pr.getDefaultProcesses},TC=pb(Jb),jC=pE;et.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:t=>t<12?"":"",week:{dow:0,doy:1}});et.locale("ko");const RC=Zb(et),sp=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],BC=it.memo(({onSave:t,onCancel:e,processList:n})=>{const[s,r]=k.useState(""),i=()=>{const u=window.innerWidth,d=window.innerHeight;return u>=768&&u<1024||u>=1024&&d>u},[a,c]=k.useState(i);k.useEffect(()=>{const u=()=>c(i());return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const m=a?"16px":"18px";return o.jsxDEV("div",{className:"w-full",onClick:u=>u.stopPropagation(),style:{padding:a?"2px 3px":"6px 0",minHeight:a?"28px":"32px"},children:[o.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:u=>r(u.target.value),onBlur:()=>{s.trim()?t(s.trim()):e()},onKeyDown:u=>{u.stopPropagation(),u.key==="Enter"?s.trim()?t(s.trim()):e():u.key==="Escape"&&e()},onClick:u=>u.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:m,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),n&&o.jsxDEV("datalist",{id:"process-suggestions",children:n.map(u=>o.jsxDEV("option",{value:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),rp=t=>t,Fo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},UC=it.memo(({date:t,label:e,filteredEvents:n,selectedDate:s,user:r,isMobileView:i})=>{const a=et(t).format("YYYY-MM-DD"),c=Fo[a],m=!!Fo[a],u=s&&et(t).isSame(s,"day"),d=n.filter(F=>et(F.start).isSame(t,"day")),h=d.length,p=d.filter(F=>F.assignedTo&&F.assignedTo.includes((r==null?void 0:r.name)||"")).length,b=h-p,C=e.replace(/^0/,""),v=t.getDay()===0,S=t.getDay()===6;let B="#000000";m||v?B="#dc2626":S&&(B="#3b82f6");const L=et(t).isSame(et(),"day");let W="#d1d5db";m||v?W="#fecaca":S&&(W="#bfdbfe");const ie=C.length===2,ee=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:L?"700":"400",border:u?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:L?"700":"400",paddingLeft:ie?"0px":"4px",...L&&{backgroundColor:W,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return o.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?o.jsxDEV("span",{style:ee,children:[o.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),h>0&&o.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:p}).map((F,A)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:b}).map((F,A)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${A}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{style:ee,children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),c&&o.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),HC=it.memo(({event:t,user:e,filterProject:n,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:a,onEditDelete:c,onEditCancel:m,onHoverDelete:u,onDeleteAction:d,processList:h})=>{const p=n&&n!=="all",b=t.assignedTo||[],[C,v]=k.useState(!1),S=it.useRef(null),B=()=>{const ge=window.innerWidth,Se=window.innerHeight;return ge>=768&&ge<1024||ge>=1024&&Se>ge},[L,W]=k.useState(B),[ie,ee]=k.useState(!1);it.useRef(null),it.useRef(!1);const[F,A]=k.useState(r||""),x=it.useRef(s);k.useEffect(()=>{s&&!x.current&&r!==void 0&&A(r),x.current=s},[s,r]);const E=e!=null&&e.name?e.name.slice(-2):null,j=E&&["",""].includes(E),I=E&&["","",""].includes(E),P=(e==null?void 0:e.name)&&(b.includes(e.name)||b.includes("HV LAB")||b.includes("")&&I||b.includes("")&&j);k.useEffect(()=>{const ge=()=>{W(B())};return window.addEventListener("resize",ge),()=>window.removeEventListener("resize",ge)},[]);const D=ge=>{A(ge)},Ae=()=>{F!=null&&F.trim()&&a&&(i&&i(F),a()),m&&m()},Ue=ge=>{ge.stopPropagation(),(ge.key==="Enter"||ge.key==="Escape")&&ge.currentTarget.blur()};return L?o.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),v(!0)},onMouseLeave:()=>{ee(!1),v(!1)},style:{padding:p?"2px 3px":"1px 3px",minHeight:p?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[C&&p&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:o.jsxDEV("button",{ref:S,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:p?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!p&&!t.isASVisit&&t.projectName?o.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",rp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):o.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!p&&b.length>0&&o.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:b.map((ge,Se)=>{const tt=ge==="HV LAB"||ge===""&&j||ge===""&&I||ge===(e==null?void 0:e.name);return o.jsxDEV(it.Fragment,{children:[o.jsxDEV("span",{style:{fontWeight:tt?"bold":"normal"},children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Se<b.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:F,onChange:ge=>D(ge.target.value),onBlur:Ae,onKeyDown:Ue,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):o.jsxDEV("div",{style:{fontWeight:500,fontSize:p?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:P?"underline":"none",textDecorationColor:P?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:t.title,children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),ie&&o.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[o.jsxDEV("div",{className:"font-semibold mb-1",children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),t.projectName&&o.jsxDEV("div",{className:"opacity-90",children:[": ",t.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),b.length>0&&o.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",b.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):o.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:p?"32px":"18px",padding:p?"6px 0":"0"},children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!p&&!t.isASVisit&&t.projectName&&o.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",rp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:F,onChange:ge=>D(ge.target.value),onBlur:Ae,onKeyDown:Ue,onClick:ge=>ge.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:p?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):o.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:p?"18px":"12px",textDecoration:P?"underline":"none",textDecorationColor:P?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!p&&b.length>0&&o.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:b.map((ge,Se)=>{const tt=ge==="HV LAB"||ge===""&&j||ge===""&&I||ge===(e==null?void 0:e.name);return o.jsxDEV(it.Fragment,{children:[o.jsxDEV("span",{className:tt?"font-bold":"",children:ge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Se<b.length-1&&""]},ge,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),C&&p&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:o.jsxDEV("button",{ref:S,onMouseDown:ge=>{ge.stopPropagation(),ge.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),h&&s&&o.jsxDEV("datalist",{id:"process-suggestions-edit",children:h.map(ge=>o.jsxDEV("option",{value:ge},ge,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),MC=()=>{const{schedules:t,setSchedules:e,addSchedule:n,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:a,deleteScheduleFromAPI:c,asRequests:m,updateASRequestInAPI:u,loadASRequestsFromAPI:d,constructionPayments:h,updateConstructionPaymentInAPI:p}=Ir(),{user:b}=Br(),C=Kl(),[v,S]=k.useState(!1);k.useEffect(()=>{const N=()=>{const U=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;S(U)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const B=N=>!N||N==="-"?"":v?N:dm(N),L=b!=null&&b.name?b.name.slice(-2):null;console.log(" Current user:",b==null?void 0:b.name,"Short name:",L);const W=it.useRef(!1);k.useEffect(()=>{W.current||(W.current=!0,r().catch(N=>{console.error("Failed to load schedules:",N),te.error("  ")}))},[r]);const[ie,ee]=k.useState([]);k.useEffect(()=>{const N=async U=>{if((U.ctrlKey||U.metaKey)&&U.key==="z"){const Y=U.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(ie.length>0){U.preventDefault();const K=ie[ie.length-1];try{const ce=K.type==="as_visit"||K.type==="expected_payment"?"other":K.type;await i({id:"",title:K.originalTitle||K.title,start:K.start,end:K.end,type:ce,project:K.originalProjectName||K.projectName,attendees:K.assignedTo||[],time:K.time,description:K.description}),ee(he=>he.slice(0,-1)),te.success(" ")}catch(ce){console.error("  :",ce),te.error("  ")}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[ie,i]);const[F,A]=k.useState([]),[x,E]=k.useState(!1),[j,I]=k.useState(""),[P,D]=k.useState(null),[Ae,Ue]=k.useState(""),[ge,Se]=k.useState(!1),[tt,Ut]=k.useState(null),[Ht,ae]=k.useState(null),Me=k.useCallback(async()=>{Se(!0);try{const N=await LC.getAllProcesses();A(N)}catch(N){console.error("   :",N),A([])}finally{Se(!1)}},[]);k.useEffect(()=>{Me()},[Me]);const fe=k.useMemo(()=>F.length>0?F.map(N=>N.name):jC,[F]),Ie=async()=>{if(j.trim())try{const N=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(N.ok)I(""),Me(),te.success(" ");else{const U=await N.json();te.error(U.error||"  ")}}catch(N){console.error("  :",N),te.error("  ")}},ze=async()=>{if(!(!P||!Ae.trim()))try{const N=await fetch(`/api/processes/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ae.trim()})});if(N.ok)D(null),Ue(""),Me(),te.success(" ");else{const U=await N.json();te.error(U.error||"  ")}}catch(N){console.error("  :",N),te.error("  ")}},bt=async N=>{if(confirm("   ?"))try{const U=await fetch(`/api/processes/${N}`,{method:"DELETE"});if(U.ok)Me(),te.success(" ");else{const Y=await U.json();te.error(Y.error||"  ")}}catch(U){console.error("  :",U),te.error("  ")}},nt=N=>{Ut(N)},Ct=(N,U)=>{N.preventDefault(),tt!==null&&tt!==U&&ae(U)},ot=async()=>{if(tt!==null&&Ht!==null&&tt!==Ht){const N=[...F],[U]=N.splice(tt,1);N.splice(Ht,0,U),A(N);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:N.map(K=>({id:K.id}))})})).ok||(Me(),te.error("  "))}catch(Y){console.error("  :",Y),Me(),te.error("  ")}}Ut(null),ae(null)},Nt=N=>{const U=C.findIndex(Y=>Y.name===N);return U>=0?sp[U%sp.length]:"#e8e2ea"},Xt=C.map(N=>N.name),Q=t.filter(N=>!N.asRequestId).filter(N=>(b==null?void 0:b.name)===""?N.project===""||Xt.includes(N.project):!0).map(N=>{const U=C.find(pe=>pe.name===N.project);let Y=N.project===""?"[]":N.project;if(U&&N.project!==""){const pe=U.name.length>2?U.name.substring(0,2):U.name,pt=(U.location||"").match(/([A-Za-z]?\d+)/),pn=pt?pt[1]:"";Y=pn?`${pe}_${pn}`:pe}const K=N.time,ce=K&&K!=="-"?` - ${B(K)}`:"",he=N.attendees||[];return{id:N.id,title:N.title+ce,originalTitle:N.title,start:N.start,end:N.end,projectId:(U==null?void 0:U.id)||"",projectName:Y||"",originalProjectName:N.project||"",type:N.type||"other",phase:"",assignedTo:he,priority:"medium",allDay:!K||K==="-",color:Nt(N.project||""),isASVisit:!1,time:K,description:N.description}}),Pe=m.filter(N=>N.scheduledVisitDate).filter(N=>(b==null?void 0:b.name)===""?Xt.includes(N.project):!0).map(N=>{const U=N.scheduledVisitTime,Y=U&&U!=="-"?` - ${B(U)}`:"",K=C.find(pe=>pe.name===N.project);let ce=N.project;if(K){const pe=K.name.length>2?K.name.substring(0,2):K.name,pt=(K.location||"").match(/([A-Za-z]?\d+)/),pn=pt?pt[1]:"";ce=pn?`${pe}_${pn}`:pe}const he=`[AS] ${ce}`;return{id:`as-${N.id}`,title:he+Y,originalTitle:he,start:N.scheduledVisitDate,end:N.scheduledVisitDate,projectId:(K==null?void 0:K.id)||"",projectName:ce,originalProjectName:N.project,type:"as_visit",phase:"",assignedTo:N.assignedTo?Array.isArray(N.assignedTo)?N.assignedTo:N.assignedTo.split(",").map(pe=>pe.trim()):[],priority:"high",allDay:!U||U==="-",color:"#FEF3C7",isASVisit:!0,time:U,description:N.description}}),qe=(b==null?void 0:b.role)==="manager"?h.flatMap(N=>{var he,pe,rt,pt,pn,wt,St,tn;const U=C.find(An=>An.name===N.project);if(!U){const An=[],kt=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),Yt=new Set(N.payments.flatMap(un=>{var Ft;return((Ft=un.type)==null?void 0:Ft.split(", ").map(qt=>qt.trim()))||[]}));return!Yt.has("")&&((he=N.expectedPaymentDates)!=null&&he.contract)&&An.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),!Yt.has("")&&((pe=N.expectedPaymentDates)!=null&&pe.start)&&An.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Yt.has("")&&((rt=N.expectedPaymentDates)!=null&&rt.middle)&&An.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Yt.has("")&&((pt=N.expectedPaymentDates)!=null&&pt.final)&&An.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),An}if(!U.startDate||!U.endDate)return[];const Y=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),K=new Set(N.payments.flatMap(An=>{var kt;return((kt=An.type)==null?void 0:kt.split(", ").map(Yt=>Yt.trim()))||[]})),ce=[];return!K.has("")&&((pn=N.expectedPaymentDates)!=null&&pn.contract)&&ce.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!K.has("")&&((wt=N.expectedPaymentDates)!=null&&wt.start)&&ce.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!K.has("")&&((St=N.expectedPaymentDates)!=null&&St.middle)&&ce.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!K.has("")&&((tn=N.expectedPaymentDates)!=null&&tn.final)&&ce.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),ce}):[],Le=[...Q,...Pe,...qe],$e=k.useCallback(N=>{if(!(b!=null&&b.name))return!1;const U=N.assignedTo||[],Y=b.name.slice(-2),K=["",""].includes(Y),ce=["","",""].includes(Y);return U.includes(b.name)||U.includes("HV LAB")||U.includes("")&&ce||U.includes("")&&K},[b==null?void 0:b.name]),gt=(N,U)=>{if(!U)return[...N].sort((ce,he)=>{const pe=$e(ce),rt=$e(he);return pe&&!rt?-1:!pe&&rt?1:ce.start.getTime()-he.start.getTime()});const Y=new Map;N.forEach(ce=>{const he=ce.time&&ce.time!=="-"&&ce.time.trim()!=="";if(ce.isASVisit||ce.isExpectedPayment||he){const pe=`single_${ce.id}`;Y.set(pe,[ce])}else{const pe=ce.start.toISOString().split("T")[0],rt=[...ce.assignedTo].sort().join(","),pt=`${pe}_${ce.projectName}_${rt}`;Y.has(pt)||Y.set(pt,[]),Y.get(pt).push(ce)}});const K=[];return Y.forEach(ce=>{if(ce.length===1)K.push(ce[0]);else{const he=ce[0],pe=ce.map(St=>St.originalTitle||St.title),rt=[...new Set(pe)],pt=ce.map(St=>{const tn=St.originalTitle||St.title;return tn.startsWith(he.projectName+" - ")?tn.substring(he.projectName.length+3):tn}),pn=[...new Set(pt)],wt={...he,id:ce[0].id,title:pn.join(", "),originalTitle:rt.join(", "),description:ce.map(St=>St.description||St.originalTitle||St.title).join(`
`),assignedTo:[...new Set(ce.flatMap(St=>St.assignedTo))],mergedEventIds:ce.map(St=>St.id)};K.push(wt)}}),K.sort((ce,he)=>{const pe=$e(ce),rt=$e(he);return pe&&!rt?-1:!pe&&rt?1:ce.start.getTime()-he.start.getTime()})},[Ot,ct]=k.useState("month"),[T,$]=k.useState(new Date),[X,ye]=k.useState(!1),[le,de]=k.useState(null),[Ee,Ke]=k.useState(null),Ze=`schedule_filterProject_${(b==null?void 0:b.id)||"guest"}`,[Ne,fn]=k.useState(()=>{const N=localStorage.getItem(Ze);return N||((b==null?void 0:b.name)===""&&C.length>0?C[0].name:"all")});k.useEffect(()=>{localStorage.setItem(Ze,Ne)},[Ne,Ze]),k.useCallback(()=>{document.body.classList.add("printing-schedule");const N=Ne==="all"?" ":Ne,U=et(T).format("YYYY MM"),Y=document.title;document.title=`${N} - ${U} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ne,T]);const Pt=gt(Le,Ne==="all"),[st,sn]=k.useState(window.innerWidth<768?new Date:null),[V,oe]=k.useState(null),De=it.useRef(null),Be=it.useRef(!1),[ue,Lt]=k.useState(null),yt=it.useRef(!1),zt=it.useRef(!1);k.useEffect(()=>{const N=K=>{K.key==="Control"&&(zt.current=!0)},U=K=>{K.key==="Control"&&(zt.current=!1)},Y=()=>{zt.current=!1};return window.addEventListener("keydown",N),window.addEventListener("keyup",U),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",N),window.removeEventListener("keyup",U),window.removeEventListener("blur",Y)}},[]),k.useEffect(()=>{if(!V)return;let N=null;const U=he=>{he.preventDefault(),he.dataTransfer&&(he.dataTransfer.dropEffect="copy")},Y=he=>{he.preventDefault(),he.dataTransfer&&(he.dataTransfer.dropEffect="copy");const rt=he.target.closest(".rbc-day-bg");N&&N!==rt&&(N.style.backgroundColor=""),rt&&(rt.style.backgroundColor="rgba(59, 130, 246, 0.15)",N=rt)},K=()=>{N&&(N.style.backgroundColor="",N=null)},ce=he=>{he.preventDefault(),N&&(N.style.backgroundColor="",N=null)};return document.addEventListener("dragenter",U),document.addEventListener("dragover",Y),document.addEventListener("dragend",K),document.addEventListener("drop",ce),()=>{document.removeEventListener("dragenter",U),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",K),document.removeEventListener("drop",ce),N&&(N.style.backgroundColor="")}},[V]);const[dt,Jt]=k.useState(null),[Zt,In]=k.useState(null),[fs,Qn]=k.useState(""),[ps,$r]=k.useState(!1),[ws,ts]=k.useState(null),[Ss,Bn]=k.useState(!1),[Pn,g]=k.useState(""),[R,w]=k.useState(null),[M,H]=k.useState({x:0,y:0}),[G,q]=k.useState({x:0,y:0}),[O,Z]=k.useState(!1),re=8;k.useEffect(()=>{if(!R)return;const N=Y=>{H({x:Y.clientX,y:Y.clientY});const K=Math.abs(Y.clientX-G.x),ce=Math.abs(Y.clientY-G.y);(K>re||ce>re)&&Z(!0)},U=()=>{w(null),Z(!1)};return window.addEventListener("mousemove",N),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",U)}},[R,G]);const we=it.useRef(!1),Ye=k.useCallback(async({event:N,start:U,end:Y})=>{if(N.isASVisit||N.isExpectedPayment){te.error("    ");return}const K=U instanceof Date?U:new Date(U),ce=Y instanceof Date?Y:new Date(Y);if(zt.current)try{const pe=N.mergedEventIds||[N.id],rt=t.filter(pt=>pe.includes(pt.id));for(const pt of rt)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:pt.title,start:K,end:ce,project:pt.project,attendees:pt.attendees||[],time:pt.time,priority:pt.priority||"medium"});te.success(" ")}catch(pe){console.error("  :",pe),te.error("  ")}else{const pe=N.mergedEventIds||[N.id];try{for(const rt of pe)await a(rt,{start:K,end:ce})}catch(rt){console.error("  :",rt),te.error("  "),r()}}},[t,a,i,r]),at=k.useCallback(({event:N,action:U})=>{var K;if(N.isASVisit||N.isExpectedPayment||N.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const ce of Y)if((K=ce.textContent)!=null&&K.includes(N.originalTitle||N.title)){const he=ce.getBoundingClientRect();q({x:he.left,y:he.top}),H({x:he.left,y:he.top});break}Z(!1),w(N)},[]),xe=k.useCallback(async(N,U,Y=!1)=>{if(Ne==="all"){te.error("  ");return}const K={id:"",title:N,start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(K)}catch(ce){console.error("  :",ce),te.error("  ")}},[Ne,i,b]),He=k.useCallback(({start:N})=>{const U=V||De.current;U&&Ne!=="all"&&(Be.current=!0,yt.current=!0,requestAnimationFrame(()=>{yt.current=!1}),Jt(null),In(null),Qn(""),xe(U,N),requestAnimationFrame(()=>{oe(null),De.current=null,Be.current=!1}))},[V,Ne,xe]),Qt=k.useCallback(()=>{const N=V||De.current;return N?{title:N}:null},[V]),mn=k.useCallback(async N=>{if(!N.trim()||!dt||Ne==="all"){Jt(null);return}const U=dt;Jt(null);const Y={id:"",title:N.trim(),start:U,end:U,type:"construction",project:Ne,location:"",attendees:b!=null&&b.name?[b.name]:[],description:""};try{await i(Y)}catch(K){console.error("  :",K),te.error("  ")}},[dt,Ne,i,b]),ns=k.useCallback(()=>{Jt(null)},[]),en=k.useCallback(async()=>{var N;if(!Zt||!fs.trim()){In(null),Qn("");return}try{const U=((N=Zt.mergedEventIds)==null?void 0:N[0])||Zt.id;await a(U,{title:fs.trim()})}catch(U){console.error("  :",U),te.error("  ")}In(null),Qn("")},[Zt,fs,a]),Yn=k.useCallback(async N=>{ee(Y=>[...Y,N]);const U=N.mergedEventIds||[N.id];te.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(U.map(Y=>c(Y)))}catch(Y){console.error("  :",Y),te.error("  "),ee(K=>K.slice(0,-1))}In(null),Qn("")},[c]),Gn=Ne==="all"?Pt:Pt.filter(N=>(N.originalProjectName||N.projectName)===Ne),Tt=it.useMemo(()=>{const N=Ne!=="all",U=new Map;Gn.forEach(K=>{const ce=et(K.start).format("YYYY-MM-DD");U.has(ce)||U.set(ce,[]),U.get(ce).push(K)});const Y=[];return U.forEach(K=>{if(N)K.forEach((ce,he)=>{const pe=et(ce.start).startOf("day").add(he,"milliseconds").toDate();Y.push({...ce,start:pe,allDay:!1})});else{const ce=[],he=[];K.forEach(pe=>{$e(pe)?ce.push(pe):he.push(pe)}),ce.forEach((pe,rt)=>{const pt=et(pe.start).startOf("day").add(rt,"milliseconds").toDate();Y.push({...pe,start:pt,allDay:!1})}),he.forEach((pe,rt)=>{const pt=et(pe.start).startOf("day").add(1e3+rt,"milliseconds").toDate();Y.push({...pe,start:pt,allDay:!1})})}}),Y.sort((K,ce)=>K.start.getTime()-ce.start.getTime())},[Gn,$e,Ne]),Te=it.useMemo(()=>{if(dt&&Ne!=="all"){const N=et(dt).format("YYYY-MM-DD"),U=Tt.filter(he=>et(he.start).format("YYYY-MM-DD")===N),Y=U.length>0?Math.max(...U.map(he=>he.start.getTime())):et(dt).startOf("day").valueOf(),K=new Date(Y+1),ce={id:"__inline_add__",title:"",start:K,end:K,projectId:"",projectName:Ne,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Tt,ce]}return Tt},[Tt,dt,Ne]);k.useEffect(()=>{(b==null?void 0:b.name)===""&&C.length>0&&(Ne==="all"||!C.find(N=>N.name===Ne))&&fn(C[0].name)},[C,b]),k.useEffect(()=>{const N=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(pe=>{pe.style.display="none",pe.style.visibility="hidden",pe.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(pe=>{pe.style.display="none",pe.style.visibility="hidden",pe.style.opacity="0",pe.style.pointerEvents="none",pe.style.position="absolute",pe.style.left="-9999px",pe.style.top="-9999px",pe.style.zIndex="-1"})};N();const U=new MutationObserver(N),Y=document.querySelector(".rbc-calendar");Y&&U.observe(Y,{childList:!0,subtree:!0});const K=new MutationObserver(N);return K.observe(document.body,{childList:!0,subtree:!0}),()=>{U.disconnect(),K.disconnect()}},[Ot,T]);const[ve,Xe]=k.useState({date:null,projectId:"",title:""}),ft=it.useRef(!1),mt=it.useRef(null),je=N=>{if(we.current){we.current=!1;return}if(N.id==="__inline_add__")return;ft.current=!0,mt.current&&clearTimeout(mt.current);const U=Ne!=="all",Y=window.innerWidth<768;if(U&&!Y&&!N.isASVisit&&!N.isExpectedPayment)Jt(null),In(N),Qn(N.originalTitle||N.title);else{const K={...N,title:N.originalTitle||N.title};Ke(null),de(K),ye(!0)}mt.current=setTimeout(()=>{ft.current=!1,mt.current=null},300)},We=N=>{const U=window.innerWidth,Y=U<768,K=U>=768&&U<1024,ce=Ne==="all";if(yt.current)return;if(Y){if(N.start){sn(N.start);const pe=document.querySelector(".md\\:hidden.mt-3.bg-white");pe&&pe.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const he=N.action==="click"||N.action==="select";if(!(K&&!he)){if(ce){ft.current=!1,In(null),Qn(""),Jt(null),Ke(N),de(null),ye(!0);return}if(!ft.current){if(ue){xe(ue,N.start,!0);return}In(null),Qn(""),Jt(N.start)}}},Dt=async()=>{if(!ve.projectId||!ve.title.trim()){alert("  ");return}const N=C.find(U=>U.id===ve.projectId);if(!(!N||!ve.date))try{await i({id:Date.now().toString(),title:ve.title,start:ve.date,end:ve.date,type:"other",project:N.name,location:"",attendees:[],description:""}),Xe({date:null,projectId:"",title:""}),sn(null)}catch(U){console.error("Failed to add schedule:",U),te.error("  ")}},Dn=N=>{if(N.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let U=N.color||"#E0E7FF",Y="#1f2937";if(N.isASVisit)U="#E8F5E9",Y="#1f2937";else{const K=N.assignedTo&&N.assignedTo.includes("HV LAB"),ce=N.assignedTo&&N.assignedTo.includes("")&&L&&["",""].includes(L),he=N.assignedTo&&N.assignedTo.includes("")&&L&&["","",""].includes(L);N.assignedTo&&N.assignedTo.includes((b==null?void 0:b.name)||"")||K||ce||he?(U="#FEF3C7",Y="#1f2937"):N.color||(U="#e8e2ea")}return{style:{backgroundColor:U,"--event-bg-color":U,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},kn=it.useCallback(N=>{const U=et(N).format("YYYY-MM-DD"),Y=!!Fo[U],K=st&&et(N).isSame(st,"day"),ce=window.innerWidth<768;let he="";K&&(he+="selected-date "),Y&&(he+="holiday-date ");const pe=ce?{backgroundColor:"transparent",background:"transparent"}:{};return{className:he.trim(),style:pe}},[st]),[lt,Wr]=k.useState(window.innerWidth<768);k.useEffect(()=>{const N=()=>{Wr(window.innerWidth<768)};return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),k.useEffect(()=>{const N=()=>{const U=st||new Date;Ke({start:U,end:U}),de(null),ye(!0)};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[st]);const rr=it.useCallback(({date:N,label:U})=>o.jsxDEV(UC,{date:N,label:U,filteredEvents:Te,selectedDate:st,user:b,isMobileView:lt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[Te,st,b,lt]),ir=it.useRef(fs);ir.current=fs;const ga=it.useCallback(N=>{Qn(N)},[]),ao=it.useCallback(()=>{In(null),Qn("")},[]),ya=it.useCallback(({event:N})=>{if(N.id==="__inline_add__")return o.jsxDEV(BC,{onSave:mn,onCancel:ns,processList:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const U=(Zt==null?void 0:Zt.id)===N.id||(Zt==null?void 0:Zt.mergedEventIds)&&Zt.mergedEventIds.includes(N.id);return o.jsxDEV(HC,{event:N,user:b,filterProject:Ne,isEditing:U,editTitle:U?ir.current:void 0,onEditTitleChange:U?ga:void 0,onEditSave:U?en:void 0,onEditDelete:U?()=>Yn(N):void 0,onEditCancel:U?ao:void 0,onHoverDelete:()=>Yn(N),onDeleteAction:()=>{we.current=!0},processList:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[b,Ne,Zt,en,Yn,mn,ns,ga,ao,fe]),nc=({onNavigate:N})=>{const[U,Y]=it.useState(!1),[K,ce]=it.useState(et(T).year()),[he,pe]=it.useState(et(T).month()),rt=window.innerWidth<768,pt=()=>{ce(et(T).year()),pe(et(T).month()),Y(!0)},pn=()=>{$(et().year(K).month(he).toDate()),Y(!1)};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${rt?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{className:"flex items-center space-x-1",children:[o.jsxDEV("button",{onClick:()=>N("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:pt,children:[o.jsxDEV("span",{children:et(T).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),o.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ne==="all"?" ":Ne]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>N("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2",children:o.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ne,onChange:wt=>{fn(wt.target.value),Lt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(b==null?void 0:b.name)!==""&&o.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),C.filter(wt=>wt.status!=="completed").map(wt=>o.jsxDEV("option",{value:wt.name,children:wt.name},wt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),U&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("button",{onClick:()=>ce(K-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),o.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[K,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),o.jsxDEV("button",{onClick:()=>ce(K+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4",children:o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(wt=>{const St=he===wt-1,tn=et().year()===K&&et().month()===wt-1;return o.jsxDEV("button",{onClick:()=>pe(wt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${St?"bg-gray-900 text-white":tn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[wt,""]},wt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{$(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),o.jsxDEV("button",{onClick:pn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},sc=()=>null,rc=k.useMemo(()=>({toolbar:nc,event:ya,month:{dateHeader:rr,showMore:sc}}),[rr,ya]),or=it.useMemo(()=>{if(!st)return[];let N;if(lt)N=Te.filter(Y=>et(Y.start).isSame(st,"day"));else{const Y=et(st).startOf("week"),K=et(st).endOf("week");N=Te.filter(ce=>{const he=et(ce.start);return he.isSameOrAfter(Y,"day")&&he.isSameOrBefore(K,"day")})}const U=[...N].sort((Y,K)=>{const ce=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),he=Y.assignedTo&&Y.assignedTo.includes("")&&L&&["",""].includes(L),pe=Y.assignedTo&&Y.assignedTo.includes("")&&L&&["","",""].includes(L),rt=Y.assignedTo&&L&&Y.assignedTo.includes(L)||Y.assignedTo&&(b==null?void 0:b.name)&&Y.assignedTo.includes(b.name)||ce||he||pe,pt=K.assignedTo&&K.assignedTo.includes("HV LAB"),pn=K.assignedTo&&K.assignedTo.includes("")&&L&&["",""].includes(L),wt=K.assignedTo&&K.assignedTo.includes("")&&L&&["","",""].includes(L),St=K.assignedTo&&L&&K.assignedTo.includes(L)||K.assignedTo&&(b==null?void 0:b.name)&&K.assignedTo.includes(b.name)||pt||pn||wt;return rt&&!St?-1:!rt&&St?1:new Date(Y.start).getTime()-new Date(K.start).getTime()});return console.log("Sorted events:",U.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:b==null?void 0:b.name,userShort:L}))),U},[st,Te,b,L,lt]);return k.useEffect(()=>{const U=setTimeout(()=>{const Y=lt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),K=document.querySelectorAll(".rbc-month-row"),ce=[];K.forEach((kt,Yt)=>{const un=kt.querySelectorAll(".rbc-date-cell");let Ft=0;un.forEach(qt=>{const ht=qt.querySelector("button");let Kt=ht==null?void 0:ht.textContent;if(!Kt){const bs=qt.querySelector("span");Kt=bs==null?void 0:bs.textContent}if(Kt&&!isNaN(parseInt(Kt))){const bs=et(T).date(parseInt(Kt)),Is=Te.filter(pi=>et(pi.start).isSame(bs,"day"));Ft=Math.max(Ft,Is.length)}}),ce.push(Ft)});const he=Ne&&Ne!=="all",pe=100,rt=he?60:18,pt=25,pn=Math.floor((pe-pt)/rt),wt=ce.length,St=pe*wt,tn=ce.map(kt=>kt<=pn?pe:pt+kt*rt+10),An=tn.reduce((kt,Yt)=>kt+Yt,0);if(An>St){const kt=tn.map((Ft,qt)=>({index:qt,height:Ft,overflow:Ft>pe})),Yt=kt.filter(Ft=>Ft.overflow).reduce((Ft,qt)=>Ft+(qt.height-pe),0),un=kt.filter(Ft=>!Ft.overflow);if(un.length>0){const Ft=St-Yt-un.length*pe,qt=Math.max(50,pe+Ft/un.length);K.forEach((ht,Kt)=>{const Is=tn[Kt]>pe?tn[Kt]:qt;ht.style.height=`${Is}px`,ht.style.minHeight=`${Is}px`})}else{const Ft=St/An;K.forEach((qt,ht)=>{const Kt=Math.max(80,tn[ht]*Ft);qt.style.height=`${Kt}px`,qt.style.minHeight=`${Kt}px`})}}else{const kt=tn.reduce((qt,ht)=>qt+(ht>pe?ht:0),0),Yt=tn.filter(qt=>qt<=pe).length,un=St-kt,Ft=Yt>0?un/Yt:pe;K.forEach((qt,ht)=>{const Kt=tn[ht]>pe?tn[ht]:Ft;qt.style.height=`${Kt}px`,qt.style.minHeight=`${Kt}px`})}Y.forEach(kt=>{const Yt=kt.querySelector("button");let un=Yt==null?void 0:Yt.textContent;if(!un){const Kt=kt.querySelector("span");un=Kt==null?void 0:Kt.textContent}if(!un||isNaN(parseInt(un)))return;const Ft=et(T).date(parseInt(un)),qt=Te.filter(Kt=>et(Kt.start).isSame(Ft,"day"));qt.length>0?kt.setAttribute("data-event-count",qt.length.toString()):kt.removeAttribute("data-event-count");const ht=Ft.clone().toDate();if(st&&et(ht).isSame(st,"day")?kt.classList.add("selected-date"):kt.classList.remove("selected-date"),lt){const Kt=kt,bs=Kt._mobileClickHandler;bs&&kt.removeEventListener("click",bs);const Is=pi=>{if(pi.target.closest(".rbc-event"))return;const hi=Ft.clone().toDate();sn(hi);const Ns=document.querySelector(".md\\:hidden.mt-3.bg-white");Ns&&Ns.scrollIntoView({behavior:"smooth",block:"nearest"})};Kt._mobileClickHandler=Is,kt.addEventListener("click",Is,!0),kt.style.cursor="pointer",kt.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(U),lt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(K=>{const ce=K,he=ce._mobileClickHandler;he&&(K.removeEventListener("click",he),delete ce._mobileClickHandler)})}},[Te,T,lt,st,Ne]),o.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[ve.date&&o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:o.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[o.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:et(ve.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),o.jsxDEV("select",{value:ve.projectId,onChange:N=>Xe({...ve,projectId:N.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:C.filter(N=>N.status!=="completed").map(N=>o.jsxDEV("option",{value:N.id,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:ve.title,onChange:N=>Xe({...ve,title:N.target.value}),onKeyPress:N=>{N.key==="Enter"&&Dt()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:Dt,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Xe({date:null,projectId:"",title:""}),sn(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),o.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[o.jsxDEV("div",{className:"flex gap-3",children:[Ne!=="all"&&!lt&&o.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[o.jsxDEV("button",{onClick:()=>E(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[o.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&o.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[o.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),o.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex flex-col gap-0.5",children:fe.map(N=>o.jsxDEV("div",{draggable:!0,onClick:()=>{Lt(ue===N?null:N)},onDragStart:U=>{Be.current=!1,Lt(null),oe(N),De.current=N,U.dataTransfer.setData("text/plain",N),U.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Be.current||(oe(null),De.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===N?"bg-blue-500 text-white ring-2 ring-blue-300":V===N?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),o.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ne!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:o.jsxDEV(TC,{localizer:RC,events:Te,startAccessor:"start",endAccessor:"end",view:Ot,onView:ct,date:T,onNavigate:$,onSelectEvent:je,onSelectSlot:We,onEventDrop:Ne!=="all"?Ye:void 0,onDragStart:Ne!=="all"?at:void 0,onDropFromOutside:Ne!=="all"?He:void 0,dragFromOutsideItem:Ne!=="all"?Qt:void 0,draggableAccessor:N=>Ne!=="all"&&N.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:Dn,dayPropGetter:kn,components:rc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:N=>`+${N} `}},`calendar-${Ne}-${(st==null?void 0:st.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),st&&o.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:lt?et(st).format("MM DD (ddd)"):`${et(st).startOf("week").format("MM DD")} - ${et(st).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Fo[et(st).format("YYYY-MM-DD")]&&o.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Fo[et(st).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[Ne!=="all"&&o.jsxDEV("button",{onClick:()=>Bn(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>{sn(null),ts(null),Bn(!1),g("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),o.jsxDEV("div",{children:or.length===0?o.jsxDEV("div",{className:"p-4",children:Ne!=="all"&&Ss?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:Pn,onChange:N=>g(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Pn.trim()){const U=st||new Date,Y={id:"",title:Pn.trim(),start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{Bn(!1),g("")}).catch(K=>{console.error("  :",K),te.error("  ")})}else N.key==="Escape"&&(Bn(!1),g(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{if(Pn.trim()){const N=st||new Date,U={id:"",title:Pn.trim(),start:N,end:N,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{Bn(!1),g("")}).catch(Y=>{console.error("  :",Y),te.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{Bn(!1),g("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):o.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):o.jsxDEV("div",{children:[(()=>{const N=or.reduce((Y,K)=>{const ce=et(K.start).format("YYYY-MM-DD");return Y[ce]||(Y[ce]=[]),Y[ce].push(K),Y},{});return Object.keys(N).sort().map(Y=>o.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!lt&&o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:o.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:et(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),o.jsxDEV("div",{className:"divide-y divide-gray-100",children:N[Y].map(K=>{const ce=K.assignedTo&&K.assignedTo.includes("HV LAB"),he=K.assignedTo&&K.assignedTo.includes("")&&L&&["",""].includes(L),pe=K.assignedTo&&K.assignedTo.includes("")&&L&&["","",""].includes(L),pt=K.assignedTo&&(K.assignedTo.includes((b==null?void 0:b.name)||"")||L&&K.assignedTo.includes(L))||ce||he||pe,pn=!K.color&&!pt,wt=!K.isASVisit&&!K.isExpectedPayment;return o.jsxDEV("div",{onClick:()=>{const St={...K,title:K.originalTitle||K.title};je(St)},className:`p-3 cursor-pointer ${pt?"bg-yellow-50":""}`,style:pn?{backgroundColor:"#f3f0f5"}:void 0,children:o.jsxDEV("div",{className:"flex items-start gap-2",children:[o.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:pt?"#FEF3C7":K.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:K.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),K.assignedTo&&K.assignedTo.length>0&&o.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(An=>K.assignedTo.includes(An))?"":K.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),K.projectName&&Ne==="all"&&o.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:K.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),wt?o.jsxDEV("button",{onClick:St=>{St.stopPropagation(),ts(K)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:o.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):o.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ne!=="all"&&Ss&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:Pn,onChange:N=>g(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Pn.trim()){const U=st||new Date,Y={id:"",title:Pn.trim(),start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{Bn(!1),g("")}).catch(K=>{console.error("  :",K),te.error("  ")})}else N.key==="Escape"&&(Bn(!1),g(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{if(Pn.trim()){const N=st||new Date,U={id:"",title:Pn.trim(),start:N,end:N,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{Bn(!1),g("")}).catch(Y=>{console.error("  :",Y),te.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{Bn(!1),g("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),lt&&Ne!=="all"&&o.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[o.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:fe.map(N=>o.jsxDEV("button",{onClick:async()=>{const U=st||new Date;if(Ne!=="all"){const Y={id:"",title:N,start:U,end:U,project:Ne,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(Y)}catch(K){console.error("  :",K),te.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),X&&o.jsxDEV(ay,{event:le,slotInfo:Ee,defaultProjectName:Ne!=="all"?Ne:void 0,onClose:()=>{ye(!1),de(null),Ke(null)},onSave:async N=>{console.log(" Schedule.tsx onSave called with newEvent:",N);try{if(le)if(le.id.startsWith("as-")){const U=le.id.replace("as-","");let Y="";N.assignedTo&&Array.isArray(N.assignedTo)&&N.assignedTo.length>0?Y=N.assignedTo.join(", "):le.assignedTo&&Array.isArray(le.assignedTo)?Y=le.assignedTo.join(", "):typeof le.assignedTo=="string"&&(Y=le.assignedTo),await u(U,{project:N.title||le.title,assignedTo:Y,scheduledVisitDate:N.start,scheduledVisitTime:N.time||le.time}),await d(),ye(!1)}else if(le.id.startsWith("payment-")){const U=le.id.split("-"),Y=U[1],K=U[2],ce=h.find(he=>he.id===Y);if(ce){const he={...ce.expectedPaymentDates};he[K]=N.start,await p(Y,{expectedPaymentDates:he})}}else{console.log(" Updating schedule with projectId:",N.projectId,"projectName:",N.projectName);let U=N.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(U=U.replace(Y,""),le.mergedEventIds&&le.mergedEventIds.length>0){console.log(" Updating merged schedules:",le.mergedEventIds);const K=(le.originalTitle||le.title).split(", "),ce=U.split(", ");for(let he=0;he<le.mergedEventIds.length;he++){const pe=le.mergedEventIds[he],rt=ce[he]||K[he]||U;await a(pe,{title:rt.trim(),start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}}else await a(le.id,{title:U,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}else{console.log(" Adding schedule with projectId:",N.projectId,"projectName:",N.projectName);const U={id:Date.now().toString(),title:N.title,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName||"",location:"",attendees:N.assignedTo||[],description:N.description||"",time:N.time||"-"};await i(U)}ye(!1)}catch(U){console.error("Failed to save schedule:",U),te.error("  ")}},onDelete:async N=>{try{if(N.startsWith("payment-")){const U=N.split("-"),Y=U[1],K=U[2],ce=h.find(he=>he.id===Y);if(ce){const he={...ce.expectedPaymentDates};delete he[K],await p(Y,{expectedPaymentDates:he})}}else if(N.startsWith("as-")){const U=N.replace("as-","");await u(U,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const U=Pt.find(Y=>Y.id===N);if(U!=null&&U.mergedEventIds&&U.mergedEventIds.length>0){console.log("Deleting merged schedules:",U.mergedEventIds);for(const Y of U.mergedEventIds)await c(Y)}else await c(N)}ye(!1)}catch(U){console.error("Failed to delete schedule:",U),te.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),R&&O&&o.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:M.x-50,top:M.y-15,backgroundColor:R.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:R.originalTitle||R.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),ws&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>ts(null),children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 text-center",children:[o.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:o.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:ws.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex border-t border-gray-100",children:[o.jsxDEV("button",{onClick:()=>ts(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),o.jsxDEV("button",{onClick:async()=>{try{const N=ws.mergedEventIds||[ws.id];await Promise.all(N.map(U=>c(U)))}catch(N){console.error("  :",N),te.error(" ")}ts(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),x&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{E(!1),D(null),I("")},children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{E(!1),D(null),I("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[o.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:j,onChange:N=>I(N.target.value),onKeyDown:N=>N.key==="Enter"&&Ie(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),o.jsxDEV("button",{onClick:Ie,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),o.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:ge?o.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[o.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),o.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):F.length===0?o.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[o.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-50",children:F.map((N,U)=>o.jsxDEV("div",{draggable:(P==null?void 0:P.id)!==N.id,onDragStart:()=>nt(U),onDragOver:Y=>Ct(Y,U),onDragEnd:ot,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${tt===U?"opacity-50 bg-gray-100":""} ${Ht===U?"border-t-2 border-gray-400":""} ${(P==null?void 0:P.id)!==N.id?"cursor-grab active:cursor-grabbing":""}`,children:(P==null?void 0:P.id)===N.id?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("input",{type:"text",value:Ae,onChange:Y=>Ue(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&ze(),Y.key==="Escape"&&(D(null),Ue(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),o.jsxDEV("button",{onClick:ze,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{D(null),Ue("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),o.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:U+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),o.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:N.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{D(N),Ue(N.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>bt(N.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),F.length>0&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},FC=({projectName:t,onClose:e,type:n="cash"})=>{const s=n==="cash",r=s?"":"",i=s?"      .":"      .",[a,c]=k.useState({receiptDate:Mt(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),m=()=>{window.print()},u=h=>{const p=Number(h.replace(/,/g,""));return isNaN(p)?"":p.toLocaleString()},d=h=>{if(h===0)return"";const p=["","","",""],b=["","","",""],C=["","","","","","","","","",""];let v="",S=0;for(;h>0;){const B=h%1e4;if(B>0){let L="",W=B,ie=0;for(;W>0;){const ee=W%10;ee>0&&(L=C[ee]+b[ie]+L),W=Math.floor(W/10),ie++}v=L+p[S]+v}h=Math.floor(h/1e4),S++}return v+""};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(Nn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),o.jsxDEV("input",{type:"date",value:a.receiptDate,onChange:h=>c({...a,receiptDate:h.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.customerName,onChange:h=>c({...a,customerName:h.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:u(a.amount),onChange:h=>{const p=h.target.value.replace(/,/g,"");/^\d*$/.test(p)&&c({...a,amount:p})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),a.amount&&o.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.purpose,onChange:h=>c({...a,purpose:h.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.receivedBy,onChange:h=>c({...a,receivedBy:h.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),o.jsxDEV("button",{onClick:m,disabled:!a.customerName||!a.amount||!a.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(up,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-12",children:o.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[o.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-6 text-lg",children:[o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 receipt-date",children:Mt(new Date(a.receiptDate),"yyyy MM dd",{locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(a.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 text-center",children:[o.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("p",{className:"text-lg receipt-date",children:Mt(new Date(a.receiptDate),"yyyy MM dd",{locale:bn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",a.receivedBy," ",o.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},OC="HVLabImageDB",qC=1,Pr="paymentRecordImages";let Oa=null;const Lu=()=>new Promise((t,e)=>{if(Oa){t(Oa);return}const n=indexedDB.open(OC,qC);n.onerror=()=>{console.error("IndexedDB  :",n.error),e(n.error)},n.onsuccess=()=>{Oa=n.result,t(Oa)},n.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(Pr)||r.createObjectStore(Pr,{keyPath:"id"})}}),$C=async()=>{try{const t=await Lu();return new Promise((e,n)=>{const i=t.transaction(Pr,"readonly").objectStore(Pr).getAll();i.onsuccess=()=>{const a={};i.result.forEach(c=>{a[c.id]=c.images}),e(a)},i.onerror=()=>{console.error("  :",i.error),n(i.error)}})}catch(t){console.error("IndexedDB , localStorage :",t);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},WC=async(t,e)=>{try{const n=await Lu();return new Promise((s,r)=>{const c=n.transaction(Pr,"readwrite").objectStore(Pr).put({id:t,images:e});c.onsuccess=()=>s(),c.onerror=()=>{console.error("  :",c.error),r(c.error)}})}catch(n){throw console.error("IndexedDB  :",n),n}},zC=async t=>{try{const e=await Lu();return new Promise((n,s)=>{const r=e.transaction(Pr,"readwrite"),i=r.objectStore(Pr);i.clear(),Object.entries(t).forEach(([a,c])=>{i.put({id:a,images:c})}),r.oncomplete=()=>n(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},KC=async()=>{try{const t=localStorage.getItem("paymentRecordImages");if(t){const e=JSON.parse(t);Object.keys(e).length>0&&(await zC(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(t){console.error(" :",t)}},qa=t=>{if(!t)return 0;try{const n=new Date(t).getTime();return isNaN(n)?0:n}catch{return 0}},ip=(t,e,n)=>{if(!t)return null;try{const s=new Date(t);return isNaN(s.getTime())?null:Mt(s,e,n)}catch{return null}},QC=()=>{const{payments:t,setPayments:e,loadPaymentsFromAPI:n,loadProjectsFromAPI:s,addPaymentToAPI:r,deletePaymentFromAPI:i,updatePaymentInAPI:a,updatePayment:c}=Ir(),{user:m}=Br(),u=Kl(),[d,h]=k.useState(""),[p,b]=k.useState(null),[C,v]=k.useState(null),[S,B]=k.useState(!1),[L,W]=k.useState(!1),[ie,ee]=k.useState(!1),[F,A]=k.useState(!1),[x,E]=k.useState(""),[j,I]=k.useState("form"),[P,D]=k.useState(!1),[Ae,Ue]=k.useState(!1),ge=k.useRef(null),[Se,tt]=k.useState("pending"),[Ut,Ht]=k.useState("all"),[ae,Me]=k.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[fe,Ie]=k.useState(!1),[ze,bt]=k.useState(null),[nt,Ct]=k.useState(!1),[ot,Nt]=k.useState(""),[Xt,Q]=k.useState(!1),Pe=k.useRef(!1),qe=k.useRef(!1),Le=k.useRef(null),$e=k.useRef(new Set),[gt,Ot]=k.useState([]),[ct,T]=k.useState([]),[$,X]=k.useState(null),[ye,le]=k.useState([]),[de,Ee]=k.useState([]),[Ke,Ze]=k.useState(!1),[Ne,fn]=k.useState({}),[Pt,st]=k.useState(!1),sn=()=>{const g=localStorage.getItem("lastSelectedProject"),R=u.filter(w=>w.status!=="completed");return g&&R.some(w=>w.name===g)?g:R.length>0?R[0].name:""},[V,oe]=k.useState({project:"",date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});k.useEffect(()=>{(async()=>{try{const R=await Ys.getAllContractors();Ot(R.map(w=>({id:w._id||w.id,rank:w.rank,companyName:w.companyName,name:w.name,process:w.process,contact:w.contact,accountNumber:w.accountNumber,bankName:w.bankName,notes:w.notes,createdAt:new Date(w.createdAt),updatedAt:new Date(w.updatedAt)})))}catch(R){console.error("Failed to load contractors:",R)}})()},[]),k.useEffect(()=>{Ht("all");const g=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);(async()=>{g&&(console.log("[]   - Firestore  "),await vf()),s().catch(M=>{console.error("Failed to load projects:",M)}),n().catch(M=>{console.error("Failed to load payments:",M)})})();const w=()=>{D(window.innerWidth<1024)};if(w(),window.addEventListener("resize",w),u.length>0&&!V.project&&!qe.current){const M=sn();M&&(oe(H=>({...H,project:M})),localStorage.setItem("lastSelectedProject",M))}return()=>window.removeEventListener("resize",w)},[]);const De=k.useRef(new Map);k.useEffect(()=>{console.log("[ ] Firestore  ...");const g=gs.subscribeToPayments(R=>{console.log("[ ]  :",R.length,""),R.forEach(q=>{const O=String(q.id),Z=De.current.get(O);Z&&Z!=="completed"&&q.status==="completed"&&($e.current.has(O)||te.success(`: ${q.project_name||""} ${q.item_name||""}`.trim(),{duration:4e3}))});const w=new Map;R.forEach(q=>{w.set(String(q.id),q.status)}),De.current=w;const M=R.map(q=>({id:String(q.id),project:q.project_name||"",purpose:q.description,process:q.vendor_name,itemName:q.item_name||"",amount:q.amount,materialAmount:q.material_amount||0,laborAmount:q.labor_amount||0,originalMaterialAmount:q.original_material_amount||0,originalLaborAmount:q.original_labor_amount||0,applyTaxDeduction:q.apply_tax_deduction===1,includesVAT:q.includes_vat===1,quickText:q.quick_text||"",images:(()=>{if(!q.images)return[];if(Array.isArray(q.images))return q.images;try{const O=JSON.parse(q.images);return Array.isArray(O)?O:[]}catch{return[]}})(),category:q.request_type,status:q.status,urgency:"normal",requestedBy:q.requester_name,requestDate:new Date(q.request_date||q.created_at),approvalDate:q.approved_at?new Date(q.approved_at):void 0,bankInfo:{accountHolder:q.account_holder||"",bankName:q.bank_name||"",accountNumber:q.account_number||""},attachments:[],notes:q.notes||"",completionDate:q.paid_at?new Date(q.paid_at):void 0})),H=M.filter(q=>q.status==="pending").length,G=M.filter(q=>q.status==="completed").length;console.log("[ ] Zustand  :",M.length," (:",H,", :",G,")"),e(M)});return()=>{console.log("[ ] Firestore  "),g()}},[e]),k.useEffect(()=>{if(!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))return;console.log("[ ] 3   ");const R=setInterval(async()=>{try{await n()}catch(w){console.warn("[ ]  :",w)}},3e3);return()=>{console.log("[ ]  "),clearInterval(R)}},[n]),k.useEffect(()=>{const g=async()=>{if(document.visibilityState==="visible"){if(Le.current){console.log("[]     - ");return}if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){console.log("[]  - Firestore  "),await vf();try{await n()}catch(w){console.error("[]  :",w)}}}};return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[n]),k.useEffect(()=>{(async()=>{var M,H,G,q;if(Pe.current)return;const R=new URLSearchParams(window.location.search),w=R.get("complete")||R.get("c");if(w){if(!m){console.log("[ ]   -  ");return}Pe.current=!0,console.log("[ ]  :",w),window.history.replaceState({},"","/payments"),qe.current=!0,I("list"),tt("completed"),Ht("all"),oe(O=>({...O,project:""})),c(String(w),{status:"completed",completionDate:new Date}),$e.current.add(String(w)),setTimeout(()=>{$e.current.delete(String(w))},1e4),te.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await a(String(w),{status:"completed"}),await n()}catch(O){console.error("[ ]  :",O),c(String(w),{status:"pending",completionDate:void 0}),tt("pending");let Z="  ";((M=O.response)==null?void 0:M.status)===401?Z=" .  ":((H=O.response)==null?void 0:H.status)===404?Z="     (ID: "+w+")":(q=(G=O.response)==null?void 0:G.data)!=null&&q.error?Z=O.response.data.error:O.message&&(Z+=": "+O.message),te.error(Z)}}})()},[n,a,c,m]),k.useEffect(()=>{if(V.process){const g=new Set(t.filter(H=>{var G;return H.status==="completed"&&((G=H.bankInfo)==null?void 0:G.accountHolder)}).map(H=>H.bankInfo.accountHolder.trim().toLowerCase())),R=(H,G)=>{const q=H.toLowerCase(),O=G.toLowerCase();if(q.includes(O)||O.includes(q))return!0;const Z=q.split("/").map(we=>we.trim()),re=O.replace(/$/,"").trim();for(const we of Z)if(we===re||re.includes(we)||we.includes(re))return!0;return!1},M=gt.filter(H=>{if(!R(V.process,H.process))return!1;const q=H.accountNumber&&H.accountNumber.trim()!=="",O=H.name.trim().toLowerCase(),Z=g.has(O);return q||Z}).sort((H,G)=>{const q=H.accountNumber&&H.accountNumber.trim()!=="",O=G.accountNumber&&G.accountNumber.trim()!=="";return q&&!O?-1:!q&&O?1:0});T(M)}else T([])},[V.process,gt,t]),k.useEffect(()=>{if(V.process){const g=(M,H)=>{if(!H)return!1;const G=M.toLowerCase(),q=H.toLowerCase();if(G.includes(q)||q.includes(G))return!0;const O=G.split("/").map(re=>re.trim()),Z=q.replace(/$/,"").trim();for(const re of O)if(re===Z||Z.includes(re)||re.includes(Z))return!0;return!1},R=t.filter(M=>{var H,G,q;return M.status==="completed"&&M.process&&g(V.process,M.process)&&((H=M.bankInfo)==null?void 0:H.accountHolder)&&((G=M.bankInfo)==null?void 0:G.bankName)&&((q=M.bankInfo)==null?void 0:q.accountNumber)}),w=new Map;R.forEach(M=>{const H=`${M.bankInfo.accountHolder}_${M.bankInfo.bankName}_${M.bankInfo.accountNumber}`;w.has(H)||w.set(H,{accountHolder:M.bankInfo.accountHolder,bankName:M.bankInfo.bankName,accountNumber:M.bankInfo.accountNumber,itemName:M.itemName||"",amount:M.amount||0})}),le(Array.from(w.values()))}else le([])},[V.process,t]),k.useEffect(()=>{var R;const g=((R=V.accountHolder)==null?void 0:R.trim())||"";if(g.length>=1&&Ke){const w=[],M=new Set;gt.filter(H=>H.accountNumber&&H.accountNumber.trim()!=="").forEach(H=>{const G=H.name.trim(),q=G.toLowerCase(),O=g.toLowerCase();if(q.startsWith(O)&&!M.has(q)){M.add(q);const Z=t.find(re=>{var we,Ye;return re.status==="completed"&&((Ye=(we=re.bankInfo)==null?void 0:we.accountHolder)==null?void 0:Ye.trim().toLowerCase())===q&&re.process});w.push({name:G,bankName:H.bankName||"",accountNumber:H.accountNumber||"",process:(Z==null?void 0:Z.process)||"",source:"contractor"})}}),t.filter(H=>{var G;return H.status==="completed"&&((G=H.bankInfo)==null?void 0:G.accountHolder)}).forEach(H=>{const G=H.bankInfo.accountHolder.trim(),q=G.toLowerCase(),O=g.toLowerCase();q.startsWith(O)&&!M.has(q)&&(M.add(q),w.push({name:G,bankName:H.bankInfo.bankName||"",accountNumber:H.bankInfo.accountNumber||"",process:H.process||"",source:"payment"}))}),Ee(w)}else Ee([])},[V.accountHolder,Ke,gt,t]);const Be=g=>{const R=g.split(`
`).map(O=>O.trim()).filter(O=>O),w={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},M=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],H=O=>{const Z=["","","","","","","",""];for(const re of Z)if(O.endsWith(re)&&O.length>re.length+1)return O.slice(0,-re.length);return O},G=O=>{if(!O||O.length<2||O.length>5||!/^[-]{2,5}$/.test(O)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(O)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(O))return!1;if(O.length>=2){const we=O.charAt(0),Ye=O.substring(0,2);if(["","","","","","",""].includes(Ye)||M.includes(we))return!0}return O.length>=2&&O.length<=4},q=R.some(O=>O.includes(" ")||O.includes(""));if(R.forEach((O,Z)=>{if(O.includes("")&&O.includes(":")){const re=O.match(/\s*:\s*(.+)/);re&&(w.itemName=re[1].trim())}if(O.includes("")&&O.includes(":")){const re=O.match(/\s*:\s*(.+)/);re&&(w.bankInfo.accountHolder=re[1].trim())}if(O.includes("")&&O.includes(":")){const re=O.match(/\s*:\s*(.+)/);re&&(w.bankInfo.bankName=re[1].trim())}if(O.includes("")&&O.includes(":")){const re=O.match(/\s*:\s*(.+)/);re&&(w.bankInfo.accountNumber=re[1].trim())}if(O.includes("")&&O.includes(":")){const re=O.match(/\s*:\s*([\d,]+)?/);re&&(w.amounts.total=parseInt(re[1].replace(/,/g,"")))}}),!q){let O=-1;if(R.forEach(Z=>{const re=Z.match(/\[([^\]]+)\]/);re&&!w.itemName&&(w.itemName=re[1].trim())}),R.forEach((Z,re)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){w.includeVat=!0;const Te=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),ve=Z.match(/(\d+)\s*\s*?/),Xe=Z.match(/([\d,]+)\s*/);if(Te){const ft=parseInt(Te[1])*1e4+parseInt(Te[2])*1e3;w.amounts.total=ft}else if(ve){const ft=parseInt(ve[1])*1e4;w.amounts.total=ft}else if(Xe){const ft=parseInt(Xe[1].replace(/,/g,""));ft>=1e3&&(w.amounts.total=ft)}return}const Ye=Z.match(/=\s*([\d,.]+)\s*?/);let at=null;if(Ye){const Te=parseInt(Ye[1].replace(/[,.]/g,""));Te>=1e3&&(w.amounts.total=Te)}else{const Te=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Te){const ve=parseInt(Te[1])*1e4,Xe=parseInt(Te[2])*1e3,ft=ve+Xe;Z.includes("")||Z.includes("")?w.amounts.material=ft:Z.includes("")||Z.includes("")?w.amounts.labor=ft:w.amounts.total||(w.amounts.total=ft),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),at=Te}else if(at=Z.match(/(\d+)\s*\s*?/),at){const ve=parseInt(at[1])*1e4;Z.includes("")||Z.includes("")?w.amounts.material=ve:Z.includes("")||Z.includes("")?w.amounts.labor=ve:w.amounts.total||(w.amounts.total=ve),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(ve=>{const Xe=ve.trim();Xe.startsWith("[")||Xe.endsWith("]")||(/^[\d\-]+$/.test(Xe)&&Xe.replace(/\-/g,"").length>=10?w.bankInfo.accountNumber||(w.bankInfo.accountNumber=Xe):G(Xe)&&!w.bankInfo.accountHolder&&(w.bankInfo.accountHolder=Xe))});const xe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{6}[\s\-]+\d{2}[\s\-]+\d{3}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,6}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let He="",Qt=-1;for(const Te of xe){const ve=Z.match(Te);if(ve&&!w.bankInfo.accountNumber){He=ve[0],Qt=ve.index||-1,w.bankInfo.accountNumber=ve[0].trim().replace(/\s+/g,"-");const ft=Z.substring(Qt+He.length).trim().split(/\s+/);for(const mt of ft){if(mt.startsWith("[")||mt.endsWith("]"))continue;const je=H(mt);if(G(je)){w.bankInfo.accountHolder=je;break}}if(!w.bankInfo.accountHolder&&re>0){const je=R[re-1].split(/\s+/);for(const We of je){if(We.startsWith("[")||We.endsWith("]"))continue;const Dt=H(We);if(G(Dt)){w.bankInfo.accountHolder=Dt;break}}}if(!w.bankInfo.accountHolder&&re+1<R.length){const mt=R[re+1],je=mt.split(/\s+/);for(const We of je){if(We.startsWith("[")||We.endsWith("]"))continue;const Dt=H(We);if(G(Dt)){w.bankInfo.accountHolder=Dt;break}}if(!w.bankInfo.accountHolder){const We=mt.match(/^([-]{2,6})/);if(We){const Dt=H(We[1].trim());G(Dt)&&(w.bankInfo.accountHolder=Dt)}}}break}}const mn=Z.match(/[\d,]+/g);if(mn){const Te=He?He.split(/[\s\-]+/).filter(Xe=>Xe):[],ve=He?He.replace(/[\s\-]/g,""):"";mn.forEach(Xe=>{const ft=parseInt(Xe.replace(/,/g,"")),mt=Xe.replace(/,/g,""),je=Te.some(We=>We===mt||parseInt(We)===ft||ve.includes(mt));!w.bankInfo.accountNumber&&mt.length>=10&&mt.length<=20?(w.bankInfo.accountNumber=mt,He=mt):ft>=1e3&&!at&&!je&&(Z.includes("")||Z.includes("")?w.amounts.material=ft:Z.includes("")||Z.includes("")?w.amounts.labor=ft:w.amounts.total||(w.amounts.total=ft))})}const ns={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},en=Object.keys(ns).sort((Te,ve)=>ve.length-Te.length);for(const Te of en)if(Z.includes(Te)){const ve=ns[Te];w.bankInfo.bankName=ve,O=re;const Xe=new RegExp(`${Te}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),ft=Z.match(Xe);if(ft){const mt=H(ft[1]);mt&&!/^\d+$/.test(mt)&&mt!==""&&(w.bankInfo.accountHolder=mt)}break}if(!w.bankInfo.bankName){const Te=Z.match(/([-]+)(|)/);Te&&(w.bankInfo.bankName=Te[0])}const Yn=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Te of Yn){const ve=Z.match(Te);if(ve&&!w.bankInfo.accountHolder){w.bankInfo.accountHolder=ve[0].trim();break}}const Gn=Z.match(/\(([-]{2,5})\)/);if(Gn&&!w.bankInfo.accountHolder){const Te=Gn[1];G(Te)&&!["","",""].includes(Te)&&(w.bankInfo.accountHolder=Te)}if(!w.bankInfo.accountHolder){const Te=/[-]{2,6}/g,ve=Z.match(Te);if(ve){const Xe=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),ft=Z.match(/||||/);ve.forEach(mt=>{const je=H(mt),We=g.split(`
`)[re];if(We&&We.includes(`[${mt}]`)||!G(je)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(je))return;const Dn=Z.indexOf(mt);if(Dn>0){const kn=Z[Dn-1];if(/[-]/.test(kn))return}if(Dn+mt.length<Z.length){const kn=Z[Dn+mt.length];if(/[-]/.test(kn))return}if(!(Gn&&je===Gn[1])){if((Xe||ft)&&!w.bankInfo.accountHolder)w.bankInfo.accountHolder=je;else if(!w.bankInfo.accountHolder){const kn=/||||/,lt=/\d{6,}/;(re>0&&(lt.test(R[re-1])||kn.test(R[re-1]))||re<R.length-1&&(lt.test(R[re+1])||kn.test(R[re+1]))||kn.test(Z))&&(w.bankInfo.accountHolder=je)}}})}}const Tt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Te,ve]of Object.entries(Tt))if(Z.includes(Te)){w.vendor=ve;break}if(re===0&&!w.itemName){const Te=Z.replace(/[\[\]{}()<>]/g,"").trim();Te&&!Te.includes(" ")&&(G(Te)||(w.itemName=Te.substring(0,50)))}}),O>=0&&O+1<R.length){const Z=R[O+1],re=Z.trim();if(/^[-]{2,5}$/.test(re)&&G(re))w.bankInfo.accountHolder=re;else{const we=Z.split(/\s+/);for(const Ye of we){const at=H(Ye);if(G(at)){w.bankInfo.accountHolder=at;break}}}}}if(w.itemName&&w.itemName.includes("")&&(w.vendor=""),w.itemName){const O=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=w.itemName.toLowerCase(),re=O.some(xe=>Z===xe.toLowerCase()||Z.startsWith(xe.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),we=/^[\d\-\s]/.test(w.itemName),Ye=/^\d{2,}[\s\-]?\d+/.test(w.itemName.replace(/[-]/g,"").trim()),at=w.bankInfo.accountHolder&&(w.itemName===w.bankInfo.accountHolder||w.itemName.includes(w.bankInfo.accountHolder));(re||we||Ye||at)&&(w.itemName=void 0)}return w},ue=async()=>{var g,R,w,M,H,G,q,O,Z,re,we;try{const Ye=V.quickText;if(!Ye.trim())return;let at=t;t.length===0&&(console.log("payments  ,  ..."),await n(),await new Promise(ve=>setTimeout(ve,100)),at=Ir.getState().payments,console.log("payments  :",at.length,""));const xe=Be(Ye);console.log("  :",xe);const He={project:V.project,date:V.date,quickText:V.quickText,quickImages:V.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};X(null),W(!1),ee(!1);let Qt=0;xe.amounts.material&&(Qt+=xe.amounts.material),xe.amounts.labor&&(Qt+=xe.amounts.labor),xe.amounts.total&&!xe.amounts.material&&!xe.amounts.labor&&(Qt=xe.amounts.total),Qt>0&&(He.amount=Qt),xe.bankInfo.bankName&&(He.bankName=xe.bankInfo.bankName),xe.bankInfo.accountHolder&&(He.accountHolder=xe.bankInfo.accountHolder),xe.bankInfo.accountNumber&&(He.accountNumber=xe.bankInfo.accountNumber);const mn=ve=>ve?ve.replace(/[^0-9]/g,""):"",ns=(ve,Xe)=>{if(!ve||!Xe)return!1;const ft=mn(ve),mt=mn(Xe);if(!ft||!mt)return!1;const je=6;return ft.length<je||mt.length<je?ft===mt:mt.includes(ft)||ft.includes(mt)},en=mn(xe.bankInfo.accountNumber||""),Yn=xe.bankInfo.accountHolder||"";let Gn=!1;console.log("===    ==="),console.log(" :",xe.bankInfo.accountNumber),console.log(" :",en),console.log(" :",Yn),console.log(" :",gt.length),console.log("  :",at.filter(ve=>ve.status==="completed").length);let Tt=gt.find(ve=>{const Xe=mn(ve.accountNumber||"");return Xe&&Xe===en});if(!Tt&&en&&(Tt=gt.find(ve=>{const Xe=mn(ve.accountNumber||"");return ns(en,Xe)})),Tt&&(Gn=!0),!Tt&&Yn&&(Tt=gt.find(ve=>ve.name===Yn),Tt)){console.log("  :",Tt.name);const ve=((g=Tt.accountNumber)==null?void 0:g.replace(/[-\s]/g,""))||"";en&&!ns(en,ve)?(console.log("    ( ) -  "),Gn=!1):Gn=!0}if(Tt&&(Tt.name&&(He.accountHolder=Tt.name,console.log("  :",Tt.name)),Tt.bankName?He.bankName=Tt.bankName:xe.bankInfo.bankName&&(He.bankName=xe.bankInfo.bankName),Gn&&(He.accountNumber=Tt.accountNumber||xe.bankInfo.accountNumber),X(Tt.id||Tt._id||null),Tt.process&&(He.process=Tt.process)),!Tt){let ve=!1;console.log("===     ==="),console.log("  payments :",at.length,""),console.log(" :",en),console.log(" :",Yn);const Xe=at.filter(We=>We.status==="completed");console.log(" :",Xe.length);const ft=[...new Set(Xe.map(We=>{var Dt;return(Dt=We.bankInfo)==null?void 0:Dt.accountHolder}).filter(Boolean))];console.log("   ( 20):",ft.slice(0,20)),console.log("  ():",en);const mt=Xe.filter(We=>{var Dt;return(Dt=We.bankInfo)==null?void 0:Dt.accountNumber}).map(We=>{var Dt,Dn,kn;return{holder:(Dt=We.bankInfo)==null?void 0:Dt.accountHolder,account:(Dn=We.bankInfo)==null?void 0:Dn.accountNumber,clean:mn(((kn=We.bankInfo)==null?void 0:kn.accountNumber)||"")}}).filter(We=>We.clean.includes(en.substring(0,6))||en.includes(We.clean.substring(0,6)));console.log("  :",mt);let je=at.find(We=>{var kn;const Dt=mn(((kn=We.bankInfo)==null?void 0:kn.accountNumber)||"");return Dt&&Dt===en&&We.status==="completed"});if(je&&console.log("   :",(R=je.bankInfo)==null?void 0:R.accountHolder,je.process),!je&&en&&(je=at.find(We=>{var Dn;const Dt=mn(((Dn=We.bankInfo)==null?void 0:Dn.accountNumber)||"");return ns(en,Dt)&&We.status==="completed"}),je&&console.log("   :",(w=je.bankInfo)==null?void 0:w.accountHolder,je.process)),je&&(ve=!0),!je&&Yn&&(je=at.find(We=>{var Dt;return((Dt=We.bankInfo)==null?void 0:Dt.accountHolder)===Yn&&We.status==="completed"}),je)){console.log("    :",(M=je.bankInfo)==null?void 0:M.accountHolder,":",je.process);const We=mn(((H=je.bankInfo)==null?void 0:H.accountNumber)||"");en&&!ns(en,We)?(console.log("    ( ) -  "),ve=!1):ve=!0}je?(console.log(" :",{accountHolder:(G=je.bankInfo)==null?void 0:G.accountHolder,accountNumber:(q=je.bankInfo)==null?void 0:q.accountNumber,bankName:(O=je.bankInfo)==null?void 0:O.bankName,process:je.process,status:je.status,paymentMatchedByAccountNumber:ve}),(Z=je.bankInfo)!=null&&Z.accountHolder&&(He.accountHolder=je.bankInfo.accountHolder,console.log("  :",je.bankInfo.accountHolder)),(re=je.bankInfo)!=null&&re.bankName?He.bankName=je.bankInfo.bankName:xe.bankInfo.bankName&&(He.bankName=xe.bankInfo.bankName),ve&&(He.accountNumber=((we=je.bankInfo)==null?void 0:we.accountNumber)||xe.bankInfo.accountNumber),je.process&&!He.process?(He.process=je.process,console.log("    :",je.process)):console.log("   - process:",je.process,"updatedFormData.process:",He.process)):console.log("  ")}if(xe.vendor&&(He.process=xe.vendor),!He.process){const ve=Ye.toLowerCase();for(const Xe of wc)if(ve.includes(Xe.toLowerCase())){He.process=Xe;break}}xe.itemName&&(He.itemName=xe.itemName),oe(He),xe.includeVat&&(W(!0),ee(!1));const Te=[];if(xe.amounts.material||xe.amounts.labor||xe.amounts.total){const ve=[];xe.amounts.material&&ve.push(`: ${xe.amounts.material.toLocaleString()}`),xe.amounts.labor&&ve.push(`: ${xe.amounts.labor.toLocaleString()}`),xe.amounts.total&&!xe.amounts.material&&!xe.amounts.labor&&ve.push(`: ${xe.amounts.total.toLocaleString()}`),Te.push(ve.join(", "))}if(xe.bankInfo.bankName||xe.bankInfo.accountHolder){const ve=[];xe.bankInfo.bankName&&ve.push(xe.bankInfo.bankName),xe.bankInfo.accountHolder&&ve.push(xe.bankInfo.accountHolder),xe.bankInfo.accountNumber&&ve.push(xe.bankInfo.accountNumber),ve.length>0&&Te.push(`: ${ve.join(" ")}`)}xe.vendor&&Te.push(`: ${xe.vendor}`),xe.includeVat&&Te.push("  "),Te.length>0?te.success(`  !
${Te.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):te.info("  ...    .")}catch(Ye){console.error(" :",Ye),te.error("   .")}};k.useEffect(()=>{(async()=>{try{await KC();const R=await $C();fn(R),st(!0)}catch(R){console.error("  :",R),st(!0)}})()},[]);const Lt=k.useRef({});k.useEffect(()=>{Pt&&(Object.entries(Ne).forEach(([g,R])=>{JSON.stringify(Lt.current[g])!==JSON.stringify(R)&&WC(g,R).catch(w=>{console.error("  :",w),te.error("  ")})}),Lt.current={...Ne})},[Ne,Pt]);const yt=k.useCallback(async g=>{var M;const R=(M=g.clipboardData)==null?void 0:M.items;if(!R)return;let w=!1;for(let H=0;H<R.length;H++)if(R[H].type.indexOf("image")!==-1){w=!0;break}if(w){if(!p){const H=document.activeElement;(H==null?void 0:H.tagName)==="INPUT"||(H==null?void 0:H.tagName)==="TEXTAREA"||(H==null?void 0:H.classList.contains("form-input"))||te.error("  ");return}for(let H=0;H<R.length;H++)if(R[H].type.indexOf("image")!==-1){g.preventDefault();const G=R[H].getAsFile();if(G){const q=new FileReader;q.onload=async O=>{var re;const Z=(re=O.target)==null?void 0:re.result;if(Z)try{const we=t.find(xe=>xe.id===p),at=[...(we==null?void 0:we.images)||Ne[p]||[],Z];await gs.updatePaymentImages(p,at),fn(xe=>({...xe,[p]:at})),await n(),te.success(" ")}catch(we){console.error("  :",we),te.error("  ")}},q.readAsDataURL(G)}}}},[p,t,Ne,n]);k.useEffect(()=>(document.addEventListener("paste",yt),()=>document.removeEventListener("paste",yt)),[yt]);const dt=[...(m==null?void 0:m.name)===""?t.filter(g=>u.some(R=>R.name===g.project)):t].sort((g,R)=>new Date(R.requestDate).getTime()-new Date(g.requestDate).getTime()),Jt=dt.filter(g=>{var G,q,O;if(!g||!g.id)return!1;const R=d===""||((G=g.purpose)==null?void 0:G.toLowerCase().includes(d.toLowerCase()))||((q=g.itemName)==null?void 0:q.toLowerCase().includes(d.toLowerCase()))||((O=g.process)==null?void 0:O.toLowerCase().includes(d.toLowerCase())),w=Se==="pending"?g.status!=="completed":g.status==="completed",M=Ut==="all"||!Ut||g.project===Ut,H=!ae||Se!=="completed"||g.requestedBy===(m==null?void 0:m.username);return R&&w&&M&&H}).sort((g,R)=>!g&&!R?0:g?R?Se==="completed"?qa(R.completionDate)-qa(g.completionDate):qa(R.requestDate)-qa(g.requestDate):-1:1),Zt=g=>{const R=g.id||g._id||null;if($===R){X(null);const G=document.querySelector('input[placeholder=" "]');G&&setTimeout(()=>{G.focus()},100);return}X(R);const w=Mo(g.name);let M=g.bankName||"",H=g.accountNumber||"";if(H&&!M){const G=H.trim().split(/\s+/);if(G.length>=2){const q=G[0];(q.includes("")||q.includes("")||q.includes("")||q.includes("")||q.includes(""))&&(M=q,H=G.slice(1).join(""))}}oe(G=>({...G,accountHolder:w,bankName:M,accountNumber:H}))};Jt.reduce((g,R)=>{const w=R.materialAmount||0,M=R.laborAmount||0,H=R.amount||0;let G=w,q=M,O=0;return w===0&&M===0&&H>0?R.includesVAT?(G=Math.round(H/1.1),O=H-G):(G=H,O=0):R.includesVAT?(w>0&&(G=Math.round(w/1.1)),M>0&&(q=Math.round(M/1.1)),O=H-(G+q)):O=0,g.material+=G,g.labor+=q,g.vat+=O,g.total+=H,g},{material:0,labor:0,vat:0,total:0});const In=async()=>{var R,w,M;if(Xt){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",m),console.log(" Form data:",V),!V.project){te.error(" ");return}if(!V.itemName){te.error(" ");return}const g=Number(V.amount)||0;if(g===0){te.error(" ");return}Q(!0);try{const H=ie?Math.round(g*.967):g,G=new Date;if(C){const q={project:V.project,requestDate:new Date(V.date),purpose:V.itemName,amount:H,category:"material",urgency:"normal",process:V.process,itemName:V.itemName,includesVAT:L,applyTaxDeduction:ie,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:V.accountHolder,bank:V.bankName,accountNumber:V.accountNumber,bankInfo:V.accountHolder||V.bankName||V.accountNumber?{accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber}:void 0,updatedAt:G};console.log(" Updating payment:",q),await a(C,q),te.success(" "),v(null)}else{const q=V.project||"",O={id:`payment_${Date.now()}`,project:q,requestDate:new Date(V.date),requestedBy:(m==null?void 0:m.username)||"  ",purpose:V.itemName,amount:H,status:"pending",category:"material",urgency:"normal",process:V.process,itemName:V.itemName,includesVAT:L,applyTaxDeduction:ie,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:V.accountHolder,bank:V.bankName,accountNumber:V.accountNumber,bankInfo:V.accountHolder||V.bankName||V.accountNumber?{accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber}:void 0,quickText:V.quickText||"",images:V.quickImages,attachments:[],createdAt:G,updatedAt:G};console.log(" Creating payment:",O),console.log(" Images in payment:",((R=V.quickImages)==null?void 0:R.length)||0,"");const Z=await r(O);if(Le.current=Z,setTimeout(()=>{Le.current=null},1e4),te.success(" "),V.accountHolder&&V.bankName&&V.accountNumber){const re=L||ie?"01074088864":"01089423283";try{await gs.sendTossPaymentSms({recipientPhone:re,accountHolder:V.accountHolder,bankName:V.bankName,accountNumber:V.accountNumber,amount:H,projectName:q,itemName:V.itemName,process:V.process,paymentId:Z}),te.success("   ")}catch(we){console.error("SMS  :",we),te.error("  : "+(((M=(w=we.response)==null?void 0:w.data)==null?void 0:M.error)||we.message||"   "))}}}oe(q=>({project:q.project,date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),W(!1),ee(!1),X(null),window.innerWidth<768&&I("list")}catch(H){console.error(" Payment save error:",H),te.error("  : "+H.message)}finally{Q(!1)}},fs=g=>{var R,w,M,H;try{console.log("[handleEdit] Starting edit for payment:",g.id);const G=g.originalMaterialAmount!==void 0?g.originalMaterialAmount:g.materialAmount||0,q=g.originalLaborAmount!==void 0?g.originalLaborAmount:g.laborAmount||0,O={project:g.project||"",date:g.requestDate?Mt(new Date(g.requestDate),"yyyy-MM-dd"):Mt(new Date,"yyyy-MM-dd"),process:g.process||"",itemName:g.itemName||g.purpose||"",materialCost:G>0?G.toString():"",laborCost:q>0?q.toString():"",amount:((R=g.amount)==null?void 0:R.toString())||"",accountHolder:((w=g.bankInfo)==null?void 0:w.accountHolder)||"",bankName:((M=g.bankInfo)==null?void 0:M.bankName)||"",accountNumber:((H=g.bankInfo)==null?void 0:H.accountNumber)||"",images:g.attachments||[],quickText:g.quickText||"",quickImages:g.images||[]};console.log("[handleEdit] Setting form data:",O),oe(O),W(g.includesVAT||!1),ee(g.applyTaxDeduction||!1),b(g.id),v(g.id),P&&I("form"),console.log("[handleEdit] Edit setup complete"),te.success("  ")}catch(G){console.error("[handleEdit] Error:",G),te.error("     ")}},Qn=async g=>{var R,w,M;try{const H=((R=g.bankInfo)==null?void 0:R.accountHolder)||g.accountHolder,G=((w=g.bankInfo)==null?void 0:w.bankName)||g.bank,q=((M=g.bankInfo)==null?void 0:M.accountNumber)||g.accountNumber;if(!H||!G||!q){te.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${G}
: ${q}
: ${g.amount.toLocaleString()}`))return;const Z=q.replace(/[-\s]/g,""),re=gE[G]||G,we=hE[G]||"004",Ye="",at=`supertoss://send?amount=${g.amount}&bankCode=${we}&bank=${encodeURIComponent(re)}&accountNo=${Z}&receiverName=${encodeURIComponent(Ye)}&toName=${encodeURIComponent(Ye)}`;let xe=!1;try{window.location.href=at,xe=!0,te.success("  ...",{duration:3e3}),setTimeout(()=>{const He=/iPhone|iPad|iPod/i.test(navigator.userAgent),Qt=/Android/i.test(navigator.userAgent);(He||Qt)&&te(`      .

: 
: ${q}
: ${g.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(He){console.error("   :",He),te(`   .

: 
: ${G}
: ${q}
: ${g.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(H){console.error(" :",H),te.error(`   : ${H.message}`)}},ps=async g=>{const R=t.find(w=>w.id===g);if(R&&R.quickText){const w=localStorage.getItem("executionMemos"),M=w?JSON.parse(w):{};M[g]=R.quickText,localStorage.setItem("executionMemos",JSON.stringify(M))}c(g,{status:"completed",completionDate:new Date}),Ie(!1),tt("completed"),$e.current.add(g),setTimeout(()=>{$e.current.delete(g)},1e4),te.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await a(g,{status:"completed"})}catch(w){console.error(" API :",w),c(g,{status:"pending",completionDate:void 0}),tt("pending"),te.error("   -  ")}},$r=async g=>{var M;if(!p){te.error("  ");return}const w=Array.from(((M=g.target)==null?void 0:M.files)||[]).filter(H=>H.type.startsWith("image/"));if(w.length!==0){try{const H=await Promise.all(w.map(Z=>new Promise((re,we)=>{const Ye=new FileReader;Ye.onload=at=>{var He;const xe=(He=at.target)==null?void 0:He.result;xe?re(xe):we(new Error("  "))},Ye.onerror=()=>we(new Error("FileReader ")),Ye.readAsDataURL(Z)}))),G=t.find(Z=>Z.id===p),O=[...(G==null?void 0:G.images)||Ne[p]||[],...H];await gs.updatePaymentImages(p,O),fn(Z=>({...Z,[p]:O})),await n(),te.success(`${H.length}  `)}catch(H){console.error("  :",H),te.error("  ")}g.target.value=""}},ws=async g=>{if(p)try{const R=t.find(H=>H.id===p),M=((R==null?void 0:R.images)||Ne[p]||[]).filter((H,G)=>G!==g);await gs.updatePaymentImages(p,M),fn(H=>({...H,[p]:M})),await n()}catch(R){console.error("  :",R),te.error("  ")}},ts=g=>{E(g),A(!0)},Ss=g=>{g.preventDefault(),B(!0)},Bn=g=>{g.preventDefault(),B(!1)},Pn=async g=>{if(g.preventDefault(),B(!1),!p){te.error("  ");return}const w=Array.from(g.dataTransfer.files).filter(M=>M.type.startsWith("image/"));if(w.length!==0)try{const M=await Promise.all(w.map(O=>new Promise((Z,re)=>{const we=new FileReader;we.onload=Ye=>{var xe;const at=(xe=Ye.target)==null?void 0:xe.result;at?Z(at):re(new Error("  "))},we.onerror=()=>re(new Error("FileReader ")),we.readAsDataURL(O)}))),H=t.find(O=>O.id===p),q=[...(H==null?void 0:H.images)||Ne[p]||[],...M];await gs.updatePaymentImages(p,q),fn(O=>({...O,[p]:q})),await n(),te.success(`${M.length}  `)}catch(M){console.error("  :",M),te.error("  ")}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"lg:hidden mb-4",children:o.jsxDEV("select",{value:V.project,onChange:g=>{oe({...V,project:g.target.value}),g.target.value&&localStorage.setItem("lastSelectedProject",g.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(m==null?void 0:m.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2527,columnNumber:35},void 0),u.filter(g=>g.status!=="completed").map(g=>o.jsxDEV("option",{value:g.name,children:g.name},g.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2529,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2517,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2516,columnNumber:7},void 0),o.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:o.jsxDEV("nav",{className:"flex space-x-4",children:[o.jsxDEV("button",{onClick:()=>I("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${j==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2538,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>I("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${j==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>I("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${j==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2558,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2537,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2536,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2535,columnNumber:7},void 0),o.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[o.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${j!=="form"?"hidden md:block":""}`,children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("select",{value:V.project,onChange:g=>{oe({...V,project:g.target.value}),g.target.value&&localStorage.setItem("lastSelectedProject",g.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(m==null?void 0:m.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2593,columnNumber:43},void 0),u.filter(g=>g.status!=="completed").map(g=>o.jsxDEV("option",{value:g.name,children:g.name},g.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2595,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2583,columnNumber:17},void 0),o.jsxDEV("select",{value:V.bankName,onChange:g=>oe({...V,bankName:g.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2603,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2604,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2605,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2606,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2607,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2608,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2609,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2611,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2614,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2615,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2598,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2582,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2581,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("textarea",{value:V.quickText,onChange:g=>oe({...V,quickText:g.target.value}),onPaste:g=>{var w;const R=(w=g.clipboardData)==null?void 0:w.items;if(R){for(let M=0;M<R.length;M++)if(R[M].type.indexOf("image")!==-1){g.preventDefault();const H=R[M].getAsFile();if(H){const G=new FileReader;G.onload=q=>{var Z;const O=(Z=q.target)==null?void 0:Z.result;oe(re=>({...re,quickImages:[...re.quickImages,O]}))},G.readAsDataURL(H)}break}}},onDragOver:g=>{g.preventDefault(),g.stopPropagation()},onDrop:g=>{g.preventDefault(),g.stopPropagation(),Array.from(g.dataTransfer.files).filter(M=>M.type.startsWith("image/")).forEach(M=>{const H=new FileReader;H.onload=G=>{var O;const q=(O=G.target)==null?void 0:O.result;oe(Z=>({...Z,quickImages:[...Z.quickImages,q]}))},H.readAsDataURL(M)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:P?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2622,columnNumber:15},void 0),V.quickImages.length>0&&o.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:V.quickImages.map((g,R)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:g,alt:` ${R+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2677,columnNumber:23},void 0),o.jsxDEV("button",{type:"button",onClick:()=>{oe(w=>({...w,quickImages:w.quickImages.filter((M,H)=>H!==R)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2682,columnNumber:23},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2676,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2674,columnNumber:17},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[o.jsxDEV("label",{className:"cursor-pointer",children:[o.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g=>{Array.from(g.target.files||[]).forEach(w=>{const M=new FileReader;M.onload=H=>{var q;const G=(q=H.target)==null?void 0:q.result;oe(O=>({...O,quickImages:[...O.quickImages,G]}))},M.readAsDataURL(w)}),g.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2701,columnNumber:19},void 0),o.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2700,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",onClick:ue,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2726,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2699,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2621,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",V.date&&`(${Mt(new Date(V.date),"E",{locale:bn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2739,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:V.date,onChange:g=>oe({...V,date:g.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2742,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2758,columnNumber:17},void 0),o.jsxDEV("button",{ref:ge,type:"button",onClick:()=>Ue(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:V.process||o.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2765,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2759,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2772,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:V.itemName,onChange:g=>oe({...V,itemName:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2773,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("input",{type:"text",value:V.amount?Number(V.amount).toLocaleString():"",onChange:g=>{const R=g.target.value.replace(/[^0-9]/g,"");oe({...V,amount:R})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:19},void 0),o.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2797,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2785,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:g=>g.preventDefault(),onClick:()=>{L||ee(!1),W(!L)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${L?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:L&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2815,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2814,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2817,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2803,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:g=>g.preventDefault(),onClick:()=>{ie||W(!1),ee(!ie)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${ie?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:ie&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2833,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2832,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2835,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2821,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2802,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:13},void 0),o.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(ct.length>0||ye.length>0&&!$)&&o.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${ct.length===0?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:ct.map(g=>{const R=g.id||g._id,w=$===R;return o.jsxDEV("button",{type:"button",onClick:()=>Zt(g),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${w?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Mo(g.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2867,columnNumber:29},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[g.bankName||""," ",g.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2870,columnNumber:29},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2857,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2848,columnNumber:19},void 0),o.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${ye.length===0||$?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2883,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:ye.map((g,R)=>o.jsxDEV("button",{type:"button",onClick:()=>{oe(w=>({...w,accountHolder:g.accountHolder,bankName:g.bankName,accountNumber:g.accountNumber})),le([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:g.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2900,columnNumber:27},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[g.bankName," ",g.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2903,columnNumber:27},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2886,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2884,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2880,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2846,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2915,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:V.accountHolder,onChange:g=>oe({...V,accountHolder:g.target.value}),onFocus:()=>Ze(!0),onBlur:()=>setTimeout(()=>Ze(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2916,columnNumber:17},void 0),Ke&&de.length>0&&o.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:de.map((g,R)=>o.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:w=>w.preventDefault(),onClick:()=>{let w=g.bankName||"",M=g.accountNumber||"";const H=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],G={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const O of H)if(M.includes(O)){w||(w=G[O]||O),M=M.replace(O,"").trim();break}for(const O of H)if(w.includes(O)){const Z=G[O]||O,re=w.replace(O,"").trim();re&&/\d/.test(re)&&(M=re),w=Z;break}M=M.replace(/[^\d\-]/g,"").trim();const q=!V.process&&g.process?g.process:V.process;oe({...V,accountHolder:g.name,bankName:w||V.bankName,accountNumber:M||V.accountNumber,process:q}),Ze(!1)},children:[o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("span",{className:"font-medium",children:g.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3021,columnNumber:27},void 0),g.process&&o.jsxDEV("span",{className:"text-xs text-blue-600",children:[": ",g.process]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3023,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:g.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:25},void 0)]},`${g.name}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2929,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2927,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2914,columnNumber:15},void 0),o.jsxDEV("div",{className:"payment-bank-field",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:17},void 0),o.jsxDEV("select",{value:V.bankName,onChange:g=>oe({...V,bankName:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3043,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3044,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3045,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3046,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3047,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3048,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3049,columnNumber:19},void 0),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3050,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3051,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3052,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3053,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3054,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3055,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3056,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3057,columnNumber:19},void 0),o.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3058,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3059,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3060,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3061,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3062,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3063,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3065,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3038,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3070,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:V.accountNumber,onChange:g=>oe({...V,accountNumber:g.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3071,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3069,columnNumber:15},void 0),o.jsxDEV("div",{className:"pt-2 border-t",children:o.jsxDEV("div",{className:"flex justify-between items-baseline",children:[o.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3082,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-right",children:[(L||ie)&&o.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",L&&" ",ie&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3085,columnNumber:23},void 0),o.jsxDEV("span",{className:"font-semibold",children:[(()=>{const g=Number(V.amount)||0;let R=g;return ie&&(R=Math.round(g*.967)),R.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3089,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3083,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3081,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3080,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[C&&o.jsxDEV("button",{onClick:()=>{v(null),oe(g=>({project:g.project,date:Mt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),W(!1),ee(!1),X(null),te.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3108,columnNumber:19},void 0),o.jsxDEV("button",{onClick:g=>{console.log(" Payment button clicked!",g),console.log(" Button element:",g.currentTarget),console.log(" Form data:",V),In()},disabled:Xt,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${Xt?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:Xt?"...":C?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3137,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3106,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2843,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2579,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2576,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${j!=="list"?"hidden md:flex":""}`,children:[o.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:o.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:o.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[o.jsxDEV("button",{onClick:()=>tt("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${Se==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${Se==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:dt.filter(g=>g&&g.id&&g.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3167,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{tt("completed"),oe(g=>({...g,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${Se==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${Se==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:dt.filter(g=>g&&g.id&&g.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3195,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3182,columnNumber:17},void 0),Se==="completed"&&o.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[o.jsxDEV("input",{type:"checkbox",checked:ae,onChange:g=>{Me(g.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(g.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3166,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3165,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3164,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3219,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Jt.length>0?o.jsxDEV("div",{className:"space-y-4",children:Jt.map(g=>{var q,O,Z;const R=g.amount||0,w=((q=g.bankInfo)==null?void 0:q.accountHolder)||g.accountHolder||"",M=((O=g.bankInfo)==null?void 0:O.bankName)||g.bank||"",H=((Z=g.bankInfo)==null?void 0:Z.accountNumber)||g.accountNumber||"",G=w&&M&&H?`${w} | ${M} ${H}`:" ";return o.jsxDEV("div",{onClick:()=>b(g.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${p===g.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-baseline gap-2",children:[g.process&&o.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",g.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:31},void 0),o.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:g.purpose||g.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3253,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3249,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:g.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3257,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3248,columnNumber:25},void 0),o.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[o.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[R.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3260,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[g.requestedBy||"-","  ",ip(g.requestDate,"MM/dd",{locale:bn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3263,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3259,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[o.jsxDEV("span",{className:"text-gray-400",children:[" ",(g.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3271,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3272,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-400",children:[" ",(g.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3273,columnNumber:25},void 0),g.includesVAT&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3276,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3277,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3275,columnNumber:27},void 0),g.applyTaxDeduction&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3282,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3283,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3281,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3270,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[o.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:G},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3290,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[o.jsxDEV("button",{onClick:re=>{re.stopPropagation(),fs(g)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:o.jsxDEV(Pb,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3302,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3294,columnNumber:27},void 0),o.jsxDEV("button",{onClick:async re=>{re.stopPropagation(),window.confirm("  ?")&&(await i(g.id),te.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(ni,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3315,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3304,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3293,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3289,columnNumber:23},void 0),Se==="pending"&&(m==null?void 0:m.role)&&["manager","admin"].includes(m.role)&&o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("button",{onClick:re=>{if(re.stopPropagation(),g.status==="completed"){te.info("   ");return}Qn(g)},disabled:g.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${g.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:g.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3324,columnNumber:27},void 0),o.jsxDEV("button",{onClick:re=>{re.stopPropagation(),ps(g.id)},disabled:g.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${g.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:g.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:re=>{g.status!=="completed"&&(re.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:re=>{g.status!=="completed"&&(re.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3342,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3323,columnNumber:25},void 0)]},g.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3237,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3223,columnNumber:15},void 0):o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3373,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3221,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3160,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${j!=="image"?"hidden lg:flex":""}`,onDragOver:Ss,onDragLeave:Bn,onDrop:Pn,children:[o.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:$r,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3389,columnNumber:11},void 0),P&&p&&j==="image"&&(()=>{const g=dt.find(R=>R.id===p);return g?o.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:o.jsxDEV("div",{className:"flex justify-between items-start",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:g.purpose||g.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3406,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[g.process||"-","  ",ip(g.requestDate,"yyyy.MM.dd",{locale:bn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3407,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(g.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3411,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3403,columnNumber:17},void 0):null})(),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:g=>{var w;const R=g.target;if(!R.closest("img")&&!R.closest("button")&&p){const M=dt.find(O=>O.id===p),H=(M==null?void 0:M.images)||[],G=Ne[p]||[];(H.length>0?H:G).length>0&&((w=document.getElementById("image-file-input"))==null||w.click())}},children:p?(()=>{const g=dt.find(H=>H.id===p),R=(g==null?void 0:g.images)||[],w=Ne[p]||[],M=R.length>0?R:w;return o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3447,columnNumber:21},void 0),o.jsxDEV("textarea",{value:(g==null?void 0:g.quickText)||(g==null?void 0:g.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3448,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3446,columnNumber:19},void 0),M.length>0&&o.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:M.map((H,G)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:H,alt:` ${G+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:q=>{q.stopPropagation(),ts(H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3462,columnNumber:27},void 0),o.jsxDEV("button",{onClick:q=>{q.stopPropagation(),ws(G)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:o.jsxDEV(Nn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3478,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3471,columnNumber:27},void 0),o.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[G+1,"/",M.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3480,columnNumber:27},void 0)]},G,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3459,columnNumber:21},void 0),o.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${M.length>0?"":"flex-1"}`,onClick:H=>H.stopPropagation(),children:o.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${S?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${M.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[o.jsxDEV(Lc,{className:`mx-auto text-gray-400 mb-1 ${M.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:M.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3500,columnNumber:23},void 0),M.length===0&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3504,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3494,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3489,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3444,columnNumber:17},void 0)})():o.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:o.jsxDEV("div",{className:"text-center text-gray-400",children:[o.jsxDEV(Eo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3513,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3512,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3511,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3421,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3381,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2573,columnNumber:7},void 0),Ae&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[o.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Ue(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(Nn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3534,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3530,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3528,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:wc.map(g=>o.jsxDEV("button",{onClick:()=>{oe({...V,process:g}),Ue(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${V.process===g?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:g},g,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3541,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3539,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{oe({...V,process:""}),Ue(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3558,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3527,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3526,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>Ue(!1),children:o.jsxDEV("div",{onClick:g=>g.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:ge.current?`${ge.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:ge.current?`${ge.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[o.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[o.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3582,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>Ue(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(Nn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3587,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3583,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-2",children:[o.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:wc.map(g=>o.jsxDEV("button",{onClick:()=>{oe({...V,process:g}),Ue(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${V.process===g?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:g},g,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3594,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3592,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{oe({...V,process:""}),Ue(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3611,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3591,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3573,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3572,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3524,columnNumber:9},void 0),F&&o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>A(!1),children:o.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[o.jsxDEV("button",{onClick:g=>{g.stopPropagation(),A(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:o.jsxDEV(Nn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3640,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3633,columnNumber:13},void 0),o.jsxDEV("img",{src:x,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:g=>g.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3642,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3632,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3628,columnNumber:9},void 0),nt&&o.jsxDEV(FC,{projectName:ot,onClose:()=>Ct(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3654,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2514,columnNumber:5},void 0)},Yr=t=>t?typeof t=="string"?t:t instanceof be?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),hs={async getSpaces(t){const e=Fe(ne,"finish_check_spaces");let n;t?n=xt(e,Rn("project_id","==",t)):n=xt(e);const r=(await Vt(n)).docs.sort((a,c)=>(a.data().display_order||0)-(c.data().display_order||0)),i=[];for(const a of r){const c=a.data(),m=Fe(ne,"finish_check_items"),u=xt(m,Rn("space_id","==",a.id)),h=(await Vt(u)).docs.sort((b,C)=>(b.data().display_order||0)-(C.data().display_order||0)),p=[];for(const b of h){const C=b.data(),v=Fe(ne,"finish_check_images"),S=xt(v,Rn("item_id","==",b.id)),L=(await Vt(S)).docs.map(W=>({id:W.id,item_id:b.id,filename:W.data().filename||null,created_at:Yr(W.data().created_at)}));p.push({id:b.id,space_id:a.id,content:C.content||"",is_completed:C.is_completed||0,is_priority:C.is_priority||0,completed_at:C.completed_at?Yr(C.completed_at):null,display_order:C.display_order||0,created_at:Yr(C.created_at),updated_at:Yr(C.updated_at),images:L})}i.push({id:a.id,name:c.name||"",project_id:c.project_id||null,display_order:c.display_order||0,created_at:Yr(c.created_at),updated_at:Yr(c.updated_at),items:p})}return i},async createSpace(t,e){const n=Fe(ne,"finish_check_spaces"),s=xt(n,Rn("project_id","==",e)),i=(await Vt(s)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={name:t,project_id:e,display_order:i+1,created_at:rn(),updated_at:rn()};return{id:(await Os(n,a)).id,name:t,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(t,e){const n=Ce(ne,"finish_check_spaces",t);await Rt(n,{name:e,updated_at:rn()})},async deleteSpace(t){const e=Fe(ne,"finish_check_items"),n=xt(e,Rn("space_id","==",t)),s=await Vt(n);for(const r of s.docs){const i=Fe(ne,"finish_check_images"),a=xt(i,Rn("item_id","==",r.id)),c=await Vt(a);for(const m of c.docs)await Hn(Ce(ne,"finish_check_images",m.id));await Hn(Ce(ne,"finish_check_items",r.id))}await Hn(Ce(ne,"finish_check_spaces",t))},async createItem(t,e){const n=Fe(ne,"finish_check_items"),s=xt(n,Rn("space_id","==",t)),i=(await Vt(s)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:rn(),updated_at:rn()};return{id:(await Os(n,a)).id,space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(t,e){const n=Ce(ne,"finish_check_items",t);await Rt(n,{content:e,updated_at:rn()})},async deleteItem(t){const e=Fe(ne,"finish_check_images"),n=xt(e,Rn("item_id","==",t)),s=await Vt(n);for(const r of s.docs)await Hn(Ce(ne,"finish_check_images",r.id));await Hn(Ce(ne,"finish_check_items",t))},async toggleItem(t){const e=Ce(ne,"finish_check_items",t),n=await It(e);if(!n.exists())throw new Error("   .");const s=n.data(),r=s.is_completed?0:1;return await Rt(e,{is_completed:r,completed_at:r?rn():null,updated_at:rn()}),{id:t,space_id:s.space_id,content:s.content,is_completed:r,is_priority:s.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:s.display_order||0,created_at:Yr(s.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(t){const e=Ce(ne,"finish_check_items",t),n=await It(e);if(!n.exists())throw new Error("   .");const r=n.data().is_priority||0?0:1;return await Rt(e,{is_priority:r,updated_at:rn()}),{is_priority:r}},async getImageData(t){const e=Ce(ne,"finish_check_images",t),n=await It(e);if(!n.exists())return null;const s=n.data();return{image_data:s.image_url||s.image_data||""}},async uploadImage(t,e,n){const s=Fe(ne,"finish_check_images"),r={item_id:t,image_data:"",image_url:"",filename:n,created_at:rn()},i=await Os(s,r);let a=e;if(Qi(e)){const c=await Xg("finish_check",i.id,e);await Rt(i,{image_url:c,image_data:""}),a=c}else await Rt(i,{image_data:e});return{id:i.id,item_id:t,image_data:a,filename:n,created_at:new Date().toISOString()}},async deleteImage(t){const e=Ce(ne,"finish_check_images",t),n=await It(e);if(n.exists()){const s=n.data();s.image_url&&await Jg(s.image_url)}await Hn(e)}},xs={getSpaces:t=>hs.getSpaces(t),createSpace:(t,e)=>hs.createSpace(t,e),updateSpace:(t,e)=>hs.updateSpace(String(t),e),deleteSpace:t=>hs.deleteSpace(String(t)),createItem:(t,e)=>hs.createItem(String(t),e),updateItem:(t,e)=>hs.updateItem(String(t),e),deleteItem:t=>hs.deleteItem(String(t)),toggleItem:t=>hs.toggleItem(String(t)),togglePriority:t=>hs.togglePriority(String(t)),getImageData:t=>hs.getImageData(String(t)),uploadImage:(t,e,n)=>hs.uploadImage(String(t),e,n),deleteImage:t=>hs.deleteImage(String(t))},YC=()=>{var st,sn;const{user:t}=Br(),{loadProjectsFromAPI:e,projects:n}=Ir(),s=Kl(),[r,i]=k.useState([]),[a,c]=k.useState(!0),[m,u]=k.useState(null),[d,h]=k.useState([]),[p,b]=k.useState(!1),[C,v]=k.useState(""),[S,B]=k.useState(""),[L,W]=k.useState(null),[ie,ee]=k.useState(null),[F,A]=k.useState(""),[x,E]=k.useState(null),[j,I]=k.useState(""),[P,D]=k.useState(null),[Ae,Ue]=k.useState(new Set),ge=k.useRef(null),[Se,tt]=k.useState(window.innerWidth<768),[Ut,Ht]=k.useState(!1),[ae,Me]=k.useState(null),[fe,Ie]=k.useState(new Set),[ze,bt]=k.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[nt,Ct]=k.useState(!1),[ot,Nt]=k.useState(!1),[Xt,Q]=k.useState(new Set);k.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(ze))},[ze]),k.useEffect(()=>{(async()=>{n.length===0&&await e(),c(!1)})();const oe=()=>{tt(window.innerWidth<768)};return window.addEventListener("resize",oe),()=>window.removeEventListener("resize",oe)},[]),k.useEffect(()=>{a||Pe()},[s,a]),k.useEffect(()=>{m!==null&&qe()},[m]),k.useEffect(()=>{m!==null&&(t!=null&&t.id)&&localStorage.setItem(`finishCheck_selectedProject_${t.id}`,m.toString())},[m,t==null?void 0:t.id]),k.useEffect(()=>{if(!Se&&P){const V=async oe=>{var Be;const De=(Be=oe.clipboardData)==null?void 0:Be.items;if(De){for(let ue=0;ue<De.length;ue++)if(De[ue].type.indexOf("image")!==-1){oe.preventDefault();const Lt=De[ue].getAsFile();Lt&&await Ee(P,Lt)}}};return document.addEventListener("paste",V),()=>document.removeEventListener("paste",V)}},[P,Se]);const Pe=async()=>{try{const V=s.map(De=>({id:De.id,title:De.name}));i(V);const oe=t!=null&&t.id?localStorage.getItem(`finishCheck_selectedProject_${t.id}`):null;oe&&V.some(De=>De.id===Number(oe))?u(Number(oe)):V.length>0&&u(V[0].id)}catch(V){console.error("Failed to load projects:",V),te.error("   ")}},qe=async()=>{try{d.length===0&&b(!0);const oe=(await xs.getSpaces(m||void 0)).map(De=>({...De,items:De.items.map(Be=>({...Be,images:Be.images||[]}))}));h(oe)}catch(V){console.error("Failed to load spaces:",V),te.error("   ")}finally{b(!1)}},Le=async V=>{if(Xt.has(Number(V)))return null;try{Q(Be=>new Set(Be).add(Number(V)));const oe=await xs.getImageData(V),De=(oe==null?void 0:oe.image_data)||null;return h(Be=>Be.map(ue=>({...ue,items:ue.items.map(Lt=>({...Lt,images:Lt.images.map(yt=>String(yt.id)===String(V)?{...yt,image_data:De}:yt)}))}))),De}catch(oe){return console.error("   :",oe),null}finally{Q(oe=>{const De=new Set(oe);return De.delete(Number(V)),De})}},$e=async V=>{const oe=d.find(ue=>ue.items.some(Lt=>Lt.id===V)),De=oe==null?void 0:oe.items.find(ue=>ue.id===V);if(!De)return;const Be=De.images.filter(ue=>!ue.image_data);await Promise.all(Be.map(ue=>Le(ue.id)))},gt=async()=>{if(!ot){if(!C.trim()){te.error("  ");return}if(!m){te.error(" ");return}Nt(!0);try{const V=await xs.createSpace(C.trim(),m),oe={...V,items:V.items||[]};h([...d,oe]),v(""),Ct(!1),te.success(" ")}catch(V){console.error("Failed to add space:",V),te.error("  ")}finally{Nt(!1)}}},Ot=async(V,oe)=>{if(!oe.trim()){te.error("  ");return}try{await xs.updateSpace(V,oe.trim()),h(d.map(De=>String(De.id)===String(V)?{...De,name:oe.trim()}:De)),ee(null),A(""),te.success("  ")}catch(De){console.error("Failed to update space:",De),te.error("  ")}},ct=V=>{Me(V),Ie(new Set)},T=async()=>{if(ae!==null){if(fe.size===0){te.error("  ");return}try{await Promise.all(Array.from(fe).map(V=>xs.deleteItem(V))),h(d.map(V=>String(V.id)===String(ae)?{...V,items:V.items.filter(oe=>!fe.has(oe.id))}:V)),te.success(`${fe.size}  `),Me(null),Ie(new Set)}catch(V){console.error("Failed to delete items:",V),te.error("  ")}}},$=async()=>{if(ae===null)return;const V=d.find(oe=>String(oe.id)===String(ae));if(V&&confirm(`"${V.name}"  ?

        .`))try{await xs.deleteSpace(ae),h(d.filter(oe=>String(oe.id)!==String(ae))),te.success(" "),Me(null),Ie(new Set)}catch(oe){console.error("Failed to delete space:",oe),te.error("  ")}},X=async V=>{if(!S.trim()){te.error("  ");return}const oe=-Date.now(),De={id:oe,space_id:V,content:S.trim(),is_checked:!1,is_priority:!1,images:[]};h(d.map(ue=>String(ue.id)===String(V)?{...ue,items:[...ue.items,De]}:ue));const Be=S.trim();B(""),W(null);try{const ue=await xs.createItem(V,Be);h(Lt=>Lt.map(yt=>String(yt.id)===String(V)?{...yt,items:yt.items.map(zt=>zt.id===oe?{...ue,images:[]}:zt)}:yt))}catch(ue){console.error("Failed to add item:",ue),h(Lt=>Lt.map(yt=>String(yt.id)===String(V)?{...yt,items:yt.items.filter(zt=>zt.id!==oe)}:yt)),te.error("  ")}},ye=async V=>{try{const oe=await xs.toggleItem(V);h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,...oe}:Be)})))}catch(oe){console.error("Failed to toggle item:",oe),te.error("   ")}},le=async V=>{try{const oe=await xs.togglePriority(V);h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,is_priority:oe.is_priority}:Be)})))}catch(oe){console.error("Failed to toggle priority:",oe),te.error("  ")}},de=V=>new Promise((oe,De)=>{const Be=new FileReader;Be.readAsDataURL(V),Be.onload=()=>oe(Be.result),Be.onerror=ue=>De(ue)}),Ee=async(V,oe)=>{var ue,Lt;if(!["image/jpeg","image/png","image/webp"].includes(oe.type)){te.error("JPEG, PNG, WebP    ");return}const Be=5*1024*1024;if(oe.size>Be){te.error("  5MB  ");return}try{Ue(dt=>new Set([...dt,Number(V)]));const yt=await de(oe),zt=await xs.uploadImage(V,yt,oe.name);h(d.map(dt=>({...dt,items:dt.items.map(Jt=>String(Jt.id)===String(V)?{...Jt,images:[...Jt.images,zt]}:Jt)}))),te.success(" ")}catch(yt){console.error("Failed to upload image:",yt),te.error(((Lt=(ue=yt.response)==null?void 0:ue.data)==null?void 0:Lt.error)||"  ")}finally{Ue(yt=>{const zt=new Set(yt);return zt.delete(Number(V)),zt})}},Ke=async(V,oe)=>{const De=oe.target.files;if(!(!De||De.length===0)){for(let Be=0;Be<De.length;Be++)await Ee(V,De[Be]);ge.current&&(ge.current.value="")}},Ze=async(V,oe)=>{if(confirm("  ?"))try{await xs.deleteImage(oe),h(d.map(De=>({...De,items:De.items.map(Be=>String(Be.id)===String(V)?{...Be,images:Be.images.filter(ue=>String(ue.id)!==String(oe))}:Be)}))),te.success(" ")}catch(De){console.error("Failed to delete image:",De),te.error("  ")}},Ne=async(V,oe)=>{V.preventDefault(),V.stopPropagation();const De=V.dataTransfer.files;if(!(!De||De.length===0))for(let Be=0;Be<De.length;Be++)De[Be].type.startsWith("image/")&&await Ee(oe,De[Be])},fn=V=>{V.preventDefault(),V.stopPropagation()};if(p)return o.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Pt=P?d.flatMap(V=>V.items).find(V=>V.id===P):null;return o.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[o.jsxDEV("input",{ref:ge,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:V=>{P&&Ke(P,V)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),o.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Se?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("div",{className:"flex-1",children:o.jsxDEV("select",{value:m||"",onChange:V=>{const oe=V.target.value?Number(V.target.value):null;u(oe)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(V=>o.jsxDEV("option",{value:V.id,children:V.title},V.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>Ct(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:o.jsxDEV(Hi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),o.jsxDEV("select",{value:m||"",onChange:V=>{const oe=V.target.value?Number(V.target.value):null;u(oe)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(V=>o.jsxDEV("option",{value:V.id,children:V.title},V.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:C,onChange:V=>v(V.target.value),onKeyPress:V=>{V.key==="Enter"&&gt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),o.jsxDEV("button",{onClick:gt,disabled:ot,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:o.jsxDEV(Hi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-end",children:o.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):o.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((V,oe)=>{const De=V.items.filter(ue=>!ue.is_completed).sort((ue,Lt)=>(Lt.is_priority||0)-(ue.is_priority||0)),Be=V.items.filter(ue=>ue.is_completed);return ze&&De.length===0?null:o.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[ie===V.id?o.jsxDEV("div",{className:"flex gap-2 mb-4",children:[o.jsxDEV("input",{type:"text",value:F,onChange:ue=>A(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?Ot(V.id,F):ue.key==="Escape"&&(ee(null),A(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>Ot(V.id,F),className:"p-1 text-green-600 hover:text-green-700",children:o.jsxDEV(lp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{ee(null),A("")},className:"p-1 text-gray-600 hover:text-gray-700",children:o.jsxDEV(Nn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[o.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:oe+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),V.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:[Be.length,"/",V.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:()=>{L===V.id?(W(null),B("")):W(V.id)},className:`p-1 transition-colors ${L===V.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:o.jsxDEV(Hi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{ee(V.id),A(V.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>ct(V.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:o.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),L===V.id&&o.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:S,onChange:ue=>B(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&S.trim()&&X(V.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>X(V.id),disabled:!S.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),De.length>0&&o.jsxDEV("div",{className:"mb-4",children:o.jsxDEV("div",{className:"space-y-2",children:De.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[o.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ye(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Se&&P===ue.id?"font-semibold":""}`,onClick:async()=>{Se||(D(ue.id),ue.images&&ue.images.length>0&&await $e(ue.id))},style:{cursor:Se?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{D(ue.id),Se&&Ht(!0),ue.images&&ue.images.length>0&&await $e(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Eo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>le(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Yu,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!ze&&Be.length>0&&o.jsxDEV("div",{children:o.jsxDEV("div",{className:"space-y-2",children:Be.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[o.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ye(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Se&&P===ue.id?"font-semibold":""}`,onClick:async()=>{Se||(D(ue.id),ue.images&&ue.images.length>0&&await $e(ue.id))},style:{cursor:Se?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{D(ue.id),Se&&Ht(!0),ue.images&&ue.images.length>0&&await $e(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Eo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>le(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Yu,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!Se&&P&&Pt&&o.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>D(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:o.jsxDEV(Nn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Pt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{var V;return(V=ge.current)==null?void 0:V.click()},disabled:Ae.has(P),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsxDEV(Lc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),Ae.has(P)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:V=>Ne(V,P),onDragOver:fn,children:Pt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[o.jsxDEV(Eo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),o.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Pt.images.map(V=>o.jsxDEV("div",{className:"relative group",children:[V.image_data?o.jsxDEV("img",{src:V.image_data,alt:V.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):o.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>Ze(P,V.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:o.jsxDEV(Gu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),V.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:V.filename,children:V.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),Se&&Ut&&P&&Pt&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ht(!1),D(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(Nn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Pt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{var V;return(V=ge.current)==null?void 0:V.click()},disabled:Ae.has(P),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[o.jsxDEV(Lc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),Ae.has(P)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Pt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[o.jsxDEV(Eo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Pt.images.map(V=>o.jsxDEV("div",{className:"relative",children:[V.image_data?o.jsxDEV("img",{src:V.image_data,alt:V.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):o.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>Ze(P,V.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:o.jsxDEV(Gu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),V.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:V.filename,children:V.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(st=d.find(V=>V.id===ae))==null?void 0:st.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Me(null),Ie(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(Nn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-2",children:(sn=d.find(V=>V.id===ae))==null?void 0:sn.items.map(V=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const oe=new Set(fe);oe.has(V.id)?oe.delete(V.id):oe.add(V.id),Ie(oe)},children:[o.jsxDEV("input",{type:"checkbox",checked:fe.has(V.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),o.jsxDEV("span",{className:`flex-1 text-sm ${V.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:V.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},V.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:T,disabled:fe.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",fe.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),o.jsxDEV("button",{onClick:$,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{Me(null),Ie(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),nt&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ct(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(Nn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4",children:[o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:C,onChange:V=>v(V.target.value),onKeyPress:V=>{V.key==="Enter"&&C.trim()&&gt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{Ct(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),o.jsxDEV("button",{onClick:gt,disabled:!C.trim()||ot,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:ot?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function GC(){const[t,e]=k.useState([]),[n,s]=k.useState(!1),[r,i]=k.useState(null),[a,c]=k.useState(!1),[m,u]=k.useState(null),[d,h]=k.useState(""),[p,b]=k.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[C,v]=k.useState(!1);k.useEffect(()=>{S()},[]),k.useEffect(()=>{const x=()=>{B()};return window.addEventListener("headerAddButtonClick",x),()=>window.removeEventListener("headerAddButtonClick",x)},[]);const S=async()=>{var x,E;try{t.length===0&&s(!0),i(null);const j=await Ys.getAllContractors();e(j.map(I=>({id:I._id,rank:I.rank,companyName:I.companyName,name:I.name,position:I.position,process:I.process,contact:I.contact,accountNumber:I.accountNumber,notes:I.notes,createdAt:new Date(I.createdAt),updatedAt:new Date(I.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const I=j instanceof Error&&((E=(x=j.response)==null?void 0:x.data)==null?void 0:E.message);i(I||"   .")}finally{s(!1)}},B=x=>{if(x){u(x);let E="",j=x.accountNumber||"";if(x.accountNumber){const D=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const Ae of D)if(x.accountNumber.startsWith(Ae)){E=Ae,j=x.accountNumber.substring(Ae.length).trim();break}}let I=x.name,P=x.position||"";P||(P=Ra(x.name),I=Mo(x.name)),b({rank:x.rank||"",companyName:x.companyName||"",name:I,position:P,process:x.process,contact:x.contact||"",bankName:E,accountNumber:j,notes:x.notes||""})}else u(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});c(!0)},L=()=>{c(!1),u(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},W=async x=>{var j,I;if(x.preventDefault(),C)return;v(!0);const E=p.bankName&&p.accountNumber?`${p.bankName} ${p.accountNumber}`:p.accountNumber;try{const P={rank:p.rank,companyName:p.companyName,name:p.name,position:p.position,process:p.process,contact:p.contact,accountNumber:E,notes:p.notes};m?await Ys.updateContractor(m.id,P):await Ys.createContractor(P),await S(),L()}catch(P){console.error("Failed to save contractor:",P);const D=P instanceof Error&&((I=(j=P.response)==null?void 0:j.data)==null?void 0:I.message);alert(D||"  .")}finally{v(!1)}},ie=async x=>{var E,j;if(window.confirm("   ?"))try{await Ys.deleteContractor(x),await S()}catch(I){console.error("Failed to delete contractor:",I);const P=I instanceof Error&&((j=(E=I.response)==null?void 0:E.data)==null?void 0:j.message);alert(P||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",F=x=>x?x==="1"?1:x==="1()"?2:x==="2"?3:x==="2()"?4:x==="3"?5:x==="3()"?6:x===""?100:x===""?200:999:999,A=t.filter(x=>x.name.toLowerCase().includes(d.toLowerCase())||x.process.toLowerCase().includes(d.toLowerCase())||x.accountNumber.toLowerCase().includes(d.toLowerCase())||x.contact&&x.contact.toLowerCase().includes(d.toLowerCase())||x.rank&&x.rank.toLowerCase().includes(d.toLowerCase())||x.companyName&&x.companyName.toLowerCase().includes(d.toLowerCase())).sort((x,E)=>{const j=F(x.rank)-F(E.rank);if(j!==0)return j;const I=x.process.localeCompare(E.process,"ko");return I!==0?I:x.name.localeCompare(E.name,"ko")});return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end",children:o.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV(mp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),o.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:x=>h(x.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),o.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsxDEV("div",{className:"overflow-x-auto",children:o.jsxDEV("table",{className:"w-full",children:[o.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:n?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),o.jsxDEV("button",{onClick:S,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):A.length===0?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):A.map(x=>o.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(x.rank)}`,children:x.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"font-medium text-gray-900",children:Mo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.position||Ra(x.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsxDEV("button",{onClick:()=>B(x),className:"text-gray-600 hover:text-gray-900 mr-3",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),o.jsxDEV("button",{onClick:()=>ie(x.id),className:"text-red-600 hover:text-red-900",children:o.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),o.jsxDEV("div",{className:"md:hidden space-y-3",children:n?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?o.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[o.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),o.jsxDEV("button",{onClick:S,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):A.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):A.map(x=>o.jsxDEV("div",{className:"card p-3 space-y-2",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[x.rank&&o.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(x.rank)}`,children:x.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),x.companyName&&o.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:x.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),o.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Mo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),o.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[o.jsxDEV("button",{onClick:()=>B(x),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),o.jsxDEV("button",{onClick:()=>ie(x.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:o.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),o.jsxDEV("div",{className:"space-y-1 text-xs",children:[(x.position||Ra(x.name))&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:x.position||Ra(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),x.contact&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:x.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),o.jsxDEV("span",{className:"text-gray-900 break-all",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),x.notes&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-600",children:x.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),a&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:o.jsxDEV("div",{className:"p-6",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:m?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),o.jsxDEV("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:o.jsxDEV(Nn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),o.jsxDEV("form",{onSubmit:W,className:"space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),o.jsxDEV("select",{value:p.rank,onChange:x=>b({...p,rank:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),o.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),o.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),o.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.companyName,onChange:x=>b({...p,companyName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:p.name,onChange:x=>b({...p,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.position,onChange:x=>b({...p,position:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:p.process,onChange:x=>b({...p,process:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.contact,onChange:x=>b({...p,contact:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),o.jsxDEV("select",{value:p.bankName,onChange:x=>b({...p,bankName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),o.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:p.accountNumber,onChange:x=>b({...p,accountNumber:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),o.jsxDEV("textarea",{value:p.notes,onChange:x=>b({...p,notes:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),o.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[o.jsxDEV("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),o.jsxDEV("button",{type:"submit",disabled:C,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:C?" ...":m?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const XC=()=>{const[t,e]=k.useState([]),[n,s]=k.useState(null),[r,i]=k.useState(!1),a=k.useRef(null);k.useEffect(()=>(a.current=Xa.subscribeToQuoteInquiries(h=>{e(h),i(!1)}),i(!0),()=>{a.current&&a.current()}),[]);const c=async h=>{try{await Xa.markAsRead(h),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(p){console.error("Failed to mark as read:",p)}},m=h=>{s(h),h.isRead||c(h.id)},u=async(h,p)=>{if(p.stopPropagation(),!!confirm("  ?"))try{await Xa.deleteQuoteInquiry(h),(n==null?void 0:n.id)===h&&s(null),te.success(" ")}catch(b){console.error("Failed to delete inquiry:",b),te.error("  ")}},d=t.filter(h=>!h.isRead).length;return r?o.jsxDEV("div",{className:"flex items-center justify-center h-full",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):o.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[o.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${n?"hidden md:flex":"flex"}`,children:[o.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&o.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:t.length===0?o.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y",children:t.map(h=>o.jsxDEV("div",{className:`relative group ${(n==null?void 0:n.id)===h.id?"bg-blue-50 border-l-4 border-blue-500":""} ${h.isRead?"":"bg-yellow-50"}`,children:o.jsxDEV("button",{onClick:()=>m(h),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"font-medium text-gray-900",children:h.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!h.isRead&&o.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"text-xs text-gray-500",children:Mt(new Date(h.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),o.jsxDEV("button",{onClick:p=>u(h.id,p),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(ni,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[o.jsxDEV(Xu,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),h.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),o.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${n?"flex flex-col":"hidden md:flex md:flex-col"}`,children:n?o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500",children:Mt(new Date(n.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(Lb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Xu,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),o.jsxDEV("span",{children:n.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Tb,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),o.jsxDEV("span",{children:n.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),n.address&&o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(jb,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),o.jsxDEV("span",{children:n.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(n.projectType||n.budget)&&o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(Rb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[n.projectType&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),n.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),n.budget&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),n.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:n.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):o.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},JC=()=>{const{login:t}=Br(),[e,n]=k.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:a}}=ku(),c=async u=>{n(!0);try{await t(u.username,u.password)}finally{n(!1)}},m=u=>{i("username",u)};return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsxDEV("div",{className:"max-w-md w-full",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[o.jsxDEV("div",{className:"text-center mb-8",children:[o.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),o.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),o.jsxDEV("form",{onSubmit:r(c),className:"space-y-6",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),o.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),a.username&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),o.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),a.password&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?o.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV(Bb,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),o.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(u=>o.jsxDEV("button",{onClick:()=>m(u),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},ZC=k.lazy(()=>$s(()=>import("./Drawings-DwsPuwcG.js"),__vite__mapDeps([0,1,2,3,4,5]))),e1=k.lazy(()=>$s(()=>import("./SiteLog-C155bt_A.js"),__vite__mapDeps([6,1,4,2,3,5]))),t1=k.lazy(()=>$s(()=>import("./AfterService-D0Tj0DIC.js"),__vite__mapDeps([7,1,2,4,3,5]))),n1=k.lazy(()=>$s(()=>import("./AdditionalWork-bh7tr_w7.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),s1=k.lazy(()=>$s(()=>import("./ConstructionPayment-CSsuV3aI.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),r1=k.lazy(()=>$s(()=>import("./WorkRequest-Cu8eJYud.js"),__vite__mapDeps([11,1,2,4,3,5]))),i1=k.lazy(()=>$s(()=>import("./Specbook-BF5osAiO.js"),__vite__mapDeps([12,1,2,3,4,5]))),o1=k.lazy(()=>$s(()=>import("./EstimatePreview-Cegu7oxY.js"),__vite__mapDeps([13,1,2,3,4,5]))),a1=k.lazy(()=>$s(()=>import("./ExecutionHistory-D_LA_JKA.js"),__vite__mapDeps([14,1,4,2,3,5]))),l1=()=>o.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:35,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:34,columnNumber:3},void 0),c1=new Db({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function m1(){const[t,e]=k.useState(!1);return k.useEffect(()=>{const n=$N({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),te.loading("   ...",{duration:2e3}),setTimeout(()=>{n(!0).then(()=>{te.dismiss(),te.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(i,a){console.log(" Service Worker :",i),a&&setInterval(()=>{console.log("   ..."),a.update()},6e4)},onRegisterError(i){console.error(" Service Worker  :",i)}});OA();const s=async()=>{try{const a=await(await fetch("/version.json?t="+Date.now())).json(),c=localStorage.getItem("app_version");c&&c!==a.version?(console.log("   :",a.version),localStorage.setItem("app_version",a.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):c||localStorage.setItem("app_version",a.version)}catch(i){console.error("  :",i)}};setTimeout(s,5e3);const r=setInterval(s,3e4);return console.log(" Firestore   "),()=>{clearInterval(r)}},[]),o.jsxDEV(kb,{client:c1,children:o.jsxDEV(xb,{children:o.jsxDEV(tA,{children:[o.jsxDEV(k.Suspense,{fallback:o.jsxDEV(l1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:31},this),children:o.jsxDEV(vb,{children:[o.jsxDEV(Vn,{path:"/login",element:o.jsxDEV(JC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:15},this),o.jsxDEV(Vn,{path:"/",element:o.jsxDEV(FA,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:40},this),children:[o.jsxDEV(Vn,{index:!0,element:o.jsxDEV(ap,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:17},this),o.jsxDEV(Vn,{path:"dashboard",element:o.jsxDEV(yE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:17},this),o.jsxDEV(Vn,{path:"projects",element:o.jsxDEV(kE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:17},this),o.jsxDEV(Vn,{path:"schedule",element:o.jsxDEV(MC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:17},this),o.jsxDEV(Vn,{path:"drawings",element:o.jsxDEV(ZC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:17},this),o.jsxDEV(Vn,{path:"site-log",element:o.jsxDEV(e1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:17},this),o.jsxDEV(Vn,{path:"after-service",element:o.jsxDEV(t1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:17},this),o.jsxDEV(Vn,{path:"additional-work",element:o.jsxDEV(n1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:17},this),o.jsxDEV(Vn,{path:"construction-payment",element:o.jsxDEV(s1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:17},this),o.jsxDEV(Vn,{path:"contractors",element:o.jsxDEV(GC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:17},this),o.jsxDEV(Vn,{path:"work-request",element:o.jsxDEV(r1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:17},this),o.jsxDEV(Vn,{path:"finish-check",element:o.jsxDEV(YC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:17},this),o.jsxDEV(Vn,{path:"specbook",element:o.jsxDEV(i1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:17},this),o.jsxDEV(Vn,{path:"estimate-preview",element:o.jsxDEV(o1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:17},this),o.jsxDEV(Vn,{path:"execution-history",element:o.jsxDEV(a1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:17},this),o.jsxDEV(Vn,{path:"payments",element:o.jsxDEV(QC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:17},this),o.jsxDEV(Vn,{path:"quote-inquiry",element:o.jsxDEV(XC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:138,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:11},this),o.jsxDEV(qN,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:161,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:136,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:135,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:134,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(t){for(const e of t)e.update()});Ep(document.getElementById("root")).render(o.jsxDEV(k.StrictMode,{children:o.jsxDEV(m1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{ku as A,bn as B,dm as C,BA as D,Ec as E,eA as F,y1 as G,jt as H,WC as I,gs as J,KC as K,$C as L,wc as P,be as T,ne as a,Hn as b,rn as c,Ce as d,yl as e,cm as f,It as g,Br as h,Kl as i,o as j,Fe as k,ds as l,Vt as m,Zg as n,an as o,Qi as p,xt as q,gl as r,ii as s,bl as t,lm as u,Rt as v,Rn as w,Os as x,Ir as y,te as z};
