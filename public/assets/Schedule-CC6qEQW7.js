import{j as d}from"./vendor-data-DG_4MGb7.js";import{i as ft,r as w,R as z}from"./vendor-react-D-r2Cqeg.js";import{c as na,p as cn,l as Ot,s as ge,i as sa,h as aa,q as dr,a as ur,m as fr,b as oa,d as Lt,o as Nt,e as ia,f as Mt,r as pr,g as gr,j as mr,k as hr,n as vr,t as dn,u as un,v as fn,w as pn,x as gn,y as mn,z as hn,A as vn,B as xn,C as yn,D as bn,E as Dn,F as la,G as ca,H as da,I as ua,J as fa,K as pa,L as ga}from"./vendor-calendar-Czm3kpbI.js";import{t as P}from"./vendor-date-9Cl9d1sr.js";import{S as ma}from"./ScheduleModal-BLEwiDq-.js";import{u as ha,z as L}from"./index-Dgd7wCS1.js";import{u as va}from"./dataStore-D-kob-RA.js";import{u as xa}from"./useFilteredProjects-BNZe-7y5.js";import{f as ya}from"./formatters-15aXprTM.js";import{P as ba}from"./index-CSlX1tQB.js";import"./index.esm-D9ojv-r8.js";import"./vendor-ui-DTwhhNuH.js";var xr={},_n={exports:{}};(function(e){function s(t){return t&&t.__esModule?t:{default:t}}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(_n);var ee=_n.exports,yr={},wn={exports:{}},jn={exports:{}},En={exports:{}},Sn={exports:{}};(function(e){function s(t){"@babel/helpers - typeof";return e.exports=s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Sn);var Je=Sn.exports,Tn={exports:{}};(function(e){var s=Je.default;function t(n,a){if(s(n)!="object"||!n)return n;var o=n[Symbol.toPrimitive];if(o!==void 0){var i=o.call(n,a||"default");if(s(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Tn);var Da=Tn.exports;(function(e){var s=Je.default,t=Da;function n(a){var o=t(a,"string");return s(o)=="symbol"?o:o+""}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(En);var Cn=En.exports;(function(e){var s=Cn;function t(n,a,o){return(a=s(a))in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o,n}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(jn);var kn=jn.exports;(function(e){var s=kn;function t(a,o){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);o&&(u=u.filter(function(c){return Object.getOwnPropertyDescriptor(a,c).enumerable})),i.push.apply(i,u)}return i}function n(a){for(var o=1;o<arguments.length;o++){var i=arguments[o]!=null?arguments[o]:{};o%2?t(Object(i),!0).forEach(function(u){s(a,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(u){Object.defineProperty(a,u,Object.getOwnPropertyDescriptor(i,u))})}return a}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(wn);var Pe=wn.exports,Pn={exports:{}},An={exports:{}};(function(e){function s(t,n){if(t==null)return{};var a={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(n.indexOf(o)!==-1)continue;a[o]=t[o]}return a}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(An);var _a=An.exports;(function(e){var s=_a;function t(n,a){if(n==null)return{};var o,i,u=s(n,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(i=0;i<c.length;i++)o=c[i],a.indexOf(o)===-1&&{}.propertyIsEnumerable.call(n,o)&&(u[o]=n[o])}return u}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Pn);var br=Pn.exports,Nn={exports:{}};(function(e){function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Nn);var Ye=Nn.exports,Mn={exports:{}};(function(e){var s=Cn;function t(a,o){for(var i=0;i<o.length;i++){var u=o[i];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,s(u.key),u)}}function n(a,o,i){return o&&t(a.prototype,o),i&&t(a,i),Object.defineProperty(a,"prototype",{writable:!1}),a}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Mn);var He=Mn.exports,On={exports:{}},Ln={exports:{}};(function(e){function s(t){return e.exports=s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Ln);var wa=Ln.exports,Fn={exports:{}};(function(e){function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(e.exports=s=function(){return!!t},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Fn);var ja=Fn.exports,$n={exports:{}},In={exports:{}};(function(e){function s(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(In);var Ea=In.exports;(function(e){var s=Je.default,t=Ea;function n(a,o){if(o&&(s(o)=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})($n);var Sa=$n.exports;(function(e){var s=wa,t=ja,n=Sa;function a(o,i,u){return i=s(i),n(o,t()?Reflect.construct(i,u||[],s(o).constructor):i.apply(o,u))}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(On);var Qe=On.exports,Rn={exports:{}},Wn={exports:{}};(function(e){function s(t,n){return e.exports=s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,o){return a.__proto__=o,a},e.exports.__esModule=!0,e.exports.default=e.exports,s(t,n)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Wn);var Ta=Wn.exports;(function(e){var s=Ta;function t(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),a&&s(n,a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Rn);var et=Rn.exports;const pt=ft(na);var me={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.views=Ze.navigate=void 0;Ze.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Ze.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var Ca=ee.default;Object.defineProperty(me,"__esModule",{value:!0});me.views=me.dateRangeFormat=me.dateFormat=me.accessor=me.DayLayoutAlgorithmPropType=void 0;var ne=Ca(cn),Kr=Ze,Ur=Object.keys(Kr.views).map(function(e){return Kr.views[e]});me.accessor=ne.default.oneOfType([ne.default.string,ne.default.func]);me.dateFormat=ne.default.any;me.dateRangeFormat=ne.default.func;me.views=ne.default.oneOfType([ne.default.arrayOf(ne.default.oneOf(Ur)),ne.default.objectOf(function(e,s){var t=Ur.indexOf(s)!==-1&&typeof e[s]=="boolean";if(t)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),o=2;o<n;o++)a[o-2]=arguments[o];return ne.default.elementType.apply(ne.default,[e,s].concat(a))})]);me.DayLayoutAlgorithmPropType=ne.default.oneOfType([ne.default.oneOf(["overlap","no-overlap"]),ne.default.func]);var Ft={},tt={},ka=ee.default;Object.defineProperty(tt,"__esModule",{value:!0});tt.accessor=zn;tt.wrapAccessor=void 0;var Pa=ka(Je);function zn(e,s){var t=null;return typeof s=="function"?t=s(e):typeof s=="string"&&(0,Pa.default)(e)==="object"&&e!=null&&s in e&&(t=e[s]),t}tt.wrapAccessor=function(s){return function(t){return zn(t,s)}};var Be={},Aa=ee.default;Object.defineProperty(Be,"__esModule",{value:!0});Be.DnDContext=void 0;var Na=Aa(w);Be.DnDContext=Na.default.createContext();var qe=ee.default;Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=void 0;var Ma=qe(Pe),Oa=qe(Ye),La=qe(He),Fa=qe(Qe),$a=qe(et),Xe=qe(w),Xr=qe(pt),Gr=tt,Ia=Be,Yn=function(e){function s(){var t;(0,Oa.default)(this,s);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=(0,Fa.default)(this,s,[].concat(a)),t.handleResizeUp=function(i){i.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(i){i.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(i){i.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(i){i.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(i){var u;if(i.button===0){var c=(u=i.target.getAttribute("class"))===null||u===void 0?void 0:u.includes("rbc-addons-dnd-resize");if(!c){var m=(0,Ma.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,$a.default)(s,e),(0,La.default)(s,[{key:"renderAnchor",value:function(n){var a=n==="Up"||n==="Down"?"ns":"ew";return Xe.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(a,"-anchor"),onMouseDown:this["handleResize".concat(n)]},Xe.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(a,"-icon")}))}},{key:"render",value:function(){var n=this.props,a=n.event,o=n.type,i=n.continuesPrior,u=n.continuesAfter,c=n.resizable,m=this.props.children;if(a.__isPreview)return Xe.default.cloneElement(m,{className:(0,Xr.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var h=this.context.draggable,v=h.draggableAccessor,x=h.resizableAccessor,g=v?!!(0,Gr.accessor)(a,v):!0;if(!g)return m;var _=c&&(x?!!(0,Gr.accessor)(a,x):!0);if(_||g){var j={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(_){var A=null,M=null;o==="date"?(A=!i&&this.renderAnchor("Left"),M=!u&&this.renderAnchor("Right")):(A=!i&&this.renderAnchor("Up"),M=!u&&this.renderAnchor("Down")),j.children=Xe.default.createElement("div",{className:"rbc-addons-dnd-resizable"},A,m.props.children,M)}h.dragAndDropAction.interacting&&h.dragAndDropAction.event===a&&(j.className=(0,Xr.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=Xe.default.cloneElement(m,j)}return m}}])}(Xe.default.Component);Yn.contextType=Ia.DnDContext;Ft.default=Yn;var $t={},Hn={exports:{}};(function(e){var s=Je.default;function t(n,a){if(typeof WeakMap=="function")var o=new WeakMap,i=new WeakMap;return(e.exports=t=function(c,m){if(!m&&c&&c.__esModule)return c;var h,v,x={__proto__:null,default:c};if(c===null||s(c)!="object"&&typeof c!="function")return x;if(h=m?i:o){if(h.has(c))return h.get(c);h.set(c,x)}for(var g in c)g!=="default"&&{}.hasOwnProperty.call(c,g)&&((v=(h=Object.defineProperty)&&Object.getOwnPropertyDescriptor(c,g))&&(v.get||v.set)?h(x,g,v):x[g]=c[g]);return x},e.exports.__esModule=!0,e.exports.default=e.exports)(n,a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Hn);var Bn=Hn.exports;function Dr(e,s,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!0),e){var a=document.createEvent("HTMLEvents");a.initEvent(s,t,n),e.dispatchEvent(a)}}function Ra(e){var s=ge(e,"transitionDuration")||"",t=s.indexOf("ms")===-1?1e3:1;return parseFloat(s)*t}function Wa(e,s,t){t===void 0&&(t=5);var n=!1,a=setTimeout(function(){n||Dr(e,"transitionend",!0)},s+t),o=Ot(e,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(a),o()}}function _r(e,s,t,n){t==null&&(t=Ra(e)||0);var a=Wa(e,t,n),o=Ot(e,"transitionend",s);return function(){a(),o()}}var Zr={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Jr(e){var s=e.node,t=e.properties,n=e.duration,a=n===void 0?200:n,o=e.easing,i=e.callback,u=[],c={},m="";Object.keys(t).forEach(function(x){var g=t[x];sa(x)?m+=x+"("+g+") ":(c[x]=g,u.push(aa(x)))}),m&&(c.transform=m,u.push("transform"));function h(x){x.target===x.currentTarget&&(ge(s,Zr),i&&i.call(this,x))}a>0&&(c.transition=u.join(", "),c["transition-duration"]=a/1e3+"s",c["transition-delay"]="0s",c["transition-timing-function"]=o||"linear");var v=_r(s,h,a);return s.clientLeft,ge(s,c),{cancel:function(){v(),ge(s,Zr)}}}function qn(e,s,t,n,a){if(!("nodeType"in e))return Jr(e);if(!s)throw new Error("must include properties to animate");return typeof n=="function"&&(a=n,n=""),Jr({node:e,properties:s,duration:t,easing:n,callback:a})}function Vn(e,s,t){if(e){if(typeof t>"u")return e.getAttribute(s);!t&&t!==""?e.removeAttribute(s):e.setAttribute(s,String(t))}}function Kn(e){return e?Array.from(e.children):[]}function Un(e){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}return null}var za=Function.prototype.bind.call(Function.prototype.call,[].slice);function Xn(e){return e?za(e.childNodes):[]}function Gn(e,s){return function(n){var a=n.currentTarget,o=n.target,i=dr(a,e);i.some(function(u){return ur(u,o)})&&s.call(this,n)}}function Zn(e,s){return e&&s&&s.parentNode?(s.nextSibling?s.parentNode.insertBefore(e,s.nextSibling):s.parentNode.appendChild(e),e):null}var Ya=/^(?:input|select|textarea|button)$/i;function Jn(e){return e?Ya.test(e.nodeName):!1}function Qn(e){return e?!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length):!1}function es(e,s,t){s===void 0&&(s=null),t===void 0&&(t=null);for(var n=[];e;e=e.nextElementSibling)if(e!==s){if(t&&fr(e,t))break;n.push(e)}return n}function ts(e,s){return es(e,e,s)}function Ha(e,s){var t=null,n=[];for(t=e?e[s]:null;t&&t.nodeType!==9;)n.push(t),t=t[s]||null;return n}function rs(e){return Ha(e,"parentElement")}function ns(e,s){return e&&s?(s.firstElementChild?s.insertBefore(e,s.firstElementChild):s.appendChild(e),e):null}function ss(e){return e&&e.parentNode?(e.parentNode.removeChild(e),e):null}function wr(e,s){var t=ge(e,"position"),n=t==="absolute",a=e.ownerDocument;if(t==="fixed")return a||document;for(;(e=e.parentNode)&&!oa(e);){var o=n&&ge(e,"position")==="static",i=(ge(e,"overflow")||"")+(ge(e,"overflow-y")||"")+ge(e,"overflow-x");if(!o&&/(auto|scroll)/.test(i)&&(s||Lt(e)<e.scrollHeight))return e}return a||document}function as(e,s){var t=Nt(e),n={top:0,left:0};if(e){var a=s||wr(e),o=ia(a),i=Mt(a),u=Lt(a,!0);o||(n=Nt(a)),t={top:t.top-n.top,left:t.left-n.left,height:t.height,width:t.width};var c=t.height,m=t.top+(o?0:i),h=m+c;i=i>m?m:h>i+u?h-u:i;var v=pr(function(){return Mt(a,i)});return function(){return gr(v)}}}function os(e){return es(e&&e.parentElement?e.parentElement.firstElementChild:null,e)}var Ba=/&nbsp;/gi,qa=/\xA0/g,Va=/\s+([^\s])/gm;function is(e,s,t){s===void 0&&(s=!0),t===void 0&&(t=!0);var n="";return e&&(n=(e.textContent||"").replace(Ba," ").replace(qa," "),s&&(n=n.trim()),t&&(n=n.replace(Va," $1"))),n}function ls(e,s){e.classList?e.classList.toggle(s):mr(e,s)?hr(e,s):vr(e,s)}const Ka={addEventListener:Dn,removeEventListener:bn,triggerEvent:Dr,animate:qn,filter:Gn,listen:Ot,style:ge,getComputedStyle:yn,attribute:Vn,activeElement:xn,ownerDocument:vn,ownerWindow:hn,requestAnimationFrame:pr,cancelAnimationFrame:gr,matches:fr,height:Lt,width:mn,offset:Nt,offsetParent:gn,position:pn,contains:ur,scrollbarSize:fn,scrollLeft:un,scrollParent:wr,scrollTo:as,scrollTop:Mt,querySelectorAll:dr,closest:dn,addClass:vr,removeClass:hr,hasClass:mr,toggleClass:ls,transitionEnd:_r,childNodes:Xn,childElements:Kn,nextUntil:ts,parents:rs,siblings:os,clear:Un,insertAfter:Zn,isInput:Jn,isVisible:Qn,prepend:ns,remove:ss,text:is},Ua=Object.freeze(Object.defineProperty({__proto__:null,activeElement:xn,addClass:vr,addEventListener:Dn,animate:qn,attribute:Vn,cancelAnimationFrame:gr,childElements:Kn,childNodes:Xn,clear:Un,closest:dn,contains:ur,default:Ka,filter:Gn,getComputedStyle:yn,hasClass:mr,height:Lt,insertAfter:Zn,isInput:Jn,isVisible:Qn,listen:Ot,matches:fr,nextUntil:ts,offset:Nt,offsetParent:gn,ownerDocument:vn,ownerWindow:hn,parents:rs,position:pn,prepend:ns,querySelectorAll:dr,remove:ss,removeClass:hr,removeEventListener:bn,requestAnimationFrame:pr,scrollLeft:un,scrollParent:wr,scrollTo:as,scrollTop:Mt,scrollbarSize:fn,siblings:os,style:ge,text:is,toggleClass:ls,transitionEnd:_r,triggerEvent:Dr,width:mn},Symbol.toStringTag,{value:"Module"})),Xa=ft(Ua);var or={exports:{}};(function(e,s){s.__esModule=!0,s.default=n;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(a,o){return t(a.querySelectorAll(o))}e.exports=s.default})(or,or.exports);var Ga=or.exports,he={};const Za=ft(la),Ja=ft(ca),Qa=ft(da);var rt=ee.default;Object.defineProperty(he,"__esModule",{value:!0});he.default=void 0;he.getBoundsForNode=ut;he.getEventNodeFromPoint=ds;he.getShowMoreNodeFromPoint=us;he.isEvent=ao;he.isShowMore=oo;he.objectsCollide=lr;var eo=rt(Je),to=rt(Ye),ro=rt(He),ir=rt(Za),cs=rt(Ja),no=rt(Qa);function Q(e,s){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,no.default)(t,e,s,{passive:!1})}function so(e,s,t){return!e||(0,ir.default)(e,document.elementFromPoint(s,t))}function ds(e,s){var t=s.clientX,n=s.clientY,a=document.elementFromPoint(t,n);return(0,cs.default)(a,".rbc-event",e)}function us(e,s){var t=s.clientX,n=s.clientY,a=document.elementFromPoint(t,n);return(0,cs.default)(a,".rbc-show-more",e)}function ao(e,s){return!!ds(e,s)}function oo(e,s){return!!us(e,s)}function it(e){var s=e;return e.touches&&e.touches.length&&(s=e.touches[0]),{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY}}var Qr=5,io=250,lo=function(){function e(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.global,a=n===void 0?!1:n,o=t.longPressThreshold,i=o===void 0?250:o,u=t.validContainers,c=u===void 0?[]:u;(0,to.default)(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=s,this.globalMouse=!s||a,this.longPressThreshold=i,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Q("touchmove",function(){},window),this._removeKeyDownListener=Q("keydown",this._keyListener),this._removeKeyUpListener=Q("keyup",this._keyListener),this._removeDropFromOutsideListener=Q("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Q("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,ro.default)(e,[{key:"on",value:function(t,n){var a=this._listeners[t]||(this._listeners[t]=[]);return a.push(n),{remove:function(){var i=a.indexOf(n);i!==-1&&a.splice(i,1)}}}},{key:"emit",value:function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];var i,u=this._listeners[t]||[];return u.forEach(function(c){i===void 0&&(i=c.apply(void 0,a))}),i}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var n=this._selectRect;return!n||!this.selecting?!1:lr(n,ut(t))}},{key:"filter",value:function(t){var n=this._selectRect;return!n||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,n){var a=this,o=null,i=null,u=null,c=function(x){o=setTimeout(function(){h(),t(x)},a.longPressThreshold),i=Q("touchmove",function(){return h()}),u=Q("touchend",function(){return h()})},m=Q("touchstart",c),h=function(){o&&clearTimeout(o),i&&i(),u&&u(),o=null,i=null,u=null};return n&&c(n),function(){h(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,n=Q("mousedown",function(o){t._removeInitialEventListener(),t._handleInitialEvent(o),t._removeInitialEventListener=Q("mousedown",t._handleInitialEvent)}),a=Q("touchstart",function(o){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,o)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(t){var n=it(t),a=n.pageX,o=n.pageY,i=n.clientX,u=n.clientY;this.emit("dropFromOutside",{x:a,y:o,clientX:i,clientY:u}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var n=it(t),a=n.pageX,o=n.pageY,i=n.clientX,u=n.clientY;this.emit("dragOverFromOutside",{x:a,y:o,clientX:i,clientY:u}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var n=it(t),a=n.clientX,o=n.clientY,i=n.pageX,u=n.pageY,c=this.container(),m,h;if(!(t.which===3||t.button===2||!so(c,a,o))){if(!this.globalMouse&&c&&!(0,ir.default)(c,t.target)){var v=co(0),x=v.top,g=v.left,_=v.bottom,j=v.right;if(h=ut(c),m=lr({top:h.top-x,left:h.left-g,bottom:h.bottom+_,right:h.right+j},{top:u,left:i}),!m)return}var A=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:i,y:u,clientX:a,clientY:o});if(A!==!1)switch(t.type){case"mousedown":this._removeEndListener=Q("mouseup",this._handleTerminatingEvent),this._onEscListener=Q("keydown",this._handleTerminatingEvent),this._removeMoveListener=Q("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Q("touchend",this._handleTerminatingEvent),this._removeMoveListener=Q("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var n=t.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(o){return!!n.closest(o)})}},{key:"_handleTerminatingEvent",value:function(t){var n=this.selecting,a=this._selectRect;if(!n&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var o=!this.container||(0,ir.default)(this.container(),t.target),i=this._isWithinValidContainer(t);return t.key==="Escape"||!i?this.emit("reset"):!n&&o?this._handleClickEvent(t):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var n=it(t),a=n.pageX,o=n.pageY,i=n.clientX,u=n.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<io?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:o,clientX:i,clientY:u})):(this._lastClickData={timestamp:c},this.emit("click",{x:a,y:o,clientX:i,clientY:u}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,o=n.y,i=it(t),u=i.pageX,c=i.pageY,m=Math.abs(a-u),h=Math.abs(o-c),v=Math.min(u,a),x=Math.min(c,o),g=this.selecting,_=this.isClick(u,c);_&&!g&&!(m||h)||(!g&&!_&&this.emit("selectStart",this._initialEventData),_||(this.selecting=!0,this._selectRect={top:x,left:v,x:u,y:c,right:v+m,bottom:x+h},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,n){var a=this._initialEventData,o=a.x,i=a.y,u=a.isTouch;return!u&&Math.abs(t-o)<=Qr&&Math.abs(n-i)<=Qr}}])}();function co(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,eo.default)(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function lr(e,s){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=ut(e),a=n.top,o=n.left,i=n.right,u=i===void 0?o:i,c=n.bottom,m=c===void 0?a:c,h=ut(s),v=h.top,x=h.left,g=h.right,_=g===void 0?x:g,j=h.bottom,A=j===void 0?v:j;return!(m-t<v||a+t>A||u-t<x||o+t>_)}function ut(e){if(!e.getBoundingClientRect)return e;var s=e.getBoundingClientRect(),t=s.left+en("left"),n=s.top+en("top");return{top:n,left:t,right:(e.offsetWidth||0)+t,bottom:(e.offsetHeight||0)+n}}function en(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}he.default=lo;var It={},Rt=ee.default;Object.defineProperty(It,"__esModule",{value:!0});It.default=void 0;var uo=Rt(kn),tn=Rt(Pe),fo=Rt(pt),lt=Rt(w);function St(e){return typeof e=="string"?e:e+"%"}function po(e){var s=e.style,t=e.className,n=e.event,a=e.accessors,o=e.rtl,i=e.selected,u=e.label,c=e.continuesPrior,m=e.continuesAfter,h=e.getters,v=e.onClick,x=e.onDoubleClick,g=e.isBackgroundEvent,_=e.onKeyPress,j=e.components,A=j.event,M=j.eventWrapper,S=a.title(n),$=a.tooltip(n),B=a.end(n),V=a.start(n),U=h.eventProp(n,V,B,i),re=[lt.default.createElement("div",{key:"1",className:"rbc-event-label"},u),lt.default.createElement("div",{key:"2",className:"rbc-event-content"},A?lt.default.createElement(A,{event:n,title:S}):S)],se=s.height,fe=s.top,oe=s.width,K=s.xOffset,E=(0,tn.default)((0,tn.default)({},U.style),{},(0,uo.default)({top:St(fe),height:St(se),width:St(oe)},o?"right":"left",St(K)));return lt.default.createElement(M,Object.assign({type:"time"},e),lt.default.createElement("div",{role:"button",tabIndex:0,onClick:v,onDoubleClick:x,style:E,onKeyDown:_,title:$?(typeof u=="string"?u+": ":"")+$:void 0,className:(0,fo.default)(g?"rbc-background-event":"rbc-event",t,U.className,{"rbc-selected":i,"rbc-event-continues-earlier":c,"rbc-event-continues-later":m})},re))}It.default=po;var we={},fs=ee.default;Object.defineProperty(we,"__esModule",{value:!0});we.dragAccessors=void 0;we.eventTimes=Do;we.mergeComponents=yo;we.pointInColumn=bo;var go=fs(Pe),mo=fs(br),rn=tt,ho=w,vo=["children"];we.dragAccessors={start:(0,rn.wrapAccessor)(function(e){return e.start}),end:(0,rn.wrapAccessor)(function(e){return e.end})};function xo(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];var n=function(o){var i=o.children,u=(0,mo.default)(o,vo);return s.filter(Boolean).reduceRight(function(c,m){return(0,ho.createElement)(m,u,c)},i)};return n}function yo(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,t=Object.keys(s),n=(0,go.default)({},e);return t.forEach(function(a){n[a]=e[a]?xo(e[a],s[a]):s[a]}),n}function bo(e,s){var t=e.left,n=e.right,a=e.top,o=s.x,i=s.y;return o<n+10&&o>t&&i>a}function Do(e,s,t){var n=s.start(e),a=s.end(e),o=t.eq(n,a,"minutes")&&t.diff(n,a,"minutes")===0;o&&(a=t.add(a,1,"day"));var i=t.diff(n,a,"milliseconds");return{start:n,end:a,duration:i}}var _o=Bn.default,Ae=ee.default;Object.defineProperty($t,"__esModule",{value:!0});$t.default=void 0;var Te=Ae(Pe),wo=Ae(Ye),jo=Ae(He),Eo=Ae(Qe),So=Ae(et),nr=Xa,To=Ae(Ga),ze=Ae(w),Co=Be,Ce=_o(he),ko=Ae(It),_e=we,ps=function(e){function s(){var t;(0,wo.default)(this,s);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=(0,Eo.default)(this,s,[].concat(a)),t.handleMove=function(i,u){if(!(0,_e.pointInColumn)(u,i))return t.reset();var c=t.context.draggable.dragAndDropAction.event,m=t.props,h=m.accessors,v=m.slotMetrics,x=v.closestSlotFromPoint({y:i.y-t.eventOffsetTop,x:i.x},u),g=(0,_e.eventTimes)(c,h,t.props.localizer),_=g.duration,j=t.props.localizer.add(x,_,"milliseconds");t.update(c,v.getRange(x,j,!1,!0))},t.handleDropFromOutside=function(i,u){var c=t.props,m=c.slotMetrics,h=c.resource,v=m.closestSlotFromPoint({y:i.y,x:i.x},u),x=t._calculateDnDEnd(v);t.context.draggable.onDropFromOutside({start:v,end:x,allDay:!1,resource:h}),t.reset()},t.handleDragOverFromOutside=function(i,u){var c=t.props.slotMetrics,m=c.closestSlotFromPoint({y:i.y,x:i.x},u),h=t._calculateDnDEnd(m),v=t.context.draggable.dragFromOutsideItem();t.update(v,c.getRange(m,h,!1,!0))},t._calculateDnDEnd=function(i){var u=t.props,c=u.accessors,m=u.slotMetrics,h=u.localizer,v=t.context.draggable.dragFromOutsideItem(),x=(0,_e.eventTimes)(v,c,h),g=x.duration,_=m.nextSlot(i),j=!isNaN(g);if(j){var A=h.add(i,g,"milliseconds");_=new Date(Math.max(A,_))}return _},t.updateParentScroll=function(i,u){setTimeout(function(){var c=(0,To.default)(u,".rbc-addons-dnd-drag-preview")[0];c&&(c.offsetTop<i.scrollTop?(0,nr.scrollTop)(i,Math.max(c.offsetTop,0)):c.offsetTop+c.offsetHeight>i.scrollTop+i.clientHeight&&(0,nr.scrollTop)(i,Math.min(c.offsetTop-i.offsetHeight+c.offsetHeight,i.scrollHeight)))})},t._selectable=function(){var i=t.ref.current,u=i.children[0],c=!1,m=t._selector=new Ce.default(function(){return i.closest(".rbc-time-view")}),h=(0,nr.scrollParent)(i);m.on("beforeSelect",function(v){var x=t.context.draggable.dragAndDropAction;if(!x.action)return!1;if(x.action==="resize")return(0,_e.pointInColumn)((0,Ce.getBoundsForNode)(u),v);var g=(0,Ce.getEventNodeFromPoint)(u,v);if(!g)return!1;t.eventOffsetTop=v.y-(0,Ce.getBoundsForNode)(g).top}),m.on("selecting",function(v){var x=(0,Ce.getBoundsForNode)(u),g=t.context.draggable.dragAndDropAction;g.action==="move"&&(t.updateParentScroll(h,u),t.handleMove(v,x)),g.action==="resize"&&(t.updateParentScroll(h,u),t.handleResize(v,x))}),m.on("dropFromOutside",function(v){if(t.context.draggable.onDropFromOutside){var x=(0,Ce.getBoundsForNode)(u);(0,_e.pointInColumn)(x,v)&&t.handleDropFromOutside(v,x)}}),m.on("dragOverFromOutside",function(v){var x=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(x){var g=(0,Ce.getBoundsForNode)(u);if(!(0,_e.pointInColumn)(g,v))return t.reset();t.handleDragOverFromOutside(v,g)}}),m.on("selectStart",function(){c=!0,t.context.draggable.onStart()}),m.on("select",function(v){var x=(0,Ce.getBoundsForNode)(u);c=!1;var g=t.context.draggable.dragAndDropAction;if(g.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,_e.pointInColumn)(x,v))return;t.handleInteractionEnd()}}),m.on("click",function(){c&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var i=t.props.resource,u=t.state.event;t.reset(),t.context.draggable.onEnd({start:u.start,end:u.end,resourceId:i})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=ze.default.createRef(),t}return(0,So.default)(s,e),(0,jo.default)(s,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,a){var o=a.startDate,i=a.endDate,u=a.top,c=a.height,m=this.state.event;m&&o===m.start&&i===m.end||this.setState({top:u,height:c,event:(0,Te.default)((0,Te.default)({},n),{},{start:o,end:i})})}},{key:"handleResize",value:function(n,a){var o=this.props,i=o.accessors,u=o.slotMetrics,c=o.localizer,m=this.context.draggable.dragAndDropAction,h=m.event,v=m.direction,x=u.closestSlotFromPoint(n,a),g=(0,_e.eventTimes)(h,i,c),_=g.start,j=g.end,A;if(v==="UP"){var M=c.min(x,u.closestSlotFromDate(j,-1));A=u.getRange(M,j),A=(0,Te.default)((0,Te.default)({},A),{},{endDate:j})}else if(v==="DOWN"){var S=c.max(x,u.closestSlotFromDate(_));A=u.getRange(_,S),A=(0,Te.default)((0,Te.default)({},A),{},{startDate:_})}this.update(h,A)}},{key:"renderContent",value:function(){var n=this.props,a=n.children,o=n.accessors,i=n.components,u=n.getters,c=n.slotMetrics,m=n.localizer,h=this.state,v=h.event,x=h.top,g=h.height;if(!v)return a;var _=a.props.children,j=v.start,A=v.end,M,S="eventTimeRangeFormat",$=c.startsBeforeDay(j),B=c.startsAfterDay(A);return $?S="eventTimeRangeEndFormat":B&&(S="eventTimeRangeStartFormat"),$&&B?M=m.messages.allDay:M=m.format({start:j,end:A},S),ze.default.cloneElement(a,{children:ze.default.createElement(ze.default.Fragment,null,_,v&&ze.default.createElement(ko.default,{event:v,label:M,className:"rbc-addons-dnd-drag-preview",style:{top:x,height:g,width:100},getters:u,components:i,accessors:(0,Te.default)((0,Te.default)({},o),_e.dragAccessors),continuesPrior:$,continuesAfter:B}))})}},{key:"render",value:function(){return ze.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(ze.default.Component);ps.contextType=Co.DnDContext;$t.default=ps;var Wt={},gs={exports:{}},ms={exports:{}},hs={exports:{}};(function(e){function s(t,n){(n==null||n>t.length)&&(n=t.length);for(var a=0,o=Array(n);a<n;a++)o[a]=t[a];return o}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(hs);var vs=hs.exports;(function(e){var s=vs;function t(n){if(Array.isArray(n))return s(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ms);var Po=ms.exports,xs={exports:{}};(function(e){function s(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(xs);var Ao=xs.exports,ys={exports:{}};(function(e){var s=vs;function t(n,a){if(n){if(typeof n=="string")return s(n,a);var o={}.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?s(n,a):void 0}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ys);var No=ys.exports,bs={exports:{}};(function(e){function s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(bs);var Mo=bs.exports;(function(e){var s=Po,t=Ao,n=No,a=Mo;function o(i){return s(i)||t(i)||n(i)||a()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports})(gs);var Ds=gs.exports,zt={},Yt={},Ht={},Ne=ee.default;Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=void 0;var nn=Ne(Pe),Oo=Ne(br),Lo=Ne(Ye),Fo=Ne(He),$o=Ne(Qe),Io=Ne(et),ct=Ne(w),Ro=Ne(pt),Wo=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],zo=function(e){function s(){return(0,Lo.default)(this,s),(0,$o.default)(this,s,arguments)}return(0,Io.default)(s,e),(0,Fo.default)(s,[{key:"render",value:function(){var n=this.props,a=n.style,o=n.className,i=n.event,u=n.selected,c=n.isAllDay,m=n.onSelect,h=n.onDoubleClick,v=n.onKeyPress,x=n.localizer,g=n.continuesPrior,_=n.continuesAfter,j=n.accessors,A=n.getters,M=n.children,S=n.components,$=S.event,B=S.eventWrapper,V=n.slotStart,U=n.slotEnd,re=(0,Oo.default)(n,Wo);delete re.resizable;var se=j.title(i),fe=j.tooltip(i),oe=j.end(i),K=j.start(i),E=j.allDay(i),pe=c||E||x.diff(K,x.ceil(oe,"day"),"day")>1,ie=A.eventProp(i,K,oe,u),gt=ct.default.createElement("div",{className:"rbc-event-content",title:fe||void 0},$?ct.default.createElement($,{event:i,continuesPrior:g,continuesAfter:_,title:se,isAllDay:E,localizer:x,slotStart:V,slotEnd:U}):se);return ct.default.createElement(B,Object.assign({},this.props,{type:"date"}),ct.default.createElement("div",Object.assign({},re,{style:(0,nn.default)((0,nn.default)({},ie.style),a),className:(0,Ro.default)("rbc-event",o,ie.className,{"rbc-selected":u,"rbc-event-allday":pe,"rbc-event-continues-prior":g,"rbc-event-continues-after":_}),onClick:function(le){return m&&m(i,le)},onDoubleClick:function(le){return h&&h(i,le)},onKeyDown:function(le){return v&&v(i,le)}}),typeof M=="function"?M(gt):gt))}}])}(ct.default.Component);Ht.default=zo;var Me={},Yo=ee.default;Object.defineProperty(Me,"__esModule",{value:!0});Me.dateCellSelection=Vo;Me.getSlotAtX=_s;Me.isSelected=Bo;Me.pointInBox=qo;Me.slotWidth=jr;var Ho=Yo(ua);function Bo(e,s){return!e||s==null?!1:(0,Ho.default)(e,s)}function jr(e,s){var t=e.right-e.left,n=t/s;return n}function _s(e,s,t,n){var a=jr(e,n);return t?n-1-Math.floor((s-e.left)/a):Math.floor((s-e.left)/a)}function qo(e,s){var t=s.x,n=s.y;return n>=e.top&&n<=e.bottom&&t>=e.left&&t<=e.right}function Vo(e,s,t,n,a){var o=-1,i=-1,u=n-1,c=jr(s,n),m=_s(s,t.x,a,n),h=s.top<t.y&&s.bottom>t.y,v=s.top<e.y&&s.bottom>e.y,x=e.y>s.bottom,g=s.top>e.y,_=t.top<s.top&&t.bottom>s.bottom;return _&&(o=0,i=u),h&&(g?(o=0,i=m):x&&(o=m,i=u)),v&&(o=i=a?u-Math.floor((e.x-s.left)/c):Math.floor((e.x-s.left)/c),h?m<o?o=m:i=m:e.y<t.y?i=u:o=0),{startIdx:o,endIdx:i}}var Er=ee.default;Object.defineProperty(Yt,"__esModule",{value:!0});Yt.default=void 0;var xe=Er(cn),sn=Er(w),Ko=Er(Ht),Uo=Me;Yt.default={propTypes:{slotMetrics:xe.default.object.isRequired,selected:xe.default.object,isAllDay:xe.default.bool,accessors:xe.default.object.isRequired,localizer:xe.default.object.isRequired,components:xe.default.object.isRequired,getters:xe.default.object.isRequired,onSelect:xe.default.func,onDoubleClick:xe.default.func,onKeyPress:xe.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(s,t){var n=s.selected;s.isAllDay;var a=s.accessors,o=s.getters,i=s.onSelect,u=s.onDoubleClick,c=s.onKeyPress,m=s.localizer,h=s.slotMetrics,v=s.components,x=s.resizable,g=h.continuesPrior(t),_=h.continuesAfter(t);return sn.default.createElement(Ko.default,{event:t,getters:o,localizer:m,accessors:a,components:v,onSelect:i,onDoubleClick:u,onKeyPress:c,continuesPrior:g,continuesAfter:_,slotStart:h.first,slotEnd:h.last,selected:(0,Uo.isSelected)(t,n),resizable:x})},renderSpan:function(s,t,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",o=Math.abs(t)/s*100+"%";return sn.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:o,flexBasis:o,maxWidth:o}},a)}};var Oe=ee.default;Object.defineProperty(zt,"__esModule",{value:!0});zt.default=void 0;var Xo=Oe(Pe),Go=Oe(Ye),Zo=Oe(He),Jo=Oe(Qe),Qo=Oe(et),ei=Oe(pt),an=Oe(w),At=Oe(Yt),ws=function(e){function s(){return(0,Go.default)(this,s),(0,Jo.default)(this,s,arguments)}return(0,Qo.default)(s,e),(0,Zo.default)(s,[{key:"render",value:function(){var n=this,a=this.props,o=a.segments,i=a.slotMetrics.slots,u=a.className,c=1;return an.default.createElement("div",{className:(0,ei.default)(u,"rbc-row")},o.reduce(function(m,h,v){var x=h.event,g=h.left,_=h.right,j=h.span,A="_lvl_"+v,M=g-c,S=At.default.renderEvent(n.props,x);return M&&m.push(At.default.renderSpan(i,M,"".concat(A,"_gap"))),m.push(At.default.renderSpan(i,j,A,S)),c=_+1,m},[]))}}])}(an.default.Component);ws.defaultProps=(0,Xo.default)({},At.default.defaultProps);zt.default=ws;var je={},js=ee.default;Object.defineProperty(je,"__esModule",{value:!0});je.endOfRange=Es;je.eventLevels=ni;je.eventSegments=ri;je.inRange=si;je.segsOverlap=Ss;je.sortEvents=cr;je.sortWeekEvents=ai;var sr=js(Ds),ti=js(fa);function Es(e){var s=e.dateRange,t=e.unit,n=t===void 0?"day":t,a=e.localizer;return{first:s[0],last:a.add(s[s.length-1],1,n)}}function ri(e,s,t,n){var a=Es({dateRange:s,localizer:n}),o=a.first,i=a.last,u=n.diff(o,i,"day"),c=n.max(n.startOf(t.start(e),"day"),o),m=n.min(n.ceil(t.end(e),"day"),i),h=(0,ti.default)(s,function(x){return n.isSameDate(x,c)}),v=n.diff(c,m,"day");return v=Math.min(v,u),v=Math.max(v-n.segmentOffset,1),{event:e,span:v,left:h+1,right:Math.max(h+v,1)}}function ni(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,n,a,o=[],i=[];for(t=0;t<e.length;t++){for(a=e[t],n=0;n<o.length&&Ss(a,o[n]);n++);n>=s?i.push(a):(o[n]||(o[n]=[])).push(a)}for(t=0;t<o.length;t++)o[t].sort(function(u,c){return u.left-c.left});return{levels:o,extra:i}}function si(e,s,t,n,a){var o={start:n.start(e),end:n.end(e)},i={start:s,end:t};return a.inEventRange({event:o,range:i})}function Ss(e,s){return s.some(function(t){return t.left<=e.right&&t.right>=e.left})}function ai(e,s,t){var n=(0,sr.default)(e),a=[],o=[];n.forEach(function(c){var m=s.start(c),h=s.end(c);t.daySpan(m,h)>1?a.push(c):o.push(c)});var i=a.sort(function(c,m){return cr(c,m,s,t)}),u=o.sort(function(c,m){return cr(c,m,s,t)});return[].concat((0,sr.default)(i),(0,sr.default)(u))}function cr(e,s,t,n){var a={start:t.start(e),end:t.end(e),allDay:t.allDay(e)},o={start:t.start(s),end:t.end(s),allDay:t.allDay(s)};return n.sortEvents({evtA:a,evtB:o})}var oi=Bn.default,Le=ee.default;Object.defineProperty(Wt,"__esModule",{value:!0});Wt.default=void 0;var Tt=Le(Pe),ii=Le(Ds),li=Le(Ye),ci=Le(He),di=Le(Qe),ui=Le(et),Ct=Le(w),fi=Le(zt),Ge=oi(he),pi=je,ke=Me,kt=we,gi=Be,Ts=function(e){function s(){var t;(0,li.default)(this,s);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=(0,di.default)(this,s,[].concat(a)),t.handleMove=function(i,u,c){if(!(0,ke.pointInBox)(u,i))return t.reset();var m=t.context.draggable.dragAndDropAction.event||c,h=t.props,v=h.accessors,x=h.slotMetrics,g=h.rtl,_=h.localizer,j=(0,ke.getSlotAtX)(u,i.x,g,x.slots),A=x.getDateForSlot(j),M=(0,kt.eventTimes)(m,v,_),S=M.start,$=M.duration;S=_.merge(A,S);var B=_.add(S,$,"milliseconds");t.update(m,S,B)},t.handleDropFromOutside=function(i,u){if(t.context.draggable.onDropFromOutside){var c=t.props,m=c.slotMetrics,h=c.rtl,v=c.localizer,x=(0,ke.getSlotAtX)(u,i.x,h,m.slots),g=m.getDateForSlot(x);t.context.draggable.onDropFromOutside({start:g,end:v.add(g,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(i,u){var c=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;c&&t.handleMove(i,u,c)},t._selectable=function(){var i=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),u=i.closest(".rbc-month-view, .rbc-time-view"),c=i.classList.contains("rbc-month-row"),m=t._selector=new Ge.default(function(){return u},{validContainers:(0,ii.default)(c?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(h){var v=t.props.isAllDay,x=t.context.draggable.dragAndDropAction.action,g=(0,Ge.getBoundsForNode)(i),_=(0,ke.pointInBox)(g,h);return x==="move"||x==="resize"&&(!v||_)}),m.on("selecting",function(h){var v=(0,Ge.getBoundsForNode)(i),x=t.context.draggable.dragAndDropAction;x.action==="move"&&t.handleMove(h,v),x.action==="resize"&&t.handleResize(h,v)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(h){var v=(0,Ge.getBoundsForNode)(i);t.state.segment&&((0,ke.pointInBox)(v,h)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(h){if(t.context.draggable.onDropFromOutside){var v=(0,Ge.getBoundsForNode)(i);(0,ke.pointInBox)(v,h)&&t.handleDropFromOutside(h,v)}}),m.on("dragOverFromOutside",function(h){if(t.context.draggable.dragFromOutsideItem){var v=(0,Ge.getBoundsForNode)(i);t.handleDragOverFromOutside(h,v)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var i=t.props,u=i.resourceId,c=i.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:u,isAllDay:c})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Ct.default.createRef(),t}return(0,ui.default)(s,e),(0,ci.default)(s,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,a,o){var i=(0,pi.eventSegments)((0,Tt.default)((0,Tt.default)({},n),{},{end:o,start:a,__isPreview:!0}),this.props.slotMetrics.range,kt.dragAccessors,this.props.localizer),u=this.state.segment;u&&i.span===u.span&&i.left===u.left&&i.right===u.right||this.setState({segment:i})}},{key:"handleResize",value:function(n,a){var o=this.context.draggable.dragAndDropAction,i=o.event,u=o.direction,c=this.props,m=c.accessors,h=c.slotMetrics,v=c.rtl,x=c.localizer,g=(0,kt.eventTimes)(i,m,x),_=g.start,j=g.end,A=(0,ke.getSlotAtX)(a,n.x,v,h.slots),M=h.getDateForSlot(A),S=(0,ke.pointInBox)(a,n);if(u==="RIGHT"){if(S){if(h.last<_)return this.reset();x.eq(x.startOf(j,"day"),j)?j=x.add(M,1,"day"):j=M}else if(x.inRange(_,h.first,h.last)||a.bottom<n.y&&+h.first>+_)j=x.add(h.last,1,"milliseconds");else{this.setState({segment:null});return}var $=m.end(i);j=x.merge(j,$),x.lt(j,_)&&(j=$)}else if(u==="LEFT"){if(S){if(h.first>j)return this.reset();_=M}else if(x.inRange(j,h.first,h.last)||a.top>n.y&&x.lt(h.last,j))_=x.add(h.first,-1,"milliseconds");else{this.reset();return}var B=m.start(i);_=x.merge(_,B),x.gt(_,j)&&(_=B)}this.update(i,_,j)}},{key:"render",value:function(){var n=this.props,a=n.children,o=n.accessors,i=this.state.segment;return Ct.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},a,i&&Ct.default.createElement(fi.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[i],accessors:(0,Tt.default)((0,Tt.default)({},o),kt.dragAccessors)})))}}])}(Ct.default.Component);Ts.contextType=gi.DnDContext;Wt.default=Ts;var ve=ee.default;Object.defineProperty(yr,"__esModule",{value:!0});yr.default=Ti;var Pt=ve(Pe),mi=ve(br),hi=ve(Ye),vi=ve(He),xi=ve(Qe),yi=ve(et),ar=ve(w),bi=ve(pt),Di=ve(Ft),_i=ve($t),wi=ve(Wt),ji=we,Ei=Be,Si=["selectable","elementProps","components"];function Ti(e){var s=function(t){function n(){var a;(0,hi.default)(this,n);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return a=(0,xi.default)(this,n,[].concat(i)),a.defaultOnDragOver=function(c){c.preventDefault()},a.handleBeginAction=function(c,m,h){a.setState({event:c,action:m,direction:h});var v=a.props.onDragStart;v&&v({event:c,action:m,direction:h})},a.handleInteractionStart=function(){a.state.interacting===!1&&a.setState({interacting:!0})},a.handleInteractionEnd=function(c){var m=a.state,h=m.action,v=m.event;if(h&&(a.setState({action:null,event:null,interacting:!1,direction:null}),c!=null)){c.event=v;var x=a.props,g=x.onEventDrop,_=x.onEventResize;h==="move"&&g&&g(c),h==="resize"&&_&&_(c)}},a.state={interacting:!1},a}return(0,yi.default)(n,t),(0,vi.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var o=this.props,i=o.selectable,u=o.elementProps,c=o.components,m=(0,mi.default)(o,Si),h=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=i?"ignoreEvents":!1,this.components=(0,ji.mergeComponents)(c,{eventWrapper:Di.default,eventContainerWrapper:_i.default,weekWrapper:wi.default});var v=this.props.onDropFromOutside?(0,Pt.default)((0,Pt.default)({},u),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):u;m.className=(0,bi.default)(m.className,"rbc-addons-dnd",!!h&&"rbc-addons-dnd-is-dragging");var x=this.getDnDContextValue();return ar.default.createElement(Ei.DnDContext.Provider,{value:x},ar.default.createElement(e,Object.assign({},m,{elementProps:v,components:this.components})))}}])}(ar.default.Component);return s.defaultProps=(0,Pt.default)((0,Pt.default)({},e.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),s}var Ci=ee.default;Object.defineProperty(xr,"__esModule",{value:!0});var Cs=xr.default=void 0,ki=Ci(yr);Cs=xr.default=ki.default;const Pi=Cs(ga),Ai=ba;P.updateLocale("ko",{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthsShort:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"],weekdaysMin:["일","월","화","수","목","금","토"],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm"},meridiem:e=>e<12?"오전":"오후",week:{dow:0,doy:1}});P.locale("ko");const Ni=pa(P),on=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],Mi=z.memo(({onSave:e,onCancel:s})=>{const[t,n]=w.useState(""),a=()=>{const c=window.innerWidth,m=window.innerHeight;return c>=768&&c<1024||c>=1024&&m>c},[o,i]=w.useState(a);w.useEffect(()=>{const c=()=>i(a());return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]);const u=o?"16px":"18px";return d.jsx("div",{className:"w-full",onClick:c=>c.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:d.jsx("input",{type:"text",value:t,onChange:c=>n(c.target.value),onBlur:()=>{t.trim()?e(t.trim()):s()},onKeyDown:c=>{c.stopPropagation(),c.key==="Enter"?t.trim()?e(t.trim()):s():c.key==="Escape"&&s()},onClick:c=>c.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}})})}),ln=e=>e,dt={"2025-01-01":"신정","2025-01-28":"설날 연휴","2025-01-29":"설날","2025-01-30":"설날 연휴","2025-03-01":"삼일절","2025-03-03":"대체공휴일","2025-05-05":"어린이날","2025-05-06":"부처님오신날","2025-06-06":"현충일","2025-08-15":"광복절","2025-10-03":"개천절","2025-10-05":"추석 연휴","2025-10-06":"추석","2025-10-07":"추석 연휴","2025-10-08":"대체공휴일","2025-10-09":"한글날","2025-12-25":"성탄절"},Oi=z.memo(({date:e,label:s,filteredEvents:t,selectedDate:n,user:a,isMobileView:o})=>{const i=P(e).format("YYYY-MM-DD"),u=dt[i],c=!!dt[i],m=n&&P(e).isSame(n,"day"),h=t.filter(U=>P(U.start).isSame(e,"day")),v=h.length,x=h.filter(U=>U.assignedTo&&U.assignedTo.includes((a==null?void 0:a.name)||"")).length,g=v-x,_=s.replace(/^0/,""),j=e.getDay()===0,A=e.getDay()===6;let M="#000000";c||j?M="#dc2626":A&&(M="#3b82f6");const S=P(e).isSame(P(),"day");let $="#d1d5db";c||j?$="#fecaca":A&&($="#bfdbfe");const B=_.length===2,V=o?{backgroundColor:"transparent",color:M,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:S?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:M,fontWeight:S?"700":"400",paddingLeft:B?"0px":"4px",...S&&{backgroundColor:$,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return d.jsx("div",{className:o?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:o?d.jsxs("span",{style:V,children:[d.jsx("span",{style:{fontSize:"13px",lineHeight:"1"},children:_}),v>0&&d.jsxs("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:x}).map((U,re)=>d.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${re}`)),Array.from({length:g}).map((U,re)=>d.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${re}`))]})]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:V,children:_}),u&&d.jsx("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:u})]})})}),Li=z.memo(({event:e,user:s,filterProject:t,isEditing:n,editTitle:a,onEditTitleChange:o,onEditSave:i,onEditDelete:u,onEditCancel:c,onHoverDelete:m,onDeleteAction:h})=>{const v=t&&t!=="all",x=e.assignedTo||[],[g,_]=w.useState(!1),j=z.useRef(null),A=()=>{const E=window.innerWidth,pe=window.innerHeight;return E>=768&&E<1024||E>=1024&&pe>E},[M,S]=w.useState(A),[$,B]=w.useState(!1);z.useRef(null),z.useRef(!1);const V=s!=null&&s.name?s.name.slice(-2):null,U=V&&["재천","민기"].includes(V),re=V&&["신애","재성","재현"].includes(V),se=(s==null?void 0:s.name)&&(x.includes(s.name)||x.includes("HV LAB")||x.includes("디자인팀")&&re||x.includes("현장팀")&&U);w.useEffect(()=>{const E=()=>{S(A())};return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const fe=E=>{o&&o(E)},oe=()=>{a!=null&&a.trim()&&i&&i(),c&&c()},K=E=>{E.stopPropagation(),(E.key==="Enter"||E.key==="Escape")&&E.currentTarget.blur()};return M?d.jsxs("div",{className:"w-full relative block",onMouseEnter:()=>{B(!0),_(!0)},onMouseLeave:()=>{B(!1),_(!1)},style:{padding:v?"2px 3px":"1px 3px",minHeight:v?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[g&&v&&m&&!e.isASVisit&&!e.isExpectedPayment&&d.jsx("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:d.jsx("button",{ref:j,onMouseDown:E=>{E.stopPropagation(),E.preventDefault(),h&&h(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:"삭제 (Ctrl+Z로 복원)",children:"✕"})}),d.jsxs("div",{className:"flex items-center justify-between w-full",style:{fontSize:v?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!v&&!e.isASVisit&&e.projectName?d.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",ln(e.projectName),"]"]}):d.jsx("span",{}),!v&&x.length>0&&d.jsx("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:x.map((E,pe)=>{const ie=E==="HV LAB"||E==="현장팀"&&U||E==="디자인팀"&&re||E===(s==null?void 0:s.name);return d.jsxs(z.Fragment,{children:[d.jsx("span",{style:{fontWeight:ie?"bold":"normal"},children:E}),pe<x.length-1&&"·"]},E)})})]}),n?d.jsx("input",{type:"text",value:a||"",onChange:E=>fe(E.target.value),onBlur:oe,onKeyDown:K,onClick:E=>E.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:v?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}}):d.jsx("div",{style:{fontWeight:500,fontSize:v?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:se?"underline":"none",textDecorationColor:se?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:e.title,children:e.title}),$&&d.jsxs("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[d.jsx("div",{className:"font-semibold mb-1",children:e.title}),e.projectName&&d.jsxs("div",{className:"opacity-90",children:["프로젝트: ",e.projectName]}),x.length>0&&d.jsxs("div",{className:"opacity-90 mt-1",children:["담당자: ",x.join(", ")]})]})]}):d.jsxs("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),style:{minHeight:v?"32px":"18px",padding:v?"6px 0":"0"},children:[d.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!v&&!e.isASVisit&&e.projectName&&d.jsxs("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",ln(e.projectName),"]"]}),n?d.jsx("input",{type:"text",value:a||"",onChange:E=>fe(E.target.value),onBlur:oe,onKeyDown:K,onClick:E=>E.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:v?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}}):d.jsx("span",{className:"font-medium truncate",style:{fontSize:v?"18px":"12px",textDecoration:se?"underline":"none",textDecorationColor:se?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:e.title})]}),!v&&x.length>0&&d.jsx("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:x.map((E,pe)=>{const ie=E==="HV LAB"||E==="현장팀"&&U||E==="디자인팀"&&re||E===(s==null?void 0:s.name);return d.jsxs(z.Fragment,{children:[d.jsx("span",{className:ie?"font-bold":"",children:E}),pe<x.length-1&&"·"]},E)})}),g&&v&&m&&!e.isASVisit&&!e.isExpectedPayment&&d.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:d.jsx("button",{ref:j,onMouseDown:E=>{E.stopPropagation(),E.preventDefault(),h&&h(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:"삭제 (Ctrl+Z로 복원)",children:"✕"})})]})}),Gi=()=>{const{schedules:e,setSchedules:s,addSchedule:t,deleteSchedule:n,loadSchedulesFromAPI:a,addScheduleToAPI:o,updateScheduleInAPI:i,deleteScheduleFromAPI:u,asRequests:c,updateASRequestInAPI:m,loadASRequestsFromAPI:h,constructionPayments:v,updateConstructionPaymentInAPI:x}=va(),{user:g}=ha(),_=xa(),[j,A]=w.useState(!1);w.useEffect(()=>{const r=()=>{const l=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;A(l)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const M=r=>!r||r==="-"?"":j?r:ya(r),S=g!=null&&g.name?g.name.slice(-2):null;console.log("👤 Current user:",g==null?void 0:g.name,"Short name:",S),w.useEffect(()=>{a().catch(r=>{console.error("Failed to load schedules:",r),L.error("일정을 불러오는데 실패했습니다")})},[a]);const[$,B]=w.useState([]);w.useEffect(()=>{const r=async l=>{if((l.ctrlKey||l.metaKey)&&l.key==="z"){const p=l.target;if(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)return;if($.length>0){l.preventDefault();const f=$[$.length-1];try{const y=f.type==="as_visit"||f.type==="expected_payment"?"other":f.type;await o({id:"",title:f.originalTitle||f.title,start:f.start,end:f.end,type:y,project:f.originalProjectName||f.projectName,attendees:f.assignedTo||[],time:f.time,description:f.description}),B(b=>b.slice(0,-1)),a(),L.success("일정이 복원되었습니다")}catch(y){console.error("일정 복원 실패:",y),L.error("일정 복원에 실패했습니다")}}}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[$,o,a]);const[V,U]=w.useState([]),[re,se]=w.useState(!1),[fe,oe]=w.useState(""),[K,E]=w.useState(null),[pe,ie]=w.useState(""),[gt,nt]=w.useState(!1),[le,Sr]=w.useState(null),[mt,Bt]=w.useState(null),Fe=w.useCallback(async()=>{nt(!0);try{const r=await fetch("/api/processes");if(r.ok){const l=await r.json();U(l)}else console.error("공정 목록 로딩 실패"),L.error("공정 목록을 불러올 수 없습니다")}catch(r){console.error("공정 목록 로딩 오류:",r),L.error("서버 연결에 실패했습니다")}finally{nt(!1)}},[]);w.useEffect(()=>{Fe()},[Fe]);const Tr=w.useMemo(()=>V.length>0?V.map(r=>r.name):Ai,[V]),Cr=async()=>{if(fe.trim())try{const r=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:fe.trim()})});if(r.ok)oe(""),Fe(),L.success("공정이 추가되었습니다");else{const l=await r.json();L.error(l.error||"공정 추가 실패")}}catch(r){console.error("공정 추가 오류:",r),L.error("공정 추가 실패")}},kr=async()=>{if(!(!K||!pe.trim()))try{const r=await fetch(`/api/processes/${K.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:pe.trim()})});if(r.ok)E(null),ie(""),Fe(),L.success("공정이 수정되었습니다");else{const l=await r.json();L.error(l.error||"공정 수정 실패")}}catch(r){console.error("공정 수정 오류:",r),L.error("공정 수정 실패")}},ks=async r=>{if(confirm("정말 이 공정을 삭제하시겠습니까?"))try{const l=await fetch(`/api/processes/${r}`,{method:"DELETE"});if(l.ok)Fe(),L.success("공정이 삭제되었습니다");else{const p=await l.json();L.error(p.error||"공정 삭제 실패")}}catch(l){console.error("공정 삭제 오류:",l),L.error("공정 삭제 실패")}},Ps=r=>{Sr(r)},As=(r,l)=>{r.preventDefault(),le!==null&&le!==l&&Bt(l)},Ns=async()=>{if(le!==null&&mt!==null&&le!==mt){const r=[...V],[l]=r.splice(le,1);r.splice(mt,0,l),U(r);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:r.map(f=>({id:f.id}))})})).ok||(Fe(),L.error("순서 변경 실패"))}catch(p){console.error("순서 변경 오류:",p),Fe(),L.error("순서 변경 실패")}}Sr(null),Bt(null)},Ms=r=>{const l=_.findIndex(p=>p.name===r);return l>=0?on[l%on.length]:"#e8e2ea"},Pr=_.map(r=>r.name),Os=e.filter(r=>!r.asRequestId).filter(r=>(g==null?void 0:g.name)==="안팀"?r.project==="비공개"||Pr.includes(r.project):!0).map(r=>{const l=_.find(D=>D.name===r.project);let p=r.project==="비공개"?"[개인일정]":r.project;if(l&&r.project!=="비공개"){const D=l.name.length>2?l.name.substring(0,2):l.name,k=(l.location||"").match(/([A-Za-z]?\d+)호/),X=k?k[1]:"";p=X?`${D}_${X}`:D}const f=r.time,y=f&&f!=="-"?` - ${M(f)}`:"",b=r.attendees||[];return{id:r.id,title:r.title+y,originalTitle:r.title,start:r.start,end:r.end,projectId:(l==null?void 0:l.id)||"",projectName:p||"",originalProjectName:r.project||"",type:r.type||"other",phase:"",assignedTo:b,priority:"medium",allDay:!f||f==="-",color:Ms(r.project||""),isASVisit:!1,time:f,description:r.description}}),Ls=c.filter(r=>r.scheduledVisitDate).filter(r=>(g==null?void 0:g.name)==="안팀"?Pr.includes(r.project):!0).map(r=>{const l=r.scheduledVisitTime,p=l&&l!=="-"?` - ${M(l)}`:"",f=_.find(D=>D.name===r.project);let y=r.project;if(f){const D=f.name.length>2?f.name.substring(0,2):f.name,k=(f.location||"").match(/([A-Za-z]?\d+)호/),X=k?k[1]:"";y=X?`${D}_${X}`:D}const b=`[AS] ${y}`;return{id:`as-${r.id}`,title:b+p,originalTitle:b,start:r.scheduledVisitDate,end:r.scheduledVisitDate,projectId:(f==null?void 0:f.id)||"",projectName:y,originalProjectName:r.project,type:"as_visit",phase:"",assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:r.assignedTo.split(",").map(D=>D.trim()):[],priority:"high",allDay:!l||l==="-",color:"#FEF3C7",isASVisit:!0,time:l,description:r.description}}),Fs=(g==null?void 0:g.role)==="manager"?v.flatMap(r=>{var b,D,C,k,X,F,Z,R;const l=_.find(O=>O.name===r.project);if(!l){const O=[],N=r.totalAmount+(r.vatType==="percentage"?r.totalAmount*(r.vatPercentage/100):r.vatAmount),G=new Set(r.payments.flatMap(te=>{var W;return((W=te.type)==null?void 0:W.split(", ").map(Y=>Y.trim()))||[]}));return!G.has("계약금")&&((b=r.expectedPaymentDates)!=null&&b.contract)&&O.push({id:`payment-${r.id}-contract`,title:"[수금일정] 계약금",originalTitle:"[수금일정] 계약금",start:new Date(r.expectedPaymentDates.contract),end:new Date(r.expectedPaymentDates.contract),projectId:"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`계약금 (10%): ${Math.round(N*.1).toLocaleString()}원`}),!G.has("착수금")&&((D=r.expectedPaymentDates)!=null&&D.start)&&O.push({id:`payment-${r.id}-start`,title:"[수금일정] 착수금",originalTitle:"[수금일정] 착수금",start:new Date(r.expectedPaymentDates.start),end:new Date(r.expectedPaymentDates.start),projectId:"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`착수금 (40%): ${Math.round(N*.4).toLocaleString()}원`}),!G.has("중도금")&&((C=r.expectedPaymentDates)!=null&&C.middle)&&O.push({id:`payment-${r.id}-middle`,title:"[수금일정] 중도금",originalTitle:"[수금일정] 중도금",start:new Date(r.expectedPaymentDates.middle),end:new Date(r.expectedPaymentDates.middle),projectId:"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`중도금 (40%): ${Math.round(N*.4).toLocaleString()}원`}),!G.has("잔금")&&((k=r.expectedPaymentDates)!=null&&k.final)&&O.push({id:`payment-${r.id}-final`,title:"[수금일정] 잔금",originalTitle:"[수금일정] 잔금",start:new Date(r.expectedPaymentDates.final),end:new Date(r.expectedPaymentDates.final),projectId:"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`잔금 (10%): ${Math.round(N*.1).toLocaleString()}원`}),O}if(!l.startDate||!l.endDate)return[];const p=r.totalAmount+(r.vatType==="percentage"?r.totalAmount*(r.vatPercentage/100):r.vatAmount),f=new Set(r.payments.flatMap(O=>{var N;return((N=O.type)==null?void 0:N.split(", ").map(G=>G.trim()))||[]})),y=[];return!f.has("계약금")&&((X=r.expectedPaymentDates)!=null&&X.contract)&&y.push({id:`payment-${r.id}-contract`,title:"[수금일정] 계약금",originalTitle:"[수금일정] 계약금",start:new Date(r.expectedPaymentDates.contract),end:new Date(r.expectedPaymentDates.contract),projectId:l.id||"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`계약금 (10%): ${Math.round(p*.1).toLocaleString()}원`}),!f.has("착수금")&&((F=r.expectedPaymentDates)!=null&&F.start)&&y.push({id:`payment-${r.id}-start`,title:"[수금일정] 착수금",originalTitle:"[수금일정] 착수금",start:new Date(r.expectedPaymentDates.start),end:new Date(r.expectedPaymentDates.start),projectId:l.id||"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`착수금 (40%): ${Math.round(p*.4).toLocaleString()}원`}),!f.has("중도금")&&((Z=r.expectedPaymentDates)!=null&&Z.middle)&&y.push({id:`payment-${r.id}-middle`,title:"[수금일정] 중도금",originalTitle:"[수금일정] 중도금",start:new Date(r.expectedPaymentDates.middle),end:new Date(r.expectedPaymentDates.middle),projectId:l.id||"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`중도금 (40%): ${Math.round(p*.4).toLocaleString()}원`}),!f.has("잔금")&&((R=r.expectedPaymentDates)!=null&&R.final)&&y.push({id:`payment-${r.id}-final`,title:"[수금일정] 잔금",originalTitle:"[수금일정] 잔금",start:new Date(r.expectedPaymentDates.final),end:new Date(r.expectedPaymentDates.final),projectId:l.id||"",projectName:r.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:`잔금 (10%): ${Math.round(p*.1).toLocaleString()}원`}),y}):[],$s=[...Os,...Ls,...Fs],Ve=w.useCallback(r=>{if(!(g!=null&&g.name))return!1;const l=r.assignedTo||[],p=g.name.slice(-2),f=["재천","민기"].includes(p),y=["신애","재성","재현"].includes(p);return l.includes(g.name)||l.includes("HV LAB")||l.includes("디자인팀")&&y||l.includes("현장팀")&&f},[g==null?void 0:g.name]),Is=(r,l)=>{if(!l)return[...r].sort((y,b)=>{const D=Ve(y),C=Ve(b);return D&&!C?-1:!D&&C?1:y.start.getTime()-b.start.getTime()});const p=new Map;r.forEach(y=>{if(y.isASVisit||y.isExpectedPayment){const b=`single_${y.id}`;p.set(b,[y])}else{const b=y.start.toISOString().split("T")[0],D=[...y.assignedTo].sort().join(","),C=`${b}_${y.projectName}_${D}`;p.has(C)||p.set(C,[]),p.get(C).push(y)}});const f=[];return p.forEach(y=>{if(y.length===1)f.push(y[0]);else{const b=y[0],D=y.map(O=>O.originalTitle||O.title),C=[...new Set(D)],k=y.filter(O=>O.time&&O.time!=="-").map(O=>O.time),X=k.length>0?` - ${k.join(", ")}`:"",F=y.map(O=>{const N=O.originalTitle||O.title;return N.startsWith(b.projectName+" - ")?N.substring(b.projectName.length+3):N}),Z=[...new Set(F)],R={...b,id:y[0].id,title:`${Z.join(", ")}${X}`,originalTitle:C.join(", "),description:y.map(O=>O.description||O.originalTitle||O.title).join(`
`),assignedTo:[...new Set(y.flatMap(O=>O.assignedTo))],mergedEventIds:y.map(O=>O.id)};f.push(R)}}),f.sort((y,b)=>{const D=Ve(y),C=Ve(b);return D&&!C?-1:!D&&C?1:y.start.getTime()-b.start.getTime()})},[Ar,Rs]=w.useState("month"),[ce,qt]=w.useState(new Date),[Ws,$e]=w.useState(!1),[q,ht]=w.useState(null),[zs,vt]=w.useState(null),Vt=`schedule_filterProject_${(g==null?void 0:g.id)||"guest"}`,[T,Nr]=w.useState(()=>{const r=localStorage.getItem(Vt);return r||((g==null?void 0:g.name)==="안팀"&&_.length>0?_[0].name:"all")});w.useEffect(()=>{localStorage.setItem(Vt,T)},[T,Vt]),w.useCallback(()=>{document.body.classList.add("printing-schedule");const r=T==="all"?"전체 프로젝트":T,l=P(ce).format("YYYY년 MM월"),p=document.title;document.title=`${r} - ${l} 일정표`,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=p},100)},[T,ce]);const Kt=Is($s,T==="all"),[I,st]=w.useState(window.innerWidth<768?new Date:null),[Ie,Ut]=w.useState(null),at=z.useRef(null),xt=z.useRef(!1),[Ke,yt]=w.useState(null),Xt=z.useRef(!1),bt=z.useRef(!1);w.useEffect(()=>{const r=f=>{f.key==="Control"&&(bt.current=!0)},l=f=>{f.key==="Control"&&(bt.current=!1)},p=()=>{bt.current=!1};return window.addEventListener("keydown",r),window.addEventListener("keyup",l),window.addEventListener("blur",p),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",l),window.removeEventListener("blur",p)}},[]),w.useEffect(()=>{if(!Ie)return;let r=null;const l=b=>{b.preventDefault(),b.dataTransfer&&(b.dataTransfer.dropEffect="copy")},p=b=>{b.preventDefault(),b.dataTransfer&&(b.dataTransfer.dropEffect="copy");const C=b.target.closest(".rbc-day-bg");r&&r!==C&&(r.style.backgroundColor=""),C&&(C.style.backgroundColor="rgba(59, 130, 246, 0.15)",r=C)},f=()=>{r&&(r.style.backgroundColor="",r=null)},y=b=>{b.preventDefault(),r&&(r.style.backgroundColor="",r=null)};return document.addEventListener("dragenter",l),document.addEventListener("dragover",p),document.addEventListener("dragend",f),document.addEventListener("drop",y),()=>{document.removeEventListener("dragenter",l),document.removeEventListener("dragover",p),document.removeEventListener("dragend",f),document.removeEventListener("drop",y),r&&(r.style.backgroundColor="")}},[Ie]);const[Ee,Re]=w.useState(null),[de,Se]=w.useState(null),[ot,ye]=w.useState(""),[Fi,Ys]=w.useState(!1),[Gt,Dt]=w.useState(null),[Ue,Mr]=w.useState(null),[Or,Lr]=w.useState({x:0,y:0}),[Zt,Hs]=w.useState({x:0,y:0}),[Bs,Jt]=w.useState(!1),Fr=8;w.useEffect(()=>{if(!Ue)return;const r=p=>{Lr({x:p.clientX,y:p.clientY});const f=Math.abs(p.clientX-Zt.x),y=Math.abs(p.clientY-Zt.y);(f>Fr||y>Fr)&&Jt(!0)},l=()=>{Mr(null),Jt(!1)};return window.addEventListener("mousemove",r),window.addEventListener("mouseup",l),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",l)}},[Ue,Zt]);const Qt=z.useRef(!1),qs=w.useCallback(async({event:r,start:l,end:p})=>{if(r.isASVisit||r.isExpectedPayment){L.error("이 일정은 이동할 수 없습니다");return}const f=l instanceof Date?l:new Date(l),y=p instanceof Date?p:new Date(p);if(bt.current)try{const D=r.mergedEventIds||[r.id],C=e.filter(k=>D.includes(k.id));for(const k of C)await o({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:k.title,start:f,end:y,project:k.project,attendees:k.attendees||[],time:k.time,priority:k.priority||"medium"});L.success("일정이 복사되었습니다"),a()}catch(D){console.error("일정 복사 실패:",D),L.error("일정 복사 실패")}else{const D=r.mergedEventIds||[r.id],C=[...e];s(e.map(k=>D.includes(k.id)?{...k,start:f,end:y}:k));try{for(const k of D)await i(k,{start:f,end:y})}catch(k){s(C),console.error("일정 이동 실패:",k),L.error("일정 이동 실패")}}},[e,s,i,o,a]),Vs=w.useCallback(({event:r,action:l})=>{var f;if(r.isASVisit||r.isExpectedPayment||r.id==="__inline_add__")return;const p=document.querySelectorAll(".rbc-event");for(const y of p)if((f=y.textContent)!=null&&f.includes(r.originalTitle||r.title)){const b=y.getBoundingClientRect();Hs({x:b.left,y:b.top}),Lr({x:b.left,y:b.top});break}Jt(!1),Mr(r)},[]),er=w.useCallback(async(r,l,p=!1)=>{if(console.log("[handleProcessDrop] Called:",{processName:r,dropDate:l,filterProject:T,isTapMode:p}),T==="all"){L.error("프로젝트를 먼저 선택해주세요");return}const f="temp_"+Date.now().toString()+Math.random().toString(36).substr(2,9),y={id:f,title:r,start:l,end:l,project:T,attendees:g!=null&&g.name?[g.name]:[],type:"construction"};t(y);try{await o(y),n(f)}catch(b){console.error("일정 추가 실패:",b),L.error("일정 추가에 실패했습니다"),n(f)}},[T,o,t,n,g]),Ks=w.useCallback(({start:r})=>{const l=Ie||at.current;l&&T!=="all"&&(xt.current=!0,Xt.current=!0,requestAnimationFrame(()=>{Xt.current=!1}),Re(null),Se(null),ye(""),er(l,r),requestAnimationFrame(()=>{Ut(null),at.current=null,xt.current=!1}))},[Ie,T,er]),Us=w.useCallback(()=>{const r=Ie||at.current;return r?{title:r}:null},[Ie]),$r=w.useCallback(async r=>{if(!r.trim()||!Ee||T==="all"){Re(null);return}const l="temp_"+Date.now().toString()+Math.random().toString(36).substr(2,9),p={id:l,title:r.trim(),start:Ee,end:Ee,type:"construction",project:T,location:"",attendees:g!=null&&g.name?[g.name]:[],description:""};t(p),Re(null);try{await o(p),n(l)}catch(f){console.error("일정 추가 실패:",f),L.error("일정 추가에 실패했습니다"),n(l)}},[Ee,T,o,t,n,g]),Ir=w.useCallback(()=>{Re(null)},[]),Rr=w.useCallback(async()=>{var r;if(!de||!ot.trim()){Se(null),ye("");return}try{const l=((r=de.mergedEventIds)==null?void 0:r[0])||de.id;await i(l,{title:ot.trim()}),a()}catch(l){console.error("일정 수정 실패:",l),L.error("일정 수정에 실패했습니다")}Se(null),ye("")},[de,ot,i,a]),tr=w.useCallback(async r=>{B(p=>[...p,r]);const l=r.mergedEventIds||[r.id];l.forEach(p=>n(p));try{await Promise.all(l.map(p=>u(p))),L.success("삭제됨 (Ctrl+Z로 복원)",{duration:2e3}),setTimeout(()=>{a()},1e3)}catch(p){console.error("일정 삭제 실패:",p),L.error("일정 삭제에 실패했습니다"),B(f=>f.slice(0,-1)),a()}Se(null),ye("")},[n,u,a]),Wr=T==="all"?Kt:Kt.filter(r=>(r.originalProjectName||r.projectName)===T),_t=z.useMemo(()=>{const r=T!=="all",l=new Map;Wr.forEach(f=>{const y=P(f.start).format("YYYY-MM-DD");l.has(y)||l.set(y,[]),l.get(y).push(f)});const p=[];return l.forEach(f=>{if(r)[...f].sort((b,D)=>{const C=parseInt(b.id)||0,k=parseInt(D.id)||0;return C-k}).forEach((b,D)=>{const C=P(b.start).startOf("day").add(D,"milliseconds").toDate();p.push({...b,start:C,allDay:!1})});else{const y=[],b=[];f.forEach(D=>{Ve(D)?y.push(D):b.push(D)}),y.forEach((D,C)=>{const k=P(D.start).startOf("day").add(C,"milliseconds").toDate();p.push({...D,start:k,allDay:!1})}),b.forEach((D,C)=>{const k=P(D.start).startOf("day").add(1e3+C,"milliseconds").toDate();p.push({...D,start:k,allDay:!1})})}}),p.sort((f,y)=>f.start.getTime()-y.start.getTime())},[Wr,Ve,T]),be=z.useMemo(()=>{if(Ee&&T!=="all"){const r=P(Ee).format("YYYY-MM-DD"),l=_t.filter(b=>P(b.start).format("YYYY-MM-DD")===r),p=l.length>0?Math.max(...l.map(b=>b.start.getTime())):P(Ee).startOf("day").valueOf(),f=new Date(p+1),y={id:"__inline_add__",title:"",start:f,end:f,projectId:"",projectName:T,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[..._t,y]}return _t},[_t,Ee,T]);w.useEffect(()=>{(g==null?void 0:g.name)==="안팀"&&_.length>0&&(T==="all"||!_.find(r=>r.name===T))&&Nr(_[0].name)},[_,g]),w.useEffect(()=>{const r=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(D=>{D.style.display="none",D.style.visibility="hidden",D.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(D=>{D.style.display="none",D.style.visibility="hidden",D.style.opacity="0",D.style.pointerEvents="none",D.style.position="absolute",D.style.left="-9999px",D.style.top="-9999px",D.style.zIndex="-1"})};r();const l=new MutationObserver(r),p=document.querySelector(".rbc-calendar");p&&l.observe(p,{childList:!0,subtree:!0});const f=new MutationObserver(r);return f.observe(document.body,{childList:!0,subtree:!0}),()=>{l.disconnect(),f.disconnect()}},[Ar,ce]);const[ae,wt]=w.useState({date:null,projectId:"",title:""}),jt=z.useRef(!1),Et=z.useRef(null),zr=r=>{if(Qt.current){Qt.current=!1;return}if(r.id==="__inline_add__")return;jt.current=!0,Et.current&&clearTimeout(Et.current);const l=T!=="all",p=window.innerWidth<768;if(l&&!p&&!r.isASVisit&&!r.isExpectedPayment)Re(null),Se(r),ye(r.originalTitle||r.title);else{const f={...r,title:r.originalTitle||r.title};vt(null),ht(f),$e(!0)}Et.current=setTimeout(()=>{jt.current=!1,Et.current=null},300)},Xs=r=>{const l=window.innerWidth,p=l<768,f=l>=768&&l<1024,y=T==="all";if(Xt.current)return;if(p){if(r.start){st(r.start);const D=document.querySelector(".md\\:hidden.mt-3.bg-white");D&&D.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const b=r.action==="click"||r.action==="select";if(!(f&&!b)){if(y){jt.current=!1,Se(null),ye(""),Re(null),vt(r),ht(null),$e(!0);return}if(!jt.current){if(Ke){er(Ke,r.start,!0);return}Se(null),ye(""),Re(r.start)}}},Yr=async()=>{if(!ae.projectId||!ae.title.trim()){alert("프로젝트와 제목을 입력하세요");return}const r=_.find(l=>l.id===ae.projectId);if(!(!r||!ae.date))try{await o({id:Date.now().toString(),title:ae.title,start:ae.date,end:ae.date,type:"other",project:r.name,location:"",attendees:[],description:""}),wt({date:null,projectId:"",title:""}),st(null)}catch(l){console.error("Failed to add schedule:",l),L.error("일정 추가에 실패했습니다")}},Gs=r=>{if(r.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let l=r.color||"#E0E7FF",p="#1f2937";if(r.isASVisit)l="#E8F5E9",p="#1f2937";else{const f=r.assignedTo&&r.assignedTo.includes("HV LAB"),y=r.assignedTo&&r.assignedTo.includes("현장팀")&&S&&["재천","민기"].includes(S),b=r.assignedTo&&r.assignedTo.includes("디자인팀")&&S&&["신애","재성","재현"].includes(S);r.assignedTo&&r.assignedTo.includes((g==null?void 0:g.name)||"")||f||y||b?(l="#FEF3C7",p="#1f2937"):r.color||(l="#e8e2ea")}return{style:{backgroundColor:l,"--event-bg-color":l,borderRadius:"6px",color:p,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},Zs=z.useCallback(r=>{const l=P(r).format("YYYY-MM-DD"),p=!!dt[l],f=I&&P(r).isSame(I,"day"),y=window.innerWidth<768;let b="";f&&(b+="selected-date "),p&&(b+="holiday-date ");const D=y?{backgroundColor:"transparent",background:"transparent"}:{};return{className:b.trim(),style:D}},[I]),[ue,Js]=w.useState(window.innerWidth<768);w.useEffect(()=>{const r=()=>{Js(window.innerWidth<768)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),w.useEffect(()=>{const r=()=>{const l=I||new Date;vt({start:l,end:l}),ht(null),$e(!0)};return window.addEventListener("headerAddButtonClick",r),()=>window.removeEventListener("headerAddButtonClick",r)},[I]);const Hr=z.useCallback(({date:r,label:l})=>d.jsx(Oi,{date:r,label:l,filteredEvents:be,selectedDate:I,user:g,isMobileView:ue}),[be,I,g,ue]),Br=z.useCallback(({event:r})=>{if(r.id==="__inline_add__")return d.jsx(Mi,{onSave:$r,onCancel:Ir});const l=(de==null?void 0:de.id)===r.id||(de==null?void 0:de.mergedEventIds)&&de.mergedEventIds.includes(r.id);return d.jsx(Li,{event:r,user:g,filterProject:T,isEditing:l,editTitle:l?ot:void 0,onEditTitleChange:l?ye:void 0,onEditSave:l?Rr:void 0,onEditDelete:l?()=>tr(r):void 0,onEditCancel:l?()=>{Se(null),ye("")}:void 0,onHoverDelete:()=>tr(r),onDeleteAction:()=>{Qt.current=!0}})},[g,T,de,ot,Rr,tr,$r,Ir]),Qs=({onNavigate:r})=>{const[l,p]=z.useState(!1),[f,y]=z.useState(P(ce).year()),[b,D]=z.useState(P(ce).month()),C=window.innerWidth<768,k=()=>{y(P(ce).year()),D(P(ce).month()),p(!0)},X=()=>{qt(P().year(f).month(b).toDate()),p(!1)};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${C?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-1",children:[d.jsx("button",{onClick:()=>r("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:"‹"}),d.jsxs("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:k,children:[d.jsx("span",{children:P(ce).format("YYYY년 MM월")}),d.jsxs("span",{className:"print-project-name hidden",children:[" - ",T==="all"?"전체 프로젝트":T]})]}),d.jsx("button",{onClick:()=>r("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:"›"})]}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:T,onChange:F=>{Nr(F.target.value),yt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(g==null?void 0:g.name)!=="안팀"&&d.jsx("option",{value:"all",children:"전체 프로젝트"}),_.filter(F=>F.status!=="completed").map(F=>d.jsx("option",{value:F.name,children:F.name},F.id))]})})]})}),l&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[d.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"월 선택"}),d.jsx("button",{onClick:()=>p(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d.jsx("div",{className:"p-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("button",{onClick:()=>y(f-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),d.jsxs("span",{className:"text-xl font-bold text-gray-900",children:[f,"년"]}),d.jsx("button",{onClick:()=>y(f+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),d.jsx("div",{className:"p-4",children:d.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(F=>{const Z=b===F-1,R=P().year()===f&&P().month()===F-1;return d.jsxs("button",{onClick:()=>D(F-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Z?"bg-gray-900 text-white":R?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[F,"월"]},F)})})}),d.jsxs("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[d.jsx("button",{onClick:()=>{qt(new Date),p(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"오늘"}),d.jsx("button",{onClick:X,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:"확인"})]})]})})]})},ea=()=>null,ta=w.useMemo(()=>({toolbar:Qs,event:Br,month:{dateHeader:Hr,showMore:ea}}),[Hr,Br]),qr=z.useMemo(()=>{if(!I)return[];let r;if(ue)r=be.filter(p=>P(p.start).isSame(I,"day"));else{const p=P(I).startOf("week"),f=P(I).endOf("week");r=be.filter(y=>{const b=P(y.start);return b.isSameOrAfter(p,"day")&&b.isSameOrBefore(f,"day")})}const l=[...r].sort((p,f)=>{const y=p.assignedTo&&p.assignedTo.includes("HV LAB"),b=p.assignedTo&&p.assignedTo.includes("현장팀")&&S&&["재천","민기"].includes(S),D=p.assignedTo&&p.assignedTo.includes("디자인팀")&&S&&["신애","재성","재현"].includes(S),C=p.assignedTo&&S&&p.assignedTo.includes(S)||p.assignedTo&&(g==null?void 0:g.name)&&p.assignedTo.includes(g.name)||y||b||D,k=f.assignedTo&&f.assignedTo.includes("HV LAB"),X=f.assignedTo&&f.assignedTo.includes("현장팀")&&S&&["재천","민기"].includes(S),F=f.assignedTo&&f.assignedTo.includes("디자인팀")&&S&&["신애","재성","재현"].includes(S),Z=f.assignedTo&&S&&f.assignedTo.includes(S)||f.assignedTo&&(g==null?void 0:g.name)&&f.assignedTo.includes(g.name)||k||X||F;return C&&!Z?-1:!C&&Z?1:new Date(p.start).getTime()-new Date(f.start).getTime()});return console.log("Sorted events:",l.map(p=>({title:p.title,assignedTo:p.assignedTo,user:g==null?void 0:g.name,userShort:S}))),l},[I,be,g,S,ue]);return w.useEffect(()=>{const l=setTimeout(()=>{const p=ue?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),f=document.querySelectorAll(".rbc-month-row"),y=[];f.forEach((N,G)=>{const te=N.querySelectorAll(".rbc-date-cell");let W=0;te.forEach(Y=>{const J=Y.querySelector("button");let H=J==null?void 0:J.textContent;if(!H){const De=Y.querySelector("span");H=De==null?void 0:De.textContent}if(H&&!isNaN(parseInt(H))){const De=P(ce).date(parseInt(H)),We=be.filter(rr=>P(rr.start).isSame(De,"day"));W=Math.max(W,We.length)}}),y.push(W)});const b=T&&T!=="all",D=100,C=b?60:18,k=25,X=Math.floor((D-k)/C),F=y.length,Z=D*F,R=y.map(N=>N<=X?D:k+N*C+10),O=R.reduce((N,G)=>N+G,0);if(O>Z){const N=R.map((W,Y)=>({index:Y,height:W,overflow:W>D})),G=N.filter(W=>W.overflow).reduce((W,Y)=>W+(Y.height-D),0),te=N.filter(W=>!W.overflow);if(te.length>0){const W=Z-G-te.length*D,Y=Math.max(50,D+W/te.length);f.forEach((J,H)=>{const We=R[H]>D?R[H]:Y;J.style.height=`${We}px`,J.style.minHeight=`${We}px`})}else{const W=Z/O;f.forEach((Y,J)=>{const H=Math.max(80,R[J]*W);Y.style.height=`${H}px`,Y.style.minHeight=`${H}px`})}}else{const N=R.reduce((Y,J)=>Y+(J>D?J:0),0),G=R.filter(Y=>Y<=D).length,te=Z-N,W=G>0?te/G:D;f.forEach((Y,J)=>{const H=R[J]>D?R[J]:W;Y.style.height=`${H}px`,Y.style.minHeight=`${H}px`})}p.forEach(N=>{const G=N.querySelector("button");let te=G==null?void 0:G.textContent;if(!te){const H=N.querySelector("span");te=H==null?void 0:H.textContent}if(!te||isNaN(parseInt(te)))return;const W=P(ce).date(parseInt(te)),Y=be.filter(H=>P(H.start).isSame(W,"day"));Y.length>0?N.setAttribute("data-event-count",Y.length.toString()):N.removeAttribute("data-event-count");const J=W.clone().toDate();if(I&&P(J).isSame(I,"day")?N.classList.add("selected-date"):N.classList.remove("selected-date"),ue){const H=N,De=H._mobileClickHandler;De&&N.removeEventListener("click",De);const We=rr=>{if(rr.target.closest(".rbc-event"))return;const ra=W.clone().toDate();st(ra);const Vr=document.querySelector(".md\\:hidden.mt-3.bg-white");Vr&&Vr.scrollIntoView({behavior:"smooth",block:"nearest"})};H._mobileClickHandler=We,N.addEventListener("click",We,!0),N.style.cursor="pointer",N.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(l),ue&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(f=>{const y=f,b=y._mobileClickHandler;b&&(f.removeEventListener("click",b),delete y._mobileClickHandler)})}},[be,ce,ue,I,T]),d.jsxs("div",{className:"schedule-container space-y-3 md:space-y-2",children:[ae.date&&d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:d.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[d.jsx("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:P(ae.date).format("MM월 DD일")}),d.jsx("select",{value:ae.projectId,onChange:r=>wt({...ae,projectId:r.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:_.filter(r=>r.status!=="completed").map(r=>d.jsx("option",{value:r.id,children:r.name},r.id))}),d.jsx("input",{type:"text",value:ae.title,onChange:r=>wt({...ae,title:r.target.value}),onKeyPress:r=>{r.key==="Enter"&&Yr()},placeholder:"일정 제목을 입력하세요...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:Yr,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:"저장"}),d.jsx("button",{onClick:()=>{wt({date:null,projectId:"",title:""}),st(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:"취소"})]})]})}),d.jsxs("div",{className:"schedule-main flex flex-col md:block",children:[d.jsxs("div",{className:"flex gap-3",children:[T!=="all"&&!ue&&d.jsx("div",{className:"hidden md:block flex-shrink-0 print-hide",children:d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[d.jsxs("button",{onClick:()=>se(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"공정 관리"]}),Ke&&d.jsxs("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[d.jsx("span",{className:"font-medium",children:Ke})," 선택됨",d.jsx("br",{}),d.jsx("span",{className:"text-blue-600",children:"날짜를 탭하세요"})]}),d.jsx("div",{className:"flex flex-col gap-0.5",children:Tr.map(r=>d.jsx("div",{draggable:!0,onClick:()=>{yt(Ke===r?null:r)},onDragStart:l=>{xt.current=!1,yt(null),Ut(r),at.current=r,l.dataTransfer.setData("text/plain",r),l.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{xt.current||(Ut(null),at.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${Ke===r?"bg-blue-500 text-white ring-2 ring-blue-300":Ie===r?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:r},r))})]})}),d.jsx("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${T!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:d.jsx(Pi,{localizer:Ni,events:be,startAccessor:"start",endAccessor:"end",view:Ar,onView:Rs,date:ce,onNavigate:qt,onSelectEvent:zr,onSelectSlot:Xs,onEventDrop:T!=="all"?qs:void 0,onDragStart:T!=="all"?Vs:void 0,onDropFromOutside:T!=="all"?Ks:void 0,dragFromOutsideItem:T!=="all"?Us:void 0,draggableAccessor:r=>T!=="all"&&r.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:Gs,dayPropGetter:Zs,components:ta,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"오늘",previous:"이전",next:"다음",month:"월",week:"주",day:"일",agenda:"일정목록",date:"날짜",time:"시간",event:"일정",noEventsInRange:"이 기간에 일정이 없습니다",showMore:r=>`+${r} 더보기`}},`calendar-${T}-${(I==null?void 0:I.getTime())||"no-selection"}`)})]}),I&&d.jsxs("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-900",children:ue?P(I).format("MM월 DD일 (ddd)"):`${P(I).startOf("week").format("MM월 DD일")} - ${P(I).endOf("week").format("MM월 DD일")}`}),dt[P(I).format("YYYY-MM-DD")]&&d.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:dt[P(I).format("YYYY-MM-DD")]})]}),d.jsx("div",{className:"flex items-center gap-1",children:d.jsx("button",{onClick:()=>{st(null),Ys(!1),Dt(null)},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:d.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),d.jsx("div",{children:qr.length===0?d.jsx("div",{className:"p-4 text-center",children:d.jsx("p",{className:"text-sm text-gray-500",children:"일정이 없습니다"})}):d.jsx("div",{children:(()=>{const r=qr.reduce((p,f)=>{const y=P(f.start).format("YYYY-MM-DD");return p[y]||(p[y]=[]),p[y].push(f),p},{});return Object.keys(r).sort().map(p=>d.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[!ue&&d.jsx("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:d.jsx("p",{className:"text-xs font-semibold text-gray-700",children:P(p).format("MM월 DD일 (ddd)")})}),d.jsx("div",{className:"divide-y divide-gray-100",children:r[p].map(f=>{const y=f.assignedTo&&f.assignedTo.includes("HV LAB"),b=f.assignedTo&&f.assignedTo.includes("현장팀")&&S&&["재천","민기"].includes(S),D=f.assignedTo&&f.assignedTo.includes("디자인팀")&&S&&["신애","재성","재현"].includes(S),k=f.assignedTo&&(f.assignedTo.includes((g==null?void 0:g.name)||"")||S&&f.assignedTo.includes(S))||y||b||D,X=!f.color&&!k,F=(Gt==null?void 0:Gt.id)===f.id,Z=!f.isASVisit&&!f.isExpectedPayment;return d.jsx("div",{onClick:()=>{if(F)return;const R={...f,title:f.originalTitle||f.title};zr(R)},className:`p-3 cursor-pointer ${F?"bg-red-50":k?"bg-yellow-50":""}`,style:X&&!F?{backgroundColor:"#f3f0f5"}:void 0,children:F?d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("p",{className:"text-sm text-red-600 font-medium truncate flex-1",children:"삭제?"}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:R=>{R.stopPropagation(),Dt(null)},className:"px-3 py-1 text-xs font-medium text-gray-600 bg-gray-100 rounded-lg active:bg-gray-200",children:"취소"}),d.jsx("button",{onClick:async R=>{R.stopPropagation();try{await u(f.id),L.success("삭제됨")}catch(O){console.error("일정 삭제 실패:",O),L.error("삭제 실패")}Dt(null)},className:"px-3 py-1 text-xs font-medium text-white bg-red-500 rounded-lg active:bg-red-600",children:"확인"})]})]}):d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:k?"#FEF3C7":f.color||"#e8e2ea",minHeight:"28px"}}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:f.title}),f.assignedTo&&f.assignedTo.length>0&&d.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["신애","재성","재현"].every(N=>f.assignedTo.includes(N))?"디자인팀":f.assignedTo.join(", ")})]}),f.projectName&&T==="all"&&d.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:f.projectName})]}),Z&&T!=="all"&&d.jsx("button",{onClick:R=>{R.stopPropagation(),Dt(f)},className:"p-1 flex-shrink-0 text-gray-300 hover:text-red-400 active:text-red-500 transition-colors",children:d.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},f.id)})})]},p))})()})}),ue&&T!=="all"&&d.jsxs("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[d.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"공정을 탭하여 일정 추가"}),d.jsx("div",{className:"flex flex-wrap gap-1.5",children:Tr.map(r=>d.jsx("button",{onClick:()=>{const l=I||new Date;if(T!=="all"){const p="temp_"+Date.now().toString()+Math.random().toString(36).substr(2,9),f={id:p,title:r,start:l,end:l,project:T,attendees:g!=null&&g.name?[g.name]:[],type:"construction"};t(f),o(f).then(()=>{n(p)}).catch(y=>{console.error("일정 추가 실패:",y),n(p)})}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:r},r))})]})]})]}),Ws&&d.jsx(ma,{event:q,slotInfo:zs,defaultProjectName:T!=="all"?T:void 0,onClose:()=>{$e(!1),ht(null),vt(null)},onSave:async r=>{console.log("📤 Schedule.tsx onSave called with newEvent:",r);try{if(q)if(q.id.startsWith("as-")){const l=q.id.replace("as-","");let p="";r.assignedTo&&Array.isArray(r.assignedTo)&&r.assignedTo.length>0?p=r.assignedTo.join(", "):q.assignedTo&&Array.isArray(q.assignedTo)?p=q.assignedTo.join(", "):typeof q.assignedTo=="string"&&(p=q.assignedTo),await m(l,{project:r.title||q.title,assignedTo:p,scheduledVisitDate:r.start,scheduledVisitTime:r.time||q.time}),await h(),$e(!1)}else if(q.id.startsWith("payment-")){const l=q.id.split("-"),p=l[1],f=l[2],y=v.find(b=>b.id===p);if(y){const b={...y.expectedPaymentDates};b[f]=r.start,await x(p,{expectedPaymentDates:b})}}else{console.log("📤 Updating schedule with projectId:",r.projectId,"projectName:",r.projectName);let l=r.title;const p=/ - (오전|오후) \d{1,2}시( \d{1,2}분)?$/;if(l=l.replace(p,""),q.mergedEventIds&&q.mergedEventIds.length>0){console.log("📤 Updating merged schedules:",q.mergedEventIds);const f=(q.originalTitle||q.title).split(", "),y=l.split(", ");for(let b=0;b<q.mergedEventIds.length;b++){const D=q.mergedEventIds[b],C=y[b]||f[b]||l;await i(D,{title:C.trim(),start:r.start,end:r.end,type:"other",project:r.projectId||r.projectName,location:"",attendees:r.assignedTo||[],description:r.description,time:r.time})}}else await i(q.id,{title:l,start:r.start,end:r.end,type:"other",project:r.projectId||r.projectName,location:"",attendees:r.assignedTo||[],description:r.description,time:r.time});await a()}else{console.log("📤 Adding schedule with projectId:",r.projectId,"projectName:",r.projectName);const l={id:Date.now().toString(),title:r.title,start:r.start,end:r.end,type:"other",project:r.projectId||r.projectName||"",location:"",attendees:r.assignedTo||[],description:r.description||"",time:r.time||"-"};await o(l)}$e(!1)}catch(l){console.error("Failed to save schedule:",l),L.error("일정 저장에 실패했습니다")}},onDelete:async r=>{try{if(r.startsWith("payment-")){const l=r.split("-"),p=l[1],f=l[2],y=v.find(b=>b.id===p);if(y){const b={...y.expectedPaymentDates};delete b[f],await x(p,{expectedPaymentDates:b})}}else if(r.startsWith("as-")){const l=r.replace("as-","");await m(l,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const l=Kt.find(p=>p.id===r);if(l!=null&&l.mergedEventIds&&l.mergedEventIds.length>0){console.log("Deleting merged schedules:",l.mergedEventIds);for(const p of l.mergedEventIds)await u(p)}else await u(r)}$e(!1)}catch(l){console.error("Failed to delete schedule:",l),L.error("일정 삭제에 실패했습니다")}}}),Ue&&Bs&&d.jsx("div",{className:"fixed pointer-events-none z-[9999]",style:{left:Or.x-50,top:Or.y-15,backgroundColor:Ue.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:Ue.originalTitle||Ue.title}),re&&d.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{se(!1),E(null),oe("")},children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:r=>r.stopPropagation(),children:[d.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[d.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"공정 관리"}),d.jsx("button",{onClick:()=>{se(!1),E(null),oe("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:"✕"})]}),d.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[d.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"새 공정 추가"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:fe,onChange:r=>oe(r.target.value),onKeyDown:r=>r.key==="Enter"&&Cr(),placeholder:"공정명 입력",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"}),d.jsx("button",{onClick:Cr,disabled:!fe.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"추가"})]})]}),d.jsx("div",{className:"overflow-y-auto max-h-[50vh]",children:gt?d.jsxs("div",{className:"p-8 text-center text-gray-500",children:[d.jsx("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"}),d.jsx("p",{children:"불러오는 중..."})]}):V.length===0?d.jsxs("div",{className:"p-8 text-center text-gray-400",children:[d.jsx("p",{className:"mb-2",children:"등록된 공정이 없습니다"}),d.jsx("p",{className:"text-xs",children:"위에서 새 공정을 추가해주세요"})]}):d.jsx("div",{className:"divide-y divide-gray-50",children:V.map((r,l)=>d.jsx("div",{draggable:(K==null?void 0:K.id)!==r.id,onDragStart:()=>Ps(l),onDragOver:p=>As(p,l),onDragEnd:Ns,onDragLeave:()=>Bt(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${le===l?"opacity-50 bg-gray-100":""} ${mt===l?"border-t-2 border-gray-400":""} ${(K==null?void 0:K.id)!==r.id?"cursor-grab active:cursor-grabbing":""}`,children:(K==null?void 0:K.id)===r.id?d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",value:pe,onChange:p=>ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&kr(),p.key==="Escape"&&(E(null),ie(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0}),d.jsx("button",{onClick:kr,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:"저장"}),d.jsx("button",{onClick:()=>{E(null),ie("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:"취소"})]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-gray-300 text-xs select-none",children:"☰"}),d.jsx("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:l+1}),d.jsx("span",{className:"flex-1 text-sm text-gray-700 select-none",children:r.name}),d.jsx("button",{onClick:()=>{E(r),ie(r.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"수정"}),d.jsx("button",{onClick:()=>ks(r.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"삭제"})]})},r.id))})}),V.length>0&&d.jsx("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"드래그하여 순서 변경 · 호버하여 수정/삭제"})]})})]})};export{Gi as default};
