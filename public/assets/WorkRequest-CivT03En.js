import{j as e}from"./vendor-data-DG_4MGb7.js";import{r as x}from"./vendor-react-D-r2Cqeg.js";import{d as M,b as re,T as ae}from"./vendor-ui-DTwhhNuH.js";import{u as ue,w,z as g,l as $}from"./index-Dgd7wCS1.js";import{u as pe}from"./dataStore-D-kob-RA.js";import{u as xe}from"./useFilteredProjects-BNZe-7y5.js";import{p as m}from"./vendor-date-9Cl9d1sr.js";const N=["상준","신애","재천","민기","재성","재현","안팀","디자인팀","현장팀"],we=()=>{const{addScheduleToAPI:oe,deleteScheduleFromAPI:L,updateScheduleInAPI:le,schedules:R,fetchSchedules:ne}=pe(),{user:n}=ue(),j=xe(),[h,v]=x.useState([]),[k,ie]=x.useState(""),[D,W]=x.useState("pending"),[i,T]=x.useState(null),[d,E]=x.useState(null),B=x.useRef(null),[a,p]=x.useState({project:"",requestType:"",description:"",requestDate:m(new Date,"yyyy-MM-dd"),dueDate:m(new Date(Date.now()+3*24*60*60*1e3),"yyyy-MM-dd"),requestedBy:(n==null?void 0:n.name)||"",assignedTo:""}),[_,A]=x.useState(""),[y,z]=x.useState(null),[I,H]=x.useState(!1),[q,O]=x.useState(!1);x.useEffect(()=>{U()},[]),x.useEffect(()=>{n!=null&&n.name&&p(t=>{const r={};return t.requestedBy||(r.requestedBy=n.name),n.name==="안팀"&&!t.project&&j.length>0&&(r.project=j[0].name),{...t,...r}})},[n,j]);const U=async()=>{try{const r=(await w.getAllWorkRequests()).map(s=>({id:s._id,project:s.project,requestType:s.requestType,description:s.description,requestDate:new Date(s.requestDate),dueDate:new Date(s.dueDate),requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status,priority:s.priority,notes:s.notes,completedDate:s.completedDate?new Date(s.completedDate):void 0}));v(r)}catch(t){console.error("Failed to load work requests:",t),g.error("업무요청을 불러오는데 실패했습니다")}};x.useEffect(()=>{var t,r;i&&B.current&&((r=(t=B.current).showPicker)==null||r.call(t))},[i]),x.useEffect(()=>{const t=()=>{d&&E(null)};if(d)return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[d]),x.useEffect(()=>{const t=()=>{H(r=>{const s=!r;return window.dispatchEvent(new CustomEvent("mobileFormStateChange",{detail:{isOpen:s}})),s})};return window.addEventListener("headerAddButtonClick",t),()=>window.removeEventListener("headerAddButtonClick",t)},[]),x.useEffect(()=>{window.dispatchEvent(new CustomEvent("mobileFormStateChange",{detail:{isOpen:I}}))},[I]);const V=async(t,r)=>{if(window.confirm(`"${r}" 업무요청을 삭제하시겠습니까?

삭제된 내역은 복구할 수 없습니다.`))try{const s=h.find(l=>l.id===t);if(await w.deleteWorkRequest(t),v(h.filter(l=>l.id!==t)),g.success("업무요청이 삭제되었습니다"),s)try{let l="";s.project?l=s.requestType?`[업무요청] ${s.requestType}`:`[업무요청] ${s.description.substring(0,20)}`:l=s.description;const c=R.filter(u=>{const o=u.start&&new Date(u.start).toDateString()===s.dueDate.toDateString(),f=u.title===l;return o&&f});for(const u of c)try{await L(u.id)}catch(o){console.error("Failed to delete related schedule:",o)}await ne()}catch(l){console.error("Failed to handle related schedules:",l)}}catch(s){console.error("Failed to delete work request:",s),g.error("업무요청 삭제에 실패했습니다"),await U()}},G=t=>{z(t),p({project:t.project,requestType:t.requestType,description:t.description,requestDate:m(t.requestDate,"yyyy-MM-dd"),dueDate:m(t.dueDate,"yyyy-MM-dd"),requestedBy:t.requestedBy,assignedTo:t.assignedTo}),H(!0)},P=()=>{z(null),p({project:"",requestType:"",description:"",requestDate:m(new Date,"yyyy-MM-dd"),dueDate:m(new Date(Date.now()+3*24*60*60*1e3),"yyyy-MM-dd"),requestedBy:(n==null?void 0:n.name)||"",assignedTo:""}),setIsUrgent(!1),A("")},J=async t=>{if(t.preventDefault(),!q){if(!a.requestedBy||!a.assignedTo||!a.requestDate||!a.dueDate){g.error("필수 항목을 모두 입력하세요");return}O(!0);try{const r=a.requestType==="직접입력"?_:a.requestType;if(y){const s=await w.updateWorkRequest(y.id,{project:a.project,requestType:r,description:a.description,requestDate:new Date(a.requestDate),dueDate:new Date(a.dueDate),requestedBy:a.requestedBy,assignedTo:a.assignedTo,status:y.status,priority:"medium"}),l={id:s._id,project:s.project,requestType:s.requestType,description:s.description,requestDate:new Date(s.requestDate),dueDate:new Date(s.dueDate),requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status,priority:s.priority,notes:s.notes,completedDate:s.completedDate?new Date(s.completedDate):void 0};let c="";s.project?c=s.requestType?`[업무요청] ${s.requestType}`:`[업무요청] ${s.description.substring(0,20)}`:c=s.description;const u=R.find(o=>{const f=o.start&&new Date(o.start).toDateString()===new Date(s.dueDate).toDateString(),F=o.title===c;return f&&F});if(u)try{let o=null,f="";if(s.project){const se=j.find(ce=>ce.name===s.project);o=se?se.id:u.project,f=s.requestType?`[업무요청] ${s.requestType}`:`[업무요청] ${s.description.substring(0,20)}`}else f=s.description,o=u.project;const F=s.assignedTo==="디자인팀"?["신애","재성","재현"]:[s.assignedTo];await le(u.id,{title:f,start:new Date(s.dueDate),end:new Date(s.dueDate),project:o,attendees:F,description:`${s.description}

담당자: ${s.assignedTo}
요청자: ${s.requestedBy}
우선순위: ${s.priority}
${s.notes||""}`})}catch(o){console.error("Failed to update related schedule:",o)}v(h.map(o=>o.id===y.id?l:o)),g.success("업무요청이 수정되었습니다")}else{const s=await w.createWorkRequest({project:a.project,requestType:r,description:a.description||"",requestDate:new Date(a.requestDate),dueDate:new Date(a.dueDate),requestedBy:a.requestedBy,assignedTo:a.assignedTo,status:"pending",priority:"medium"}),l={id:s._id,project:s.project,requestType:s.requestType,description:s.description,requestDate:new Date(s.requestDate),dueDate:new Date(s.dueDate),requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status,priority:s.priority,notes:s.notes,completedDate:s.completedDate?new Date(s.completedDate):void 0};try{let c=null,u="";if(s.project){const f=j.find(F=>F.name===s.project);if(c=f?f.id:null,!c)throw console.warn("Project not found for work request:",s.project),new Error("Project not found");u=s.requestType?`[업무요청] ${s.requestType}`:`[업무요청] ${s.description.substring(0,20)}`}else u=s.description;const o=s.assignedTo==="디자인팀"?["신애","재성","재현"]:[s.assignedTo];await oe({id:`workrequest-${s._id}`,title:u,start:new Date(s.dueDate),end:new Date(s.dueDate),type:"other",project:c,location:"",attendees:o,description:`${s.description}

담당자: ${s.assignedTo}
요청자: ${s.requestedBy}
우선순위: ${s.priority}
${s.notes||""}`})}catch(c){console.error("Failed to create schedule:",c)}v([l,...h]),g.success("업무요청이 추가되었습니다")}P()}catch(r){console.error("Failed to save work request:",r),g.error("업무요청 저장에 실패했습니다")}finally{O(!1)}}},K=(t,r)=>{T({requestId:t,field:r})},Q=async t=>{if(!i)return;const r=new Date(t);if(!isNaN(r.getTime()))try{if(!h.find(l=>l.id===i.requestId))return;await w.updateWorkRequest(i.requestId,{[i.field]:r}),v(h.map(l=>l.id===i.requestId?{...l,[i.field]:r}:l)),T(null),g.success("날짜가 수정되었습니다")}catch(s){console.error("Failed to update date:",s),g.error("날짜 수정에 실패했습니다"),T(null)}},X=(t,r)=>{E({requestId:t,field:r})},Y=async t=>{if(d)try{await w.updateWorkRequest(d.requestId,{[d.field]:t}),v(h.map(r=>r.id===d.requestId?{...r,[d.field]:t}:r)),E(null),g.success("담당자가 수정되었습니다")}catch(r){console.error("Failed to update person:",r),g.error("담당자 수정에 실패했습니다"),E(null)}},S=async(t,r)=>{try{const s=r==="completed"?new Date:void 0;if(await w.updateWorkRequest(t,{status:r,completedDate:s}),v(h.map(c=>c.id===t?{...c,status:r,completedDate:s}:c)),r==="completed"){const c=h.find(u=>u.id===t);if(c){const u=R.find(o=>o.id===`workrequest-${t}`||o.title.includes("[업무요청]")&&o.project===c.project);if(u)try{await L(u.id)}catch(o){console.error("Failed to delete related schedule:",o)}}}const l={pending:"대기","in-progress":"진행중",completed:"완료"};g.success(`상태가 ${l[r]}로 변경되었습니다`)}catch(s){console.error("Failed to update status:",s),g.error("상태 변경에 실패했습니다")}},Z=t=>{const s={pending:{label:"대기",color:"bg-gray-100 text-gray-700 border-gray-300"},"in-progress":{label:"진행중",color:"bg-gray-100 text-gray-800 border-gray-300"},completed:{label:"완료",color:"bg-gray-900 text-white border-gray-900"},cancelled:{label:"취소",color:"bg-gray-100 text-gray-500 border-gray-300"}}[t];return e.jsx("span",{className:`px-3 py-1 text-xs font-medium border ${s.color}`,children:s.label})},de=t=>{const r=new Date;r.setHours(0,0,0,0);const s=new Date(t);s.setHours(0,0,0,0);const l=s.getTime()-r.getTime();return Math.ceil(l/(1e3*60*60*24))},ee=t=>{const r=de(t);return r<0?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gray-100 text-gray-700 border border-gray-300 rounded",children:["D+",Math.abs(r)]}):r===0?e.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gray-900 text-white border border-gray-900 rounded",children:"D-Day"}):r<=3?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gray-100 text-gray-700 border border-gray-300 rounded",children:["D-",r]}):r<=7?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-bold bg-gray-100 text-gray-700 border border-gray-300 rounded",children:["D-",r]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 border border-gray-300 rounded",children:["D-",r]})},C=(n==null?void 0:n.name)==="안팀"?h.filter(t=>j.some(r=>r.name===t.project)):h,te=(()=>{let t=C;return D!=="all"&&(t=t.filter(r=>r.status===D)),k&&(t=t.filter(r=>r.project.toLowerCase().includes(k.toLowerCase())||r.requestType.toLowerCase().includes(k.toLowerCase())||r.description.toLowerCase().includes(k.toLowerCase()))),t})(),b={pending:C.filter(t=>t.status==="pending").length,inProgress:C.filter(t=>t.status==="in-progress").length,completed:C.filter(t=>t.status==="completed").length,total:C.length};return e.jsxs("div",{className:"workrequest-container space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"workrequest-desktop hidden md:grid md:grid-cols-[400px_1fr] gap-4",children:[e.jsxs("div",{className:"workrequest-form bg-white border border-gray-200 rounded-lg p-6 h-fit sticky top-4",children:[y&&e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"업무요청 수정"}),e.jsxs("form",{onSubmit:J,className:"workrequest-form-inner space-y-4",children:[e.jsxs("div",{className:"wr-project",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"프로젝트"}),e.jsxs("select",{value:a.project,onChange:t=>p({...a,project:t.target.value}),className:"input w-full",children:[(n==null?void 0:n.name)!=="안팀"&&e.jsx("option",{value:"",children:"선택하세요"}),j.filter(t=>t.status!=="completed").map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{className:"wr-type",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"요청유형"}),e.jsxs("select",{value:a.requestType,onChange:t=>p({...a,requestType:t.target.value}),className:"input w-full",children:[e.jsx("option",{value:""}),e.jsx("option",{value:"3D모델링",children:"3D모델링"}),e.jsx("option",{value:"철거도면",children:"철거도면"}),e.jsx("option",{value:"설비도면",children:"설비도면"}),e.jsx("option",{value:"에어컨 배치도",children:"에어컨 배치도"}),e.jsx("option",{value:"디퓨저 배치도",children:"디퓨저 배치도"}),e.jsx("option",{value:"스프링클러 배치도",children:"스프링클러 배치도"}),e.jsx("option",{value:"전기도면",children:"전기도면"}),e.jsx("option",{value:"목공도면",children:"목공도면"}),e.jsx("option",{value:"디테일도면",children:"디테일도면"}),e.jsx("option",{value:"금속도면",children:"금속도면"}),e.jsx("option",{value:"가구도면",children:"가구도면"}),e.jsx("option",{value:"세라믹도면",children:"세라믹도면"}),e.jsx("option",{value:"트렌치유가",children:"트렌치유가"}),e.jsx("option",{value:"욕실장",children:"욕실장"}),e.jsx("option",{value:"발주",children:"발주"}),e.jsx("option",{value:"마감",children:"마감"}),e.jsx("option",{value:"직접입력",children:"직접입력"})]}),a.requestType==="직접입력"&&e.jsx("input",{type:"text",value:_,onChange:t=>A(t.target.value),placeholder:"요청유형을 직접 입력하세요",className:"input w-full mt-2"})]}),e.jsxs("div",{className:"wr-description",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"요청내용"}),e.jsx("textarea",{value:a.description,onChange:t=>p({...a,description:t.target.value}),rows:4,className:"input w-full",placeholder:"상세한 요청 내용을 입력하세요"})]}),e.jsxs("div",{className:"wr-dates grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"요청일 *"}),e.jsx("input",{type:"date",value:a.requestDate,onChange:t=>p({...a,requestDate:t.target.value}),required:!0,className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"마감일 *"}),e.jsx("input",{type:"date",value:a.dueDate,onChange:t=>p({...a,dueDate:t.target.value}),required:!0,className:"input w-full"})]})]}),e.jsxs("div",{className:"wr-people grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"요청자 *"}),e.jsxs("select",{value:a.requestedBy,onChange:t=>p({...a,requestedBy:t.target.value}),required:!0,className:"input w-full",children:[e.jsx("option",{value:"",children:"선택하세요"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"담당자 *"}),e.jsxs("select",{value:a.assignedTo,onChange:t=>p({...a,assignedTo:t.target.value}),required:!0,className:"input w-full",children:[e.jsx("option",{value:"",children:"선택하세요"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"wr-actions flex gap-3 pt-4 border-t",children:[y&&e.jsx("button",{type:"button",onClick:P,className:"flex-1 btn btn-outline",children:"취소"}),e.jsx("button",{type:"submit",disabled:q,className:"flex-1 btn btn-primary disabled:opacity-50",children:q?"저장 중...":y?"수정":"추가"})]})]})]}),e.jsxs("div",{className:"workrequest-list space-y-4",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"pending",label:"대기",count:b.pending,color:"text-gray-700"},{id:"in-progress",label:"진행중",count:b.inProgress,color:"text-gray-700"},{id:"completed",label:"완료",count:b.completed,color:"text-gray-700"},{id:"all",label:"전체",count:b.total,color:"text-gray-600"}].map(t=>e.jsxs("button",{onClick:()=>W(t.id),className:M("py-4 px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap",D===t.id?`border-gray-700 ${t.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[t.label,t.count>0&&e.jsx("span",{className:M("ml-2 py-0.5 px-2 rounded-full text-xs font-semibold",D===t.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:t.count})]},t.id))})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("input",{type:"text",placeholder:"검색...",value:k,onChange:t=>ie(t.target.value),className:"flex-1 px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:border-gray-900"})}),e.jsx("div",{className:"bg-white border border-gray-200 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"프로젝트"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청유형"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"내용"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청자"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"담당자"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청일"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"마감일"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"D-day"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"액션"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",style:{overflow:"visible"},children:te.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 ${t.priority==="high"?"bg-rose-50/30":""}`,style:{overflow:"visible"},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"font-medium text-gray-900",children:t.project})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"text-sm text-gray-900",children:t.requestType})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-900",children:t.description})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{overflow:"visible"},children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),X(t.id,"requestedBy")},className:"text-sm text-gray-900 hover:text-gray-600 hover:underline transition-colors",children:t.requestedBy}),(d==null?void 0:d.requestId)===t.id&&(d==null?void 0:d.field)==="requestedBy"&&e.jsx("div",{onClick:r=>r.stopPropagation(),className:"absolute left-0 top-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[100px]",children:N.map(r=>e.jsx("button",{onClick:()=>Y(r),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 transition-colors first:rounded-t-lg last:rounded-b-lg ${r===t.requestedBy?"bg-gray-50 font-medium":""}`,children:r},r))})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{overflow:"visible"},children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),X(t.id,"assignedTo")},className:"text-sm text-gray-900 hover:text-gray-600 hover:underline transition-colors",children:t.assignedTo}),(d==null?void 0:d.requestId)===t.id&&(d==null?void 0:d.field)==="assignedTo"&&e.jsx("div",{onClick:r=>r.stopPropagation(),className:"absolute left-0 top-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 min-w-[100px]",children:N.map(r=>e.jsx("button",{onClick:()=>Y(r),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 transition-colors first:rounded-t-lg last:rounded-b-lg ${r===t.assignedTo?"bg-gray-50 font-medium":""}`,children:r},r))})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"relative inline-block",children:[(i==null?void 0:i.requestId)===t.id&&(i==null?void 0:i.field)==="requestDate"&&e.jsx("input",{ref:B,type:"date",defaultValue:m(t.requestDate,"yyyy-MM-dd"),onChange:r=>Q(r.target.value),onBlur:()=>T(null),className:"absolute left-0 top-0 w-auto h-auto opacity-0 z-50",style:{pointerEvents:"auto"}}),e.jsxs("button",{onClick:()=>K(t.id,"requestDate"),className:"flex items-center space-x-2 text-sm text-gray-900 hover:text-gray-600 transition-colors",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:m(t.requestDate,"yyyy.MM.dd (eee)",{locale:$})})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"relative inline-block",children:[(i==null?void 0:i.requestId)===t.id&&(i==null?void 0:i.field)==="dueDate"&&e.jsx("input",{ref:B,type:"date",defaultValue:m(t.dueDate,"yyyy-MM-dd"),onChange:r=>Q(r.target.value),onBlur:()=>T(null),className:"absolute left-0 top-0 w-auto h-auto opacity-0 z-50",style:{pointerEvents:"auto"}}),e.jsxs("button",{onClick:()=>K(t.id,"dueDate"),className:"flex items-center space-x-2 text-sm text-gray-900 hover:text-gray-600 transition-colors",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:m(t.dueDate,"yyyy.MM.dd (eee)",{locale:$})})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ee(t.dueDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z(t.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>S(t.id,"in-progress"),className:"px-3 py-1 text-xs font-semibold text-white rounded-lg transition-colors bg-gray-900 hover:bg-gray-800",children:"수락"}),t.status==="in-progress"&&e.jsx("button",{onClick:()=>S(t.id,"completed"),className:"px-3 py-1 text-xs font-semibold bg-gray-900 text-white rounded hover:bg-gray-800 transition-colors",children:"완료"}),e.jsx("button",{onClick:()=>G(t),className:"text-xs text-gray-600 hover:text-gray-900",children:"수정"}),e.jsx("button",{onClick:()=>V(t.id,t.project),className:"text-gray-600 hover:text-gray-700",children:e.jsx(ae,{className:"h-4 w-4"})})]})})]},t.id))})]})})]})]}),e.jsxs("div",{className:"workrequest-mobile md:hidden space-y-3",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-4 overflow-x-auto",children:[{id:"pending",label:"대기",count:b.pending,color:"text-gray-700"},{id:"in-progress",label:"진행중",count:b.inProgress,color:"text-gray-700"},{id:"completed",label:"완료",count:b.completed,color:"text-gray-700"},{id:"all",label:"전체",count:b.total,color:"text-gray-600"}].map(t=>e.jsxs("button",{onClick:()=>W(t.id),className:M("py-3 px-1 border-b-2 font-medium text-xs transition-colors whitespace-nowrap",D===t.id?`border-gray-700 ${t.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[t.label,t.count>0&&e.jsx("span",{className:M("ml-1 py-0.5 px-1.5 rounded-full text-[10px] font-semibold",D===t.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:t.count})]},t.id))})}),I&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[y&&e.jsx("h2",{className:"text-base font-semibold text-gray-900 mb-3",children:"업무요청 수정"}),e.jsxs("form",{onSubmit:J,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"프로젝트"}),e.jsxs("select",{value:a.project,onChange:t=>p({...a,project:t.target.value}),className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(n==null?void 0:n.name)!=="안팀"&&e.jsx("option",{value:"",children:"선택하세요"}),j.filter(t=>t.status!=="completed").map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"요청유형"}),e.jsxs("select",{value:a.requestType,onChange:t=>p({...a,requestType:t.target.value}),className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[e.jsx("option",{value:""}),e.jsx("option",{value:"3D모델링",children:"3D모델링"}),e.jsx("option",{value:"철거도면",children:"철거도면"}),e.jsx("option",{value:"설비도면",children:"설비도면"}),e.jsx("option",{value:"에어컨 배치도",children:"에어컨 배치도"}),e.jsx("option",{value:"디퓨저 배치도",children:"디퓨저 배치도"}),e.jsx("option",{value:"스프링클러 배치도",children:"스프링클러 배치도"}),e.jsx("option",{value:"전기도면",children:"전기도면"}),e.jsx("option",{value:"목공도면",children:"목공도면"}),e.jsx("option",{value:"디테일도면",children:"디테일도면"}),e.jsx("option",{value:"금속도면",children:"금속도면"}),e.jsx("option",{value:"가구도면",children:"가구도면"}),e.jsx("option",{value:"세라믹도면",children:"세라믹도면"}),e.jsx("option",{value:"트렌치유가",children:"트렌치유가"}),e.jsx("option",{value:"욕실장",children:"욕실장"}),e.jsx("option",{value:"발주",children:"발주"}),e.jsx("option",{value:"마감",children:"마감"}),e.jsx("option",{value:"직접입력",children:"직접입력"})]}),a.requestType==="직접입력"&&e.jsx("input",{type:"text",value:_,onChange:t=>A(t.target.value),placeholder:"요청유형을 직접 입력하세요",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 mt-2 hover:border-gray-400 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"요청내용"}),e.jsx("textarea",{value:a.description,onChange:t=>p({...a,description:t.target.value}),rows:3,className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 hover:border-gray-400 transition-colors",placeholder:"상세한 요청 내용을 입력하세요"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"요청일 *"}),e.jsx("input",{type:"date",value:a.requestDate,onChange:t=>p({...a,requestDate:t.target.value}),required:!0,className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"마감일 *"}),e.jsx("input",{type:"date",value:a.dueDate,onChange:t=>p({...a,dueDate:t.target.value}),required:!0,className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"요청자 *"}),e.jsxs("select",{value:a.requestedBy,onChange:t=>p({...a,requestedBy:t.target.value}),required:!0,className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[e.jsx("option",{value:"",children:"선택하세요"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"담당자 *"}),e.jsxs("select",{value:a.assignedTo,onChange:t=>p({...a,assignedTo:t.target.value}),required:!0,className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[e.jsx("option",{value:"",children:"선택하세요"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[y&&e.jsx("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"}),e.jsx("button",{type:"submit",disabled:q,className:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-gray-900 rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:q?"저장 중...":y?"수정":"추가"})]})]})]}),e.jsx("div",{className:"workrequest-cards space-y-3",children:te.map(t=>e.jsxs("div",{className:`card p-3 hover:border-gray-400 transition-colors ${t.priority==="high"?"border-2 border-rose-200 bg-rose-50/30":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Z(t.status),ee(t.dueDate)]}),e.jsx("h3",{className:"font-bold text-base text-gray-900",children:t.project}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:t.requestType})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>G(t),className:"text-xs text-gray-600 hover:text-gray-900 px-2 py-1",children:"수정"}),e.jsx("button",{onClick:()=>V(t.id,t.project),className:"text-gray-600 hover:text-gray-700 p-1",children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm border-t border-gray-100 pt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"요청 내용"}),e.jsx("p",{className:"text-gray-900 mt-0.5",children:t.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"요청자"}),e.jsx("p",{className:"text-gray-900 font-medium mt-0.5",children:t.requestedBy})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"담당자"}),e.jsx("p",{className:"text-gray-900 font-medium mt-0.5",children:t.assignedTo})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"요청일"}),e.jsx("p",{className:"text-xs text-gray-900",children:m(t.requestDate,"MM.dd (eee)",{locale:$})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"마감일"}),e.jsx("p",{className:"text-xs text-gray-900",children:m(t.dueDate,"MM.dd (eee)",{locale:$})})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t border-gray-100",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>S(t.id,"in-progress"),className:"flex-1 px-3 py-2 text-xs font-semibold text-white rounded-lg transition-colors bg-gray-900 hover:bg-gray-800",children:"수락"}),t.status==="in-progress"&&e.jsx("button",{onClick:()=>S(t.id,"completed"),className:"flex-1 px-3 py-2 text-xs font-semibold bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:"완료"}),t.status==="completed"&&e.jsx("div",{className:"flex-1 text-center text-xs text-gray-500 py-2",children:"완료된 업무입니다"})]})]},t.id))})]})]})};export{we as default};
