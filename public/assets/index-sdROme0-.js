const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-C9AaIUcM.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-CN2pzGih.js","assets/AfterService-CpapiY_8.js","assets/AdditionalWork-B1fsWaZD.js","assets/additionalWorkService-t0dwD0Ef.js","assets/ConstructionPayment-B8zXvKql.js","assets/WorkRequest-CV8gfLOX.js","assets/Specbook-CJpBmjaD.js","assets/EstimatePreview-DSybfmhW.js","assets/ExecutionHistory-Iis0Cf-w.js"])))=>i.map(i=>d[i]);
import{r as A,b as yb,u as op,d as bb,N as ap,e as mc,O as Nb,R as it,f as na,B as xb,h as vb,i as En}from"./vendor-react-DN7YJcfR.js";import{a as _b,c as ym,Q as Db,b as kb}from"./vendor-data-DrLf5NIQ.js";import{B as uc,X as xn,C as lp,T as ti,a as Ab,b as cp,W as Eb,c as Vb,d as xs,P as Hi,R as Cb,e as wb,S as mp,f as Sb,g as Ib,h as up,i as Pb,U as Lc,I as Eo,j as Tc,k as Yu,l as Gu,m as Xu,n as Lb,M as Tb,o as jb,p as Rb,L as Bb}from"./vendor-ui-D8A9iq7X.js";import{k as dc,l as mo,m as uo,n as Ub,o as Hb,p as Ot,q as Mb,r as Ju,s as Fb,t as nt}from"./vendor-date-DbWJ9m7c.js";import{c as Ob,p as dp,l as _l,s as vs,i as qb,h as $b,q as bm,a as Nm,m as xm,b as Wb,d as Dl,o as el,e as zb,f as tl,r as vm,g as _m,j as Dm,k as km,n as Am,t as fp,u as pp,v as hp,w as gp,x as yp,y as bp,z as Np,A as xp,B as vp,C as _p,D as Dp,E as kp,F as Kb,G as Qb,H as Yb,I as Gb,J as Xb,K as Jb,L as Zb}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var Ap={exports:{}},jc={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var t=A,e=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),w=Symbol.iterator,_="@@iterator";function S(x){if(x===null||typeof x!="object")return null;var E=w&&x[w]||x[_];return typeof E=="function"?E:null}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function L(x){{for(var E=arguments.length,U=new Array(E>1?E-1:0),H=1;H<E;H++)U[H-1]=arguments[H];$("error",x,U)}}function $(x,E,U){{var H=R.ReactDebugCurrentFrame,X=H.getStackAddendum();X!==""&&(E+="%s",U=U.concat([X]));var W=U.map(function(q){return String(q)});W.unshift("Warning: "+E),Function.prototype.apply.call(console[x],console,W)}}var ie=!1,ee=!1,F=!1,C=!1,N=!1,V;V=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===s||x===i||N||x===r||x===u||x===d||C||x===y||ie||ee||F||typeof x=="object"&&x!==null&&(x.$$typeof===h||x.$$typeof===f||x.$$typeof===a||x.$$typeof===c||x.$$typeof===m||x.$$typeof===V||x.getModuleId!==void 0))}function P(x,E,U){var H=x.displayName;if(H)return H;var X=E.displayName||E.name||"";return X!==""?U+"("+X+")":U}function I(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&L("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case s:return"Fragment";case n:return"Portal";case i:return"Profiler";case r:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case c:var E=x;return I(E)+".Consumer";case a:var U=x;return I(U._context)+".Provider";case m:return P(x,x.render,"ForwardRef");case f:var H=x.displayName||null;return H!==null?H:k(x.type)||"Memo";case h:{var X=x,W=X._payload,q=X._init;try{return k(q(W))}catch{return null}}}return null}var ke=Object.assign,Be=0,pe,je,ut,qt,Mt,ae,Ue;function fe(){}fe.__reactDisabledLog=!0;function Le(){{if(Be===0){pe=console.log,je=console.info,ut=console.warn,qt=console.error,Mt=console.group,ae=console.groupCollapsed,Ue=console.groupEnd;var x={configurable:!0,enumerable:!0,value:fe,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}Be++}}function Ke(){{if(Be--,Be===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:ke({},x,{value:pe}),info:ke({},x,{value:je}),warn:ke({},x,{value:ut}),error:ke({},x,{value:qt}),group:ke({},x,{value:Mt}),groupCollapsed:ke({},x,{value:ae}),groupEnd:ke({},x,{value:Ue})})}Be<0&&L("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=R.ReactCurrentDispatcher,st;function Ct(x,E,U){{if(st===void 0)try{throw Error()}catch(X){var H=X.stack.trim().match(/\n( *(at )?)/);st=H&&H[1]||""}return`
`+st+x}}var lt=!1,ct;{var cn=typeof WeakMap=="function"?WeakMap:Map;ct=new cn}function Q(x,E){if(!x||lt)return"";{var U=ct.get(x);if(U!==void 0)return U}var H;lt=!0;var X=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var W;W=bt.current,bt.current=null,Le();try{if(E){var q=function(){throw Error()};if(Object.defineProperty(q.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(q,[])}catch(wt){H=wt}Reflect.construct(x,[],q)}else{try{q.call()}catch(wt){H=wt}x.call(q.prototype)}}else{try{throw Error()}catch(wt){H=wt}x()}}catch(wt){if(wt&&H&&typeof wt.stack=="string"){for(var Y=wt.stack.split(`
`),oe=H.stack.split(`
`),Se=Y.length-1,We=oe.length-1;Se>=1&&We>=0&&Y[Se]!==oe[We];)We--;for(;Se>=1&&We>=0;Se--,We--)if(Y[Se]!==oe[We]){if(Se!==1||We!==1)do if(Se--,We--,We<0||Y[Se]!==oe[We]){var Je=`
`+Y[Se].replace(" at new "," at ");return x.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",x.displayName)),typeof x=="function"&&ct.set(x,Je),Je}while(Se>=1&&We>=0);break}}}finally{lt=!1,bt.current=W,Ke(),Error.prepareStackTrace=X}var _e=x?x.displayName||x.name:"",Qe=_e?Ct(_e):"";return typeof x=="function"&&ct.set(x,Qe),Qe}function Pe(x,E,U){return Q(x,!1)}function Oe(x){var E=x.prototype;return!!(E&&E.isReactComponent)}function Ie(x,E,U){if(x==null)return"";if(typeof x=="function")return Q(x,Oe(x));if(typeof x=="string")return Ct(x);switch(x){case u:return Ct("Suspense");case d:return Ct("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case m:return Pe(x.render);case f:return Ie(x.type,E,U);case h:{var H=x,X=H._payload,W=H._init;try{return Ie(W(X),E,U)}catch{}}}return""}var He=Object.prototype.hasOwnProperty,Tt={},Ft=R.ReactDebugCurrentFrame;function dt(x){if(x){var E=x._owner,U=Ie(x.type,x._source,E?E.type:null);Ft.setExtraStackFrame(U)}else Ft.setExtraStackFrame(null)}function T(x,E,U,H,X){{var W=Function.call.bind(He);for(var q in x)if(W(x,q)){var Y=void 0;try{if(typeof x[q]!="function"){var oe=Error((H||"React class")+": "+U+" type `"+q+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[q]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw oe.name="Invariant Violation",oe}Y=x[q](E,q,H,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Se){Y=Se}Y&&!(Y instanceof Error)&&(dt(X),L("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",H||"React class",U,q,typeof Y),dt(null)),Y instanceof Error&&!(Y.message in Tt)&&(Tt[Y.message]=!0,dt(X),L("Failed %s type: %s",U,Y.message),dt(null))}}}var O=Array.isArray;function Z(x){return O(x)}function ye(x){{var E=typeof Symbol=="function"&&Symbol.toStringTag,U=E&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function me(x){try{return de(x),!1}catch{return!0}}function de(x){return""+x}function Ve(x){if(me(x))return L("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ye(x)),de(x)}var Xe=R.ReactCurrentOwner,Ge={key:!0,ref:!0,__self:!0,__source:!0},ve,jn,jt;jt={};function ot(x){if(He.call(x,"ref")){var E=Object.getOwnPropertyDescriptor(x,"ref").get;if(E&&E.isReactWarning)return!1}return x.ref!==void 0}function re(x){if(He.call(x,"key")){var E=Object.getOwnPropertyDescriptor(x,"key").get;if(E&&E.isReactWarning)return!1}return x.key!==void 0}function B(x,E){if(typeof x.ref=="string"&&Xe.current&&E&&Xe.current.stateNode!==E){var U=k(Xe.current.type);jt[U]||(L('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Xe.current.type),x.ref),jt[U]=!0)}}function be(x,E){{var U=function(){ve||(ve=!0,L("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",E))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function Ae(x,E){{var U=function(){jn||(jn=!0,L("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",E))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Re=function(x,E,U,H,X,W,q){var Y={$$typeof:e,type:x,key:E,ref:U,props:q,_owner:W};return Y._store={},Object.defineProperty(Y._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Y,"_self",{configurable:!1,enumerable:!1,writable:!1,value:H}),Object.defineProperty(Y,"_source",{configurable:!1,enumerable:!1,writable:!1,value:X}),Object.freeze&&(Object.freeze(Y.props),Object.freeze(Y)),Y};function ue(x,E,U,H,X){{var W,q={},Y=null,oe=null;U!==void 0&&(Ve(U),Y=""+U),re(E)&&(Ve(E.key),Y=""+E.key),ot(E)&&(oe=E.ref,B(E,X));for(W in E)He.call(E,W)&&!Ge.hasOwnProperty(W)&&(q[W]=E[W]);if(x&&x.defaultProps){var Se=x.defaultProps;for(W in Se)q[W]===void 0&&(q[W]=Se[W])}if(Y||oe){var We=typeof x=="function"?x.displayName||x.name||"Unknown":x;Y&&be(q,We),oe&&Ae(q,We)}return Re(x,Y,oe,X,H,Xe.current,q)}}var Lt=R.ReactCurrentOwner,Dt=R.ReactDebugCurrentFrame;function Rt(x){if(x){var E=x._owner,U=Ie(x.type,x._source,E?E.type:null);Dt.setExtraStackFrame(U)}else Dt.setExtraStackFrame(null)}var Nt;Nt=!1;function mn(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function en(){{if(Lt.current){var x=k(Lt.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Sn(x){{if(x!==void 0){var E=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+E+":"+U+"."}return""}}var ds={};function Yn(x){{var E=en();if(!E){var U=typeof x=="string"?x:x.displayName||x.name;U&&(E=`

Check the top-level render call using <`+U+">.")}return E}}function fs(x,E){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=Yn(E);if(ds[U])return;ds[U]=!0;var H="";x&&x._owner&&x._owner!==Lt.current&&(H=" It was passed a child from "+k(x._owner.type)+"."),Rt(x),L('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,H),Rt(null)}}function $r(x,E){{if(typeof x!="object")return;if(Z(x))for(var U=0;U<x.length;U++){var H=x[U];mn(H)&&fs(H,E)}else if(mn(x))x._store&&(x._store.validated=!0);else if(x){var X=S(x);if(typeof X=="function"&&X!==x.entries)for(var W=X.call(x),q;!(q=W.next()).done;)mn(q.value)&&fs(q.value,E)}}}function Cs(x){{var E=x.type;if(E==null||typeof E=="string")return;var U;if(typeof E=="function")U=E.propTypes;else if(typeof E=="object"&&(E.$$typeof===m||E.$$typeof===f))U=E.propTypes;else return;if(U){var H=k(E);T(U,x.props,"prop",H,x)}else if(E.PropTypes!==void 0&&!Nt){Nt=!0;var X=k(E);L("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",X||"Unknown")}typeof E.getDefaultProps=="function"&&!E.getDefaultProps.isReactClassApproved&&L("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function es(x){{for(var E=Object.keys(x.props),U=0;U<E.length;U++){var H=E[U];if(H!=="children"&&H!=="key"){Rt(x),L("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",H),Rt(null);break}}x.ref!==null&&(Rt(x),L("Invalid attribute `ref` supplied to `React.Fragment`."),Rt(null))}}var ws={};function Rn(x,E,U,H,X,W){{var q=j(x);if(!q){var Y="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Y+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var oe=Sn(X);oe?Y+=oe:Y+=en();var Se;x===null?Se="null":Z(x)?Se="array":x!==void 0&&x.$$typeof===e?(Se="<"+(k(x.type)||"Unknown")+" />",Y=" Did you accidentally export a JSX literal instead of a component?"):Se=typeof x,L("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Se,Y)}var We=ue(x,E,U,X,W);if(We==null)return We;if(q){var Je=E.children;if(Je!==void 0)if(H)if(Z(Je)){for(var _e=0;_e<Je.length;_e++)$r(Je[_e],x);Object.freeze&&Object.freeze(Je)}else L("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else $r(Je,x)}if(He.call(E,"key")){var Qe=k(x),wt=Object.keys(E).filter(function(Xt){return Xt!=="key"}),Qt=wt.length>0?"{key: someKey, "+wt.join(": ..., ")+": ...}":"{key: someKey}";if(!ws[Qe+Qt]){var On=wt.length>0?"{"+wt.join(": ..., ")+": ...}":"{}";L(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Qt,Qe,On,Qe),ws[Qe+Qt]=!0}}return x===s?es(We):Cs(We),We}}var v=Rn;jc.Fragment=s,jc.jsxDEV=v})();Ap.exports=jc;var o=Ap.exports,Ep,Zu=yb;{var ed=Zu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ep=function(t,e){ed.usingClientEntryPoint=!0;try{return Zu.createRoot(t,e)}finally{ed.usingClientEntryPoint=!1}}}const eN="modulepreload",tN=function(t){return"/"+t},td={},qs=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(m=>{if(m=tN(m),m in td)return;td[m]=!0;const u=m.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":eN,u||(f.as="script"),f.crossOrigin="",f.href=m,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return r.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};let nN={data:""},sN=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||nN},rN=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,iN=/\/\*[^]*?\*\/|  +/g,nd=/\n+/g,gr=(t,e)=>{let n="",s="",r="";for(let i in t){let a=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+a+";":s+=i[1]=="f"?gr(a,i):i+"{"+gr(a,i[1]=="k"?"":e)+"}":typeof a=="object"?s+=gr(a,e?e.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,c):c?c+" "+m:m)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=gr.p?gr.p(i,a):i+":"+a+";")}return n+(e&&r?e+"{"+r+"}":r)+s},$s={},Vp=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Vp(t[n]);return e}return t},oN=(t,e,n,s,r)=>{let i=Vp(t),a=$s[i]||($s[i]=(m=>{let u=0,d=11;for(;u<m.length;)d=101*d+m.charCodeAt(u++)>>>0;return"go"+d})(i));if(!$s[a]){let m=i!==t?t:(u=>{let d,f,h=[{}];for(;d=rN.exec(u.replace(iN,""));)d[4]?h.shift():d[3]?(f=d[3].replace(nd," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(nd," ").trim();return h[0]})(t);$s[a]=gr(r?{["@keyframes "+a]:m}:m,n?"":"."+a)}let c=n&&$s.g?$s.g:null;return n&&($s.g=$s[a]),((m,u,d,f)=>{f?u.data=u.data.replace(f,m):u.data.indexOf(m)===-1&&(u.data=d?m+u.data:u.data+m)})($s[a],e,s,c),a},aN=(t,e,n)=>t.reduce((s,r,i)=>{let a=e[i];if(a&&a.call){let c=a(n),m=c&&c.props&&c.props.className||/^go/.test(c)&&c;a=m?"."+m:c&&typeof c=="object"?c.props?"":gr(c,""):c===!1?"":c}return s+r+(a??"")},"");function kl(t){let e=this||{},n=t.call?t(e.p):t;return oN(n.unshift?n.raw?aN(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,sN(e.target),e.g,e.o,e.k)}let Cp,Rc,Bc;kl.bind({g:1});let Xs=kl.bind({k:1});function lN(t,e,n,s){gr.p=e,Cp=t,Rc=n,Bc=s}function Lr(t,e){let n=this||{};return function(){let s=arguments;function r(i,a){let c=Object.assign({},i),m=c.className||r.className;n.p=Object.assign({theme:Rc&&Rc()},c),n.o=/ *go\d+/.test(m),c.className=kl.apply(n,s)+(m?" "+m:"");let u=t;return t[0]&&(u=c.as||t,delete c.as),Bc&&u[0]&&Bc(c),Cp(u,c)}return r}}var cN=t=>typeof t=="function",nl=(t,e)=>cN(t)?t(e):t,mN=(()=>{let t=0;return()=>(++t).toString()})(),wp=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),uN=20,Em="default",Sp=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:s}=e;return Sp(t,{type:t.toasts.find(a=>a.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},$a=[],Ip={toasts:[],pausedAt:void 0,settings:{toastLimit:uN}},js={},Pp=(t,e=Em)=>{js[e]=Sp(js[e]||Ip,t),$a.forEach(([n,s])=>{n===e&&s(js[e])})},Lp=t=>Object.keys(js).forEach(e=>Pp(t,e)),dN=t=>Object.keys(js).find(e=>js[e].toasts.some(n=>n.id===t)),Al=(t=Em)=>e=>{Pp(e,t)},fN={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},pN=(t={},e=Em)=>{let[n,s]=A.useState(js[e]||Ip),r=A.useRef(js[e]);A.useEffect(()=>(r.current!==js[e]&&s(js[e]),$a.push([e,s]),()=>{let a=$a.findIndex(([c])=>c===e);a>-1&&$a.splice(a,1)}),[e]);let i=n.toasts.map(a=>{var c,m,u;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((c=t[a.type])==null?void 0:c.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((m=t[a.type])==null?void 0:m.duration)||(t==null?void 0:t.duration)||fN[a.type],style:{...t.style,...(u=t[a.type])==null?void 0:u.style,...a.style}}});return{...n,toasts:i}},hN=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||mN()}),sa=t=>(e,n)=>{let s=hN(e,t,n);return Al(s.toasterId||dN(s.id))({type:2,toast:s}),s.id},Vn=(t,e)=>sa("blank")(t,e);Vn.error=sa("error");Vn.success=sa("success");Vn.loading=sa("loading");Vn.custom=sa("custom");Vn.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Al(e)(n):Lp(n)};Vn.dismissAll=t=>Vn.dismiss(void 0,t);Vn.remove=(t,e)=>{let n={type:4,toastId:t};e?Al(e)(n):Lp(n)};Vn.removeAll=t=>Vn.remove(void 0,t);Vn.promise=(t,e,n)=>{let s=Vn.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let i=e.success?nl(e.success,r):void 0;return i?Vn.success(i,{id:s,...n,...n==null?void 0:n.success}):Vn.dismiss(s),r}).catch(r=>{let i=e.error?nl(e.error,r):void 0;i?Vn.error(i,{id:s,...n,...n==null?void 0:n.error}):Vn.dismiss(s)}),t};var gN=1e3,yN=(t,e="default")=>{let{toasts:n,pausedAt:s}=pN(t,e),r=A.useRef(new Map).current,i=A.useCallback((f,h=gN)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),a({type:4,toastId:f})},h);r.set(f,y)},[]);A.useEffect(()=>{if(s)return;let f=Date.now(),h=n.map(y=>{if(y.duration===1/0)return;let w=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(w<0){y.visible&&Vn.dismiss(y.id);return}return setTimeout(()=>Vn.dismiss(y.id,e),w)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[n,s,e]);let a=A.useCallback(Al(e),[e]),c=A.useCallback(()=>{a({type:5,time:Date.now()})},[a]),m=A.useCallback((f,h)=>{a({type:1,toast:{id:f,height:h}})},[a]),u=A.useCallback(()=>{s&&a({type:6,time:Date.now()})},[s,a]),d=A.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:w=8,defaultPosition:_}=h||{},S=n.filter($=>($.position||_)===(f.position||_)&&$.height),R=S.findIndex($=>$.id===f.id),L=S.filter(($,ie)=>ie<R&&$.visible).length;return S.filter($=>$.visible).slice(...y?[L+1]:[0,L]).reduce(($,ie)=>$+(ie.height||0)+w,0)},[n]);return A.useEffect(()=>{n.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:m,startPause:c,endPause:u,calculateOffset:d}}},bN=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,NN=Xs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xN=Xs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,vN=Lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${bN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${NN} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${xN} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_N=Xs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,DN=Lr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${_N} 1s linear infinite;
`,kN=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,AN=Xs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,EN=Lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${kN} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${AN} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,VN=Lr("div")`
  position: absolute;
`,CN=Lr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wN=Xs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,SN=Lr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wN} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,IN=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?A.createElement(SN,null,e):e:n==="blank"?null:A.createElement(CN,null,A.createElement(DN,{...s}),n!=="loading"&&A.createElement(VN,null,n==="error"?A.createElement(vN,{...s}):A.createElement(EN,{...s})))},PN=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,LN=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,TN="0%{opacity:0;} 100%{opacity:1;}",jN="0%{opacity:1;} 100%{opacity:0;}",RN=Lr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,BN=Lr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,UN=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=wp()?[TN,jN]:[PN(n),LN(n)];return{animation:e?`${Xs(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Xs(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},HN=A.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?UN(t.position||e||"top-center",t.visible):{opacity:0},i=A.createElement(IN,{toast:t}),a=A.createElement(BN,{...t.ariaProps},nl(t.message,t));return A.createElement(RN,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:i,message:a}):A.createElement(A.Fragment,null,i,a))});lN(A.createElement);var MN=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let i=A.useCallback(a=>{if(a){let c=()=>{let m=a.getBoundingClientRect().height;s(t,m)};c(),new MutationObserver(c).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return A.createElement("div",{ref:i,className:e,style:n},r)},FN=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:wp()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},ON=kl`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Da=16,qN=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,toasterId:i,containerStyle:a,containerClassName:c})=>{let{toasts:m,handlers:u}=yN(n,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Da,left:Da,right:Da,bottom:Da,pointerEvents:"none",...a},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},m.map(d=>{let f=d.position||e,h=u.calculateOffset(d,{reverseOrder:t,gutter:s,defaultPosition:e}),y=FN(f,h);return A.createElement(MN,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?ON:"",style:y},d.type==="custom"?nl(d.message,d):r?r(d):A.createElement(HN,{toast:d,position:f}))}))},te=Vn;function $N(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:a}=t;let c,m,u;const d=async(h=!0)=>{await m,await(u==null?void 0:u())};async function f(){if("serviceWorker"in navigator){if(c=await qs(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{a==null||a(h)}),!c)return;u=async()=>{await(c==null?void 0:c.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,c==null||c.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),n==null||n()};c.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"?w.isExternal?y():!h&&(s==null||s()):w.isExternal?window.location.reload():!h&&(s==null||s()):w.isUpdate||s==null||s()}),c.addEventListener("waiting",y),c.addEventListener("externalwaiting",y)}c.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{a==null||a(h)})}}return m=f(),d}const WN=()=>{if(typeof window<"u"){const t=window.location.hostname;if(t==="hvlab.app"||t.includes("hv-lab-app")||t.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},zN=WN(),Oo=_b.create({baseURL:zN,headers:{"Content-Type":"application/json"}});Oo.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));Oo.interceptors.response.use(t=>t,t=>{var e,n,s;return((e=t.response)==null?void 0:e.status)===401&&!((s=(n=t.config)==null?void 0:n.url)!=null&&s.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)});const KN=()=>{};var sd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},QN=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],a=t[n++],c=t[n++],m=((r&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const i=t[n++],a=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},jp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],a=r+1<t.length,c=a?t[r+1]:0,m=r+2<t.length,u=m?t[r+2]:0,d=i>>2,f=(i&3)<<4|c>>4;let h=(c&15)<<2|u>>6,y=u&63;m||(y=64,a||(h=64)),s.push(n[d],n[f],n[h],n[y])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Tp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):QN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],c=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||c==null||u==null||f==null)throw new YN;const h=i<<2|c>>4;if(s.push(h),u!==64){const y=c<<4&240|u>>2;if(s.push(y),f!==64){const w=u<<6&192|f;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GN=function(t){const e=Tp(t);return jp.encodeByteArray(e,!0)},sl=function(t){return GN(t).replace(/\./g,"")},XN=function(t){try{return jp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=()=>JN().__FIREBASE_DEFAULTS__,e0=()=>{if(typeof process>"u"||typeof sd>"u")return;const t=sd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},t0=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XN(t[1]);return e&&JSON.parse(e)},Vm=()=>{try{return KN()||ZN()||e0()||t0()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n0=t=>{var e,n;return(n=(e=Vm())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Rp=t=>{const e=n0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Bp=()=>{var t;return(t=Vm())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Up(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sl(JSON.stringify(n)),sl(JSON.stringify(a)),""].join(".")}const Po={};function r0(){const t={prod:[],emulator:[]};for(const e of Object.keys(Po))Po[e]?t.emulator.push(e):t.prod.push(e);return t}function i0(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let rd=!1;function Mp(t,e){if(typeof window>"u"||typeof document>"u"||!ra(window.location.host)||Po[t]===e||Po[t]||rd)return;Po[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=r0().prod.length>0;function a(){const h=document.getElementById(s);h&&h.remove()}function c(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function m(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{rd=!0,a()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=i0(s),y=n("text"),w=document.getElementById(y)||document.createElement("span"),_=n("learnmore"),S=document.getElementById(_)||document.createElement("a"),R=n("preprendIcon"),L=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const $=h.element;c($),d(S,_);const ie=u();m(L,R),$.append(L,w,S,ie),document.body.appendChild($)}i?(w.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a0(){var e;const t=(e=Vm())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l0(){return!a0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function c0(){try{return typeof indexedDB=="object"}catch{return!1}}function m0(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="FirebaseError";class oi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=u0,Object.setPrototypeOf(this,oi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fp.prototype.create)}}class Fp{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?d0(i,s):"Error",c=`${this.serviceName}: ${a} (${r}).`;return new oi(r,c,s)}}function d0(t,e){return t.replace(f0,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const f0=/\{\$([^}]+)}/g;function rl(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],a=e[r];if(id(i)&&id(a)){if(!rl(i,a))return!1}else if(i!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function id(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t){return t&&t._delegate?t._delegate:t}class Fi{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new s0;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(g0(e))try{this.getOrInitializeService({instanceIdentifier:Yr})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Yr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yr){return this.instances.has(e)}getOptions(e=Yr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);s===c&&a.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:h0(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Yr){return this.component?this.component.multipleInstances?e:Yr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h0(t){return t===Yr?void 0:t}function g0(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new p0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Et||(Et={}));const b0={debug:Et.DEBUG,verbose:Et.VERBOSE,info:Et.INFO,warn:Et.WARN,error:Et.ERROR,silent:Et.SILENT},N0=Et.INFO,x0={[Et.DEBUG]:"log",[Et.VERBOSE]:"log",[Et.INFO]:"info",[Et.WARN]:"warn",[Et.ERROR]:"error"},v0=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=x0[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Op{constructor(e){this.name=e,this._logLevel=N0,this._logHandler=v0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Et.DEBUG,...e),this._logHandler(this,Et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Et.VERBOSE,...e),this._logHandler(this,Et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Et.INFO,...e),this._logHandler(this,Et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Et.WARN,...e),this._logHandler(this,Et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Et.ERROR,...e),this._logHandler(this,Et.ERROR,...e)}}const _0=(t,e)=>e.some(n=>t instanceof n);let od,ad;function D0(){return od||(od=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k0(){return ad||(ad=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qp=new WeakMap,Uc=new WeakMap,$p=new WeakMap,fc=new WeakMap,Cm=new WeakMap;function A0(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(xr(t.result)),r()},a=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&qp.set(n,t)}).catch(()=>{}),Cm.set(e,t),e}function E0(t){if(Uc.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),r()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Uc.set(t,e)}let Hc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$p.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function V0(t){Hc=t(Hc)}function C0(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(pc(this),e,...n);return $p.set(s,e.sort?e.sort():[e]),xr(s)}:k0().includes(t)?function(...e){return t.apply(pc(this),e),xr(qp.get(this))}:function(...e){return xr(t.apply(pc(this),e))}}function w0(t){return typeof t=="function"?C0(t):(t instanceof IDBTransaction&&E0(t),_0(t,D0())?new Proxy(t,Hc):t)}function xr(t){if(t instanceof IDBRequest)return A0(t);if(fc.has(t))return fc.get(t);const e=w0(t);return e!==t&&(fc.set(t,e),Cm.set(e,t)),e}const pc=t=>Cm.get(t);function S0(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(t,e),c=xr(a);return s&&a.addEventListener("upgradeneeded",m=>{s(xr(a.result),m.oldVersion,m.newVersion,xr(a.transaction),m)}),n&&a.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),c.then(m=>{i&&m.addEventListener("close",()=>i()),r&&m.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}const I0=["get","getKey","getAll","getAllKeys","count"],P0=["put","add","delete","clear"],hc=new Map;function ld(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hc.get(e))return hc.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=P0.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||I0.includes(n)))return;const i=async function(a,...c){const m=this.transaction(a,r?"readwrite":"readonly");let u=m.store;return s&&(u=u.index(c.shift())),(await Promise.all([u[n](...c),r&&m.done]))[0]};return hc.set(e,i),i}V0(t=>({...t,get:(e,n,s)=>ld(e,n)||t.get(e,n,s),has:(e,n)=>!!ld(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(T0(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function T0(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mc="@firebase/app",cd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new Op("@firebase/app"),j0="@firebase/app-compat",R0="@firebase/analytics-compat",B0="@firebase/analytics",U0="@firebase/app-check-compat",H0="@firebase/app-check",M0="@firebase/auth",F0="@firebase/auth-compat",O0="@firebase/database",q0="@firebase/data-connect",$0="@firebase/database-compat",W0="@firebase/functions",z0="@firebase/functions-compat",K0="@firebase/installations",Q0="@firebase/installations-compat",Y0="@firebase/messaging",G0="@firebase/messaging-compat",X0="@firebase/performance",J0="@firebase/performance-compat",Z0="@firebase/remote-config",ex="@firebase/remote-config-compat",tx="@firebase/storage",nx="@firebase/storage-compat",sx="@firebase/firestore",rx="@firebase/ai",ix="@firebase/firestore-compat",ox="firebase",ax="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc="[DEFAULT]",lx={[Mc]:"fire-core",[j0]:"fire-core-compat",[B0]:"fire-analytics",[R0]:"fire-analytics-compat",[H0]:"fire-app-check",[U0]:"fire-app-check-compat",[M0]:"fire-auth",[F0]:"fire-auth-compat",[O0]:"fire-rtdb",[q0]:"fire-data-connect",[$0]:"fire-rtdb-compat",[W0]:"fire-fn",[z0]:"fire-fn-compat",[K0]:"fire-iid",[Q0]:"fire-iid-compat",[Y0]:"fire-fcm",[G0]:"fire-fcm-compat",[X0]:"fire-perf",[J0]:"fire-perf-compat",[Z0]:"fire-rc",[ex]:"fire-rc-compat",[tx]:"fire-gcs",[nx]:"fire-gcs-compat",[sx]:"fire-fst",[ix]:"fire-fst-compat",[rx]:"fire-vertex","fire-js":"fire-js",[ox]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new Map,cx=new Map,Oc=new Map;function md(t,e){try{t.container.addComponent(e)}catch(n){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $o(t){const e=t.name;if(Oc.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;Oc.set(e,t);for(const n of qo.values())md(n,t);for(const n of cx.values())md(n,t);return!0}function Wp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zp(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vr=new Fp("app","Firebase",mx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp=ax;function Qp(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Fc,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw vr.create("bad-app-name",{appName:String(r)});if(n||(n=Bp()),!n)throw vr.create("no-options");const i=qo.get(r);if(i){if(rl(n,i.options)&&rl(s,i.config))return i;throw vr.create("duplicate-app",{appName:r})}const a=new y0(r);for(const m of Oc.values())a.addComponent(m);const c=new ux(n,s,a);return qo.set(r,c),c}function Yp(t=Fc){const e=qo.get(t);if(!e&&t===Fc&&Bp())return Qp();if(!e)throw vr.create("no-app",{appName:t});return e}function ud(){return Array.from(qo.values())}function _r(t,e,n){let s=lx[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(a.join(" "));return}$o(new Fi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="firebase-heartbeat-database",fx=1,Wo="firebase-heartbeat-store";let gc=null;function Gp(){return gc||(gc=S0(dx,fx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(n){console.warn(n)}}}}).catch(t=>{throw vr.create("idb-open",{originalErrorMessage:t.message})})),gc}async function px(t){try{const n=(await Gp()).transaction(Wo),s=await n.objectStore(Wo).get(Xp(t));return await n.done,s}catch(e){if(e instanceof oi)Js.warn(e.message);else{const n=vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Js.warn(n.message)}}}async function dd(t,e){try{const s=(await Gp()).transaction(Wo,"readwrite");await s.objectStore(Wo).put(e,Xp(t)),await s.done}catch(n){if(n instanceof oi)Js.warn(n.message);else{const s=vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Js.warn(s.message)}}}function Xp(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=1024,gx=30;class yx{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Nx(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>gx){const a=xx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fd(),{heartbeatsToSend:s,unsentEntries:r}=bx(this._heartbeatsCache.heartbeats),i=sl(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Js.warn(n),""}}}function fd(){return new Date().toISOString().substring(0,10)}function bx(t,e=hx){const n=[];let s=t.slice();for(const r of t){const i=n.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),pd(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),pd(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Nx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c0()?m0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await px(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function pd(t){return sl(JSON.stringify({version:2,heartbeats:t})).length}function xx(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t){$o(new Fi("platform-logger",e=>new L0(e),"PRIVATE")),$o(new Fi("heartbeat",e=>new yx(e),"PRIVATE")),_r(Mc,cd,t),_r(Mc,cd,"esm2020"),_r("fire-js","")}vx("");var _x="firebase",Dx="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_r(_x,Dx,"app");var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dr,Jp;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,N){function V(){}V.prototype=N.prototype,C.F=N.prototype,C.prototype=new V,C.prototype.constructor=C,C.D=function(j,P,I){for(var k=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)k[ke-2]=arguments[ke];return N.prototype[P].apply(j,k)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,N,V){V||(V=0);const j=Array(16);if(typeof N=="string")for(var P=0;P<16;++P)j[P]=N.charCodeAt(V++)|N.charCodeAt(V++)<<8|N.charCodeAt(V++)<<16|N.charCodeAt(V++)<<24;else for(P=0;P<16;++P)j[P]=N[V++]|N[V++]<<8|N[V++]<<16|N[V++]<<24;N=C.g[0],V=C.g[1],P=C.g[2];let I=C.g[3],k;k=N+(I^V&(P^I))+j[0]+3614090360&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(P^N&(V^P))+j[1]+3905402710&4294967295,I=N+(k<<12&4294967295|k>>>20),k=P+(V^I&(N^V))+j[2]+606105819&4294967295,P=I+(k<<17&4294967295|k>>>15),k=V+(N^P&(I^N))+j[3]+3250441966&4294967295,V=P+(k<<22&4294967295|k>>>10),k=N+(I^V&(P^I))+j[4]+4118548399&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(P^N&(V^P))+j[5]+1200080426&4294967295,I=N+(k<<12&4294967295|k>>>20),k=P+(V^I&(N^V))+j[6]+2821735955&4294967295,P=I+(k<<17&4294967295|k>>>15),k=V+(N^P&(I^N))+j[7]+4249261313&4294967295,V=P+(k<<22&4294967295|k>>>10),k=N+(I^V&(P^I))+j[8]+1770035416&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(P^N&(V^P))+j[9]+2336552879&4294967295,I=N+(k<<12&4294967295|k>>>20),k=P+(V^I&(N^V))+j[10]+4294925233&4294967295,P=I+(k<<17&4294967295|k>>>15),k=V+(N^P&(I^N))+j[11]+2304563134&4294967295,V=P+(k<<22&4294967295|k>>>10),k=N+(I^V&(P^I))+j[12]+1804603682&4294967295,N=V+(k<<7&4294967295|k>>>25),k=I+(P^N&(V^P))+j[13]+4254626195&4294967295,I=N+(k<<12&4294967295|k>>>20),k=P+(V^I&(N^V))+j[14]+2792965006&4294967295,P=I+(k<<17&4294967295|k>>>15),k=V+(N^P&(I^N))+j[15]+1236535329&4294967295,V=P+(k<<22&4294967295|k>>>10),k=N+(P^I&(V^P))+j[1]+4129170786&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^P&(N^V))+j[6]+3225465664&4294967295,I=N+(k<<9&4294967295|k>>>23),k=P+(N^V&(I^N))+j[11]+643717713&4294967295,P=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(P^I))+j[0]+3921069994&4294967295,V=P+(k<<20&4294967295|k>>>12),k=N+(P^I&(V^P))+j[5]+3593408605&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^P&(N^V))+j[10]+38016083&4294967295,I=N+(k<<9&4294967295|k>>>23),k=P+(N^V&(I^N))+j[15]+3634488961&4294967295,P=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(P^I))+j[4]+3889429448&4294967295,V=P+(k<<20&4294967295|k>>>12),k=N+(P^I&(V^P))+j[9]+568446438&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^P&(N^V))+j[14]+3275163606&4294967295,I=N+(k<<9&4294967295|k>>>23),k=P+(N^V&(I^N))+j[3]+4107603335&4294967295,P=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(P^I))+j[8]+1163531501&4294967295,V=P+(k<<20&4294967295|k>>>12),k=N+(P^I&(V^P))+j[13]+2850285829&4294967295,N=V+(k<<5&4294967295|k>>>27),k=I+(V^P&(N^V))+j[2]+4243563512&4294967295,I=N+(k<<9&4294967295|k>>>23),k=P+(N^V&(I^N))+j[7]+1735328473&4294967295,P=I+(k<<14&4294967295|k>>>18),k=V+(I^N&(P^I))+j[12]+2368359562&4294967295,V=P+(k<<20&4294967295|k>>>12),k=N+(V^P^I)+j[5]+4294588738&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^P)+j[8]+2272392833&4294967295,I=N+(k<<11&4294967295|k>>>21),k=P+(I^N^V)+j[11]+1839030562&4294967295,P=I+(k<<16&4294967295|k>>>16),k=V+(P^I^N)+j[14]+4259657740&4294967295,V=P+(k<<23&4294967295|k>>>9),k=N+(V^P^I)+j[1]+2763975236&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^P)+j[4]+1272893353&4294967295,I=N+(k<<11&4294967295|k>>>21),k=P+(I^N^V)+j[7]+4139469664&4294967295,P=I+(k<<16&4294967295|k>>>16),k=V+(P^I^N)+j[10]+3200236656&4294967295,V=P+(k<<23&4294967295|k>>>9),k=N+(V^P^I)+j[13]+681279174&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^P)+j[0]+3936430074&4294967295,I=N+(k<<11&4294967295|k>>>21),k=P+(I^N^V)+j[3]+3572445317&4294967295,P=I+(k<<16&4294967295|k>>>16),k=V+(P^I^N)+j[6]+76029189&4294967295,V=P+(k<<23&4294967295|k>>>9),k=N+(V^P^I)+j[9]+3654602809&4294967295,N=V+(k<<4&4294967295|k>>>28),k=I+(N^V^P)+j[12]+3873151461&4294967295,I=N+(k<<11&4294967295|k>>>21),k=P+(I^N^V)+j[15]+530742520&4294967295,P=I+(k<<16&4294967295|k>>>16),k=V+(P^I^N)+j[2]+3299628645&4294967295,V=P+(k<<23&4294967295|k>>>9),k=N+(P^(V|~I))+j[0]+4096336452&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~P))+j[7]+1126891415&4294967295,I=N+(k<<10&4294967295|k>>>22),k=P+(N^(I|~V))+j[14]+2878612391&4294967295,P=I+(k<<15&4294967295|k>>>17),k=V+(I^(P|~N))+j[5]+4237533241&4294967295,V=P+(k<<21&4294967295|k>>>11),k=N+(P^(V|~I))+j[12]+1700485571&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~P))+j[3]+2399980690&4294967295,I=N+(k<<10&4294967295|k>>>22),k=P+(N^(I|~V))+j[10]+4293915773&4294967295,P=I+(k<<15&4294967295|k>>>17),k=V+(I^(P|~N))+j[1]+2240044497&4294967295,V=P+(k<<21&4294967295|k>>>11),k=N+(P^(V|~I))+j[8]+1873313359&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~P))+j[15]+4264355552&4294967295,I=N+(k<<10&4294967295|k>>>22),k=P+(N^(I|~V))+j[6]+2734768916&4294967295,P=I+(k<<15&4294967295|k>>>17),k=V+(I^(P|~N))+j[13]+1309151649&4294967295,V=P+(k<<21&4294967295|k>>>11),k=N+(P^(V|~I))+j[4]+4149444226&4294967295,N=V+(k<<6&4294967295|k>>>26),k=I+(V^(N|~P))+j[11]+3174756917&4294967295,I=N+(k<<10&4294967295|k>>>22),k=P+(N^(I|~V))+j[2]+718787259&4294967295,P=I+(k<<15&4294967295|k>>>17),k=V+(I^(P|~N))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+N&4294967295,C.g[1]=C.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+P&4294967295,C.g[3]=C.g[3]+I&4294967295}s.prototype.v=function(C,N){N===void 0&&(N=C.length);const V=N-this.blockSize,j=this.C;let P=this.h,I=0;for(;I<N;){if(P==0)for(;I<=V;)r(this,C,I),I+=this.blockSize;if(typeof C=="string"){for(;I<N;)if(j[P++]=C.charCodeAt(I++),P==this.blockSize){r(this,j),P=0;break}}else for(;I<N;)if(j[P++]=C[I++],P==this.blockSize){r(this,j),P=0;break}}this.h=P,this.o+=N},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var N=1;N<C.length-8;++N)C[N]=0;N=this.o*8;for(var V=C.length-8;V<C.length;++V)C[V]=N&255,N/=256;for(this.v(C),C=Array(16),N=0,V=0;V<4;++V)for(let j=0;j<32;j+=8)C[N++]=this.g[V]>>>j&255;return C};function i(C,N){var V=c;return Object.prototype.hasOwnProperty.call(V,C)?V[C]:V[C]=N(C)}function a(C,N){this.h=N;const V=[];let j=!0;for(let P=C.length-1;P>=0;P--){const I=C[P]|0;j&&I==N||(V[P]=I,j=!1)}this.g=V}var c={};function m(C){return-128<=C&&C<128?i(C,function(N){return new a([N|0],N<0?-1:0)}):new a([C|0],C<0?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(C<0)return S(u(-C));const N=[];let V=1;for(let j=0;C>=V;j++)N[j]=C/V|0,V*=4294967296;return new a(N,0)}function d(C,N){if(C.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(C.charAt(0)=="-")return S(d(C.substring(1),N));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=u(Math.pow(N,8));let j=f;for(let I=0;I<C.length;I+=8){var P=Math.min(8,C.length-I);const k=parseInt(C.substring(I,I+P),N);P<8?(P=u(Math.pow(N,P)),j=j.j(P).add(u(k))):(j=j.j(V),j=j.add(u(k)))}return j}var f=m(0),h=m(1),y=m(16777216);t=a.prototype,t.m=function(){if(_(this))return-S(this).m();let C=0,N=1;for(let V=0;V<this.g.length;V++){const j=this.i(V);C+=(j>=0?j:4294967296+j)*N,N*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(_(this))return"-"+S(this).toString(C);const N=u(Math.pow(C,6));var V=this;let j="";for(;;){const P=ie(V,N).g;V=R(V,P.j(N));let I=((V.g.length>0?V.g[0]:V.h)>>>0).toString(C);if(V=P,w(V))return I+j;for(;I.length<6;)I="0"+I;j=I+j}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(let N=0;N<C.g.length;N++)if(C.g[N]!=0)return!1;return!0}function _(C){return C.h==-1}t.l=function(C){return C=R(this,C),_(C)?-1:w(C)?0:1};function S(C){const N=C.g.length,V=[];for(let j=0;j<N;j++)V[j]=~C.g[j];return new a(V,~C.h).add(h)}t.abs=function(){return _(this)?S(this):this},t.add=function(C){const N=Math.max(this.g.length,C.g.length),V=[];let j=0;for(let P=0;P<=N;P++){let I=j+(this.i(P)&65535)+(C.i(P)&65535),k=(I>>>16)+(this.i(P)>>>16)+(C.i(P)>>>16);j=k>>>16,I&=65535,k&=65535,V[P]=k<<16|I}return new a(V,V[V.length-1]&-2147483648?-1:0)};function R(C,N){return C.add(S(N))}t.j=function(C){if(w(this)||w(C))return f;if(_(this))return _(C)?S(this).j(S(C)):S(S(this).j(C));if(_(C))return S(this.j(S(C)));if(this.l(y)<0&&C.l(y)<0)return u(this.m()*C.m());const N=this.g.length+C.g.length,V=[];for(var j=0;j<2*N;j++)V[j]=0;for(j=0;j<this.g.length;j++)for(let P=0;P<C.g.length;P++){const I=this.i(j)>>>16,k=this.i(j)&65535,ke=C.i(P)>>>16,Be=C.i(P)&65535;V[2*j+2*P]+=k*Be,L(V,2*j+2*P),V[2*j+2*P+1]+=I*Be,L(V,2*j+2*P+1),V[2*j+2*P+1]+=k*ke,L(V,2*j+2*P+1),V[2*j+2*P+2]+=I*ke,L(V,2*j+2*P+2)}for(C=0;C<N;C++)V[C]=V[2*C+1]<<16|V[2*C];for(C=N;C<2*N;C++)V[C]=0;return new a(V,0)};function L(C,N){for(;(C[N]&65535)!=C[N];)C[N+1]+=C[N]>>>16,C[N]&=65535,N++}function $(C,N){this.g=C,this.h=N}function ie(C,N){if(w(N))throw Error("division by zero");if(w(C))return new $(f,f);if(_(C))return N=ie(S(C),N),new $(S(N.g),S(N.h));if(_(N))return N=ie(C,S(N)),new $(S(N.g),N.h);if(C.g.length>30){if(_(C)||_(N))throw Error("slowDivide_ only works with positive integers.");for(var V=h,j=N;j.l(C)<=0;)V=ee(V),j=ee(j);var P=F(V,1),I=F(j,1);for(j=F(j,2),V=F(V,2);!w(j);){var k=I.add(j);k.l(C)<=0&&(P=P.add(V),I=k),j=F(j,1),V=F(V,1)}return N=R(C,P.j(N)),new $(P,N)}for(P=f;C.l(N)>=0;){for(V=Math.max(1,Math.floor(C.m()/N.m())),j=Math.ceil(Math.log(V)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),I=u(V),k=I.j(N);_(k)||k.l(C)>0;)V-=j,I=u(V),k=I.j(N);w(I)&&(I=h),P=P.add(I),C=R(C,k)}return new $(P,C)}t.B=function(C){return ie(this,C).h},t.and=function(C){const N=Math.max(this.g.length,C.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)&C.i(j);return new a(V,this.h&C.h)},t.or=function(C){const N=Math.max(this.g.length,C.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)|C.i(j);return new a(V,this.h|C.h)},t.xor=function(C){const N=Math.max(this.g.length,C.g.length),V=[];for(let j=0;j<N;j++)V[j]=this.i(j)^C.i(j);return new a(V,this.h^C.h)};function ee(C){const N=C.g.length+1,V=[];for(let j=0;j<N;j++)V[j]=C.i(j)<<1|C.i(j-1)>>>31;return new a(V,C.h)}function F(C,N){const V=N>>5;N%=32;const j=C.g.length-V,P=[];for(let I=0;I<j;I++)P[I]=N>0?C.i(I+V)>>>N|C.i(I+V+1)<<32-N:C.i(I+V);return new a(P,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,Jp=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=d,Dr=a}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zp,Vo,eh,Wa,qc,th,nh,sh;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ka=="object"&&ka];for(var p=0;p<l.length;++p){var g=l[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(l,p){if(p)e:{var g=s;l=l.split(".");for(var D=0;D<l.length-1;D++){var z=l[D];if(!(z in g))break e;g=g[z]}l=l[l.length-1],D=g[l],p=p(D),p!=D&&p!=null&&e(g,l,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(l){return l||function(p){var g=[],D;for(D in p)Object.prototype.hasOwnProperty.call(p,D)&&g.push([D,p[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function c(l){var p=typeof l;return p=="object"&&l!=null||p=="function"}function m(l,p,g){return l.call.apply(l.bind,arguments)}function u(l,p,g){return u=m,u.apply(null,arguments)}function d(l,p){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),l.apply(this,D)}}function f(l,p){function g(){}g.prototype=p.prototype,l.Z=p.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(D,z,J){for(var xe=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)xe[mt-2]=arguments[mt];return p.prototype[z].apply(D,xe)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function y(l){const p=l.length;if(p>0){const g=Array(p);for(let D=0;D<p;D++)g[D]=l[D];return g}return[]}function w(l,p){for(let D=1;D<arguments.length;D++){const z=arguments[D];var g=typeof z;if(g=g!="object"?g:z?Array.isArray(z)?"array":g:"null",g=="array"||g=="object"&&typeof z.length=="number"){g=l.length||0;const J=z.length||0;l.length=g+J;for(let xe=0;xe<J;xe++)l[g+xe]=z[xe]}else l.push(z)}}class _{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function S(l){a.setTimeout(()=>{throw l},0)}function R(){var l=C;let p=null;return l.g&&(p=l.g,l.g=l.g.next,l.g||(l.h=null),p.next=null),p}class L{constructor(){this.h=this.g=null}add(p,g){const D=$.get();D.set(p,g),this.h?this.h.next=D:this.g=D,this.h=D}}var $=new _(()=>new ie,l=>l.reset());class ie{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,F=!1,C=new L,N=()=>{const l=Promise.resolve(void 0);ee=()=>{l.then(V)}};function V(){for(var l;l=R();){try{l.h.call(l.g)}catch(g){S(g)}var p=$;p.j(l),p.h<100&&(p.h++,l.next=p.g,p.g=l)}F=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(l,p){this.type=l,this.g=this.target=p,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,p=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,p),a.removeEventListener("test",g,p)}catch{}return l}();function k(l){return/^[\s\xa0]*$/.test(l)}function ke(l,p){P.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,p)}f(ke,P),ke.prototype.init=function(l,p){const g=this.type=l.type,D=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=p,p=l.relatedTarget,p||(g=="mouseover"?p=l.fromElement:g=="mouseout"&&(p=l.toElement)),this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Be="closure_listenable_"+(Math.random()*1e6|0),pe=0;function je(l,p,g,D,z){this.listener=l,this.proxy=null,this.src=p,this.type=g,this.capture=!!D,this.ha=z,this.key=++pe,this.da=this.fa=!1}function ut(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function qt(l,p,g){for(const D in l)p.call(g,l[D],D,l)}function Mt(l,p){for(const g in l)p.call(void 0,l[g],g,l)}function ae(l){const p={};for(const g in l)p[g]=l[g];return p}const Ue="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(l,p){let g,D;for(let z=1;z<arguments.length;z++){D=arguments[z];for(g in D)l[g]=D[g];for(let J=0;J<Ue.length;J++)g=Ue[J],Object.prototype.hasOwnProperty.call(D,g)&&(l[g]=D[g])}}function Le(l){this.src=l,this.g={},this.h=0}Le.prototype.add=function(l,p,g,D,z){const J=l.toString();l=this.g[J],l||(l=this.g[J]=[],this.h++);const xe=bt(l,p,D,z);return xe>-1?(p=l[xe],g||(p.fa=!1)):(p=new je(p,this.src,J,!!D,z),p.fa=g,l.push(p)),p};function Ke(l,p){const g=p.type;if(g in l.g){var D=l.g[g],z=Array.prototype.indexOf.call(D,p,void 0),J;(J=z>=0)&&Array.prototype.splice.call(D,z,1),J&&(ut(p),l.g[g].length==0&&(delete l.g[g],l.h--))}}function bt(l,p,g,D){for(let z=0;z<l.length;++z){const J=l[z];if(!J.da&&J.listener==p&&J.capture==!!g&&J.ha==D)return z}return-1}var st="closure_lm_"+(Math.random()*1e6|0),Ct={};function lt(l,p,g,D,z){if(Array.isArray(p)){for(let J=0;J<p.length;J++)lt(l,p[J],g,D,z);return null}return g=Ft(g),l&&l[Be]?l.J(p,g,c(D)?!!D.capture:!1,z):ct(l,p,g,!1,D,z)}function ct(l,p,g,D,z,J){if(!p)throw Error("Invalid event type");const xe=c(z)?!!z.capture:!!z;let mt=He(l);if(mt||(l[st]=mt=new Le(l)),g=mt.add(p,g,D,xe,J),g.proxy)return g;if(D=cn(),g.proxy=D,D.src=l,D.listener=g,l.addEventListener)I||(z=xe),z===void 0&&(z=!1),l.addEventListener(p.toString(),D,z);else if(l.attachEvent)l.attachEvent(Oe(p.toString()),D);else if(l.addListener&&l.removeListener)l.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function cn(){function l(g){return p.call(l.src,l.listener,g)}const p=Ie;return l}function Q(l,p,g,D,z){if(Array.isArray(p))for(var J=0;J<p.length;J++)Q(l,p[J],g,D,z);else D=c(D)?!!D.capture:!!D,g=Ft(g),l&&l[Be]?(l=l.i,J=String(p).toString(),J in l.g&&(p=l.g[J],g=bt(p,g,D,z),g>-1&&(ut(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete l.g[J],l.h--)))):l&&(l=He(l))&&(p=l.g[p.toString()],l=-1,p&&(l=bt(p,g,D,z)),(g=l>-1?p[l]:null)&&Pe(g))}function Pe(l){if(typeof l!="number"&&l&&!l.da){var p=l.src;if(p&&p[Be])Ke(p.i,l);else{var g=l.type,D=l.proxy;p.removeEventListener?p.removeEventListener(g,D,l.capture):p.detachEvent?p.detachEvent(Oe(g),D):p.addListener&&p.removeListener&&p.removeListener(D),(g=He(p))?(Ke(g,l),g.h==0&&(g.src=null,p[st]=null)):ut(l)}}}function Oe(l){return l in Ct?Ct[l]:Ct[l]="on"+l}function Ie(l,p){if(l.da)l=!0;else{p=new ke(p,this);const g=l.listener,D=l.ha||l.src;l.fa&&Pe(l),l=g.call(D,p)}return l}function He(l){return l=l[st],l instanceof Le?l:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ft(l){return typeof l=="function"?l:(l[Tt]||(l[Tt]=function(p){return l.handleEvent(p)}),l[Tt])}function dt(){j.call(this),this.i=new Le(this),this.M=this,this.G=null}f(dt,j),dt.prototype[Be]=!0,dt.prototype.removeEventListener=function(l,p,g,D){Q(this,l,p,g,D)};function T(l,p){var g,D=l.G;if(D)for(g=[];D;D=D.G)g.push(D);if(l=l.M,D=p.type||p,typeof p=="string")p=new P(p,l);else if(p instanceof P)p.target=p.target||l;else{var z=p;p=new P(D,l),fe(p,z)}z=!0;let J,xe;if(g)for(xe=g.length-1;xe>=0;xe--)J=p.g=g[xe],z=O(J,D,!0,p)&&z;if(J=p.g=l,z=O(J,D,!0,p)&&z,z=O(J,D,!1,p)&&z,g)for(xe=0;xe<g.length;xe++)J=p.g=g[xe],z=O(J,D,!1,p)&&z}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var l=this.i;for(const p in l.g){const g=l.g[p];for(let D=0;D<g.length;D++)ut(g[D]);delete l.g[p],l.h--}}this.G=null},dt.prototype.J=function(l,p,g,D){return this.i.add(String(l),p,!1,g,D)},dt.prototype.K=function(l,p,g,D){return this.i.add(String(l),p,!0,g,D)};function O(l,p,g,D){if(p=l.i.g[String(p)],!p)return!0;p=p.concat();let z=!0;for(let J=0;J<p.length;++J){const xe=p[J];if(xe&&!xe.da&&xe.capture==g){const mt=xe.listener,An=xe.ha||xe.src;xe.fa&&Ke(l.i,xe),z=mt.call(An,D)!==!1&&z}}return z&&!D.defaultPrevented}function Z(l,p){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:a.setTimeout(l,p||0)}function ye(l){l.g=Z(()=>{l.g=null,l.i&&(l.i=!1,ye(l))},l.l);const p=l.h;l.h=null,l.m.apply(null,p)}class me extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(l){j.call(this),this.h=l,this.g={}}f(de,j);var Ve=[];function Xe(l){qt(l.g,function(p,g){this.g.hasOwnProperty(g)&&Pe(p)},l),l.g={}}de.prototype.N=function(){de.Z.N.call(this),Xe(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ge=a.JSON.stringify,ve=a.JSON.parse,jn=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function jt(){}function ot(){}var re={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function B(){P.call(this,"d")}f(B,P);function be(){P.call(this,"c")}f(be,P);var Ae={},Re=null;function ue(){return Re=Re||new dt}Ae.Ia="serverreachability";function Lt(l){P.call(this,Ae.Ia,l)}f(Lt,P);function Dt(l){const p=ue();T(p,new Lt(p))}Ae.STAT_EVENT="statevent";function Rt(l,p){P.call(this,Ae.STAT_EVENT,l),this.stat=p}f(Rt,P);function Nt(l){const p=ue();T(p,new Rt(p,l))}Ae.Ja="timingevent";function mn(l,p){P.call(this,Ae.Ja,l),this.size=p}f(mn,P);function en(l,p){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},p)}function Sn(){this.g=!0}Sn.prototype.ua=function(){this.g=!1};function ds(l,p,g,D,z,J){l.info(function(){if(l.g)if(J){var xe="",mt=J.split("&");for(let Kt=0;Kt<mt.length;Kt++){var An=mt[Kt].split("=");if(An.length>1){const In=An[0];An=An[1];const Is=In.split("_");xe=Is.length>=2&&Is[1]=="type"?xe+(In+"="+An+"&"):xe+(In+"=redacted&")}}}else xe=null;else xe=J;return"XMLHTTP REQ ("+D+") [attempt "+z+"]: "+p+`
`+g+`
`+xe})}function Yn(l,p,g,D,z,J,xe){l.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+z+"]: "+p+`
`+g+`
`+J+" "+xe})}function fs(l,p,g,D){l.info(function(){return"XMLHTTP TEXT ("+p+"): "+Cs(l,g)+(D?" "+D:"")})}function $r(l,p){l.info(function(){return"TIMEOUT: "+p})}Sn.prototype.info=function(){};function Cs(l,p){if(!l.g)return p;if(!p)return null;try{const J=JSON.parse(p);if(J){for(l=0;l<J.length;l++)if(Array.isArray(J[l])){var g=J[l];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var z=D[0];if(z!="noop"&&z!="stop"&&z!="close")for(let xe=1;xe<D.length;xe++)D[xe]=""}}}}return Ge(J)}catch{return p}}var es={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ws={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rn;function v(){}f(v,jt),v.prototype.g=function(){return new XMLHttpRequest},Rn=new v;function x(l){return encodeURIComponent(String(l))}function E(l){var p=1;l=l.split(":");const g=[];for(;p>0&&l.length;)g.push(l.shift()),p--;return l.length&&g.push(l.join(":")),g}function U(l,p,g,D){this.j=l,this.i=p,this.l=g,this.S=D||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new H}function H(){this.i=null,this.g="",this.h=!1}var X={},W={};function q(l,p,g){l.M=1,l.A=fi(pt(p)),l.u=g,l.R=!0,Y(l,null)}function Y(l,p){l.F=Date.now(),Je(l),l.B=pt(l.A);var g=l.B,D=l.S;Array.isArray(D)||(D=[String(D)]),le(g.i,"t",D),l.C=0,g=l.j.L,l.h=new H,l.g=Wu(l.j,g?p:null,!l.u),l.P>0&&(l.O=new me(u(l.Y,l,l.g),l.P)),p=l.V,g=l.g,D=l.ba;var z="readystatechange";Array.isArray(z)||(z&&(Ve[0]=z.toString()),z=Ve);for(let J=0;J<z.length;J++){const xe=lt(g,z[J],D||p.handleEvent,!1,p.h||p);if(!xe)break;p.g[xe.key]=xe}p=l.J?ae(l.J):{},l.u?(l.v||(l.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,p)):(l.v="GET",l.g.ea(l.B,l.v,null,p)),Dt(),ds(l.i,l.v,l.B,l.l,l.S,l.u)}U.prototype.ba=function(l){l=l.target;const p=this.O;p&&bs(l)==3?p.j():this.Y(l)},U.prototype.Y=function(l){try{if(l==this.g)e:{const mt=bs(this.g),An=this.g.ya(),Kt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||Tu(this.g)))){this.K||mt!=4||An==7||(An==8||Kt<=0?Dt(3):Dt(2)),Qe(this);var p=this.g.ca();this.X=p;var g=oe(this);if(this.o=p==200,Yn(this.i,this.v,this.B,this.l,this.S,mt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var D,z=this.g;if((D=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(D)){var J=D;break t}}J=null}if(l=J)fs(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,On(this,l);else{this.o=!1,this.m=3,Nt(12),Qt(this),wt(this);break e}}if(this.R){l=!0;let In;for(;!this.K&&this.C<g.length;)if(In=We(this,g),In==W){mt==4&&(this.m=4,Nt(14),l=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(In==X){this.m=4,Nt(15),fs(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else fs(this.i,this.l,In,null),On(this,In);if(Se(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||g.length!=0||this.h.h||(this.m=1,Nt(16),l=!1),this.o=this.o&&l,!l)fs(this.i,this.l,g,"[Invalid Chunked Response]"),Qt(this),wt(this);else if(g.length>0&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.aa&&!xe.P&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),lc(xe),xe.P=!0,Nt(11))}}else fs(this.i,this.l,g,null),On(this,g);mt==4&&Qt(this),this.o&&!this.K&&(mt==4?Fu(this.j,this):(this.o=!1,Je(this)))}else hb(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Nt(12)):(this.m=0,Nt(13)),Qt(this),wt(this)}}}catch{}finally{}};function oe(l){if(!Se(l))return l.g.la();const p=Tu(l.g);if(p==="")return"";let g="";const D=p.length,z=bs(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Qt(l),wt(l),"";l.h.i=new a.TextDecoder}for(let J=0;J<D;J++)l.h.h=!0,g+=l.h.i.decode(p[J],{stream:!(z&&J==D-1)});return p.length=0,l.h.g+=g,l.C=0,l.h.g}function Se(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function We(l,p){var g=l.C,D=p.indexOf(`
`,g);return D==-1?W:(g=Number(p.substring(g,D)),isNaN(g)?X:(D+=1,D+g>p.length?W:(p=p.slice(D,D+g),l.C=D+g,p)))}U.prototype.cancel=function(){this.K=!0,Qt(this)};function Je(l){l.T=Date.now()+l.H,_e(l,l.H)}function _e(l,p){if(l.D!=null)throw Error("WatchDog timer not null");l.D=en(u(l.aa,l),p)}function Qe(l){l.D&&(a.clearTimeout(l.D),l.D=null)}U.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?($r(this.i,this.B),this.M!=2&&(Dt(),Nt(17)),Qt(this),this.m=2,wt(this)):_e(this,this.T-l)};function wt(l){l.j.I==0||l.K||Fu(l.j,l)}function Qt(l){Qe(l);var p=l.O;p&&typeof p.dispose=="function"&&p.dispose(),l.O=null,Xe(l.V),l.g&&(p=l.g,l.g=null,p.abort(),p.dispose())}function On(l,p){try{var g=l.j;if(g.I!=0&&(g.g==l||Me(g.h,l))){if(!l.L&&Me(g.h,l)&&g.I==3){try{var D=g.Ba.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var z=D;if(z[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)xa(g),ba(g);else break e;ac(g),Nt(18)}}else g.xa=z[1],0<g.xa-g.K&&z[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=en(u(g.Va,g),6e3));$t(g.h)<=1&&g.ta&&(g.ta=void 0)}else Wr(g,11)}else if((l.L||g.g==l)&&xa(g),!k(p))for(z=g.Ba.g.parse(p),p=0;p<z.length;p++){let Kt=z[p];const In=Kt[0];if(!(In<=g.K))if(g.K=In,Kt=Kt[1],g.I==2)if(Kt[0]=="c"){g.M=Kt[1],g.ba=Kt[2];const Is=Kt[3];Is!=null&&(g.ka=Is,g.j.info("VER="+g.ka));const zr=Kt[4];zr!=null&&(g.za=zr,g.j.info("SVER="+g.za));const lr=Kt[5];lr!=null&&typeof lr=="number"&&lr>0&&(D=1.5*lr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const cr=l.g;if(cr){const _a=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_a){var J=D.h;J.g||_a.indexOf("spdy")==-1&&_a.indexOf("quic")==-1&&_a.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(De(J,J.h),J.h=null))}if(D.G){const cc=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;cc&&(D.wa=cc,ht(D.J,D.G,cc))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var xe=l;if(D.na=$u(D,D.L?D.ba:null,D.W),xe.L){ze(D.h,xe);var mt=xe,An=D.O;An&&(mt.H=An),mt.D&&(Qe(mt),Je(mt)),D.g=xe}else Hu(D);g.i.length>0&&Na(g)}else Kt[0]!="stop"&&Kt[0]!="close"||Wr(g,7);else g.I==3&&(Kt[0]=="stop"||Kt[0]=="close"?Kt[0]=="stop"?Wr(g,7):oc(g):Kt[0]!="noop"&&g.l&&g.l.qa(Kt),g.A=0)}}Dt(4)}catch{}}var Xt=class{constructor(l,p){this.g=l,this.map=p}};function ts(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function qn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function $t(l){return l.h?1:l.g?l.g.size:0}function Me(l,p){return l.h?l.h==p:l.g?l.g.has(p):!1}function De(l,p){l.g?l.g.add(p):l.h=p}function ze(l,p){l.h&&l.h==p?l.h=null:l.g&&l.g.has(p)&&l.g.delete(p)}ts.prototype.cancel=function(){if(this.i=ft(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ft(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let p=l.i;for(const g of l.g.values())p=p.concat(g.G);return p}return y(l.i)}var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fe(l,p){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const D=l[g].indexOf("=");let z,J=null;D>=0?(z=l[g].substring(0,D),J=l[g].substring(D+1)):z=l[g],p(z,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Ye(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;l instanceof Ye?(this.l=l.l,pn(this,l.j),this.o=l.o,this.g=l.g,un(this,l.u),this.h=l.h,rr(this,ge(l.i)),this.m=l.m):l&&(p=String(l).match(at))?(this.l=!1,pn(this,p[1]||"",!0),this.o=ir(p[2]||""),this.g=ir(p[3]||"",!0),un(this,p[4]),this.h=ir(p[5]||"",!0),rr(this,p[6]||"",!0),this.m=ir(p[7]||"")):(this.l=!1,this.i=new ar(null,this.l))}Ye.prototype.toString=function(){const l=[];var p=this.j;p&&l.push(or(p,ao,!0),":");var g=this.g;return(g||p=="file")&&(l.push("//"),(p=this.o)&&l.push(or(p,ao,!0),"@"),l.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(or(g,g.charAt(0)=="/"?nc:ya,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",or(g,rc)),l.join("")},Ye.prototype.resolve=function(l){const p=pt(this);let g=!!l.j;g?pn(p,l.j):g=!!l.o,g?p.o=l.o:g=!!l.g,g?p.g=l.g:g=l.u!=null;var D=l.h;if(g)un(p,l.u);else if(g=!!l.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var z=p.h.lastIndexOf("/");z!=-1&&(D=p.h.slice(0,z+1)+D)}if(z=D,z==".."||z==".")D="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){D=z.lastIndexOf("/",0)==0,z=z.split("/");const J=[];for(let xe=0;xe<z.length;){const mt=z[xe++];mt=="."?D&&xe==z.length&&J.push(""):mt==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),D&&xe==z.length&&J.push("")):(J.push(mt),D=!0)}D=J.join("/")}else D=z}return g?p.h=D:g=l.i.toString()!=="",g?rr(p,ge(l.i)):g=!!l.m,g&&(p.m=l.m),p};function pt(l){return new Ye(l)}function pn(l,p,g){l.j=g?ir(p,!0):p,l.j&&(l.j=l.j.replace(/:$/,""))}function un(l,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);l.u=p}else l.u=null}function rr(l,p,g){p instanceof ar?(l.i=p,rt(l.i,l.l)):(g||(p=or(p,sc)),l.i=new ar(p,l.l))}function ht(l,p,g){l.i.set(p,g)}function fi(l){return ht(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ir(l,p){return l?p?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function or(l,p,g){return typeof l=="string"?(l=encodeURI(l).replace(p,ga),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function ga(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ao=/[#\/\?@]/g,ya=/[#\?:]/g,nc=/[#\?]/g,sc=/[#\?@]/g,rc=/#/g;function ar(l,p){this.h=this.g=null,this.i=l||null,this.j=!!p}function b(l){l.g||(l.g=new Map,l.h=0,l.i&&Fe(l.i,function(p,g){l.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=ar.prototype,t.add=function(l,p){b(this),this.i=null,l=he(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(p),this.h+=1,this};function M(l,p){b(l),p=he(l,p),l.g.has(p)&&(l.i=null,l.h-=l.g.get(p).length,l.g.delete(p))}function G(l,p){return b(l),p=he(l,p),l.g.has(p)}t.forEach=function(l,p){b(this),this.g.forEach(function(g,D){g.forEach(function(z){l.call(p,z,D,this)},this)},this)};function K(l,p){b(l);let g=[];if(typeof p=="string")G(l,p)&&(g=g.concat(l.g.get(he(l,p))));else for(l=Array.from(l.g.values()),p=0;p<l.length;p++)g=g.concat(l[p]);return g}t.set=function(l,p){return b(this),this.i=null,l=he(this,l),G(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[p]),this.h+=1,this},t.get=function(l,p){return l?(l=K(this,l),l.length>0?String(l[0]):p):p};function le(l,p,g){M(l,p),g.length>0&&(l.i=null,l.g.set(he(l,p),y(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],p=Array.from(this.g.keys());for(let D=0;D<p.length;D++){var g=p[D];const z=x(g);g=K(this,g);for(let J=0;J<g.length;J++){let xe=z;g[J]!==""&&(xe+="="+x(g[J])),l.push(xe)}}return this.i=l.join("&")};function ge(l){const p=new ar;return p.i=l.i,l.g&&(p.g=new Map(l.g),p.h=l.h),p}function he(l,p){return p=String(p),l.j&&(p=p.toLowerCase()),p}function rt(l,p){p&&!l.j&&(b(l),l.i=null,l.g.forEach(function(g,D){const z=D.toLowerCase();D!=z&&(M(this,D),le(this,z,g))},l)),l.j=p}function gt(l,p){const g=new Sn;if(a.Image){const D=new Image;D.onload=d(St,g,"TestLoadImage: loaded",!0,p,D),D.onerror=d(St,g,"TestLoadImage: error",!1,p,D),D.onabort=d(St,g,"TestLoadImage: abort",!1,p,D),D.ontimeout=d(St,g,"TestLoadImage: timeout",!1,p,D),a.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=l}else p(!1)}function hn(l,p){const g=new Sn,D=new AbortController,z=setTimeout(()=>{D.abort(),St(g,"TestPingServer: timeout",!1,p)},1e4);fetch(l,{signal:D.signal}).then(J=>{clearTimeout(z),J.ok?St(g,"TestPingServer: ok",!0,p):St(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(z),St(g,"TestPingServer: error",!1,p)})}function St(l,p,g,D,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),D(g)}catch{}}function It(){this.g=new jn}function tn(l){this.i=l.Sb||null,this.h=l.ab||!1}f(tn,jt),tn.prototype.g=function(){return new kn(this.i,this.h)};function kn(l,p){dt.call(this),this.H=l,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(kn,dt),t=kn.prototype,t.open=function(l,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=p,this.readyState=1,dn(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(p.body=l),(this.H||a).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Jt(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,dn(this)),this.g&&(this.readyState=3,dn(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kt(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function kt(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var p=l.value?l.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!l.done}))&&(this.response=this.responseText+=p)}l.done?Jt(this):dn(this),this.readyState==3&&kt(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Jt(this))},t.Na=function(l){this.g&&(this.response=l,Jt(this))},t.ga=function(){this.g&&Jt(this)};function Jt(l){l.readyState=4,l.l=null,l.j=null,l.B=null,dn(l)}t.setRequestHeader=function(l,p){this.A.append(l,p)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=p.next();return l.join(`\r
`)};function dn(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(kn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Wt(l){let p="";return qt(l,function(g,D){p+=D,p+=":",p+=g,p+=`\r
`}),p}function zt(l,p,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=Wt(g),typeof l=="string"?g!=null&&x(g):ht(l,p,g))}function yt(l){dt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yt,dt);var Gt=/^https?$/i,ys=["POST","PUT"];t=yt.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,p,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);p=p?p.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rn.g(),this.g.onreadystatechange=h(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(l),!0),this.B=!1}catch(J){Ss(this,J);return}if(l=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var z in D)g.set(z,D[z]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const J of D.keys())g.set(J,D.get(J));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(J=>J.toLowerCase()=="content-type"),z=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(ys,p,void 0)>=0)||D||z||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,xe]of g)this.g.setRequestHeader(J,xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(J){Ss(this,J)}};function Ss(l,p){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=p,l.o=5,pi(l),hi(l)}function pi(l){l.A||(l.A=!0,T(l,"complete"),T(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,T(this,"complete"),T(this,"abort"),hi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hi(this,!0)),yt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ic(this):this.Xa())},t.Xa=function(){ic(this)};function ic(l){if(l.h&&typeof i<"u"){if(l.v&&bs(l)==4)setTimeout(l.Ca.bind(l),0);else if(T(l,"readystatechange"),bs(l)==4){l.h=!1;try{const J=l.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var D;if(D=J===0){let xe=String(l.D).match(at)[1]||null;!xe&&a.self&&a.self.location&&(xe=a.self.location.protocol.slice(0,-1)),D=!Gt.test(xe?xe.toLowerCase():"")}g=D}if(g)T(l,"complete"),T(l,"success");else{l.o=6;try{var z=bs(l)>2?l.g.statusText:""}catch{z=""}l.l=z+" ["+l.ca()+"]",pi(l)}}finally{hi(l)}}}}function hi(l,p){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,p||T(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function bs(l){return l.g?l.g.readyState:0}t.ca=function(){try{return bs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var p=this.g.responseText;return l&&p.indexOf(l)==0&&(p=p.substring(l.length)),ve(p)}};function Tu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function hb(l){const p={};l=(l.g&&bs(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<l.length;D++){if(k(l[D]))continue;var g=E(l[D]);const z=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const J=p[z]||[];p[z]=J,J.push(g)}Mt(p,function(D){return D.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(l,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||p}function ju(l){this.za=0,this.i=[],this.j=new Sn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=lo("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=lo("baseRetryDelayMs",5e3,l),this.Za=lo("retryDelaySeedMs",1e4,l),this.Ta=lo("forwardChannelMaxRetries",2,l),this.va=lo("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new ts(l&&l.concurrentRequestLimit),this.Ba=new It,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ju.prototype,t.ka=8,t.I=1,t.connect=function(l,p,g,D){Nt(0),this.W=l,this.H=p||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=$u(this,null,this.W),Na(this)};function oc(l){if(Ru(l),l.I==3){var p=l.V++,g=pt(l.J);if(ht(g,"SID",l.M),ht(g,"RID",p),ht(g,"TYPE","terminate"),co(l,g),p=new U(l,l.j,p),p.M=2,p.A=fi(pt(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&a.Image&&(new Image().src=p.A,g=!0),g||(p.g=Wu(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Je(p)}qu(l)}function ba(l){l.g&&(lc(l),l.g.cancel(),l.g=null)}function Ru(l){ba(l),l.v&&(a.clearTimeout(l.v),l.v=null),xa(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function Na(l){if(!qn(l.h)&&!l.m){l.m=!0;var p=l.Ea;ee||N(),F||(ee(),F=!0),C.add(p,l),l.D=0}}function gb(l,p){return $t(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=p.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=en(u(l.Ea,l,p),Ou(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const z=new U(this,this.j,l);let J=this.o;if(this.U&&(J?(J=ae(J),fe(J,this.U)):J=this.U),this.u!==null||this.R||(z.J=J,J=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Uu(this,z,p),g=pt(this.J),ht(g,"RID",l),ht(g,"CVER",22),this.G&&ht(g,"X-HTTP-Session-Id",this.G),co(this,g),J&&(this.R?p="headers="+x(Wt(J))+"&"+p:this.u&&zt(g,this.u,J)),De(this.h,z),this.Ra&&ht(g,"TYPE","init"),this.S?(ht(g,"$req",p),ht(g,"SID","null"),z.U=!0,q(z,g,null)):q(z,g,p),this.I=2}}else this.I==3&&(l?Bu(this,l):this.i.length==0||qn(this.h)||Bu(this))};function Bu(l,p){var g;p?g=p.l:g=l.V++;const D=pt(l.J);ht(D,"SID",l.M),ht(D,"RID",g),ht(D,"AID",l.K),co(l,D),l.u&&l.o&&zt(D,l.u,l.o),g=new U(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),p&&(l.i=p.G.concat(l.i)),p=Uu(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),De(l.h,g),q(g,D,p)}function co(l,p){l.H&&qt(l.H,function(g,D){ht(p,D,g)}),l.l&&qt({},function(g,D){ht(p,D,g)})}function Uu(l,p,g){g=Math.min(l.i.length,g);const D=l.l?u(l.l.Ka,l.l,l):null;e:{var z=l.i;let mt=-1;for(;;){const An=["count="+g];mt==-1?g>0?(mt=z[0].g,An.push("ofs="+mt)):mt=0:An.push("ofs="+mt);let Kt=!0;for(let In=0;In<g;In++){var J=z[In].g;const Is=z[In].map;if(J-=mt,J<0)mt=Math.max(0,z[In].g-100),Kt=!1;else try{J="req"+J+"_"||"";try{var xe=Is instanceof Map?Is:Object.entries(Is);for(const[zr,lr]of xe){let cr=lr;c(lr)&&(cr=Ge(lr)),An.push(J+zr+"="+encodeURIComponent(cr))}}catch(zr){throw An.push(J+"type="+encodeURIComponent("_badmap")),zr}}catch{D&&D(Is)}}if(Kt){xe=An.join("&");break e}}xe=void 0}return l=l.i.splice(0,g),p.G=l,xe}function Hu(l){if(!l.g&&!l.v){l.Y=1;var p=l.Da;ee||N(),F||(ee(),F=!0),C.add(p,l),l.A=0}}function ac(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=en(u(l.Da,l),Ou(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Mu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=en(u(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Nt(10),ba(this),Mu(this))};function lc(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function Mu(l){l.g=new U(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var p=pt(l.na);ht(p,"RID","rpc"),ht(p,"SID",l.M),ht(p,"AID",l.K),ht(p,"CI",l.F?"0":"1"),!l.F&&l.ia&&ht(p,"TO",l.ia),ht(p,"TYPE","xmlhttp"),co(l,p),l.u&&l.o&&zt(p,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=fi(pt(p)),g.u=null,g.R=!0,Y(g,l)}t.Va=function(){this.C!=null&&(this.C=null,ba(this),ac(this),Nt(19))};function xa(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Fu(l,p){var g=null;if(l.g==p){xa(l),lc(l),l.g=null;var D=2}else if(Me(l.h,p))g=p.G,ze(l.h,p),D=1;else return;if(l.I!=0){if(p.o)if(D==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var z=l.D;D=ue(),T(D,new mn(D,g)),Na(l)}else Hu(l);else if(z=p.m,z==3||z==0&&p.X>0||!(D==1&&gb(l,p)||D==2&&ac(l)))switch(g&&g.length>0&&(p=l.h,p.i=p.i.concat(g)),z){case 1:Wr(l,5);break;case 4:Wr(l,10);break;case 3:Wr(l,6);break;default:Wr(l,2)}}}function Ou(l,p){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*p}function Wr(l,p){if(l.j.info("Error code "+p),p==2){var g=u(l.bb,l),D=l.Ua;const z=!D;D=new Ye(D||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||pn(D,"https"),fi(D),z?gt(D.toString(),g):hn(D.toString(),g)}else Nt(2);l.I=0,l.l&&l.l.pa(p),qu(l),Ru(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function qu(l){if(l.I=0,l.ja=[],l.l){const p=ft(l.h);(p.length!=0||l.i.length!=0)&&(w(l.ja,p),w(l.ja,l.i),l.h.i.length=0,y(l.i),l.i.length=0),l.l.oa()}}function $u(l,p,g){var D=g instanceof Ye?pt(g):new Ye(g);if(D.g!="")p&&(D.g=p+"."+D.g),un(D,D.u);else{var z=a.location;D=z.protocol,p=p?p+"."+z.hostname:z.hostname,z=+z.port;const J=new Ye(null);D&&pn(J,D),p&&(J.g=p),z&&un(J,z),g&&(J.h=g),D=J}return g=l.G,p=l.wa,g&&p&&ht(D,g,p),ht(D,"VER",l.ka),co(l,D),D}function Wu(l,p,g){if(p&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=l.Aa&&!l.ma?new yt(new tn({ab:g})):new yt(l.ma),p.Fa(l.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}t=zu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function va(){}va.prototype.g=function(l,p){return new os(l,p)};function os(l,p){dt.call(this),this.g=new ju(p),this.l=l,this.h=p&&p.messageUrlParams||null,l=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(l?l["X-WebChannel-Content-Type"]=p.messageContentType:l={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(l?l["X-WebChannel-Client-Profile"]=p.sa:l={"X-WebChannel-Client-Profile":p.sa}),this.g.U=l,(l=p&&p.Qb)&&!k(l)&&(this.g.u=l),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,l=this.h,l!==null&&p in l&&(l=this.h,p in l&&delete l[p])),this.j=new gi(this)}f(os,dt),os.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},os.prototype.close=function(){oc(this.g)},os.prototype.o=function(l){var p=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=Ge(l),l=g);p.i.push(new Xt(p.Ya++,l)),p.I==3&&Na(p)},os.prototype.N=function(){this.g.l=null,delete this.j,oc(this.g),delete this.g,os.Z.N.call(this)};function Ku(l){B.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var p=l.__sm__;if(p){e:{for(const g in p){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,p=p!==null&&l in p?p[l]:void 0),this.data=p}else this.data=l}f(Ku,B);function Qu(){be.call(this),this.status=1}f(Qu,be);function gi(l){this.g=l}f(gi,zu),gi.prototype.ra=function(){T(this.g,"a")},gi.prototype.qa=function(l){T(this.g,new Ku(l))},gi.prototype.pa=function(l){T(this.g,new Qu)},gi.prototype.oa=function(){T(this.g,"b")},va.prototype.createWebChannel=va.prototype.g,os.prototype.send=os.prototype.o,os.prototype.open=os.prototype.m,os.prototype.close=os.prototype.close,sh=function(){return new va},nh=function(){return ue()},th=Ae,qc={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},es.NO_ERROR=0,es.TIMEOUT=8,es.HTTP_ERROR=6,Wa=es,ws.COMPLETE="complete",eh=ws,ot.EventType=re,re.OPEN="a",re.CLOSE="b",re.ERROR="c",re.MESSAGE="d",dt.prototype.listen=dt.prototype.J,Vo=ot,yt.prototype.listenOnce=yt.prototype.K,yt.prototype.getLastError=yt.prototype.Ha,yt.prototype.getLastErrorCode=yt.prototype.ya,yt.prototype.getStatus=yt.prototype.ca,yt.prototype.getResponseJson=yt.prototype.La,yt.prototype.getResponseText=yt.prototype.la,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Fa,Zp=yt}).apply(typeof ka<"u"?ka:typeof self<"u"?self:typeof window<"u"?window:{});const gd="@firebase/firestore",yd="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zn.UNAUTHENTICATED=new zn(null),zn.GOOGLE_CREDENTIALS=new zn("google-credentials-uid"),zn.FIRST_PARTY=new zn("first-party-uid"),zn.MOCK_USER=new zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gi="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new Op("@firebase/firestore");function Pi(){return ni.logLevel}function Ce(t,...e){if(ni.logLevel<=Et.DEBUG){const n=e.map(wm);ni.debug(`Firestore (${Gi}): ${t}`,...n)}}function Zs(t,...e){if(ni.logLevel<=Et.ERROR){const n=e.map(wm);ni.error(`Firestore (${Gi}): ${t}`,...n)}}function Oi(t,...e){if(ni.logLevel<=Et.WARN){const n=e.map(wm);ni.warn(`Firestore (${Gi}): ${t}`,...n)}}function wm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,rh(t,s,n)}function rh(t,e,n){let s=`FIRESTORE (${Gi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Zs(s),new Error(s)}function Ht(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||rh(e,r,s)}function et(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends oi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(zn.UNAUTHENTICATED))}shutdown(){}}class Ax{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Ex{constructor(e){this.t=e,this.currentUser=zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ht(this.o===void 0,42304);let s=this.i;const r=m=>this.i!==s?(s=this.i,n(m)):Promise.resolve();let i=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ys,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const m=i;e.enqueueRetryable(async()=>{await m.promise,await r(this.currentUser)})},c=m=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(m=>c(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?c(m):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ys)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ht(typeof s.accessToken=="string",31837,{l:s}),new ih(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ht(e===null||typeof e=="string",2055,{h:e}),new zn(e)}}class Vx{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=zn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Cx{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new Vx(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(zn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wx{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ht(this.o===void 0,3512);const s=i=>{i.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ce("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ht(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new bd(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Sx(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function vt(t,e){return t<e?-1:t>e?1:0}function $c(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return yc(r)===yc(i)?vt(r,i):yc(r)?1:-1}return vt(t.length,e.length)}const Ix=55296,Px=57343;function yc(t){const e=t.charCodeAt(0);return e>=Ix&&e<=Px}function qi(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="__name__";class Ls{constructor(e,n,s){n===void 0?n=0:n>e.length&&Ze(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&Ze(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=Ls.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return vt(e.length,n.length)}static compareSegments(e,n){const s=Ls.isNumericId(e),r=Ls.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Ls.extractNumericId(e).compare(Ls.extractNumericId(n)):$c(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Dr.fromString(e.substring(4,e.length-2))}}class Yt extends Ls{construct(e,n,s){return new Yt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ee(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Yt(n)}static emptyPath(){return new Yt([])}}const Lx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hn extends Ls{construct(e,n,s){return new Hn(e,n,s)}static isValidIdentifier(e){return Lx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Nd}static keyField(){return new Hn([Nd])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Ee(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let a=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new Ee(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[r+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ee(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(s+=c,r++):(i(),r++)}if(i(),a)throw new Ee(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hn(n)}static emptyPath(){return new Hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Yt.fromString(e))}static fromName(e){return new $e(Yt.fromString(e).popFirst(5))}static empty(){return new $e(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Yt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(t,e,n){if(!n)throw new Ee(se.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Tx(t,e,n,s){if(e===!0&&s===!0)throw new Ee(se.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function xd(t){if(!$e.isDocumentKey(t))throw new Ee(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vd(t){if($e.isDocumentKey(t))throw new Ee(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ah(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function El(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ze(12329,{type:typeof t})}function Cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ee(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=El(t);throw new Ee(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t,e){const n={typeString:t};return e&&(n.value=e),n}function ia(t,e){if(!ah(t))throw new Ee(se.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const a=t[s];if(r&&typeof a!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new Ee(se.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d=-62135596800,Dd=1e6;class Ne{static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Dd);return new Ne(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<_d)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Dd}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ia(e,Ne._jsonSchema))return new Ne(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_d;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ne._jsonSchemaVersion="firestore/timestamp/1.0",Ne._jsonSchema={type:_n("string",Ne._jsonSchemaVersion),seconds:_n("number"),nanoseconds:_n("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{static fromTimestamp(e){return new tt(e)}static min(){return new tt(new Ne(0,0))}static max(){return new tt(new Ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=-1;function jx(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=tt.fromTimestamp(s===1e9?new Ne(n+1,0):new Ne(n,s));return new Er(r,$e.empty(),e)}function Rx(t){return new Er(t.readTime,t.key,zo)}class Er{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Er(tt.min(),$e.empty(),zo)}static max(){return new Er(tt.max(),$e.empty(),zo)}}function Bx(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=$e.comparator(t.documentKey,e.documentKey),n!==0?n:vt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xi(t){if(t.code!==se.FAILED_PRECONDITION||t.message!==Ux)throw t;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ce((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ce?n:ce.resolve(n)}catch(n){return ce.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ce.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ce.reject(n)}static resolve(e){return new ce((n,s)=>{n(e)})}static reject(e){return new ce((n,s)=>{s(e)})}static waitFor(e){return new ce((n,s)=>{let r=0,i=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++i,a&&i===r&&n()},m=>s(m))}),a=!0,i===r&&n()})}static or(e){let n=ce.resolve(!1);for(const s of e)n=n.next(r=>r?ce.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new ce((s,r)=>{const i=e.length,a=new Array(i);let c=0;for(let m=0;m<i;m++){const u=m;n(e[u]).next(d=>{a[u]=d,++c,c===i&&s(a)},d=>r(d))}})}static doWhile(e,n){return new ce((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function Mx(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ji(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Vl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=-1;function Cl(t){return t==null}function il(t){return t===0&&1/t==-1/0}function Fx(t){return typeof t=="number"&&Number.isInteger(t)&&!il(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="";function Ox(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=kd(e)),e=qx(t.get(n),e);return kd(e)}function qx(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case lh:n+="";break;default:n+=i}}return n}function kd(t){return t+lh+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Tr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ch(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,n){this.comparator=e,this.root=n||Bn.EMPTY}insert(e,n){return new nn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Bn.BLACK,null,null))}remove(e){return new nn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Aa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Aa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Aa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Aa(this.root,e,this.comparator,!0)}}class Aa{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bn{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Bn.RED,this.left=r??Bn.EMPTY,this.right=i??Bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Bn(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Bn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}Bn.EMPTY=null,Bn.RED=!0,Bn.BLACK=!1;Bn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new Bn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.comparator=e,this.data=new nn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ed(this.data.getIterator())}getIteratorFrom(e){return new Ed(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof wn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new wn(this.comparator);return n.data=e,n}}class Ed{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this.fields=e,e.sort(Hn.comparator)}static empty(){return new ls([])}unionWith(e){let n=new wn(Hn.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new ls(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qi(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mh("Invalid base64 string: "+i):i}}(e);return new Fn(n)}static fromUint8Array(e){const n=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Fn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fn.EMPTY_BYTE_STRING=new Fn("");const $x=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vr(t){if(Ht(!!t,39018),typeof t=="string"){let e=0;const n=$x.exec(t);if(Ht(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:fn(t.seconds),nanos:fn(t.nanos)}}function fn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Cr(t){return typeof t=="string"?Fn.fromBase64String(t):Fn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="server_timestamp",dh="__type__",fh="__previous_value__",ph="__local_write_time__";function Pm(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dh])==null?void 0:s.stringValue)===uh}function wl(t){const e=t.mapValue.fields[fh];return Pm(e)?wl(e):e}function Ko(t){const e=Vr(t.mapValue.fields[ph].timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,s,r,i,a,c,m,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=m,this.useFetchStreams=u,this.isUsingEmulator=d}}const ol="(default)";class Qo{constructor(e,n){this.projectId=e,this.database=n||ol}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===ol}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="__type__",zx="__max__",Ea={mapValue:{}},gh="__vector__",al="value";function wr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pm(t)?4:Qx(t)?9007199254740991:Kx(t)?10:11:Ze(28295,{value:t})}function Os(t,e){if(t===e)return!0;const n=wr(t);if(n!==wr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ko(t).isEqual(Ko(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Vr(r.timestampValue),c=Vr(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Cr(r.bytesValue).isEqual(Cr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return fn(r.geoPointValue.latitude)===fn(i.geoPointValue.latitude)&&fn(r.geoPointValue.longitude)===fn(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return fn(r.integerValue)===fn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=fn(r.doubleValue),c=fn(i.doubleValue);return a===c?il(a)===il(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return qi(t.arrayValue.values||[],e.arrayValue.values||[],Os);case 10:case 11:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(Ad(a)!==Ad(c))return!1;for(const m in a)if(a.hasOwnProperty(m)&&(c[m]===void 0||!Os(a[m],c[m])))return!1;return!0}(t,e);default:return Ze(52216,{left:t})}}function Yo(t,e){return(t.values||[]).find(n=>Os(n,e))!==void 0}function $i(t,e){if(t===e)return 0;const n=wr(t),s=wr(e);if(n!==s)return vt(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return vt(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=fn(i.integerValue||i.doubleValue),m=fn(a.integerValue||a.doubleValue);return c<m?-1:c>m?1:c===m?0:isNaN(c)?isNaN(m)?0:-1:1}(t,e);case 3:return Vd(t.timestampValue,e.timestampValue);case 4:return Vd(Ko(t),Ko(e));case 5:return $c(t.stringValue,e.stringValue);case 6:return function(i,a){const c=Cr(i),m=Cr(a);return c.compareTo(m)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),m=a.split("/");for(let u=0;u<c.length&&u<m.length;u++){const d=vt(c[u],m[u]);if(d!==0)return d}return vt(c.length,m.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=vt(fn(i.latitude),fn(a.latitude));return c!==0?c:vt(fn(i.longitude),fn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Cd(t.arrayValue,e.arrayValue);case 10:return function(i,a){var h,y,w,_;const c=i.fields||{},m=a.fields||{},u=(h=c[al])==null?void 0:h.arrayValue,d=(y=m[al])==null?void 0:y.arrayValue,f=vt(((w=u==null?void 0:u.values)==null?void 0:w.length)||0,((_=d==null?void 0:d.values)==null?void 0:_.length)||0);return f!==0?f:Cd(u,d)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ea.mapValue&&a===Ea.mapValue)return 0;if(i===Ea.mapValue)return 1;if(a===Ea.mapValue)return-1;const c=i.fields||{},m=Object.keys(c),u=a.fields||{},d=Object.keys(u);m.sort(),d.sort();for(let f=0;f<m.length&&f<d.length;++f){const h=$c(m[f],d[f]);if(h!==0)return h;const y=$i(c[m[f]],u[d[f]]);if(y!==0)return y}return vt(m.length,d.length)}(t.mapValue,e.mapValue);default:throw Ze(23264,{he:n})}}function Vd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return vt(t,e);const n=Vr(t),s=Vr(e),r=vt(n.seconds,s.seconds);return r!==0?r:vt(n.nanos,s.nanos)}function Cd(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=$i(n[r],s[r]);if(i)return i}return vt(n.length,s.length)}function Wi(t){return Wc(t)}function Wc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=Vr(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Cr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return $e.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=Wc(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const a of s)i?i=!1:r+=",",r+=`${a}:${Wc(n.fields[a])}`;return r+"}"}(t.mapValue):Ze(61005,{value:t})}function za(t){switch(wr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wl(t);return e?16+za(e):16;case 5:return 2*t.stringValue.length;case 6:return Cr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+za(i),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Tr(s.fields,(i,a)=>{r+=i.length+za(a)}),r}(t.mapValue);default:throw Ze(13486,{value:t})}}function wd(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function zc(t){return!!t&&"integerValue"in t}function Lm(t){return!!t&&"arrayValue"in t}function Sd(t){return!!t&&"nullValue"in t}function Id(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ka(t){return!!t&&"mapValue"in t}function Kx(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[hh])==null?void 0:s.stringValue)===gh}function Lo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Tr(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Lo(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lo(t.arrayValue.values[n]);return e}return{...t}}function Qx(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===zx}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.value=e}static empty(){return new is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Ka(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lo(n)}setAll(e){let n=Hn.emptyPath(),s={},r=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const m=this.getFieldsMap(n);this.applyChanges(m,s,r),s={},r=[],n=c.popLast()}a?s[c.lastSegment()]=Lo(a):r.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Ka(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Os(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Ka(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Tr(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new is(Lo(this.value))}}function yh(t){const e=[];return Tr(t.fields,(n,s)=>{const r=new Hn([n]);if(Ka(s)){const i=yh(s.mapValue).fields;if(i.length===0)e.push(r);else for(const a of i)e.push(r.child(a))}else e.push(r)}),new ls(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,n,s,r,i,a,c){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Kn(e,0,tt.min(),tt.min(),tt.min(),is.empty(),0)}static newFoundDocument(e,n,s,r){return new Kn(e,1,n,tt.min(),s,r,0)}static newNoDocument(e,n){return new Kn(e,2,n,tt.min(),tt.min(),is.empty(),0)}static newUnknownDocument(e,n){return new Kn(e,3,n,tt.min(),tt.min(),is.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n){this.position=e,this.inclusive=n}}function Pd(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],a=t.position[r];if(i.field.isKeyField()?s=$e.comparator($e.fromName(a.referenceValue),n.key):s=$i(a,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Ld(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Os(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n="asc"){this.field=e,this.dir=n}}function Yx(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{}class vn extends bh{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new Xx(e,n,s):n==="array-contains"?new ev(e,s):n==="in"?new tv(e,s):n==="not-in"?new nv(e,s):n==="array-contains-any"?new sv(e,s):new vn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new Jx(e,s):new Zx(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison($i(n,this.value)):n!==null&&wr(this.value)===wr(n)&&this.matchesComparison($i(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class As extends bh{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new As(e,n)}matches(e){return Nh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nh(t){return t.op==="and"}function xh(t){return Gx(t)&&Nh(t)}function Gx(t){for(const e of t.filters)if(e instanceof As)return!1;return!0}function Kc(t){if(t instanceof vn)return t.field.canonicalString()+t.op.toString()+Wi(t.value);if(xh(t))return t.filters.map(e=>Kc(e)).join(",");{const e=t.filters.map(n=>Kc(n)).join(",");return`${t.op}(${e})`}}function vh(t,e){return t instanceof vn?function(s,r){return r instanceof vn&&s.op===r.op&&s.field.isEqual(r.field)&&Os(s.value,r.value)}(t,e):t instanceof As?function(s,r){return r instanceof As&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,a,c)=>i&&vh(a,r.filters[c]),!0):!1}(t,e):void Ze(19439)}function _h(t){return t instanceof vn?function(n){return`${n.field.canonicalString()} ${n.op} ${Wi(n.value)}`}(t):t instanceof As?function(n){return n.op.toString()+" {"+n.getFilters().map(_h).join(" ,")+"}"}(t):"Filter"}class Xx extends vn{constructor(e,n,s){super(e,n,s),this.key=$e.fromName(s.referenceValue)}matches(e){const n=$e.comparator(e.key,this.key);return this.matchesComparison(n)}}class Jx extends vn{constructor(e,n){super(e,"in",n),this.keys=Dh("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Zx extends vn{constructor(e,n){super(e,"not-in",n),this.keys=Dh("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Dh(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(s=>$e.fromName(s.referenceValue))}class ev extends vn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lm(n)&&Yo(n.arrayValue,this.value)}}class tv extends vn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yo(this.value.arrayValue,n)}}class nv extends vn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Yo(this.value.arrayValue,n)}}class sv extends vn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Yo(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n=null,s=[],r=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Td(t,e=null,n=[],s=[],r=null,i=null,a=null){return new rv(t,e,n,s,r,i,a)}function Tm(t){const e=et(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Kc(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Cl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Wi(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Wi(s)).join(",")),e.Te=n}return e.Te}function jm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Yx(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ld(t.startAt,e.startAt)&&Ld(t.endAt,e.endAt)}function Qc(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n=null,s=[],r=[],i=null,a="F",c=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iv(t,e,n,s,r,i,a,c){return new Zi(t,e,n,s,r,i,a,c)}function Sl(t){return new Zi(t)}function jd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kh(t){return t.collectionGroup!==null}function To(t){const e=et(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new wn(Hn.comparator);return a.filters.forEach(m=>{m.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Go(i,s))}),n.has(Hn.keyField().canonicalString())||e.Ie.push(new Go(Hn.keyField(),s))}return e.Ie}function Bs(t){const e=et(t);return e.Ee||(e.Ee=ov(e,To(t))),e.Ee}function ov(t,e){if(t.limitType==="F")return Td(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Go(r.field,i)});const n=t.endAt?new ll(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ll(t.startAt.position,t.startAt.inclusive):null;return Td(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function Yc(t,e){const n=t.filters.concat([e]);return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gc(t,e,n){return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Il(t,e){return jm(Bs(t),Bs(e))&&t.limitType===e.limitType}function Ah(t){return`${Tm(Bs(t))}|lt:${t.limitType}`}function Li(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>_h(r)).join(", ")}]`),Cl(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>Wi(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>Wi(r)).join(",")),`Target(${s})`}(Bs(t))}; limitType=${t.limitType})`}function Pl(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):$e.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of To(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(a,c,m){const u=Pd(a,c,m);return a.inclusive?u<=0:u<0}(s.startAt,To(s),r)||s.endAt&&!function(a,c,m){const u=Pd(a,c,m);return a.inclusive?u>=0:u>0}(s.endAt,To(s),r))}(t,e)}function av(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Eh(t){return(e,n)=>{let s=!1;for(const r of To(t)){const i=lv(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function lv(t,e,n){const s=t.field.isKeyField()?$e.comparator(e.key,n.key):function(i,a,c){const m=a.data.field(i),u=c.data.field(i);return m!==null&&u!==null?$i(m,u):Ze(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Ze(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Tr(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return ch(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv=new nn($e.comparator);function er(){return cv}const Vh=new nn($e.comparator);function Co(...t){let e=Vh;for(const n of t)e=e.insert(n.key,n);return e}function Ch(t){let e=Vh;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Gr(){return jo()}function wh(){return jo()}function jo(){return new ai(t=>t.toString(),(t,e)=>t.isEqual(e))}const mv=new nn($e.comparator),uv=new wn($e.comparator);function _t(...t){let e=uv;for(const n of t)e=e.add(n);return e}const dv=new wn(vt);function fv(){return dv}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:il(e)?"-0":e}}function Sh(t){return{integerValue:""+t}}function pv(t,e){return Fx(e)?Sh(e):Rm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this._=void 0}}function hv(t,e,n){return t instanceof Xo?function(r,i){const a={fields:{[dh]:{stringValue:uh},[ph]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Pm(i)&&(i=wl(i)),i&&(a.fields[fh]=i),{mapValue:a}}(n,e):t instanceof Jo?Ph(t,e):t instanceof Zo?Lh(t,e):function(r,i){const a=Ih(r,i),c=Rd(a)+Rd(r.Ae);return zc(a)&&zc(r.Ae)?Sh(c):Rm(r.serializer,c)}(t,e)}function gv(t,e,n){return t instanceof Jo?Ph(t,e):t instanceof Zo?Lh(t,e):n}function Ih(t,e){return t instanceof cl?function(s){return zc(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Xo extends Ll{}class Jo extends Ll{constructor(e){super(),this.elements=e}}function Ph(t,e){const n=Th(e);for(const s of t.elements)n.some(r=>Os(r,s))||n.push(s);return{arrayValue:{values:n}}}class Zo extends Ll{constructor(e){super(),this.elements=e}}function Lh(t,e){let n=Th(e);for(const s of t.elements)n=n.filter(r=>!Os(r,s));return{arrayValue:{values:n}}}class cl extends Ll{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Rd(t){return fn(t.integerValue||t.doubleValue)}function Th(t){return Lm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,n){this.field=e,this.transform=n}}function bv(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof Jo&&r instanceof Jo||s instanceof Zo&&r instanceof Zo?qi(s.elements,r.elements,Os):s instanceof cl&&r instanceof cl?Os(s.Ae,r.Ae):s instanceof Xo&&r instanceof Xo}(t.transform,e.transform)}class Nv{constructor(e,n){this.version=e,this.transformResults=n}}class Zn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zn}static exists(e){return new Zn(void 0,e)}static updateTime(e){return new Zn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tl{}function jh(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jl(t.key,Zn.none()):new oa(t.key,t.data,Zn.none());{const n=t.data,s=is.empty();let r=new wn(Hn.comparator);for(let i of e.fields)if(!r.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?s.delete(i):s.set(i,a),r=r.add(i)}return new jr(t.key,s,new ls(r.toArray()),Zn.none())}}function xv(t,e,n){t instanceof oa?function(r,i,a){const c=r.value.clone(),m=Ud(r.fieldTransforms,i,a.transformResults);c.setAll(m),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof jr?function(r,i,a){if(!Qa(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Ud(r.fieldTransforms,i,a.transformResults),m=i.data;m.setAll(Rh(r)),m.setAll(c),i.convertToFoundDocument(a.version,m).setHasCommittedMutations()}(t,e,n):function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Ro(t,e,n,s){return t instanceof oa?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=i.value.clone(),d=Hd(i.fieldTransforms,m,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof jr?function(i,a,c,m){if(!Qa(i.precondition,a))return c;const u=Hd(i.fieldTransforms,m,a),d=a.data;return d.setAll(Rh(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,s):function(i,a,c){return Qa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function vv(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Ih(s.transform,r||null);i!=null&&(n===null&&(n=is.empty()),n.set(s.field,i))}return n||null}function Bd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&qi(s,r,(i,a)=>bv(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class oa extends Tl{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class jr extends Tl{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Rh(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function Ud(t,e,n){const s=new Map;Ht(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],a=i.transform,c=e.data.field(i.field);s.set(i.field,gv(a,c,n[r]))}return s}function Hd(t,e,n){const s=new Map;for(const r of t){const i=r.transform,a=n.data.field(r.field);s.set(r.field,hv(i,a,e))}return s}class jl extends Tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _v extends Tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&xv(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Ro(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Ro(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=wh();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(r.key)?null:c;const m=jh(a,c);m!==null&&s.set(r.key,m),a.isValidDocument()||a.convertToNoDocument(tt.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),_t())}isEqual(e){return this.batchId===e.batchId&&qi(this.mutations,e.mutations,(n,s)=>Bd(n,s))&&qi(this.baseMutations,e.baseMutations,(n,s)=>Bd(n,s))}}class Bm{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Ht(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return mv}();const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,s[a].version);return new Bm(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,At;function Ev(t){switch(t){case se.OK:return Ze(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Ze(15467,{code:t})}}function Bh(t){if(t===void 0)return Zs("GRPC error has no .code"),se.UNKNOWN;switch(t){case yn.OK:return se.OK;case yn.CANCELLED:return se.CANCELLED;case yn.UNKNOWN:return se.UNKNOWN;case yn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case yn.INTERNAL:return se.INTERNAL;case yn.UNAVAILABLE:return se.UNAVAILABLE;case yn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case yn.NOT_FOUND:return se.NOT_FOUND;case yn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case yn.ABORTED:return se.ABORTED;case yn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case yn.DATA_LOSS:return se.DATA_LOSS;default:return Ze(39323,{code:t})}}(At=yn||(yn={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv=new Dr([4294967295,4294967295],0);function Md(t){const e=Vv().encode(t),n=new Jp;return n.update(e),new Uint8Array(n.digest())}function Fd(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Dr([n,s],0),new Dr([r,i],0)]}class Um{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new wo(`Invalid padding: ${n}`);if(s<0)throw new wo(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new wo(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new wo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Dr.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(Dr.fromNumber(s)));return r.compare(Cv)===1&&(r=new Dr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Md(e),[s,r]=Fd(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);if(!this.we(a))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Um(i,r,n);return s.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const n=Md(e),[s,r]=Fd(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(s,r,i);this.Se(a)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,aa.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Rl(tt.min(),r,new nn(vt),er(),_t())}}class aa{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new aa(s,n,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class Uh{constructor(e,n){this.targetId=e,this.Ce=n}}class Hh{constructor(e,n,s=Fn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class Od{constructor(){this.ve=0,this.Fe=qd(),this.Me=Fn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),n=_t(),s=_t();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:Ze(38017,{changeType:i})}}),new aa(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=qd()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ht(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wv{constructor(e){this.Ge=e,this.ze=new Map,this.je=er(),this.Je=Va(),this.He=Va(),this.Ye=new nn(vt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:Ze(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(Qc(i))if(s===0){const a=new $e(i.path);this.et(n,a,Kn.newNoDocument(a,tt.min()))}else Ht(s===1,20013,{expectedCount:s});else{const a=this._t(n);if(a!==s){const c=this.ut(e),m=c?this.ct(c,e,a):1;if(m!==0){this.it(n);const u=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let a,c;try{a=Cr(s).toUint8Array()}catch(m){if(m instanceof mh)return Oi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{c=new Um(a,r,i)}catch(m){return Oi(m instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return c.ge===0?null:c}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Qc(c.target)){const m=new $e(c.target.path);this.It(m).has(a)||this.Et(a,m)||this.et(a,m,Kn.newNoDocument(m,e))}i.Be&&(n.set(a,i.ke()),i.qe())}});let s=_t();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(m=>{const u=this.ot(m);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(s=s.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const r=new Rl(e,n,this.Ye,this.je,s);return this.je=er(),this.Je=Va(),this.He=Va(),this.Ye=new nn(vt),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Od,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new wn(vt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new wn(vt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ce("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Od),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Va(){return new nn($e.comparator)}function qd(){return new nn($e.comparator)}const Sv={asc:"ASCENDING",desc:"DESCENDING"},Iv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pv={and:"AND",or:"OR"};class Lv{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xc(t,e){return t.useProto3Json||Cl(e)?e:{value:e}}function ml(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Tv(t,e){return ml(t,e.toTimestamp())}function Us(t){return Ht(!!t,49232),tt.fromTimestamp(function(n){const s=Vr(n);return new Ne(s.seconds,s.nanos)}(t))}function Hm(t,e){return Jc(t,e).canonicalString()}function Jc(t,e){const n=function(r){return new Yt(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Fh(t){const e=Yt.fromString(t);return Ht(zh(e),10190,{key:e.toString()}),e}function Zc(t,e){return Hm(t.databaseId,e.path)}function bc(t,e){const n=Fh(e);if(n.get(1)!==t.databaseId.projectId)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $e(qh(n))}function Oh(t,e){return Hm(t.databaseId,e)}function jv(t){const e=Fh(t);return e.length===4?Yt.emptyPath():qh(e)}function em(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qh(t){return Ht(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $d(t,e,n){return{name:Zc(t,e),fields:n.value.mapValue.fields}}function Rv(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ze(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Ht(d===void 0||typeof d=="string",58123),Fn.fromBase64String(d||"")):(Ht(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Fn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(u){const d=u.code===void 0?se.UNKNOWN:Bh(u.code);return new Ee(d,u.message||"")}(a);n=new Hh(s,r,i,c||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=bc(t,s.document.name),i=Us(s.document.updateTime),a=s.document.createTime?Us(s.document.createTime):tt.min(),c=new is({mapValue:{fields:s.document.fields}}),m=Kn.newFoundDocument(r,i,a,c),u=s.targetIds||[],d=s.removedTargetIds||[];n=new Ya(u,d,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=bc(t,s.document),i=s.readTime?Us(s.readTime):tt.min(),a=Kn.newNoDocument(r,i),c=s.removedTargetIds||[];n=new Ya([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=bc(t,s.document),i=s.removedTargetIds||[];n=new Ya([],i,r,null)}else{if(!("filter"in e))return Ze(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,a=new Av(r,i),c=s.targetId;n=new Uh(c,a)}}return n}function Bv(t,e){let n;if(e instanceof oa)n={update:$d(t,e.key,e.value)};else if(e instanceof jl)n={delete:Zc(t,e.key)};else if(e instanceof jr)n={update:$d(t,e.key,e.data),updateMask:zv(e.fieldMask)};else{if(!(e instanceof _v))return Ze(16599,{Vt:e.type});n={verify:Zc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,a){const c=a.transform;if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Jo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof cl)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Ze(20930,{transform:a.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:Tv(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ze(27497)}(t,e.precondition)),n}function Uv(t,e){return t&&t.length>0?(Ht(e!==void 0,14353),t.map(n=>function(r,i){let a=r.updateTime?Us(r.updateTime):Us(i);return a.isEqual(tt.min())&&(a=Us(i)),new Nv(a,r.transformResults||[])}(n,e))):[]}function Hv(t,e){return{documents:[Oh(t,e.path)]}}function Mv(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Oh(t,r);const i=function(u){if(u.length!==0)return Wh(As.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(d=>function(h){return{field:Ti(h.field),direction:qv(h.dir)}}(d))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=Xc(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:r}}function Fv(t){let e=jv(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Ht(s===1,65062);const d=n.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const h=$h(f);return h instanceof As&&xh(h)?h.getFilters():[h]}(n.where));let a=[];n.orderBy&&(a=function(f){return f.map(h=>function(w){return new Go(ji(w.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(h))}(n.orderBy));let c=null;n.limit&&(c=function(f){let h;return h=typeof f=="object"?f.value:f,Cl(h)?null:h}(n.limit));let m=null;n.startAt&&(m=function(f){const h=!!f.before,y=f.values||[];return new ll(y,h)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const h=!f.before,y=f.values||[];return new ll(y,h)}(n.endAt)),iv(e,r,a,i,c,"F",m,u)}function Ov(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $h(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=ji(n.unaryFilter.field);return vn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ji(n.unaryFilter.field);return vn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ji(n.unaryFilter.field);return vn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ji(n.unaryFilter.field);return vn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}}(t):t.fieldFilter!==void 0?function(n){return vn.create(ji(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return As.create(n.compositeFilter.filters.map(s=>$h(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}}(n.compositeFilter.op))}(t):Ze(30097,{filter:t})}function qv(t){return Sv[t]}function $v(t){return Iv[t]}function Wv(t){return Pv[t]}function Ti(t){return{fieldPath:t.canonicalString()}}function ji(t){return Hn.fromServerFormat(t.fieldPath)}function Wh(t){return t instanceof vn?function(n){if(n.op==="=="){if(Id(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NAN"}};if(Sd(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Id(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NAN"}};if(Sd(n.value))return{unaryFilter:{field:Ti(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(n.field),op:$v(n.op),value:n.value}}}(t):t instanceof As?function(n){const s=n.getFilters().map(r=>Wh(r));return s.length===1?s[0]:{compositeFilter:{op:Wv(n.op),filters:s}}}(t):Ze(54877,{filter:t})}function zv(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function zh(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n,s,r,i=tt.min(),a=tt.min(),c=Fn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=m}withSequenceNumber(e){return new Nr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this.yt=e}}function Qv(t){const e=Fv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(){this.Cn=new Gv}addToCollectionParentIndex(e,n){return this.Cn.add(n),ce.resolve()}getCollectionParents(e,n){return ce.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ce.resolve()}deleteFieldIndex(e,n){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,n){return ce.resolve()}getDocumentsMatchingTarget(e,n){return ce.resolve(null)}getIndexType(e,n){return ce.resolve(0)}getFieldIndexes(e,n){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,n){return ce.resolve(Er.min())}getMinOffsetFromCollectionGroup(e,n){return ce.resolve(Er.min())}updateCollectionGroup(e,n,s){return ce.resolve()}updateIndexEntries(e,n){return ce.resolve()}}class Gv{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new wn(Yt.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new wn(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kh=41943040;class ss{static withCacheSize(e){return new ss(e,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ss.DEFAULT_COLLECTION_PERCENTILE=10,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ss.DEFAULT=new ss(Kh,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ss.DISABLED=new ss(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zi(0)}static cr(){return new zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="LruGarbageCollector",Xv=1048576;function Kd([t,e],[n,s]){const r=vt(t,n);return r===0?vt(e,s):r}class Jv{constructor(e){this.Ir=e,this.buffer=new wn(Kd),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();Kd(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Zv{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ce(zd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ji(n)?Ce(zd,"Ignoring IndexedDB error during garbage collection: ",n):await Xi(n)}await this.Vr(3e5)})}}class e_{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return ce.resolve(Vl.ce);const s=new Jv(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Wd)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wd):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,a,c,m,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,a=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,c=Date.now(),this.removeTargets(e,s,n))).next(f=>(i=f,m=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(u=Date.now(),Pi()<=Et.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${r} in `+(c-a)+`ms
	Removed ${i} targets in `+(m-c)+`ms
	Removed ${f} documents in `+(u-m)+`ms
Total Duration: ${u-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function t_(t,e){return new e_(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this.changes=new ai(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Kn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?ce.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Ro(s.mutation,r,ls.empty(),Ne.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,_t()).next(()=>s))}getLocalViewOfDocuments(e,n,s=_t()){const r=Gr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let a=Co();return i.forEach((c,m)=>{a=a.insert(c,m.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const s=Gr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,_t()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,s,r){let i=er();const a=jo(),c=function(){return jo()}();return n.forEach((m,u)=>{const d=s.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof jr)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),Ro(d.mutation,u,d.mutation.getFieldMask(),Ne.now())):a.set(u.key,ls.empty())}),this.recalculateAndSaveOverlays(e,i).next(m=>(m.forEach((u,d)=>a.set(u,d)),n.forEach((u,d)=>c.set(u,new s_(d,a.get(u)??null))),c))}recalculateAndSaveOverlays(e,n){const s=jo();let r=new nn((a,c)=>a-c),i=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(m=>{const u=n.get(m);if(u===null)return;let d=s.get(m)||ls.empty();d=c.applyToLocalView(u,d),s.set(m,d);const f=(r.get(c.batchId)||_t()).add(m);r=r.insert(c.batchId,f)})}).next(()=>{const a=[],c=r.getReverseIterator();for(;c.hasNext();){const m=c.getNext(),u=m.key,d=m.value,f=wh();d.forEach(h=>{if(!i.has(h)){const y=jh(n.get(h),s.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return ce.waitFor(a)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(a){return $e.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):kh(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):ce.resolve(Gr());let c=zo,m=i;return a.next(u=>ce.forEach(u,(d,f)=>(c<f.largestBatchId&&(c=f.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{m=m.insert(d,h)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,m,u,_t())).next(d=>({batchId:c,changes:Ch(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new $e(n)).next(s=>{let r=Co();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let a=Co();return this.indexManager.getCollectionParents(e,i).next(c=>ce.forEach(c,m=>{const u=function(f,h){return new Zi(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,m.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(d=>{d.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(a=>{i.forEach((m,u)=>{const d=u.getKey();a.get(d)===null&&(a=a.insert(d,Kn.newInvalidDocument(d)))});let c=Co();return a.forEach((m,u)=>{const d=i.get(m);d!==void 0&&Ro(d.mutation,u,ls.empty(),Ne.now()),Pl(n,u)&&(c=c.insert(m,u))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ce.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Us(r.createTime)}}(n)),ce.resolve()}getNamedQuery(e,n){return ce.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:Qv(r.bundledQuery),readTime:Us(r.readTime)}}(n)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(){this.overlays=new nn($e.comparator),this.qr=new Map}getOverlay(e,n){return ce.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Gr();return ce.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),ce.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),ce.resolve()}getOverlaysForCollection(e,n,s){const r=Gr(),i=n.length+1,a=new $e(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const m=c.getNext().value,u=m.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&m.largestBatchId>s&&r.set(m.getKey(),m)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new nn((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let d=i.get(u.largestBatchId);d===null&&(d=Gr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const c=Gr(),m=i.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((u,d)=>c.set(u,d)),!(c.size()>=r)););return ce.resolve(c)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new kv(n,s));let i=this.qr.get(n);i===void 0&&(i=_t(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.sessionToken=Fn.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(){this.Qr=new wn(Ln.$r),this.Ur=new wn(Ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Ln(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new Ln(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new $e(new Yt([])),s=new Ln(n,e),r=new Ln(n,e+1),i=[];return this.Ur.forEachInRange([s,r],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new $e(new Yt([])),s=new Ln(n,e),r=new Ln(n,e+1);let i=_t();return this.Ur.forEachInRange([s,r],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Ln(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Ln{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return $e.comparator(e.key,n.key)||vt(e.Yr,n.Yr)}static Kr(e,n){return vt(e.Yr,n.Yr)||$e.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new wn(Ln.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Dv(i,n,s,r);this.mutationQueue.push(a);for(const c of r)this.Zr=this.Zr.add(new Ln(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ce.resolve(a)}lookupMutationBatch(e,n){return ce.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?Im:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Ln(n,0),r=new Ln(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],a=>{const c=this.Xr(a.Yr);i.push(c)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new wn(vt);return n.forEach(r=>{const i=new Ln(r,0),a=new Ln(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{s=s.add(c.Yr)})}),ce.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;$e.isDocumentKey(i)||(i=i.child(""));const a=new Ln(new $e(i),0);let c=new wn(vt);return this.Zr.forEachWhile(m=>{const u=m.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(c=c.add(m.Yr)),!0)},a),ce.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Ht(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return ce.forEach(n.mutations,r=>{const i=new Ln(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new Ln(n,0),r=this.Zr.firstAfterOrEqual(s);return ce.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.ri=e,this.docs=function(){return new nn($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,a=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return ce.resolve(s?s.document.mutableCopy():Kn.newInvalidDocument(n))}getEntries(e,n){let s=er();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Kn.newInvalidDocument(r))}),ce.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=er();const a=n.path,c=new $e(a.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(c);for(;m.hasNext();){const{key:u,value:{document:d}}=m.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Bx(Rx(d),s)<=0||(r.has(d.key)||Pl(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,n,s,r){Ze(9500)}ii(e,n){return ce.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new m_(this)}getSize(e){return ce.resolve(this.size)}}class m_ extends n_{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),ce.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.persistence=e,this.si=new ai(n=>Tm(n),jm),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.oi=0,this._i=new Mm,this.targetCount=0,this.ai=zi.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),ce.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new zi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ce.resolve()}updateTargetData(e,n){return this.Pr(n),ce.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=n&&s.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return ce.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),ce.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(a=>{i.push(r.markPotentiallyOrphaned(e,a))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ce.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return ce.resolve(s)}containsKey(e,n){return ce.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.ui={},this.overlays={},this.ci=new Vl(0),this.li=!1,this.li=!0,this.hi=new a_,this.referenceDelegate=e(this),this.Pi=new u_(this),this.indexManager=new Yv,this.remoteDocumentCache=function(r){return new c_(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new Kv(n),this.Ii=new i_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new o_,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new l_(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){Ce("MemoryPersistence","Starting transaction:",e);const r=new d_(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return ce.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class d_ extends Hx{constructor(e){super(),this.currentSequenceNumber=e}}class Fm{constructor(e){this.persistence=e,this.Ri=new Mm,this.Vi=null}static mi(e){return new Fm(e)}get fi(){if(this.Vi)return this.Vi;throw Ze(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),ce.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),ce.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ce.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,s=>{const r=$e.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,tt.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ce.or([()=>ce.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ul{constructor(e,n){this.persistence=e,this.pi=new ai(s=>Ox(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=t_(this,n)}static mi(e,n){return new ul(e,n)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return ce.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?ce.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,n).next(c=>{c||(s++,i.removeEntry(a,tt.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ce.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=za(e.data.value)),n}br(e,n,s){return ce.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return ce.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=_t(),r=_t();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Om(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return l0()?8:Mx(o0())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new f_;return this.Ss(e,n,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,a,c.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(Pi()<=Et.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Li(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Pi()<=Et.DEBUG&&Ce("QueryEngine","Query:",Li(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Pi()<=Et.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Li(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bs(n))):ce.resolve())}ys(e,n){if(jd(n))return ce.resolve(null);let s=Bs(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Gc(n,null,"F"),s=Bs(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const a=_t(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,s).next(m=>{const u=this.Ds(n,c);return this.Cs(n,u,a,m.readTime)?this.ys(e,Gc(n,null,"F")):this.vs(e,u,n,m)}))})))}ws(e,n,s,r){return jd(n)||r.isEqual(tt.min())?ce.resolve(null):this.ps.getDocuments(e,s).next(i=>{const a=this.Ds(n,i);return this.Cs(n,a,s,r)?ce.resolve(null):(Pi()<=Et.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Li(n)),this.vs(e,a,n,jx(r,zo)).next(c=>c))})}Ds(e,n){let s=new wn(Eh(e));return n.forEach((r,i)=>{Pl(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Pi()<=Et.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Li(n)),this.ps.getDocumentsMatchingQuery(e,n,Er.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="LocalStore",h_=3e8;class g_{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new nn(vt),this.xs=new ai(i=>Tm(i),jm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function y_(t,e,n,s){return new g_(t,e,n,s)}async function Yh(t,e){const n=et(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const a=[],c=[];let m=_t();for(const u of r){a.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}for(const u of i){c.push(u.batchId);for(const d of u.mutations)m=m.add(d.key)}return n.localDocuments.getDocuments(s,m).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:c}))})})}function b_(t,e){const n=et(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,m,u,d){const f=u.batch,h=f.keys();let y=ce.resolve();return h.forEach(w=>{y=y.next(()=>d.getEntry(m,w)).next(_=>{const S=u.docVersions.get(w);Ht(S!==null,48541),_.version.compareTo(S)<0&&(f.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),d.addEntry(_)))})}),y.next(()=>c.mutationQueue.removeMutationBatch(m,f))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(c){let m=_t();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(m=m.add(c.batch.mutations[u].key));return m}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function Gh(t){const e=et(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function N_(t,e){const n=et(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const c=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;c.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Fn.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(_,S,R){return _.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=h_?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(h,y,d)&&c.push(n.Pi.updateTargetData(i,y))});let m=er(),u=_t();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),c.push(x_(i,a,e.documentUpdates).next(d=>{m=d.ks,u=d.qs})),!s.isEqual(tt.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));c.push(d)}return ce.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,m,u)).next(()=>m)}).then(i=>(n.Ms=r,i))}function x_(t,e,n){let s=_t(),r=_t();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let a=er();return n.forEach((c,m)=>{const u=i.get(c);m.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),m.isNoDocument()&&m.version.isEqual(tt.min())?(e.removeEntry(c,m.readTime),a=a.insert(c,m)):!u.isValidDocument()||m.version.compareTo(u.version)>0||m.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(m),a=a.insert(c,m)):Ce(qm,"Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",m.version)}),{ks:a,qs:r}})}function v_(t,e){const n=et(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Im),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function __(t,e){const n=et(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,ce.resolve(r)):n.Pi.allocateTargetId(s).next(a=>(r=new Nr(e,a,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function tm(t,e,n){const s=et(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,a=>s.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Ji(a))throw a;Ce(qm,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Qd(t,e,n){const s=et(t);let r=tt.min(),i=_t();return s.persistence.runTransaction("Execute query","readwrite",a=>function(m,u,d){const f=et(m),h=f.xs.get(d);return h!==void 0?ce.resolve(f.Ms.get(h)):f.Pi.getTargetData(u,d)}(s,a,Bs(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,c.targetId).next(m=>{i=m})}).next(()=>s.Fs.getDocumentsMatchingQuery(a,e,n?r:tt.min(),n?i:_t())).next(c=>(D_(s,av(e),c),{documents:c,Qs:i})))}function D_(t,e,n){let s=t.Os.get(e)||tt.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class Yd{constructor(){this.activeTargetIds=fv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class k_{constructor(){this.Mo=new Yd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Yd,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd="ConnectivityMonitor";class Xd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ce(Gd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ce(Gd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ca=null;function nm(){return Ca===null?Ca=function(){return 268435456+Math.round(2147483648*Math.random())}():Ca++,"0x"+Ca.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="RestConnection",E_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class V_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===ol?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const a=nm(),c=this.zo(e,n.toUriEncodedString());Ce(Nc,`Sending RPC '${e}' ${a}:`,c,s);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,r,i);const{host:u}=new URL(c),d=ra(u);return this.Jo(e,c,m,s,d).then(f=>(Ce(Nc,`Received RPC '${e}' ${a}: `,f),f),f=>{throw Oi(Nc,`RPC '${e}' ${a} failed with error: `,f,"url: ",c,"request:",s),f})}Ho(e,n,s,r,i,a){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=E_[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class w_ extends V_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const a=nm();return new Promise((c,m)=>{const u=new Zp;u.setWithCredentials(!0),u.listenOnce(eh.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Wa.NO_ERROR:const f=u.getResponseJson();Ce($n,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),c(f);break;case Wa.TIMEOUT:Ce($n,`RPC '${e}' ${a} timed out`),m(new Ee(se.DEADLINE_EXCEEDED,"Request time out"));break;case Wa.HTTP_ERROR:const h=u.getStatus();if(Ce($n,`RPC '${e}' ${a} failed with status:`,h,"response text:",u.getResponseText()),h>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const _=function(R){const L=R.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(L)>=0?L:se.UNKNOWN}(w.status);m(new Ee(_,w.message))}else m(new Ee(se.UNKNOWN,"Server responded with status "+u.getStatus()))}else m(new Ee(se.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ce($n,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(r);Ce($n,`RPC '${e}' ${a} sending request:`,r),u.send(n,"POST",d,s,15)})}T_(e,n,s){const r=nm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=sh(),c=nh(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(m.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,s),m.encodeInitMessageHeaders=!0;const d=i.join("");Ce($n,`Creating RPC '${e}' stream ${r}: ${d}`,m);const f=a.createWebChannel(d,m);this.I_(f);let h=!1,y=!1;const w=new C_({Yo:S=>{y?Ce($n,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(h||(Ce($n,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),Ce($n,`RPC '${e}' stream ${r} sending:`,S),f.send(S))},Zo:()=>f.close()}),_=(S,R,L)=>{S.listen(R,$=>{try{L($)}catch(ie){setTimeout(()=>{throw ie},0)}})};return _(f,Vo.EventType.OPEN,()=>{y||(Ce($n,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),_(f,Vo.EventType.CLOSE,()=>{y||(y=!0,Ce($n,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(f))}),_(f,Vo.EventType.ERROR,S=>{y||(y=!0,Oi($n,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),w.a_(new Ee(se.UNAVAILABLE,"The operation could not be completed")))}),_(f,Vo.EventType.MESSAGE,S=>{var R;if(!y){const L=S.data[0];Ht(!!L,16349);const $=L,ie=($==null?void 0:$.error)||((R=$[0])==null?void 0:R.error);if(ie){Ce($n,`RPC '${e}' stream ${r} received error:`,ie);const ee=ie.status;let F=function(V){const j=yn[V];if(j!==void 0)return Bh(j)}(ee),C=ie.message;F===void 0&&(F=se.INTERNAL,C="Unknown error status: "+ee+" with message "+ie.message),y=!0,w.a_(new Ee(F,C)),f.close()}else Ce($n,`RPC '${e}' stream ${r} received:`,L),w.u_(L)}}),_(c,th.STAT_EVENT,S=>{S.stat===qc.PROXY?Ce($n,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===qc.NOPROXY&&Ce($n,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function xc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(t){return new Lv(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&Ce("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="PersistentStream";class Jh{constructor(e,n,s,r,i,a,c,m){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Xh(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===se.RESOURCE_EXHAUSTED?(Zs(n.toString()),Zs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new Ee(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ce(Jd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Ce(Jd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class S_ extends Jh{constructor(e,n,s,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Rv(this.serializer,e),s=function(i){if(!("targetChange"in i))return tt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?tt.min():a.readTime?Us(a.readTime):tt.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=em(this.serializer),n.addTarget=function(i,a){let c;const m=a.target;if(c=Qc(m)?{documents:Hv(i,m)}:{query:Mv(i,m).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Mh(i,a.resumeToken);const u=Xc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}else if(a.snapshotVersion.compareTo(tt.min())>0){c.readTime=ml(i,a.snapshotVersion.toTimestamp());const u=Xc(i,a.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);const s=Ov(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=em(this.serializer),n.removeTarget=e,this.q_(n)}}class I_ extends Jh{constructor(e,n,s,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ht(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ht(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ht(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Uv(e.writeResults,e.commitTime),s=Us(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=em(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Bv(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{}class L_ extends P_{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,Jc(n,s),r,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(se.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,Jc(n,s),r,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ee(se.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class T_{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zs(n),this.aa=!1):Ce("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si="RemoteStore";class j_{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{s.enqueueAndForget(async()=>{li(this)&&(Ce(si,"Restarting streams for network reachability change."),await async function(m){const u=et(m);u.Ea.add(4),await eo(u),u.Ra.set("Unknown"),u.Ea.delete(4),await la(u)}(this))})}),this.Ra=new T_(s,r)}}async function la(t){if(li(t))for(const e of t.da)await e(!0)}async function eo(t){for(const e of t.da)await e(!1)}function Zh(t,e){const n=et(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Km(n)?zm(n):to(n).O_()&&Wm(n,e))}function $m(t,e){const n=et(t),s=to(n);n.Ia.delete(e),s.O_()&&eg(n,e),n.Ia.size===0&&(s.O_()?s.L_():li(n)&&n.Ra.set("Unknown"))}function Wm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}to(t).Y_(e)}function eg(t,e){t.Va.Ue(e),to(t).Z_(e)}function zm(t){t.Va=new wv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),to(t).start(),t.Ra.ua()}function Km(t){return li(t)&&!to(t).x_()&&t.Ia.size>0}function li(t){return et(t).Ea.size===0}function tg(t){t.Va=void 0}async function R_(t){t.Ra.set("Online")}async function B_(t){t.Ia.forEach((e,n)=>{Wm(t,e)})}async function U_(t,e){tg(t),Km(t)?(t.Ra.ha(e),zm(t)):t.Ra.set("Unknown")}async function H_(t,e,n){if(t.Ra.set("Online"),e instanceof Hh&&e.state===2&&e.cause)try{await async function(r,i){const a=i.cause;for(const c of i.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,a),r.Ia.delete(c),r.Va.removeTarget(c))}(t,e)}catch(s){Ce(si,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await dl(t,s)}else if(e instanceof Ya?t.Va.Ze(e):e instanceof Uh?t.Va.st(e):t.Va.tt(e),!n.isEqual(tt.min()))try{const s=await Gh(t.localStore);n.compareTo(s)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((m,u)=>{if(m.resumeToken.approximateByteSize()>0){const d=i.Ia.get(u);d&&i.Ia.set(u,d.withResumeToken(m.resumeToken,a))}}),c.targetMismatches.forEach((m,u)=>{const d=i.Ia.get(m);if(!d)return;i.Ia.set(m,d.withResumeToken(Fn.EMPTY_BYTE_STRING,d.snapshotVersion)),eg(i,m);const f=new Nr(d.target,m,u,d.sequenceNumber);Wm(i,f)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(s){Ce(si,"Failed to raise snapshot:",s),await dl(t,s)}}async function dl(t,e,n){if(!Ji(e))throw e;t.Ea.add(1),await eo(t),t.Ra.set("Offline"),n||(n=()=>Gh(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ce(si,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await la(t)})}function ng(t,e){return e().catch(n=>dl(t,n,e))}async function Ul(t){const e=et(t),n=Sr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Im;for(;M_(e);)try{const r=await v_(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,F_(e,r)}catch(r){await dl(e,r)}sg(e)&&rg(e)}function M_(t){return li(t)&&t.Ta.length<10}function F_(t,e){t.Ta.push(e);const n=Sr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function sg(t){return li(t)&&!Sr(t).x_()&&t.Ta.length>0}function rg(t){Sr(t).start()}async function O_(t){Sr(t).ra()}async function q_(t){const e=Sr(t);for(const n of t.Ta)e.ea(n.mutations)}async function $_(t,e,n){const s=t.Ta.shift(),r=Bm.from(s,e,n);await ng(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Ul(t)}async function W_(t,e){e&&Sr(t).X_&&await async function(s,r){if(function(a){return Ev(a)&&a!==se.ABORTED}(r.code)){const i=s.Ta.shift();Sr(s).B_(),await ng(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ul(s)}}(t,e),sg(t)&&rg(t)}async function Zd(t,e){const n=et(t);n.asyncQueue.verifyOperationInProgress(),Ce(si,"RemoteStore received new credentials");const s=li(n);n.Ea.add(3),await eo(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await la(n)}async function z_(t,e){const n=et(t);e?(n.Ea.delete(2),await la(n)):e||(n.Ea.add(2),await eo(n),n.Ra.set("Unknown"))}function to(t){return t.ma||(t.ma=function(n,s,r){const i=et(n);return i.sa(),new S_(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:R_.bind(null,t),t_:B_.bind(null,t),r_:U_.bind(null,t),H_:H_.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Km(t)?zm(t):t.Ra.set("Unknown")):(await t.ma.stop(),tg(t))})),t.ma}function Sr(t){return t.fa||(t.fa=function(n,s,r){const i=et(n);return i.sa(),new I_(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:O_.bind(null,t),r_:W_.bind(null,t),ta:q_.bind(null,t),na:$_.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ul(t)):(await t.fa.stop(),t.Ta.length>0&&(Ce(si,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const a=Date.now()+s,c=new Qm(e,n,a,r,i);return c.start(s),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ym(t,e){if(Zs("AsyncQueue",`${e}: ${t}`),Ji(t))return new Ee(se.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{static emptySet(e){return new Mi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||$e.comparator(n.key,s.key):(n,s)=>$e.comparator(n.key,s.key),this.keyedMap=Co(),this.sortedSet=new nn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Mi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(){this.ga=new nn($e.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ze(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class Ki{constructor(e,n,s,r,i,a,c,m,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=m,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new Ki(e,n,Mi.emptySet(n),a,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Il(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Q_{constructor(){this.queries=tf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=et(n),i=r.queries;r.queries=tf(),i.forEach((a,c)=>{for(const m of c.Sa)m.onError(s)})})(this,new Ee(se.ABORTED,"Firestore shutting down"))}}function tf(){return new ai(t=>Ah(t),Il)}async function Gm(t,e){const n=et(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new K_,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const c=Ym(a,`Initialization of query '${Li(e.query)}' failed`);return void e.onError(c)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Jm(n)}async function Xm(t,e){const n=et(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function Y_(t,e){const n=et(t);let s=!1;for(const r of e){const i=r.query,a=n.queries.get(i);if(a){for(const c of a.Sa)c.Fa(r)&&(s=!0);a.wa=r}}s&&Jm(n)}function G_(t,e,n){const s=et(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function Jm(t){t.Ca.forEach(e=>{e.next()})}var sm,nf;(nf=sm||(sm={})).Ma="default",nf.Cache="cache";class Zm{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Ki(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e){this.key=e}}class og{constructor(e){this.key=e}}class X_{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=Eh(e),this.tu=new Mi(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new ef,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,a=r,c=!1;const m=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=Pl(this.query,f)?f:null,w=!!h&&this.mutatedKeys.has(h.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;h&&y?h.data.isEqual(y.data)?w!==_&&(s.track({type:3,doc:y}),S=!0):this.su(h,y)||(s.track({type:2,doc:y}),S=!0,(m&&this.eu(y,m)>0||u&&this.eu(y,u)<0)&&(c=!0)):!h&&y?(s.track({type:0,doc:y}),S=!0):h&&!y&&(s.track({type:1,doc:h}),S=!0,(m||u)&&(c=!0)),S&&(y?(a=a.add(y),i=_?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:a,iu:s,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((d,f)=>function(y,w){const _=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{Rt:S})}};return _(y)-_(w)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(s),r=r??!1;const c=n&&!r?this._u():[],m=this.Xa.size===0&&this.current&&!r?1:0,u=m!==this.Za;return this.Za=m,a.length!==0||u?{snapshot:new Ki(this.query,e.tu,i,a,e.mutatedKeys,m===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ef,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new og(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new ig(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=_t();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ki.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const eu="SyncEngine";class J_{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class Z_{constructor(e){this.key=e,this.hu=!1}}class eD{constructor(e,n,s,r,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ai(c=>Ah(c),Il),this.Iu=new Map,this.Eu=new Set,this.du=new nn($e.comparator),this.Au=new Map,this.Ru=new Mm,this.Vu={},this.mu=new Map,this.fu=zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function tD(t,e,n=!0){const s=dg(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await ag(s,e,n,!0),r}async function nD(t,e){const n=dg(t);await ag(n,e,!0,!1)}async function ag(t,e,n,s){const r=await __(t.localStore,Bs(e)),i=r.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return s&&(c=await sD(t,e,i,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&Zh(t.remoteStore,r),c}async function sD(t,e,n,s,r){t.pu=(f,h,y)=>async function(_,S,R,L){let $=S.view.ru(R);$.Cs&&($=await Qd(_.localStore,S.query,!1).then(({documents:C})=>S.view.ru(C,$)));const ie=L&&L.targetChanges.get(S.targetId),ee=L&&L.targetMismatches.get(S.targetId)!=null,F=S.view.applyChanges($,_.isPrimaryClient,ie,ee);return rf(_,S.targetId,F.au),F.snapshot}(t,f,h,y);const i=await Qd(t.localStore,e,!0),a=new X_(e,i.Qs),c=a.ru(i.documents),m=aa.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=a.applyChanges(c,t.isPrimaryClient,m);rf(t,n,u.au);const d=new J_(e,n,a);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function rD(t,e,n){const s=et(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(a=>!Il(a,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await tm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&$m(s.remoteStore,r.targetId),rm(s,r.targetId)}).catch(Xi)):(rm(s,r.targetId),await tm(s.localStore,r.targetId,!0))}async function iD(t,e){const n=et(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),$m(n.remoteStore,s.targetId))}async function oD(t,e,n){const s=fD(t);try{const r=await function(a,c){const m=et(a),u=Ne.now(),d=c.reduce((y,w)=>y.add(w.key),_t());let f,h;return m.persistence.runTransaction("Locally write mutations","readwrite",y=>{let w=er(),_=_t();return m.Ns.getEntries(y,d).next(S=>{w=S,w.forEach((R,L)=>{L.isValidDocument()||(_=_.add(R))})}).next(()=>m.localDocuments.getOverlayedDocuments(y,w)).next(S=>{f=S;const R=[];for(const L of c){const $=vv(L,f.get(L.key).overlayedDocument);$!=null&&R.push(new jr(L.key,$,yh($.value.mapValue),Zn.exists(!0)))}return m.mutationQueue.addMutationBatch(y,u,R,c)}).next(S=>{h=S;const R=S.applyToLocalDocumentSet(f,_);return m.documentOverlayCache.saveOverlays(y,S.batchId,R)})}).then(()=>({batchId:h.batchId,changes:Ch(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(a,c,m){let u=a.Vu[a.currentUser.toKey()];u||(u=new nn(vt)),u=u.insert(c,m),a.Vu[a.currentUser.toKey()]=u}(s,r.batchId,n),await ca(s,r.changes),await Ul(s.remoteStore)}catch(r){const i=Ym(r,"Failed to persist write");n.reject(i)}}async function lg(t,e){const n=et(t);try{const s=await N_(n.localStore,e);e.targetChanges.forEach((r,i)=>{const a=n.Au.get(i);a&&(Ht(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Ht(a.hu,14607):r.removedDocuments.size>0&&(Ht(a.hu,42227),a.hu=!1))}),await ca(n,s,e)}catch(s){await Xi(s)}}function sf(t,e,n){const s=et(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){const m=et(a);m.onlineState=c;let u=!1;m.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(c)&&(u=!0)}),u&&Jm(m)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function aD(t,e,n){const s=et(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let a=new nn($e.comparator);a=a.insert(i,Kn.newNoDocument(i,tt.min()));const c=_t().add(i),m=new Rl(tt.min(),new Map,new nn(vt),a,c);await lg(s,m),s.du=s.du.remove(i),s.Au.delete(e),tu(s)}else await tm(s.localStore,e,!1).then(()=>rm(s,e,n)).catch(Xi)}async function lD(t,e){const n=et(t),s=e.batch.batchId;try{const r=await b_(n.localStore,e);mg(n,s,null),cg(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await ca(n,r)}catch(r){await Xi(r)}}async function cD(t,e,n){const s=et(t);try{const r=await function(a,c){const m=et(a);return m.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return m.mutationQueue.lookupMutationBatch(u,c).next(f=>(Ht(f!==null,37113),d=f.keys(),m.mutationQueue.removeMutationBatch(u,f))).next(()=>m.mutationQueue.performConsistencyCheck(u)).next(()=>m.documentOverlayCache.removeOverlaysForBatchId(u,d,c)).next(()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>m.localDocuments.getDocuments(u,d))})}(s.localStore,e);mg(s,e,n),cg(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await ca(s,r)}catch(r){await Xi(r)}}function cg(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function mg(t,e,n){const s=et(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function rm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||ug(t,s)})}function ug(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&($m(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),tu(t))}function rf(t,e,n){for(const s of n)s instanceof ig?(t.Ru.addReference(s.key,e),mD(t,s)):s instanceof og?(Ce(eu,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||ug(t,s.key)):Ze(19791,{wu:s})}function mD(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(Ce(eu,"New document in limbo: "+n),t.Eu.add(s),tu(t))}function tu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new $e(Yt.fromString(e)),s=t.fu.next();t.Au.set(s,new Z_(n)),t.du=t.du.insert(n,s),Zh(t.remoteStore,new Nr(Bs(Sl(n.path)),s,"TargetPurposeLimboResolution",Vl.ce))}}async function ca(t,e,n){const s=et(t),r=[],i=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach((c,m)=>{a.push(s.pu(m,e,n).then(u=>{var d;if((u||n)&&s.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(m.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(m.targetId,f?"current":"not-current")}if(u){r.push(u);const f=Om.As(m.targetId,u);i.push(f)}}))}),await Promise.all(a),s.Pu.H_(r),await async function(m,u){const d=et(m);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ce.forEach(u,h=>ce.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>ce.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!Ji(f))throw f;Ce(qm,"Failed to update sequence numbers: "+f)}for(const f of u){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),w=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(w);d.Ms=d.Ms.insert(h,_)}}}(s.localStore,i))}async function uD(t,e){const n=et(t);if(!n.currentUser.isEqual(e)){Ce(eu,"User change. New user:",e.toKey());const s=await Yh(n.localStore,e);n.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(m=>{m.reject(new Ee(se.CANCELLED,a))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ca(n,s.Ls)}}function dD(t,e){const n=et(t),s=n.Au.get(e);if(s&&s.hu)return _t().add(s.key);{let r=_t();const i=n.Iu.get(e);if(!i)return r;for(const a of i){const c=n.Tu.get(a);r=r.unionWith(c.view.nu)}return r}}function dg(t){const e=et(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=lg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aD.bind(null,e),e.Pu.H_=Y_.bind(null,e.eventManager),e.Pu.yu=G_.bind(null,e.eventManager),e}function fD(t){const e=et(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cD.bind(null,e),e}class fl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return y_(this.persistence,new p_,e.initialUser,this.serializer)}Cu(e){return new Qh(Fm.mi,this.serializer)}Du(e){return new k_}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fl.provider={build:()=>new fl};class pD extends fl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ht(this.persistence.referenceDelegate instanceof ul,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Zv(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?ss.withCacheSize(this.cacheSizeBytes):ss.DEFAULT;return new Qh(s=>ul.mi(s,n),this.serializer)}}class im{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>sf(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=uD.bind(null,this.syncEngine),await z_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Q_}()}createDatastore(e){const n=Bl(e.databaseInfo.databaseId),s=function(i){return new w_(i)}(e.databaseInfo);return function(i,a,c,m){return new L_(i,a,c,m)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,a,c){return new j_(s,r,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>sf(this.syncEngine,n,0),function(){return Xd.v()?new Xd:new A_}())}createSyncEngine(e,n){return function(r,i,a,c,m,u,d){const f=new eD(r,i,a,c,m,u);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=et(r);Ce(si,"RemoteStore shutting down."),i.Ea.add(5),await eo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}im.provider={build:()=>new im};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir="FirestoreClient";class hD{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=zn.UNAUTHENTICATED,this.clientId=Sm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async a=>{Ce(Ir,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(s,a=>(Ce(Ir,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Ym(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function vc(t,e){t.asyncQueue.verifyOperationInProgress(),Ce(Ir,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Yh(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function of(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fg(t);Ce(Ir,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Zd(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>Zd(e.remoteStore,r)),t._onlineComponents=e}async function fg(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ce(Ir,"Using user provided OfflineComponentProvider");try{await vc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Oi("Error using user provided cache. Falling back to memory cache: "+n),await vc(t,new fl)}}else Ce(Ir,"Using default OfflineComponentProvider"),await vc(t,new pD(void 0));return t._offlineComponents}async function su(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ce(Ir,"Using user provided OnlineComponentProvider"),await of(t,t._uninitializedComponentsProvider._online)):(Ce(Ir,"Using default OnlineComponentProvider"),await of(t,new im))),t._onlineComponents}function pg(t){return fg(t).then(e=>e.persistence)}function hg(t){return su(t).then(e=>e.remoteStore)}function gD(t){return su(t).then(e=>e.syncEngine)}async function pl(t){const e=await su(t),n=e.eventManager;return n.onListen=tD.bind(null,e.syncEngine),n.onUnlisten=rD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=nD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=iD.bind(null,e.syncEngine),n}function yD(t){return t.asyncQueue.enqueue(async()=>{const e=await pg(t),n=await hg(t);return e.setNetworkEnabled(!0),function(r){const i=et(r);return i.Ea.delete(0),la(i)}(n)})}function bD(t){return t.asyncQueue.enqueue(async()=>{const e=await pg(t),n=await hg(t);return e.setNetworkEnabled(!1),async function(r){const i=et(r);i.Ea.add(0),await eo(i),i.Ra.set("Offline")}(n)})}function ND(t,e,n={}){const s=new Ys;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new nu({next:h=>{d.Nu(),a.enqueueAndForget(()=>Xm(i,f));const y=h.docs.has(c);!y&&h.fromCache?u.reject(new Ee(se.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&m&&m.source==="server"?u.reject(new Ee(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),f=new Zm(Sl(c.path),d,{includeMetadataChanges:!0,qa:!0});return Gm(i,f)}(await pl(t),t.asyncQueue,e,n,s)),s.promise}function gg(t,e,n={}){const s=new Ys;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,m,u){const d=new nu({next:h=>{d.Nu(),a.enqueueAndForget(()=>Xm(i,f)),h.fromCache&&m.source==="server"?u.reject(new Ee(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),f=new Zm(c,d,{includeMetadataChanges:!0,qa:!0});return Gm(i,f)}(await pl(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg="firestore.googleapis.com",lf=!0;class cf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bg,this.ssl=lf}else this.host=e.host,this.ssl=e.ssl??lf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Kh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Xv)throw new Ee(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yg(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hl{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new kx;switch(s.type){case"firstParty":return new Cx(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ee(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=af.get(n);s&&(Ce("ComponentProvider","Removing Datastore"),af.delete(n),s.terminate())}(this),Promise.resolve()}}function xD(t,e,n,s={}){var u;t=Cn(t,Hl);const r=ra(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;r&&(Up(`https://${c}`),Mp("Firestore",!0)),i.host!==bg&&i.host!==c&&Oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...i,host:c,ssl:r,emulatorOptions:s};if(!rl(m,a)&&(t._setSettings(m),s.mockUserToken)){let d,f;if(typeof s.mockUserToken=="string")d=s.mockUserToken,f=zn.MOCK_USER;else{d=Hp(s.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const h=s.mockUserToken.sub||s.mockUserToken.user_id;if(!h)throw new Ee(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new zn(h)}t._authCredentials=new Ax(new ih(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new tr(this.firestore,e,this._query)}}class rn{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}toJSON(){return{type:rn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(ia(n,rn._jsonSchema))return new rn(e,s||null,new $e(Yt.fromString(n.referencePath)))}}rn._jsonSchemaVersion="firestore/documentReference/1.0",rn._jsonSchema={type:_n("string",rn._jsonSchemaVersion),referencePath:_n("string")};class kr extends tr{constructor(e,n,s){super(e,n,Sl(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new $e(e))}withConverter(e){return new kr(this.firestore,e,this._path)}}function qe(t,e,...n){if(t=Mn(t),oh("collection","path",e),t instanceof Hl){const s=Yt.fromString(e,...n);return vd(s),new kr(t,null,s)}{if(!(t instanceof rn||t instanceof kr))throw new Ee(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Yt.fromString(e,...n));return vd(s),new kr(t.firestore,null,s)}}function we(t,e,...n){if(t=Mn(t),arguments.length===1&&(e=Sm.newId()),oh("doc","path",e),t instanceof Hl){const s=Yt.fromString(e,...n);return xd(s),new rn(t,null,new $e(s))}{if(!(t instanceof rn||t instanceof kr))throw new Ee(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Yt.fromString(e,...n));return xd(s),new rn(t.firestore,t instanceof kr?t.converter:null,new $e(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="AsyncQueue";class uf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Xh(this,"async_queue_retry"),this._c=()=>{const s=xc();s&&Ce(mf,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=xc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=xc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Ys;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ji(e))throw e;Ce(mf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Zs("INTERNAL UNHANDLED ERROR: ",df(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Qm.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Ze(47125,{Pc:df(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function df(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ms extends Hl{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new uf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uf(e),this._firestoreClient=void 0,await e}}}function vD(t,e){const n=typeof t=="object"?t:Yp(),s=typeof t=="string"?t:ol,r=Wp(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Rp("firestore");i&&xD(r,...i)}return r}function Rr(t){if(t._terminated)throw new Ee(se.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||_D(t),t._firestoreClient}function _D(t){var s,r,i;const e=t._freezeSettings(),n=function(c,m,u,d){return new Wx(c,m,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,yg(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new hD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const m=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(m),_online:m}}(t._componentsProvider))}function DD(t){return yD(Rr(t=Cn(t,ms)))}function kD(t){return bD(Rr(t=Cn(t,ms)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gs(Fn.fromBase64String(e))}catch(n){throw new Ee(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new gs(Fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:gs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ia(e,gs._jsonSchema))return gs.fromBase64String(e.bytes)}}gs._jsonSchemaVersion="firestore/bytes/1.0",gs._jsonSchema={type:_n("string",gs._jsonSchemaVersion),bytes:_n("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ee(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ee(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ee(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hs._jsonSchemaVersion}}static fromJSON(e){if(ia(e,Hs._jsonSchema))return new Hs(e.latitude,e.longitude)}}Hs._jsonSchemaVersion="firestore/geoPoint/1.0",Hs._jsonSchema={type:_n("string",Hs._jsonSchemaVersion),latitude:_n("number"),longitude:_n("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ms._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ia(e,Ms._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Ms(e.vectorValues);throw new Ee(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ms._jsonSchemaVersion="firestore/vectorValue/1.0",Ms._jsonSchema={type:_n("string",Ms._jsonSchemaVersion),vectorValues:_n("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=/^__.*__$/;class ED{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new jr(e,this.data,this.fieldMask,n,this.fieldTransforms):new oa(e,this.data,n,this.fieldTransforms)}}class Ng{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new jr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function xg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ac:t})}}class ru{constructor(e,n,s,r,i,a){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ru({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return hl(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(xg(this.Ac)&&AD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class VD{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Bl(e)}Cc(e,n,s,r=!1){return new ru({Ac:e,methodName:n,Dc:s,path:Hn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ua(t){const e=t._freezeSettings(),n=Bl(t._databaseId);return new VD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function iu(t,e,n,s,r,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);au("Data must be an object, but it was:",a,s);const c=Dg(s,a);let m,u;if(i.merge)m=new ls(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=om(e,f,n);if(!a.contains(h))throw new Ee(se.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Ag(d,h)||d.push(h)}m=new ls(d),u=a.fieldTransforms.filter(f=>m.covers(f.field))}else m=null,u=a.fieldTransforms;return new ED(new is(c),m,u)}class Fl extends Ml{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fl}}class ou extends Ml{_toFieldTransform(e){return new yv(e.path,new Xo)}isEqual(e){return e instanceof ou}}function vg(t,e,n,s){const r=t.Cc(1,e,n);au("Data must be an object, but it was:",r,s);const i=[],a=is.empty();Tr(s,(m,u)=>{const d=lu(e,m,n);u=Mn(u);const f=r.yc(d);if(u instanceof Fl)i.push(d);else{const h=da(u,f);h!=null&&(i.push(d),a.set(d,h))}});const c=new ls(i);return new Ng(a,c,r.fieldTransforms)}function _g(t,e,n,s,r,i){const a=t.Cc(1,e,n),c=[om(e,s,n)],m=[r];if(i.length%2!=0)throw new Ee(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)c.push(om(e,i[h])),m.push(i[h+1]);const u=[],d=is.empty();for(let h=c.length-1;h>=0;--h)if(!Ag(u,c[h])){const y=c[h];let w=m[h];w=Mn(w);const _=a.yc(y);if(w instanceof Fl)u.push(y);else{const S=da(w,_);S!=null&&(u.push(y),d.set(y,S))}}const f=new ls(u);return new Ng(d,f,a.fieldTransforms)}function CD(t,e,n,s=!1){return da(n,t.Cc(s?4:3,e))}function da(t,e){if(kg(t=Mn(t)))return au("Unsupported field value:",e,t),Dg(t,e);if(t instanceof Ml)return function(s,r){if(!xg(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let a=0;for(const c of s){let m=da(c,r.wc(a));m==null&&(m={nullValue:"NULL_VALUE"}),i.push(m),a++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Mn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return pv(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Ne.fromDate(s);return{timestampValue:ml(r.serializer,i)}}if(s instanceof Ne){const i=new Ne(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ml(r.serializer,i)}}if(s instanceof Hs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof gs)return{bytesValue:Mh(r.serializer,s._byteString)};if(s instanceof rn){const i=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(i))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Hm(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Ms)return function(a,c){return{mapValue:{fields:{[hh]:{stringValue:gh},[al]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Sc("VectorValues must only contain numeric values.");return Rm(c.serializer,u)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${El(s)}`)}(t,e)}function Dg(t,e){const n={};return ch(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Tr(t,(s,r)=>{const i=da(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function kg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ne||t instanceof Hs||t instanceof gs||t instanceof rn||t instanceof Ml||t instanceof Ms)}function au(t,e,n){if(!kg(n)||!ah(n)){const s=El(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function om(t,e,n){if((e=Mn(e))instanceof ma)return e._internalPath;if(typeof e=="string")return lu(t,e);throw hl("Field path arguments must be of type string or ",t,!1,void 0,n)}const wD=new RegExp("[~\\*/\\[\\]]");function lu(t,e,n){if(e.search(wD)>=0)throw hl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ma(...e.split("."))._internalPath}catch{throw hl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function hl(t,e,n,s,r){const i=s&&!s.isEmpty(),a=r!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let m="";return(i||a)&&(m+=" (found",i&&(m+=` in field ${s}`),a&&(m+=` in document ${r}`),m+=")"),new Ee(se.INVALID_ARGUMENT,c+t+m)}function Ag(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ol("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SD extends Eg{data(){return super.data()}}function Ol(t,e){return typeof e=="string"?lu(t,e):e instanceof ma?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ee(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cu{}class Cg extends cu{}function xt(t,e,...n){let s=[];e instanceof cu&&s.push(e),s=s.concat(n),function(i){const a=i.filter(m=>m instanceof mu).length,c=i.filter(m=>m instanceof ql).length;if(a>1||a>0&&c>0)throw new Ee(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class ql extends Cg{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new ql(e,n,s)}_apply(e){const n=this._parse(e);return wg(e._query,n),new tr(e.firestore,e.converter,Yc(e._query,n))}_parse(e){const n=ua(e.firestore);return function(i,a,c,m,u,d,f){let h;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ee(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){hf(f,d);const w=[];for(const _ of f)w.push(pf(m,i,_));h={arrayValue:{values:w}}}else h=pf(m,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||hf(f,d),h=CD(c,a,f,d==="in"||d==="not-in");return vn.create(u,d,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Tn(t,e,n){const s=e,r=Ol("where",t);return ql._create(r,s,n)}class mu extends cu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new mu(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:As.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const m of c)wg(a,m),a=Yc(a,m)}(e._query,n),new tr(e.firestore,e.converter,Yc(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uu extends Cg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new uu(e,n)}_apply(e){const n=function(r,i,a){if(r.startAt!==null)throw new Ee(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ee(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Go(i,a)}(e._query,this._field,this._direction);return new tr(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Zi(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function on(t,e="asc"){const n=e,s=Ol("orderBy",t);return uu._create(s,n)}function pf(t,e,n){if(typeof(n=Mn(n))=="string"){if(n==="")throw new Ee(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kh(e)&&n.indexOf("/")!==-1)throw new Ee(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(Yt.fromString(n));if(!$e.isDocumentKey(s))throw new Ee(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return wd(t,new $e(s))}if(n instanceof rn)return wd(t,n._key);throw new Ee(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${El(n)}.`)}function hf(t,e){if(!Array.isArray(t)||t.length===0)throw new Ee(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wg(t,e){const n=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Ee(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class ID{convertValue(e,n="none"){switch(wr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return fn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Tr(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var s,r,i;const n=(i=(r=(s=e.fields)==null?void 0:s[al].arrayValue)==null?void 0:r.values)==null?void 0:i.map(a=>fn(a.doubleValue));return new Ms(n)}convertGeoPoint(e){return new Hs(fn(e.latitude),fn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=wl(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Ko(e));default:return null}}convertTimestamp(e){const n=Vr(e);return new Ne(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Yt.fromString(e);Ht(zh(s),9688,{name:e});const r=new Qo(s.get(1),s.get(3)),i=new $e(s.popFirst(5));return r.isEqual(n)||Zs(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class So{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jr extends Eg{constructor(e,n,s,r,i,a){super(e,n,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Ol("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Jr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Jr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jr._jsonSchema={type:_n("string",Jr._jsonSchemaVersion),bundleSource:_n("string","DocumentSnapshot"),bundleName:_n("string"),bundle:_n("string")};class Ga extends Jr{data(e={}){return super.data(e)}}class Ar{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new So(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Ga(this._firestore,this._userDataWriter,s.key,s,new So(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ee(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new So(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:m,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const m=new Ga(r._firestore,r._userDataWriter,c.doc.key,c.doc,new So(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,d=-1;return c.type!==0&&(u=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:PD(c.type),doc:m,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ar._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t){t=Cn(t,rn);const e=Cn(t.firestore,ms);return ND(Rr(e),t._key).then(n=>Sg(e,t,n))}Ar._jsonSchemaVersion="firestore/querySnapshot/1.0",Ar._jsonSchema={type:_n("string",Ar._jsonSchemaVersion),bundleSource:_n("string","QuerySnapshot"),bundleName:_n("string"),bundle:_n("string")};class $l extends ID{constructor(e){super(),this.firestore=e}convertBytes(e){return new gs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,n)}}function Vt(t){t=Cn(t,tr);const e=Cn(t.firestore,ms),n=Rr(e),s=new $l(e);return Vg(t._query),gg(n,t._query).then(r=>new Ar(e,s,t,r))}function LD(t){t=Cn(t,tr);const e=Cn(t.firestore,ms),n=Rr(e),s=new $l(e);return gg(n,t._query,{source:"server"}).then(r=>new Ar(e,s,t,r))}function ri(t,e,n){t=Cn(t,rn);const s=Cn(t.firestore,ms),r=du(t.converter,e,n);return fa(s,[iu(ua(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Zn.none())])}function Ut(t,e,n,...s){t=Cn(t,rn);const r=Cn(t.firestore,ms),i=ua(r);let a;return a=typeof(e=Mn(e))=="string"||e instanceof ma?_g(i,"updateDoc",t._key,e,n,s):vg(i,"updateDoc",t._key,e),fa(r,[a.toMutation(t._key,Zn.exists(!0))])}function Un(t){return fa(Cn(t.firestore,ms),[new jl(t._key,Zn.none())])}function Fs(t,e){const n=Cn(t.firestore,ms),s=we(t),r=du(t.converter,e);return fa(n,[iu(ua(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Zn.exists(!1))]).then(()=>s)}function us(t,...e){var m,u,d;t=Mn(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||ff(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(ff(e[s])){const f=e[s];e[s]=(m=f.next)==null?void 0:m.bind(f),e[s+1]=(u=f.error)==null?void 0:u.bind(f),e[s+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,a,c;if(t instanceof rn)a=Cn(t.firestore,ms),c=Sl(t._key.path),i={next:f=>{e[s]&&e[s](Sg(a,t,f))},error:e[s+1],complete:e[s+2]};else{const f=Cn(t,tr);a=Cn(f.firestore,ms),c=f._query;const h=new $l(a);i={next:y=>{e[s]&&e[s](new Ar(a,h,f,y))},error:e[s+1],complete:e[s+2]},Vg(t._query)}return function(h,y,w,_){const S=new nu(_),R=new Zm(y,S,w);return h.asyncQueue.enqueueAndForget(async()=>Gm(await pl(h),R)),()=>{S.Nu(),h.asyncQueue.enqueueAndForget(async()=>Xm(await pl(h),R))}}(Rr(a),c,r,i)}function fa(t,e){return function(s,r){const i=new Ys;return s.asyncQueue.enqueueAndForget(async()=>oD(await gD(s),r,i)),i.promise}(Rr(t),e)}function Sg(t,e,n){const s=n.docs.get(e._key),r=new $l(t);return new Jr(t,r,e._key,s,new So(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ua(e)}set(e,n,s){this._verifyNotCommitted();const r=_c(e,this._firestore),i=du(r.converter,n,s),a=iu(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(a.toMutation(r._key,Zn.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=_c(e,this._firestore);let a;return a=typeof(n=Mn(n))=="string"||n instanceof ma?_g(this._dataReader,"WriteBatch.update",i._key,n,s,r):vg(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,Zn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=_c(e,this._firestore);return this._mutations=this._mutations.concat(new jl(n._key,Zn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ee(se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _c(t,e){if((t=Mn(t)).firestore!==e)throw new Ee(se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function sn(){return new ou("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(t){return Rr(t=Cn(t,ms)),new TD(t,e=>fa(t,e))}(function(e,n=!0){(function(r){Gi=r})(Kp),$o(new Fi("firestore",(s,{instanceIdentifier:r,options:i})=>{const a=s.getProvider("app").getImmediate(),c=new ms(new Ex(s.getProvider("auth-internal")),new wx(a,s.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ee(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(u.options.projectId,d)}(a,r),a);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),_r(gd,yd,e),_r(gd,yd,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="firebasestorage.googleapis.com",Pg="storageBucket",RD=2*60*1e3,BD=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln extends oi{constructor(e,n,s=0){super(Dc(e),`Firebase Storage: ${n} (${Dc(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ln.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var an;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(an||(an={}));function Dc(t){return"storage/"+t}function fu(){const t="An unknown error occurred, please check the error payload for server response.";return new ln(an.UNKNOWN,t)}function UD(t){return new ln(an.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function HD(t){return new ln(an.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function MD(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ln(an.UNAUTHENTICATED,t)}function FD(){return new ln(an.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function OD(t){return new ln(an.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function qD(){return new ln(an.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $D(){return new ln(an.CANCELED,"User canceled the upload/download.")}function WD(t){return new ln(an.INVALID_URL,"Invalid URL '"+t+"'.")}function zD(t){return new ln(an.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function KD(){return new ln(an.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Pg+"' property when initializing the app?")}function QD(){return new ln(an.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YD(){return new ln(an.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function GD(t){return new ln(an.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function am(t){return new ln(an.INVALID_ARGUMENT,t)}function Lg(){return new ln(an.APP_DELETED,"The Firebase app was deleted.")}function XD(t){return new ln(an.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bo(t,e){return new ln(an.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function fo(t){throw new ln(an.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=cs.makeFromUrl(e,n)}catch{return new cs(e,"")}if(s.path==="")return s;throw zD(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+r+a,"i"),m={bucket:1,path:3};function u(ie){ie.path_=decodeURIComponent(ie.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),w={bucket:1,path:3},_=n===Ig?"(?:storage.googleapis.com|storage.cloud.google.com)":n,S="([^?#]*)",R=new RegExp(`^https?://${_}/${r}/${S}`,"i"),$=[{regex:c,indices:m,postModify:i},{regex:y,indices:w,postModify:u},{regex:R,indices:{bucket:1,path:2},postModify:u}];for(let ie=0;ie<$.length;ie++){const ee=$[ie],F=ee.regex.exec(e);if(F){const C=F[ee.indices.bucket];let N=F[ee.indices.path];N||(N=""),s=new cs(C,N),ee.postModify(s);break}}if(s==null)throw WD(e);return s}}class JD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(t,e,n){let s=1,r=null,i=null,a=!1,c=0;function m(){return c===2}let u=!1;function d(...S){u||(u=!0,e.apply(null,S))}function f(S){r=setTimeout(()=>{r=null,t(y,m())},S)}function h(){i&&clearTimeout(i)}function y(S,...R){if(u){h();return}if(S){h(),d.call(null,S,...R);return}if(m()||a){h(),d.call(null,S,...R);return}s<64&&(s*=2);let $;c===1?(c=2,$=0):$=(s+Math.random())*1e3,f($)}let w=!1;function _(S){w||(w=!0,h(),!u&&(r!==null?(S||(c=2),clearTimeout(r),f(0)):S||(c=1)))}return f(0),i=setTimeout(()=>{a=!0,_(!0)},n),_}function ek(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(t){return t!==void 0}function nk(t){return typeof t=="object"&&!Array.isArray(t)}function pu(t){return typeof t=="string"||t instanceof String}function gf(t){return hu()&&t instanceof Blob}function hu(){return typeof Blob<"u"}function yf(t,e,n,s){if(s<e)throw am(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw am(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function Tg(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var Zr;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Zr||(Zr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,n,s,r,i,a,c,m,u,d,f,h=!0,y=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=m,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,_)=>{this.resolve_=w,this.reject_=_,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new wa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const m=c.loaded,u=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===Zr.NO_ERROR,m=i.getStatus();if(!c||sk(m,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Zr.ABORT;s(!1,new wa(!1,null,d));return}const u=this.successCodes_.indexOf(m)!==-1;s(!0,new wa(u,i))})},n=(s,r)=>{const i=this.resolve_,a=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const m=this.callback_(c,c.getResponse());tk(m)?i(m):i()}catch(m){a(m)}else if(c!==null){const m=fu();m.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,m)):a(m)}else if(r.canceled){const m=this.appDelete_?Lg():$D();a(m)}else{const m=qD();a(m)}};this.canceled_?n(!1,new wa(!1,null,!0)):this.backoffId_=ZD(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ek(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wa{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function ik(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function ok(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ak(t,e){e&&(t["X-Firebase-GMPID"]=e)}function lk(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ck(t,e,n,s,r,i,a=!0,c=!1){const m=Tg(t.urlParams),u=t.url+m,d=Object.assign({},t.headers);return ak(d,e),ik(d,n),ok(d,i),lk(d,s),new rk(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function uk(...t){const e=mk();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(hu())return new Blob(t);throw new ln(an.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function dk(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){if(typeof atob>"u")throw GD("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kc{constructor(e,n){this.data=e,this.contentType=n||null}}function pk(t,e){switch(t){case Rs.RAW:return new kc(jg(e));case Rs.BASE64:case Rs.BASE64URL:return new kc(Rg(t,e));case Rs.DATA_URL:return new kc(gk(e),yk(e))}throw fu()}function jg(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,a=t.charCodeAt(++n);s=65536|(i&1023)<<10|a&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function hk(t){let e;try{e=decodeURIComponent(t)}catch{throw Bo(Rs.DATA_URL,"Malformed data URL.")}return jg(e)}function Rg(t,e){switch(t){case Rs.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Bo(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Rs.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Bo(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=fk(e)}catch(r){throw r.message.includes("polyfill")?r:Bo(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class Bg{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Bo(Rs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=bk(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function gk(t){const e=new Bg(t);return e.base64?Rg(Rs.BASE64,e.rest):hk(e.rest)}function yk(t){return new Bg(t).contentType}function bk(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,n){let s=0,r="";gf(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(gf(this.data_)){const s=this.data_,r=dk(s,e,n);return r===null?null:new yr(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new yr(s,!0)}}static getBlob(...e){if(hu()){const n=e.map(s=>s instanceof yr?s.data_:s);return new yr(uk.apply(null,n))}else{const n=e.map(a=>pu(a)?pk(Rs.RAW,a).data:a.data_);let s=0;n.forEach(a=>{s+=a.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(a=>{for(let c=0;c<a.length;c++)r[i++]=a[c]}),new yr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t){let e;try{e=JSON.parse(t)}catch{return null}return nk(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function xk(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function Hg(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t,e){return e}class Gn{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||vk}}let Sa=null;function _k(t){return!pu(t)||t.length<2?t:Hg(t)}function Mg(){if(Sa)return Sa;const t=[];t.push(new Gn("bucket")),t.push(new Gn("generation")),t.push(new Gn("metageneration")),t.push(new Gn("name","fullPath",!0));function e(i,a){return _k(a)}const n=new Gn("name");n.xform=e,t.push(n);function s(i,a){return a!==void 0?Number(a):a}const r=new Gn("size");return r.xform=s,t.push(r),t.push(new Gn("timeCreated")),t.push(new Gn("updated")),t.push(new Gn("md5Hash",null,!0)),t.push(new Gn("cacheControl",null,!0)),t.push(new Gn("contentDisposition",null,!0)),t.push(new Gn("contentEncoding",null,!0)),t.push(new Gn("contentLanguage",null,!0)),t.push(new Gn("contentType",null,!0)),t.push(new Gn("metadata","customMetadata",!0)),Sa=t,Sa}function Dk(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new cs(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function kk(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const a=n[i];s[a.local]=a.xform(s,e[a.server])}return Dk(s,t),s}function Fg(t,e,n){const s=Ug(e);return s===null?null:kk(t,s,n)}function Ak(t,e,n,s){const r=Ug(e);if(r===null||!pu(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,f=t.fullPath,h="/b/"+a(d)+"/o/"+a(f),y=Wl(h,n,s),w=Tg({alt:"media",token:u});return y+w})[0]}function Ek(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class gu{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(t){if(!t)throw fu()}function Vk(t,e){function n(s,r){const i=Fg(t,r,e);return Og(i!==null),i}return n}function Ck(t,e){function n(s,r){const i=Fg(t,r,e);return Og(i!==null),Ak(i,r,t.host,t._protocol)}return n}function qg(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=FD():r=MD():n.getStatus()===402?r=HD(t.bucket):n.getStatus()===403?r=OD(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function $g(t){const e=qg(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=UD(t.path)),i.serverResponse=r.serverResponse,i}return n}function wk(t,e,n){const s=e.fullServerUrl(),r=Wl(s,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,c=new gu(r,i,Ck(t,n),a);return c.errorHandler=$g(e),c}function Sk(t,e){const n=e.fullServerUrl(),s=Wl(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function a(m,u){}const c=new gu(s,r,a,i);return c.successCodes=[200,204],c.errorHandler=$g(e),c}function Ik(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Pk(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=Ik(null,e)),s}function Lk(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let $="";for(let ie=0;ie<2;ie++)$=$+Math.random().toString().slice(2);return $}const m=c();a["Content-Type"]="multipart/related; boundary="+m;const u=Pk(e,s,r),d=Ek(u,n),f="--"+m+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+m+`\r
Content-Type: `+u.contentType+`\r
\r
`,h=`\r
--`+m+"--",y=yr.getBlob(f,s,h);if(y===null)throw QD();const w={name:u.fullPath},_=Wl(i,t.host,t._protocol),S="POST",R=t.maxUploadRetryTime,L=new gu(_,S,Vk(t,n),R);return L.urlParams=w,L.headers=a,L.body=y.uploadData(),L.errorHandler=qg(e),L}class Tk{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Zr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Zr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Zr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r,i){if(this.sent_)throw fo("cannot .send() more than once");if(ra(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw fo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw fo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw fo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw fo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class jk extends Tk{initXhr(){this.xhr_.responseType="text"}}function yu(){return new jk}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n){this._service=e,n instanceof cs?this._location=n:this._location=cs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ii(e,n)}get root(){const e=new cs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Hg(this._location.path)}get storage(){return this._service}get parent(){const e=Nk(this._location.path);if(e===null)return null;const n=new cs(this._location.bucket,e);return new ii(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw XD(e)}}function Rk(t,e,n){t._throwIfRoot("uploadBytes");const s=Lk(t.storage,t._location,Mg(),new yr(e,!0),n);return t.storage.makeRequestWithTokens(s,yu).then(r=>({metadata:r,ref:t}))}function Bk(t){t._throwIfRoot("getDownloadURL");const e=wk(t.storage,t._location,Mg());return t.storage.makeRequestWithTokens(e,yu).then(n=>{if(n===null)throw YD();return n})}function Uk(t){t._throwIfRoot("deleteObject");const e=Sk(t.storage,t._location);return t.storage.makeRequestWithTokens(e,yu)}function Hk(t,e){const n=xk(t._location.path,e),s=new cs(t._location.bucket,n);return new ii(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(t){return/^[A-Za-z]+:\/\//.test(t)}function Fk(t,e){return new ii(t,e)}function Wg(t,e){if(t instanceof bu){const n=t;if(n._bucket==null)throw KD();const s=new ii(n,n._bucket);return e!=null?Wg(s,e):s}else return e!==void 0?Hk(t,e):t}function Ok(t,e){if(e&&Mk(e)){if(t instanceof bu)return Fk(t,e);throw am("To use ref(service, url), the first argument must be a Storage instance.")}else return Wg(t,e)}function bf(t,e){const n=e==null?void 0:e[Pg];return n==null?null:cs.makeFromBucketSpec(n,t)}function qk(t,e,n,s={}){t.host=`${e}:${n}`;const r=ra(e);r&&(Up(`https://${t.host}/b`),Mp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(t._overrideAuthToken=typeof i=="string"?i:Hp(i,t.app.options.projectId))}class bu{constructor(e,n,s,r,i,a=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=Ig,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RD,this._maxUploadRetryTime=BD,this._requests=new Set,r!=null?this._bucket=cs.makeFromBucketSpec(r,this._host):this._bucket=bf(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=cs.makeFromBucketSpec(this._url,e):this._bucket=bf(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(zp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ii(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new JD(Lg());{const a=ck(e,this._appId,s,r,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const Nf="@firebase/storage",xf="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="storage";function lm(t,e,n){return t=Mn(t),Rk(t,e,n)}function cm(t){return t=Mn(t),Bk(t)}function $k(t){return t=Mn(t),Uk(t)}function gl(t,e){return t=Mn(t),Ok(t,e)}function Wk(t=Yp(),e){t=Mn(t);const s=Wp(t,zg).getImmediate({identifier:e}),r=Rp("storage");return r&&zk(s,...r),s}function zk(t,e,n,s={}){qk(t,e,n,s)}function Kk(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new bu(n,s,r,e,Kp)}function Qk(){$o(new Fi(zg,Kk,"PUBLIC").setMultipleInstances(!0)),_r(Nf,xf,""),_r(Nf,xf,"esm2020")}Qk();const Yk={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Kg=ud().length===0?Qp(Yk):ud()[0],ne=vD(Kg),yl=Wk(Kg),vf=async()=>{try{console.log("[Firebase]   ..."),await kD(ne),await DD(ne),console.log("[Firebase]   ")}catch(t){console.error("[Firebase]   :",t)}},Ia=async t=>{const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")},Gk=t=>{const n=new TextEncoder().encode(t);let s="";return n.forEach(r=>s+=String.fromCharCode(r)),btoa(s)},Xk=t=>{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return new TextDecoder().decode(n)},_f=t=>{const e={id:t.id,username:t.username,role:t.role,iat:Date.now(),exp:Date.now()+2592e6};return Gk(JSON.stringify(e))},Df=t=>{try{if(t.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse(Xk(t));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},kf={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Ac={async login(t){console.time("[Auth]   ");const e=kf[t.username];if(e){if(t.password!==e.password)throw new Error("  .");const d=e.user,f=_f(d);return Vt(xt(qe(ne,"users"),Tn("username","==",t.username))).then(h=>{h.empty||Ut(we(ne,"users",h.docs[0].id),{lastLogin:sn()}).catch(y=>console.error("lastLogin  :",y))}).catch(h=>console.error("Firestore  :",h)),console.timeEnd("[Auth]   "),{success:!0,token:f,user:d}}console.time("[Auth] Firestore ");const n=qe(ne,"users"),s=xt(n,Tn("username","==",t.username)),r=await Vt(s);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],a=i.data(),c=await Ia(t.password);if(a.passwordHash){if(a.passwordHash!==c)throw new Error("  .")}else if(a.password){if(a.password.startsWith("$2b$")||a.password.startsWith("$2a$")){if(t.password!=="1234")throw new Error("  .")}else if(a.password!==t.password&&t.password!=="1234")throw new Error("  .")}else if(t.password!=="1234")throw new Error("  .");const m={id:i.id,username:a.username,name:a.name,email:a.email,role:a.role||"user",phone:a.phone,department:a.department,position:a.position,avatar:a.avatar},u=_f(m);return Ut(we(ne,"users",i.id),{lastLogin:sn()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:u,user:m}},async getCurrentUser(t){const e=Df(t);if(!e)return null;const n=kf[e.username];if(n)return n.user;try{const s=await Pt(we(ne,"users",e.id));if(!s.exists())return null;const r=s.data();return{id:s.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(s){return console.error("Firestore getCurrentUser error:",s),null}},async getUserById(t){const e=await Pt(we(ne,"users",t));if(!e.exists())return null;const n=e.data();return{id:e.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}},async getUserByUsername(t){const e=qe(ne,"users"),n=xt(e,Tn("username","==",t)),s=await Vt(n);if(s.empty)return null;const r=s.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const t=qe(ne,"users");return(await Vt(t)).docs.map(n=>{const s=n.data();return{id:n.id,username:s.username,name:s.name,email:s.email,role:s.role||"user",phone:s.phone,department:s.department,position:s.position,avatar:s.avatar}})},async createUser(t){const{password:e,...n}=t,s=await Ia(e),r=qe(ne,"users"),i=we(r),a={...n,passwordHash:s,createdAt:sn(),updatedAt:sn()};return await ri(i,a),{id:i.id,...n}},async updateUser(t,e){const n=we(ne,"users",t);await Ut(n,{...e,updatedAt:sn()});const r=(await Pt(n)).data();return{id:t,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(t,e,n){const s=await Pt(we(ne,"users",t));if(!s.exists())throw new Error("   .");const r=s.data(),i=await Ia(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const a=await Ia(n);return await Ut(we(ne,"users",t),{passwordHash:a,updatedAt:sn()}),!0},verifyToken:Df};class Jk{async login(e){const n=await Ac.login(e);return n.success&&n.token&&(localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user))),n}async getCurrentUser(){const e=this.getToken(),n=this.getUser();if(!e)return n;try{const s=await Ac.getCurrentUser(e);return s?(localStorage.setItem("user",JSON.stringify(s)),s):(console.log("Token invalid or expired, using cached user..."),n?(localStorage.removeItem("token"),n):null)}catch(s){return console.error("Get current user error:",s),n?(console.log("Using cached user data due to error"),n):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Ac.getAllUsers()}}const Af=new Jk,yi=(t,e)=>({id:parseInt(t)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Ec={async getLibraryMeta(){const t=qe(ne,"specbook_items"),e=xt(t,Tn("is_library","==",1),on("category"),on("name"));return(await Vt(e)).docs.map(s=>yi(s.id,s.data()))},async getCategories(){const t=await this.getLibraryMeta();return[...new Set(t.map(n=>n.category))].sort()},async getProjectMeta(t){const e=qe(ne,"specbook_items"),n=xt(e,Tn("project_id","==",t),on("display_order"));return(await Vt(n)).docs.map(r=>yi(r.id,r.data()))},async getItemById(t){const e=we(ne,"specbook_items",t),n=await Pt(e);return n.exists()?yi(n.id,n.data()):null},async getItemImage(t){const e=we(ne,"specbook_items",t),n=await Pt(e);if(!n.exists())return null;const s=n.data();return{image_url:s.image_url||null,sub_images:s.sub_images||[]}},subscribeToLibraryItems(t){const e=qe(ne,"specbook_items"),n=xt(e,Tn("is_library","==",1));return us(n,r=>{const i=r.docs.map(a=>yi(a.id,a.data()));i.sort((a,c)=>a.category!==c.category?a.category.localeCompare(c.category):a.name.localeCompare(c.name)),t(i)})},subscribeToProjectItems(t,e){const n=qe(ne,"specbook_items"),s=xt(n,Tn("project_id","==",t));return us(s,i=>{const a=i.docs.map(c=>yi(c.id,c.data()));a.sort((c,m)=>(c.display_order||0)-(m.display_order||0)),e(a)})},async updateCategories(t){const e=we(ne,"specbook_settings","categories");await ri(e,{categories:t,updatedAt:sn()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(t){try{const e=qe(ne,"specbook_items"),n=await Vt(e);let s=0;n.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>s&&(s=u)});const r=s+1;let i=null;if(t.image&&t.image.startsWith("data:")){const m=t.image.split(",")[1],u=t.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(m),y=new Array(h.length);for(let L=0;L<h.length;L++)y[L]=h.charCodeAt(L);const w=new Uint8Array(y),_=new Blob([w],{type:d}),S=`specbook/${r}-${Date.now()}.${f}`,R=gl(yl,S);await lm(R,_),i=await cm(R)}const a=new Date().toISOString(),c=we(ne,"specbook_items",String(r));return await ri(c,{name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade||null,created_at:a,updated_at:a}),console.log(" [Firestore]    :",r),{id:r,name:t.name,category:t.category,brand:t.brand||"",price:t.price||"",description:t.description||"",image_url:i,sub_images:t.sub_images||[],project_id:t.project_id||null,is_library:t.is_library??1,display_order:t.display_order||0,grade:t.grade,created_at:a,updated_at:a}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(t,e){try{const n=we(ne,"specbook_items",String(t)),s=await Pt(n);if(!s.exists())throw new Error("   .");const r=s.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const m=e.image.split(",")[1],u=e.image.match(/data:([^;]+);/),d=u?u[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(m),y=new Array(h.length);for(let L=0;L<h.length;L++)y[L]=h.charCodeAt(L);const w=new Uint8Array(y),_=new Blob([w],{type:d}),S=`specbook/${t}-${Date.now()}.${f}`,R=gl(yl,S);await lm(R,_),i=await cm(R)}const c={updated_at:new Date().toISOString()};return e.name!==void 0&&(c.name=e.name),e.category!==void 0&&(c.category=e.category),e.brand!==void 0&&(c.brand=e.brand),e.price!==void 0&&(c.price=e.price),e.description!==void 0&&(c.description=e.description),i!==r.image_url&&(c.image_url=i),e.sub_images!==void 0&&(c.sub_images=e.sub_images),e.project_id!==void 0&&(c.project_id=e.project_id),e.is_library!==void 0&&(c.is_library=e.is_library),e.display_order!==void 0&&(c.display_order=e.display_order),e.grade!==void 0&&(c.grade=e.grade),await Ut(n,c),console.log(" [Firestore]    :",t),yi(String(t),{...r,...c,image_url:i})}catch(n){throw console.error("[Firestore]    :",n),new Error(`  : ${n.message||"   "}`)}},async deleteItem(t){try{const e=we(ne,"specbook_items",String(t));await Un(e),console.log(" [Firestore]    :",t)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(t,e){try{const n=we(ne,"specbook_items",String(t));await Ut(n,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",t)}catch(n){throw console.error("[Firestore]    :",n),new Error(`   : ${n.message||"   "}`)}},async reorderItems(t){try{const e=jD(ne);t.forEach(n=>{const s=we(ne,"specbook_items",String(n.id));e.update(s,{display_order:n.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},Zk=10*60*1e3,eA=ym((t,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const n=e();if(!n.libraryLoading){if(n.libraryLoaded&&n.libraryLoadedAt&&Date.now()-n.libraryLoadedAt<Zk){console.log("[SpecbookStore]   , ");return}t({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const s=await Ec.getLibraryMeta();t({libraryItems:s,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",s.length," ")}catch(s){console.error("[SpecbookStore]   :",s),t({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const s=await Ec.getCategories();t({categories:s,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",s.length,"")}catch(s){console.error("[SpecbookStore]   :",s)}},preloadAll:async()=>{const{preloadLibrary:n,preloadCategories:s}=e();await Promise.all([n(),s()])},getLibraryItems:(n,s)=>{const{libraryItems:r}=e();let i=r;return n&&n!==""&&(i=i.filter(a=>a.category===n)),s&&s.length>0&&(i=i.filter(a=>{if(!a.grade)return!1;const c=a.grade.split(",").map(m=>m.trim());return s.some(m=>c.includes(m))})),i=[...i].sort((a,c)=>{var d,f;const m=parseInt(((d=a.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=c.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-m}),i},getProjectItems:n=>{const{projectItemsCache:s}=e();return s.get(n)||null},loadProjectItems:async n=>{const r=e().projectItemsCache.get(n);if(r)return r;try{const i=await Ec.getProjectMeta(n);return t(a=>{const c=new Map(a.projectItemsCache);return c.set(n,i),{projectItemsCache:c}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:n=>{t(s=>{const r=new Map(s.projectItemsCache);return r.delete(n),{projectItemsCache:r}})},invalidateAll:()=>{t({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:n=>{n.is_library?t(s=>({libraryItems:[n,...s.libraryItems]})):n.project_id&&t(s=>{const r=new Map(s.projectItemsCache),i=r.get(n.project_id)||[];return r.set(n.project_id,[n,...i]),{projectItemsCache:r}})},updateItemInCache:n=>{n.is_library?t(s=>({libraryItems:s.libraryItems.map(r=>r.id===n.id?n:r)})):n.project_id&&t(s=>{const r=new Map(s.projectItemsCache),i=r.get(n.project_id);return i&&r.set(n.project_id,i.map(a=>a.id===n.id?n:a)),{projectItemsCache:r}})},removeItemFromCache:(n,s,r)=>{s?t(i=>({libraryItems:i.libraryItems.filter(a=>a.id!==n)})):r&&t(i=>{const a=new Map(i.projectItemsCache),c=a.get(r);return c&&a.set(r,c.filter(m=>m.id!==n)),{projectItemsCache:a}})}})),Qg=A.createContext(void 0);function tA({children:t}){const[e,n]=A.useState(null),[s,r]=A.useState(!0),i=op(),a=eA(f=>f.preloadAll);A.useEffect(()=>{c()},[]);const c=async()=>{try{const f=localStorage.getItem("user");let h=null;if(f)try{h=JSON.parse(f)}catch{}if(h&&(n(h),a()),!localStorage.getItem("token")){r(!1);return}const w=await Af.getCurrentUser();w&&(n(w),localStorage.setItem("user",JSON.stringify(w)))}catch(f){console.error("Auth check error:",f)}finally{r(!1)}},m=async(f,h)=>{var y,w;try{const _=await Af.login({username:f,password:h}),S=_.token,R=_.user;localStorage.setItem("token",S),localStorage.setItem("user",JSON.stringify(R)),Oo.defaults.headers.common.Authorization=`Bearer ${S}`,n(R),a(),te.success(`${R.name}, !`);const L=sessionStorage.getItem("redirectAfterLogin");L?(sessionStorage.removeItem("redirectAfterLogin"),i(L)):i("/")}catch(_){const S=_;throw te.error(((w=(y=S.response)==null?void 0:y.data)==null?void 0:w.message)||" "),_}},u=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Oo.defaults.headers.common.Authorization,n(null),i("/login"),te.success("")},d=f=>{n(f)};return o.jsxDEV(Qg.Provider,{value:{user:e,loading:s,login:m,logout:u,updateUser:d},children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:131,columnNumber:5},this)}function Br(){const t=A.useContext(Qg);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const nA={};function sA(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var i;const a=m=>m===null?null:JSON.parse(m,void 0),c=(i=n.getItem(r))!=null?i:null;return c instanceof Promise?c.then(a):a(c)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const ea=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(s){return ea(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return ea(s)(n)}}}},rA=(t,e)=>(n,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,R)=>({...R,...S}),...e},a=!1;const c=new Set,m=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...S)},s,r);const d=ea(i.serialize),f=()=>{const S=i.partialize({...s()});let R;const L=d({state:S,version:i.version}).then($=>u.setItem(i.name,$)).catch($=>{R=$});if(R)throw R;return L},h=r.setState;r.setState=(S,R)=>{h(S,R),f()};const y=t((...S)=>{n(...S),f()},s,r);let w;const _=()=>{var S;if(!u)return;a=!1,c.forEach(L=>L(s()));const R=((S=i.onRehydrateStorage)==null?void 0:S.call(i,s()))||void 0;return ea(u.getItem.bind(u))(i.name).then(L=>{if(L)return i.deserialize(L)}).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return i.migrate(L.state,L.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return L.state}).then(L=>{var $;return w=i.merge(L,($=s())!=null?$:y),n(w,!0),f()}).then(()=>{R==null||R(w,void 0),a=!0,m.forEach(L=>L(w))}).catch(L=>{R==null||R(void 0,L)})};return r.persist={setOptions:S=>{i={...i,...S},S.getStorage&&(u=S.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:S=>(c.add(S),()=>{c.delete(S)}),onFinishHydration:S=>(m.add(S),()=>{m.delete(S)})},_(),w||y},iA=(t,e)=>(n,s,r)=>{let i={storage:sA(()=>localStorage),partialize:_=>_,version:0,merge:(_,S)=>({...S,..._}),...e},a=!1;const c=new Set,m=new Set;let u=i.storage;if(!u)return t((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(..._)},s,r);const d=()=>{const _=i.partialize({...s()});return u.setItem(i.name,{state:_,version:i.version})},f=r.setState;r.setState=(_,S)=>{f(_,S),d()};const h=t((..._)=>{n(..._),d()},s,r);r.getInitialState=()=>h;let y;const w=()=>{var _,S;if(!u)return;a=!1,c.forEach(L=>{var $;return L(($=s())!=null?$:h)});const R=((S=i.onRehydrateStorage)==null?void 0:S.call(i,(_=s())!=null?_:h))||void 0;return ea(u.getItem.bind(u))(i.name).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return[!0,i.migrate(L.state,L.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,L.state];return[!1,void 0]}).then(L=>{var $;const[ie,ee]=L;if(y=i.merge(ee,($=s())!=null?$:h),n(y,!0),ie)return d()}).then(()=>{R==null||R(y,void 0),y=s(),a=!0,m.forEach(L=>L(y))}).catch(L=>{R==null||R(void 0,L)})};return r.persist={setOptions:_=>{i={...i,..._},_.storage&&(u=_.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>a,onHydrate:_=>(c.add(_),()=>{c.delete(_)}),onFinishHydration:_=>(m.add(_),()=>{m.delete(_)})},i.skipHydration||w(),y||h},oA=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((nA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),rA(t,e)):iA(t,e),Yg=oA,Gg=ym()(Yg((t,e)=>({notifications:[],unreadCount:0,addNotification:n=>{const s={...n,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};t(r=>({notifications:[s,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:n=>{t(s=>({notifications:s.notifications.map(r=>r.id===n?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{t(n=>({notifications:n.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},deleteNotification:n=>{t(s=>{const r=s.notifications.find(a=>a.id===n),i=r&&!r.read;return{notifications:s.notifications.filter(a=>a.id!==n),unreadCount:i?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAll:()=>{t({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:t=>({notifications:t.notifications,unreadCount:t.unreadCount})}));var aA={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},lA=function(e,n,s){var r,i=aA[e];return typeof i=="string"?r=i:n===1?r=i.one:r=i.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?r+" ":r+" ":r},cA={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},mA={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},uA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},dA={date:dc({formats:cA,defaultWidth:"full"}),time:dc({formats:mA,defaultWidth:"full"}),dateTime:dc({formats:uA,defaultWidth:"full"})},fA={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},pA=function(e,n,s,r){return fA[e]},hA={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},gA={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},yA={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},bA={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},NA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},xA={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},vA=function(e,n){var s=Number(e),r=String(n==null?void 0:n.unit);switch(r){case"minute":case"second":return String(s);case"date":return s+"";default:return s+""}},_A={ordinalNumber:vA,era:mo({values:hA,defaultWidth:"wide"}),quarter:mo({values:gA,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:mo({values:yA,defaultWidth:"wide"}),day:mo({values:bA,defaultWidth:"wide"}),dayPeriod:mo({values:NA,defaultWidth:"wide",formattingValues:xA,defaultFormattingWidth:"wide"})},DA=/^(\d+)(|)?/i,kA=/\d+/i,AA={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},EA={any:[/^(bc|)/i,/^(ad|)/i]},VA={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},CA={any:[/1/i,/2/i,/3/i,/4/i]},wA={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},SA={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},IA={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},PA={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},LA={any:/^(am|pm|||||||)/i},TA={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},jA={ordinalNumber:Ub({matchPattern:DA,parsePattern:kA,valueCallback:function(e){return parseInt(e,10)}}),era:uo({matchPatterns:AA,defaultMatchWidth:"wide",parsePatterns:EA,defaultParseWidth:"any"}),quarter:uo({matchPatterns:VA,defaultMatchWidth:"wide",parsePatterns:CA,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:uo({matchPatterns:wA,defaultMatchWidth:"wide",parsePatterns:SA,defaultParseWidth:"any"}),day:uo({matchPatterns:IA,defaultMatchWidth:"wide",parsePatterns:PA,defaultParseWidth:"any"}),dayPeriod:uo({matchPatterns:LA,defaultMatchWidth:"any",parsePatterns:TA,defaultParseWidth:"any"})},Nn={code:"ko",formatDistance:lA,formatLong:dA,formatRelative:pA,localize:_A,match:jA,options:{weekStartsOn:0,firstWeekContainsDate:1}};const RA=({isOpen:t,onClose:e})=>{const n=op(),{notifications:s,unreadCount:r,markAsRead:i,markAllAsRead:a,deleteNotification:c,clearAll:m}=Gg();if(!t)return null;const u=h=>{switch(h){case"payment":return o.jsxDEV(Vb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return o.jsxDEV(Eb,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return o.jsxDEV(cp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return o.jsxDEV(Ab,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return o.jsxDEV(uc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(n(h.link),e())};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),o.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV(uc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&o.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),s.length>0&&o.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&o.jsxDEV("button",{onClick:a,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[o.jsxDEV(lp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),o.jsxDEV("button",{onClick:m,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[o.jsxDEV(ti,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[o.jsxDEV(uc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-100",children:s.map(h=>o.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:u(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[o.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&o.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Hb(new Date(h.createdAt),{addSuffix:!0,locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),o.jsxDEV("button",{onClick:y=>{y.stopPropagation(),c(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:o.jsxDEV(xn,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},bi="work_requests",po=t=>{const e=t.data();return{_id:t.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof Ne?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof Ne?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof Ne?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof Ne?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof Ne?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ni={getAllWorkRequests:async()=>{const t=xt(qe(ne,bi),on("createdAt","desc"));return(await Vt(t)).docs.map(po)},getWorkRequestById:async t=>{const e=we(ne,bi,t),n=await Pt(e);return n.exists()?po(n):null},createWorkRequest:async t=>{const e=Ne.now(),n={project:t.project,requestType:t.requestType,description:t.description,requestDate:t.requestDate instanceof Date?Ne.fromDate(t.requestDate):t.requestDate,dueDate:t.dueDate instanceof Date?Ne.fromDate(t.dueDate):t.dueDate,requestedBy:t.requestedBy,assignedTo:t.assignedTo,status:t.status||"pending",priority:t.priority||"medium",notes:t.notes||"",createdAt:e,updatedAt:e},s=await Fs(qe(ne,bi),n),r=await Pt(s);return po(r)},updateWorkRequest:async(t,e)=>{const n=we(ne,bi,t),s={updatedAt:Ne.now()};e.project!==void 0&&(s.project=e.project),e.requestType!==void 0&&(s.requestType=e.requestType),e.description!==void 0&&(s.description=e.description),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?Ne.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(s.dueDate=e.dueDate instanceof Date?Ne.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(s.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.status!==void 0&&(s.status=e.status),e.priority!==void 0&&(s.priority=e.priority),e.notes!==void 0&&(s.notes=e.notes),e.completedDate!==void 0&&(s.completedDate=e.completedDate instanceof Date?Ne.fromDate(e.completedDate):e.completedDate),await Ut(n,s);const r=await Pt(n);return po(r)},deleteWorkRequest:async t=>{const e=we(ne,bi,t);await Un(e)},subscribeToWorkRequests:t=>{const e=xt(qe(ne,bi),on("createdAt","desc"));return us(e,n=>{const s=n.docs.map(po);t(s)})}},BA={getAllWorkRequests:()=>Ni.getAllWorkRequests(),getWorkRequestById:async t=>{const e=await Ni.getWorkRequestById(t);if(!e)throw new Error("Work request not found");return e},createWorkRequest:t=>Ni.createWorkRequest(t),updateWorkRequest:(t,e)=>Ni.updateWorkRequest(t,e),deleteWorkRequest:t=>Ni.deleteWorkRequest(t),subscribeToWorkRequests:Ni.subscribeToWorkRequests},Bt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function y1(t,e){const n=qe(ne,t);return(await Fs(n,{...e,createdAt:Ne.now(),updatedAt:Ne.now()})).id}function Qi(t){return!t||typeof t!="string"||t.startsWith("http://")||t.startsWith("https://")?!1:!!(t.startsWith("data:image")||t.length>1e3)}function UA(t){if(t.startsWith("data:")){const e=t.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function HA(t){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[t]||"jpg"}function MA(t){let e=t,n="image/jpeg";if(t.includes(",")){const a=t.split(",");e=a[1];const c=a[0].match(/data:([^;]+);/);c&&(n=c[1])}const s=atob(e),r=new Array(s.length);for(let a=0;a<s.length;a++)r[a]=s.charCodeAt(a);const i=new Uint8Array(r);return new Blob([i],{type:n})}async function Xg(t,e,n,s){if(!Qi(n))return n;const r=UA(n),i=HA(r),a=s!==void 0?`image_${s}.${i}`:`main.${i}`,c=`${t}/${e}/${a}`,m=gl(yl,c),u=MA(n);return await lm(m,u,{contentType:r}),await cm(m)}async function bl(t,e,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],a=await Xg(t,e,i,r);s.push(a)}return s}async function Jg(t){if(t.includes("firebasestorage.googleapis.com"))try{const e=t.match(/\/o\/(.+)\?/);if(e){const n=decodeURIComponent(e[1]),s=gl(yl,n);await $k(s)}}catch(e){console.warn("  :",e)}}async function Zg(t){await Promise.all(t.map(e=>Jg(e)))}let ei=new Map,Ri=null;async function mr(){if(!(ei.size>0))return Ri||(Ri=(async()=>{try{const t=qe(ne,Bt.PROJECTS);(await Vt(t)).docs.forEach(n=>{const s=n.data();ei.set(n.id,{name:s.name||"",color:s.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ei.size,"")}catch(t){throw console.error("[paymentFirestoreService]    :",t),Ri=null,t}})(),Ri)}function ho(t){const e=ei.get(String(t.projectId))||{name:"",color:"#4A90E2"};return!e.name&&t.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:t.id,projectId:t.projectId,cacheSize:ei.size,cacheKeys:Array.from(ei.keys()).slice(0,5),vendorName:t.vendorName}),{id:t.id,project_id:t.projectId,project_name:e.name,project_color:e.color,user_id:t.userId||0,requester_name:t.requestedBy||"",approved_by:t.approvedBy||void 0,request_type:t.requestType||"material",vendor_name:t.vendorName||"",description:t.description||"",amount:t.amount||0,account_holder:t.accountHolder||"",bank_name:t.bankName||"",account_number:t.accountNumber||"",item_name:t.itemName||"",material_amount:t.materialAmount||0,labor_amount:t.laborAmount||0,original_material_amount:t.originalMaterialAmount||0,original_labor_amount:t.originalLaborAmount||0,apply_tax_deduction:t.applyTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,quick_text:t.quickText||"",images:t.images?JSON.stringify(t.images):"[]",notes:t.notes||"",status:t.status||"pending",created_at:t.createdAt||"",updated_at:t.updatedAt||"",paid_at:t.paidAt||void 0,request_date:t.requestDate||t.createdAt||""}}function Ef(t){const e={};if(t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.request_type!==void 0&&(e.requestType=t.request_type),t.category!==void 0&&(e.requestType=t.category),t.vendor_name!==void 0&&(e.vendorName=t.vendor_name),t.process!==void 0&&(e.vendorName=t.process),t.description!==void 0&&(e.description=t.description),t.purpose!==void 0&&(e.description=t.purpose),t.amount!==void 0&&(e.amount=t.amount),t.account_holder!==void 0&&(e.accountHolder=t.account_holder),t.bank_name!==void 0&&(e.bankName=t.bank_name),t.account_number!==void 0&&(e.accountNumber=t.account_number),t.bankInfo!==void 0&&typeof t.bankInfo=="object"&&t.bankInfo!==null){const n=t.bankInfo;n.accountHolder&&(e.accountHolder=n.accountHolder),n.bankName&&(e.bankName=n.bankName),n.accountNumber&&(e.accountNumber=n.accountNumber)}if(t.notes!==void 0&&(e.notes=t.notes),t.itemName!==void 0&&(e.itemName=t.itemName),t.item_name!==void 0&&(e.itemName=t.item_name),t.materialAmount!==void 0&&(e.materialAmount=t.materialAmount),t.laborAmount!==void 0&&(e.laborAmount=t.laborAmount),t.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=t.originalMaterialAmount),t.originalLaborAmount!==void 0&&(e.originalLaborAmount=t.originalLaborAmount),t.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=t.applyTaxDeduction),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),t.quickText!==void 0&&(e.quickText=t.quickText),t.images!==void 0&&(e.images=Array.isArray(t.images)?t.images:[]),t.status!==void 0&&(e.status=t.status),t.requestedBy!==void 0&&(e.requestedBy=t.requestedBy),t.requestDate!==void 0){const n=t.requestDate;n instanceof Date?e.requestDate=n.toISOString():typeof n=="string"&&(e.requestDate=n)}return t.request_date!==void 0&&typeof t.request_date=="string"&&(e.requestDate=t.request_date),e}const Xn={getAllPayments:async()=>{await mr();const t=qe(ne,Bt.PAYMENTS),e=xt(t,on("id","desc"));let n;try{n=await LD(e),console.log("[getAllPayments]   :",n.docs.length,"")}catch(s){console.warn("[getAllPayments]   ,  :",s),n=await Vt(e)}return n.docs.map(s=>{const r=s.data();return ho({...r,id:parseInt(s.id)||r.id})})},getPaymentById:async t=>{await mr();const e=we(ne,Bt.PAYMENTS,t),n=await Pt(e);if(n.exists()){const s=n.data();return ho({...s,id:parseInt(n.id)||s.id})}return null},createPayment:async t=>{await mr();const e=qe(ne,Bt.PAYMENTS),n=await Vt(e);let s=0;n.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>s&&(s=d)});const r=s+1,i=Ef(t),a=new Date().toISOString(),c={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",requestDate:i.requestDate||a,createdAt:a,updatedAt:a,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},m=we(ne,Bt.PAYMENTS,String(r));if(await ri(m,c),i.images&&i.images.length>0)if(i.images.some(d=>Qi(d))){const d=await bl("payments",String(r),i.images);await Ut(m,{images:d,imageCount:d.length}),c.images=d,c.imageCount=d.length}else await Ut(m,{images:i.images,imageCount:i.images.length}),c.images=i.images,c.imageCount=i.images.length;return ho(c)},updatePayment:async(t,e)=>{await mr();const n=we(ne,Bt.PAYMENTS,t),s=Ef(e);await Ut(n,{...s,updatedAt:new Date().toISOString()});const r=await Xn.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(t,e)=>{console.log("[Firestore]   :",t,"->",e),await mr();const n=we(ne,Bt.PAYMENTS,t),s=new Date().toISOString(),r={status:e,updatedAt:s};e==="completed"&&(r.paidAt=s),await Ut(n,r),console.log("[Firestore]   :",t,"->",e);const i=await Xn.getPaymentById(t);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(t,e,n)=>{await mr();const s=we(ne,Bt.PAYMENTS,t);await Ut(s,{materialAmount:e,laborAmount:n,updatedAt:new Date().toISOString()});const r=await Xn.getPaymentById(t);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(t,e)=>{const n=we(ne,Bt.PAYMENTS,t);let s=e;return e.length>0&&e.some(i=>Qi(i))&&(s=await bl("payments",t,e)),await Ut(n,{images:s,imageCount:s.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:s}},deletePayment:async t=>{const e=we(ne,Bt.PAYMENTS,t),n=await Pt(e);if(n.exists()){const s=n.data();s.images&&s.images.length>0&&await Zg(s.images)}await Un(e)},subscribeToPayments:t=>{console.log("[paymentFirestoreService] subscribeToPayments ");let e=null;return mr().then(()=>{const n=qe(ne,Bt.PAYMENTS),s=xt(n,on("id","desc"));console.log("[paymentFirestoreService] Firestore onSnapshot  ..."),e=us(s,{includeMetadataChanges:!0},r=>{console.log("[ ]  :",r.docs.length,", fromCache:",r.metadata.fromCache),r.docChanges().forEach(a=>{const c=a.doc.data();console.log(`[ ] : ${a.type} - ID: ${a.doc.id}, status: ${c.status}`)});const i=r.docs.map(a=>{const c=a.data();return ho({...c,id:parseInt(a.id)||c.id})});t(i)},r=>{console.error("[ ]  :",r)})}).catch(n=>{console.error("[paymentFirestoreService]    :",n)}),()=>{console.log("[paymentFirestoreService]   "),e&&e()}},getPaymentsByProject:async t=>{await mr();const e=qe(ne,Bt.PAYMENTS),n=xt(e,Tn("projectId","==",t),on("id","desc"));return(await Vt(n)).docs.map(r=>{const i=r.data();return ho({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ei.clear(),Ri=null}},hs={getAllPayments:()=>Xn.getAllPayments(),getPaymentById:async t=>{const e=await Xn.getPaymentById(t);if(!e)throw new Error("Payment not found");return e},createPayment:t=>Xn.createPayment(t),updatePayment:(t,e)=>Xn.updatePayment(t,e),updatePaymentStatus:(t,e)=>Xn.updatePaymentStatus(t,e),updatePaymentAmounts:(t,e,n)=>Xn.updatePaymentAmounts(t,e,n),updatePaymentImages:(t,e)=>Xn.updatePaymentImages(t,e),deletePayment:t=>Xn.deletePayment(t),sendTossPaymentSms:async t=>(await Oo.post("/payments/send-toss-payment-sms",t)).data,subscribeToPayments:Xn.subscribeToPayments,getPaymentsByProject:Xn.getPaymentsByProject,clearProjectsCache:Xn.clearProjectsCache},xi="as_requests",go=t=>{const e=t.data();return{_id:t.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof Ne?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof Ne?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof Ne?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof Ne?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof Ne?e.updatedAt.toDate().toISOString():e.updatedAt||""}},vi={getAllASRequests:async()=>{const t=xt(qe(ne,xi),on("createdAt","desc"));return(await Vt(t)).docs.map(go)},getASRequestById:async t=>{const e=we(ne,xi,t),n=await Pt(e);return n.exists()?go(n):null},createASRequest:async t=>{const e=Ne.now(),n={project:t.project,client:t.client,requestDate:t.requestDate instanceof Date?Ne.fromDate(t.requestDate):t.requestDate,siteAddress:t.siteAddress,entrancePassword:t.entrancePassword,description:t.description,status:t.status||"pending",notes:t.notes||"",createdAt:e,updatedAt:e};t.scheduledVisitDate&&(n.scheduledVisitDate=t.scheduledVisitDate instanceof Date?Ne.fromDate(t.scheduledVisitDate):t.scheduledVisitDate),t.scheduledVisitTime&&(n.scheduledVisitTime=t.scheduledVisitTime),t.assignedTo&&(n.assignedTo=t.assignedTo);const s=await Fs(qe(ne,xi),n),r=await Pt(s);return go(r)},updateASRequest:async(t,e)=>{const n=we(ne,xi,t),s={updatedAt:Ne.now()};e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.requestDate!==void 0&&(s.requestDate=e.requestDate instanceof Date?Ne.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(s.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(s.entrancePassword=e.entrancePassword),e.description!==void 0&&(s.description=e.description),e.scheduledVisitDate!==void 0&&(s.scheduledVisitDate=e.scheduledVisitDate instanceof Date?Ne.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(s.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.completionDate!==void 0&&(s.completionDate=e.completionDate instanceof Date?Ne.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(s.notes=e.notes),e.status!==void 0&&(s.status=e.status),await Ut(n,s);const r=await Pt(n);return go(r)},deleteASRequest:async t=>{const e=we(ne,xi,t);await Un(e)},subscribeToASRequests:t=>{const e=xt(qe(ne,xi),on("createdAt","desc"));return us(e,n=>{const s=n.docs.map(go);t(s)})}},Io={getAllASRequests:()=>vi.getAllASRequests(),getASRequestById:async t=>{const e=await vi.getASRequestById(t);if(!e)throw new Error("AS Request not found");return e},createASRequest:t=>vi.createASRequest(t),updateASRequest:(t,e)=>vi.updateASRequest(t,e),deleteASRequest:t=>vi.deleteASRequest(t),subscribeToASRequests:vi.subscribeToASRequests};function yo(t){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:t.id,id:parseInt(t.id)||0,name:t.name,client:{name:t.client||"",phone:"",address:t.address||""},location:{address:t.address||""},startDate:t.startDate||"",endDate:t.endDate||"",status:e[t.status]||"planning",budget:0,actualCost:0,manager:{_id:String(t.managerId||""),name:t.managerName||t.manager||"",username:t.managerUsername||""},fieldManagers:[],workers:[],colorCode:t.color||"#4A90E2",progress:0,description:t.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:t.createdAt||"",updatedAt:t.updatedAt||"",meetingNotes:t.meetingNotes||[],customerRequests:t.customerRequests||[],entrancePassword:t.entrancePassword||"",sitePassword:t.sitePassword||""}}function Vf(t){var n,s,r,i,a,c,m,u;const e={};if(t.name!==void 0&&(e.name=t.name),t.client!==void 0&&(e.client=typeof t.client=="string"?t.client:((n=t.client)==null?void 0:n.name)||""),t.location!==void 0&&(e.address=typeof t.location=="string"?t.location:((s=t.location)==null?void 0:s.address)||""),t.address!==void 0&&(e.address=t.address),t.startDate!==void 0&&(e.startDate=typeof t.startDate=="string"?t.startDate:((a=(i=(r=t.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:a.split("T")[0])||null),t.endDate!==void 0&&(e.endDate=typeof t.endDate=="string"?t.endDate:((u=(m=(c=t.endDate)==null?void 0:c.toISOString)==null?void 0:m.call(c))==null?void 0:u.split("T")[0])||null),t.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[t.status]||"planning"}return t.description!==void 0&&(e.description=t.description),t.manager!==void 0&&(e.manager=t.manager),t.meetingNotes!==void 0&&(e.meetingNotes=t.meetingNotes),t.customerRequests!==void 0&&(e.customerRequests=t.customerRequests),t.entrancePassword!==void 0&&(e.entrancePassword=t.entrancePassword),t.sitePassword!==void 0&&(e.sitePassword=t.sitePassword),t.color!==void 0&&(e.color=t.color),t.colorCode!==void 0&&(e.color=t.colorCode),e}const pr={getAllProjects:async()=>{const t=qe(ne,Bt.PROJECTS);return(await Vt(t)).docs.map(s=>{const r=s.data();return yo({...r,id:s.id})}).sort((s,r)=>(r.id||0)-(s.id||0))},getProjectById:async t=>{const e=we(ne,Bt.PROJECTS,t),n=await Pt(e);if(n.exists()){const s=n.data();return yo({...s,id:n.id})}return null},createProject:async t=>{const e=qe(ne,Bt.PROJECTS),n=await Vt(e);let s=0;n.docs.forEach(u=>{const d=parseInt(u.id);!isNaN(d)&&d>s&&(s=d)});const r=String(s+1),i=Vf(t),a=new Date().toISOString(),c={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:a,updatedAt:a},m=we(ne,Bt.PROJECTS,r);return await ri(m,c),yo(c)},updateProject:async(t,e)=>{const n=we(ne,Bt.PROJECTS,t),s=Vf(e);await Ut(n,{...s,updatedAt:new Date().toISOString()});const r=await pr.getProjectById(t);if(!r)throw new Error("Project not found after update");return r},deleteProject:async t=>{const e=we(ne,Bt.PROJECTS,t);await Un(e)},subscribeToProjects:t=>{const e=qe(ne,Bt.PROJECTS);return us(e,n=>{const s=n.docs.map(r=>{const i=r.data();return yo({...i,id:r.id})});s.sort((r,i)=>(i.id||0)-(r.id||0)),t(s)})},subscribeToProject:(t,e)=>{const n=we(ne,Bt.PROJECTS,t);return us(n,s=>{if(s.exists()){const r=s.data();e(yo({...r,id:s.id}))}else e(null)})}},Ui={getAllProjects:()=>pr.getAllProjects(),getProjectById:async t=>{const e=await pr.getProjectById(t);if(!e)throw new Error("Project not found");return e},createProject:t=>pr.createProject(t),updateProject:(t,e)=>pr.updateProject(t,e),deleteProject:t=>pr.deleteProject(t),subscribeToProjects:pr.subscribeToProjects,subscribeToProject:pr.subscribeToProject},Vc=t=>t?typeof t=="string"?t:t instanceof Ne?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Pa={async getAllQuoteInquiries(){const t=qe(ne,"quote_inquiries"),e=xt(t,on("createdAt","desc"));return(await Vt(e)).docs.map(s=>{const r=s.data();return{id:s.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Vc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(t){const e=we(ne,"quote_inquiries",t),n=await Pt(e);if(!n.exists())return null;const s=n.data();return{id:n.id,name:s.name||"",phone:s.phone||"",email:s.email||"",address:s.address,projectType:s.projectType,budget:s.budget,message:s.message||"",createdAt:Vc(s.createdAt),isRead:s.isRead||!1}},async createQuoteInquiry(t){const e=qe(ne,"quote_inquiries"),n={...t,isRead:!1,createdAt:sn()};return{id:(await Fs(e,n)).id,...t,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(t){const e=we(ne,"quote_inquiries",t);await Ut(e,{isRead:!0,updatedAt:sn()})},async deleteQuoteInquiry(t){const e=we(ne,"quote_inquiries",t);await Un(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(t){const e=qe(ne,"quote_inquiries"),n=xt(e,on("createdAt","desc"));return us(n,r=>{const i=r.docs.map(a=>{const c=a.data();return{id:a.id,name:c.name||"",phone:c.phone||"",email:c.email||"",address:c.address,projectType:c.projectType,budget:c.budget,message:c.message||"",createdAt:Vc(c.createdAt),isRead:c.isRead||!1}});t(i)})}},Xa={getAllQuoteInquiries:()=>Pa.getAllQuoteInquiries(),markAsRead:t=>Pa.markAsRead(t),deleteQuoteInquiry:t=>Pa.deleteQuoteInquiry(t),subscribeToQuoteInquiries:Pa.subscribeToQuoteInquiries},FA=()=>{var ae,Ue;const{user:t,logout:e,loading:n}=Br(),[s,r]=A.useState(!1),[i,a]=A.useState(!1),[c,m]=A.useState(!1),u=bb(),{unreadCount:d}=Gg(),[f,h]=A.useState(0),[y,w]=A.useState(0),[_,S]=A.useState(0),[R,L]=A.useState(0),[$,ie]=A.useState(!1),[ee,F]=A.useState(0),[C,N]=A.useState(!1),V=A.useRef(0),j=A.useRef(null),P=80,I=A.useCallback(fe=>{if(window.scrollY>0)return!1;let Le=fe;for(;Le&&Le!==document.body;){const bt=window.getComputedStyle(Le).overflowY;if((bt==="auto"||bt==="scroll")&&Le.scrollTop>0)return!1;Le=Le.parentElement}return!0},[]),k=A.useCallback(fe=>{if(window.innerWidth>=768)return;const Le=fe.target;I(Le)&&(V.current=fe.touches[0].clientY,ie(!0))},[I]),ke=A.useCallback(fe=>{if(!$||C)return;const Le=fe.target;if(!I(Le)){ie(!1),F(0);return}const bt=fe.touches[0].clientY-V.current;if(bt>0){const st=Math.min(bt*.5,120);F(st)}else ie(!1),F(0)},[$,C,I]),Be=A.useCallback(()=>{$&&(ee>=P&&!C?(N(!0),F(50),setTimeout(()=>{window.location.reload()},300)):F(0),ie(!1))},[$,ee,C]);if(A.useEffect(()=>{m(!1)},[u.pathname]),A.useEffect(()=>{const fe=Le=>{m(Le.detail.isOpen)};return window.addEventListener("mobileFormStateChange",fe),()=>window.removeEventListener("mobileFormStateChange",fe)},[]),A.useEffect(()=>{const fe=()=>{L(Le=>Math.max(0,Le-1))};return window.addEventListener("quoteInquiryRead",fe),()=>window.removeEventListener("quoteInquiryRead",fe)},[]),A.useEffect(()=>{const fe=()=>{w(Le=>Math.max(0,Le-1))};return window.addEventListener("paymentCompleted",fe),()=>window.removeEventListener("paymentCompleted",fe)},[]),A.useEffect(()=>{if(!t)return;const fe=Xn.subscribeToPayments(async Le=>{try{let Ke=Le;if(t.name===""){const st=(await Ui.getAllProjects()).map(Ct=>Ct.name);Ke=Le.filter(Ct=>st.includes(Ct.project_name))}w(Ke.filter(bt=>bt.status==="pending").length)}catch(Ke){console.error("Failed to refresh payment count:",Ke)}});return()=>{fe()}},[t]),A.useEffect(()=>{if(!t)return;const fe=async()=>{try{const[Ke,bt,st,Ct]=await Promise.all([BA.getAllWorkRequests(),hs.getAllPayments(),Io.getAllASRequests(),Ui.getAllProjects()]);h(Ke.filter(ct=>ct.assignedTo===t.name&&ct.status==="pending").length);let lt=bt;if(t.name===""){const ct=Ct.map(cn=>cn.name);lt=bt.filter(cn=>ct.includes(cn.project))}if(w(lt.filter(ct=>ct.status==="pending").length),S(st.filter(ct=>ct.status==="in-progress").length),t.role==="admin"||t.role==="manager")try{const cn=(await Xa.getAllQuoteInquiries()).filter(Q=>!Q.isRead).length;L(cn)}catch(ct){console.error("Failed to load quote inquiry count:",ct)}}catch(Ke){console.error("Failed to load badge counts:",Ke)}};fe();const Le=setInterval(fe,3e4);return()=>clearInterval(Le)},[t]),n)return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsxDEV("div",{className:"text-center",children:[o.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:240,columnNumber:11},void 0),o.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:241,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:239,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:238,columnNumber:7},void 0);if(!t){const fe=window.location.pathname+window.location.search;return fe&&fe!=="/login"&&fe!=="/"&&sessionStorage.setItem("redirectAfterLogin",fe),o.jsxDEV(ap,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:254,columnNumber:12},void 0)}const pe=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",..._>0&&{badge:_}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...R>0&&{badge:R}},{name:"",href:"/contractors"}],je=pe.filter(fe=>!fe.roles||fe.roles.includes((t==null?void 0:t.role)||"")),ut=((ae=pe.find(fe=>fe.href===u.pathname))==null?void 0:ae.name)||"",Mt=(()=>{const fe=u.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(fe)?()=>{const Ke=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Ke)}:null})();return o.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[o.jsxDEV("div",{className:xs("fixed inset-0 z-40 lg:hidden",s?"block":"hidden"),children:[o.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:322,columnNumber:9},void 0),o.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[o.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:328,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:327,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Le})=>xs("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:355,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:357,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:354,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:338,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:366,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:365,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:326,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:316,columnNumber:7},void 0),o.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:o.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[o.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:380,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:379,columnNumber:11},void 0),o.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Le})=>xs("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:o.jsxDEV("span",{className:"flex items-center justify-between",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:397,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:399,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:396,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:382,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:o.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:408,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:407,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:378,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:377,columnNumber:7},void 0),o.jsxDEV("div",{className:"main-content lg:pl-56",children:[o.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:o.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[o.jsxDEV("div",{className:"flex items-center space-x-3",children:[o.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:o.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:430,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:425,columnNumber:15},void 0),ut&&o.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ut},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:435,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:424,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Mt&&o.jsxDEV("button",{onClick:Mt,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":c?"":"",children:c?o.jsxDEV(xn,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:448,columnNumber:37},void 0):o.jsxDEV(Hi,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:448,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:443,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>a(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[o.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:458,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:457,columnNumber:17},void 0),d>0&&o.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:461,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:452,columnNumber:15},void 0),o.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:469,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:467,columnNumber:17},void 0),o.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Ue=t==null?void 0:t.name)==null?void 0:Ue.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:471,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:466,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:440,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:422,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:421,columnNumber:9},void 0),o.jsxDEV("div",{className:"portrait-top-nav hidden",children:o.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:je.map(fe=>o.jsxDEV(mc,{to:fe.href,className:({isActive:Le})=>xs("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Le?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:o.jsxDEV("span",{className:"flex items-center gap-1",children:[o.jsxDEV("span",{children:fe.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:496,columnNumber:19},void 0),fe.badge&&fe.badge>0&&o.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:fe.badge>99?"99+":fe.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:498,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:495,columnNumber:17},void 0)},fe.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:483,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:481,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:480,columnNumber:9},void 0),o.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:ke,onTouchEnd:Be,children:[ee>0&&o.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:ee,transition:$?"none":"height 0.2s ease-out"},children:o.jsxDEV("div",{className:xs("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",C&&"animate-spin"),style:{transform:`rotate(${C?0:ee*2}deg)`,opacity:Math.min(ee/P,1)},children:o.jsxDEV(Cb,{className:xs("w-5 h-5",ee>=P?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:536,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:526,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:518,columnNumber:13},void 0),o.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:ee>0?`translateY(${ee}px)`:"none",transition:$?"none":"transform 0.2s ease-out"},children:o.jsxDEV(Nb,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:546,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:509,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:419,columnNumber:7},void 0),o.jsxDEV(RA,{isOpen:i,onClose:()=>a(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:559,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:314,columnNumber:5},void 0)},OA=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",_i="schedules",bo=t=>{const e=t.data();return{_id:t.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof Ne?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof Ne?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof Ne?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof Ne?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof Ne?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},Di={getAllSchedules:async()=>{const t=xt(qe(ne,_i),on("startDate","desc"));return(await Vt(t)).docs.map(bo)},getScheduleById:async t=>{const e=we(ne,_i,t),n=await Pt(e);return n.exists()?bo(n):null},createSchedule:async t=>{const e=Ne.now(),n={project:typeof t.project=="string"?{_id:t.project,name:t.project}:t.project,title:t.title,type:t.type||"other",phase:t.phase||"",startDate:t.startDate instanceof Date?Ne.fromDate(t.startDate):t.startDate,endDate:t.endDate instanceof Date?Ne.fromDate(t.endDate):t.endDate,allDay:t.allDay??!0,assignedTo:t.assignedTo||[],description:t.description||"",location:t.location||"",priority:t.priority||"medium",progress:t.progress??0,isCompleted:t.isCompleted??!1,time:t.time||"",asRequestId:t.asRequestId||null,createdAt:e,updatedAt:e},s=await Fs(qe(ne,_i),n),r=await Pt(s);return bo(r)},updateSchedule:async(t,e)=>{const n=we(ne,_i,t),s={updatedAt:Ne.now()};e.project!==void 0&&(s.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(s.title=e.title),e.type!==void 0&&(s.type=e.type),e.phase!==void 0&&(s.phase=e.phase),e.startDate!==void 0&&(s.startDate=e.startDate instanceof Date?Ne.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate instanceof Date?Ne.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(s.allDay=e.allDay),e.assignedTo!==void 0&&(s.assignedTo=e.assignedTo),e.description!==void 0&&(s.description=e.description),e.location!==void 0&&(s.location=e.location),e.priority!==void 0&&(s.priority=e.priority),e.progress!==void 0&&(s.progress=e.progress),e.isCompleted!==void 0&&(s.isCompleted=e.isCompleted,e.isCompleted&&(s.completedAt=Ne.now())),e.time!==void 0&&(s.time=e.time),await Ut(n,s);const r=await Pt(n);return bo(r)},deleteSchedule:async t=>{const e=we(ne,_i,t);await Un(e)},subscribeToSchedules:t=>{const e=xt(qe(ne,_i),on("startDate","desc"));return us(e,n=>{const s=n.docs.map(bo);t(s)})}},La={getAllSchedules:()=>Di.getAllSchedules(),getScheduleById:async t=>{const e=await Di.getScheduleById(t);if(!e)throw new Error("Schedule not found");return e},createSchedule:t=>Di.createSchedule(t),updateSchedule:(t,e)=>Di.updateSchedule(t,e),deleteSchedule:t=>Di.deleteSchedule(t),subscribeToSchedules:Di.subscribeToSchedules},ki="contractors",No=t=>{const e=t.data();return{_id:t.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof Ne?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof Ne?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ai={getAllContractors:async()=>{const t=xt(qe(ne,ki),on("name","asc"));return(await Vt(t)).docs.map(No)},getContractorById:async t=>{const e=we(ne,ki,t),n=await Pt(e);return n.exists()?No(n):null},createContractor:async t=>{const e=Ne.now(),n={rank:t.rank||"",companyName:t.companyName||"",name:t.name,position:t.position||"",process:t.process,contact:t.contact||"",accountNumber:t.accountNumber,notes:t.notes||"",createdAt:e,updatedAt:e},s=await Fs(qe(ne,ki),n),r=await Pt(s);return No(r)},updateContractor:async(t,e)=>{const n=we(ne,ki,t),s={updatedAt:Ne.now()};e.rank!==void 0&&(s.rank=e.rank),e.companyName!==void 0&&(s.companyName=e.companyName),e.name!==void 0&&(s.name=e.name),e.position!==void 0&&(s.position=e.position),e.process!==void 0&&(s.process=e.process),e.contact!==void 0&&(s.contact=e.contact),e.accountNumber!==void 0&&(s.accountNumber=e.accountNumber),e.notes!==void 0&&(s.notes=e.notes),await Ut(n,s);const r=await Pt(n);return No(r)},deleteContractor:async t=>{const e=we(ne,ki,t);await Un(e)},subscribeToContractors:t=>{const e=xt(qe(ne,ki),on("name","asc"));return us(e,n=>{const s=n.docs.map(No);t(s)})}},Qs={getAllContractors:()=>Ai.getAllContractors(),getContractorById:async t=>{const e=await Ai.getContractorById(t);if(!e)throw new Error("Contractor not found");return e},createContractor:t=>Ai.createContractor(t),updateContractor:(t,e)=>Ai.updateContractor(t,e),deleteContractor:t=>Ai.deleteContractor(t),subscribeToContractors:Ai.subscribeToContractors},Ei="construction_payments",xo=t=>{const e=t.data();let n=e.payments||[];if(typeof n=="string")try{n=JSON.parse(n)}catch{n=[]}Array.isArray(n)||(n=[]);const s=n.map(i=>{let a=i.types||[];if(typeof a=="string")try{a=JSON.parse(a)}catch{a=[a]}return Array.isArray(a)||(a=[]),{types:a,type:a[0]||i.type||"",amount:i.amount||0,date:i.date instanceof Ne?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof Ne?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof Ne?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof Ne?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof Ne?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:t.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:s,expectedPaymentDates:r,createdAt:e.createdAt instanceof Ne?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof Ne?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Vi={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const t=await Vt(qe(ne,Ei));console.log("[ConstructionPayment] Firestore :",t.size," ");const e=t.docs.map(xo).filter(n=>n.project&&n.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(t){return console.error("[ConstructionPayment] Firestore  :",t),[]}},getConstructionPaymentById:async t=>{const e=we(ne,Ei,t),n=await Pt(e);return n.exists()?xo(n):null},createConstructionPayment:async t=>{const e=Ne.now(),n=(t.payments||[]).map(c=>({types:c.types,amount:c.amount,date:c.date instanceof Date?Ne.fromDate(c.date):c.date,method:c.method,notes:c.notes||""})),s={};t.expectedPaymentDates&&(t.expectedPaymentDates.contract&&(s.contract=t.expectedPaymentDates.contract instanceof Date?Ne.fromDate(t.expectedPaymentDates.contract):t.expectedPaymentDates.contract),t.expectedPaymentDates.start&&(s.start=t.expectedPaymentDates.start instanceof Date?Ne.fromDate(t.expectedPaymentDates.start):t.expectedPaymentDates.start),t.expectedPaymentDates.middle&&(s.middle=t.expectedPaymentDates.middle instanceof Date?Ne.fromDate(t.expectedPaymentDates.middle):t.expectedPaymentDates.middle),t.expectedPaymentDates.final&&(s.final=t.expectedPaymentDates.final instanceof Date?Ne.fromDate(t.expectedPaymentDates.final):t.expectedPaymentDates.final));const r={project:t.project,client:t.client,totalAmount:t.totalAmount,vatType:t.vatType,vatPercentage:t.vatPercentage,vatAmount:t.vatAmount,payments:n,expectedPaymentDates:s,createdAt:e,updatedAt:e},i=await Fs(qe(ne,Ei),r),a=await Pt(i);return xo(a)},updateConstructionPayment:async(t,e)=>{const n=we(ne,Ei,t),s={updatedAt:Ne.now()};if(e.project!==void 0&&(s.project=e.project),e.client!==void 0&&(s.client=e.client),e.totalAmount!==void 0&&(s.totalAmount=e.totalAmount),e.vatType!==void 0&&(s.vatType=e.vatType),e.vatPercentage!==void 0&&(s.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(s.vatAmount=e.vatAmount),e.payments!==void 0&&(s.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?Ne.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?Ne.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?Ne.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?Ne.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?Ne.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),s.expectedPaymentDates=i}await Ut(n,s);const r=await Pt(n);return xo(r)},deleteConstructionPayment:async t=>{const e=we(ne,Ei,t);await Un(e)},subscribeToConstructionPayments:t=>{const e=xt(qe(ne,Ei),on("createdAt","desc"));return us(e,n=>{const s=n.docs.map(xo);t(s)})}},Ta={getAllConstructionPayments:()=>Vi.getAllConstructionPayments(),getConstructionPaymentById:async t=>{const e=await Vi.getConstructionPaymentById(t);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:t=>Vi.createConstructionPayment(t),updateConstructionPayment:(t,e)=>Vi.updateConstructionPayment(t,e),deleteConstructionPayment:t=>Vi.deleteConstructionPayment(t),subscribeToConstructionPayments:Vi.subscribeToConstructionPayments};let Ja=new Map,vo=null;async function qA(){if(!(Ja.size>0))return vo||(vo=(async()=>{try{const t=qe(ne,Bt.PROJECTS);(await Vt(t)).docs.forEach(n=>{const s=n.data(),r=parseInt(n.id);!isNaN(r)&&s.name&&Ja.set(s.name,r)}),console.log("[executionRecordFirestoreService]    :",Ja.size,"")}catch(t){throw console.error("[executionRecordFirestoreService]    :",t),vo=null,t}})(),vo)}function Ci(t){return{id:t.id,project_id:t.projectId,project_name:t.projectName||"",author:t.author||"",date:t.date||"",process:t.process||"",item_name:t.itemName||"",material_cost:t.materialCost||0,labor_cost:t.laborCost||0,vat_amount:t.vatAmount||0,total_amount:t.totalAmount||0,notes:t.notes||"",images:t.images||[],payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction?1:0,includes_vat:t.includesVAT?1:0,created_at:t.createdAt||"",updated_at:t.updatedAt||""}}function Cf(t){const e={};return t.project_id!==void 0&&(e.projectId=t.project_id),t.projectId!==void 0&&(e.projectId=t.projectId),t.project_name!==void 0&&(e.projectName=t.project_name),t.projectName!==void 0&&(e.projectName=t.projectName),t.author!==void 0&&(e.author=t.author),t.date!==void 0&&(e.date=t.date),t.process!==void 0&&(e.process=t.process),t.item_name!==void 0&&(e.itemName=t.item_name),t.itemName!==void 0&&(e.itemName=t.itemName),t.material_cost!==void 0&&(e.materialCost=t.material_cost),t.materialCost!==void 0&&(e.materialCost=t.materialCost),t.labor_cost!==void 0&&(e.laborCost=t.labor_cost),t.laborCost!==void 0&&(e.laborCost=t.laborCost),t.vat_amount!==void 0&&(e.vatAmount=t.vat_amount),t.vatAmount!==void 0&&(e.vatAmount=t.vatAmount),t.total_amount!==void 0&&(e.totalAmount=t.total_amount),t.totalAmount!==void 0&&(e.totalAmount=t.totalAmount),t.notes!==void 0&&(e.notes=t.notes),t.images!==void 0&&(e.images=t.images),t.payment_id!==void 0&&(e.paymentId=t.payment_id),t.paymentId!==void 0&&(e.paymentId=t.paymentId),t.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=t.includes_tax_deduction===!0||t.includes_tax_deduction===1),t.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=t.includesTaxDeduction),t.includes_vat!==void 0&&(e.includesVAT=t.includes_vat===!0||t.includes_vat===1),t.includesVAT!==void 0&&(e.includesVAT=t.includesVAT),e}const Ks={getAllRecords:async()=>{const t=qe(ne,Bt.EXECUTION_RECORDS),e=xt(t,on("id","desc"));return(await Vt(e)).docs.map(s=>{const r=s.data();return Ci({...r,id:parseInt(s.id)||r.id})})},getRecordById:async t=>{const e=we(ne,Bt.EXECUTION_RECORDS,t),n=await Pt(e);if(n.exists()){const s=n.data();return Ci({...s,id:parseInt(n.id)||s.id})}return null},createRecord:async t=>{await qA();const e=qe(ne,Bt.EXECUTION_RECORDS),n=await Vt(e);let s=0;n.docs.forEach(f=>{const h=parseInt(f.id);!isNaN(h)&&h>s&&(s=h)});const r=s+1,i=Cf(t),a=new Date().toISOString();let c=i.projectId||0;const m=i.projectName||"";if((!c||c===0)&&m){const f=Ja.get(m);f?(c=f,console.log("[executionRecordFirestoreService]  ID :",m,"->",c)):console.warn("[executionRecordFirestoreService]   ID   :",m)}const u={id:r,projectId:c,projectName:m,author:i.author||"",date:i.date||a.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:a,updatedAt:a,images:[],imageCount:0},d=we(ne,Bt.EXECUTION_RECORDS,String(r));if(await ri(d,u),i.images&&i.images.length>0)if(i.images.some(h=>Qi(h))){const h=await bl("execution_records",String(r),i.images);await Ut(d,{images:h,imageCount:h.length}),u.images=h,u.imageCount=h.length}else await Ut(d,{images:i.images,imageCount:i.images.length}),u.images=i.images,u.imageCount=i.images.length;return Ci(u)},updateRecord:async(t,e)=>{const n=we(ne,Bt.EXECUTION_RECORDS,t),s=Cf(e);s.images!==void 0&&(s.images.some(a=>Qi(a))&&(s.images=await bl("execution_records",t,s.images)),s.imageCount=s.images.length),await Ut(n,{...s,updatedAt:new Date().toISOString()});const r=await Ks.getRecordById(t);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async t=>{const e=we(ne,Bt.EXECUTION_RECORDS,t),n=await Pt(e);if(n.exists()){const s=n.data();s.images&&s.images.length>0&&await Zg(s.images)}await Un(e)},subscribeToRecords:t=>{const e=qe(ne,Bt.EXECUTION_RECORDS),n=xt(e,on("id","desc"));return us(n,s=>{const r=s.docs.map(i=>{const a=i.data();return Ci({...a,id:parseInt(i.id)||a.id})});t(r)})},getRecordsByProject:async t=>{const e=qe(ne,Bt.EXECUTION_RECORDS),n=xt(e,Tn("projectId","==",t),on("id","desc"));return(await Vt(n)).docs.map(r=>{const i=r.data();return Ci({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async t=>{const e=qe(ne,Bt.EXECUTION_RECORDS),n=xt(e,Tn("paymentId","==",t)),s=await Vt(n);if(s.empty)return null;const r=s.docs[0],i=r.data();return Ci({...i,id:parseInt(r.id)||i.id})}},ja={getAllRecords:()=>Ks.getAllRecords(),getRecordById:async t=>{const e=await Ks.getRecordById(t);if(!e)throw new Error("Execution record not found");return e},createRecord:t=>Ks.createRecord(t),updateRecord:(t,e)=>Ks.updateRecord(t,e),deleteRecord:t=>Ks.deleteRecord(t),subscribeToRecords:Ks.subscribeToRecords,getRecordsByProject:Ks.getRecordsByProject,getRecordByPaymentId:Ks.getRecordByPaymentId},Gs=ym()(Yg((t,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:n=>t({projects:n}),addProject:n=>t(s=>{const r={id:n.id,project:n.name,client:n.client,totalAmount:n.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[n,...s.projects],constructionPayments:[r,...s.constructionPayments]}}),updateProject:(n,s)=>t(r=>({projects:r.projects.map(i=>i.id===n?{...i,...s}:i)})),deleteProject:n=>t(s=>({projects:s.projects.filter(r=>r.id!==n),constructionPayments:s.constructionPayments.filter(r=>r.id!==n)})),setSchedules:n=>t({schedules:n}),addSchedule:n=>t(s=>({schedules:[n,...s.schedules]})),updateSchedule:(n,s)=>t(r=>({schedules:r.schedules.map(i=>i.id===n?{...i,...s}:i)})),deleteSchedule:n=>t(s=>({schedules:s.schedules.filter(r=>r.id!==n)})),setPayments:n=>t({payments:n}),addPayment:n=>t(s=>({payments:[n,...s.payments]})),updatePayment:(n,s)=>t(r=>({payments:r.payments.map(i=>i.id===n?{...i,...s}:i)})),deletePayment:n=>t(s=>({payments:s.payments.filter(r=>r.id!==n)})),setContractors:n=>t({contractors:n}),addContractor:n=>t(s=>({contractors:[n,...s.contractors]})),updateContractor:(n,s)=>t(r=>({contractors:r.contractors.map(i=>i.id===n?{...i,...s}:i)})),deleteContractor:n=>t(s=>({contractors:s.contractors.filter(r=>r.id!==n)})),setConstructionPayments:n=>t({constructionPayments:n}),addConstructionPayment:n=>t(s=>({constructionPayments:[n,...s.constructionPayments]})),updateConstructionPayment:(n,s)=>t(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===n?{...i,...s}:i)})),deleteConstructionPayment:n=>t(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==n)})),setASRequests:n=>t({asRequests:n}),addASRequest:n=>t(s=>({asRequests:[n,...s.asRequests]})),updateASRequest:(n,s)=>t(r=>({asRequests:r.asRequests.map(i=>i.id===n?{...i,...s}:i)})),deleteASRequest:n=>t(s=>({asRequests:s.asRequests.filter(r=>r.id!==n)})),setExecutionRecords:n=>t({executionRecords:n}),addExecutionRecord:n=>{console.log("[dataStore]  :",n.id,n.itemName),t(s=>{const r=[n,...s.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(n,s)=>t(r=>({executionRecords:r.executionRecords.map(i=>i.id===n?{...i,...s}:i)})),deleteExecutionRecord:n=>t(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==n)})),loadPaymentsFromAPI:async()=>{try{const n=await hs.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",n[0]);const s=n.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.request_date||d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));s.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const a=new Set(s.map(d=>d.id)),c=3e4,m=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",s.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const u=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(a.has(d.id))return!1;const f=d._addedAt;return f&&m-f<c?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(m-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",u.length),console.log("[loadPaymentsFromAPI]   ID:",u.map(d=>d.id)),u.length>0){console.log(`[loadPaymentsFromAPI]  ${u.length}  `);const d=new Set(u.map(w=>w.id)),f=s.filter(w=>!d.has(w.id)),y=[...u.map(w=>({...w,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),t({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),t({payments:s})}catch(n){throw console.error("Failed to load payments from API:",n),n}},addPaymentToAPI:async n=>{const s=`temp_${Date.now()}`,r={...n,id:s,_addedAt:Date.now(),_tempId:s};t(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",s);try{const a=e().projects.find(f=>f.name===n.project),m={projectId:a?a.id:n.project,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,status:n.status||"pending",category:n.category,urgency:n.urgency,requestedBy:n.requestedBy,bankInfo:n.bankInfo,notes:n.notes,attachments:[],materialAmount:n.materialAmount||0,laborAmount:n.laborAmount||0,originalMaterialAmount:n.originalMaterialAmount||0,originalLaborAmount:n.originalLaborAmount||0,applyTaxDeduction:n.applyTaxDeduction||!1,includesVAT:n.includesVAT||!1,quickText:n.quickText||"",images:n.images||[]};console.log("[addPaymentToAPI] Sending payment data:",m);const u=await hs.createPayment(m),d=String(u.id);return t(f=>({payments:f.payments.map(h=>h._tempId===s?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),t(a=>({payments:a.payments.filter(c=>c._tempId!==s)})),i}},updatePaymentInAPI:async(n,s)=>{try{if(s.status&&Object.keys(s).length===1)await hs.updatePaymentStatus(n,s.status);else{let r=s.project;if(s.project){const a=e().projects.find(c=>c.name===s.project);r=a?a.id:s.project}await hs.updatePayment(n,{projectId:r,purpose:s.purpose,process:s.process,itemName:s.itemName,amount:s.amount,materialAmount:s.materialAmount,laborAmount:s.laborAmount,originalMaterialAmount:s.originalMaterialAmount,originalLaborAmount:s.originalLaborAmount,category:s.category,urgency:s.urgency,bankInfo:s.bankInfo,notes:s.notes,requestDate:s.requestDate,includesVAT:s.includesVAT,applyTaxDeduction:s.applyTaxDeduction})}t(r=>({payments:r.payments.map(i=>i.id===n?{...i,...s}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async n=>{try{await hs.deletePayment(n),t(s=>({payments:s.payments.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete payment from API:",s),s}},loadSchedulesFromAPI:async()=>{try{const n=await La.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",n[0]);const s=n.map(r=>{var a;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(c=>c.trim()):[r.assigneeNames]:((a=r.assignedTo)==null?void 0:a.map(c=>typeof c=="object"?c.name:c))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});s.sort((r,i)=>{const a=parseInt(r.id)||0,c=parseInt(i.id)||0;return a-c}),t({schedules:s})}catch(n){throw console.error("Failed to load schedules from API:",n),n}},addScheduleToAPI:async n=>{var i,a;const s=(i=n.id)!=null&&i.startsWith("temp_")?n.id:`temp_${Date.now()}`,r={...n,id:s};t(c=>({schedules:[...c.schedules,r]}));try{const c=await La.createSchedule({project:n.project||"",title:n.title,type:n.type,startDate:n.start,endDate:n.end,allDay:!n.time||n.time==="-",location:n.location,assignedTo:n.attendees||[],description:n.description,asRequestId:n.asRequestId,time:n.time}),m=n.attendees||[];let u=c.assigneeNames||((a=c.assignedTo)==null?void 0:a.map(f=>typeof f=="object"?f.name:f))||[];m.length>0&&u.length>m.length&&(u=m);const d={id:c._id,title:c.title,start:new Date(c.startDate),end:new Date(c.endDate),type:c.type,project:typeof c.project=="object"?c.project.name:c.project,location:c.location,attendees:u,description:c.description,time:c.time};t(f=>({schedules:f.schedules.map(h=>h.id===s?d:h)}))}catch(c){throw console.error("Failed to add schedule to API:",c),t(m=>({schedules:m.schedules.filter(u=>u.id!==s)})),c}},updateScheduleInAPI:async(n,s)=>{var r,i,a;try{console.log(" updateScheduleInAPI called with:",{id:n,updatedSchedule:s});const c={};s.project!==void 0&&(c.project=s.project),s.title!==void 0&&(c.title=s.title),s.type!==void 0&&(c.type=s.type),s.start!==void 0&&(c.startDate=s.start),s.end!==void 0&&(c.endDate=s.end),s.location!==void 0&&(c.location=s.location),s.description!==void 0&&(c.description=s.description),s.attendees!==void 0&&(c.assignedTo=s.attendees),s.time!==void 0&&(c.time=s.time),console.log(" Sending update data:",c);const m=await La.updateSchedule(n,c);console.log(" updateScheduleInAPI response:",m);const u={id:m._id,title:m.title,start:new Date(m.startDate),end:new Date(m.endDate),type:m.type,project:typeof m.project=="object"?m.project.name:m.project,location:m.location,attendees:m.assigneeNames||((r=m.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:m.description,time:m.time};t(d=>({schedules:d.schedules.map(f=>f.id===n?u:f)}))}catch(c){throw console.error("Failed to update schedule in API:",c),console.error("Error details:",{message:c instanceof Error?c.message:"Unknown error",response:c&&typeof c=="object"&&"response"in c?(i=c.response)==null?void 0:i.data:void 0,status:c&&typeof c=="object"&&"response"in c?(a=c.response)==null?void 0:a.status:void 0}),c}},deleteScheduleFromAPI:async n=>{var i;const{schedules:s}=e(),r=s.find(a=>a.id===n);if(r){t(a=>({schedules:a.schedules.filter(c=>c.id!==n)}));try{n.startsWith("temp_")||await La.deleteSchedule(n)}catch(a){const c=a,m=(i=c==null?void 0:c.response)==null?void 0:i.status;if(m===404||m===502||m===503||m===504){console.log("Schedule delete - ignoring error (status:",m,"):",n);return}throw console.error("Failed to delete schedule from API:",a),r&&t(u=>({schedules:[...u.schedules,r]})),a}}},loadProjectsFromAPI:async()=>{try{const s=(await Ui.getAllProjects()).map(r=>{var i,a;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((a=r.customerRequests)==null?void 0:a.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});t({projects:s})}catch(n){throw console.error("Failed to load projects from API:",n),n}},addProjectToAPI:async n=>{var s,r;try{const i=await Ui.createProject({name:n.name,client:n.client,location:n.location,startDate:n.startDate,endDate:n.endDate,status:n.status,contractAmount:n.contractAmount,spent:n.spent,manager:n.manager,team:n.team,progress:n.progress,description:n.description}),a={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((s=i.meetingNotes)==null?void 0:s.map(c=>({id:c.id,content:c.content,date:new Date(c.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(c=>({id:c.id,content:c.content,completed:c.completed,createdAt:new Date(c.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};t(c=>({projects:[a,...c.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(n,s)=>{var r,i;try{const a=await Ui.updateProject(n,s),c={id:a._id||a.id,name:a.name,client:typeof a.client=="object"?a.client.name:a.client||"",location:typeof a.location=="object"?a.location.address:a.location||a.address||"",status:a.status==="inProgress"?"in-progress":a.status==="onHold"?"on-hold":a.status,progress:a.progress||0,startDate:a.startDate||a.start_date?new Date(a.startDate||a.start_date):void 0,endDate:a.endDate||a.end_date?new Date(a.endDate||a.end_date):void 0,contractAmount:a.budget||a.contractAmount||0,spent:a.actualCost||a.spent||0,manager:typeof a.manager=="object"&&a.manager!==null?a.manager.name||"":a.manager||"",team:[],description:a.description||"",meetingNotes:((r=a.meetingNotes)==null?void 0:r.map(m=>({id:m.id,content:m.content,date:new Date(m.date)})))||[],customerRequests:((i=a.customerRequests)==null?void 0:i.map(m=>({id:m.id,content:m.content,completed:m.completed,createdAt:new Date(m.createdAt)})))||[],entrancePassword:a.entrancePassword||"",sitePassword:a.sitePassword||""};t(m=>({projects:m.projects.map(u=>u.id===n?c:u)}))}catch(a){throw console.error("Failed to update project in API:",a),a}},deleteProjectFromAPI:async n=>{try{await Ui.deleteProject(n),t(s=>({projects:s.projects.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete project from API:",s),s}},loadContractorsFromAPI:async()=>{try{const s=(await Qs.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));t({contractors:s})}catch(n){throw console.error("Failed to load contractors from API:",n),n}},addContractorToAPI:async n=>{try{const s=await Qs.createContractor({rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),r={id:s._id,rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)};t(i=>({contractors:[r,...i.contractors]}))}catch(s){throw console.error("Failed to add contractor to API:",s),s}},updateContractorInAPI:async(n,s)=>{try{const r=await Qs.updateContractor(n,{rank:s.rank,companyName:s.companyName,name:s.name,process:s.process,contact:s.contact,accountNumber:s.accountNumber,notes:s.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};t(a=>({contractors:a.contractors.map(c=>c.id===n?i:c)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async n=>{try{await Qs.deleteContractor(n),t(s=>({contractors:s.contractors.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete contractor from API:",s),s}},loadConstructionPaymentsFromAPI:async()=>{try{const s=(await Ta.getAllConstructionPayments()).map(r=>{var a;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((a=r.payments)==null?void 0:a.map(c=>{var d;const m=c.date?new Date(c.date):new Date,u=isNaN(m.getTime())?new Date:m;return{type:c.type||((d=c.types)==null?void 0:d[0])||"",amount:c.amount,date:u,method:c.method,notes:c.notes}}))||[]}});t({constructionPayments:s})}catch(n){throw console.error("Failed to load construction payments from API:",n),n}},addConstructionPaymentToAPI:async n=>{var s;try{const r=await Ta.createConstructionPayment(n),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((s=r.payments)==null?void 0:s.map(a=>{var u;const c=a.date?new Date(a.date):new Date,m=isNaN(c.getTime())?new Date:c;return{type:a.type||((u=a.types)==null?void 0:u[0])||"",amount:a.amount,date:m,method:a.method,notes:a.notes}}))||[]};t(a=>({constructionPayments:[i,...a.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(n,s)=>{var r;try{const i=await Ta.updateConstructionPayment(n,s);let a;i.expectedPaymentDates&&(a={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const c={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:a,payments:((r=i.payments)==null?void 0:r.map(m=>{var u;return{type:m.type||((u=m.types)==null?void 0:u[0])||"",amount:m.amount,date:new Date(m.date),method:m.method,notes:m.notes}}))||[]};t(m=>({constructionPayments:m.constructionPayments.map(u=>u.id===n?c:u)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async n=>{try{await Ta.deleteConstructionPayment(n),t(s=>({constructionPayments:s.constructionPayments.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete construction payment from API:",s),s}},loadASRequestsFromAPI:async()=>{try{const s=(await Io.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));t({asRequests:s})}catch(n){throw console.error("Failed to load AS requests from API:",n),n}},addASRequestToAPI:async n=>{try{const s=await Io.createASRequest(n),r={id:s._id,project:s.project,client:s.client,requestDate:new Date(s.requestDate),siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,scheduledVisitDate:s.scheduledVisitDate?new Date(s.scheduledVisitDate):void 0,scheduledVisitTime:s.scheduledVisitTime,assignedTo:Array.isArray(s.assignedTo)?s.assignedTo:[],completionDate:s.completionDate?new Date(s.completionDate):void 0,notes:s.notes};return t(i=>({asRequests:[r,...i.asRequests]})),r}catch(s){throw console.error("Failed to add AS request to API:",s),s}},updateASRequestInAPI:async(n,s)=>{try{const r=await Io.updateASRequest(n,s),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};t(a=>({asRequests:a.asRequests.map(c=>c.id===n?i:c)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async n=>{try{await Io.deleteASRequest(n),t(s=>({asRequests:s.asRequests.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete AS request from API:",s),s}},loadExecutionRecordsFromAPI:async()=>{try{const n=await ja.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",n.length,"records");const s=n.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));t({executionRecords:s})}catch(n){throw console.error("Failed to load execution records from API:",n),n}},addExecutionRecordToAPI:async n=>{try{console.log("[addExecutionRecordToAPI] Adding:",n.itemName,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat);const s=await ja.createRecord({project_name:n.project,author:n.author,date:n.date.toISOString().split("T")[0],process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),r={id:String(s.id),project:s.project_name,author:s.author||void 0,date:new Date(s.date),process:s.process||void 0,itemName:s.item_name,materialCost:s.material_cost||0,laborCost:s.labor_cost||0,vatAmount:s.vat_amount||0,totalAmount:s.total_amount||0,notes:s.notes||void 0,paymentId:s.payment_id?String(s.payment_id):void 0,includesTaxDeduction:s.includes_tax_deduction===1,includesVat:s.includes_vat===1,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",s.includes_vat),t(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(s){throw console.error("Failed to add execution record to API:",s),s}},updateExecutionRecordInAPI:async(n,s)=>{console.log("[updateExecutionRecordInAPI] Called with id:",n,"record:",s);try{let r;if(s.date){const i=s.date instanceof Date?s.date:new Date(s.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:s.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",s.includesTaxDeduction,"includesVat:",s.includesVat),await ja.updateRecord(n,{project_name:s.project,author:s.author,date:r,process:s.process,item_name:s.itemName,material_cost:s.materialCost,labor_cost:s.laborCost,vat_amount:s.vatAmount,total_amount:s.totalAmount,notes:s.notes,payment_id:s.paymentId,images:s.images,includes_tax_deduction:s.includesTaxDeduction,includes_vat:s.includesVat}),t(i=>({executionRecords:i.executionRecords.map(a=>a.id===n?{...a,...s,updatedAt:new Date}:a)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async n=>{try{await ja.deleteRecord(n),t(s=>({executionRecords:s.executionRecords.filter(r=>r.id!==n)}))}catch(s){throw console.error("Failed to delete execution record from API:",s),s}}}),{name:"interior-management-storage",partialize:t=>({...t,payments:t.payments.map(e=>{const{images:n,...s}=e;return s}),executionRecords:t.executionRecords.map(e=>{const{images:n,...s}=e;return s})}),storage:{getItem:t=>{var m,u,d,f,h,y,w;const e=localStorage.getItem(t);if(!e)return null;const{state:n}=JSON.parse(e),s=((m=n.projects)==null?void 0:m.map(_=>({..._,startDate:_.startDate?new Date(_.startDate):void 0,endDate:_.endDate?new Date(_.endDate):void 0,contractAmount:_.contractAmount!==void 0?_.contractAmount:_.budget||0})))||[],r=((u=n.constructionPayments)==null?void 0:u.map(_=>{var S;return{..._,vatType:_.vatType||"percentage",vatPercentage:_.vatPercentage??100,vatAmount:_.vatAmount??0,payments:((S=_.payments)==null?void 0:S.map(R=>({...R,date:new Date(R.date)})))||[]}}))||[],i=new Set(r.map(_=>_.id)),a=s.filter(_=>!i.has(_.id)).map(_=>({id:_.id,project:_.name,client:_.client,totalAmount:_.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),c=[...r,...a];return{state:{...n,projects:s,schedules:((d=n.schedules)==null?void 0:d.map(_=>({..._,start:new Date(_.start),end:new Date(_.end)})))||[],payments:((f=n.payments)==null?void 0:f.map(_=>({..._,requestDate:new Date(_.requestDate),approvalDate:_.approvalDate?new Date(_.approvalDate):void 0})))||[],contractors:((h=n.contractors)==null?void 0:h.map(_=>({..._,createdAt:new Date(_.createdAt),updatedAt:new Date(_.updatedAt)})))||[],constructionPayments:c,asRequests:((y=n.asRequests)==null?void 0:y.map(_=>({..._,requestDate:new Date(_.requestDate),scheduledVisitDate:_.scheduledVisitDate?new Date(_.scheduledVisitDate):void 0,completionDate:_.completionDate?new Date(_.completionDate):void 0})))||[],executionRecords:((w=n.executionRecords)==null?void 0:w.map(_=>({..._,date:new Date(_.date),createdAt:new Date(_.createdAt),updatedAt:new Date(_.updatedAt)})))||[]}}},setItem:(t,e)=>{try{const n=JSON.stringify(e);localStorage.setItem(t,n)}catch(n){console.error("[dataStore] localStorage  :",n),n instanceof DOMException&&n.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:t=>localStorage.removeItem(t)}}));var pa=t=>t.type==="checkbox",Xr=t=>t instanceof Date,Jn=t=>t==null;const ey=t=>typeof t=="object";var Dn=t=>!Jn(t)&&!Array.isArray(t)&&ey(t)&&!Xr(t),$A=t=>Dn(t)&&t.target?pa(t.target)?t.target.checked:t.target.value:t,WA=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,zA=(t,e)=>t.has(WA(e)),KA=t=>{const e=t.constructor&&t.constructor.prototype;return Dn(e)&&e.hasOwnProperty("isPrototypeOf")},Nu=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Pn(t){let e;const n=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(Nu&&(t instanceof Blob||s))&&(n||Dn(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!KA(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=Pn(t[r]));else return t;return e}var zl=t=>/^\w*$/.test(t),bn=t=>t===void 0,xu=t=>Array.isArray(t)?t.filter(Boolean):[],vu=t=>xu(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Te=(t,e,n)=>{if(!e||!Dn(t))return n;const s=(zl(e)?[e]:vu(e)).reduce((r,i)=>Jn(r)?r:r[i],t);return bn(s)||s===t?bn(t[e])?n:t[e]:s},Ts=t=>typeof t=="boolean",Zt=(t,e,n)=>{let s=-1;const r=zl(e)?[e]:vu(e),i=r.length,a=i-1;for(;++s<i;){const c=r[s];let m=n;if(s!==a){const u=t[c];m=Dn(u)||Array.isArray(u)?u:isNaN(+r[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=m,t=t[c]}};const wf={BLUR:"blur",FOCUS_OUT:"focusout"},_s={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ws={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},QA=it.createContext(null);QA.displayName="HookFormContext";var YA=(t,e,n,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(r,i,{get:()=>{const a=i;return e._proxyFormState[a]!==_s.all&&(e._proxyFormState[a]=!s||_s.all),t[a]}});return r};const GA=typeof window<"u"?it.useLayoutEffect:it.useEffect;var as=t=>typeof t=="string",XA=(t,e,n,s,r)=>as(t)?(s&&e.watch.add(t),Te(n,t,r)):Array.isArray(t)?t.map(i=>(s&&e.watch.add(i),Te(n,i))):(s&&(e.watchAll=!0),n),mm=t=>Jn(t)||!ey(t);function br(t,e,n=new WeakSet){if(mm(t)||mm(e))return t===e;if(Xr(t)&&Xr(e))return t.getTime()===e.getTime();const s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of s){const a=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const c=e[i];if(Xr(a)&&Xr(c)||Dn(a)&&Dn(c)||Array.isArray(a)&&Array.isArray(c)?!br(a,c,n):a!==c)return!1}}return!0}var JA=(t,e,n,s,r)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[s]:r||!0}}:{},Uo=t=>Array.isArray(t)?t:[t],Sf=()=>{let t=[];return{get observers(){return t},next:r=>{for(const i of t)i.next&&i.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(i=>i!==r)}}),unsubscribe:()=>{t=[]}}};function ty(t,e){const n={};for(const s in t)if(t.hasOwnProperty(s)){const r=t[s],i=e[s];if(r&&Dn(r)&&i){const a=ty(r,i);Dn(a)&&(n[s]=a)}else t[s]&&(n[s]=i)}return n}var ns=t=>Dn(t)&&!Object.keys(t).length,_u=t=>t.type==="file",Ds=t=>typeof t=="function",Nl=t=>{if(!Nu)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ny=t=>t.type==="select-multiple",Du=t=>t.type==="radio",ZA=t=>Du(t)||pa(t),Cc=t=>Nl(t)&&t.isConnected;function eE(t,e){const n=e.slice(0,-1).length;let s=0;for(;s<n;)t=bn(t)?s++:t[e[s++]];return t}function tE(t){for(const e in t)if(t.hasOwnProperty(e)&&!bn(t[e]))return!1;return!0}function gn(t,e){const n=Array.isArray(e)?e:zl(e)?[e]:vu(e),s=n.length===1?t:eE(t,n),r=n.length-1,i=n[r];return s&&delete s[i],r!==0&&(Dn(s)&&ns(s)||Array.isArray(s)&&tE(s))&&gn(t,n.slice(0,-1)),t}var nE=t=>{for(const e in t)if(Ds(t[e]))return!0;return!1};function sy(t){return Array.isArray(t)||Dn(t)&&!nE(t)}function um(t,e={}){for(const n in t)sy(t[n])?(e[n]=Array.isArray(t[n])?[]:{},um(t[n],e[n])):Jn(t[n])||(e[n]=!0);return e}function Bi(t,e,n){n||(n=um(e));for(const s in t)sy(t[s])?bn(e)||mm(n[s])?n[s]=um(t[s],Array.isArray(t[s])?[]:{}):Bi(t[s],Jn(e)?{}:e[s],n[s]):n[s]=!br(t[s],e[s]);return n}const If={value:!1,isValid:!1},Pf={value:!0,isValid:!0};var ry=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!bn(t[0].attributes.value)?bn(t[0].value)||t[0].value===""?Pf:{value:t[0].value,isValid:!0}:Pf:If}return If},iy=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:s})=>bn(t)?t:e?t===""?NaN:t&&+t:n&&as(t)?new Date(t):s?s(t):t;const Lf={isValid:!1,value:null};var oy=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,Lf):Lf;function Tf(t){const e=t.ref;return _u(e)?e.files:Du(e)?oy(t.refs).value:ny(e)?[...e.selectedOptions].map(({value:n})=>n):pa(e)?ry(t.refs).value:iy(bn(e.value)?t.ref.value:e.value,t)}var sE=(t,e,n,s)=>{const r={};for(const i of t){const a=Te(e,i);a&&Zt(r,i,a._f)}return{criteriaMode:n,names:[...t],fields:r,shouldUseNativeValidation:s}},xl=t=>t instanceof RegExp,_o=t=>bn(t)?t:xl(t)?t.source:Dn(t)?xl(t.value)?t.value.source:t.value:t,jf=t=>({isOnSubmit:!t||t===_s.onSubmit,isOnBlur:t===_s.onBlur,isOnChange:t===_s.onChange,isOnAll:t===_s.all,isOnTouch:t===_s.onTouched});const Rf="AsyncFunction";var rE=t=>!!t&&!!t.validate&&!!(Ds(t.validate)&&t.validate.constructor.name===Rf||Dn(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Rf)),iE=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Bf=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const Ho=(t,e,n,s)=>{for(const r of n||Object.keys(t)){const i=Te(t,r);if(i){const{_f:a,...c}=i;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],r)&&!s)return!0;if(a.ref&&e(a.ref,a.name)&&!s)return!0;if(Ho(c,e))break}else if(Dn(c)&&Ho(c,e))break}}};function Uf(t,e,n){const s=Te(t,n);if(s||zl(n))return{error:s,name:n};const r=n.split(".");for(;r.length;){const i=r.join("."),a=Te(e,i),c=Te(t,i);if(a&&!Array.isArray(a)&&n!==i)return{name:n};if(c&&c.type)return{name:i,error:c};if(c&&c.root&&c.root.type)return{name:`${i}.root`,error:c.root};r.pop()}return{name:n}}var oE=(t,e,n,s)=>{n(t);const{name:r,...i}=t;return ns(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(a=>e[a]===(!s||_s.all))},aE=(t,e,n)=>!t||!e||t===e||Uo(t).some(s=>s&&(n?s===e:s.startsWith(e)||e.startsWith(s))),lE=(t,e,n,s,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(e||t):(n?s.isOnBlur:r.isOnBlur)?!t:(n?s.isOnChange:r.isOnChange)?t:!0,cE=(t,e)=>!xu(Te(t,e)).length&&gn(t,e),mE=(t,e,n)=>{const s=Uo(Te(t,n));return Zt(s,"root",e[n]),Zt(t,n,s),t};function Hf(t,e,n="validate"){if(as(t)||Array.isArray(t)&&t.every(as)||Ts(t)&&!t)return{type:n,message:as(t)?t:"",ref:e}}var wi=t=>Dn(t)&&!xl(t)?t:{value:t,message:""},Mf=async(t,e,n,s,r,i)=>{const{ref:a,refs:c,required:m,maxLength:u,minLength:d,min:f,max:h,pattern:y,validate:w,name:_,valueAsNumber:S,mount:R}=t._f,L=Te(n,_);if(!R||e.has(_))return{};const $=c?c[0]:a,ie=I=>{r&&$.reportValidity&&($.setCustomValidity(Ts(I)?"":I||""),$.reportValidity())},ee={},F=Du(a),C=pa(a),N=F||C,V=(S||_u(a))&&bn(a.value)&&bn(L)||Nl(a)&&a.value===""||L===""||Array.isArray(L)&&!L.length,j=JA.bind(null,_,s,ee),P=(I,k,ke,Be=Ws.maxLength,pe=Ws.minLength)=>{const je=I?k:ke;ee[_]={type:I?Be:pe,message:je,ref:a,...j(I?Be:pe,je)}};if(i?!Array.isArray(L)||!L.length:m&&(!N&&(V||Jn(L))||Ts(L)&&!L||C&&!ry(c).isValid||F&&!oy(c).isValid)){const{value:I,message:k}=as(m)?{value:!!m,message:m}:wi(m);if(I&&(ee[_]={type:Ws.required,message:k,ref:$,...j(Ws.required,k)},!s))return ie(k),ee}if(!V&&(!Jn(f)||!Jn(h))){let I,k;const ke=wi(h),Be=wi(f);if(!Jn(L)&&!isNaN(L)){const pe=a.valueAsNumber||L&&+L;Jn(ke.value)||(I=pe>ke.value),Jn(Be.value)||(k=pe<Be.value)}else{const pe=a.valueAsDate||new Date(L),je=Mt=>new Date(new Date().toDateString()+" "+Mt),ut=a.type=="time",qt=a.type=="week";as(ke.value)&&L&&(I=ut?je(L)>je(ke.value):qt?L>ke.value:pe>new Date(ke.value)),as(Be.value)&&L&&(k=ut?je(L)<je(Be.value):qt?L<Be.value:pe<new Date(Be.value))}if((I||k)&&(P(!!I,ke.message,Be.message,Ws.max,Ws.min),!s))return ie(ee[_].message),ee}if((u||d)&&!V&&(as(L)||i&&Array.isArray(L))){const I=wi(u),k=wi(d),ke=!Jn(I.value)&&L.length>+I.value,Be=!Jn(k.value)&&L.length<+k.value;if((ke||Be)&&(P(ke,I.message,k.message),!s))return ie(ee[_].message),ee}if(y&&!V&&as(L)){const{value:I,message:k}=wi(y);if(xl(I)&&!L.match(I)&&(ee[_]={type:Ws.pattern,message:k,ref:a,...j(Ws.pattern,k)},!s))return ie(k),ee}if(w){if(Ds(w)){const I=await w(L,n),k=Hf(I,$);if(k&&(ee[_]={...k,...j(Ws.validate,k.message)},!s))return ie(k.message),ee}else if(Dn(w)){let I={};for(const k in w){if(!ns(I)&&!s)break;const ke=Hf(await w[k](L,n),$,k);ke&&(I={...ke,...j(k,ke.message)},ie(ke.message),s&&(ee[_]=I))}if(!ns(I)&&(ee[_]={ref:$,...I},!s))return ee}}return ie(!0),ee};const uE={mode:_s.onSubmit,reValidateMode:_s.onChange,shouldFocusError:!0};function dE(t={}){let e={...uE,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ds(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=Dn(e.defaultValues)||Dn(e.values)?Pn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Pn(r),a={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},m,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:Sf(),state:Sf()},y=e.criteriaMode===_s.all,w=T=>O=>{clearTimeout(u),u=setTimeout(T,O)},_=async T=>{if(!e.disabled&&(d.isValid||f.isValid||T)){const O=e.resolver?ns((await C()).errors):await V(s,!0);O!==n.isValid&&h.state.next({isValid:O})}},S=(T,O)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((T||Array.from(c.mount)).forEach(Z=>{Z&&(O?Zt(n.validatingFields,Z,O):gn(n.validatingFields,Z))}),h.state.next({validatingFields:n.validatingFields,isValidating:!ns(n.validatingFields)}))},R=(T,O=[],Z,ye,me=!0,de=!0)=>{if(ye&&Z&&!e.disabled){if(a.action=!0,de&&Array.isArray(Te(s,T))){const Ve=Z(Te(s,T),ye.argA,ye.argB);me&&Zt(s,T,Ve)}if(de&&Array.isArray(Te(n.errors,T))){const Ve=Z(Te(n.errors,T),ye.argA,ye.argB);me&&Zt(n.errors,T,Ve),cE(n.errors,T)}if((d.touchedFields||f.touchedFields)&&de&&Array.isArray(Te(n.touchedFields,T))){const Ve=Z(Te(n.touchedFields,T),ye.argA,ye.argB);me&&Zt(n.touchedFields,T,Ve)}(d.dirtyFields||f.dirtyFields)&&(n.dirtyFields=Bi(r,i)),h.state.next({name:T,isDirty:P(T,O),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Zt(i,T,O)},L=(T,O)=>{Zt(n.errors,T,O),h.state.next({errors:n.errors})},$=T=>{n.errors=T,h.state.next({errors:n.errors,isValid:!1})},ie=(T,O,Z,ye)=>{const me=Te(s,T);if(me){const de=Te(i,T,bn(Z)?Te(r,T):Z);bn(de)||ye&&ye.defaultChecked||O?Zt(i,T,O?de:Tf(me._f)):ke(T,de),a.mount&&_()}},ee=(T,O,Z,ye,me)=>{let de=!1,Ve=!1;const Xe={name:T};if(!e.disabled){if(!Z||ye){(d.isDirty||f.isDirty)&&(Ve=n.isDirty,n.isDirty=Xe.isDirty=P(),de=Ve!==Xe.isDirty);const Ge=br(Te(r,T),O);Ve=!!Te(n.dirtyFields,T),Ge?gn(n.dirtyFields,T):Zt(n.dirtyFields,T,!0),Xe.dirtyFields=n.dirtyFields,de=de||(d.dirtyFields||f.dirtyFields)&&Ve!==!Ge}if(Z){const Ge=Te(n.touchedFields,T);Ge||(Zt(n.touchedFields,T,Z),Xe.touchedFields=n.touchedFields,de=de||(d.touchedFields||f.touchedFields)&&Ge!==Z)}de&&me&&h.state.next(Xe)}return de?Xe:{}},F=(T,O,Z,ye)=>{const me=Te(n.errors,T),de=(d.isValid||f.isValid)&&Ts(O)&&n.isValid!==O;if(e.delayError&&Z?(m=w(()=>L(T,Z)),m(e.delayError)):(clearTimeout(u),m=null,Z?Zt(n.errors,T,Z):gn(n.errors,T)),(Z?!br(me,Z):me)||!ns(ye)||de){const Ve={...ye,...de&&Ts(O)?{isValid:O}:{},errors:n.errors,name:T};n={...n,...Ve},h.state.next(Ve)}},C=async T=>{S(T,!0);const O=await e.resolver(i,e.context,sE(T||c.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return S(T),O},N=async T=>{const{errors:O}=await C(T);if(T)for(const Z of T){const ye=Te(O,Z);ye?Zt(n.errors,Z,ye):gn(n.errors,Z)}else n.errors=O;return O},V=async(T,O,Z={valid:!0})=>{for(const ye in T){const me=T[ye];if(me){const{_f:de,...Ve}=me;if(de){const Xe=c.array.has(de.name),Ge=me._f&&rE(me._f);Ge&&d.validatingFields&&S([de.name],!0);const ve=await Mf(me,c.disabled,i,y,e.shouldUseNativeValidation&&!O,Xe);if(Ge&&d.validatingFields&&S([de.name]),ve[de.name]&&(Z.valid=!1,O))break;!O&&(Te(ve,de.name)?Xe?mE(n.errors,ve,de.name):Zt(n.errors,de.name,ve[de.name]):gn(n.errors,de.name))}!ns(Ve)&&await V(Ve,O,Z)}}return Z.valid},j=()=>{for(const T of c.unMount){const O=Te(s,T);O&&(O._f.refs?O._f.refs.every(Z=>!Cc(Z)):!Cc(O._f.ref))&&st(T)}c.unMount=new Set},P=(T,O)=>!e.disabled&&(T&&O&&Zt(i,T,O),!br(Mt(),r)),I=(T,O,Z)=>XA(T,c,{...a.mount?i:bn(O)?r:as(T)?{[T]:O}:O},Z,O),k=T=>xu(Te(a.mount?i:r,T,e.shouldUnregister?Te(r,T,[]):[])),ke=(T,O,Z={})=>{const ye=Te(s,T);let me=O;if(ye){const de=ye._f;de&&(!de.disabled&&Zt(i,T,iy(O,de)),me=Nl(de.ref)&&Jn(O)?"":O,ny(de.ref)?[...de.ref.options].forEach(Ve=>Ve.selected=me.includes(Ve.value)):de.refs?pa(de.ref)?de.refs.forEach(Ve=>{(!Ve.defaultChecked||!Ve.disabled)&&(Array.isArray(me)?Ve.checked=!!me.find(Xe=>Xe===Ve.value):Ve.checked=me===Ve.value||!!me)}):de.refs.forEach(Ve=>Ve.checked=Ve.value===me):_u(de.ref)?de.ref.value="":(de.ref.value=me,de.ref.type||h.state.next({name:T,values:Pn(i)})))}(Z.shouldDirty||Z.shouldTouch)&&ee(T,me,Z.shouldTouch,Z.shouldDirty,!0),Z.shouldValidate&&qt(T)},Be=(T,O,Z)=>{for(const ye in O){if(!O.hasOwnProperty(ye))return;const me=O[ye],de=T+"."+ye,Ve=Te(s,de);(c.array.has(T)||Dn(me)||Ve&&!Ve._f)&&!Xr(me)?Be(de,me,Z):ke(de,me,Z)}},pe=(T,O,Z={})=>{const ye=Te(s,T),me=c.array.has(T),de=Pn(O);Zt(i,T,de),me?(h.array.next({name:T,values:Pn(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&Z.shouldDirty&&h.state.next({name:T,dirtyFields:Bi(r,i),isDirty:P(T,de)})):ye&&!ye._f&&!Jn(de)?Be(T,de,Z):ke(T,de,Z),Bf(T,c)&&h.state.next({...n,name:T}),h.state.next({name:a.mount?T:void 0,values:Pn(i)})},je=async T=>{a.mount=!0;const O=T.target;let Z=O.name,ye=!0;const me=Te(s,Z),de=Ge=>{ye=Number.isNaN(Ge)||Xr(Ge)&&isNaN(Ge.getTime())||br(Ge,Te(i,Z,Ge))},Ve=jf(e.mode),Xe=jf(e.reValidateMode);if(me){let Ge,ve;const jn=O.type?Tf(me._f):$A(T),jt=T.type===wf.BLUR||T.type===wf.FOCUS_OUT,ot=!iE(me._f)&&!e.resolver&&!Te(n.errors,Z)&&!me._f.deps||lE(jt,Te(n.touchedFields,Z),n.isSubmitted,Xe,Ve),re=Bf(Z,c,jt);Zt(i,Z,jn),jt?(!O||!O.readOnly)&&(me._f.onBlur&&me._f.onBlur(T),m&&m(0)):me._f.onChange&&me._f.onChange(T);const B=ee(Z,jn,jt),be=!ns(B)||re;if(!jt&&h.state.next({name:Z,type:T.type,values:Pn(i)}),ot)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?jt&&_():jt||_()),be&&h.state.next({name:Z,...re?{}:B});if(!jt&&re&&h.state.next({...n}),e.resolver){const{errors:Ae}=await C([Z]);if(de(jn),ye){const Re=Uf(n.errors,s,Z),ue=Uf(Ae,s,Re.name||Z);Ge=ue.error,Z=ue.name,ve=ns(Ae)}}else S([Z],!0),Ge=(await Mf(me,c.disabled,i,y,e.shouldUseNativeValidation))[Z],S([Z]),de(jn),ye&&(Ge?ve=!1:(d.isValid||f.isValid)&&(ve=await V(s,!0)));ye&&(me._f.deps&&(!Array.isArray(me._f.deps)||me._f.deps.length>0)&&qt(me._f.deps),F(Z,ve,Ge,B))}},ut=(T,O)=>{if(Te(n.errors,O)&&T.focus)return T.focus(),1},qt=async(T,O={})=>{let Z,ye;const me=Uo(T);if(e.resolver){const de=await N(bn(T)?T:me);Z=ns(de),ye=T?!me.some(Ve=>Te(de,Ve)):Z}else T?(ye=(await Promise.all(me.map(async de=>{const Ve=Te(s,de);return await V(Ve&&Ve._f?{[de]:Ve}:Ve)}))).every(Boolean),!(!ye&&!n.isValid)&&_()):ye=Z=await V(s);return h.state.next({...!as(T)||(d.isValid||f.isValid)&&Z!==n.isValid?{}:{name:T},...e.resolver||!T?{isValid:Z}:{},errors:n.errors}),O.shouldFocus&&!ye&&Ho(s,ut,T?me:c.mount),ye},Mt=(T,O)=>{let Z={...a.mount?i:r};return O&&(Z=ty(O.dirtyFields?n.dirtyFields:n.touchedFields,Z)),bn(T)?Z:as(T)?Te(Z,T):T.map(ye=>Te(Z,ye))},ae=(T,O)=>({invalid:!!Te((O||n).errors,T),isDirty:!!Te((O||n).dirtyFields,T),error:Te((O||n).errors,T),isValidating:!!Te(n.validatingFields,T),isTouched:!!Te((O||n).touchedFields,T)}),Ue=T=>{T&&Uo(T).forEach(O=>gn(n.errors,O)),h.state.next({errors:T?n.errors:{}})},fe=(T,O,Z)=>{const ye=(Te(s,T,{_f:{}})._f||{}).ref,me=Te(n.errors,T)||{},{ref:de,message:Ve,type:Xe,...Ge}=me;Zt(n.errors,T,{...Ge,...O,ref:ye}),h.state.next({name:T,errors:n.errors,isValid:!1}),Z&&Z.shouldFocus&&ye&&ye.focus&&ye.focus()},Le=(T,O)=>Ds(T)?h.state.subscribe({next:Z=>"values"in Z&&T(I(void 0,O),Z)}):I(T,O,!0),Ke=T=>h.state.subscribe({next:O=>{aE(T.name,O.name,T.exact)&&oE(O,T.formState||d,Tt,T.reRenderRoot)&&T.callback({values:{...i},...n,...O,defaultValues:r})}}).unsubscribe,bt=T=>(a.mount=!0,f={...f,...T.formState},Ke({...T,formState:f})),st=(T,O={})=>{for(const Z of T?Uo(T):c.mount)c.mount.delete(Z),c.array.delete(Z),O.keepValue||(gn(s,Z),gn(i,Z)),!O.keepError&&gn(n.errors,Z),!O.keepDirty&&gn(n.dirtyFields,Z),!O.keepTouched&&gn(n.touchedFields,Z),!O.keepIsValidating&&gn(n.validatingFields,Z),!e.shouldUnregister&&!O.keepDefaultValue&&gn(r,Z);h.state.next({values:Pn(i)}),h.state.next({...n,...O.keepDirty?{isDirty:P()}:{}}),!O.keepIsValid&&_()},Ct=({disabled:T,name:O})=>{(Ts(T)&&a.mount||T||c.disabled.has(O))&&(T?c.disabled.add(O):c.disabled.delete(O))},lt=(T,O={})=>{let Z=Te(s,T);const ye=Ts(O.disabled)||Ts(e.disabled);return Zt(s,T,{...Z||{},_f:{...Z&&Z._f?Z._f:{ref:{name:T}},name:T,mount:!0,...O}}),c.mount.add(T),Z?Ct({disabled:Ts(O.disabled)?O.disabled:e.disabled,name:T}):ie(T,!0,O.value),{...ye?{disabled:O.disabled||e.disabled}:{},...e.progressive?{required:!!O.required,min:_o(O.min),max:_o(O.max),minLength:_o(O.minLength),maxLength:_o(O.maxLength),pattern:_o(O.pattern)}:{},name:T,onChange:je,onBlur:je,ref:me=>{if(me){lt(T,O),Z=Te(s,T);const de=bn(me.value)&&me.querySelectorAll&&me.querySelectorAll("input,select,textarea")[0]||me,Ve=ZA(de),Xe=Z._f.refs||[];if(Ve?Xe.find(Ge=>Ge===de):de===Z._f.ref)return;Zt(s,T,{_f:{...Z._f,...Ve?{refs:[...Xe.filter(Cc),de,...Array.isArray(Te(r,T))?[{}]:[]],ref:{type:de.type,name:T}}:{ref:de}}}),ie(T,!1,void 0,de)}else Z=Te(s,T,{}),Z._f&&(Z._f.mount=!1),(e.shouldUnregister||O.shouldUnregister)&&!(zA(c.array,T)&&a.action)&&c.unMount.add(T)}}},ct=()=>e.shouldFocusError&&Ho(s,ut,c.mount),cn=T=>{Ts(T)&&(h.state.next({disabled:T}),Ho(s,(O,Z)=>{const ye=Te(s,Z);ye&&(O.disabled=ye._f.disabled||T,Array.isArray(ye._f.refs)&&ye._f.refs.forEach(me=>{me.disabled=ye._f.disabled||T}))},0,!1))},Q=(T,O)=>async Z=>{let ye;Z&&(Z.preventDefault&&Z.preventDefault(),Z.persist&&Z.persist());let me=Pn(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:de,values:Ve}=await C();n.errors=de,me=Pn(Ve)}else await V(s);if(c.disabled.size)for(const de of c.disabled)gn(me,de);if(gn(n.errors,"root"),ns(n.errors)){h.state.next({errors:{}});try{await T(me,Z)}catch(de){ye=de}}else O&&await O({...n.errors},Z),ct(),setTimeout(ct);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ns(n.errors)&&!ye,submitCount:n.submitCount+1,errors:n.errors}),ye)throw ye},Pe=(T,O={})=>{Te(s,T)&&(bn(O.defaultValue)?pe(T,Pn(Te(r,T))):(pe(T,O.defaultValue),Zt(r,T,Pn(O.defaultValue))),O.keepTouched||gn(n.touchedFields,T),O.keepDirty||(gn(n.dirtyFields,T),n.isDirty=O.defaultValue?P(T,Pn(Te(r,T))):P()),O.keepError||(gn(n.errors,T),d.isValid&&_()),h.state.next({...n}))},Oe=(T,O={})=>{const Z=T?Pn(T):r,ye=Pn(Z),me=ns(T),de=me?r:ye;if(O.keepDefaultValues||(r=Z),!O.keepValues){if(O.keepDirtyValues){const Ve=new Set([...c.mount,...Object.keys(Bi(r,i))]);for(const Xe of Array.from(Ve))Te(n.dirtyFields,Xe)?Zt(de,Xe,Te(i,Xe)):pe(Xe,Te(de,Xe))}else{if(Nu&&bn(T))for(const Ve of c.mount){const Xe=Te(s,Ve);if(Xe&&Xe._f){const Ge=Array.isArray(Xe._f.refs)?Xe._f.refs[0]:Xe._f.ref;if(Nl(Ge)){const ve=Ge.closest("form");if(ve){ve.reset();break}}}}if(O.keepFieldsRef)for(const Ve of c.mount)pe(Ve,Te(de,Ve));else s={}}i=e.shouldUnregister?O.keepDefaultValues?Pn(r):{}:Pn(de),h.array.next({values:{...de}}),h.state.next({values:{...de}})}c={mount:O.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!d.isValid||!!O.keepIsValid||!!O.keepDirtyValues,a.watch=!!e.shouldUnregister,h.state.next({submitCount:O.keepSubmitCount?n.submitCount:0,isDirty:me?!1:O.keepDirty?n.isDirty:!!(O.keepDefaultValues&&!br(T,r)),isSubmitted:O.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:me?{}:O.keepDirtyValues?O.keepDefaultValues&&i?Bi(r,i):n.dirtyFields:O.keepDefaultValues&&T?Bi(r,T):O.keepDirty?n.dirtyFields:{},touchedFields:O.keepTouched?n.touchedFields:{},errors:O.keepErrors?n.errors:{},isSubmitSuccessful:O.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Ie=(T,O)=>Oe(Ds(T)?T(i):T,O),He=(T,O={})=>{const Z=Te(s,T),ye=Z&&Z._f;if(ye){const me=ye.refs?ye.refs[0]:ye.ref;me.focus&&(me.focus(),O.shouldSelect&&Ds(me.select)&&me.select())}},Tt=T=>{n={...n,...T}},dt={control:{register:lt,unregister:st,getFieldState:ae,handleSubmit:Q,setError:fe,_subscribe:Ke,_runSchema:C,_focusError:ct,_getWatch:I,_getDirty:P,_setValid:_,_setFieldArray:R,_setDisabledField:Ct,_setErrors:$,_getFieldArray:k,_reset:Oe,_resetDefaultValues:()=>Ds(e.defaultValues)&&e.defaultValues().then(T=>{Ie(T,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:cn,_subjects:h,_proxyFormState:d,get _fields(){return s},get _formValues(){return i},get _state(){return a},set _state(T){a=T},get _defaultValues(){return r},get _names(){return c},set _names(T){c=T},get _formState(){return n},get _options(){return e},set _options(T){e={...e,...T}}},subscribe:bt,trigger:qt,register:lt,handleSubmit:Q,watch:Le,setValue:pe,getValues:Mt,reset:Ie,resetField:Pe,clearErrors:Ue,unregister:st,setError:fe,setFocus:He,getFieldState:ae};return{...dt,formControl:dt}}function ku(t={}){const e=it.useRef(void 0),n=it.useRef(void 0),[s,r]=it.useState({isDirty:!1,isValidating:!1,isLoading:Ds(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Ds(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:s},t.defaultValues&&!Ds(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:a,...c}=dE(t);e.current={...c,formState:s}}const i=e.current.control;return i._options=t,GA(()=>{const a=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(c=>({...c,isReady:!0})),i._formState.isReady=!0,a},[i]),it.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),it.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),it.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),it.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),it.useEffect(()=>{if(i._proxyFormState.isDirty){const a=i._getDirty();a!==s.isDirty&&i._subjects.state.next({isDirty:a})}},[i,s.isDirty]),it.useEffect(()=>{t.values&&!br(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),n.current=t.values,r(a=>({...a}))):i._resetDefaultValues()},[i,t.values]),it.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=YA(s,i),e.current}const Ff=["","","","","","",""],ay=({event:t,slotInfo:e,defaultProjectName:n,onClose:s,onSave:r,onDelete:i})=>{const[a,c]=A.useState(!1),{register:m,handleSubmit:u,setValue:d,watch:f,formState:{errors:h},reset:y}=ku({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:w}=Gs(),[_,S]=A.useState([]),[R,L]=A.useState(""),[$,ie]=A.useState(!1),[ee,F]=A.useState(""),[C,N]=A.useState(9),[V,j]=A.useState(0),[P,I]=A.useState(""),k=f("projectId");A.useEffect(()=>{if(k){const ae=w.find(Ue=>Ue.id===k||Ue.id===parseInt(k)||Ue.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",_)}},[k,w,_]),A.useEffect(()=>{console.log(" Modal mount - initializing states"),S([]),I(""),L("")},[]),A.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!t,eventId:t==null?void 0:t.id,hasSlotInfo:!!e,hasMergedEvents:!!(t!=null&&t.mergedEventIds)}),t&&t.id){console.log(" ScheduleModal processing event:",{title:t.title,projectId:t.projectId,projectName:t.projectName,start:t.start,assignedTo:t.assignedTo,time:t.time});const ae=t.originalTitle||t.title,Ue=/ - (|) \d{1,2}$/,fe=ae.replace(Ue,"");if(d("title",fe,{shouldValidate:!1,shouldDirty:!1}),d("date",Ot(t.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",t.description||"",{shouldValidate:!1,shouldDirty:!1}),t.projectId&&t.projectId!==""&&t.projectId!=="undefined")console.log(" Setting projectId from event:",t.projectId),d("projectId",t.projectId,{shouldValidate:!1,shouldDirty:!1}),I("");else if(t.projectName){const Ke=w.find(bt=>bt.name===t.projectName);console.log(" Finding project by name:",t.projectName,"found:",Ke),Ke?(console.log(" Setting projectId from found project:",Ke.id),d("projectId",Ke.id,{shouldValidate:!1,shouldDirty:!1}),I("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),I("");const Le=t.assignedTo||t.attendees||[];if(console.log(" Setting selectedMembers to:",Le),S(Array.isArray(Le)?Le:[]),t.time&&t.time!=="-"){console.log(" Setting time from event:",{eventTime:t.time,parsedHours:t.time.split(":")[0],parsedMinutes:t.time.split(":")[1]}),ie(!0);const[Ke,bt]=t.time.split(":"),st=parseInt(Ke,10),Ct=parseInt(bt,10);st>=12?(F(""),N(st===12?12:st-12)):(F(""),N(st===0?12:st)),j(Ct),console.log(" Time state set:",{hasTime:!0,period:st>=12?"":"",hour:st>=12?st===12?12:st-12:st===0?12:st,minute:Ct})}else console.log(" No time in event, setting hasTime to false"),ie(!1),F(""),N(9),j(0)}else if(e&&!t&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:Ot(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),S([]),I(""),n)){const ae=w.find(Ue=>Ue.name===n);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[t==null?void 0:t.id]);const ke=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",_),S(Ue=>{console.log(" Previous members in setState:",Ue);const fe=Ue.includes(ae)?Ue.filter(Le=>Le!==ae):[...Ue,ae];return console.log(" Updated members after toggle:",fe),fe})},Be=()=>{const ae="HV LAB";_.includes(ae)?S(Ue=>Ue.filter(fe=>fe!==ae)):S(Ue=>[...Ue.filter(fe=>fe!==""),ae])},pe=()=>{const ae="";_.includes(ae)?S(Ue=>Ue.filter(fe=>fe!==ae)):S(Ue=>[...Ue,ae])},je=()=>{const ae="";_.includes(ae)?S(Ue=>Ue.filter(fe=>fe!==ae)):S(Ue=>[...Ue,ae])},ut=()=>{R.trim()&&!_.includes(R.trim())&&(S(ae=>[...ae,R.trim()]),L(""))},qt=ae=>{S(Ue=>Ue.filter(fe=>fe!==ae))},Mt=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",_),console.log(" hasTime state:",$),console.log(" timePeriod:",ee,"timeHour:",C,"timeMinute:",V),console.log(" Available projects:",w.map(lt=>({id:lt.id,name:lt.name,idType:typeof lt.id}))),console.log(" Merged event IDs:",t==null?void 0:t.mergedEventIds);const Ue=/ - (|) \d{1,2}$/,fe=ae.title.replace(Ue,"").trim();let Le="",Ke="";if(ae.projectId){const lt=w.find(ct=>ct.id===ae.projectId||ct.id===parseInt(ae.projectId)||ct.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",lt),Le=(lt==null?void 0:lt.name)||"",Ke=ae.projectId}else Le="",Ke="";console.log(" Final projectId:",Ke,"projectName:",Le,"cleanedTitle:",fe);const bt=new Date(ae.date);let st="-";if($){let lt=C;ee===""&&C!==12?lt=C+12:ee===""&&C===12&&(lt=0),st=`${lt.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`,console.log(" Time calculated:",st)}else console.log(" No time set (hasTime is false)");const Ct={...t,title:fe,start:bt,end:bt,projectId:Ke,projectName:Le,assignedTo:_,description:ae.description||"",time:st,mergedEventIds:t==null?void 0:t.mergedEventIds};if(!a){c(!0),console.log(" Calling onSave with newEvent:",Ct);try{await r(Ct),console.log(" onSave completed successfully")}catch(lt){throw console.error(" onSave failed:",lt),lt}finally{c(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",_),o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:u(Mt),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),o.jsxDEV("select",{...m("projectId"),className:"input w-full",children:[o.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),w.filter(ae=>t!=null&&t.isASVisit?!0:ae.status!=="completed").map(ae=>o.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),o.jsxDEV("input",{...m("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),o.jsxDEV("input",{...m("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),o.jsxDEV("div",{className:"mb-2",children:o.jsxDEV("button",{type:"button",onClick:()=>ie(!$),className:`px-3 py-1.5 text-xs rounded border transition-colors ${$?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:$?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),$&&o.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsxDEV("div",{className:"flex gap-1",children:[o.jsxDEV("button",{type:"button",onClick:()=>F(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),o.jsxDEV("button",{type:"button",onClick:()=>F(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${ee===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),o.jsxDEV("select",{value:C,onChange:ae=>N(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>o.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),o.jsxDEV("select",{value:V,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>o.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[o.jsxDEV("button",{type:"button",onClick:Be,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:pe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:je,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Ff.map(ae=>o.jsxDEV("button",{type:"button",onClick:()=>ke(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${_.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),_.filter(ae=>!Ff.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>o.jsxDEV("button",{type:"button",onClick:()=>qt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:R,onChange:ae=>L(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ut())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:ut,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),o.jsxDEV("textarea",{...m("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[o.jsxDEV("div",{children:t&&o.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(t.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[o.jsxDEV(ti,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[o.jsxDEV("button",{type:"button",onClick:s,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),o.jsxDEV("button",{type:"submit",disabled:a,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:a?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},dm=t=>{if(!t||t==="-")return"";const[e,n]=t.split(":"),s=parseInt(e,10),r=parseInt(n,10),i=s>=12?"":"",a=s%12||12;return r>0?`${i} ${a} ${r}`:`${i} ${a}`},vl=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Mo=t=>{if(!t)return t;const e=t.replace(/$/g,"").trim(),n=e.split(" ");if(n.length>=2){const s=n[n.length-1];for(const r of vl)if(s===r)return n.slice(0,-1).join(" ").trim()}for(const s of vl)if(e.endsWith(s))return e.substring(0,e.length-s.length).trim()||e;return e},Ra=t=>{const e=t.replace(/$/g,"").trim(),n=e.split(" ");if(n.length>=2){const s=n[n.length-1];for(const r of vl)if(s===r)return r}for(const s of vl)if(e.endsWith(s))return s;return""},fE=["","","","","","",""],pE=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],wc=["","","/","","","","","","","","","","","","",""],hE={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},gE={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Of=fE,yE=()=>{const{schedules:t,loadSchedulesFromAPI:e,addScheduleToAPI:n,deleteScheduleFromAPI:s}=Gs(),{user:r}=Br(),[i,a]=A.useState(!1);A.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const c=r!=null&&r.name?r.name.slice(-2):null,m=(r==null?void 0:r.name)===""?[""]:c?[c,...Of.filter(d=>d!==c)]:Of,u=d=>{const f=t.filter(_=>_.attendees?!!(_.attendees.includes(d)||_.attendees.includes("HV LAB")&&d!==""||_.attendees.includes("")&&["",""].includes(d)||_.attendees.includes("")&&["","",""].includes(d)):!1),h=_=>{const S=new Set;return _.filter(R=>{const $=`${Ot(new Date(R.start),"yyyy-MM-dd")}|${R.project}|${R.title}`;return S.has($)?!1:(S.add($),!0)})},y=h(f.filter(_=>Ju(new Date(_.start)))),w=h(f.filter(_=>Fb(new Date(_.start))&&!Ju(new Date(_.start))).sort((_,S)=>new Date(_.start).getTime()-new Date(S.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:w,member:d}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[o.jsxDEV("div",{children:o.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:m.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=u(d),y=f.length+h.length,w=d===c;return o.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${w?"ring-1 ring-gray-300":""}`,children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),w&&o.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[w&&o.jsxDEV("button",{onClick:()=>a(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:o.jsxDEV(Hi,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),o.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${w&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),o.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),f.length>0&&o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(cp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const _=f.reduce((S,R)=>{const L=R.project||"-";return S[L]||(S[L]=[]),S[L].push(R),S},{});return Object.entries(_).map(([S,R])=>{const L=d===c;return o.jsxDEV("div",{className:`border-l-3 ${L?"border-gray-400":"border-gray-900"} ${L?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[o.jsxDEV("div",{className:`px-3 py-1 ${L?"bg-amber-100":"bg-gray-100"} border-b ${L?"border-amber-200":"border-gray-200"}`,children:o.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:S},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:R.map($=>{const ie=$.time&&$.time!=="-"?` - ${dm($.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",$.title,ie]},$.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},S,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),h.length>0&&o.jsxDEV("div",{children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[o.jsxDEV(wb,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-2",children:(()=>{const _=h.reduce((S,R)=>{const L=Ot(new Date(R.start),"MM.dd",{locale:Nn}),$=R.project||"-",ie=`${L}|${$}`;return S[ie]||(S[ie]={date:L,project:$,schedules:[]}),S[ie].schedules.push(R),S},{});return Object.values(_).map(({date:S,project:R,schedules:L})=>{const ie=L.length>0&&Mb(new Date(L[0].start))?`${S} ()`:S;return o.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[o.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:R},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:ie},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),o.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:L.map(ee=>{const F=ee.time&&ee.time!=="-"?` - ${dm(ee.time)}`:"";return o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",ee.title,F]},ee.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${S}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),y===0&&o.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&o.jsxDEV(ay,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>a(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await n({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),a(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await s(d),await e(),a(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},Kl=()=>{const{user:t}=Br(),{projects:e}=Gs();return A.useMemo(()=>t?t.name===""?e.filter(s=>{const i=(s.manager?s.manager.split(",").map(c=>c.trim()):[]).includes(""),a=s.team&&Array.isArray(s.team)&&s.team.includes("");return i||a}):e:[],[t,e])},bE=({value:t,detailValue:e="",onChange:n,onDetailChange:s,placeholder:r=" ",error:i})=>{const[a,c]=A.useState(!1),[m,u]=A.useState(t),[d,f]=A.useState(e),h=A.useRef(null);A.useEffect(()=>{const R=L=>{h.current&&!h.current.contains(L.target)&&c(!1)};return a&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[a]),A.useEffect(()=>{u(t)},[t]),A.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((R,L)=>{if(window.daum&&window.daum.Postcode){R(!0);return}const $=document.createElement("script");$.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",$.async=!0,$.onload=()=>R(!0),$.onerror=()=>L(new Error("Kakao Postcode   ")),document.head.appendChild($)}),w=R=>{const L=R.roadAddr||R.jibunAddr;u(L),n(L,d),c(!1)},_=R=>{const L=R.target.value;f(L),s&&s(L),m&&n(m,L)},S=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(R){const L={roadAddr:R.roadAddress,jibunAddr:R.jibunAddress||R.autoJibunAddress||"",zipNo:R.zonecode,bdNm:R.buildingName,siNm:R.sido,sggNm:R.sigungu,emdNm:R.bname,rn:R.roadname};w(L)}}).open()}catch(R){console.error("  :",R),alert("     .  .")}};return o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("div",{className:"relative flex-1",children:[o.jsxDEV("input",{type:"text",value:m,onClick:()=>S(),onChange:R=>{u(R.target.value),n(R.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),o.jsxDEV(mp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),o.jsxDEV("button",{type:"button",onClick:S,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),o.jsxDEV("div",{children:o.jsxDEV("input",{type:"text",value:d,onChange:_,placeholder:" (/ )",className:"input",disabled:!m},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),m&&o.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsxDEV("p",{className:"text-sm text-gray-600",children:[o.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",m,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),o.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},qf=["","","","","","",""],NE=({project:t,onClose:e,onSave:n})=>{const{register:s,handleSubmit:r,setValue:i,reset:a,formState:{errors:c}}=ku({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[m,u]=A.useState([]),[d,f]=A.useState(""),[h,y]=A.useState(""),[w,_]=A.useState(""),[S,R]=A.useState(!1);A.useEffect(()=>{var F;if(t){const C=t.location?t.location.split(","):["",""],N=((F=C[0])==null?void 0:F.trim())||t.location||"",V=C.length>1?C.slice(1).join(",").trim():"";a({name:t.name,client:t.client||"",location:N,detailLocation:V,startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate?new Date(t.endDate).toISOString().split("T")[0]:""}),y(N),_(V);const j=t.manager?t.manager.split(",").map(P=>P.trim()).filter(P=>P&&P!==""):[];u(j)}else a({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),_(""),u([])},[t,a]);const L=F=>{u(C=>C.includes(F)?C.filter(N=>N!==F):[...C,F])},$=()=>{d.trim()&&!m.includes(d.trim())&&(u(F=>[...F,d.trim()]),f(""))},ie=F=>{u(C=>C.filter(N=>N!==F))},ee=async F=>{if(S)return;R(!0),console.log(" ProjectModal onSubmit - Raw form data:",F);const C=h&&w?`${h}, ${w}`:h||F.location,N={name:F.name,client:F.client,location:C,manager:m.join(", "),contractAmount:(t==null?void 0:t.contractAmount)??0,spent:(t==null?void 0:t.spent)??0,status:(t==null?void 0:t.status)??"planning",progress:(t==null?void 0:t.progress)??0,description:(t==null?void 0:t.description)??"",meetingNotes:(t==null?void 0:t.meetingNotes)??[],customerRequests:(t==null?void 0:t.customerRequests)??[],entrancePassword:(t==null?void 0:t.entrancePassword)??"",sitePassword:(t==null?void 0:t.sitePassword)??""};if(F.startDate&&F.startDate!=="")N.startDate=F.startDate,console.log(" Setting startDate from form:",F.startDate);else if(t!=null&&t.startDate){const V=typeof t.startDate=="string"&&t.startDate.includes("T")?t.startDate.split("T")[0]:t.startDate;N.startDate=V,console.log(" Keeping existing startDate:",N.startDate)}if(F.endDate&&F.endDate!=="")N.endDate=F.endDate,console.log(" Setting endDate from form:",F.endDate);else if(t!=null&&t.endDate){const V=typeof t.endDate=="string"&&t.endDate.includes("T")?t.endDate.split("T")[0]:t.endDate;N.endDate=V,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await n(N)}catch(V){throw R(!1),V}};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[o.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:t?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),o.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),o.jsxDEV("form",{onSubmit:r(ee),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),o.jsxDEV("input",{...s("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),c.name&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(c.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),o.jsxDEV("input",{...s("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),o.jsxDEV(bE,{value:h,detailValue:w,onChange:(F,C)=>{y(F),_(C||""),i("location",F),i("detailLocation",C||"")},onDetailChange:F=>{_(F),i("detailLocation",F)},placeholder:"  ",required:!0,error:c.location?String(c.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),o.jsxDEV("input",{...s("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),o.jsxDEV("input",{...s("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[qf.map(F=>o.jsxDEV("button",{type:"button",onClick:()=>L(F),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${m.includes(F)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F},F,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),m.filter(F=>!qf.includes(F)).map(F=>o.jsxDEV("button",{type:"button",onClick:()=>ie(F),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[F," "]},F,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:d,onChange:F=>f(F.target.value),onKeyPress:F=>{F.key==="Enter"&&(F.preventDefault(),$())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),o.jsxDEV("button",{type:"button",onClick:$,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[o.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:S,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:S?" ...":t?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},xE=({projectName:t,meetingNotes:e,onClose:n,onSave:s,onDelete:r})=>{const[i,a]=A.useState(""),[c,m]=A.useState(new Date().toISOString().split("T")[0]),[u,d]=A.useState(!1),[f,h]=A.useState(!1),y=()=>{d(!0),a(""),m(new Date().toISOString().split("T")[0])},w=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!c){alert(" ");return}h(!0);try{await s(i.trim(),new Date(c)),a(""),m(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},_=()=>{a(""),m(new Date().toISOString().split("T")[0]),d(!1)},S=R=>{window.confirm("   ?")&&r(R)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:R=>R.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!u&&o.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),u&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:c,onChange:R=>m(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),o.jsxDEV("textarea",{value:i,onChange:R=>a(R.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:w,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),o.jsxDEV("button",{onClick:_,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-3",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(R=>o.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ot(new Date(R.date),"yyyy.MM.dd (eee)",{locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:R.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>S(R.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},R.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},vE=({projectName:t,customerRequests:e,onClose:n,onSave:s,onToggleComplete:r,onDelete:i})=>{const[a,c]=A.useState(""),[m,u]=A.useState(new Date().toISOString().split("T")[0]),[d,f]=A.useState(!1),[h,y]=A.useState(!1),w=()=>{f(!0),c(""),u(new Date().toISOString().split("T")[0])},_=async()=>{if(!h){if(!a.trim()){alert(" ");return}if(!m){alert(" ");return}y(!0);try{await s(a.trim(),new Date(m)),c(""),u(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},S=()=>{c(""),u(new Date().toISOString().split("T")[0]),f(!1)},R=ee=>{window.confirm("  ?")&&i(ee)},L=ee=>{r(ee)},$=e.filter(ee=>!ee.completed),ie=e.filter(ee=>ee.completed);return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:ee=>ee.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),o.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&o.jsxDEV("button",{onClick:w,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&o.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:m,onChange:ee=>u(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),o.jsxDEV("textarea",{value:a,onChange:ee=>c(ee.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:_,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),o.jsxDEV("button",{onClick:S,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2",children:e.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):o.jsxDEV(o.Fragment,{children:[$.map(ee=>o.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>L(ee.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Sb,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ot(new Date(ee.createdAt),"yyyy.MM.dd",{locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>R(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),ie.map(ee=>o.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:o.jsxDEV("div",{className:"flex items-start gap-3",children:[o.jsxDEV("button",{onClick:()=>L(ee.id),className:"mt-0.5 flex-shrink-0",children:o.jsxDEV(Ib,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:ee.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ot(new Date(ee.createdAt),"yyyy.MM.dd",{locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>R(ee.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},ee.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},_E=({projectName:t,entrancePassword:e,sitePassword:n,onClose:s,onSave:r})=>{const[i,a]=A.useState(e||""),[c,m]=A.useState(n||""),[u,d]=A.useState(!1),[f,h]=A.useState(!1),y=()=>{d(!0)},w=async()=>{if(!f){h(!0);try{await r(i,c),d(!1)}finally{h(!1)}}},_=()=>{a(e||""),m(n||""),d(!1)};return o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s,children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:S=>S.stopPropagation(),children:[o.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[o.jsxDEV("div",{children:[o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),o.jsxDEV("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),o.jsxDEV("div",{className:"p-6 space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:i,onChange:S=>a(S.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),u?o.jsxDEV("input",{type:"text",value:c,onChange:S=>m(S.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:c?o.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):o.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),o.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:u?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:w,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),o.jsxDEV("button",{onClick:_,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("button",{onClick:s,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},DE=({projectName:t,onClose:e})=>{var a;const[n,s]=A.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=c=>{const m=Number(c.replace(/,/g,""));return isNaN(m)?"":m.toLocaleString()};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.clientName,onChange:c=>s({...n,clientName:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.phoneNumber,onChange:c=>s({...n,phoneNumber:c.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.address,onChange:c=>s({...n,address:c.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:n.startDate,onChange:c=>s({...n,startDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:n.endDate,onChange:c=>s({...n,endDate:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.area,onChange:c=>s({...n,area:c.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:i(n.designFee),onChange:c=>{const m=c.target.value.replace(/,/g,"");/^\d*$/.test(m)&&s({...n,designFee:m})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:n.bankAccount,onChange:c=>s({...n,bankAccount:c.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),o.jsxDEV("button",{onClick:r,disabled:!n.clientName||!n.phoneNumber||!n.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(up,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-16",children:o.jsxDEV("div",{className:"space-y-16",children:[o.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.startDate&&n.endDate?o.jsxDEV(o.Fragment,{children:[Ot(new Date(n.startDate),"yyyy",{locale:Nn}),"",Ot(new Date(n.startDate),"MM",{locale:Nn}),"",Ot(new Date(n.startDate),"dd",{locale:Nn})," ~ ",Ot(new Date(n.endDate),"yyyy",{locale:Nn}),"",Ot(new Date(n.endDate),"MM",{locale:Nn}),"",Ot(new Date(n.endDate),"dd",{locale:Nn})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:n.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("div",{className:"flex items-baseline",children:[o.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),o.jsxDEV("span",{className:"flex-1",children:[n.designFee?`${i(n.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),n.bankAccount&&o.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:n.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-20 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",n.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",(a=n.clientName)==null?void 0:a.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),o.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 space-y-3",children:[o.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),o.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[o.jsxDEV("div",{children:[" : ",n.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),o.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{children:[" : ",n.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),o.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:o.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),o.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),o.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),o.jsxDEV("div",{className:"text-right",children:[o.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},kE=()=>{const{loadProjectsFromAPI:t,addProjectToAPI:e,updateProjectInAPI:n,deleteProjectFromAPI:s}=Gs(),{user:r}=Br(),i=Kl(),[a,c]=A.useState("in-progress"),[m,u]=A.useState("grid"),[d,f]=A.useState(!1),[h,y]=A.useState(null),[w,_]=A.useState(!1),[S,R]=A.useState(!1),[L,$]=A.useState(!1),[ie,ee]=A.useState(!1),[F,C]=A.useState(null),N=(Q,Pe)=>`lastViewed_${r==null?void 0:r.id}_${Q}_${Pe}`,V=(Q,Pe)=>{const Oe=N(Q,Pe),Ie=localStorage.getItem(Oe);return Ie?parseInt(Ie,10):0},j=(Q,Pe)=>{const Oe=N(Q,Pe);localStorage.setItem(Oe,Date.now().toString())},P=(Q,Pe)=>{const Oe=V(Q.id,Pe);return Pe==="meeting"?(Q.meetingNotes||[]).some(He=>(He.createdAt?new Date(He.createdAt).getTime():new Date(He.date).getTime())>Oe):(Q.customerRequests||[]).some(He=>!He.completed)};A.useEffect(()=>{t().catch(Q=>{console.error("Failed to load projects:",Q),te.error("   ")})},[t]),A.useEffect(()=>{const Q=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",Q),()=>window.removeEventListener("headerAddButtonClick",Q)},[]);const I=(Q,Pe)=>{if(!Q||!Pe)return 0;const Oe=new Date,Ie=new Date(Q),He=new Date(Pe);if(Oe<Ie)return 0;if(Oe>He)return 100;const Tt=Math.ceil((He.getTime()-Ie.getTime())/(1e3*60*60*24)),Ft=Math.ceil((Oe.getTime()-Ie.getTime())/(1e3*60*60*24)),dt=Math.round(Ft/Tt*100);return Math.min(100,Math.max(0,dt))},k=Q=>{y(Q),f(!0)},ke=async(Q,Pe)=>{if(window.confirm(`"${Pe}"  ?

    .`))try{await s(Q),te.success(" ")}catch(Oe){console.error("Failed to delete project:",Oe),te.error("  ")}},Be=async Q=>{try{if(h)await n(h.id,Q),te.success(" ");else{const Pe={id:"",...Q,team:Q.team||[]};await e(Pe),te.success(" "),c(Q.status||"planning")}f(!1),y(null)}catch(Pe){console.error("Failed to save project:",Pe),te.error("  ")}},pe=async(Q,Pe)=>{try{await n(Q,{status:Pe}),te.success(" ")}catch(Oe){console.error("Failed to update project status:",Oe),te.error("  ")}},je=Q=>{C(Q),_(!0),j(Q.id,"meeting")},ut=Q=>{C(Q),R(!0),j(Q.id,"request")},qt=Q=>{C(Q),$(!0)},Mt=Q=>{C(Q),ee(!0)},ae=async(Q,Pe)=>{if(!F)return;const Oe=F.entrancePassword,Ie=F.sitePassword;C({...F,entrancePassword:Q,sitePassword:Pe});try{await n(F.id,{entrancePassword:Q,sitePassword:Pe}),te.success(" ")}catch(He){console.error("Failed to save passwords:",He),te.error("  "),C({...F,entrancePassword:Oe,sitePassword:Ie})}},Ue=async(Q,Pe)=>{if(!F)return;const Oe={id:Date.now().toString(),content:Q,date:Pe,createdAt:new Date},Ie=[...F.meetingNotes||[],Oe];C({...F,meetingNotes:Ie});try{await n(F.id,{meetingNotes:Ie}),te.success("  ")}catch(He){console.error("Failed to save meeting note:",He),te.error("   "),C({...F,meetingNotes:F.meetingNotes||[]})}},fe=async(Q,Pe)=>{if(!F)return;const Oe={id:Date.now().toString(),content:Q,completed:!1,createdAt:Pe},Ie=[...F.customerRequests||[],Oe];C({...F,customerRequests:Ie});try{await n(F.id,{customerRequests:Ie}),te.success("  ")}catch(He){console.error("Failed to save customer request:",He),te.error("   "),C({...F,customerRequests:F.customerRequests||[]})}},Le=async Q=>{if(!F)return;const Pe=F.customerRequests||[],Oe=Pe.map(Ie=>Ie.id===Q?{...Ie,completed:!Ie.completed}:Ie);C({...F,customerRequests:Oe});try{await n(F.id,{customerRequests:Oe}),te.success("  ")}catch(Ie){console.error("Failed to toggle request:",Ie),te.error("  "),C({...F,customerRequests:Pe})}},Ke=async Q=>{if(!F)return;const Pe=F.meetingNotes||[],Oe=Pe.filter(Ie=>Ie.id!==Q);C({...F,meetingNotes:Oe});try{await n(F.id,{meetingNotes:Oe}),te.success("  ")}catch(Ie){console.error("Failed to delete meeting note:",Ie),te.error(" "),C({...F,meetingNotes:Pe})}},bt=async Q=>{if(!F)return;const Pe=F.customerRequests||[],Oe=Pe.filter(Ie=>Ie.id!==Q);C({...F,customerRequests:Oe});try{await n(F.id,{customerRequests:Oe}),te.success("  ")}catch(Ie){console.error("Failed to delete customer request:",Ie),te.error(" "),C({...F,customerRequests:Pe})}},st=({project:Q})=>{const Oe={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[Q.status];return o.jsxDEV("select",{value:Q.status,onChange:Ie=>pe(Q.id,Ie.target.value),className:xs("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Oe.color),onClick:Ie=>Ie.stopPropagation(),children:[o.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),o.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),o.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),o.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},lt=(()=>{let Q=i;return a!=="all"&&(Q=Q.filter(Pe=>Pe.status===a)),r!=null&&r.name&&(Q=[...Q].sort((Pe,Oe)=>{var Tt,Ft;const Ie=Pe.manager===r.name||((Tt=Pe.team)==null?void 0:Tt.includes(r.name)),He=Oe.manager===r.name||((Ft=Oe.team)==null?void 0:Ft.includes(r.name));return Ie&&!He?-1:!Ie&&He?1:0})),Q})(),ct={planning:i.filter(Q=>Q.status==="planning").length,inProgress:i.filter(Q=>Q.status==="in-progress").length,completed:i.filter(Q=>Q.status==="completed").length,onHold:i.filter(Q=>Q.status==="on-hold").length},cn=({project:Q})=>{var Oe,Ie,He;const Pe=I(Q.startDate,Q.endDate);return o.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&o.jsxDEV("button",{onClick:()=>Mt(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),o.jsxDEV(st,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>k(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),o.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.startDate&&Q.endDate?`${Ot(Q.startDate,"MM.dd (eee)",{locale:Nn})} - ${Ot(Q.endDate,"MM.dd (eee)",{locale:Nn})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),o.jsxDEV("div",{className:"text-gray-600",children:[": ",Q.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),o.jsxDEV("div",{className:"mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:o.jsxDEV("button",{onClick:()=>qt(Q),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[o.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),o.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),o.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:o.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),o.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[o.jsxDEV("div",{onClick:()=>je(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Oe=Q.meetingNotes)==null?void 0:Oe.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Ie=Q.meetingNotes)==null?void 0:Ie.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),P(Q,"meeting")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),Q.meetingNotes&&Q.meetingNotes.length>0?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((He=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:He.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var dt;const Tt=((dt=Q.customerRequests)==null?void 0:dt.filter(T=>!T.completed))||[],Ft=Tt[Tt.length-1];return o.jsxDEV("div",{onClick:()=>ut(Q),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[o.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Tt.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",Tt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),P(Q,"request")&&o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Ft?o.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Ft.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):o.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("div",{className:"flex justify-end pt-1",children:o.jsxDEV("button",{onClick:()=>ke(Q.id,Q.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ct.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ct.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ct.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(Q=>o.jsxDEV("button",{onClick:()=>c(Q.id),className:xs("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",a===Q.id?`border-gray-700 ${Q.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[Q.label,o.jsxDEV("span",{className:xs("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",a===Q.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:Q.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[o.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[o.jsxDEV("button",{onClick:()=>u("grid"),className:xs("px-3 md:px-4 py-2 text-xs md:text-sm",m==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>u("list"),className:xs("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",m==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[o.jsxDEV(Hi,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),o.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),m==="grid"||window.innerWidth<768?o.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:lt.map(Q=>o.jsxDEV(cn,{project:Q},Q.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):o.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:o.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsxDEV("thead",{className:"bg-gray-50",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:lt.map(Q=>{var Oe,Ie,He,Tt;const Pe=I(Q.startDate,Q.endDate);return o.jsxDEV("tr",{className:"hover:bg-gray-50",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{children:[o.jsxDEV("p",{className:"font-medium",children:Q.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500",children:Q.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("p",{className:"text-sm",children:[Q.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q.startDate&&Q.endDate?o.jsxDEV(o.Fragment,{children:[Ot(Q.startDate,"yyyy.MM.dd (eee)",{locale:Nn})," -",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ot(Q.endDate,"yyyy.MM.dd (eee)",{locale:Nn})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[Q.status==="planning"&&o.jsxDEV("button",{onClick:()=>Mt(Q),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),o.jsxDEV(st,{project:Q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("button",{onClick:()=>qt(Q),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center",children:[o.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:o.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-sm",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[o.jsxDEV("div",{onClick:()=>je(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Oe=Q.meetingNotes)==null?void 0:Oe.length)||0)>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",(Ie=Q.meetingNotes)==null?void 0:Ie.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),P(Q,"meeting")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(He=Q.meetingNotes)!=null&&He.length?((Tt=Q.meetingNotes[Q.meetingNotes.length-1])==null?void 0:Tt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var T;const Ft=((T=Q.customerRequests)==null?void 0:T.filter(O=>!O.completed))||[],dt=Ft[Ft.length-1];return o.jsxDEV("div",{onClick:()=>ut(Q),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[o.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Ft.length>0&&o.jsxDEV("span",{className:"text-gray-500",children:["(",Ft.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),P(Q,"request")&&o.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),o.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:dt?dt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),o.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[o.jsxDEV("button",{onClick:()=>k(Q),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&o.jsxDEV("button",{onClick:()=>ke(Q.id,Q.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},Q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&o.jsxDEV(NE,{project:h,onClose:()=>{f(!1),y(null)},onSave:Be},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),w&&F&&o.jsxDEV(xE,{projectName:F.name,meetingNotes:F.meetingNotes||[],onClose:()=>{_(!1),C(null)},onSave:Ue,onDelete:Ke},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),S&&F&&o.jsxDEV(vE,{projectName:F.name,customerRequests:F.customerRequests||[],onClose:()=>{R(!1),C(null)},onSave:fe,onToggleComplete:Le,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),L&&F&&o.jsxDEV(_E,{projectName:F.name,entrancePassword:F.entrancePassword||"",sitePassword:F.sitePassword||"",onClose:()=>{$(!1),C(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),ie&&F&&o.jsxDEV(DE,{projectName:F.name,onClose:()=>{ee(!1),C(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var Au={},ly={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ly);var Qn=ly.exports,Eu={},cy={exports:{}},my={exports:{}},uy={exports:{}},dy={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(dy);var no=dy.exports,fy={exports:{}};(function(t){var e=no.default;function n(s,r){if(e(s)!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var a=i.call(s,r||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(fy);var AE=fy.exports;(function(t){var e=no.default,n=AE;function s(r){var i=n(r,"string");return e(i)=="symbol"?i:i+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(uy);var py=uy.exports;(function(t){var e=py;function n(s,r,i){return(r=e(r))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(my);var hy=my.exports;(function(t){var e=hy;function n(r,i){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);i&&(c=c.filter(function(m){return Object.getOwnPropertyDescriptor(r,m).enumerable})),a.push.apply(a,c)}return a}function s(r){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?n(Object(a),!0).forEach(function(c){e(r,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(a,c))})}return r}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(cy);var Ur=cy.exports,gy={exports:{}},yy={exports:{}};(function(t){function e(n,s){if(n==null)return{};var r={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(s.indexOf(i)!==-1)continue;r[i]=n[i]}return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(yy);var EE=yy.exports;(function(t){var e=EE;function n(s,r){if(s==null)return{};var i,a,c=e(s,r);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(s);for(a=0;a<m.length;a++)i=m[a],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(c[i]=s[i])}return c}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(gy);var Vu=gy.exports,by={exports:{}};(function(t){function e(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(by);var ci=by.exports,Ny={exports:{}};(function(t){var e=py;function n(r,i){for(var a=0;a<i.length;a++){var c=i[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(r,e(c.key),c)}}function s(r,i,a){return i&&n(r.prototype,i),a&&n(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(Ny);var mi=Ny.exports,xy={exports:{}},vy={exports:{}};(function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(vy);var VE=vy.exports,_y={exports:{}};(function(t){function e(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t.exports=e=function(){return!!n},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(_y);var CE=_y.exports,Dy={exports:{}},ky={exports:{}};(function(t){function e(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ky);var wE=ky.exports;(function(t){var e=no.default,n=wE;function s(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n(r)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(Dy);var SE=Dy.exports;(function(t){var e=VE,n=CE,s=SE;function r(i,a,c){return a=e(a),s(i,n()?Reflect.construct(a,c||[],e(i).constructor):a.apply(i,c))}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(xy);var so=xy.exports,Ay={exports:{}},Ey={exports:{}};(function(t){function e(n,s){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Ey);var IE=Ey.exports;(function(t){var e=IE;function n(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),r&&e(s,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Ay);var ro=Ay.exports;const ha=na(Ob);var ks={},Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.views=Yi.navigate=void 0;Yi.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};Yi.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var PE=Qn.default;Object.defineProperty(ks,"__esModule",{value:!0});ks.views=ks.dateRangeFormat=ks.dateFormat=ks.accessor=ks.DayLayoutAlgorithmPropType=void 0;var rs=PE(dp),$f=Yi,Wf=Object.keys($f.views).map(function(t){return $f.views[t]});ks.accessor=rs.default.oneOfType([rs.default.string,rs.default.func]);ks.dateFormat=rs.default.any;ks.dateRangeFormat=rs.default.func;ks.views=rs.default.oneOfType([rs.default.arrayOf(rs.default.oneOf(Wf)),rs.default.objectOf(function(t,e){var n=Wf.indexOf(e)!==-1&&typeof t[e]=="boolean";if(n)return null;for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return rs.default.elementType.apply(rs.default,[t,e].concat(r))})]);ks.DayLayoutAlgorithmPropType=rs.default.oneOfType([rs.default.oneOf(["overlap","no-overlap"]),rs.default.func]);var Ql={},io={},LE=Qn.default;Object.defineProperty(io,"__esModule",{value:!0});io.accessor=Vy;io.wrapAccessor=void 0;var TE=LE(no);function Vy(t,e){var n=null;return typeof e=="function"?n=e(t):typeof e=="string"&&(0,TE.default)(t)==="object"&&t!=null&&e in t&&(n=t[e]),n}io.wrapAccessor=function(e){return function(n){return Vy(n,e)}};var ui={},jE=Qn.default;Object.defineProperty(ui,"__esModule",{value:!0});ui.DnDContext=void 0;var RE=jE(A);ui.DnDContext=RE.default.createContext();var di=Qn.default;Object.defineProperty(Ql,"__esModule",{value:!0});Ql.default=void 0;var BE=di(Ur),UE=di(ci),HE=di(mi),ME=di(so),FE=di(ro),Si=di(A),zf=di(ha),Kf=io,OE=ui,Cy=function(t){function e(){var n;(0,UE.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,ME.default)(this,e,[].concat(r)),n.handleResizeUp=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","UP")},n.handleResizeDown=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","DOWN")},n.handleResizeLeft=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","LEFT")},n.handleResizeRight=function(a){a.button===0&&n.context.draggable.onBeginAction(n.props.event,"resize","RIGHT")},n.handleStartDragging=function(a){var c;if(a.button===0){var m=(c=a.target.getAttribute("class"))===null||c===void 0?void 0:c.includes("rbc-addons-dnd-resize");if(!m){var u=(0,BE.default)({},n.props.event);u.sourceResource=n.props.resource,n.context.draggable.onBeginAction(n.props.event,"move")}}},n}return(0,FE.default)(e,t),(0,HE.default)(e,[{key:"renderAnchor",value:function(s){var r=s==="Up"||s==="Down"?"ns":"ew";return Si.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(s)]},Si.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var s=this.props,r=s.event,i=s.type,a=s.continuesPrior,c=s.continuesAfter,m=s.resizable,u=this.props.children;if(r.__isPreview)return Si.default.cloneElement(u,{className:(0,zf.default)(u.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,Kf.accessor)(r,f):!0;if(!y)return u;var w=m&&(h?!!(0,Kf.accessor)(r,h):!0);if(w||y){var _={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(w){var S=null,R=null;i==="date"?(S=!a&&this.renderAnchor("Left"),R=!c&&this.renderAnchor("Right")):(S=!a&&this.renderAnchor("Up"),R=!c&&this.renderAnchor("Down")),_.children=Si.default.createElement("div",{className:"rbc-addons-dnd-resizable"},S,u.props.children,R)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(_.className=(0,zf.default)(u.props.className,"rbc-addons-dnd-dragged-event")),u=Si.default.cloneElement(u,_)}return u}}])}(Si.default.Component);Cy.contextType=OE.DnDContext;Ql.default=Cy;var Yl={},wy={exports:{}};(function(t){var e=no.default;function n(s,r){if(typeof WeakMap=="function")var i=new WeakMap,a=new WeakMap;return(t.exports=n=function(m,u){if(!u&&m&&m.__esModule)return m;var d,f,h={__proto__:null,default:m};if(m===null||e(m)!="object"&&typeof m!="function")return h;if(d=u?a:i){if(d.has(m))return d.get(m);d.set(m,h)}for(var y in m)y!=="default"&&{}.hasOwnProperty.call(m,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(m,y))&&(f.get||f.set)?d(h,y,f):h[y]=m[y]);return h},t.exports.__esModule=!0,t.exports.default=t.exports)(s,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(wy);var Sy=wy.exports;function Cu(t,e,n,s){if(n===void 0&&(n=!1),s===void 0&&(s=!0),t){var r=document.createEvent("HTMLEvents");r.initEvent(e,n,s),t.dispatchEvent(r)}}function qE(t){var e=vs(t,"transitionDuration")||"",n=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*n}function $E(t,e,n){n===void 0&&(n=5);var s=!1,r=setTimeout(function(){s||Cu(t,"transitionend",!0)},e+n),i=_l(t,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(r),i()}}function wu(t,e,n,s){n==null&&(n=qE(t)||0);var r=$E(t,n,s),i=_l(t,"transitionend",e);return function(){r(),i()}}var Qf={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Yf(t){var e=t.node,n=t.properties,s=t.duration,r=s===void 0?200:s,i=t.easing,a=t.callback,c=[],m={},u="";Object.keys(n).forEach(function(h){var y=n[h];qb(h)?u+=h+"("+y+") ":(m[h]=y,c.push($b(h)))}),u&&(m.transform=u,c.push("transform"));function d(h){h.target===h.currentTarget&&(vs(e,Qf),a&&a.call(this,h))}r>0&&(m.transition=c.join(", "),m["transition-duration"]=r/1e3+"s",m["transition-delay"]="0s",m["transition-timing-function"]=i||"linear");var f=wu(e,d,r);return e.clientLeft,vs(e,m),{cancel:function(){f(),vs(e,Qf)}}}function Iy(t,e,n,s,r){if(!("nodeType"in t))return Yf(t);if(!e)throw new Error("must include properties to animate");return typeof s=="function"&&(r=s,s=""),Yf({node:t,properties:e,duration:n,easing:s,callback:r})}function Py(t,e,n){if(t){if(typeof n>"u")return t.getAttribute(e);!n&&n!==""?t.removeAttribute(e):t.setAttribute(e,String(n))}}function Ly(t){return t?Array.from(t.children):[]}function Ty(t){if(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}return null}var WE=Function.prototype.bind.call(Function.prototype.call,[].slice);function jy(t){return t?WE(t.childNodes):[]}function Ry(t,e){return function(s){var r=s.currentTarget,i=s.target,a=bm(r,t);a.some(function(c){return Nm(c,i)})&&e.call(this,s)}}function By(t,e){return t&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t):null}var zE=/^(?:input|select|textarea|button)$/i;function Uy(t){return t?zE.test(t.nodeName):!1}function Hy(t){return t?!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length):!1}function My(t,e,n){e===void 0&&(e=null),n===void 0&&(n=null);for(var s=[];t;t=t.nextElementSibling)if(t!==e){if(n&&xm(t,n))break;s.push(t)}return s}function Fy(t,e){return My(t,t,e)}function KE(t,e){var n=null,s=[];for(n=t?t[e]:null;n&&n.nodeType!==9;)s.push(n),n=n[e]||null;return s}function Oy(t){return KE(t,"parentElement")}function qy(t,e){return t&&e?(e.firstElementChild?e.insertBefore(t,e.firstElementChild):e.appendChild(t),t):null}function $y(t){return t&&t.parentNode?(t.parentNode.removeChild(t),t):null}function Su(t,e){var n=vs(t,"position"),s=n==="absolute",r=t.ownerDocument;if(n==="fixed")return r||document;for(;(t=t.parentNode)&&!Wb(t);){var i=s&&vs(t,"position")==="static",a=(vs(t,"overflow")||"")+(vs(t,"overflow-y")||"")+vs(t,"overflow-x");if(!i&&/(auto|scroll)/.test(a)&&(e||Dl(t)<t.scrollHeight))return t}return r||document}function Wy(t,e){var n=el(t),s={top:0,left:0};if(t){var r=e||Su(t),i=zb(r),a=tl(r),c=Dl(r,!0);i||(s=el(r)),n={top:n.top-s.top,left:n.left-s.left,height:n.height,width:n.width};var m=n.height,u=n.top+(i?0:a),d=u+m;a=a>u?u:d>a+c?d-c:a;var f=vm(function(){return tl(r,a)});return function(){return _m(f)}}}function zy(t){return My(t&&t.parentElement?t.parentElement.firstElementChild:null,t)}var QE=/&nbsp;/gi,YE=/\xA0/g,GE=/\s+([^\s])/gm;function Ky(t,e,n){e===void 0&&(e=!0),n===void 0&&(n=!0);var s="";return t&&(s=(t.textContent||"").replace(QE," ").replace(YE," "),e&&(s=s.trim()),n&&(s=s.replace(GE," $1"))),s}function Qy(t,e){t.classList?t.classList.toggle(e):Dm(t,e)?km(t,e):Am(t,e)}const XE={addEventListener:kp,removeEventListener:Dp,triggerEvent:Cu,animate:Iy,filter:Ry,listen:_l,style:vs,getComputedStyle:_p,attribute:Py,activeElement:vp,ownerDocument:xp,ownerWindow:Np,requestAnimationFrame:vm,cancelAnimationFrame:_m,matches:xm,height:Dl,width:bp,offset:el,offsetParent:yp,position:gp,contains:Nm,scrollbarSize:hp,scrollLeft:pp,scrollParent:Su,scrollTo:Wy,scrollTop:tl,querySelectorAll:bm,closest:fp,addClass:Am,removeClass:km,hasClass:Dm,toggleClass:Qy,transitionEnd:wu,childNodes:jy,childElements:Ly,nextUntil:Fy,parents:Oy,siblings:zy,clear:Ty,insertAfter:By,isInput:Uy,isVisible:Hy,prepend:qy,remove:$y,text:Ky},JE=Object.freeze(Object.defineProperty({__proto__:null,activeElement:vp,addClass:Am,addEventListener:kp,animate:Iy,attribute:Py,cancelAnimationFrame:_m,childElements:Ly,childNodes:jy,clear:Ty,closest:fp,contains:Nm,default:XE,filter:Ry,getComputedStyle:_p,hasClass:Dm,height:Dl,insertAfter:By,isInput:Uy,isVisible:Hy,listen:_l,matches:xm,nextUntil:Fy,offset:el,offsetParent:yp,ownerDocument:xp,ownerWindow:Np,parents:Oy,position:gp,prepend:qy,querySelectorAll:bm,remove:$y,removeClass:km,removeEventListener:Dp,requestAnimationFrame:vm,scrollLeft:pp,scrollParent:Su,scrollTo:Wy,scrollTop:tl,scrollbarSize:hp,siblings:zy,style:vs,text:Ky,toggleClass:Qy,transitionEnd:wu,triggerEvent:Cu,width:bp},Symbol.toStringTag,{value:"Module"})),ZE=na(JE);var fm={exports:{}};(function(t,e){e.__esModule=!0,e.default=s;var n=Function.prototype.bind.call(Function.prototype.call,[].slice);function s(r,i){return n(r.querySelectorAll(i))}t.exports=e.default})(fm,fm.exports);var eV=fm.exports,Es={};const tV=na(Kb),nV=na(Qb),sV=na(Yb);var oo=Qn.default;Object.defineProperty(Es,"__esModule",{value:!0});Es.default=void 0;Es.getBoundsForNode=ta;Es.getEventNodeFromPoint=Gy;Es.getShowMoreNodeFromPoint=Xy;Es.isEvent=cV;Es.isShowMore=mV;Es.objectsCollide=hm;var rV=oo(no),iV=oo(ci),oV=oo(mi),pm=oo(tV),Yy=oo(nV),aV=oo(sV);function Wn(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,aV.default)(n,t,e,{passive:!1})}function lV(t,e,n){return!t||(0,pm.default)(t,document.elementFromPoint(e,n))}function Gy(t,e){var n=e.clientX,s=e.clientY,r=document.elementFromPoint(n,s);return(0,Yy.default)(r,".rbc-event",t)}function Xy(t,e){var n=e.clientX,s=e.clientY,r=document.elementFromPoint(n,s);return(0,Yy.default)(r,".rbc-show-more",t)}function cV(t,e){return!!Gy(t,e)}function mV(t,e){return!!Xy(t,e)}function Do(t){var e=t;return t.touches&&t.touches.length&&(e=t.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Gf=5,uV=250,dV=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.global,r=s===void 0?!1:s,i=n.longPressThreshold,a=i===void 0?250:i,c=n.validContainers,m=c===void 0?[]:c;(0,iV.default)(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=a,this.validContainers=m,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Wn("touchmove",function(){},window),this._removeKeyDownListener=Wn("keydown",this._keyListener),this._removeKeyUpListener=Wn("keyup",this._keyListener),this._removeDropFromOutsideListener=Wn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Wn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,oV.default)(t,[{key:"on",value:function(n,s){var r=this._listeners[n]||(this._listeners[n]=[]);return r.push(s),{remove:function(){var a=r.indexOf(s);a!==-1&&r.splice(a,1)}}}},{key:"emit",value:function(n){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];var a,c=this._listeners[n]||[];return c.forEach(function(m){a===void 0&&(a=m.apply(void 0,r))}),a}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(n){var s=this._selectRect;return!s||!this.selecting?!1:hm(s,ta(n))}},{key:"filter",value:function(n){var s=this._selectRect;return!s||!this.selecting?[]:n.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(n,s){var r=this,i=null,a=null,c=null,m=function(h){i=setTimeout(function(){d(),n(h)},r.longPressThreshold),a=Wn("touchmove",function(){return d()}),c=Wn("touchend",function(){return d()})},u=Wn("touchstart",m),d=function(){i&&clearTimeout(i),a&&a(),c&&c(),i=null,a=null,c=null};return s&&m(s),function(){d(),u()}}},{key:"_addInitialEventListener",value:function(){var n=this,s=Wn("mousedown",function(i){n._removeInitialEventListener(),n._handleInitialEvent(i),n._removeInitialEventListener=Wn("mousedown",n._handleInitialEvent)}),r=Wn("touchstart",function(i){n._removeInitialEventListener(),n._removeInitialEventListener=n._addLongPressListener(n._handleInitialEvent,i)});this._removeInitialEventListener=function(){s(),r()}}},{key:"_dropFromOutsideListener",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:a,clientY:c}),n.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:a,clientY:c}),n.preventDefault()}},{key:"_handleInitialEvent",value:function(n){if(this._initialEvent=n,!this.isDetached){var s=Do(n),r=s.clientX,i=s.clientY,a=s.pageX,c=s.pageY,m=this.container(),u,d;if(!(n.which===3||n.button===2||!lV(m,r,i))){if(!this.globalMouse&&m&&!(0,pm.default)(m,n.target)){var f=fV(0),h=f.top,y=f.left,w=f.bottom,_=f.right;if(d=ta(m),u=hm({top:d.top-h,left:d.left-y,bottom:d.bottom+w,right:d.right+_},{top:c,left:a}),!u)return}var S=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(n.type),x:a,y:c,clientX:r,clientY:i});if(S!==!1)switch(n.type){case"mousedown":this._removeEndListener=Wn("mouseup",this._handleTerminatingEvent),this._onEscListener=Wn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Wn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(n),this._removeEndListener=Wn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Wn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(n){var s=n.target,r=this.validContainers;return!r||!r.length||!s?!0:r.some(function(i){return!!s.closest(i)})}},{key:"_handleTerminatingEvent",value:function(n){var s=this.selecting,r=this._selectRect;if(!s&&n.type.includes("key")&&(n=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!n){var i=!this.container||(0,pm.default)(this.container(),n.target),a=this._isWithinValidContainer(n);return n.key==="Escape"||!a?this.emit("reset"):!s&&i?this._handleClickEvent(n):s?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(n){var s=Do(n),r=s.pageX,i=s.pageY,a=s.clientX,c=s.clientY,m=new Date().getTime();return this._lastClickData&&m-this._lastClickData.timestamp<uV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:a,clientY:c})):(this._lastClickData={timestamp:m},this.emit("click",{x:r,y:i,clientX:a,clientY:c}))}},{key:"_handleMoveEvent",value:function(n){if(!(this._initialEventData===null||this.isDetached)){var s=this._initialEventData,r=s.x,i=s.y,a=Do(n),c=a.pageX,m=a.pageY,u=Math.abs(r-c),d=Math.abs(i-m),f=Math.min(c,r),h=Math.min(m,i),y=this.selecting,w=this.isClick(c,m);w&&!y&&!(u||d)||(!y&&!w&&this.emit("selectStart",this._initialEventData),w||(this.selecting=!0,this._selectRect={top:h,left:f,x:c,y:m,right:f+u,bottom:h+d},this.emit("selecting",this._selectRect)),n.preventDefault())}}},{key:"_keyListener",value:function(n){this.ctrl=n.metaKey||n.ctrlKey}},{key:"isClick",value:function(n,s){var r=this._initialEventData,i=r.x,a=r.y,c=r.isTouch;return!c&&Math.abs(n-i)<=Gf&&Math.abs(s-a)<=Gf}}])}();function fV(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,rV.default)(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function hm(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=ta(t),r=s.top,i=s.left,a=s.right,c=a===void 0?i:a,m=s.bottom,u=m===void 0?r:m,d=ta(e),f=d.top,h=d.left,y=d.right,w=y===void 0?h:y,_=d.bottom,S=_===void 0?f:_;return!(u-n<f||r+n>S||c-n<h||i+n>w)}function ta(t){if(!t.getBoundingClientRect)return t;var e=t.getBoundingClientRect(),n=e.left+Xf("left"),s=e.top+Xf("top");return{top:s,left:n,right:(t.offsetWidth||0)+n,bottom:(t.offsetHeight||0)+s}}function Xf(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}Es.default=dV;var Gl={},Xl=Qn.default;Object.defineProperty(Gl,"__esModule",{value:!0});Gl.default=void 0;var pV=Xl(hy),Jf=Xl(Ur),hV=Xl(ha),ko=Xl(A);function Ba(t){return typeof t=="string"?t:t+"%"}function gV(t){var e=t.style,n=t.className,s=t.event,r=t.accessors,i=t.rtl,a=t.selected,c=t.label,m=t.continuesPrior,u=t.continuesAfter,d=t.getters,f=t.onClick,h=t.onDoubleClick,y=t.isBackgroundEvent,w=t.onKeyPress,_=t.components,S=_.event,R=_.eventWrapper,L=r.title(s),$=r.tooltip(s),ie=r.end(s),ee=r.start(s),F=d.eventProp(s,ee,ie,a),C=[ko.default.createElement("div",{key:"1",className:"rbc-event-label"},c),ko.default.createElement("div",{key:"2",className:"rbc-event-content"},S?ko.default.createElement(S,{event:s,title:L}):L)],N=e.height,V=e.top,j=e.width,P=e.xOffset,I=(0,Jf.default)((0,Jf.default)({},F.style),{},(0,pV.default)({top:Ba(V),height:Ba(N),width:Ba(j)},i?"right":"left",Ba(P)));return ko.default.createElement(R,Object.assign({type:"time"},t),ko.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:I,onKeyDown:w,title:$?(typeof c=="string"?c+": ":"")+$:void 0,className:(0,hV.default)(y?"rbc-background-event":"rbc-event",n,F.className,{"rbc-selected":a,"rbc-event-continues-earlier":m,"rbc-event-continues-later":u})},C))}Gl.default=gV;var nr={},Jy=Qn.default;Object.defineProperty(nr,"__esModule",{value:!0});nr.dragAccessors=void 0;nr.eventTimes=kV;nr.mergeComponents=_V;nr.pointInColumn=DV;var yV=Jy(Ur),bV=Jy(Vu),Zf=io,NV=A,xV=["children"];nr.dragAccessors={start:(0,Zf.wrapAccessor)(function(t){return t.start}),end:(0,Zf.wrapAccessor)(function(t){return t.end})};function vV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s=function(i){var a=i.children,c=(0,bV.default)(i,xV);return e.filter(Boolean).reduceRight(function(m,u){return(0,NV.createElement)(u,c,m)},a)};return s}function _V(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=Object.keys(e),s=(0,yV.default)({},t);return n.forEach(function(r){s[r]=t[r]?vV(t[r],e[r]):e[r]}),s}function DV(t,e){var n=t.left,s=t.right,r=t.top,i=e.x,a=e.y;return i<s+10&&i>n&&a>r}function kV(t,e,n){var s=e.start(t),r=e.end(t),i=n.eq(s,r,"minutes")&&n.diff(s,r,"minutes")===0;i&&(r=n.add(r,1,"day"));var a=n.diff(s,r,"milliseconds");return{start:s,end:r,duration:a}}var AV=Sy.default,Hr=Qn.default;Object.defineProperty(Yl,"__esModule",{value:!0});Yl.default=void 0;var ur=Hr(Ur),EV=Hr(ci),VV=Hr(mi),CV=Hr(so),wV=Hr(ro),Sc=ZE,SV=Hr(eV),Kr=Hr(A),IV=ui,dr=AV(Es),PV=Hr(Gl),zs=nr,Zy=function(t){function e(){var n;(0,EV.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,CV.default)(this,e,[].concat(r)),n.handleMove=function(a,c){if(!(0,zs.pointInColumn)(c,a))return n.reset();var m=n.context.draggable.dragAndDropAction.event,u=n.props,d=u.accessors,f=u.slotMetrics,h=f.closestSlotFromPoint({y:a.y-n.eventOffsetTop,x:a.x},c),y=(0,zs.eventTimes)(m,d,n.props.localizer),w=y.duration,_=n.props.localizer.add(h,w,"milliseconds");n.update(m,f.getRange(h,_,!1,!0))},n.handleDropFromOutside=function(a,c){var m=n.props,u=m.slotMetrics,d=m.resource,f=u.closestSlotFromPoint({y:a.y,x:a.x},c),h=n._calculateDnDEnd(f);n.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),n.reset()},n.handleDragOverFromOutside=function(a,c){var m=n.props.slotMetrics,u=m.closestSlotFromPoint({y:a.y,x:a.x},c),d=n._calculateDnDEnd(u),f=n.context.draggable.dragFromOutsideItem();n.update(f,m.getRange(u,d,!1,!0))},n._calculateDnDEnd=function(a){var c=n.props,m=c.accessors,u=c.slotMetrics,d=c.localizer,f=n.context.draggable.dragFromOutsideItem(),h=(0,zs.eventTimes)(f,m,d),y=h.duration,w=u.nextSlot(a),_=!isNaN(y);if(_){var S=d.add(a,y,"milliseconds");w=new Date(Math.max(S,w))}return w},n.updateParentScroll=function(a,c){setTimeout(function(){var m=(0,SV.default)(c,".rbc-addons-dnd-drag-preview")[0];m&&(m.offsetTop<a.scrollTop?(0,Sc.scrollTop)(a,Math.max(m.offsetTop,0)):m.offsetTop+m.offsetHeight>a.scrollTop+a.clientHeight&&(0,Sc.scrollTop)(a,Math.min(m.offsetTop-a.offsetHeight+m.offsetHeight,a.scrollHeight)))})},n._selectable=function(){var a=n.ref.current,c=a.children[0],m=!1,u=n._selector=new dr.default(function(){return a.closest(".rbc-time-view")}),d=(0,Sc.scrollParent)(a);u.on("beforeSelect",function(f){var h=n.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,zs.pointInColumn)((0,dr.getBoundsForNode)(c),f);var y=(0,dr.getEventNodeFromPoint)(c,f);if(!y)return!1;n.eventOffsetTop=f.y-(0,dr.getBoundsForNode)(y).top}),u.on("selecting",function(f){var h=(0,dr.getBoundsForNode)(c),y=n.context.draggable.dragAndDropAction;y.action==="move"&&(n.updateParentScroll(d,c),n.handleMove(f,h)),y.action==="resize"&&(n.updateParentScroll(d,c),n.handleResize(f,h))}),u.on("dropFromOutside",function(f){if(n.context.draggable.onDropFromOutside){var h=(0,dr.getBoundsForNode)(c);(0,zs.pointInColumn)(h,f)&&n.handleDropFromOutside(f,h)}}),u.on("dragOverFromOutside",function(f){var h=n.context.draggable.dragFromOutsideItem?n.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,dr.getBoundsForNode)(c);if(!(0,zs.pointInColumn)(y,f))return n.reset();n.handleDragOverFromOutside(f,y)}}),u.on("selectStart",function(){m=!0,n.context.draggable.onStart()}),u.on("select",function(f){var h=(0,dr.getBoundsForNode)(c);m=!1;var y=n.context.draggable.dragAndDropAction;if(y.action==="resize")n.handleInteractionEnd();else{if(!n.state.event||!(0,zs.pointInColumn)(h,f))return;n.handleInteractionEnd()}}),u.on("click",function(){m&&n.reset(),n.context.draggable.onEnd(null)}),u.on("reset",function(){n.reset(),n.context.draggable.onEnd(null)})},n.handleInteractionEnd=function(){var a=n.props.resource,c=n.state.event;n.reset(),n.context.draggable.onEnd({start:c.start,end:c.end,resourceId:a})},n._teardownSelectable=function(){n._selector&&(n._selector.teardown(),n._selector=null)},n.state={},n.ref=Kr.default.createRef(),n}return(0,wV.default)(e,t),(0,VV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(s,r){var i=r.startDate,a=r.endDate,c=r.top,m=r.height,u=this.state.event;u&&i===u.start&&a===u.end||this.setState({top:c,height:m,event:(0,ur.default)((0,ur.default)({},s),{},{start:i,end:a})})}},{key:"handleResize",value:function(s,r){var i=this.props,a=i.accessors,c=i.slotMetrics,m=i.localizer,u=this.context.draggable.dragAndDropAction,d=u.event,f=u.direction,h=c.closestSlotFromPoint(s,r),y=(0,zs.eventTimes)(d,a,m),w=y.start,_=y.end,S;if(f==="UP"){var R=m.min(h,c.closestSlotFromDate(_,-1));S=c.getRange(R,_),S=(0,ur.default)((0,ur.default)({},S),{},{endDate:_})}else if(f==="DOWN"){var L=m.max(h,c.closestSlotFromDate(w));S=c.getRange(w,L),S=(0,ur.default)((0,ur.default)({},S),{},{startDate:w})}this.update(d,S)}},{key:"renderContent",value:function(){var s=this.props,r=s.children,i=s.accessors,a=s.components,c=s.getters,m=s.slotMetrics,u=s.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var w=r.props.children,_=f.start,S=f.end,R,L="eventTimeRangeFormat",$=m.startsBeforeDay(_),ie=m.startsAfterDay(S);return $?L="eventTimeRangeEndFormat":ie&&(L="eventTimeRangeStartFormat"),$&&ie?R=u.messages.allDay:R=u.format({start:_,end:S},L),Kr.default.cloneElement(r,{children:Kr.default.createElement(Kr.default.Fragment,null,w,f&&Kr.default.createElement(PV.default,{event:f,label:R,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:c,components:a,accessors:(0,ur.default)((0,ur.default)({},i),zs.dragAccessors),continuesPrior:$,continuesAfter:ie}))})}},{key:"render",value:function(){return Kr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Kr.default.Component);Zy.contextType=IV.DnDContext;Yl.default=Zy;var Jl={},eb={exports:{}},tb={exports:{}},nb={exports:{}};(function(t){function e(n,s){(s==null||s>n.length)&&(s=n.length);for(var r=0,i=Array(s);r<s;r++)i[r]=n[r];return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(nb);var sb=nb.exports;(function(t){var e=sb;function n(s){if(Array.isArray(s))return e(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(tb);var LV=tb.exports,rb={exports:{}};(function(t){function e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(rb);var TV=rb.exports,ib={exports:{}};(function(t){var e=sb;function n(s,r){if(s){if(typeof s=="string")return e(s,r);var i={}.toString.call(s).slice(8,-1);return i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set"?Array.from(s):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(s,r):void 0}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ib);var jV=ib.exports,ob={exports:{}};(function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ob);var RV=ob.exports;(function(t){var e=LV,n=TV,s=jV,r=RV;function i(a){return e(a)||n(a)||s(a)||r()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports})(eb);var ab=eb.exports,Zl={},ec={},tc={},Mr=Qn.default;Object.defineProperty(tc,"__esModule",{value:!0});tc.default=void 0;var ep=Mr(Ur),BV=Mr(Vu),UV=Mr(ci),HV=Mr(mi),MV=Mr(so),FV=Mr(ro),Ao=Mr(A),OV=Mr(ha),qV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],$V=function(t){function e(){return(0,UV.default)(this,e),(0,MV.default)(this,e,arguments)}return(0,FV.default)(e,t),(0,HV.default)(e,[{key:"render",value:function(){var s=this.props,r=s.style,i=s.className,a=s.event,c=s.selected,m=s.isAllDay,u=s.onSelect,d=s.onDoubleClick,f=s.onKeyPress,h=s.localizer,y=s.continuesPrior,w=s.continuesAfter,_=s.accessors,S=s.getters,R=s.children,L=s.components,$=L.event,ie=L.eventWrapper,ee=s.slotStart,F=s.slotEnd,C=(0,BV.default)(s,qV);delete C.resizable;var N=_.title(a),V=_.tooltip(a),j=_.end(a),P=_.start(a),I=_.allDay(a),k=m||I||h.diff(P,h.ceil(j,"day"),"day")>1,ke=S.eventProp(a,P,j,c),Be=Ao.default.createElement("div",{className:"rbc-event-content",title:V||void 0},$?Ao.default.createElement($,{event:a,continuesPrior:y,continuesAfter:w,title:N,isAllDay:I,localizer:h,slotStart:ee,slotEnd:F}):N);return Ao.default.createElement(ie,Object.assign({},this.props,{type:"date"}),Ao.default.createElement("div",Object.assign({},C,{style:(0,ep.default)((0,ep.default)({},ke.style),r),className:(0,OV.default)("rbc-event",i,ke.className,{"rbc-selected":c,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":w}),onClick:function(je){return u&&u(a,je)},onDoubleClick:function(je){return d&&d(a,je)},onKeyDown:function(je){return f&&f(a,je)}}),typeof R=="function"?R(Be):Be))}}])}(Ao.default.Component);tc.default=$V;var Fr={},WV=Qn.default;Object.defineProperty(Fr,"__esModule",{value:!0});Fr.dateCellSelection=YV;Fr.getSlotAtX=lb;Fr.isSelected=KV;Fr.pointInBox=QV;Fr.slotWidth=Iu;var zV=WV(Gb);function KV(t,e){return!t||e==null?!1:(0,zV.default)(t,e)}function Iu(t,e){var n=t.right-t.left,s=n/e;return s}function lb(t,e,n,s){var r=Iu(t,s);return n?s-1-Math.floor((e-t.left)/r):Math.floor((e-t.left)/r)}function QV(t,e){var n=e.x,s=e.y;return s>=t.top&&s<=t.bottom&&n>=t.left&&n<=t.right}function YV(t,e,n,s,r){var i=-1,a=-1,c=s-1,m=Iu(e,s),u=lb(e,n.x,r,s),d=e.top<n.y&&e.bottom>n.y,f=e.top<t.y&&e.bottom>t.y,h=t.y>e.bottom,y=e.top>t.y,w=n.top<e.top&&n.bottom>e.bottom;return w&&(i=0,a=c),d&&(y?(i=0,a=u):h&&(i=u,a=c)),f&&(i=a=r?c-Math.floor((t.x-e.left)/m):Math.floor((t.x-e.left)/m),d?u<i?i=u:a=u:t.y<n.y?a=c:i=0),{startIdx:i,endIdx:a}}var Pu=Qn.default;Object.defineProperty(ec,"__esModule",{value:!0});ec.default=void 0;var Ps=Pu(dp),tp=Pu(A),GV=Pu(tc),XV=Fr;ec.default={propTypes:{slotMetrics:Ps.default.object.isRequired,selected:Ps.default.object,isAllDay:Ps.default.bool,accessors:Ps.default.object.isRequired,localizer:Ps.default.object.isRequired,components:Ps.default.object.isRequired,getters:Ps.default.object.isRequired,onSelect:Ps.default.func,onDoubleClick:Ps.default.func,onKeyPress:Ps.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,n){var s=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,a=e.onSelect,c=e.onDoubleClick,m=e.onKeyPress,u=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(n),w=d.continuesAfter(n);return tp.default.createElement(GV.default,{event:n,getters:i,localizer:u,accessors:r,components:f,onSelect:a,onDoubleClick:c,onKeyPress:m,continuesPrior:y,continuesAfter:w,slotStart:d.first,slotEnd:d.last,selected:(0,XV.isSelected)(n,s),resizable:h})},renderSpan:function(e,n,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(n)/e*100+"%";return tp.default.createElement("div",{key:s,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Or=Qn.default;Object.defineProperty(Zl,"__esModule",{value:!0});Zl.default=void 0;var JV=Or(Ur),ZV=Or(ci),eC=Or(mi),tC=Or(so),nC=Or(ro),sC=Or(ha),np=Or(A),Za=Or(ec),cb=function(t){function e(){return(0,ZV.default)(this,e),(0,tC.default)(this,e,arguments)}return(0,nC.default)(e,t),(0,eC.default)(e,[{key:"render",value:function(){var s=this,r=this.props,i=r.segments,a=r.slotMetrics.slots,c=r.className,m=1;return np.default.createElement("div",{className:(0,sC.default)(c,"rbc-row")},i.reduce(function(u,d,f){var h=d.event,y=d.left,w=d.right,_=d.span,S="_lvl_"+f,R=y-m,L=Za.default.renderEvent(s.props,h);return R&&u.push(Za.default.renderSpan(a,R,"".concat(S,"_gap"))),u.push(Za.default.renderSpan(a,_,S,L)),m=w+1,u},[]))}}])}(np.default.Component);cb.defaultProps=(0,JV.default)({},Za.default.defaultProps);Zl.default=cb;var sr={},mb=Qn.default;Object.defineProperty(sr,"__esModule",{value:!0});sr.endOfRange=ub;sr.eventLevels=oC;sr.eventSegments=iC;sr.inRange=aC;sr.segsOverlap=db;sr.sortEvents=gm;sr.sortWeekEvents=lC;var Ic=mb(ab),rC=mb(Xb);function ub(t){var e=t.dateRange,n=t.unit,s=n===void 0?"day":n,r=t.localizer;return{first:e[0],last:r.add(e[e.length-1],1,s)}}function iC(t,e,n,s){var r=ub({dateRange:e,localizer:s}),i=r.first,a=r.last,c=s.diff(i,a,"day"),m=s.max(s.startOf(n.start(t),"day"),i),u=s.min(s.ceil(n.end(t),"day"),a),d=(0,rC.default)(e,function(h){return s.isSameDate(h,m)}),f=s.diff(m,u,"day");return f=Math.min(f,c),f=Math.max(f-s.segmentOffset,1),{event:t,span:f,left:d+1,right:Math.max(d+f,1)}}function oC(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,n,s,r,i=[],a=[];for(n=0;n<t.length;n++){for(r=t[n],s=0;s<i.length&&db(r,i[s]);s++);s>=e?a.push(r):(i[s]||(i[s]=[])).push(r)}for(n=0;n<i.length;n++)i[n].sort(function(c,m){return c.left-m.left});return{levels:i,extra:a}}function aC(t,e,n,s,r){var i={start:s.start(t),end:s.end(t)},a={start:e,end:n};return r.inEventRange({event:i,range:a})}function db(t,e){return e.some(function(n){return n.left<=t.right&&n.right>=t.left})}function lC(t,e,n){var s=(0,Ic.default)(t),r=[],i=[];s.forEach(function(m){var u=e.start(m),d=e.end(m);n.daySpan(u,d)>1?r.push(m):i.push(m)});var a=r.sort(function(m,u){return gm(m,u,e,n)}),c=i.sort(function(m,u){return gm(m,u,e,n)});return[].concat((0,Ic.default)(a),(0,Ic.default)(c))}function gm(t,e,n,s){var r={start:n.start(t),end:n.end(t),allDay:n.allDay(t)},i={start:n.start(e),end:n.end(e),allDay:n.allDay(e)};return s.sortEvents({evtA:r,evtB:i})}var cC=Sy.default,qr=Qn.default;Object.defineProperty(Jl,"__esModule",{value:!0});Jl.default=void 0;var Ua=qr(Ur),mC=qr(ab),uC=qr(ci),dC=qr(mi),fC=qr(so),pC=qr(ro),Ha=qr(A),hC=qr(Zl),Ii=cC(Es),gC=sr,fr=Fr,Ma=nr,yC=ui,fb=function(t){function e(){var n;(0,uC.default)(this,e);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return n=(0,fC.default)(this,e,[].concat(r)),n.handleMove=function(a,c,m){if(!(0,fr.pointInBox)(c,a))return n.reset();var u=n.context.draggable.dragAndDropAction.event||m,d=n.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,w=d.localizer,_=(0,fr.getSlotAtX)(c,a.x,y,h.slots),S=h.getDateForSlot(_),R=(0,Ma.eventTimes)(u,f,w),L=R.start,$=R.duration;L=w.merge(S,L);var ie=w.add(L,$,"milliseconds");n.update(u,L,ie)},n.handleDropFromOutside=function(a,c){if(n.context.draggable.onDropFromOutside){var m=n.props,u=m.slotMetrics,d=m.rtl,f=m.localizer,h=(0,fr.getSlotAtX)(c,a.x,d,u.slots),y=u.getDateForSlot(h);n.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},n.handleDragOverFromOutside=function(a,c){var m=n.context.draggable.dragFromOutsideItem?n.context.draggable.dragFromOutsideItem():null;m&&n.handleMove(a,c,m)},n._selectable=function(){var a=n.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),c=a.closest(".rbc-month-view, .rbc-time-view"),m=a.classList.contains("rbc-month-row"),u=n._selector=new Ii.default(function(){return c},{validContainers:(0,mC.default)(m?[]:[".rbc-day-slot",".rbc-allday-cell"])});u.on("beforeSelect",function(d){var f=n.props.isAllDay,h=n.context.draggable.dragAndDropAction.action,y=(0,Ii.getBoundsForNode)(a),w=(0,fr.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||w)}),u.on("selecting",function(d){var f=(0,Ii.getBoundsForNode)(a),h=n.context.draggable.dragAndDropAction;h.action==="move"&&n.handleMove(d,f),h.action==="resize"&&n.handleResize(d,f)}),u.on("selectStart",function(){return n.context.draggable.onStart()}),u.on("select",function(d){var f=(0,Ii.getBoundsForNode)(a);n.state.segment&&((0,fr.pointInBox)(f,d)?n.handleInteractionEnd():n.reset())}),u.on("dropFromOutside",function(d){if(n.context.draggable.onDropFromOutside){var f=(0,Ii.getBoundsForNode)(a);(0,fr.pointInBox)(f,d)&&n.handleDropFromOutside(d,f)}}),u.on("dragOverFromOutside",function(d){if(n.context.draggable.dragFromOutsideItem){var f=(0,Ii.getBoundsForNode)(a);n.handleDragOverFromOutside(d,f)}}),u.on("click",function(){return n.context.draggable.onEnd(null)}),u.on("reset",function(){n.reset(),n.context.draggable.onEnd(null)})},n.handleInteractionEnd=function(){var a=n.props,c=a.resourceId,m=a.isAllDay,u=n.state.segment.event;n.reset(),n.context.draggable.onEnd({start:u.start,end:u.end,resourceId:c,isAllDay:m})},n._teardownSelectable=function(){n._selector&&(n._selector.teardown(),n._selector=null)},n.state={},n.ref=Ha.default.createRef(),n}return(0,pC.default)(e,t),(0,dC.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(s,r,i){var a=(0,gC.eventSegments)((0,Ua.default)((0,Ua.default)({},s),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Ma.dragAccessors,this.props.localizer),c=this.state.segment;c&&a.span===c.span&&a.left===c.left&&a.right===c.right||this.setState({segment:a})}},{key:"handleResize",value:function(s,r){var i=this.context.draggable.dragAndDropAction,a=i.event,c=i.direction,m=this.props,u=m.accessors,d=m.slotMetrics,f=m.rtl,h=m.localizer,y=(0,Ma.eventTimes)(a,u,h),w=y.start,_=y.end,S=(0,fr.getSlotAtX)(r,s.x,f,d.slots),R=d.getDateForSlot(S),L=(0,fr.pointInBox)(r,s);if(c==="RIGHT"){if(L){if(d.last<w)return this.reset();h.eq(h.startOf(_,"day"),_)?_=h.add(R,1,"day"):_=R}else if(h.inRange(w,d.first,d.last)||r.bottom<s.y&&+d.first>+w)_=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var $=u.end(a);_=h.merge(_,$),h.lt(_,w)&&(_=$)}else if(c==="LEFT"){if(L){if(d.first>_)return this.reset();w=R}else if(h.inRange(_,d.first,d.last)||r.top>s.y&&h.lt(d.last,_))w=h.add(d.first,-1,"milliseconds");else{this.reset();return}var ie=u.start(a);w=h.merge(w,ie),h.gt(w,_)&&(w=ie)}this.update(a,w,_)}},{key:"render",value:function(){var s=this.props,r=s.children,i=s.accessors,a=this.state.segment;return Ha.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,a&&Ha.default.createElement(hC.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[a],accessors:(0,Ua.default)((0,Ua.default)({},i),Ma.dragAccessors)})))}}])}(Ha.default.Component);fb.contextType=yC.DnDContext;Jl.default=fb;var Vs=Qn.default;Object.defineProperty(Eu,"__esModule",{value:!0});Eu.default=SC;var Fa=Vs(Ur),bC=Vs(Vu),NC=Vs(ci),xC=Vs(mi),vC=Vs(so),_C=Vs(ro),Pc=Vs(A),DC=Vs(ha),kC=Vs(Ql),AC=Vs(Yl),EC=Vs(Jl),VC=nr,CC=ui,wC=["selectable","elementProps","components"];function SC(t){var e=function(n){function s(){var r;(0,NC.default)(this,s);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return r=(0,vC.default)(this,s,[].concat(a)),r.defaultOnDragOver=function(m){m.preventDefault()},r.handleBeginAction=function(m,u,d){r.setState({event:m,action:u,direction:d});var f=r.props.onDragStart;f&&f({event:m,action:u,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(m){var u=r.state,d=u.action,f=u.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),m!=null)){m.event=f;var h=r.props,y=h.onEventDrop,w=h.onEventResize;d==="move"&&y&&y(m),d==="resize"&&w&&w(m)}},r.state={interacting:!1},r}return(0,_C.default)(s,n),(0,xC.default)(s,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,a=i.selectable,c=i.elementProps,m=i.components,u=(0,bC.default)(i,wC),d=this.state.interacting;delete u.onEventDrop,delete u.onEventResize,u.selectable=a?"ignoreEvents":!1,this.components=(0,VC.mergeComponents)(m,{eventWrapper:kC.default,eventContainerWrapper:AC.default,weekWrapper:EC.default});var f=this.props.onDropFromOutside?(0,Fa.default)((0,Fa.default)({},c),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):c;u.className=(0,DC.default)(u.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return Pc.default.createElement(CC.DnDContext.Provider,{value:h},Pc.default.createElement(t,Object.assign({},u,{elementProps:f,components:this.components})))}}])}(Pc.default.Component);return e.defaultProps=(0,Fa.default)((0,Fa.default)({},t.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var IC=Qn.default;Object.defineProperty(Au,"__esModule",{value:!0});var pb=Au.default=void 0,PC=IC(Eu);pb=Au.default=PC.default;const hr={async getAllProcesses(){try{const t=qe(ne,"processes"),e=xt(t,on("order","asc")),n=await Vt(e);return n.empty?this.getDefaultProcesses():n.docs.map(s=>{const r=s.data();return{id:parseInt(s.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(t){return console.error("[Firestore]    :",t),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,n)=>({id:n+1,name:e,order:n,isDefault:!0}))},async createProcess(t,e){try{const n=qe(ne,"processes"),s=await Vt(n);let r=0;s.docs.forEach(m=>{const u=parseInt(m.id);!isNaN(u)&&u>r&&(r=u)});const i=r+1,a=we(ne,"processes",String(i)),c=new Date().toISOString();return await ri(a,{name:t,order:e,isDefault:!1,createdAt:c,updatedAt:sn()}),console.log(" [Firestore]   :",i),{id:i,name:t,order:e,isDefault:!1,createdAt:c}}catch(n){throw console.error("[Firestore]   :",n),new Error(`  : ${n.message||"   "}`)}},async updateProcess(t,e){try{const n=we(ne,"processes",String(t)),s=await Pt(n);if(!s.exists())throw new Error("   .");const r=s.data(),i={updatedAt:sn()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Ut(n,i),console.log(" [Firestore]   :",t),{id:t,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(n){throw console.error("[Firestore]   :",n),new Error(`  : ${n.message||"   "}`)}},async deleteProcess(t){try{const e=we(ne,"processes",String(t));await Un(e),console.log(" [Firestore]   :",t)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(t){try{const e=t.map((n,s)=>{const r=we(ne,"processes",String(n));return Ut(r,{order:s,updatedAt:sn()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(t){const e=qe(ne,"processes"),n=xt(e,on("order","asc"));return us(n,r=>{if(r.empty){t(hr.getDefaultProcesses());return}const i=r.docs.map(a=>{const c=a.data();return{id:parseInt(a.id)||0,name:c.name||"",order:c.order||0,isDefault:c.isDefault||!1}});t(i)})}},LC={getAllProcesses:()=>hr.getAllProcesses(),createProcess:(t,e)=>hr.createProcess(t,e),updateProcess:(t,e)=>hr.updateProcess(t,e),deleteProcess:t=>hr.deleteProcess(t),reorderProcesses:t=>hr.reorderProcesses(t),subscribeToProcesses:hr.subscribeToProcesses,getDefaultProcesses:hr.getDefaultProcesses},TC=pb(Jb),jC=pE;nt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:t=>t<12?"":"",week:{dow:0,doy:1}});nt.locale("ko");const RC=Zb(nt),sp=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],BC=it.memo(({onSave:t,onCancel:e,processList:n})=>{const[s,r]=A.useState(""),i=()=>{const u=window.innerWidth,d=window.innerHeight;return u>=768&&u<1024||u>=1024&&d>u},[a,c]=A.useState(i);A.useEffect(()=>{const u=()=>c(i());return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const m=a?"16px":"18px";return o.jsxDEV("div",{className:"w-full",onClick:u=>u.stopPropagation(),style:{padding:a?"2px 3px":"6px 0",minHeight:a?"28px":"32px"},children:[o.jsxDEV("input",{type:"text",list:"process-suggestions",value:s,onChange:u=>r(u.target.value),onBlur:()=>{s.trim()?t(s.trim()):e()},onKeyDown:u=>{u.stopPropagation(),u.key==="Enter"?s.trim()?t(s.trim()):e():u.key==="Escape"&&e()},onClick:u=>u.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:m,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),n&&o.jsxDEV("datalist",{id:"process-suggestions",children:n.map(u=>o.jsxDEV("option",{value:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),rp=t=>t,Fo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},UC=it.memo(({date:t,label:e,filteredEvents:n,selectedDate:s,user:r,isMobileView:i})=>{const a=nt(t).format("YYYY-MM-DD"),c=Fo[a],m=!!Fo[a],u=s&&nt(t).isSame(s,"day"),d=n.filter(F=>nt(F.start).isSame(t,"day")),f=d.length,h=d.filter(F=>F.assignedTo&&F.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,w=e.replace(/^0/,""),_=t.getDay()===0,S=t.getDay()===6;let R="#000000";m||_?R="#dc2626":S&&(R="#3b82f6");const L=nt(t).isSame(nt(),"day");let $="#d1d5db";m||_?$="#fecaca":S&&($="#bfdbfe");const ie=w.length===2,ee=i?{backgroundColor:"transparent",color:R,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:L?"700":"400",border:u?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:R,fontWeight:L?"700":"400",paddingLeft:ie?"0px":"4px",...L&&{backgroundColor:$,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return o.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?o.jsxDEV("span",{style:ee,children:[o.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&o.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((F,C)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((F,C)=>o.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{style:ee,children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),c&&o.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:c},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),HC=it.memo(({event:t,user:e,filterProject:n,isEditing:s,editTitle:r,onEditTitleChange:i,onEditSave:a,onEditDelete:c,onEditCancel:m,onHoverDelete:u,onDeleteAction:d,processList:f})=>{const h=n&&n!=="all",y=t.assignedTo||[],[w,_]=A.useState(!1),S=it.useRef(null),R=()=>{const pe=window.innerWidth,je=window.innerHeight;return pe>=768&&pe<1024||pe>=1024&&je>pe},[L,$]=A.useState(R),[ie,ee]=A.useState(!1);it.useRef(null),it.useRef(!1);const[F,C]=A.useState(r||""),N=it.useRef(s);A.useEffect(()=>{s&&!N.current&&r!==void 0&&C(r),N.current=s},[s,r]);const V=e!=null&&e.name?e.name.slice(-2):null,j=V&&["",""].includes(V),P=V&&["","",""].includes(V),I=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&P||y.includes("")&&j);A.useEffect(()=>{const pe=()=>{$(R())};return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const k=pe=>{C(pe)},ke=()=>{F!=null&&F.trim()&&a&&(i&&i(F),a()),m&&m()},Be=pe=>{pe.stopPropagation(),(pe.key==="Enter"||pe.key==="Escape")&&pe.currentTarget.blur()};return L?o.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{ee(!0),_(!0)},onMouseLeave:()=>{ee(!1),_(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[w&&h&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:o.jsxDEV("button",{ref:S,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!t.isASVisit&&t.projectName?o.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",rp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):o.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&o.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((pe,je)=>{const ut=pe==="HV LAB"||pe===""&&j||pe===""&&P||pe===(e==null?void 0:e.name);return o.jsxDEV(it.Fragment,{children:[o.jsxDEV("span",{style:{fontWeight:ut?"bold":"normal"},children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),je<y.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),s?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:F,onChange:pe=>k(pe.target.value),onBlur:ke,onKeyDown:Be,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):o.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:t.title,children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),ie&&o.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[o.jsxDEV("div",{className:"font-semibold mb-1",children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),t.projectName&&o.jsxDEV("div",{className:"opacity-90",children:[": ",t.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&o.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):o.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[o.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!t.isASVisit&&t.projectName&&o.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",rp(t.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),s?o.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:F,onChange:pe=>k(pe.target.value),onBlur:ke,onKeyDown:Be,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):o.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:I?"underline":"none",textDecorationColor:I?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:t.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&o.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((pe,je)=>{const ut=pe==="HV LAB"||pe===""&&j||pe===""&&P||pe===(e==null?void 0:e.name);return o.jsxDEV(it.Fragment,{children:[o.jsxDEV("span",{className:ut?"font-bold":"",children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),je<y.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),w&&h&&u&&!t.isASVisit&&!t.isExpectedPayment&&o.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:o.jsxDEV("button",{ref:S,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),u()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&s&&o.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(pe=>o.jsxDEV("option",{value:pe},pe,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),MC=()=>{const{schedules:t,setSchedules:e,addSchedule:n,deleteSchedule:s,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:a,deleteScheduleFromAPI:c,asRequests:m,updateASRequestInAPI:u,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=Gs(),{user:y}=Br(),w=Kl(),[_,S]=A.useState(!1);A.useEffect(()=>{const b=()=>{const M=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;S(M)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const R=b=>!b||b==="-"?"":_?b:dm(b),L=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",L);const $=it.useRef(!1);A.useEffect(()=>{$.current||($.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),te.error("  ")}))},[r]);const[ie,ee]=A.useState([]);A.useEffect(()=>{const b=async M=>{if((M.ctrlKey||M.metaKey)&&M.key==="z"){const G=M.target;if(G.tagName==="INPUT"||G.tagName==="TEXTAREA"||G.isContentEditable)return;if(ie.length>0){M.preventDefault();const K=ie[ie.length-1];try{const le=K.type==="as_visit"||K.type==="expected_payment"?"other":K.type;await i({id:"",title:K.originalTitle||K.title,start:K.start,end:K.end,type:le,project:K.originalProjectName||K.projectName,attendees:K.assignedTo||[],time:K.time,description:K.description}),ee(ge=>ge.slice(0,-1)),te.success(" ")}catch(le){console.error("  :",le),te.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[ie,i]);const[F,C]=A.useState([]),[N,V]=A.useState(!1),[j,P]=A.useState(""),[I,k]=A.useState(null),[ke,Be]=A.useState(""),[pe,je]=A.useState(!1),[ut,qt]=A.useState(null),[Mt,ae]=A.useState(null),Ue=A.useCallback(async()=>{je(!0);try{const b=await LC.getAllProcesses();C(b)}catch(b){console.error("   :",b),C([])}finally{je(!1)}},[]);A.useEffect(()=>{Ue()},[Ue]);const fe=A.useMemo(()=>F.length>0?F.map(b=>b.name):jC,[F]),Le=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)P(""),Ue(),te.success(" ");else{const M=await b.json();te.error(M.error||"  ")}}catch(b){console.error("  :",b),te.error("  ")}},Ke=async()=>{if(!(!I||!ke.trim()))try{const b=await fetch(`/api/processes/${I.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ke.trim()})});if(b.ok)k(null),Be(""),Ue(),te.success(" ");else{const M=await b.json();te.error(M.error||"  ")}}catch(b){console.error("  :",b),te.error("  ")}},bt=async b=>{if(confirm("   ?"))try{const M=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(M.ok)Ue(),te.success(" ");else{const G=await M.json();te.error(G.error||"  ")}}catch(M){console.error("  :",M),te.error("  ")}},st=b=>{qt(b)},Ct=(b,M)=>{b.preventDefault(),ut!==null&&ut!==M&&ae(M)},lt=async()=>{if(ut!==null&&Mt!==null&&ut!==Mt){const b=[...F],[M]=b.splice(ut,1);b.splice(Mt,0,M),C(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(K=>({id:K.id}))})})).ok||(Ue(),te.error("  "))}catch(G){console.error("  :",G),Ue(),te.error("  ")}}qt(null),ae(null)},ct=b=>{const M=w.findIndex(G=>G.name===b);return M>=0?sp[M%sp.length]:"#e8e2ea"},cn=w.map(b=>b.name),Q=t.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||cn.includes(b.project):!0).map(b=>{const M=w.find(he=>he.name===b.project);let G=b.project===""?"[]":b.project;if(M&&b.project!==""){const he=M.name.length>2?M.name.substring(0,2):M.name,gt=(M.location||"").match(/([A-Za-z]?\d+)/),hn=gt?gt[1]:"";G=hn?`${he}_${hn}`:he}const K=b.time,le=K&&K!=="-"?` - ${R(K)}`:"",ge=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(M==null?void 0:M.id)||"",projectName:G||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:ge,priority:"medium",allDay:!K||K==="-",color:ct(b.project||""),isASVisit:!1,time:K,description:b.description}}),Pe=m.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?cn.includes(b.project):!0).map(b=>{const M=b.scheduledVisitTime,G=M&&M!=="-"?` - ${R(M)}`:"",K=w.find(he=>he.name===b.project);let le=b.project;if(K){const he=K.name.length>2?K.name.substring(0,2):K.name,gt=(K.location||"").match(/([A-Za-z]?\d+)/),hn=gt?gt[1]:"";le=hn?`${he}_${hn}`:he}const ge=`[AS] ${le}`;return{id:`as-${b.id}`,title:ge+G,originalTitle:ge,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(K==null?void 0:K.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(he=>he.trim()):[],priority:"high",allDay:!M||M==="-",color:"#FEF3C7",isASVisit:!0,time:M,description:b.description}}),Oe=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var ge,he,rt,gt,hn,St,It,tn;const M=w.find(kn=>kn.name===b.project);if(!M){const kn=[],kt=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),Jt=new Set(b.payments.flatMap(dn=>{var Wt;return((Wt=dn.type)==null?void 0:Wt.split(", ").map(zt=>zt.trim()))||[]}));return!Jt.has("")&&((ge=b.expectedPaymentDates)!=null&&ge.contract)&&kn.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),!Jt.has("")&&((he=b.expectedPaymentDates)!=null&&he.start)&&kn.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Jt.has("")&&((rt=b.expectedPaymentDates)!=null&&rt.middle)&&kn.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(kt*.4).toLocaleString()}`}),!Jt.has("")&&((gt=b.expectedPaymentDates)!=null&&gt.final)&&kn.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(kt*.1).toLocaleString()}`}),kn}if(!M.startDate||!M.endDate)return[];const G=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),K=new Set(b.payments.flatMap(kn=>{var kt;return((kt=kn.type)==null?void 0:kt.split(", ").map(Jt=>Jt.trim()))||[]})),le=[];return!K.has("")&&((hn=b.expectedPaymentDates)!=null&&hn.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:M.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(G*.1).toLocaleString()}`}),!K.has("")&&((St=b.expectedPaymentDates)!=null&&St.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:M.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(G*.4).toLocaleString()}`}),!K.has("")&&((It=b.expectedPaymentDates)!=null&&It.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:M.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(G*.4).toLocaleString()}`}),!K.has("")&&((tn=b.expectedPaymentDates)!=null&&tn.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:M.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(G*.1).toLocaleString()}`}),le}):[],Ie=[...Q,...Pe,...Oe],He=A.useCallback(b=>{if(!(y!=null&&y.name))return!1;const M=b.assignedTo||[],G=y.name.slice(-2),K=["",""].includes(G),le=["","",""].includes(G);return M.includes(y.name)||M.includes("HV LAB")||M.includes("")&&le||M.includes("")&&K},[y==null?void 0:y.name]),Tt=(b,M)=>{if(!M)return[...b].sort((le,ge)=>{const he=He(le),rt=He(ge);return he&&!rt?-1:!he&&rt?1:le.start.getTime()-ge.start.getTime()});const G=new Map;b.forEach(le=>{const ge=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ge){const he=`single_${le.id}`;G.set(he,[le])}else{const he=le.start.toISOString().split("T")[0],rt=[...le.assignedTo].sort().join(","),gt=`${he}_${le.projectName}_${rt}`;G.has(gt)||G.set(gt,[]),G.get(gt).push(le)}});const K=[];return G.forEach(le=>{if(le.length===1)K.push(le[0]);else{const ge=le[0],he=le.map(It=>It.originalTitle||It.title),rt=[...new Set(he)],gt=le.map(It=>{const tn=It.originalTitle||It.title;return tn.startsWith(ge.projectName+" - ")?tn.substring(ge.projectName.length+3):tn}),hn=[...new Set(gt)],St={...ge,id:le[0].id,title:hn.join(", "),originalTitle:rt.join(", "),description:le.map(It=>It.description||It.originalTitle||It.title).join(`
`),assignedTo:[...new Set(le.flatMap(It=>It.assignedTo))],mergedEventIds:le.map(It=>It.id)};K.push(St)}}),K.sort((le,ge)=>{const he=He(le),rt=He(ge);return he&&!rt?-1:!he&&rt?1:le.start.getTime()-ge.start.getTime()})},[Ft,dt]=A.useState("month"),[T,O]=A.useState(new Date),[Z,ye]=A.useState(!1),[me,de]=A.useState(null),[Ve,Xe]=A.useState(null),Ge=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[ve,jn]=A.useState(()=>{const b=localStorage.getItem(Ge);return b||((y==null?void 0:y.name)===""&&w.length>0?w[0].name:"all")});A.useEffect(()=>{localStorage.setItem(Ge,ve)},[ve,Ge]),A.useCallback(()=>{document.body.classList.add("printing-schedule");const b=ve==="all"?" ":ve,M=nt(T).format("YYYY MM"),G=document.title;document.title=`${b} - ${M} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=G},100)},[ve,T]);const jt=Tt(Ie,ve==="all"),[ot,re]=A.useState(window.innerWidth<768?new Date:null),[B,be]=A.useState(null),Ae=it.useRef(null),Re=it.useRef(!1),[ue,Lt]=A.useState(null),Dt=it.useRef(!1),Rt=it.useRef(!1);A.useEffect(()=>{const b=K=>{K.key==="Control"&&(Rt.current=!0)},M=K=>{K.key==="Control"&&(Rt.current=!1)},G=()=>{Rt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",M),window.addEventListener("blur",G),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",M),window.removeEventListener("blur",G)}},[]),A.useEffect(()=>{if(!B)return;let b=null;const M=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy")},G=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy");const rt=ge.target.closest(".rbc-day-bg");b&&b!==rt&&(b.style.backgroundColor=""),rt&&(rt.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=rt)},K=()=>{b&&(b.style.backgroundColor="",b=null)},le=ge=>{ge.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",M),document.addEventListener("dragover",G),document.addEventListener("dragend",K),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",M),document.removeEventListener("dragover",G),document.removeEventListener("dragend",K),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[B]);const[Nt,mn]=A.useState(null),[en,Sn]=A.useState(null),[ds,Yn]=A.useState(""),[fs,$r]=A.useState(!1),[Cs,es]=A.useState(null),[ws,Rn]=A.useState(!1),[v,x]=A.useState(""),[E,U]=A.useState(null),[H,X]=A.useState({x:0,y:0}),[W,q]=A.useState({x:0,y:0}),[Y,oe]=A.useState(!1),Se=8;A.useEffect(()=>{if(!E)return;const b=G=>{X({x:G.clientX,y:G.clientY});const K=Math.abs(G.clientX-W.x),le=Math.abs(G.clientY-W.y);(K>Se||le>Se)&&oe(!0)},M=()=>{U(null),oe(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",M),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",M)}},[E,W]);const We=it.useRef(!1),Je=A.useCallback(async({event:b,start:M,end:G})=>{if(b.isASVisit||b.isExpectedPayment){te.error("    ");return}const K=M instanceof Date?M:new Date(M),le=G instanceof Date?G:new Date(G);if(Rt.current)try{const he=b.mergedEventIds||[b.id],rt=t.filter(gt=>he.includes(gt.id));for(const gt of rt)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:gt.title,start:K,end:le,project:gt.project,attendees:gt.attendees||[],time:gt.time,priority:gt.priority||"medium"});te.success(" ")}catch(he){console.error("  :",he),te.error("  ")}else{const he=b.mergedEventIds||[b.id];try{for(const rt of he)await a(rt,{start:K,end:le})}catch(rt){console.error("  :",rt),te.error("  "),r()}}},[t,a,i,r]),_e=A.useCallback(({event:b,action:M})=>{var K;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const G=document.querySelectorAll(".rbc-event");for(const le of G)if((K=le.textContent)!=null&&K.includes(b.originalTitle||b.title)){const ge=le.getBoundingClientRect();q({x:ge.left,y:ge.top}),X({x:ge.left,y:ge.top});break}oe(!1),U(b)},[]),Qe=A.useCallback(async(b,M,G=!1)=>{if(ve==="all"){te.error("  ");return}const K={id:"",title:b,start:M,end:M,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(K)}catch(le){console.error("  :",le),te.error("  ")}},[ve,i,y]),wt=A.useCallback(({start:b})=>{const M=B||Ae.current;M&&ve!=="all"&&(Re.current=!0,Dt.current=!0,requestAnimationFrame(()=>{Dt.current=!1}),mn(null),Sn(null),Yn(""),Qe(M,b),requestAnimationFrame(()=>{be(null),Ae.current=null,Re.current=!1}))},[B,ve,Qe]),Qt=A.useCallback(()=>{const b=B||Ae.current;return b?{title:b}:null},[B]),On=A.useCallback(async b=>{if(!b.trim()||!Nt||ve==="all"){mn(null);return}const M=Nt;mn(null);const G={id:"",title:b.trim(),start:M,end:M,type:"construction",project:ve,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(G)}catch(K){console.error("  :",K),te.error("  ")}},[Nt,ve,i,y]),Xt=A.useCallback(()=>{mn(null)},[]),ts=A.useCallback(async()=>{var b;if(!en||!ds.trim()){Sn(null),Yn("");return}try{const M=((b=en.mergedEventIds)==null?void 0:b[0])||en.id;await a(M,{title:ds.trim()})}catch(M){console.error("  :",M),te.error("  ")}Sn(null),Yn("")},[en,ds,a]),qn=A.useCallback(async b=>{ee(G=>[...G,b]);const M=b.mergedEventIds||[b.id];te.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(M.map(G=>c(G)))}catch(G){console.error("  :",G),te.error("  "),ee(K=>K.slice(0,-1))}Sn(null),Yn("")},[c]),$t=ve==="all"?jt:jt.filter(b=>(b.originalProjectName||b.projectName)===ve),Me=it.useMemo(()=>{const b=ve!=="all",M=new Map;$t.forEach(K=>{const le=nt(K.start).format("YYYY-MM-DD");M.has(le)||M.set(le,[]),M.get(le).push(K)});const G=[];return M.forEach(K=>{if(b)K.forEach((le,ge)=>{const he=nt(le.start).startOf("day").add(ge,"milliseconds").toDate();G.push({...le,start:he,allDay:!1})});else{const le=[],ge=[];K.forEach(he=>{He(he)?le.push(he):ge.push(he)}),le.forEach((he,rt)=>{const gt=nt(he.start).startOf("day").add(rt,"milliseconds").toDate();G.push({...he,start:gt,allDay:!1})}),ge.forEach((he,rt)=>{const gt=nt(he.start).startOf("day").add(1e3+rt,"milliseconds").toDate();G.push({...he,start:gt,allDay:!1})})}}),G.sort((K,le)=>K.start.getTime()-le.start.getTime())},[$t,He,ve]),De=it.useMemo(()=>{if(Nt&&ve!=="all"){const b=nt(Nt).format("YYYY-MM-DD"),M=Me.filter(ge=>nt(ge.start).format("YYYY-MM-DD")===b),G=M.length>0?Math.max(...M.map(ge=>ge.start.getTime())):nt(Nt).startOf("day").valueOf(),K=new Date(G+1),le={id:"__inline_add__",title:"",start:K,end:K,projectId:"",projectName:ve,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Me,le]}return Me},[Me,Nt,ve]);A.useEffect(()=>{(y==null?void 0:y.name)===""&&w.length>0&&(ve==="all"||!w.find(b=>b.name===ve))&&jn(w[0].name)},[w,y]),A.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.opacity="0",he.style.pointerEvents="none",he.style.position="absolute",he.style.left="-9999px",he.style.top="-9999px",he.style.zIndex="-1"})};b();const M=new MutationObserver(b),G=document.querySelector(".rbc-calendar");G&&M.observe(G,{childList:!0,subtree:!0});const K=new MutationObserver(b);return K.observe(document.body,{childList:!0,subtree:!0}),()=>{M.disconnect(),K.disconnect()}},[Ft,T]);const[ze,ft]=A.useState({date:null,projectId:"",title:""}),at=it.useRef(!1),Fe=it.useRef(null),Ye=b=>{if(We.current){We.current=!1;return}if(b.id==="__inline_add__")return;at.current=!0,Fe.current&&clearTimeout(Fe.current);const M=ve!=="all",G=window.innerWidth<768;if(M&&!G&&!b.isASVisit&&!b.isExpectedPayment)mn(null),Sn(b),Yn(b.originalTitle||b.title);else{const K={...b,title:b.originalTitle||b.title};Xe(null),de(K),ye(!0)}Fe.current=setTimeout(()=>{at.current=!1,Fe.current=null},300)},pt=b=>{const M=window.innerWidth,G=M<768,K=M>=768&&M<1024,le=ve==="all";if(Dt.current)return;if(G){if(b.start){re(b.start);const he=document.querySelector(".md\\:hidden.mt-3.bg-white");he&&he.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ge=b.action==="click"||b.action==="select";if(!(K&&!ge)){if(le){at.current=!1,Sn(null),Yn(""),mn(null),Xe(b),de(null),ye(!0);return}if(!at.current){if(ue){Qe(ue,b.start,!0);return}Sn(null),Yn(""),mn(b.start)}}},pn=async()=>{if(!ze.projectId||!ze.title.trim()){alert("  ");return}const b=w.find(M=>M.id===ze.projectId);if(!(!b||!ze.date))try{await i({id:Date.now().toString(),title:ze.title,start:ze.date,end:ze.date,type:"other",project:b.name,location:"",attendees:[],description:""}),ft({date:null,projectId:"",title:""}),re(null)}catch(M){console.error("Failed to add schedule:",M),te.error("  ")}},un=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let M=b.color||"#E0E7FF",G="#1f2937";if(b.isASVisit)M="#E8F5E9",G="#1f2937";else{const K=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&L&&["",""].includes(L),ge=b.assignedTo&&b.assignedTo.includes("")&&L&&["","",""].includes(L);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||K||le||ge?(M="#FEF3C7",G="#1f2937"):b.color||(M="#e8e2ea")}return{style:{backgroundColor:M,"--event-bg-color":M,borderRadius:"6px",color:G,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},rr=it.useCallback(b=>{const M=nt(b).format("YYYY-MM-DD"),G=!!Fo[M],K=ot&&nt(b).isSame(ot,"day"),le=window.innerWidth<768;let ge="";K&&(ge+="selected-date "),G&&(ge+="holiday-date ");const he=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ge.trim(),style:he}},[ot]),[ht,fi]=A.useState(window.innerWidth<768);A.useEffect(()=>{const b=()=>{fi(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),A.useEffect(()=>{const b=()=>{const M=ot||new Date;Xe({start:M,end:M}),de(null),ye(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ot]);const ir=it.useCallback(({date:b,label:M})=>o.jsxDEV(UC,{date:b,label:M,filteredEvents:De,selectedDate:ot,user:y,isMobileView:ht},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[De,ot,y,ht]),or=it.useRef(ds);or.current=ds;const ga=it.useCallback(b=>{Yn(b)},[]),ao=it.useCallback(()=>{Sn(null),Yn("")},[]),ya=it.useCallback(({event:b})=>{if(b.id==="__inline_add__")return o.jsxDEV(BC,{onSave:On,onCancel:Xt,processList:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const M=(en==null?void 0:en.id)===b.id||(en==null?void 0:en.mergedEventIds)&&en.mergedEventIds.includes(b.id);return o.jsxDEV(HC,{event:b,user:y,filterProject:ve,isEditing:M,editTitle:M?or.current:void 0,onEditTitleChange:M?ga:void 0,onEditSave:M?ts:void 0,onEditDelete:M?()=>qn(b):void 0,onEditCancel:M?ao:void 0,onHoverDelete:()=>qn(b),onDeleteAction:()=>{We.current=!0},processList:fe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,ve,en,ts,qn,On,Xt,ga,ao,fe]),nc=({onNavigate:b})=>{const[M,G]=it.useState(!1),[K,le]=it.useState(nt(T).year()),[ge,he]=it.useState(nt(T).month()),rt=window.innerWidth<768,gt=()=>{le(nt(T).year()),he(nt(T).month()),G(!0)},hn=()=>{O(nt().year(K).month(ge).toDate()),G(!1)};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${rt?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("div",{className:"flex items-center space-x-1",children:[o.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:gt,children:[o.jsxDEV("span",{children:nt(T).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),o.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",ve==="all"?" ":ve]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex items-center space-x-2",children:o.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:ve,onChange:St=>{jn(St.target.value),Lt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&o.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),w.filter(St=>St.status!=="completed").map(St=>o.jsxDEV("option",{value:St.name,children:St.name},St.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),M&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>G(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("button",{onClick:()=>le(K-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),o.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[K,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),o.jsxDEV("button",{onClick:()=>le(K+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4",children:o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(St=>{const It=ge===St-1,tn=nt().year()===K&&nt().month()===St-1;return o.jsxDEV("button",{onClick:()=>he(St-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${It?"bg-gray-900 text-white":tn?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[St,""]},St,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{O(new Date),G(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),o.jsxDEV("button",{onClick:hn,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},sc=()=>null,rc=A.useMemo(()=>({toolbar:nc,event:ya,month:{dateHeader:ir,showMore:sc}}),[ir,ya]),ar=it.useMemo(()=>{if(!ot)return[];let b;if(ht)b=De.filter(G=>nt(G.start).isSame(ot,"day"));else{const G=nt(ot).startOf("week"),K=nt(ot).endOf("week");b=De.filter(le=>{const ge=nt(le.start);return ge.isSameOrAfter(G,"day")&&ge.isSameOrBefore(K,"day")})}const M=[...b].sort((G,K)=>{const le=G.assignedTo&&G.assignedTo.includes("HV LAB"),ge=G.assignedTo&&G.assignedTo.includes("")&&L&&["",""].includes(L),he=G.assignedTo&&G.assignedTo.includes("")&&L&&["","",""].includes(L),rt=G.assignedTo&&L&&G.assignedTo.includes(L)||G.assignedTo&&(y==null?void 0:y.name)&&G.assignedTo.includes(y.name)||le||ge||he,gt=K.assignedTo&&K.assignedTo.includes("HV LAB"),hn=K.assignedTo&&K.assignedTo.includes("")&&L&&["",""].includes(L),St=K.assignedTo&&K.assignedTo.includes("")&&L&&["","",""].includes(L),It=K.assignedTo&&L&&K.assignedTo.includes(L)||K.assignedTo&&(y==null?void 0:y.name)&&K.assignedTo.includes(y.name)||gt||hn||St;return rt&&!It?-1:!rt&&It?1:new Date(G.start).getTime()-new Date(K.start).getTime()});return console.log("Sorted events:",M.map(G=>({title:G.title,assignedTo:G.assignedTo,user:y==null?void 0:y.name,userShort:L}))),M},[ot,De,y,L,ht]);return A.useEffect(()=>{const M=setTimeout(()=>{const G=ht?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),K=document.querySelectorAll(".rbc-month-row"),le=[];K.forEach((kt,Jt)=>{const dn=kt.querySelectorAll(".rbc-date-cell");let Wt=0;dn.forEach(zt=>{const yt=zt.querySelector("button");let Gt=yt==null?void 0:yt.textContent;if(!Gt){const ys=zt.querySelector("span");Gt=ys==null?void 0:ys.textContent}if(Gt&&!isNaN(parseInt(Gt))){const ys=nt(T).date(parseInt(Gt)),Ss=De.filter(pi=>nt(pi.start).isSame(ys,"day"));Wt=Math.max(Wt,Ss.length)}}),le.push(Wt)});const ge=ve&&ve!=="all",he=100,rt=ge?60:18,gt=25,hn=Math.floor((he-gt)/rt),St=le.length,It=he*St,tn=le.map(kt=>kt<=hn?he:gt+kt*rt+10),kn=tn.reduce((kt,Jt)=>kt+Jt,0);if(kn>It){const kt=tn.map((Wt,zt)=>({index:zt,height:Wt,overflow:Wt>he})),Jt=kt.filter(Wt=>Wt.overflow).reduce((Wt,zt)=>Wt+(zt.height-he),0),dn=kt.filter(Wt=>!Wt.overflow);if(dn.length>0){const Wt=It-Jt-dn.length*he,zt=Math.max(50,he+Wt/dn.length);K.forEach((yt,Gt)=>{const Ss=tn[Gt]>he?tn[Gt]:zt;yt.style.height=`${Ss}px`,yt.style.minHeight=`${Ss}px`})}else{const Wt=It/kn;K.forEach((zt,yt)=>{const Gt=Math.max(80,tn[yt]*Wt);zt.style.height=`${Gt}px`,zt.style.minHeight=`${Gt}px`})}}else{const kt=tn.reduce((zt,yt)=>zt+(yt>he?yt:0),0),Jt=tn.filter(zt=>zt<=he).length,dn=It-kt,Wt=Jt>0?dn/Jt:he;K.forEach((zt,yt)=>{const Gt=tn[yt]>he?tn[yt]:Wt;zt.style.height=`${Gt}px`,zt.style.minHeight=`${Gt}px`})}G.forEach(kt=>{const Jt=kt.querySelector("button");let dn=Jt==null?void 0:Jt.textContent;if(!dn){const Gt=kt.querySelector("span");dn=Gt==null?void 0:Gt.textContent}if(!dn||isNaN(parseInt(dn)))return;const Wt=nt(T).date(parseInt(dn)),zt=De.filter(Gt=>nt(Gt.start).isSame(Wt,"day"));zt.length>0?kt.setAttribute("data-event-count",zt.length.toString()):kt.removeAttribute("data-event-count");const yt=Wt.clone().toDate();if(ot&&nt(yt).isSame(ot,"day")?kt.classList.add("selected-date"):kt.classList.remove("selected-date"),ht){const Gt=kt,ys=Gt._mobileClickHandler;ys&&kt.removeEventListener("click",ys);const Ss=pi=>{if(pi.target.closest(".rbc-event"))return;const hi=Wt.clone().toDate();re(hi);const bs=document.querySelector(".md\\:hidden.mt-3.bg-white");bs&&bs.scrollIntoView({behavior:"smooth",block:"nearest"})};Gt._mobileClickHandler=Ss,kt.addEventListener("click",Ss,!0),kt.style.cursor="pointer",kt.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(M),ht&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(K=>{const le=K,ge=le._mobileClickHandler;ge&&(K.removeEventListener("click",ge),delete le._mobileClickHandler)})}},[De,T,ht,ot,ve]),o.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[ze.date&&o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:o.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[o.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:nt(ze.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),o.jsxDEV("select",{value:ze.projectId,onChange:b=>ft({...ze,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:w.filter(b=>b.status!=="completed").map(b=>o.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:ze.title,onChange:b=>ft({...ze,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&pn()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:pn,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{ft({date:null,projectId:"",title:""}),re(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),o.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[o.jsxDEV("div",{className:"flex gap-3",children:[ve!=="all"&&!ht&&o.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[o.jsxDEV("button",{onClick:()=>V(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[o.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),ue&&o.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[o.jsxDEV("span",{className:"font-medium",children:ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),o.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),o.jsxDEV("div",{className:"flex flex-col gap-0.5",children:fe.map(b=>o.jsxDEV("div",{draggable:!0,onClick:()=>{Lt(ue===b?null:b)},onDragStart:M=>{Re.current=!1,Lt(null),be(b),Ae.current=b,M.dataTransfer.setData("text/plain",b),M.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Re.current||(be(null),Ae.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${ue===b?"bg-blue-500 text-white ring-2 ring-blue-300":B===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),o.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${ve!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:o.jsxDEV(TC,{localizer:RC,events:De,startAccessor:"start",endAccessor:"end",view:Ft,onView:dt,date:T,onNavigate:O,onSelectEvent:Ye,onSelectSlot:pt,onEventDrop:ve!=="all"?Je:void 0,onDragStart:ve!=="all"?_e:void 0,onDropFromOutside:ve!=="all"?wt:void 0,dragFromOutsideItem:ve!=="all"?Qt:void 0,draggableAccessor:b=>ve!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:un,dayPropGetter:rr,components:rc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${ve}-${(ot==null?void 0:ot.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ot&&o.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:ht?nt(ot).format("MM DD (ddd)"):`${nt(ot).startOf("week").format("MM DD")} - ${nt(ot).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Fo[nt(ot).format("YYYY-MM-DD")]&&o.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Fo[nt(ot).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[ve!=="all"&&o.jsxDEV("button",{onClick:()=>Rn(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),o.jsxDEV("button",{onClick:()=>{re(null),es(null),Rn(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:o.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),o.jsxDEV("div",{children:ar.length===0?o.jsxDEV("div",{className:"p-4",children:ve!=="all"&&ws?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:v,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&v.trim()){const M=ot||new Date,G={id:"",title:v.trim(),start:M,end:M,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(G).then(()=>{Rn(!1),x("")}).catch(K=>{console.error("  :",K),te.error("  ")})}else b.key==="Escape"&&(Rn(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{if(v.trim()){const b=ot||new Date,M={id:"",title:v.trim(),start:b,end:b,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(M).then(()=>{Rn(!1),x("")}).catch(G=>{console.error("  :",G),te.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{Rn(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):o.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):o.jsxDEV("div",{children:[(()=>{const b=ar.reduce((G,K)=>{const le=nt(K.start).format("YYYY-MM-DD");return G[le]||(G[le]=[]),G[le].push(K),G},{});return Object.keys(b).sort().map(G=>o.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!ht&&o.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:o.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:nt(G).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),o.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[G].map(K=>{const le=K.assignedTo&&K.assignedTo.includes("HV LAB"),ge=K.assignedTo&&K.assignedTo.includes("")&&L&&["",""].includes(L),he=K.assignedTo&&K.assignedTo.includes("")&&L&&["","",""].includes(L),gt=K.assignedTo&&(K.assignedTo.includes((y==null?void 0:y.name)||"")||L&&K.assignedTo.includes(L))||le||ge||he,hn=!K.color&&!gt,St=!K.isASVisit&&!K.isExpectedPayment;return o.jsxDEV("div",{onClick:()=>{const It={...K,title:K.originalTitle||K.title};Ye(It)},className:`p-3 cursor-pointer ${gt?"bg-yellow-50":""}`,style:hn?{backgroundColor:"#f3f0f5"}:void 0,children:o.jsxDEV("div",{className:"flex items-start gap-2",children:[o.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:gt?"#FEF3C7":K.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[o.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:K.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),K.assignedTo&&K.assignedTo.length>0&&o.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(kn=>K.assignedTo.includes(kn))?"":K.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),K.projectName&&ve==="all"&&o.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:K.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),St?o.jsxDEV("button",{onClick:It=>{It.stopPropagation(),es(K)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:o.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):o.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},G,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),ve!=="all"&&ws&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("input",{type:"text",value:v,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&v.trim()){const M=ot||new Date,G={id:"",title:v.trim(),start:M,end:M,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(G).then(()=>{Rn(!1),x("")}).catch(K=>{console.error("  :",K),te.error("  ")})}else b.key==="Escape"&&(Rn(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{if(v.trim()){const b=ot||new Date,M={id:"",title:v.trim(),start:b,end:b,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(M).then(()=>{Rn(!1),x("")}).catch(G=>{console.error("  :",G),te.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{Rn(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),ht&&ve!=="all"&&o.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[o.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:fe.map(b=>o.jsxDEV("button",{onClick:async()=>{const M=ot||new Date;if(ve!=="all"){const G={id:"",title:b,start:M,end:M,project:ve,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(G)}catch(K){console.error("  :",K),te.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),Z&&o.jsxDEV(ay,{event:me,slotInfo:Ve,defaultProjectName:ve!=="all"?ve:void 0,onClose:()=>{ye(!1),de(null),Xe(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(me)if(me.id.startsWith("as-")){const M=me.id.replace("as-","");let G="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?G=b.assignedTo.join(", "):me.assignedTo&&Array.isArray(me.assignedTo)?G=me.assignedTo.join(", "):typeof me.assignedTo=="string"&&(G=me.assignedTo),await u(M,{project:b.title||me.title,assignedTo:G,scheduledVisitDate:b.start,scheduledVisitTime:b.time||me.time}),await d(),ye(!1)}else if(me.id.startsWith("payment-")){const M=me.id.split("-"),G=M[1],K=M[2],le=f.find(ge=>ge.id===G);if(le){const ge={...le.expectedPaymentDates};ge[K]=b.start,await h(G,{expectedPaymentDates:ge})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let M=b.title;const G=/ - (|) \d{1,2}( \d{1,2})?$/;if(M=M.replace(G,""),me.mergedEventIds&&me.mergedEventIds.length>0){console.log(" Updating merged schedules:",me.mergedEventIds);const K=(me.originalTitle||me.title).split(", "),le=M.split(", ");for(let ge=0;ge<me.mergedEventIds.length;ge++){const he=me.mergedEventIds[ge],rt=le[ge]||K[ge]||M;await a(he,{title:rt.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await a(me.id,{title:M,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const M={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(M)}ye(!1)}catch(M){console.error("Failed to save schedule:",M),te.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const M=b.split("-"),G=M[1],K=M[2],le=f.find(ge=>ge.id===G);if(le){const ge={...le.expectedPaymentDates};delete ge[K],await h(G,{expectedPaymentDates:ge})}}else if(b.startsWith("as-")){const M=b.replace("as-","");await u(M,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const M=jt.find(G=>G.id===b);if(M!=null&&M.mergedEventIds&&M.mergedEventIds.length>0){console.log("Deleting merged schedules:",M.mergedEventIds);for(const G of M.mergedEventIds)await c(G)}else await c(b)}ye(!1)}catch(M){console.error("Failed to delete schedule:",M),te.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),E&&Y&&o.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:H.x-50,top:H.y-15,backgroundColor:E.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:E.originalTitle||E.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Cs&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>es(null),children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 text-center",children:[o.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:o.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),o.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Cs.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex border-t border-gray-100",children:[o.jsxDEV("button",{onClick:()=>es(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),o.jsxDEV("button",{onClick:async()=>{try{const b=Cs.mergedEventIds||[Cs.id];await Promise.all(b.map(M=>c(M)))}catch(b){console.error("  :",b),te.error(" ")}es(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&o.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{V(!1),k(null),P("")},children:o.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{V(!1),k(null),P("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[o.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:j,onChange:b=>P(b.target.value),onKeyDown:b=>b.key==="Enter"&&Le(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),o.jsxDEV("button",{onClick:Le,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),o.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:pe?o.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[o.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),o.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):F.length===0?o.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[o.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):o.jsxDEV("div",{className:"divide-y divide-gray-50",children:F.map((b,M)=>o.jsxDEV("div",{draggable:(I==null?void 0:I.id)!==b.id,onDragStart:()=>st(M),onDragOver:G=>Ct(G,M),onDragEnd:lt,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ut===M?"opacity-50 bg-gray-100":""} ${Mt===M?"border-t-2 border-gray-400":""} ${(I==null?void 0:I.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(I==null?void 0:I.id)===b.id?o.jsxDEV(o.Fragment,{children:[o.jsxDEV("input",{type:"text",value:ke,onChange:G=>Be(G.target.value),onKeyDown:G=>{G.key==="Enter"&&Ke(),G.key==="Escape"&&(k(null),Be(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),o.jsxDEV("button",{onClick:Ke,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{k(null),Be("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),o.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:M+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),o.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>{k(b),Be(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),o.jsxDEV("button",{onClick:()=>bt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),F.length>0&&o.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},FC=({projectName:t,onClose:e,type:n="cash"})=>{const s=n==="cash",r=s?"":"",i=s?"      .":"      .",[a,c]=A.useState({receiptDate:Ot(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),m=()=>{window.print()},u=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],w=["","","","","","","","","",""];let _="",S=0;for(;f>0;){const R=f%1e4;if(R>0){let L="",$=R,ie=0;for(;$>0;){const ee=$%10;ee>0&&(L=w[ee]+y[ie]+L),$=Math.floor($/10),ie++}_=L+h[S]+_}f=Math.floor(f/1e4),S++}return _+""};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[o.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),o.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(xn,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),o.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),o.jsxDEV("input",{type:"date",value:a.receiptDate,onChange:f=>c({...a,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.customerName,onChange:f=>c({...a,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:u(a.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&c({...a,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),a.amount&&o.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.purpose,onChange:f=>c({...a,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:a.receivedBy,onChange:f=>c({...a,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),o.jsxDEV("button",{onClick:m,disabled:!a.customerName||!a.amount||!a.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsxDEV(up,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden print:block p-12",children:o.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[o.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:s?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-6 text-lg",children:[o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 receipt-date",children:Ot(new Date(a.receiptDate),"yyyy MM dd",{locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:t},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(a.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:d(Number(a.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[o.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),o.jsxDEV("span",{className:"flex-1",children:a.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-12 text-center",children:[o.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-2",children:[o.jsxDEV("p",{className:"text-lg receipt-date",children:Ot(new Date(a.receiptDate),"yyyy MM dd",{locale:Nn})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",a.receivedBy," ",o.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),o.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},OC="HVLabImageDB",qC=1,Pr="paymentRecordImages";let Oa=null;const Lu=()=>new Promise((t,e)=>{if(Oa){t(Oa);return}const n=indexedDB.open(OC,qC);n.onerror=()=>{console.error("IndexedDB  :",n.error),e(n.error)},n.onsuccess=()=>{Oa=n.result,t(Oa)},n.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains(Pr)||r.createObjectStore(Pr,{keyPath:"id"})}}),$C=async()=>{try{const t=await Lu();return new Promise((e,n)=>{const i=t.transaction(Pr,"readonly").objectStore(Pr).getAll();i.onsuccess=()=>{const a={};i.result.forEach(c=>{a[c.id]=c.images}),e(a)},i.onerror=()=>{console.error("  :",i.error),n(i.error)}})}catch(t){console.error("IndexedDB , localStorage :",t);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},WC=async(t,e)=>{try{const n=await Lu();return new Promise((s,r)=>{const c=n.transaction(Pr,"readwrite").objectStore(Pr).put({id:t,images:e});c.onsuccess=()=>s(),c.onerror=()=>{console.error("  :",c.error),r(c.error)}})}catch(n){throw console.error("IndexedDB  :",n),n}},zC=async t=>{try{const e=await Lu();return new Promise((n,s)=>{const r=e.transaction(Pr,"readwrite"),i=r.objectStore(Pr);i.clear(),Object.entries(t).forEach(([a,c])=>{i.put({id:a,images:c})}),r.oncomplete=()=>n(),r.onerror=()=>{console.error("  :",r.error),s(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},KC=async()=>{try{const t=localStorage.getItem("paymentRecordImages");if(t){const e=JSON.parse(t);Object.keys(e).length>0&&(await zC(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(t){console.error(" :",t)}},qa=t=>{if(!t)return 0;try{const n=new Date(t).getTime();return isNaN(n)?0:n}catch{return 0}},ip=(t,e,n)=>{if(!t)return null;try{const s=new Date(t);return isNaN(s.getTime())?null:Ot(s,e,n)}catch{return null}},QC=()=>{const{payments:t,loadPaymentsFromAPI:e,loadProjectsFromAPI:n,addPaymentToAPI:s,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:a}=Gs(),{user:c}=Br(),m=Kl(),[u,d]=A.useState(""),[f,h]=A.useState(null),[y,w]=A.useState(null),[_,S]=A.useState(!1),[R,L]=A.useState(!1),[$,ie]=A.useState(!1),[ee,F]=A.useState(!1),[C,N]=A.useState(""),[V,j]=A.useState("form"),[P,I]=A.useState(!1),[k,ke]=A.useState(!1),Be=A.useRef(null),[pe,je]=A.useState("pending"),[ut,qt]=A.useState("all"),[Mt,ae]=A.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Ue,fe]=A.useState(!1),[Le,Ke]=A.useState(null),[bt,st]=A.useState(!1),[Ct,lt]=A.useState(""),[ct,cn]=A.useState(!1),Q=A.useRef(!1),Pe=A.useRef(!1),Oe=A.useRef(null),Ie=A.useRef(new Set),[He,Tt]=A.useState([]),[Ft,dt]=A.useState([]),[T,O]=A.useState(null),[Z,ye]=A.useState([]),[me,de]=A.useState([]),[Ve,Xe]=A.useState(!1),[Ge,ve]=A.useState({}),[jn,jt]=A.useState(!1),ot=()=>{const v=localStorage.getItem("lastSelectedProject"),x=m.filter(E=>E.status!=="completed");return v&&x.some(E=>E.name===v)?v:x.length>0?x[0].name:""},[re,B]=A.useState({project:"",date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});A.useEffect(()=>{(async()=>{try{const x=await Qs.getAllContractors();Tt(x.map(E=>({id:E._id||E.id,rank:E.rank,companyName:E.companyName,name:E.name,process:E.process,contact:E.contact,accountNumber:E.accountNumber,bankName:E.bankName,notes:E.notes,createdAt:new Date(E.createdAt),updatedAt:new Date(E.updatedAt)})))}catch(x){console.error("Failed to load contractors:",x)}})()},[]),A.useEffect(()=>{qt("all");const v=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);(async()=>{v&&(console.log("[]   - Firestore  "),await vf()),n().catch(U=>{console.error("Failed to load projects:",U)}),e().catch(U=>{console.error("Failed to load payments:",U)})})();const E=()=>{I(window.innerWidth<1024)};if(E(),window.addEventListener("resize",E),m.length>0&&!re.project&&!Pe.current){const U=ot();U&&(B(H=>({...H,project:U})),localStorage.setItem("lastSelectedProject",U))}return()=>window.removeEventListener("resize",E)},[]);const be=A.useRef(new Map);A.useEffect(()=>{console.log("[ ] Firestore  ...");const v=hs.subscribeToPayments(x=>{console.log("[ ]  :",x.length,""),x.forEach(W=>{const q=String(W.id),Y=be.current.get(q);Y&&Y!=="completed"&&W.status==="completed"&&(Ie.current.has(q)||te.success(`: ${W.project_name||""} ${W.item_name||""}`.trim(),{duration:4e3}))});const E=new Map;x.forEach(W=>{E.set(String(W.id),W.status)}),be.current=E;const U=x.map(W=>({id:String(W.id),project:W.project_name||"",purpose:W.description,process:W.vendor_name,itemName:W.item_name||"",amount:W.amount,materialAmount:W.material_amount||0,laborAmount:W.labor_amount||0,originalMaterialAmount:W.original_material_amount||0,originalLaborAmount:W.original_labor_amount||0,applyTaxDeduction:W.apply_tax_deduction===1,includesVAT:W.includes_vat===1,quickText:W.quick_text||"",images:(()=>{if(!W.images)return[];if(Array.isArray(W.images))return W.images;try{const q=JSON.parse(W.images);return Array.isArray(q)?q:[]}catch{return[]}})(),category:W.request_type,status:W.status,urgency:"normal",requestedBy:W.requester_name,requestDate:new Date(W.request_date||W.created_at),approvalDate:W.approved_at?new Date(W.approved_at):void 0,bankInfo:{accountHolder:W.account_holder||"",bankName:W.bank_name||"",accountNumber:W.account_number||""},attachments:[],notes:W.notes||"",completionDate:W.paid_at?new Date(W.paid_at):void 0})),H=U.filter(W=>W.status==="pending").length,X=U.filter(W=>W.status==="completed").length;console.log("[ ] Zustand  :",U.length," (:",H,", :",X,")"),Gs.setState({payments:U})});return()=>{console.log("[ ] Firestore  "),v()}},[]),A.useEffect(()=>{if(!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))return;console.log("[ ] 3   ");const x=setInterval(async()=>{try{await e()}catch(E){console.warn("[ ]  :",E)}},3e3);return()=>{console.log("[ ]  "),clearInterval(x)}},[e]),A.useEffect(()=>{const v=async()=>{if(document.visibilityState==="visible"){if(Oe.current){console.log("[]     - ");return}if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){console.log("[]  - Firestore  "),await vf();try{await e()}catch(E){console.error("[]  :",E)}}}};return document.addEventListener("visibilitychange",v),()=>{document.removeEventListener("visibilitychange",v)}},[e]),A.useEffect(()=>{(async()=>{var U,H,X,W;if(Q.current)return;const x=new URLSearchParams(window.location.search),E=x.get("complete")||x.get("c");if(E){if(!c){console.log("[ ]   -  ");return}Q.current=!0,console.log("[ ]  :",E),window.history.replaceState({},"","/payments"),Pe.current=!0,j("list"),je("completed"),qt("all"),B(q=>({...q,project:""})),a(String(E),{status:"completed",completionDate:new Date}),Ie.current.add(String(E)),setTimeout(()=>{Ie.current.delete(String(E))},1e4),te.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(E),{status:"completed"}),await e()}catch(q){console.error("[ ]  :",q),a(String(E),{status:"pending",completionDate:void 0}),je("pending");let Y="  ";((U=q.response)==null?void 0:U.status)===401?Y=" .  ":((H=q.response)==null?void 0:H.status)===404?Y="     (ID: "+E+")":(W=(X=q.response)==null?void 0:X.data)!=null&&W.error?Y=q.response.data.error:q.message&&(Y+=": "+q.message),te.error(Y)}}})()},[e,i,a,c]),A.useEffect(()=>{if(re.process){const v=new Set(t.filter(H=>{var X;return H.status==="completed"&&((X=H.bankInfo)==null?void 0:X.accountHolder)}).map(H=>H.bankInfo.accountHolder.trim().toLowerCase())),x=(H,X)=>{const W=H.toLowerCase(),q=X.toLowerCase();if(W.includes(q)||q.includes(W))return!0;const Y=W.split("/").map(Se=>Se.trim()),oe=q.replace(/$/,"").trim();for(const Se of Y)if(Se===oe||oe.includes(Se)||Se.includes(oe))return!0;return!1},U=He.filter(H=>{if(!x(re.process,H.process))return!1;const W=H.accountNumber&&H.accountNumber.trim()!=="",q=H.name.trim().toLowerCase(),Y=v.has(q);return W||Y}).sort((H,X)=>{const W=H.accountNumber&&H.accountNumber.trim()!=="",q=X.accountNumber&&X.accountNumber.trim()!=="";return W&&!q?-1:!W&&q?1:0});dt(U)}else dt([])},[re.process,He,t]),A.useEffect(()=>{if(re.process){const v=(U,H)=>{if(!H)return!1;const X=U.toLowerCase(),W=H.toLowerCase();if(X.includes(W)||W.includes(X))return!0;const q=X.split("/").map(oe=>oe.trim()),Y=W.replace(/$/,"").trim();for(const oe of q)if(oe===Y||Y.includes(oe)||oe.includes(Y))return!0;return!1},x=t.filter(U=>{var H,X,W;return U.status==="completed"&&U.process&&v(re.process,U.process)&&((H=U.bankInfo)==null?void 0:H.accountHolder)&&((X=U.bankInfo)==null?void 0:X.bankName)&&((W=U.bankInfo)==null?void 0:W.accountNumber)}),E=new Map;x.forEach(U=>{const H=`${U.bankInfo.accountHolder}_${U.bankInfo.bankName}_${U.bankInfo.accountNumber}`;E.has(H)||E.set(H,{accountHolder:U.bankInfo.accountHolder,bankName:U.bankInfo.bankName,accountNumber:U.bankInfo.accountNumber,itemName:U.itemName||"",amount:U.amount||0})}),ye(Array.from(E.values()))}else ye([])},[re.process,t]),A.useEffect(()=>{var x;const v=((x=re.accountHolder)==null?void 0:x.trim())||"";if(v.length>=1&&Ve){const E=[],U=new Set;He.filter(H=>H.accountNumber&&H.accountNumber.trim()!=="").forEach(H=>{const X=H.name.trim(),W=X.toLowerCase(),q=v.toLowerCase();if(W.startsWith(q)&&!U.has(W)){U.add(W);const Y=t.find(oe=>{var Se,We;return oe.status==="completed"&&((We=(Se=oe.bankInfo)==null?void 0:Se.accountHolder)==null?void 0:We.trim().toLowerCase())===W&&oe.process});E.push({name:X,bankName:H.bankName||"",accountNumber:H.accountNumber||"",process:(Y==null?void 0:Y.process)||"",source:"contractor"})}}),t.filter(H=>{var X;return H.status==="completed"&&((X=H.bankInfo)==null?void 0:X.accountHolder)}).forEach(H=>{const X=H.bankInfo.accountHolder.trim(),W=X.toLowerCase(),q=v.toLowerCase();W.startsWith(q)&&!U.has(W)&&(U.add(W),E.push({name:X,bankName:H.bankInfo.bankName||"",accountNumber:H.bankInfo.accountNumber||"",process:H.process||"",source:"payment"}))}),de(E)}else de([])},[re.accountHolder,Ve,He,t]);const Ae=v=>{const x=v.split(`
`).map(q=>q.trim()).filter(q=>q),E={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},U=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],H=q=>{const Y=["","","","","","","",""];for(const oe of Y)if(q.endsWith(oe)&&q.length>oe.length+1)return q.slice(0,-oe.length);return q},X=q=>{if(!q||q.length<2||q.length>5||!/^[-]{2,5}$/.test(q)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(q)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(q))return!1;if(q.length>=2){const Se=q.charAt(0),We=q.substring(0,2);if(["","","","","","",""].includes(We)||U.includes(Se))return!0}return q.length>=2&&q.length<=4},W=x.some(q=>q.includes(" ")||q.includes(""));if(x.forEach((q,Y)=>{if(q.includes("")&&q.includes(":")){const oe=q.match(/\s*:\s*(.+)/);oe&&(E.itemName=oe[1].trim())}if(q.includes("")&&q.includes(":")){const oe=q.match(/\s*:\s*(.+)/);oe&&(E.bankInfo.accountHolder=oe[1].trim())}if(q.includes("")&&q.includes(":")){const oe=q.match(/\s*:\s*(.+)/);oe&&(E.bankInfo.bankName=oe[1].trim())}if(q.includes("")&&q.includes(":")){const oe=q.match(/\s*:\s*(.+)/);oe&&(E.bankInfo.accountNumber=oe[1].trim())}if(q.includes("")&&q.includes(":")){const oe=q.match(/\s*:\s*([\d,]+)?/);oe&&(E.amounts.total=parseInt(oe[1].replace(/,/g,"")))}}),!W){let q=-1;if(x.forEach(Y=>{const oe=Y.match(/\[([^\]]+)\]/);oe&&!E.itemName&&(E.itemName=oe[1].trim())}),x.forEach((Y,oe)=>{if(Y.includes("")||Y.includes(" ")||Y.includes("()")){E.includeVat=!0;const Me=Y.match(/(\d+)\s*\s*(\d+)\s*\s*?/),De=Y.match(/(\d+)\s*\s*?/),ze=Y.match(/([\d,]+)\s*/);if(Me){const ft=parseInt(Me[1])*1e4+parseInt(Me[2])*1e3;E.amounts.total=ft}else if(De){const ft=parseInt(De[1])*1e4;E.amounts.total=ft}else if(ze){const ft=parseInt(ze[1].replace(/,/g,""));ft>=1e3&&(E.amounts.total=ft)}return}const We=Y.match(/=\s*([\d,.]+)\s*?/);let Je=null;if(We){const Me=parseInt(We[1].replace(/[,.]/g,""));Me>=1e3&&(E.amounts.total=Me)}else{const Me=Y.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(Me){const De=parseInt(Me[1])*1e4,ze=parseInt(Me[2])*1e3,ft=De+ze;Y.includes("")||Y.includes("")?E.amounts.material=ft:Y.includes("")||Y.includes("")?E.amounts.labor=ft:E.amounts.total||(E.amounts.total=ft),Y=Y.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Je=Me}else if(Je=Y.match(/(\d+)\s*\s*?/),Je){const De=parseInt(Je[1])*1e4;Y.includes("")||Y.includes("")?E.amounts.material=De:Y.includes("")||Y.includes("")?E.amounts.labor=De:E.amounts.total||(E.amounts.total=De),Y=Y.replace(/(\d+)\s*\s*?/g,"")}}Y.includes("/")&&Y.split("/").forEach(De=>{const ze=De.trim();ze.startsWith("[")||ze.endsWith("]")||(/^[\d\-]+$/.test(ze)&&ze.replace(/\-/g,"").length>=10?E.bankInfo.accountNumber||(E.bankInfo.accountNumber=ze):X(ze)&&!E.bankInfo.accountHolder&&(E.bankInfo.accountHolder=ze))});const _e=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{6}[\s\-]+\d{2}[\s\-]+\d{3}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,6}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Qe="",wt=-1;for(const Me of _e){const De=Y.match(Me);if(De&&!E.bankInfo.accountNumber){Qe=De[0],wt=De.index||-1,E.bankInfo.accountNumber=De[0].trim().replace(/\s+/g,"-");const ft=Y.substring(wt+Qe.length).trim().split(/\s+/);for(const at of ft){if(at.startsWith("[")||at.endsWith("]"))continue;const Fe=H(at);if(X(Fe)){E.bankInfo.accountHolder=Fe;break}}if(!E.bankInfo.accountHolder&&oe>0){const Fe=x[oe-1].split(/\s+/);for(const Ye of Fe){if(Ye.startsWith("[")||Ye.endsWith("]"))continue;const pt=H(Ye);if(X(pt)){E.bankInfo.accountHolder=pt;break}}}if(!E.bankInfo.accountHolder&&oe+1<x.length){const at=x[oe+1],Fe=at.split(/\s+/);for(const Ye of Fe){if(Ye.startsWith("[")||Ye.endsWith("]"))continue;const pt=H(Ye);if(X(pt)){E.bankInfo.accountHolder=pt;break}}if(!E.bankInfo.accountHolder){const Ye=at.match(/^([-]{2,6})/);if(Ye){const pt=H(Ye[1].trim());X(pt)&&(E.bankInfo.accountHolder=pt)}}}break}}const Qt=Y.match(/[\d,]+/g);if(Qt){const Me=Qe?Qe.split(/[\s\-]+/).filter(ze=>ze):[],De=Qe?Qe.replace(/[\s\-]/g,""):"";Qt.forEach(ze=>{const ft=parseInt(ze.replace(/,/g,"")),at=ze.replace(/,/g,""),Fe=Me.some(Ye=>Ye===at||parseInt(Ye)===ft||De.includes(at));!E.bankInfo.accountNumber&&at.length>=10&&at.length<=20?(E.bankInfo.accountNumber=at,Qe=at):ft>=1e3&&!Je&&!Fe&&(Y.includes("")||Y.includes("")?E.amounts.material=ft:Y.includes("")||Y.includes("")?E.amounts.labor=ft:E.amounts.total||(E.amounts.total=ft))})}const On={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Xt=Object.keys(On).sort((Me,De)=>De.length-Me.length);for(const Me of Xt)if(Y.includes(Me)){const De=On[Me];E.bankInfo.bankName=De,q=oe;const ze=new RegExp(`${Me}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),ft=Y.match(ze);if(ft){const at=H(ft[1]);at&&!/^\d+$/.test(at)&&at!==""&&(E.bankInfo.accountHolder=at)}break}if(!E.bankInfo.bankName){const Me=Y.match(/([-]+)(|)/);Me&&(E.bankInfo.bankName=Me[0])}const ts=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const Me of ts){const De=Y.match(Me);if(De&&!E.bankInfo.accountHolder){E.bankInfo.accountHolder=De[0].trim();break}}const qn=Y.match(/\(([-]{2,5})\)/);if(qn&&!E.bankInfo.accountHolder){const Me=qn[1];X(Me)&&!["","",""].includes(Me)&&(E.bankInfo.accountHolder=Me)}if(!E.bankInfo.accountHolder){const Me=/[-]{2,6}/g,De=Y.match(Me);if(De){const ze=Y.match(/\d{10,}/)||Y.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),ft=Y.match(/||||/);De.forEach(at=>{const Fe=H(at),Ye=v.split(`
`)[oe];if(Ye&&Ye.includes(`[${at}]`)||!X(Fe)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Fe))return;const pn=Y.indexOf(at);if(pn>0){const un=Y[pn-1];if(/[-]/.test(un))return}if(pn+at.length<Y.length){const un=Y[pn+at.length];if(/[-]/.test(un))return}if(!(qn&&Fe===qn[1])){if((ze||ft)&&!E.bankInfo.accountHolder)E.bankInfo.accountHolder=Fe;else if(!E.bankInfo.accountHolder){const un=/||||/,rr=/\d{6,}/;(oe>0&&(rr.test(x[oe-1])||un.test(x[oe-1]))||oe<x.length-1&&(rr.test(x[oe+1])||un.test(x[oe+1]))||un.test(Y))&&(E.bankInfo.accountHolder=Fe)}}})}}const $t={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[Me,De]of Object.entries($t))if(Y.includes(Me)){E.vendor=De;break}if(oe===0&&!E.itemName){const Me=Y.replace(/[\[\]{}()<>]/g,"").trim();Me&&!Me.includes(" ")&&(X(Me)||(E.itemName=Me.substring(0,50)))}}),q>=0&&q+1<x.length){const Y=x[q+1],oe=Y.trim();if(/^[-]{2,5}$/.test(oe)&&X(oe))E.bankInfo.accountHolder=oe;else{const Se=Y.split(/\s+/);for(const We of Se){const Je=H(We);if(X(Je)){E.bankInfo.accountHolder=Je;break}}}}}if(E.itemName&&E.itemName.includes("")&&(E.vendor=""),E.itemName){const q=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Y=E.itemName.toLowerCase(),oe=q.some(_e=>Y===_e.toLowerCase()||Y.startsWith(_e.toLowerCase()+" ")||Y.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Se=/^[\d\-\s]/.test(E.itemName),We=/^\d{2,}[\s\-]?\d+/.test(E.itemName.replace(/[-]/g,"").trim()),Je=E.bankInfo.accountHolder&&(E.itemName===E.bankInfo.accountHolder||E.itemName.includes(E.bankInfo.accountHolder));(oe||Se||We||Je)&&(E.itemName=void 0)}return E},Re=async()=>{var v,x,E,U,H,X,W,q,Y,oe,Se;try{const We=re.quickText;if(!We.trim())return;let Je=t;t.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(De=>setTimeout(De,100)),Je=Gs.getState().payments,console.log("payments  :",Je.length,""));const _e=Ae(We);console.log("  :",_e);const Qe={project:re.project,date:re.date,quickText:re.quickText,quickImages:re.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};O(null),L(!1),ie(!1);let wt=0;_e.amounts.material&&(wt+=_e.amounts.material),_e.amounts.labor&&(wt+=_e.amounts.labor),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&(wt=_e.amounts.total),wt>0&&(Qe.amount=wt),_e.bankInfo.bankName&&(Qe.bankName=_e.bankInfo.bankName),_e.bankInfo.accountHolder&&(Qe.accountHolder=_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&(Qe.accountNumber=_e.bankInfo.accountNumber);const Qt=De=>De?De.replace(/[^0-9]/g,""):"",On=(De,ze)=>{if(!De||!ze)return!1;const ft=Qt(De),at=Qt(ze);if(!ft||!at)return!1;const Fe=6;return ft.length<Fe||at.length<Fe?ft===at:at.includes(ft)||ft.includes(at)},Xt=Qt(_e.bankInfo.accountNumber||""),ts=_e.bankInfo.accountHolder||"";let qn=!1;console.log("===    ==="),console.log(" :",_e.bankInfo.accountNumber),console.log(" :",Xt),console.log(" :",ts),console.log(" :",He.length),console.log("  :",Je.filter(De=>De.status==="completed").length);let $t=He.find(De=>{const ze=Qt(De.accountNumber||"");return ze&&ze===Xt});if(!$t&&Xt&&($t=He.find(De=>{const ze=Qt(De.accountNumber||"");return On(Xt,ze)})),$t&&(qn=!0),!$t&&ts&&($t=He.find(De=>De.name===ts),$t)){console.log("  :",$t.name);const De=((v=$t.accountNumber)==null?void 0:v.replace(/[-\s]/g,""))||"";Xt&&!On(Xt,De)?(console.log("    ( ) -  "),qn=!1):qn=!0}if($t&&($t.name&&(Qe.accountHolder=$t.name,console.log("  :",$t.name)),$t.bankName?Qe.bankName=$t.bankName:_e.bankInfo.bankName&&(Qe.bankName=_e.bankInfo.bankName),qn&&(Qe.accountNumber=$t.accountNumber||_e.bankInfo.accountNumber),O($t.id||$t._id||null),$t.process&&(Qe.process=$t.process)),!$t){let De=!1;console.log("===     ==="),console.log("  payments :",Je.length,""),console.log(" :",Xt),console.log(" :",ts);const ze=Je.filter(Ye=>Ye.status==="completed");console.log(" :",ze.length);const ft=[...new Set(ze.map(Ye=>{var pt;return(pt=Ye.bankInfo)==null?void 0:pt.accountHolder}).filter(Boolean))];console.log("   ( 20):",ft.slice(0,20)),console.log("  ():",Xt);const at=ze.filter(Ye=>{var pt;return(pt=Ye.bankInfo)==null?void 0:pt.accountNumber}).map(Ye=>{var pt,pn,un;return{holder:(pt=Ye.bankInfo)==null?void 0:pt.accountHolder,account:(pn=Ye.bankInfo)==null?void 0:pn.accountNumber,clean:Qt(((un=Ye.bankInfo)==null?void 0:un.accountNumber)||"")}}).filter(Ye=>Ye.clean.includes(Xt.substring(0,6))||Xt.includes(Ye.clean.substring(0,6)));console.log("  :",at);let Fe=Je.find(Ye=>{var un;const pt=Qt(((un=Ye.bankInfo)==null?void 0:un.accountNumber)||"");return pt&&pt===Xt&&Ye.status==="completed"});if(Fe&&console.log("   :",(x=Fe.bankInfo)==null?void 0:x.accountHolder,Fe.process),!Fe&&Xt&&(Fe=Je.find(Ye=>{var pn;const pt=Qt(((pn=Ye.bankInfo)==null?void 0:pn.accountNumber)||"");return On(Xt,pt)&&Ye.status==="completed"}),Fe&&console.log("   :",(E=Fe.bankInfo)==null?void 0:E.accountHolder,Fe.process)),Fe&&(De=!0),!Fe&&ts&&(Fe=Je.find(Ye=>{var pt;return((pt=Ye.bankInfo)==null?void 0:pt.accountHolder)===ts&&Ye.status==="completed"}),Fe)){console.log("    :",(U=Fe.bankInfo)==null?void 0:U.accountHolder,":",Fe.process);const Ye=Qt(((H=Fe.bankInfo)==null?void 0:H.accountNumber)||"");Xt&&!On(Xt,Ye)?(console.log("    ( ) -  "),De=!1):De=!0}Fe?(console.log(" :",{accountHolder:(X=Fe.bankInfo)==null?void 0:X.accountHolder,accountNumber:(W=Fe.bankInfo)==null?void 0:W.accountNumber,bankName:(q=Fe.bankInfo)==null?void 0:q.bankName,process:Fe.process,status:Fe.status,paymentMatchedByAccountNumber:De}),(Y=Fe.bankInfo)!=null&&Y.accountHolder&&(Qe.accountHolder=Fe.bankInfo.accountHolder,console.log("  :",Fe.bankInfo.accountHolder)),(oe=Fe.bankInfo)!=null&&oe.bankName?Qe.bankName=Fe.bankInfo.bankName:_e.bankInfo.bankName&&(Qe.bankName=_e.bankInfo.bankName),De&&(Qe.accountNumber=((Se=Fe.bankInfo)==null?void 0:Se.accountNumber)||_e.bankInfo.accountNumber),Fe.process&&!Qe.process?(Qe.process=Fe.process,console.log("    :",Fe.process)):console.log("   - process:",Fe.process,"updatedFormData.process:",Qe.process)):console.log("  ")}if(_e.vendor&&(Qe.process=_e.vendor),!Qe.process){const De=We.toLowerCase();for(const ze of wc)if(De.includes(ze.toLowerCase())){Qe.process=ze;break}}_e.itemName&&(Qe.itemName=_e.itemName),B(Qe),_e.includeVat&&(L(!0),ie(!1));const Me=[];if(_e.amounts.material||_e.amounts.labor||_e.amounts.total){const De=[];_e.amounts.material&&De.push(`: ${_e.amounts.material.toLocaleString()}`),_e.amounts.labor&&De.push(`: ${_e.amounts.labor.toLocaleString()}`),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&De.push(`: ${_e.amounts.total.toLocaleString()}`),Me.push(De.join(", "))}if(_e.bankInfo.bankName||_e.bankInfo.accountHolder){const De=[];_e.bankInfo.bankName&&De.push(_e.bankInfo.bankName),_e.bankInfo.accountHolder&&De.push(_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&De.push(_e.bankInfo.accountNumber),De.length>0&&Me.push(`: ${De.join(" ")}`)}_e.vendor&&Me.push(`: ${_e.vendor}`),_e.includeVat&&Me.push("  "),Me.length>0?te.success(`  !
${Me.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):te.info("  ...    .")}catch(We){console.error(" :",We),te.error("   .")}};A.useEffect(()=>{(async()=>{try{await KC();const x=await $C();ve(x),jt(!0)}catch(x){console.error("  :",x),jt(!0)}})()},[]);const ue=A.useRef({});A.useEffect(()=>{jn&&(Object.entries(Ge).forEach(([v,x])=>{JSON.stringify(ue.current[v])!==JSON.stringify(x)&&WC(v,x).catch(E=>{console.error("  :",E),te.error("  ")})}),ue.current={...Ge})},[Ge,jn]);const Lt=A.useCallback(async v=>{var U;const x=(U=v.clipboardData)==null?void 0:U.items;if(!x)return;let E=!1;for(let H=0;H<x.length;H++)if(x[H].type.indexOf("image")!==-1){E=!0;break}if(E){if(!f){const H=document.activeElement;(H==null?void 0:H.tagName)==="INPUT"||(H==null?void 0:H.tagName)==="TEXTAREA"||(H==null?void 0:H.classList.contains("form-input"))||te.error("  ");return}for(let H=0;H<x.length;H++)if(x[H].type.indexOf("image")!==-1){v.preventDefault();const X=x[H].getAsFile();if(X){const W=new FileReader;W.onload=async q=>{var oe;const Y=(oe=q.target)==null?void 0:oe.result;if(Y)try{const Se=t.find(_e=>_e.id===f),Je=[...(Se==null?void 0:Se.images)||Ge[f]||[],Y];await hs.updatePaymentImages(f,Je),ve(_e=>({..._e,[f]:Je})),await e(),te.success(" ")}catch(Se){console.error("  :",Se),te.error("  ")}},W.readAsDataURL(X)}}}},[f,t,Ge,e]);A.useEffect(()=>(document.addEventListener("paste",Lt),()=>document.removeEventListener("paste",Lt)),[Lt]);const Rt=[...(c==null?void 0:c.name)===""?t.filter(v=>m.some(x=>x.name===v.project)):t].sort((v,x)=>new Date(x.requestDate).getTime()-new Date(v.requestDate).getTime()),Nt=Rt.filter(v=>{var X,W,q;if(!v||!v.id)return!1;const x=u===""||((X=v.purpose)==null?void 0:X.toLowerCase().includes(u.toLowerCase()))||((W=v.itemName)==null?void 0:W.toLowerCase().includes(u.toLowerCase()))||((q=v.process)==null?void 0:q.toLowerCase().includes(u.toLowerCase())),E=pe==="pending"?v.status!=="completed":v.status==="completed",U=ut==="all"||!ut||v.project===ut,H=!Mt||pe!=="completed"||v.requestedBy===(c==null?void 0:c.username);return x&&E&&U&&H}).sort((v,x)=>!v&&!x?0:v?x?pe==="completed"?qa(x.completionDate)-qa(v.completionDate):qa(x.requestDate)-qa(v.requestDate):-1:1),mn=v=>{const x=v.id||v._id||null;if(T===x){O(null);const X=document.querySelector('input[placeholder=" "]');X&&setTimeout(()=>{X.focus()},100);return}O(x);const E=Mo(v.name);let U=v.bankName||"",H=v.accountNumber||"";if(H&&!U){const X=H.trim().split(/\s+/);if(X.length>=2){const W=X[0];(W.includes("")||W.includes("")||W.includes("")||W.includes("")||W.includes(""))&&(U=W,H=X.slice(1).join(""))}}B(X=>({...X,accountHolder:E,bankName:U,accountNumber:H}))};Nt.reduce((v,x)=>{const E=x.materialAmount||0,U=x.laborAmount||0,H=x.amount||0;let X=E,W=U,q=0;return E===0&&U===0&&H>0?x.includesVAT?(X=Math.round(H/1.1),q=H-X):(X=H,q=0):x.includesVAT?(E>0&&(X=Math.round(E/1.1)),U>0&&(W=Math.round(U/1.1)),q=H-(X+W)):q=0,v.material+=X,v.labor+=W,v.vat+=q,v.total+=H,v},{material:0,labor:0,vat:0,total:0});const en=async()=>{var x,E,U;if(ct){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",c),console.log(" Form data:",re),!re.project){te.error(" ");return}if(!re.itemName){te.error(" ");return}const v=Number(re.amount)||0;if(v===0){te.error(" ");return}cn(!0);try{const H=$?Math.round(v*.967):v,X=new Date;if(y){const W={project:re.project,requestDate:new Date(re.date),purpose:re.itemName,amount:H,category:"material",urgency:"normal",process:re.process,itemName:re.itemName,includesVAT:R,applyTaxDeduction:$,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:re.accountHolder,bank:re.bankName,accountNumber:re.accountNumber,bankInfo:re.accountHolder||re.bankName||re.accountNumber?{accountHolder:re.accountHolder,bankName:re.bankName,accountNumber:re.accountNumber}:void 0,updatedAt:X};console.log(" Updating payment:",W),await i(y,W),te.success(" "),w(null)}else{const W=re.project||"",q={id:`payment_${Date.now()}`,project:W,requestDate:new Date(re.date),requestedBy:(c==null?void 0:c.username)||"  ",purpose:re.itemName,amount:H,status:"pending",category:"material",urgency:"normal",process:re.process,itemName:re.itemName,includesVAT:R,applyTaxDeduction:$,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:re.accountHolder,bank:re.bankName,accountNumber:re.accountNumber,bankInfo:re.accountHolder||re.bankName||re.accountNumber?{accountHolder:re.accountHolder,bankName:re.bankName,accountNumber:re.accountNumber}:void 0,quickText:re.quickText||"",images:re.quickImages,attachments:[],createdAt:X,updatedAt:X};console.log(" Creating payment:",q),console.log(" Images in payment:",((x=re.quickImages)==null?void 0:x.length)||0,"");const Y=await s(q);if(Oe.current=Y,setTimeout(()=>{Oe.current=null},1e4),te.success(" "),re.accountHolder&&re.bankName&&re.accountNumber){const oe=R||$?"01074088864":"01089423283";try{await hs.sendTossPaymentSms({recipientPhone:oe,accountHolder:re.accountHolder,bankName:re.bankName,accountNumber:re.accountNumber,amount:H,projectName:W,itemName:re.itemName,process:re.process,paymentId:Y}),te.success("   ")}catch(Se){console.error("SMS  :",Se),te.error("  : "+(((U=(E=Se.response)==null?void 0:E.data)==null?void 0:U.error)||Se.message||"   "))}}}B(W=>({project:W.project,date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),L(!1),ie(!1),O(null),window.innerWidth<768&&j("list")}catch(H){console.error(" Payment save error:",H),te.error("  : "+H.message)}finally{cn(!1)}},Sn=v=>{var x,E,U,H;try{console.log("[handleEdit] Starting edit for payment:",v.id);const X=v.originalMaterialAmount!==void 0?v.originalMaterialAmount:v.materialAmount||0,W=v.originalLaborAmount!==void 0?v.originalLaborAmount:v.laborAmount||0,q={project:v.project||"",date:v.requestDate?Ot(new Date(v.requestDate),"yyyy-MM-dd"):Ot(new Date,"yyyy-MM-dd"),process:v.process||"",itemName:v.itemName||v.purpose||"",materialCost:X>0?X.toString():"",laborCost:W>0?W.toString():"",amount:((x=v.amount)==null?void 0:x.toString())||"",accountHolder:((E=v.bankInfo)==null?void 0:E.accountHolder)||"",bankName:((U=v.bankInfo)==null?void 0:U.bankName)||"",accountNumber:((H=v.bankInfo)==null?void 0:H.accountNumber)||"",images:v.attachments||[],quickText:v.quickText||"",quickImages:v.images||[]};console.log("[handleEdit] Setting form data:",q),B(q),L(v.includesVAT||!1),ie(v.applyTaxDeduction||!1),h(v.id),w(v.id),P&&j("form"),console.log("[handleEdit] Edit setup complete"),te.success("  ")}catch(X){console.error("[handleEdit] Error:",X),te.error("     ")}},ds=async v=>{var x,E,U;try{const H=((x=v.bankInfo)==null?void 0:x.accountHolder)||v.accountHolder,X=((E=v.bankInfo)==null?void 0:E.bankName)||v.bank,W=((U=v.bankInfo)==null?void 0:U.accountNumber)||v.accountNumber;if(!H||!X||!W){te.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${X}
: ${W}
: ${v.amount.toLocaleString()}`))return;const Y=W.replace(/[-\s]/g,""),oe=gE[X]||X,Se=hE[X]||"004",We="",Je=`supertoss://send?amount=${v.amount}&bankCode=${Se}&bank=${encodeURIComponent(oe)}&accountNo=${Y}&receiverName=${encodeURIComponent(We)}&toName=${encodeURIComponent(We)}`;let _e=!1;try{window.location.href=Je,_e=!0,te.success("  ...",{duration:3e3}),setTimeout(()=>{const Qe=/iPhone|iPad|iPod/i.test(navigator.userAgent),wt=/Android/i.test(navigator.userAgent);(Qe||wt)&&te(`      .

: 
: ${W}
: ${v.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Qe){console.error("   :",Qe),te(`   .

: 
: ${X}
: ${W}
: ${v.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(H){console.error(" :",H),te.error(`   : ${H.message}`)}},Yn=async v=>{const x=t.find(E=>E.id===v);if(x&&x.quickText){const E=localStorage.getItem("executionMemos"),U=E?JSON.parse(E):{};U[v]=x.quickText,localStorage.setItem("executionMemos",JSON.stringify(U))}a(v,{status:"completed",completionDate:new Date}),fe(!1),je("completed"),Ie.current.add(v),setTimeout(()=>{Ie.current.delete(v)},1e4),te.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(v,{status:"completed"})}catch(E){console.error(" API :",E),a(v,{status:"pending",completionDate:void 0}),je("pending"),te.error("   -  ")}},fs=async v=>{var U;if(!f){te.error("  ");return}const E=Array.from(((U=v.target)==null?void 0:U.files)||[]).filter(H=>H.type.startsWith("image/"));if(E.length!==0){try{const H=await Promise.all(E.map(Y=>new Promise((oe,Se)=>{const We=new FileReader;We.onload=Je=>{var Qe;const _e=(Qe=Je.target)==null?void 0:Qe.result;_e?oe(_e):Se(new Error("  "))},We.onerror=()=>Se(new Error("FileReader ")),We.readAsDataURL(Y)}))),X=t.find(Y=>Y.id===f),q=[...(X==null?void 0:X.images)||Ge[f]||[],...H];await hs.updatePaymentImages(f,q),ve(Y=>({...Y,[f]:q})),await e(),te.success(`${H.length}  `)}catch(H){console.error("  :",H),te.error("  ")}v.target.value=""}},$r=async v=>{if(f)try{const x=t.find(H=>H.id===f),U=((x==null?void 0:x.images)||Ge[f]||[]).filter((H,X)=>X!==v);await hs.updatePaymentImages(f,U),ve(H=>({...H,[f]:U})),await e()}catch(x){console.error("  :",x),te.error("  ")}},Cs=v=>{N(v),F(!0)},es=v=>{v.preventDefault(),S(!0)},ws=v=>{v.preventDefault(),S(!1)},Rn=async v=>{if(v.preventDefault(),S(!1),!f){te.error("  ");return}const E=Array.from(v.dataTransfer.files).filter(U=>U.type.startsWith("image/"));if(E.length!==0)try{const U=await Promise.all(E.map(q=>new Promise((Y,oe)=>{const Se=new FileReader;Se.onload=We=>{var _e;const Je=(_e=We.target)==null?void 0:_e.result;Je?Y(Je):oe(new Error("  "))},Se.onerror=()=>oe(new Error("FileReader ")),Se.readAsDataURL(q)}))),H=t.find(q=>q.id===f),W=[...(H==null?void 0:H.images)||Ge[f]||[],...U];await hs.updatePaymentImages(f,W),ve(q=>({...q,[f]:W})),await e(),te.success(`${U.length}  `)}catch(U){console.error("  :",U),te.error("  ")}};return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"lg:hidden mb-4",children:o.jsxDEV("select",{value:re.project,onChange:v=>{B({...re,project:v.target.value}),v.target.value&&localStorage.setItem("lastSelectedProject",v.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(c==null?void 0:c.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2526,columnNumber:35},void 0),m.filter(v=>v.status!=="completed").map(v=>o.jsxDEV("option",{value:v.name,children:v.name},v.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2528,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2516,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2515,columnNumber:7},void 0),o.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:o.jsxDEV("nav",{className:"flex space-x-4",children:[o.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2537,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${V==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2536,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2535,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:7},void 0),o.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[o.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${V!=="form"?"hidden md:block":""}`,children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("select",{value:re.project,onChange:v=>{B({...re,project:v.target.value}),v.target.value&&localStorage.setItem("lastSelectedProject",v.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(c==null?void 0:c.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2592,columnNumber:43},void 0),m.filter(v=>v.status!=="completed").map(v=>o.jsxDEV("option",{value:v.name,children:v.name},v.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2594,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2582,columnNumber:17},void 0),o.jsxDEV("select",{value:re.bankName,onChange:v=>B({...re,bankName:v.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2602,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2603,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2604,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2605,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2606,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2607,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2608,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2609,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2611,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2614,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2597,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2581,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2580,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("textarea",{value:re.quickText,onChange:v=>B({...re,quickText:v.target.value}),onPaste:v=>{var E;const x=(E=v.clipboardData)==null?void 0:E.items;if(x){for(let U=0;U<x.length;U++)if(x[U].type.indexOf("image")!==-1){v.preventDefault();const H=x[U].getAsFile();if(H){const X=new FileReader;X.onload=W=>{var Y;const q=(Y=W.target)==null?void 0:Y.result;B(oe=>({...oe,quickImages:[...oe.quickImages,q]}))},X.readAsDataURL(H)}break}}},onDragOver:v=>{v.preventDefault(),v.stopPropagation()},onDrop:v=>{v.preventDefault(),v.stopPropagation(),Array.from(v.dataTransfer.files).filter(U=>U.type.startsWith("image/")).forEach(U=>{const H=new FileReader;H.onload=X=>{var q;const W=(q=X.target)==null?void 0:q.result;B(Y=>({...Y,quickImages:[...Y.quickImages,W]}))},H.readAsDataURL(U)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:P?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2621,columnNumber:15},void 0),re.quickImages.length>0&&o.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:re.quickImages.map((v,x)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:v,alt:` ${x+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2676,columnNumber:23},void 0),o.jsxDEV("button",{type:"button",onClick:()=>{B(E=>({...E,quickImages:E.quickImages.filter((U,H)=>H!==x)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2681,columnNumber:23},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2675,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:17},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[o.jsxDEV("label",{className:"cursor-pointer",children:[o.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:v=>{Array.from(v.target.files||[]).forEach(E=>{const U=new FileReader;U.onload=H=>{var W;const X=(W=H.target)==null?void 0:W.result;B(q=>({...q,quickImages:[...q.quickImages,X]}))},U.readAsDataURL(E)}),v.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2700,columnNumber:19},void 0),o.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2699,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",onClick:Re,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2725,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2698,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2620,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",re.date&&`(${Ot(new Date(re.date),"E",{locale:Nn})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:17},void 0),o.jsxDEV("input",{type:"date",value:re.date,onChange:v=>B({...re,date:v.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2741,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:15},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0),o.jsxDEV("button",{ref:Be,type:"button",onClick:()=>ke(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:re.process||o.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2764,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2758,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2756,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2736,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:15},void 0),o.jsxDEV("input",{type:"text",value:re.itemName,onChange:v=>B({...re,itemName:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2772,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2770,columnNumber:13},void 0),o.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("input",{type:"text",value:re.amount?Number(re.amount).toLocaleString():"",onChange:v=>{const x=v.target.value.replace(/[^0-9]/g,"");B({...re,amount:x})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2785,columnNumber:19},void 0),o.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2796,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-center gap-4",children:[o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:v=>v.preventDefault(),onClick:()=>{R||ie(!1),L(!R)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${R?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:R&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2814,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2813,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2802,columnNumber:17},void 0),o.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:v=>v.preventDefault(),onClick:()=>{$||L(!1),ie(!$)},children:[o.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${$?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:$&&o.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2832,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2831,columnNumber:19},void 0),o.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2834,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2801,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2781,columnNumber:13},void 0),o.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Ft.length>0||Z.length>0&&!T)&&o.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[o.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Ft.length===0?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Ft.map(v=>{const x=v.id||v._id,E=T===x;return o.jsxDEV("button",{type:"button",onClick:()=>mn(v),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${E?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Mo(v.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2866,columnNumber:29},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[v.bankName||""," ",v.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2869,columnNumber:29},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2856,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2847,columnNumber:19},void 0),o.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${Z.length===0||T?"hidden":""}`,children:[o.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2882,columnNumber:21},void 0),o.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Z.map((v,x)=>o.jsxDEV("button",{type:"button",onClick:()=>{B(E=>({...E,accountHolder:v.accountHolder,bankName:v.bankName,accountNumber:v.accountNumber})),ye([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[o.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:v.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2899,columnNumber:27},void 0),o.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[v.bankName," ",v.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2902,columnNumber:27},void 0)]},x,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2885,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2883,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2879,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2845,columnNumber:17},void 0),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2914,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:re.accountHolder,onChange:v=>B({...re,accountHolder:v.target.value}),onFocus:()=>Xe(!0),onBlur:()=>setTimeout(()=>Xe(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2915,columnNumber:17},void 0),Ve&&me.length>0&&o.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:me.map((v,x)=>o.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:E=>E.preventDefault(),onClick:()=>{let E=v.bankName||"",U=v.accountNumber||"";const H=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],X={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const q of H)if(U.includes(q)){E||(E=X[q]||q),U=U.replace(q,"").trim();break}for(const q of H)if(E.includes(q)){const Y=X[q]||q,oe=E.replace(q,"").trim();oe&&/\d/.test(oe)&&(U=oe),E=Y;break}U=U.replace(/[^\d\-]/g,"").trim();const W=!re.process&&v.process?v.process:re.process;B({...re,accountHolder:v.name,bankName:E||re.bankName,accountNumber:U||re.accountNumber,process:W}),Xe(!1)},children:[o.jsxDEV("div",{className:"flex flex-col",children:[o.jsxDEV("span",{className:"font-medium",children:v.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:27},void 0),v.process&&o.jsxDEV("span",{className:"text-xs text-blue-600",children:[": ",v.process]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3022,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3019,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:v.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3025,columnNumber:25},void 0)]},`${v.name}-${x}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2928,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2926,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2913,columnNumber:15},void 0),o.jsxDEV("div",{className:"payment-bank-field",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:17},void 0),o.jsxDEV("select",{value:re.bankName,onChange:v=>B({...re,bankName:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3042,columnNumber:19},void 0),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3043,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3044,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3045,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3046,columnNumber:19},void 0),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3047,columnNumber:19},void 0),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3048,columnNumber:19},void 0),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3049,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3050,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3051,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3052,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3053,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3054,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3055,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3056,columnNumber:19},void 0),o.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3057,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3058,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3059,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3060,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3061,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3062,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3063,columnNumber:19},void 0),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:15},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3069,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:re.accountNumber,onChange:v=>B({...re,accountNumber:v.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3070,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3068,columnNumber:15},void 0),o.jsxDEV("div",{className:"pt-2 border-t",children:o.jsxDEV("div",{className:"flex justify-between items-baseline",children:[o.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3081,columnNumber:19},void 0),o.jsxDEV("div",{className:"text-right",children:[(R||$)&&o.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",R&&" ",$&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3084,columnNumber:23},void 0),o.jsxDEV("span",{className:"font-semibold",children:[(()=>{const v=Number(re.amount)||0;let x=v;return $&&(x=Math.round(v*.967)),x.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3088,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3082,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3080,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3079,columnNumber:15},void 0),o.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&o.jsxDEV("button",{onClick:()=>{w(null),B(v=>({project:v.project,date:Ot(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),L(!1),ie(!1),O(null),te.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3107,columnNumber:19},void 0),o.jsxDEV("button",{onClick:v=>{console.log(" Payment button clicked!",v),console.log(" Button element:",v.currentTarget),console.log(" Form data:",re),en()},disabled:ct,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ct?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ct?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3136,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3105,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2842,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2578,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2575,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${V!=="list"?"hidden md:flex":""}`,children:[o.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:o.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:o.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[o.jsxDEV("button",{onClick:()=>je("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Rt.filter(v=>v&&v.id&&v.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3166,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{je("completed"),B(v=>({...v,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",o.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:Rt.filter(v=>v&&v.id&&v.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3194,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3181,columnNumber:17},void 0),pe==="completed"&&o.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[o.jsxDEV("input",{type:"checkbox",checked:Mt,onChange:v=>{ae(v.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(v.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3203,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3202,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3165,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3164,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3163,columnNumber:11},void 0),o.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3218,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Nt.length>0?o.jsxDEV("div",{className:"space-y-4",children:Nt.map(v=>{var W,q,Y;const x=v.amount||0,E=((W=v.bankInfo)==null?void 0:W.accountHolder)||v.accountHolder||"",U=((q=v.bankInfo)==null?void 0:q.bankName)||v.bank||"",H=((Y=v.bankInfo)==null?void 0:Y.accountNumber)||v.accountNumber||"",X=E&&U&&H?`${E} | ${U} ${H}`:" ";return o.jsxDEV("div",{onClick:()=>h(v.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===v.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[o.jsxDEV("div",{className:"flex-1 min-w-0",children:[o.jsxDEV("div",{className:"flex items-baseline gap-2",children:[v.process&&o.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",v.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:31},void 0),o.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:v.purpose||v.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3248,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:v.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3256,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:25},void 0),o.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[o.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[x.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3259,columnNumber:27},void 0),o.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[v.requestedBy||"-","  ",ip(v.requestDate,"MM/dd",{locale:Nn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3262,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3258,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3246,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[o.jsxDEV("span",{className:"text-gray-400",children:[" ",(v.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3270,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3271,columnNumber:25},void 0),o.jsxDEV("span",{className:"text-gray-400",children:[" ",(v.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3272,columnNumber:25},void 0),v.includesVAT&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3275,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3276,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3274,columnNumber:27},void 0),v.applyTaxDeduction&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3281,columnNumber:29},void 0),o.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3282,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3280,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3269,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[o.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:X},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3289,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[o.jsxDEV("button",{onClick:oe=>{oe.stopPropagation(),Sn(v)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:o.jsxDEV(Pb,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3301,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3293,columnNumber:27},void 0),o.jsxDEV("button",{onClick:async oe=>{oe.stopPropagation(),window.confirm("  ?")&&(await r(v.id),te.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(ti,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3314,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3303,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3292,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3288,columnNumber:23},void 0),pe==="pending"&&(c==null?void 0:c.role)&&["manager","admin"].includes(c.role)&&o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("button",{onClick:oe=>{if(oe.stopPropagation(),v.status==="completed"){te.info("   ");return}ds(v)},disabled:v.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${v.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:v.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3323,columnNumber:27},void 0),o.jsxDEV("button",{onClick:oe=>{oe.stopPropagation(),Yn(v.id)},disabled:v.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${v.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:v.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:oe=>{v.status!=="completed"&&(oe.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:oe=>{v.status!=="completed"&&(oe.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3341,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3322,columnNumber:25},void 0)]},v.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3236,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3222,columnNumber:15},void 0):o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3372,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3159,columnNumber:9},void 0),o.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${V!=="image"?"hidden lg:flex":""}`,onDragOver:es,onDragLeave:ws,onDrop:Rn,children:[o.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:fs,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3388,columnNumber:11},void 0),P&&f&&V==="image"&&(()=>{const v=Rt.find(x=>x.id===f);return v?o.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:o.jsxDEV("div",{className:"flex justify-between items-start",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:v.purpose||v.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[v.process||"-","  ",ip(v.requestDate,"yyyy.MM.dd",{locale:Nn})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3406,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:21},void 0),o.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(v.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3410,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3403,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3402,columnNumber:17},void 0):null})(),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:v=>{var E;const x=v.target;if(!x.closest("img")&&!x.closest("button")&&f){const U=Rt.find(q=>q.id===f),H=(U==null?void 0:U.images)||[],X=Ge[f]||[];(H.length>0?H:X).length>0&&((E=document.getElementById("image-file-input"))==null||E.click())}},children:f?(()=>{const v=Rt.find(H=>H.id===f),x=(v==null?void 0:v.images)||[],E=Ge[f]||[],U=x.length>0?x:E;return o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"mb-3",children:[o.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3446,columnNumber:21},void 0),o.jsxDEV("textarea",{value:(v==null?void 0:v.quickText)||(v==null?void 0:v.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3447,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3445,columnNumber:19},void 0),U.length>0&&o.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:U.map((H,X)=>o.jsxDEV("div",{className:"relative group",children:[o.jsxDEV("img",{src:H,alt:` ${X+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:W=>{W.stopPropagation(),Cs(H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:27},void 0),o.jsxDEV("button",{onClick:W=>{W.stopPropagation(),$r(X)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:o.jsxDEV(xn,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3477,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3470,columnNumber:27},void 0),o.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[X+1,"/",U.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3479,columnNumber:27},void 0)]},X,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3460,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3458,columnNumber:21},void 0),o.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${U.length>0?"":"flex-1"}`,onClick:H=>H.stopPropagation(),children:o.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${_?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${U.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[o.jsxDEV(Lc,{className:`mx-auto text-gray-400 mb-1 ${U.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3498,columnNumber:23},void 0),o.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:U.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:23},void 0),U.length===0&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3503,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3493,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3443,columnNumber:17},void 0)})():o.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:o.jsxDEV("div",{className:"text-center text-gray-400",children:[o.jsxDEV(Eo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3512,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3513,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3511,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3510,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3420,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3380,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2572,columnNumber:7},void 0),k&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[o.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[o.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3528,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>ke(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(xn,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3533,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3527,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[o.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:wc.map(v=>o.jsxDEV("button",{onClick:()=>{B({...re,process:v}),ke(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${re.process===v?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:v},v,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3540,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{B({...re,process:""}),ke(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3557,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3537,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3526,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3525,columnNumber:11},void 0),o.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>ke(!1),children:o.jsxDEV("div",{onClick:v=>v.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:Be.current?`${Be.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:Be.current?`${Be.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[o.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[o.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>ke(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:o.jsxDEV(xn,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3586,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3582,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3580,columnNumber:15},void 0),o.jsxDEV("div",{className:"p-2",children:[o.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:wc.map(v=>o.jsxDEV("button",{onClick:()=>{B({...re,process:v}),ke(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${re.process===v?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:v},v,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3593,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3591,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{B({...re,process:""}),ke(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3610,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3590,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3572,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3571,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3523,columnNumber:9},void 0),ee&&o.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>F(!1),children:o.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[o.jsxDEV("button",{onClick:v=>{v.stopPropagation(),F(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:o.jsxDEV(xn,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3639,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3632,columnNumber:13},void 0),o.jsxDEV("img",{src:C,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:v=>v.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3641,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3631,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3627,columnNumber:9},void 0),bt&&o.jsxDEV(FC,{projectName:Ct,onClose:()=>st(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3653,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2513,columnNumber:5},void 0)},Qr=t=>t?typeof t=="string"?t:t instanceof Ne?t.toDate().toISOString():new Date().toISOString():new Date().toISOString(),ps={async getSpaces(t){const e=qe(ne,"finish_check_spaces");let n;t?n=xt(e,Tn("project_id","==",t)):n=xt(e);const r=(await Vt(n)).docs.sort((a,c)=>(a.data().display_order||0)-(c.data().display_order||0)),i=[];for(const a of r){const c=a.data(),m=qe(ne,"finish_check_items"),u=xt(m,Tn("space_id","==",a.id)),f=(await Vt(u)).docs.sort((y,w)=>(y.data().display_order||0)-(w.data().display_order||0)),h=[];for(const y of f){const w=y.data(),_=qe(ne,"finish_check_images"),S=xt(_,Tn("item_id","==",y.id)),L=(await Vt(S)).docs.map($=>({id:$.id,item_id:y.id,filename:$.data().filename||null,created_at:Qr($.data().created_at)}));h.push({id:y.id,space_id:a.id,content:w.content||"",is_completed:w.is_completed||0,is_priority:w.is_priority||0,completed_at:w.completed_at?Qr(w.completed_at):null,display_order:w.display_order||0,created_at:Qr(w.created_at),updated_at:Qr(w.updated_at),images:L})}i.push({id:a.id,name:c.name||"",project_id:c.project_id||null,display_order:c.display_order||0,created_at:Qr(c.created_at),updated_at:Qr(c.updated_at),items:h})}return i},async createSpace(t,e){const n=qe(ne,"finish_check_spaces"),s=xt(n,Tn("project_id","==",e)),i=(await Vt(s)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={name:t,project_id:e,display_order:i+1,created_at:sn(),updated_at:sn()};return{id:(await Fs(n,a)).id,name:t,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(t,e){const n=we(ne,"finish_check_spaces",t);await Ut(n,{name:e,updated_at:sn()})},async deleteSpace(t){const e=qe(ne,"finish_check_items"),n=xt(e,Tn("space_id","==",t)),s=await Vt(n);for(const r of s.docs){const i=qe(ne,"finish_check_images"),a=xt(i,Tn("item_id","==",r.id)),c=await Vt(a);for(const m of c.docs)await Un(we(ne,"finish_check_images",m.id));await Un(we(ne,"finish_check_items",r.id))}await Un(we(ne,"finish_check_spaces",t))},async createItem(t,e){const n=qe(ne,"finish_check_items"),s=xt(n,Tn("space_id","==",t)),i=(await Vt(s)).docs.reduce((m,u)=>Math.max(m,u.data().display_order||0),0),a={space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:sn(),updated_at:sn()};return{id:(await Fs(n,a)).id,space_id:t,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(t,e){const n=we(ne,"finish_check_items",t);await Ut(n,{content:e,updated_at:sn()})},async deleteItem(t){const e=qe(ne,"finish_check_images"),n=xt(e,Tn("item_id","==",t)),s=await Vt(n);for(const r of s.docs)await Un(we(ne,"finish_check_images",r.id));await Un(we(ne,"finish_check_items",t))},async toggleItem(t){const e=we(ne,"finish_check_items",t),n=await Pt(e);if(!n.exists())throw new Error("   .");const s=n.data(),r=s.is_completed?0:1;return await Ut(e,{is_completed:r,completed_at:r?sn():null,updated_at:sn()}),{id:t,space_id:s.space_id,content:s.content,is_completed:r,is_priority:s.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:s.display_order||0,created_at:Qr(s.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(t){const e=we(ne,"finish_check_items",t),n=await Pt(e);if(!n.exists())throw new Error("   .");const r=n.data().is_priority||0?0:1;return await Ut(e,{is_priority:r,updated_at:sn()}),{is_priority:r}},async getImageData(t){const e=we(ne,"finish_check_images",t),n=await Pt(e);if(!n.exists())return null;const s=n.data();return{image_data:s.image_url||s.image_data||""}},async uploadImage(t,e,n){const s=qe(ne,"finish_check_images"),r={item_id:t,image_data:"",image_url:"",filename:n,created_at:sn()},i=await Fs(s,r);let a=e;if(Qi(e)){const c=await Xg("finish_check",i.id,e);await Ut(i,{image_url:c,image_data:""}),a=c}else await Ut(i,{image_data:e});return{id:i.id,item_id:t,image_data:a,filename:n,created_at:new Date().toISOString()}},async deleteImage(t){const e=we(ne,"finish_check_images",t),n=await Pt(e);if(n.exists()){const s=n.data();s.image_url&&await Jg(s.image_url)}await Un(e)}},Ns={getSpaces:t=>ps.getSpaces(t),createSpace:(t,e)=>ps.createSpace(t,e),updateSpace:(t,e)=>ps.updateSpace(String(t),e),deleteSpace:t=>ps.deleteSpace(String(t)),createItem:(t,e)=>ps.createItem(String(t),e),updateItem:(t,e)=>ps.updateItem(String(t),e),deleteItem:t=>ps.deleteItem(String(t)),toggleItem:t=>ps.toggleItem(String(t)),togglePriority:t=>ps.togglePriority(String(t)),getImageData:t=>ps.getImageData(String(t)),uploadImage:(t,e,n)=>ps.uploadImage(String(t),e,n),deleteImage:t=>ps.deleteImage(String(t))},YC=()=>{var ot,re;const{user:t}=Br(),{loadProjectsFromAPI:e,projects:n}=Gs(),s=Kl(),[r,i]=A.useState([]),[a,c]=A.useState(!0),[m,u]=A.useState(null),[d,f]=A.useState([]),[h,y]=A.useState(!1),[w,_]=A.useState(""),[S,R]=A.useState(""),[L,$]=A.useState(null),[ie,ee]=A.useState(null),[F,C]=A.useState(""),[N,V]=A.useState(null),[j,P]=A.useState(""),[I,k]=A.useState(null),[ke,Be]=A.useState(new Set),pe=A.useRef(null),[je,ut]=A.useState(window.innerWidth<768),[qt,Mt]=A.useState(!1),[ae,Ue]=A.useState(null),[fe,Le]=A.useState(new Set),[Ke,bt]=A.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[st,Ct]=A.useState(!1),[lt,ct]=A.useState(!1),[cn,Q]=A.useState(new Set);A.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Ke))},[Ke]),A.useEffect(()=>{(async()=>{n.length===0&&await e(),c(!1)})();const be=()=>{ut(window.innerWidth<768)};return window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)},[]),A.useEffect(()=>{a||Pe()},[s,a]),A.useEffect(()=>{m!==null&&Oe()},[m]),A.useEffect(()=>{m!==null&&(t!=null&&t.id)&&localStorage.setItem(`finishCheck_selectedProject_${t.id}`,m.toString())},[m,t==null?void 0:t.id]),A.useEffect(()=>{if(!je&&I){const B=async be=>{var Re;const Ae=(Re=be.clipboardData)==null?void 0:Re.items;if(Ae){for(let ue=0;ue<Ae.length;ue++)if(Ae[ue].type.indexOf("image")!==-1){be.preventDefault();const Lt=Ae[ue].getAsFile();Lt&&await Ve(I,Lt)}}};return document.addEventListener("paste",B),()=>document.removeEventListener("paste",B)}},[I,je]);const Pe=async()=>{try{const B=s.map(Ae=>({id:Ae.id,title:Ae.name}));i(B);const be=t!=null&&t.id?localStorage.getItem(`finishCheck_selectedProject_${t.id}`):null;be&&B.some(Ae=>Ae.id===Number(be))?u(Number(be)):B.length>0&&u(B[0].id)}catch(B){console.error("Failed to load projects:",B),te.error("   ")}},Oe=async()=>{try{d.length===0&&y(!0);const be=(await Ns.getSpaces(m||void 0)).map(Ae=>({...Ae,items:Ae.items.map(Re=>({...Re,images:Re.images||[]}))}));f(be)}catch(B){console.error("Failed to load spaces:",B),te.error("   ")}finally{y(!1)}},Ie=async B=>{if(cn.has(Number(B)))return null;try{Q(Re=>new Set(Re).add(Number(B)));const be=await Ns.getImageData(B),Ae=(be==null?void 0:be.image_data)||null;return f(Re=>Re.map(ue=>({...ue,items:ue.items.map(Lt=>({...Lt,images:Lt.images.map(Dt=>String(Dt.id)===String(B)?{...Dt,image_data:Ae}:Dt)}))}))),Ae}catch(be){return console.error("   :",be),null}finally{Q(be=>{const Ae=new Set(be);return Ae.delete(Number(B)),Ae})}},He=async B=>{const be=d.find(ue=>ue.items.some(Lt=>Lt.id===B)),Ae=be==null?void 0:be.items.find(ue=>ue.id===B);if(!Ae)return;const Re=Ae.images.filter(ue=>!ue.image_data);await Promise.all(Re.map(ue=>Ie(ue.id)))},Tt=async()=>{if(!lt){if(!w.trim()){te.error("  ");return}if(!m){te.error(" ");return}ct(!0);try{const B=await Ns.createSpace(w.trim(),m),be={...B,items:B.items||[]};f([...d,be]),_(""),Ct(!1),te.success(" ")}catch(B){console.error("Failed to add space:",B),te.error("  ")}finally{ct(!1)}}},Ft=async(B,be)=>{if(!be.trim()){te.error("  ");return}try{await Ns.updateSpace(B,be.trim()),f(d.map(Ae=>String(Ae.id)===String(B)?{...Ae,name:be.trim()}:Ae)),ee(null),C(""),te.success("  ")}catch(Ae){console.error("Failed to update space:",Ae),te.error("  ")}},dt=B=>{Ue(B),Le(new Set)},T=async()=>{if(ae!==null){if(fe.size===0){te.error("  ");return}try{await Promise.all(Array.from(fe).map(B=>Ns.deleteItem(B))),f(d.map(B=>String(B.id)===String(ae)?{...B,items:B.items.filter(be=>!fe.has(be.id))}:B)),te.success(`${fe.size}  `),Ue(null),Le(new Set)}catch(B){console.error("Failed to delete items:",B),te.error("  ")}}},O=async()=>{if(ae===null)return;const B=d.find(be=>String(be.id)===String(ae));if(B&&confirm(`"${B.name}"  ?

        .`))try{await Ns.deleteSpace(ae),f(d.filter(be=>String(be.id)!==String(ae))),te.success(" "),Ue(null),Le(new Set)}catch(be){console.error("Failed to delete space:",be),te.error("  ")}},Z=async B=>{if(!S.trim()){te.error("  ");return}const be=-Date.now(),Ae={id:be,space_id:B,content:S.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(ue=>String(ue.id)===String(B)?{...ue,items:[...ue.items,Ae]}:ue));const Re=S.trim();R(""),$(null);try{const ue=await Ns.createItem(B,Re);f(Lt=>Lt.map(Dt=>String(Dt.id)===String(B)?{...Dt,items:Dt.items.map(Rt=>Rt.id===be?{...ue,images:[]}:Rt)}:Dt))}catch(ue){console.error("Failed to add item:",ue),f(Lt=>Lt.map(Dt=>String(Dt.id)===String(B)?{...Dt,items:Dt.items.filter(Rt=>Rt.id!==be)}:Dt)),te.error("  ")}},ye=async B=>{try{const be=await Ns.toggleItem(B);f(d.map(Ae=>({...Ae,items:Ae.items.map(Re=>String(Re.id)===String(B)?{...Re,...be}:Re)})))}catch(be){console.error("Failed to toggle item:",be),te.error("   ")}},me=async B=>{try{const be=await Ns.togglePriority(B);f(d.map(Ae=>({...Ae,items:Ae.items.map(Re=>String(Re.id)===String(B)?{...Re,is_priority:be.is_priority}:Re)})))}catch(be){console.error("Failed to toggle priority:",be),te.error("  ")}},de=B=>new Promise((be,Ae)=>{const Re=new FileReader;Re.readAsDataURL(B),Re.onload=()=>be(Re.result),Re.onerror=ue=>Ae(ue)}),Ve=async(B,be)=>{var ue,Lt;if(!["image/jpeg","image/png","image/webp"].includes(be.type)){te.error("JPEG, PNG, WebP    ");return}const Re=5*1024*1024;if(be.size>Re){te.error("  5MB  ");return}try{Be(Nt=>new Set([...Nt,Number(B)]));const Dt=await de(be),Rt=await Ns.uploadImage(B,Dt,be.name);f(d.map(Nt=>({...Nt,items:Nt.items.map(mn=>String(mn.id)===String(B)?{...mn,images:[...mn.images,Rt]}:mn)}))),te.success(" ")}catch(Dt){console.error("Failed to upload image:",Dt),te.error(((Lt=(ue=Dt.response)==null?void 0:ue.data)==null?void 0:Lt.error)||"  ")}finally{Be(Dt=>{const Rt=new Set(Dt);return Rt.delete(Number(B)),Rt})}},Xe=async(B,be)=>{const Ae=be.target.files;if(!(!Ae||Ae.length===0)){for(let Re=0;Re<Ae.length;Re++)await Ve(B,Ae[Re]);pe.current&&(pe.current.value="")}},Ge=async(B,be)=>{if(confirm("  ?"))try{await Ns.deleteImage(be),f(d.map(Ae=>({...Ae,items:Ae.items.map(Re=>String(Re.id)===String(B)?{...Re,images:Re.images.filter(ue=>String(ue.id)!==String(be))}:Re)}))),te.success(" ")}catch(Ae){console.error("Failed to delete image:",Ae),te.error("  ")}},ve=async(B,be)=>{B.preventDefault(),B.stopPropagation();const Ae=B.dataTransfer.files;if(!(!Ae||Ae.length===0))for(let Re=0;Re<Ae.length;Re++)Ae[Re].type.startsWith("image/")&&await Ve(be,Ae[Re])},jn=B=>{B.preventDefault(),B.stopPropagation()};if(h)return o.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const jt=I?d.flatMap(B=>B.items).find(B=>B.id===I):null;return o.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[o.jsxDEV("input",{ref:pe,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:B=>{I&&Xe(I,B)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),o.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:je?o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("div",{className:"flex-1",children:o.jsxDEV("select",{value:m||"",onChange:B=>{const be=B.target.value?Number(B.target.value):null;u(be)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(B=>o.jsxDEV("option",{value:B.id,children:B.title},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>Ct(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:o.jsxDEV(Hi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):o.jsxDEV("div",{className:"flex gap-3",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),o.jsxDEV("select",{value:m||"",onChange:B=>{const be=B.target.value?Number(B.target.value):null;u(be)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(t==null?void 0:t.name)!==""&&o.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(B=>o.jsxDEV("option",{value:B.id,children:B.title},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:w,onChange:B=>_(B.target.value),onKeyPress:B=>{B.key==="Enter"&&Tt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),o.jsxDEV("button",{onClick:Tt,disabled:lt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:o.jsxDEV(Hi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex items-end",children:o.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?o.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):o.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((B,be)=>{const Ae=B.items.filter(ue=>!ue.is_completed).sort((ue,Lt)=>(Lt.is_priority||0)-(ue.is_priority||0)),Re=B.items.filter(ue=>ue.is_completed);return Ke&&Ae.length===0?null:o.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[ie===B.id?o.jsxDEV("div",{className:"flex gap-2 mb-4",children:[o.jsxDEV("input",{type:"text",value:F,onChange:ue=>C(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"?Ft(B.id,F):ue.key==="Escape"&&(ee(null),C(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>Ft(B.id,F),className:"p-1 text-green-600 hover:text-green-700",children:o.jsxDEV(lp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>{ee(null),C("")},className:"p-1 text-gray-600 hover:text-gray-700",children:o.jsxDEV(xn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):o.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[o.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:be+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),B.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),o.jsxDEV("span",{className:"text-xs text-gray-500",children:[Re.length,"/",B.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:()=>{L===B.id?($(null),R("")):$(B.id)},className:`p-1 transition-colors ${L===B.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:o.jsxDEV(Hi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>{ee(B.id),C(B.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>dt(B.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:o.jsxDEV(ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),L===B.id&&o.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("input",{type:"text",value:S,onChange:ue=>R(ue.target.value),onKeyPress:ue=>{ue.key==="Enter"&&S.trim()&&Z(B.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),o.jsxDEV("button",{onClick:()=>Z(B.id),disabled:!S.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),Ae.length>0&&o.jsxDEV("div",{className:"mb-4",children:o.jsxDEV("div",{className:"space-y-2",children:Ae.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[o.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ye(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!je&&I===ue.id?"font-semibold":""}`,onClick:async()=>{je||(k(ue.id),ue.images&&ue.images.length>0&&await He(ue.id))},style:{cursor:je?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{k(ue.id),je&&Mt(!0),ue.images&&ue.images.length>0&&await He(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Eo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>me(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Yu,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!Ke&&Re.length>0&&o.jsxDEV("div",{children:o.jsxDEV("div",{className:"space-y-2",children:Re.map(ue=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[o.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ye(ue.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),o.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!je&&I===ue.id?"font-semibold":""}`,onClick:async()=>{je||(k(ue.id),ue.images&&ue.images.length>0&&await He(ue.id))},style:{cursor:je?"default":"pointer"},children:[ue.content,ue.images&&ue.images.length>0&&o.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",ue.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center gap-1",children:[o.jsxDEV("button",{onClick:async()=>{k(ue.id),je&&Mt(!0),ue.images&&ue.images.length>0&&await He(ue.id)},className:`p-1 transition-colors ${ue.images&&ue.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Eo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),o.jsxDEV("button",{onClick:()=>me(ue.id),className:`p-1 transition-colors ${ue.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:o.jsxDEV(Yu,{className:`w-4 h-4 ${ue.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},ue.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},B.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!je&&I&&jt&&o.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:o.jsxDEV(xn,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),o.jsxDEV("button",{onClick:()=>{var B;return(B=pe.current)==null?void 0:B.click()},disabled:ke.has(I),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsxDEV(Lc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),ke.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:B=>ve(B,I),onDragOver:jn,children:jt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[o.jsxDEV(Eo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),o.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(B=>o.jsxDEV("div",{className:"relative group",children:[B.image_data?o.jsxDEV("img",{src:B.image_data,alt:B.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):o.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),o.jsxDEV("button",{onClick:()=>Ge(I,B.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:o.jsxDEV(Gu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),B.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:B.filename,children:B.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},B.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),je&&qt&&I&&jt&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Mt(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(xn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),o.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{var B;return(B=pe.current)==null?void 0:B.click()},disabled:ke.has(I),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[o.jsxDEV(Lc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),ke.has(I)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:jt.images.length===0?o.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[o.jsxDEV(Eo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),o.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):o.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(B=>o.jsxDEV("div",{className:"relative",children:[B.image_data?o.jsxDEV("img",{src:B.image_data,alt:B.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):o.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:o.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),o.jsxDEV("button",{onClick:()=>Ge(I,B.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:o.jsxDEV(Gu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),B.filename&&o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:B.filename,children:B.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},B.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ot=d.find(B=>B.id===ae))==null?void 0:ot.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ue(null),Le(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(xn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),o.jsxDEV("div",{className:"space-y-2",children:(re=d.find(B=>B.id===ae))==null?void 0:re.items.map(B=>o.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const be=new Set(fe);be.has(B.id)?be.delete(B.id):be.add(B.id),Le(be)},children:[o.jsxDEV("input",{type:"checkbox",checked:fe.has(B.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),o.jsxDEV("span",{className:`flex-1 text-sm ${B.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},B.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[o.jsxDEV("button",{onClick:T,disabled:fe.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",fe.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),o.jsxDEV("button",{onClick:O,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),o.jsxDEV("button",{onClick:()=>{Ue(null),Le(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),st&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:o.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[o.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:o.jsxDEV("div",{className:"flex items-center justify-between",children:[o.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>{Ct(!1),_("")},className:"p-1 text-gray-600 hover:text-gray-900",children:o.jsxDEV(xn,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),o.jsxDEV("div",{className:"p-4",children:[o.jsxDEV("div",{className:"mb-4",children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),o.jsxDEV("input",{type:"text",value:w,onChange:B=>_(B.target.value),onKeyPress:B=>{B.key==="Enter"&&w.trim()&&Tt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),o.jsxDEV("div",{className:"flex gap-2",children:[o.jsxDEV("button",{onClick:()=>{Ct(!1),_("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),o.jsxDEV("button",{onClick:Tt,disabled:!w.trim()||lt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:lt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function GC(){const[t,e]=A.useState([]),[n,s]=A.useState(!1),[r,i]=A.useState(null),[a,c]=A.useState(!1),[m,u]=A.useState(null),[d,f]=A.useState(""),[h,y]=A.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[w,_]=A.useState(!1);A.useEffect(()=>{S()},[]),A.useEffect(()=>{const N=()=>{R()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const S=async()=>{var N,V;try{t.length===0&&s(!0),i(null);const j=await Qs.getAllContractors();e(j.map(P=>({id:P._id,rank:P.rank,companyName:P.companyName,name:P.name,position:P.position,process:P.process,contact:P.contact,accountNumber:P.accountNumber,notes:P.notes,createdAt:new Date(P.createdAt),updatedAt:new Date(P.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const P=j instanceof Error&&((V=(N=j.response)==null?void 0:N.data)==null?void 0:V.message);i(P||"   .")}finally{s(!1)}},R=N=>{if(N){u(N);let V="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const ke of k)if(N.accountNumber.startsWith(ke)){V=ke,j=N.accountNumber.substring(ke.length).trim();break}}let P=N.name,I=N.position||"";I||(I=Ra(N.name),P=Mo(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:P,position:I,process:N.process,contact:N.contact||"",bankName:V,accountNumber:j,notes:N.notes||""})}else u(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});c(!0)},L=()=>{c(!1),u(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},$=async N=>{var j,P;if(N.preventDefault(),w)return;_(!0);const V=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const I={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:V,notes:h.notes};m?await Qs.updateContractor(m.id,I):await Qs.createContractor(I),await S(),L()}catch(I){console.error("Failed to save contractor:",I);const k=I instanceof Error&&((P=(j=I.response)==null?void 0:j.data)==null?void 0:P.message);alert(k||"  .")}finally{_(!1)}},ie=async N=>{var V,j;if(window.confirm("   ?"))try{await Qs.deleteContractor(N),await S()}catch(P){console.error("Failed to delete contractor:",P);const I=P instanceof Error&&((j=(V=P.response)==null?void 0:V.data)==null?void 0:j.message);alert(I||"  .")}},ee=()=>"border-gray-200 text-gray-600 bg-gray-50",F=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,C=t.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,V)=>{const j=F(N.rank)-F(V.rank);if(j!==0)return j;const P=N.process.localeCompare(V.process,"ko");return P!==0?P:N.name.localeCompare(V.name,"ko")});return o.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[o.jsxDEV("div",{className:"flex items-center justify-end",children:o.jsxDEV("button",{onClick:()=>R(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),o.jsxDEV("div",{className:"relative",children:[o.jsxDEV(mp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),o.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),o.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsxDEV("div",{className:"overflow-x-auto",children:o.jsxDEV("table",{className:"w-full",children:[o.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxDEV("tr",{children:[o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),o.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),o.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:n?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("div",{className:"space-y-4",children:[o.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),o.jsxDEV("button",{onClick:S,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):C.length===0?o.jsxDEV("tr",{children:o.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:o.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):C.map(N=>o.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${ee(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"font-medium text-gray-900",children:Mo(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||Ra(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4",children:o.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),o.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsxDEV("button",{onClick:()=>R(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),o.jsxDEV("button",{onClick:()=>ie(N.id),className:"text-red-600 hover:text-red-900",children:o.jsxDEV(ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),o.jsxDEV("div",{className:"md:hidden space-y-3",children:n?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?o.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[o.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),o.jsxDEV("button",{onClick:S,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):C.length===0?o.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):C.map(N=>o.jsxDEV("div",{className:"card p-3 space-y-2",children:[o.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[o.jsxDEV("div",{className:"flex-1",children:[o.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&o.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${ee(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),o.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&o.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),o.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Mo(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),o.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[o.jsxDEV("button",{onClick:()=>R(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:o.jsxDEV(Tc,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),o.jsxDEV("button",{onClick:()=>ie(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:o.jsxDEV(ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),o.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||Ra(N.name))&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:N.position||Ra(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),o.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&o.jsxDEV("div",{className:"flex items-start",children:[o.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),o.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),a&&o.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:o.jsxDEV("div",{className:"p-6",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[o.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:m?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),o.jsxDEV("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:o.jsxDEV(xn,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),o.jsxDEV("form",{onSubmit:$,className:"space-y-4",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),o.jsxDEV("select",{value:h.rank,onChange:N=>y({...h,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),o.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),o.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),o.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:h.companyName,onChange:N=>y({...h,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:N=>y({...h,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:h.position,onChange:N=>y({...h,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",o.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),o.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:N=>y({...h,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:h.contact,onChange:N=>y({...h,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),o.jsxDEV("select",{value:h.bankName,onChange:N=>y({...h,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),o.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),o.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),o.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),o.jsxDEV("optgroup",{label:"",children:[o.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),o.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),o.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),o.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:N=>y({...h,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),o.jsxDEV("div",{children:[o.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),o.jsxDEV("textarea",{value:h.notes,onChange:N=>y({...h,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),o.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[o.jsxDEV("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),o.jsxDEV("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:w?" ...":m?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const XC=()=>{const[t,e]=A.useState([]),[n,s]=A.useState(null),[r,i]=A.useState(!1),a=A.useRef(null);A.useEffect(()=>(a.current=Xa.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{a.current&&a.current()}),[]);const c=async f=>{try{await Xa.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},m=f=>{s(f),f.isRead||c(f.id)},u=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await Xa.deleteQuoteInquiry(f),(n==null?void 0:n.id)===f&&s(null),te.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),te.error("  ")}},d=t.filter(f=>!f.isRead).length;return r?o.jsxDEV("div",{className:"flex items-center justify-center h-full",children:o.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):o.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[o.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${n?"hidden md:flex":"flex"}`,children:[o.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:o.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&o.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:t.length===0?o.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):o.jsxDEV("div",{className:"divide-y",children:t.map(f=>o.jsxDEV("div",{className:`relative group ${(n==null?void 0:n.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:o.jsxDEV("button",{onClick:()=>m(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[o.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&o.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),o.jsxDEV("div",{className:"flex items-center gap-2",children:[o.jsxDEV("span",{className:"text-xs text-gray-500",children:Ot(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),o.jsxDEV("button",{onClick:h=>u(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:o.jsxDEV(ti,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[o.jsxDEV(Xu,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),o.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${n?"flex flex-col":"hidden md:flex md:flex-col"}`,children:n?o.jsxDEV("div",{className:"h-full flex flex-col",children:[o.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[o.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[o.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:n.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),o.jsxDEV("button",{onClick:()=>s(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),o.jsxDEV("div",{className:"text-sm text-gray-500",children:Ot(new Date(n.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),o.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(Lb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Xu,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),o.jsxDEV("span",{children:n.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(Tb,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),o.jsxDEV("span",{children:n.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),n.address&&o.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[o.jsxDEV(jb,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),o.jsxDEV("span",{children:n.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(n.projectType||n.budget)&&o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[o.jsxDEV(Rb,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),o.jsxDEV("div",{className:"pl-6 space-y-2",children:[n.projectType&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),n.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),n.budget&&o.jsxDEV("div",{className:"text-gray-700",children:[o.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),n.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),o.jsxDEV("div",{className:"space-y-3",children:[o.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),o.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:n.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):o.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},JC=()=>{const{login:t}=Br(),[e,n]=A.useState(!1),{register:s,handleSubmit:r,setValue:i,formState:{errors:a}}=ku(),c=async u=>{n(!0);try{await t(u.username,u.password)}finally{n(!1)}},m=u=>{i("username",u)};return o.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsxDEV("div",{className:"max-w-md w-full",children:o.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[o.jsxDEV("div",{className:"text-center mb-8",children:[o.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),o.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),o.jsxDEV("form",{onSubmit:r(c),className:"space-y-6",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),o.jsxDEV("input",{...s("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),a.username&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),o.jsxDEV("input",{...s("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),a.password&&o.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:a.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),o.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?o.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):o.jsxDEV(o.Fragment,{children:[o.jsxDEV(Bb,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),o.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[o.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),o.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(u=>o.jsxDEV("button",{onClick:()=>m(u),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:u},u,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},ZC=A.lazy(()=>qs(()=>import("./Drawings-C9AaIUcM.js"),__vite__mapDeps([0,1,2,3,4,5]))),e1=A.lazy(()=>qs(()=>import("./SiteLog-CN2pzGih.js"),__vite__mapDeps([6,1,4,2,3,5]))),t1=A.lazy(()=>qs(()=>import("./AfterService-CpapiY_8.js"),__vite__mapDeps([7,1,2,4,3,5]))),n1=A.lazy(()=>qs(()=>import("./AdditionalWork-B1fsWaZD.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),s1=A.lazy(()=>qs(()=>import("./ConstructionPayment-B8zXvKql.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),r1=A.lazy(()=>qs(()=>import("./WorkRequest-CV8gfLOX.js"),__vite__mapDeps([11,1,2,4,3,5]))),i1=A.lazy(()=>qs(()=>import("./Specbook-CJpBmjaD.js"),__vite__mapDeps([12,1,2,3,4,5]))),o1=A.lazy(()=>qs(()=>import("./EstimatePreview-DSybfmhW.js"),__vite__mapDeps([13,1,2,3,4,5]))),a1=A.lazy(()=>qs(()=>import("./ExecutionHistory-Iis0Cf-w.js"),__vite__mapDeps([14,1,4,2,3,5]))),l1=()=>o.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:35,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:34,columnNumber:3},void 0),c1=new Db({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function m1(){const[t,e]=A.useState(!1);return A.useEffect(()=>{const n=$N({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),te.loading("   ...",{duration:2e3}),setTimeout(()=>{n(!0).then(()=>{te.dismiss(),te.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(i,a){console.log(" Service Worker :",i),a&&setInterval(()=>{console.log("   ..."),a.update()},6e4)},onRegisterError(i){console.error(" Service Worker  :",i)}});OA();const s=async()=>{try{const a=await(await fetch("/version.json?t="+Date.now())).json(),c=localStorage.getItem("app_version");c&&c!==a.version?(console.log("   :",a.version),localStorage.setItem("app_version",a.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):c||localStorage.setItem("app_version",a.version)}catch(i){console.error("  :",i)}};setTimeout(s,5e3);const r=setInterval(s,3e4);return console.log(" Firestore   "),()=>{clearInterval(r)}},[]),o.jsxDEV(kb,{client:c1,children:o.jsxDEV(xb,{children:o.jsxDEV(tA,{children:[o.jsxDEV(A.Suspense,{fallback:o.jsxDEV(l1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:31},this),children:o.jsxDEV(vb,{children:[o.jsxDEV(En,{path:"/login",element:o.jsxDEV(JC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:139,columnNumber:15},this),o.jsxDEV(En,{path:"/",element:o.jsxDEV(FA,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:40},this),children:[o.jsxDEV(En,{index:!0,element:o.jsxDEV(ap,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:141,columnNumber:17},this),o.jsxDEV(En,{path:"dashboard",element:o.jsxDEV(yE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:142,columnNumber:17},this),o.jsxDEV(En,{path:"projects",element:o.jsxDEV(kE,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:143,columnNumber:17},this),o.jsxDEV(En,{path:"schedule",element:o.jsxDEV(MC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:144,columnNumber:17},this),o.jsxDEV(En,{path:"drawings",element:o.jsxDEV(ZC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:145,columnNumber:17},this),o.jsxDEV(En,{path:"site-log",element:o.jsxDEV(e1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:146,columnNumber:17},this),o.jsxDEV(En,{path:"after-service",element:o.jsxDEV(t1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:147,columnNumber:17},this),o.jsxDEV(En,{path:"additional-work",element:o.jsxDEV(n1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:148,columnNumber:17},this),o.jsxDEV(En,{path:"construction-payment",element:o.jsxDEV(s1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:149,columnNumber:17},this),o.jsxDEV(En,{path:"contractors",element:o.jsxDEV(GC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:150,columnNumber:17},this),o.jsxDEV(En,{path:"work-request",element:o.jsxDEV(r1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:151,columnNumber:17},this),o.jsxDEV(En,{path:"finish-check",element:o.jsxDEV(YC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:152,columnNumber:17},this),o.jsxDEV(En,{path:"specbook",element:o.jsxDEV(i1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:153,columnNumber:17},this),o.jsxDEV(En,{path:"estimate-preview",element:o.jsxDEV(o1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:154,columnNumber:17},this),o.jsxDEV(En,{path:"execution-history",element:o.jsxDEV(a1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:155,columnNumber:17},this),o.jsxDEV(En,{path:"payments",element:o.jsxDEV(QC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:156,columnNumber:17},this),o.jsxDEV(En,{path:"quote-inquiry",element:o.jsxDEV(XC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:157,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:140,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:138,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:137,columnNumber:11},this),o.jsxDEV(qN,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:161,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:136,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:135,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:134,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(t){for(const e of t)e.update()});Ep(document.getElementById("root")).render(o.jsxDEV(A.StrictMode,{children:o.jsxDEV(m1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{ku as A,Nn as B,dm as C,BA as D,Ec as E,eA as F,y1 as G,Bt as H,WC as I,hs as J,KC as K,$C as L,wc as P,Ne as T,ne as a,Un as b,sn as c,we as d,yl as e,cm as f,Pt as g,Br as h,Kl as i,o as j,qe as k,us as l,Vt as m,Zg as n,on as o,Qi as p,xt as q,gl as r,ri as s,bl as t,lm as u,Ut as v,Tn as w,Fs as x,Gs as y,te as z};
