const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-BHm7icV_.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-Cb3gXYnk.js","assets/AfterService-CUrfhe4J.js","assets/AdditionalWork-DwM1Hv-d.js","assets/additionalWorkService-C6jAdTFp.js","assets/ConstructionPayment-D6Ee-IfZ.js","assets/WorkRequest-yxDp_JYV.js","assets/Specbook-q8ys50F5.js","assets/EstimatePreview-D8T5-HFO.js","assets/ExecutionHistory-DPO74lec.js"])))=>i.map(i=>d[i]);
var hN=Object.defineProperty;var gN=(s,e,t)=>e in s?hN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var wd=(s,e,t)=>gN(s,typeof e!="symbol"?e+"":e,t);import{r as A,b as yN,u as zp,d as bN,N as Kp,e as wc,O as NN,R as lt,f as fa,B as xN,h as vN,i as Vs}from"./vendor-react-DN7YJcfR.js";import{a as _N,c as Wu,Q as DN,b as kN}from"./vendor-data-DrLf5NIQ.js";import{B as Sc,X as vs,C as Qp,T as ii,a as AN,b as Yp,W as EN,c as CN,d as Dn,P as Wi,R as VN,e as wN,S as Gp,f as SN,g as TN,h as Xp,i as LN,U as tu,I as jo,j as su,k as Sd,l as Td,m as Ld,n as PN,M as IN,o as jN,p as RN,L as BN}from"./vendor-ui-D8A9iq7X.js";import{k as Tc,l as No,m as xo,n as UN,o as HN,p as Ft,q as MN,r as Pd,s as ON,t as ot}from"./vendor-date-DbWJ9m7c.js";import{c as FN,p as Jp,l as Ml,s as kn,i as qN,h as $N,q as zu,a as Ku,m as Qu,b as WN,d as Ol,o as yl,e as zN,f as bl,r as Yu,g as Gu,j as Xu,k as Ju,n as Zu,t as Zp,u as eh,v as th,w as sh,x as nh,y as rh,z as ih,A as oh,B as ah,C as lh,D as ch,E as uh,F as KN,G as QN,H as YN,I as GN,J as XN,K as JN,L as ZN}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var mh={exports:{}},nu={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var s=A,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),V=Symbol.iterator,v="@@iterator";function w(y){if(y===null||typeof y!="object")return null;var R=V&&y[V]||y[v];return typeof R=="function"?R:null}var B=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function P(y){{for(var R=arguments.length,S=new Array(R>1?R-1:0),q=1;q<R;q++)S[q-1]=arguments[q];F("error",y,S)}}function F(y,R,S){{var q=B.ReactDebugCurrentFrame,J=q.getStackAddendum();J!==""&&(R+="%s",S=S.concat([J]));var W=S.map(function(G){return String(G)});W.unshift("Warning: "+R),Function.prototype.apply.call(console[y],console,W)}}var oe=!1,se=!1,M=!1,C=!1,x=!1,E;E=Symbol.for("react.module.reference");function j(y){return!!(typeof y=="string"||typeof y=="function"||y===n||y===i||x||y===r||y===m||y===d||C||y===b||oe||se||M||typeof y=="object"&&y!==null&&(y.$$typeof===h||y.$$typeof===f||y.$$typeof===o||y.$$typeof===l||y.$$typeof===u||y.$$typeof===E||y.getModuleId!==void 0))}function L(y,R,S){var q=y.displayName;if(q)return q;var J=R.displayName||R.name||"";return J!==""?S+"("+J+")":S}function T(y){return y.displayName||"Context"}function k(y){if(y==null)return null;if(typeof y.tag=="number"&&P("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case n:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case l:var R=y;return T(R)+".Consumer";case o:var S=y;return T(S._context)+".Provider";case u:return L(y,y.render,"ForwardRef");case f:var q=y.displayName||null;return q!==null?q:k(y.type)||"Memo";case h:{var J=y,W=J._payload,G=J._init;try{return k(G(W))}catch{return null}}}return null}var _e=Object.assign,Ue=0,pe,je,ft,qt,Ht,ae,He;function de(){}de.__reactDisabledLog=!0;function Le(){{if(Ue===0){pe=console.log,je=console.info,ft=console.warn,qt=console.error,Ht=console.group,ae=console.groupCollapsed,He=console.groupEnd;var y={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:y,log:y,warn:y,error:y,group:y,groupCollapsed:y,groupEnd:y})}Ue++}}function ze(){{if(Ue--,Ue===0){var y={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:_e({},y,{value:pe}),info:_e({},y,{value:je}),warn:_e({},y,{value:ft}),error:_e({},y,{value:qt}),group:_e({},y,{value:Ht}),groupCollapsed:_e({},y,{value:ae}),groupEnd:_e({},y,{value:He})})}Ue<0&&P("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=B.ReactCurrentDispatcher,it;function St(y,R,S){{if(it===void 0)try{throw Error()}catch(J){var q=J.stack.trim().match(/\n( *(at )?)/);it=q&&q[1]||""}return`
`+it+y}}var nt=!1,ut;{var ms=typeof WeakMap=="function"?WeakMap:Map;ut=new ms}function K(y,R){if(!y||nt)return"";{var S=ut.get(y);if(S!==void 0)return S}var q;nt=!0;var J=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var W;W=bt.current,bt.current=null,Le();try{if(R){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(Dt){q=Dt}Reflect.construct(y,[],G)}else{try{G.call()}catch(Dt){q=Dt}y.call(G.prototype)}}else{try{throw Error()}catch(Dt){q=Dt}y()}}catch(Dt){if(Dt&&q&&typeof Dt.stack=="string"){for(var te=Dt.stack.split(`
`),Oe=q.stack.split(`
`),Ke=te.length-1,Fe=Oe.length-1;Ke>=1&&Fe>=0&&te[Ke]!==Oe[Fe];)Fe--;for(;Ke>=1&&Fe>=0;Ke--,Fe--)if(te[Ke]!==Oe[Fe]){if(Ke!==1||Fe!==1)do if(Ke--,Fe--,Fe<0||te[Ke]!==Oe[Fe]){var Ne=`
`+te[Ke].replace(" at new "," at ");return y.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",y.displayName)),typeof y=="function"&&ut.set(y,Ne),Ne}while(Ke>=1&&Fe>=0);break}}}finally{nt=!1,bt.current=W,ze(),Error.prepareStackTrace=J}var Ze=y?y.displayName||y.name:"",Yt=Ze?St(Ze):"";return typeof y=="function"&&ut.set(y,Yt),Yt}function Te(y,R,S){return K(y,!1)}function Re(y){var R=y.prototype;return!!(R&&R.isReactComponent)}function we(y,R,S){if(y==null)return"";if(typeof y=="function")return K(y,Re(y));if(typeof y=="string")return St(y);switch(y){case m:return St("Suspense");case d:return St("SuspenseList")}if(typeof y=="object")switch(y.$$typeof){case u:return Te(y.render);case f:return we(y.type,R,S);case h:{var q=y,J=q._payload,W=q._init;try{return we(W(J),R,S)}catch{}}}return""}var Ye=Object.prototype.hasOwnProperty,Tt={},$t=B.ReactDebugCurrentFrame;function ct(y){if(y){var R=y._owner,S=we(y.type,y._source,R?R.type:null);$t.setExtraStackFrame(S)}else $t.setExtraStackFrame(null)}function I(y,R,S,q,J){{var W=Function.call.bind(Ye);for(var G in y)if(W(y,G)){var te=void 0;try{if(typeof y[G]!="function"){var Oe=Error((q||"React class")+": "+S+" type `"+G+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof y[G]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Oe.name="Invariant Violation",Oe}te=y[G](R,G,q,S,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Ke){te=Ke}te&&!(te instanceof Error)&&(ct(J),P("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",q||"React class",S,G,typeof te),ct(null)),te instanceof Error&&!(te.message in Tt)&&(Tt[te.message]=!0,ct(J),P("Failed %s type: %s",S,te.message),ct(null))}}}var O=Array.isArray;function Z(y){return O(y)}function ye(y){{var R=typeof Symbol=="function"&&Symbol.toStringTag,S=R&&y[Symbol.toStringTag]||y.constructor.name||"Object";return S}}function ue(y){try{return fe(y),!1}catch{return!0}}function fe(y){return""+y}function Ce(y){if(ue(y))return P("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ye(y)),fe(y)}var Me=B.ReactCurrentOwner,tt={key:!0,ref:!0,__self:!0,__source:!0},Ae,Rs,jt;jt={};function ee(y){if(Ye.call(y,"ref")){var R=Object.getOwnPropertyDescriptor(y,"ref").get;if(R&&R.isReactWarning)return!1}return y.ref!==void 0}function Ge(y){if(Ye.call(y,"key")){var R=Object.getOwnPropertyDescriptor(y,"key").get;if(R&&R.isReactWarning)return!1}return y.key!==void 0}function H(y,R){if(typeof y.ref=="string"&&Me.current&&R&&Me.current.stateNode!==R){var S=k(Me.current.type);jt[S]||(P('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Me.current.type),y.ref),jt[S]=!0)}}function be(y,R){{var S=function(){Ae||(Ae=!0,P("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};S.isReactWarning=!0,Object.defineProperty(y,"key",{get:S,configurable:!0})}}function De(y,R){{var S=function(){Rs||(Rs=!0,P("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",R))};S.isReactWarning=!0,Object.defineProperty(y,"ref",{get:S,configurable:!0})}}var Pe=function(y,R,S,q,J,W,G){var te={$$typeof:e,type:y,key:R,ref:S,props:G,_owner:W};return te._store={},Object.defineProperty(te._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(te,"_self",{configurable:!1,enumerable:!1,writable:!1,value:q}),Object.defineProperty(te,"_source",{configurable:!1,enumerable:!1,writable:!1,value:J}),Object.freeze&&(Object.freeze(te.props),Object.freeze(te)),te};function me(y,R,S,q,J){{var W,G={},te=null,Oe=null;S!==void 0&&(Ce(S),te=""+S),Ge(R)&&(Ce(R.key),te=""+R.key),ee(R)&&(Oe=R.ref,H(R,J));for(W in R)Ye.call(R,W)&&!tt.hasOwnProperty(W)&&(G[W]=R[W]);if(y&&y.defaultProps){var Ke=y.defaultProps;for(W in Ke)G[W]===void 0&&(G[W]=Ke[W])}if(te||Oe){var Fe=typeof y=="function"?y.displayName||y.name||"Unknown":y;te&&be(G,Fe),Oe&&De(G,Fe)}return Pe(y,te,Oe,J,q,Me.current,G)}}var Mt=B.ReactCurrentOwner,mt=B.ReactDebugCurrentFrame;function Wt(y){if(y){var R=y._owner,S=we(y.type,y._source,R?R.type:null);mt.setExtraStackFrame(S)}else mt.setExtraStackFrame(null)}var At;At=!1;function ds(y){return typeof y=="object"&&y!==null&&y.$$typeof===e}function ss(){{if(Mt.current){var y=k(Mt.current.type);if(y)return`

Check the render method of \``+y+"`."}return""}}function Ts(y){{if(y!==void 0){var R=y.fileName.replace(/^.*[\\\/]/,""),S=y.lineNumber;return`

Check your code at `+R+":"+S+"."}return""}}var fn={};function Qs(y){{var R=ss();if(!R){var S=typeof y=="string"?y:y.displayName||y.name;S&&(R=`

Check the top-level render call using <`+S+">.")}return R}}function pn(y,R){{if(!y._store||y._store.validated||y.key!=null)return;y._store.validated=!0;var S=Qs(R);if(fn[S])return;fn[S]=!0;var q="";y&&y._owner&&y._owner!==Mt.current&&(q=" It was passed a child from "+k(y._owner.type)+"."),Wt(y),P('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',S,q),Wt(null)}}function Kr(y,R){{if(typeof y!="object")return;if(Z(y))for(var S=0;S<y.length;S++){var q=y[S];ds(q)&&pn(q,R)}else if(ds(y))y._store&&(y._store.validated=!0);else if(y){var J=w(y);if(typeof J=="function"&&J!==y.entries)for(var W=J.call(y),G;!(G=W.next()).done;)ds(G.value)&&pn(G.value,R)}}}function Tn(y){{var R=y.type;if(R==null||typeof R=="string")return;var S;if(typeof R=="function")S=R.propTypes;else if(typeof R=="object"&&(R.$$typeof===u||R.$$typeof===f))S=R.propTypes;else return;if(S){var q=k(R);I(S,y.props,"prop",q,y)}else if(R.PropTypes!==void 0&&!At){At=!0;var J=k(R);P("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",J||"Unknown")}typeof R.getDefaultProps=="function"&&!R.getDefaultProps.isReactClassApproved&&P("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function en(y){{for(var R=Object.keys(y.props),S=0;S<R.length;S++){var q=R[S];if(q!=="children"&&q!=="key"){Wt(y),P("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",q),Wt(null);break}}y.ref!==null&&(Wt(y),P("Invalid attribute `ref` supplied to `React.Fragment`."),Wt(null))}}var Ln={};function _(y,R,S,q,J,W){{var G=j(y);if(!G){var te="";(y===void 0||typeof y=="object"&&y!==null&&Object.keys(y).length===0)&&(te+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Oe=Ts(J);Oe?te+=Oe:te+=ss();var Ke;y===null?Ke="null":Z(y)?Ke="array":y!==void 0&&y.$$typeof===e?(Ke="<"+(k(y.type)||"Unknown")+" />",te=" Did you accidentally export a JSX literal instead of a component?"):Ke=typeof y,P("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ke,te)}var Fe=me(y,R,S,J,W);if(Fe==null)return Fe;if(G){var Ne=R.children;if(Ne!==void 0)if(q)if(Z(Ne)){for(var Ze=0;Ze<Ne.length;Ze++)Kr(Ne[Ze],y);Object.freeze&&Object.freeze(Ne)}else P("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Kr(Ne,y)}if(Ye.call(R,"key")){var Yt=k(y),Dt=Object.keys(R).filter(function(Ys){return Ys!=="key"}),fs=Dt.length>0?"{key: someKey, "+Dt.join(": ..., ")+": ...}":"{key: someKey}";if(!Ln[Yt+fs]){var Gt=Dt.length>0?"{"+Dt.join(": ..., ")+": ...}":"{}";P(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,fs,Yt,Gt,Yt),Ln[Yt+fs]=!0}}return y===n?en(Fe):Tn(Fe),Fe}}var Q=_;nu.Fragment=n,nu.jsxDEV=Q})();mh.exports=nu;var a=mh.exports,dh,Id=yN;{var jd=Id.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;dh=function(s,e){jd.usingClientEntryPoint=!0;try{return Id.createRoot(s,e)}finally{jd.usingClientEntryPoint=!1}}}const e0="modulepreload",t0=function(s){return"/"+s},Rd={},Qn=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=t0(u),u in Rd)return;Rd[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":e0,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,b)=>{f.addEventListener("load",h),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let s0={data:""},n0=s=>{if(typeof window=="object"){let e=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(s||document.head).appendChild(e),e.firstChild}return s||s0},r0=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,i0=/\/\*[^]*?\*\/|  +/g,Bd=/\n+/g,Nr=(s,e)=>{let t="",n="",r="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?Nr(o,i):i+"{"+Nr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=Nr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Nr.p?Nr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+n},Yn={},fh=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+fh(s[t]);return e}return s},o0=(s,e,t,n,r)=>{let i=fh(s),o=Yn[i]||(Yn[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Yn[o]){let u=i!==s?s:(m=>{let d,f,h=[{}];for(;d=r0.exec(m.replace(i0,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Bd," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Bd," ").trim();return h[0]})(s);Yn[o]=Nr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Yn.g?Yn.g:null;return t&&(Yn.g=Yn[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Yn[o],e,n,l),o},a0=(s,e,t)=>s.reduce((n,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Nr(l,""):l===!1?"":l}return n+r+(o??"")},"");function Fl(s){let e=this||{},t=s.call?s(e.p):s;return o0(t.unshift?t.raw?a0(t,[].slice.call(arguments,1),e.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):t,n0(e.target),e.g,e.o,e.k)}let ph,ru,iu;Fl.bind({g:1});let sr=Fl.bind({k:1});function l0(s,e,t,n){Nr.p=e,ph=s,ru=t,iu=n}function Rr(s,e){let t=this||{};return function(){let n=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:ru&&ru()},l),t.o=/ *go\d+/.test(u),l.className=Fl.apply(t,n)+(u?" "+u:"");let m=s;return s[0]&&(m=l.as||s,delete l.as),iu&&m[0]&&iu(l),ph(m,l)}return r}}var c0=s=>typeof s=="function",Nl=(s,e)=>c0(s)?s(e):s,u0=(()=>{let s=0;return()=>(++s).toString()})(),hh=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),m0=20,em="default",gh=(s,e)=>{let{toastLimit:t}=s.settings;switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:n}=e;return gh(s,{type:s.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...s,toasts:s.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let i=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},nl=[],yh={toasts:[],pausedAt:void 0,settings:{toastLimit:m0}},Hn={},bh=(s,e=em)=>{Hn[e]=gh(Hn[e]||yh,s),nl.forEach(([t,n])=>{t===e&&n(Hn[e])})},Nh=s=>Object.keys(Hn).forEach(e=>bh(s,e)),d0=s=>Object.keys(Hn).find(e=>Hn[e].toasts.some(t=>t.id===s)),ql=(s=em)=>e=>{bh(e,s)},f0={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},p0=(s={},e=em)=>{let[t,n]=A.useState(Hn[e]||yh),r=A.useRef(Hn[e]);A.useEffect(()=>(r.current!==Hn[e]&&n(Hn[e]),nl.push([e,n]),()=>{let o=nl.findIndex(([l])=>l===e);o>-1&&nl.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...s,...s[o.type],...o,removeDelay:o.removeDelay||((l=s[o.type])==null?void 0:l.removeDelay)||(s==null?void 0:s.removeDelay),duration:o.duration||((u=s[o.type])==null?void 0:u.duration)||(s==null?void 0:s.duration)||f0[o.type],style:{...s.style,...(m=s[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},h0=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||u0()}),pa=s=>(e,t)=>{let n=h0(e,s,t);return ql(n.toasterId||d0(n.id))({type:2,toast:n}),n.id},ws=(s,e)=>pa("blank")(s,e);ws.error=pa("error");ws.success=pa("success");ws.loading=pa("loading");ws.custom=pa("custom");ws.dismiss=(s,e)=>{let t={type:3,toastId:s};e?ql(e)(t):Nh(t)};ws.dismissAll=s=>ws.dismiss(void 0,s);ws.remove=(s,e)=>{let t={type:4,toastId:s};e?ql(e)(t):Nh(t)};ws.removeAll=s=>ws.remove(void 0,s);ws.promise=(s,e,t)=>{let n=ws.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof s=="function"&&(s=s()),s.then(r=>{let i=e.success?Nl(e.success,r):void 0;return i?ws.success(i,{id:n,...t,...t==null?void 0:t.success}):ws.dismiss(n),r}).catch(r=>{let i=e.error?Nl(e.error,r):void 0;i?ws.error(i,{id:n,...t,...t==null?void 0:t.error}):ws.dismiss(n)}),s};var g0=1e3,y0=(s,e="default")=>{let{toasts:t,pausedAt:n}=p0(s,e),r=A.useRef(new Map).current,i=A.useCallback((f,h=g0)=>{if(r.has(f))return;let b=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,b)},[]);A.useEffect(()=>{if(n)return;let f=Date.now(),h=t.map(b=>{if(b.duration===1/0)return;let V=(b.duration||0)+b.pauseDuration-(f-b.createdAt);if(V<0){b.visible&&ws.dismiss(b.id);return}return setTimeout(()=>ws.dismiss(b.id,e),V)});return()=>{h.forEach(b=>b&&clearTimeout(b))}},[t,n,e]);let o=A.useCallback(ql(e),[e]),l=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=A.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=A.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),d=A.useCallback((f,h)=>{let{reverseOrder:b=!1,gutter:V=8,defaultPosition:v}=h||{},w=t.filter(F=>(F.position||v)===(f.position||v)&&F.height),B=w.findIndex(F=>F.id===f.id),P=w.filter((F,oe)=>oe<B&&F.visible).length;return w.filter(F=>F.visible).slice(...b?[P+1]:[0,P]).reduce((F,oe)=>F+(oe.height||0)+V,0)},[t]);return A.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},b0=sr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,N0=sr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,x0=sr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,v0=Rr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${b0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${N0} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${x0} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_0=sr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,D0=Rr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${_0} 1s linear infinite;
`,k0=sr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,A0=sr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,E0=Rr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${k0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${A0} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,C0=Rr("div")`
  position: absolute;
`,V0=Rr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,w0=sr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,S0=Rr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${w0} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,T0=({toast:s})=>{let{icon:e,type:t,iconTheme:n}=s;return e!==void 0?typeof e=="string"?A.createElement(S0,null,e):e:t==="blank"?null:A.createElement(V0,null,A.createElement(D0,{...n}),t!=="loading"&&A.createElement(C0,null,t==="error"?A.createElement(v0,{...n}):A.createElement(E0,{...n})))},L0=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,P0=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,I0="0%{opacity:0;} 100%{opacity:1;}",j0="0%{opacity:1;} 100%{opacity:0;}",R0=Rr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,B0=Rr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,U0=(s,e)=>{let t=s.includes("top")?1:-1,[n,r]=hh()?[I0,j0]:[L0(t),P0(t)];return{animation:e?`${sr(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${sr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},H0=A.memo(({toast:s,position:e,style:t,children:n})=>{let r=s.height?U0(s.position||e||"top-center",s.visible):{opacity:0},i=A.createElement(T0,{toast:s}),o=A.createElement(B0,{...s.ariaProps},Nl(s.message,s));return A.createElement(R0,{className:s.className,style:{...r,...t,...s.style}},typeof n=="function"?n({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});l0(A.createElement);var M0=({id:s,className:e,style:t,onHeightUpdate:n,children:r})=>{let i=A.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(s,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[s,n]);return A.createElement("div",{ref:i,className:e,style:t},r)},O0=(s,e)=>{let t=s.includes("top"),n=t?{top:0}:{bottom:0},r=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hh()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...r}},F0=Fl`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ia=16,q0=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:n,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=y0(t,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ia,left:Ia,right:Ia,bottom:Ia,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:s,gutter:n,defaultPosition:e}),b=O0(f,h);return A.createElement(M0,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?F0:"",style:b},d.type==="custom"?Nl(d.message,d):r?r(d):A.createElement(H0,{toast:d,position:f}))}))},ne=ws;const zn=Object.create(null);zn.open="0";zn.close="1";zn.ping="2";zn.pong="3";zn.message="4";zn.upgrade="5";zn.noop="6";const rl=Object.create(null);Object.keys(zn).forEach(s=>{rl[zn[s]]=s});const ou={type:"error",data:"parser error"},xh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vh=typeof ArrayBuffer=="function",_h=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,tm=({type:s,data:e},t,n)=>xh&&e instanceof Blob?t?n(e):Ud(e,n):vh&&(e instanceof ArrayBuffer||_h(e))?t?n(e):Ud(new Blob([e]),n):n(zn[s]+(e||"")),Ud=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Hd(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Lc;function $0(s,e){if(xh&&s.data instanceof Blob)return s.data.arrayBuffer().then(Hd).then(e);if(vh&&(s.data instanceof ArrayBuffer||_h(s.data)))return e(Hd(s.data));tm(s,!1,t=>{Lc||(Lc=new TextEncoder),e(Lc.encode(t))})}const Md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ro=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Md.length;s++)Ro[Md.charCodeAt(s)]=s;const W0=s=>{let e=s.length*.75,t=s.length,n,r=0,i,o,l,u;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(n=0;n<t;n+=4)i=Ro[s.charCodeAt(n)],o=Ro[s.charCodeAt(n+1)],l=Ro[s.charCodeAt(n+2)],u=Ro[s.charCodeAt(n+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},z0=typeof ArrayBuffer=="function",sm=(s,e)=>{if(typeof s!="string")return{type:"message",data:Dh(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:K0(s.substring(1),e)}:rl[t]?s.length>1?{type:rl[t],data:s.substring(1)}:{type:rl[t]}:ou},K0=(s,e)=>{if(z0){const t=W0(s);return Dh(t,e)}else return{base64:!0,data:s}},Dh=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},kh="",Q0=(s,e)=>{const t=s.length,n=new Array(t);let r=0;s.forEach((i,o)=>{tm(i,!1,l=>{n[o]=l,++r===t&&e(n.join(kh))})})},Y0=(s,e)=>{const t=s.split(kh),n=[];for(let r=0;r<t.length;r++){const i=sm(t[r],e);if(n.push(i),i.type==="error")break}return n};function G0(){return new TransformStream({transform(s,e){$0(s,t=>{const n=t.length;let r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Pc;function ja(s){return s.reduce((e,t)=>e+t.length,0)}function Ra(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let r=0;r<e;r++)t[r]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function X0(s,e){Pc||(Pc=new TextDecoder);const t=[];let n=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(ja(t)<1)break;const u=Ra(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(ja(t)<2)break;const u=Ra(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(ja(t)<8)break;const u=Ra(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(ou);break}r=d*Math.pow(2,32)+m.getUint32(4),n=3}else{if(ja(t)<r)break;const u=Ra(t,r);l.enqueue(sm(i?u:Pc.decode(u),e)),n=0}if(r===0||r>s){l.enqueue(ou);break}}}})}const Ah=4;function Ds(s){if(s)return J0(s)}function J0(s){for(var e in Ds.prototype)s[e]=Ds.prototype[e];return s}Ds.prototype.on=Ds.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Ds.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Ds.prototype.off=Ds.prototype.removeListener=Ds.prototype.removeAllListeners=Ds.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Ds.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};Ds.prototype.emitReserved=Ds.prototype.emit;Ds.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ds.prototype.hasListeners=function(s){return!!this.listeners(s).length};const $l=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),gn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Z0="arraybuffer";function Eh(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const ex=gn.setTimeout,tx=gn.clearTimeout;function Wl(s,e){e.useNativeTimers?(s.setTimeoutFn=ex.bind(gn),s.clearTimeoutFn=tx.bind(gn)):(s.setTimeoutFn=gn.setTimeout.bind(gn),s.clearTimeoutFn=gn.clearTimeout.bind(gn))}const sx=1.33;function nx(s){return typeof s=="string"?rx(s):Math.ceil((s.byteLength||s.size)*sx)}function rx(s){let e=0,t=0;for(let n=0,r=s.length;n<r;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Ch(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ix(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function ox(s){let e={},t=s.split("&");for(let n=0,r=t.length;n<r;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class ax extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class nm extends Ds{constructor(e){super(),this.writable=!1,Wl(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new ax(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=sm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=ix(e);return t.length?"?"+t:""}}class lx extends nm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Y0(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Q0(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Ch()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Vh=!1;try{Vh=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const cx=Vh;function ux(){}class mx extends lx{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}let zi=class il extends Ds{constructor(e,t,n){super(),this.createRequest=e,Wl(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=Eh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var r;n.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=il.requestsCount++,il.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ux,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete il.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};zi.requestsCount=0;zi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Od);else if(typeof addEventListener=="function"){const s="onpagehide"in gn?"pagehide":"unload";addEventListener(s,Od,!1)}}function Od(){for(let s in zi.requests)zi.requests.hasOwnProperty(s)&&zi.requests[s].abort()}const dx=function(){const s=wh({xdomain:!1});return s&&s.responseType!==null}();class fx extends mx{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=dx&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new zi(wh,this.uri(),e)}}function wh(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||cx))return new XMLHttpRequest}catch{}if(!e)try{return new gn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Sh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class px extends nm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Sh?{}:Eh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;tm(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}r&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ch()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Ic=gn.WebSocket||gn.MozWebSocket;class hx extends px{createSocket(e,t,n){return Sh?new Ic(e,t,n):t?new Ic(e,t):new Ic(e)}doWrite(e,t){this.ws.send(t)}}class gx extends nm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=X0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=G0();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const yx={websocket:hx,webtransport:gx,polling:fx},bx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function au(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let r=bx.exec(s||""),i={},o=14;for(;o--;)i[Nx[o]]=r[o]||"";return t!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=xx(i,i.path),i.queryKey=vx(i,i.query),i}function xx(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function vx(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,i){r&&(t[r]=i)}),t}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",ol=[];lu&&addEventListener("offline",()=>{ol.forEach(s=>s())},!1);class Dr extends Ds{constructor(e,t){if(super(),this.binaryType=Z0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=au(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=au(t.host).host);Wl(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const r=n.prototype.name;this.transports.push(r),this._transportsByName[r]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ox(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ol.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Ah,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Dr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Dr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+=nx(r)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,$l(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if(typeof t=="function"&&(r=t,t=void 0),typeof n=="function"&&(r=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Dr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=ol.indexOf(this._offlineEventListener);n!==-1&&ol.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Dr.protocol=Ah;class _x extends Dr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Dr.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Dr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){n||(n=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Dx=class extends _x{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>yx[r]).filter(r=>!!r)),super(e,n)}};function kx(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=au(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}const Ax=typeof ArrayBuffer=="function",Ex=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Th=Object.prototype.toString,Cx=typeof Blob=="function"||typeof Blob<"u"&&Th.call(Blob)==="[object BlobConstructor]",Vx=typeof File=="function"||typeof File<"u"&&Th.call(File)==="[object FileConstructor]";function rm(s){return Ax&&(s instanceof ArrayBuffer||Ex(s))||Cx&&s instanceof Blob||Vx&&s instanceof File}function al(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(al(s[t]))return!0;return!1}if(rm(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return al(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&al(s[t]))return!0;return!1}function wx(s){const e=[],t=s.data,n=s;return n.data=cu(t,e),n.attachments=e.length,{packet:n,buffers:e}}function cu(s,e){if(!s)return s;if(rm(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=cu(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=cu(s[n],e));return t}return s}function Sx(s,e){return s.data=uu(s.data,e),delete s.attachments,s}function uu(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=uu(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=uu(s[t],e));return s}const Tx=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Lx=5;var kt;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(kt||(kt={}));class Px{constructor(e){this.replacer=e}encode(e){return(e.type===kt.EVENT||e.type===kt.ACK)&&al(e)?this.encodeAsBinary({type:e.type===kt.EVENT?kt.BINARY_EVENT:kt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===kt.BINARY_EVENT||e.type===kt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=wx(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function Fd(s){return Object.prototype.toString.call(s)==="[object Object]"}class im extends Ds{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===kt.BINARY_EVENT;n||t.type===kt.BINARY_ACK?(t.type=n?kt.EVENT:kt.ACK,this.reconstructor=new Ix(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(rm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(kt[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===kt.BINARY_EVENT||n.type===kt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(i,t)}else n.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(im.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case kt.CONNECT:return Fd(t);case kt.DISCONNECT:return t===void 0;case kt.CONNECT_ERROR:return typeof t=="string"||Fd(t);case kt.EVENT:case kt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Tx.indexOf(t[0])===-1);case kt.ACK:case kt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ix{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Sx(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const jx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:im,Encoder:Px,get PacketType(){return kt},protocol:Lx},Symbol.toStringTag,{value:"Module"}));function _n(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const Rx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Lh extends Ds{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_n(e,"open",this.onopen.bind(this)),_n(e,"packet",this.onpacket.bind(this)),_n(e,"error",this.onerror.bind(this)),_n(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,i;if(Rx.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:kt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{const i=(o,l)=>o?r(o):n(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:kt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case kt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case kt.EVENT:case kt.BINARY_EVENT:this.onevent(e);break;case kt.ACK:case kt.BINARY_ACK:this.onack(e);break;case kt.DISCONNECT:this.ondisconnect();break;case kt.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:kt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:kt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function no(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}no.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};no.prototype.reset=function(){this.attempts=0};no.prototype.setMin=function(s){this.ms=s};no.prototype.setMax=function(s){this.max=s};no.prototype.setJitter=function(s){this.jitter=s};class mu extends Ds{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Wl(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new no({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||jx;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Dx(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=_n(t,"open",function(){n.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=_n(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_n(e,"ping",this.onping.bind(this)),_n(e,"data",this.ondata.bind(this)),_n(e,"error",this.onerror.bind(this)),_n(e,"close",this.onclose.bind(this)),_n(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){$l(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Lh(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const vo={};function Fo(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=kx(s,e.path||"/socket.io"),n=t.source,r=t.id,i=t.path,o=vo[r]&&i in vo[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new mu(n,e):(vo[r]||(vo[r]=new mu(n,e)),u=vo[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Fo,{Manager:mu,Socket:Lh,io:Fo,connect:Fo});function Bx(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Qn(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const b=()=>{h=!0,l==null||l.addEventListener("controlling",V=>{V.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",V=>{typeof V.isUpdate>"u"?typeof V.isExternal<"u"?V.isExternal?b():!h&&(n==null||n()):V.isExternal?window.location.reload():!h&&(n==null||n()):V.isUpdate||n==null||n()}),l.addEventListener("waiting",b),l.addEventListener("externalwaiting",b)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const Ux=()=>{if(typeof window<"u"){const s=window.location.hostname;if(s==="hvlab.app"||s.includes("hv-lab-app")||s.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},Hx=Ux(),Zo=_N.create({baseURL:Hx,headers:{"Content-Type":"application/json"}});Zo.interceptors.request.use(s=>{const e=localStorage.getItem("token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));Zo.interceptors.response.use(s=>s,s=>{var e,t,n;return((e=s.response)==null?void 0:e.status)===401&&!((n=(t=s.config)==null?void 0:t.url)!=null&&n.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Mx=()=>{};var qd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Ox=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const r=s[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=s[t++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=s[t++],o=s[t++],l=s[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=s[t++],o=s[t++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ih={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<s.length;r+=3){const i=s[r],o=r+1<s.length,l=o?s[r+1]:0,u=r+2<s.length,m=u?s[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,b=m&63;u||(b=64,o||(h=64)),n.push(t[d],t[f],t[h],t[b])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Ph(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Ox(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<s.length;){const i=t[s.charAt(r++)],l=r<s.length?t[s.charAt(r)]:0;++r;const m=r<s.length?t[s.charAt(r)]:64;++r;const f=r<s.length?t[s.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new Fx;const h=i<<2|l>>4;if(n.push(h),m!==64){const b=l<<4&240|m>>2;if(n.push(b),f!==64){const V=m<<6&192|f;n.push(V)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Fx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qx=function(s){const e=Ph(s);return Ih.encodeByteArray(e,!0)},xl=function(s){return qx(s).replace(/\./g,"")},$x=function(s){try{return Ih.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=()=>Wx().__FIREBASE_DEFAULTS__,Kx=()=>{if(typeof process>"u"||typeof qd>"u")return;const s=qd.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Qx=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&$x(s[1]);return e&&JSON.parse(e)},om=()=>{try{return Mx()||zx()||Kx()||Qx()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Yx=s=>{var e,t;return(t=(e=om())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},jh=s=>{const e=Yx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Rh=()=>{var s;return(s=om())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bh(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=s.iat||0,i=s.sub||s.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...s};return[xl(JSON.stringify(t)),xl(JSON.stringify(o)),""].join(".")}const qo={};function Xx(){const s={prod:[],emulator:[]};for(const e of Object.keys(qo))qo[e]?s.emulator.push(e):s.prod.push(e);return s}function Jx(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let $d=!1;function Hh(s,e){if(typeof window>"u"||typeof document>"u"||!ha(window.location.host)||qo[s]===e||qo[s]||$d)return;qo[s]=e;function t(h){return`__firebase__banner__${h}`}const n="__firebase__banner",i=Xx().prod.length>0;function o(){const h=document.getElementById(n);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,b){h.setAttribute("width","24"),h.setAttribute("id",b),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{$d=!0,o()},h}function d(h,b){h.setAttribute("id",b),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=Jx(n),b=t("text"),V=document.getElementById(b)||document.createElement("span"),v=t("learnmore"),w=document.getElementById(v)||document.createElement("a"),B=t("preprendIcon"),P=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const F=h.element;l(F),d(w,v);const oe=m();u(P,B),F.append(P,V,w,oe),document.body.appendChild(F)}i?(V.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ev(){var e;const s=(e=om())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tv(){return!ev()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sv(){try{return typeof indexedDB=="object"}catch{return!1}}function nv(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="FirebaseError";class ui extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=rv,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mh.prototype.create)}}class Mh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?iv(i,n):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new ui(r,l,n)}}function iv(s,e){return s.replace(ov,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const ov=/\{\$([^}]+)}/g;function vl(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const i=s[r],o=e[r];if(Wd(i)&&Wd(o)){if(!vl(i,o))return!1}else if(i!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function Wd(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(s){return s&&s._delegate?s._delegate:s}class Qi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Gx;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cv(e))try{this.getOrInitializeService({instanceIdentifier:Jr})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=Jr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jr){return this.instances.has(e)}getOptions(e=Jr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:lv(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Jr){return this.component?this.component.multipleInstances?e:Jr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lv(s){return s===Jr?void 0:s}function cv(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new av(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Vt||(Vt={}));const mv={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},dv=Vt.INFO,fv={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},pv=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),r=fv[e];if(r)console[r](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Oh{constructor(e){this.name=e,this._logLevel=dv,this._logHandler=pv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}const hv=(s,e)=>e.some(t=>s instanceof t);let zd,Kd;function gv(){return zd||(zd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yv(){return Kd||(Kd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fh=new WeakMap,du=new WeakMap,qh=new WeakMap,jc=new WeakMap,am=new WeakMap;function bv(s){const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("success",i),s.removeEventListener("error",o)},i=()=>{t(kr(s.result)),r()},o=()=>{n(s.error),r()};s.addEventListener("success",i),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Fh.set(t,s)}).catch(()=>{}),am.set(e,s),e}function Nv(s){if(du.has(s))return;const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("complete",i),s.removeEventListener("error",o),s.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",i),s.addEventListener("error",o),s.addEventListener("abort",o)});du.set(s,e)}let fu={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return du.get(s);if(e==="objectStoreNames")return s.objectStoreNames||qh.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return kr(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function xv(s){fu=s(fu)}function vv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Rc(this),e,...t);return qh.set(n,e.sort?e.sort():[e]),kr(n)}:yv().includes(s)?function(...e){return s.apply(Rc(this),e),kr(Fh.get(this))}:function(...e){return kr(s.apply(Rc(this),e))}}function _v(s){return typeof s=="function"?vv(s):(s instanceof IDBTransaction&&Nv(s),hv(s,gv())?new Proxy(s,fu):s)}function kr(s){if(s instanceof IDBRequest)return bv(s);if(jc.has(s))return jc.get(s);const e=_v(s);return e!==s&&(jc.set(s,e),am.set(e,s)),e}const Rc=s=>am.get(s);function Dv(s,e,{blocked:t,upgrade:n,blocking:r,terminated:i}={}){const o=indexedDB.open(s,e),l=kr(o);return n&&o.addEventListener("upgradeneeded",u=>{n(kr(o.result),u.oldVersion,u.newVersion,kr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const kv=["get","getKey","getAll","getAllKeys","count"],Av=["put","add","delete","clear"],Bc=new Map;function Qd(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Bc.get(e))return Bc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=Av.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||kv.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return n&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Bc.set(e,i),i}xv(s=>({...s,get:(e,t,n)=>Qd(e,t)||s.get(e,t,n),has:(e,t)=>!!Qd(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cv(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Cv(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pu="@firebase/app",Yd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new Oh("@firebase/app"),Vv="@firebase/app-compat",wv="@firebase/analytics-compat",Sv="@firebase/analytics",Tv="@firebase/app-check-compat",Lv="@firebase/app-check",Pv="@firebase/auth",Iv="@firebase/auth-compat",jv="@firebase/database",Rv="@firebase/data-connect",Bv="@firebase/database-compat",Uv="@firebase/functions",Hv="@firebase/functions-compat",Mv="@firebase/installations",Ov="@firebase/installations-compat",Fv="@firebase/messaging",qv="@firebase/messaging-compat",$v="@firebase/performance",Wv="@firebase/performance-compat",zv="@firebase/remote-config",Kv="@firebase/remote-config-compat",Qv="@firebase/storage",Yv="@firebase/storage-compat",Gv="@firebase/firestore",Xv="@firebase/ai",Jv="@firebase/firestore-compat",Zv="firebase",e_="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="[DEFAULT]",t_={[pu]:"fire-core",[Vv]:"fire-core-compat",[Sv]:"fire-analytics",[wv]:"fire-analytics-compat",[Lv]:"fire-app-check",[Tv]:"fire-app-check-compat",[Pv]:"fire-auth",[Iv]:"fire-auth-compat",[jv]:"fire-rtdb",[Rv]:"fire-data-connect",[Bv]:"fire-rtdb-compat",[Uv]:"fire-fn",[Hv]:"fire-fn-compat",[Mv]:"fire-iid",[Ov]:"fire-iid-compat",[Fv]:"fire-fcm",[qv]:"fire-fcm-compat",[$v]:"fire-perf",[Wv]:"fire-perf-compat",[zv]:"fire-rc",[Kv]:"fire-rc-compat",[Qv]:"fire-gcs",[Yv]:"fire-gcs-compat",[Gv]:"fire-fst",[Jv]:"fire-fst-compat",[Xv]:"fire-vertex","fire-js":"fire-js",[Zv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new Map,s_=new Map,gu=new Map;function Gd(s,e){try{s.container.addComponent(e)}catch(t){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ta(s){const e=s.name;if(gu.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;gu.set(e,s);for(const t of ea.values())Gd(t,s);for(const t of s_.values())Gd(t,s);return!0}function $h(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Wh(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ar=new Mh("app","Firebase",n_);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=e_;function Kh(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:hu,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw Ar.create("bad-app-name",{appName:String(r)});if(t||(t=Rh()),!t)throw Ar.create("no-options");const i=ea.get(r);if(i){if(vl(t,i.options)&&vl(n,i.config))return i;throw Ar.create("duplicate-app",{appName:r})}const o=new uv(r);for(const u of gu.values())o.addComponent(u);const l=new r_(t,n,o);return ea.set(r,l),l}function Qh(s=hu){const e=ea.get(s);if(!e&&s===hu&&Rh())return Kh();if(!e)throw Ar.create("no-app",{appName:s});return e}function Xd(){return Array.from(ea.values())}function Er(s,e,t){let n=t_[s]??s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(o.join(" "));return}ta(new Qi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="firebase-heartbeat-database",o_=1,sa="firebase-heartbeat-store";let Uc=null;function Yh(){return Uc||(Uc=Dv(i_,o_,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(sa)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ar.create("idb-open",{originalErrorMessage:s.message})})),Uc}async function a_(s){try{const t=(await Yh()).transaction(sa),n=await t.objectStore(sa).get(Gh(s));return await t.done,n}catch(e){if(e instanceof ui)nr.warn(e.message);else{const t=Ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(t.message)}}}async function Jd(s,e){try{const n=(await Yh()).transaction(sa,"readwrite");await n.objectStore(sa).put(e,Gh(s)),await n.done}catch(t){if(t instanceof ui)nr.warn(t.message);else{const n=Ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});nr.warn(n.message)}}}function Gh(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=1024,c_=30;class u_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new d_(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Zd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>c_){const o=f_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){nr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Zd(),{heartbeatsToSend:n,unsentEntries:r}=m_(this._heartbeatsCache.heartbeats),i=xl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return nr.warn(t),""}}}function Zd(){return new Date().toISOString().substring(0,10)}function m_(s,e=l_){const t=[];let n=s.slice();for(const r of s){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),ef(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ef(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class d_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sv()?nv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await a_(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function ef(s){return xl(JSON.stringify({version:2,heartbeats:s})).length}function f_(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(s){ta(new Qi("platform-logger",e=>new Ev(e),"PRIVATE")),ta(new Qi("heartbeat",e=>new u_(e),"PRIVATE")),Er(pu,Yd,s),Er(pu,Yd,"esm2020"),Er("fire-js","")}p_("");var h_="firebase",g_="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er(h_,g_,"app");var tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cr,Xh;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,x){function E(){}E.prototype=x.prototype,C.F=x.prototype,C.prototype=new E,C.prototype.constructor=C,C.D=function(j,L,T){for(var k=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)k[_e-2]=arguments[_e];return x.prototype[L].apply(j,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,x,E){E||(E=0);const j=Array(16);if(typeof x=="string")for(var L=0;L<16;++L)j[L]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(L=0;L<16;++L)j[L]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=C.g[0],E=C.g[1],L=C.g[2];let T=C.g[3],k;k=x+(T^E&(L^T))+j[0]+3614090360&4294967295,x=E+(k<<7&4294967295|k>>>25),k=T+(L^x&(E^L))+j[1]+3905402710&4294967295,T=x+(k<<12&4294967295|k>>>20),k=L+(E^T&(x^E))+j[2]+606105819&4294967295,L=T+(k<<17&4294967295|k>>>15),k=E+(x^L&(T^x))+j[3]+3250441966&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(T^E&(L^T))+j[4]+4118548399&4294967295,x=E+(k<<7&4294967295|k>>>25),k=T+(L^x&(E^L))+j[5]+1200080426&4294967295,T=x+(k<<12&4294967295|k>>>20),k=L+(E^T&(x^E))+j[6]+2821735955&4294967295,L=T+(k<<17&4294967295|k>>>15),k=E+(x^L&(T^x))+j[7]+4249261313&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(T^E&(L^T))+j[8]+1770035416&4294967295,x=E+(k<<7&4294967295|k>>>25),k=T+(L^x&(E^L))+j[9]+2336552879&4294967295,T=x+(k<<12&4294967295|k>>>20),k=L+(E^T&(x^E))+j[10]+4294925233&4294967295,L=T+(k<<17&4294967295|k>>>15),k=E+(x^L&(T^x))+j[11]+2304563134&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(T^E&(L^T))+j[12]+1804603682&4294967295,x=E+(k<<7&4294967295|k>>>25),k=T+(L^x&(E^L))+j[13]+4254626195&4294967295,T=x+(k<<12&4294967295|k>>>20),k=L+(E^T&(x^E))+j[14]+2792965006&4294967295,L=T+(k<<17&4294967295|k>>>15),k=E+(x^L&(T^x))+j[15]+1236535329&4294967295,E=L+(k<<22&4294967295|k>>>10),k=x+(L^T&(E^L))+j[1]+4129170786&4294967295,x=E+(k<<5&4294967295|k>>>27),k=T+(E^L&(x^E))+j[6]+3225465664&4294967295,T=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(T^x))+j[11]+643717713&4294967295,L=T+(k<<14&4294967295|k>>>18),k=E+(T^x&(L^T))+j[0]+3921069994&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^T&(E^L))+j[5]+3593408605&4294967295,x=E+(k<<5&4294967295|k>>>27),k=T+(E^L&(x^E))+j[10]+38016083&4294967295,T=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(T^x))+j[15]+3634488961&4294967295,L=T+(k<<14&4294967295|k>>>18),k=E+(T^x&(L^T))+j[4]+3889429448&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^T&(E^L))+j[9]+568446438&4294967295,x=E+(k<<5&4294967295|k>>>27),k=T+(E^L&(x^E))+j[14]+3275163606&4294967295,T=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(T^x))+j[3]+4107603335&4294967295,L=T+(k<<14&4294967295|k>>>18),k=E+(T^x&(L^T))+j[8]+1163531501&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(L^T&(E^L))+j[13]+2850285829&4294967295,x=E+(k<<5&4294967295|k>>>27),k=T+(E^L&(x^E))+j[2]+4243563512&4294967295,T=x+(k<<9&4294967295|k>>>23),k=L+(x^E&(T^x))+j[7]+1735328473&4294967295,L=T+(k<<14&4294967295|k>>>18),k=E+(T^x&(L^T))+j[12]+2368359562&4294967295,E=L+(k<<20&4294967295|k>>>12),k=x+(E^L^T)+j[5]+4294588738&4294967295,x=E+(k<<4&4294967295|k>>>28),k=T+(x^E^L)+j[8]+2272392833&4294967295,T=x+(k<<11&4294967295|k>>>21),k=L+(T^x^E)+j[11]+1839030562&4294967295,L=T+(k<<16&4294967295|k>>>16),k=E+(L^T^x)+j[14]+4259657740&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^T)+j[1]+2763975236&4294967295,x=E+(k<<4&4294967295|k>>>28),k=T+(x^E^L)+j[4]+1272893353&4294967295,T=x+(k<<11&4294967295|k>>>21),k=L+(T^x^E)+j[7]+4139469664&4294967295,L=T+(k<<16&4294967295|k>>>16),k=E+(L^T^x)+j[10]+3200236656&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^T)+j[13]+681279174&4294967295,x=E+(k<<4&4294967295|k>>>28),k=T+(x^E^L)+j[0]+3936430074&4294967295,T=x+(k<<11&4294967295|k>>>21),k=L+(T^x^E)+j[3]+3572445317&4294967295,L=T+(k<<16&4294967295|k>>>16),k=E+(L^T^x)+j[6]+76029189&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(E^L^T)+j[9]+3654602809&4294967295,x=E+(k<<4&4294967295|k>>>28),k=T+(x^E^L)+j[12]+3873151461&4294967295,T=x+(k<<11&4294967295|k>>>21),k=L+(T^x^E)+j[15]+530742520&4294967295,L=T+(k<<16&4294967295|k>>>16),k=E+(L^T^x)+j[2]+3299628645&4294967295,E=L+(k<<23&4294967295|k>>>9),k=x+(L^(E|~T))+j[0]+4096336452&4294967295,x=E+(k<<6&4294967295|k>>>26),k=T+(E^(x|~L))+j[7]+1126891415&4294967295,T=x+(k<<10&4294967295|k>>>22),k=L+(x^(T|~E))+j[14]+2878612391&4294967295,L=T+(k<<15&4294967295|k>>>17),k=E+(T^(L|~x))+j[5]+4237533241&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~T))+j[12]+1700485571&4294967295,x=E+(k<<6&4294967295|k>>>26),k=T+(E^(x|~L))+j[3]+2399980690&4294967295,T=x+(k<<10&4294967295|k>>>22),k=L+(x^(T|~E))+j[10]+4293915773&4294967295,L=T+(k<<15&4294967295|k>>>17),k=E+(T^(L|~x))+j[1]+2240044497&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~T))+j[8]+1873313359&4294967295,x=E+(k<<6&4294967295|k>>>26),k=T+(E^(x|~L))+j[15]+4264355552&4294967295,T=x+(k<<10&4294967295|k>>>22),k=L+(x^(T|~E))+j[6]+2734768916&4294967295,L=T+(k<<15&4294967295|k>>>17),k=E+(T^(L|~x))+j[13]+1309151649&4294967295,E=L+(k<<21&4294967295|k>>>11),k=x+(L^(E|~T))+j[4]+4149444226&4294967295,x=E+(k<<6&4294967295|k>>>26),k=T+(E^(x|~L))+j[11]+3174756917&4294967295,T=x+(k<<10&4294967295|k>>>22),k=L+(x^(T|~E))+j[2]+718787259&4294967295,L=T+(k<<15&4294967295|k>>>17),k=E+(T^(L|~x))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+x&4294967295,C.g[1]=C.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+T&4294967295}n.prototype.v=function(C,x){x===void 0&&(x=C.length);const E=x-this.blockSize,j=this.C;let L=this.h,T=0;for(;T<x;){if(L==0)for(;T<=E;)r(this,C,T),T+=this.blockSize;if(typeof C=="string"){for(;T<x;)if(j[L++]=C.charCodeAt(T++),L==this.blockSize){r(this,j),L=0;break}}else for(;T<x;)if(j[L++]=C[T++],L==this.blockSize){r(this,j),L=0;break}}this.h=L,this.o+=x},n.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var x=1;x<C.length-8;++x)C[x]=0;x=this.o*8;for(var E=C.length-8;E<C.length;++E)C[E]=x&255,x/=256;for(this.v(C),C=Array(16),x=0,E=0;E<4;++E)for(let j=0;j<32;j+=8)C[x++]=this.g[E]>>>j&255;return C};function i(C,x){var E=l;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=x(C)}function o(C,x){this.h=x;const E=[];let j=!0;for(let L=C.length-1;L>=0;L--){const T=C[L]|0;j&&T==x||(E[L]=T,j=!1)}this.g=E}var l={};function u(C){return-128<=C&&C<128?i(C,function(x){return new o([x|0],x<0?-1:0)}):new o([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return f;if(C<0)return w(m(-C));const x=[];let E=1;for(let j=0;C>=E;j++)x[j]=C/E|0,E*=4294967296;return new o(x,0)}function d(C,x){if(C.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(C.charAt(0)=="-")return w(d(C.substring(1),x));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=m(Math.pow(x,8));let j=f;for(let T=0;T<C.length;T+=8){var L=Math.min(8,C.length-T);const k=parseInt(C.substring(T,T+L),x);L<8?(L=m(Math.pow(x,L)),j=j.j(L).add(m(k))):(j=j.j(E),j=j.add(m(k)))}return j}var f=u(0),h=u(1),b=u(16777216);s=o.prototype,s.m=function(){if(v(this))return-w(this).m();let C=0,x=1;for(let E=0;E<this.g.length;E++){const j=this.i(E);C+=(j>=0?j:4294967296+j)*x,x*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(V(this))return"0";if(v(this))return"-"+w(this).toString(C);const x=m(Math.pow(C,6));var E=this;let j="";for(;;){const L=oe(E,x).g;E=B(E,L.j(x));let T=((E.g.length>0?E.g[0]:E.h)>>>0).toString(C);if(E=L,V(E))return T+j;for(;T.length<6;)T="0"+T;j=T+j}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function V(C){if(C.h!=0)return!1;for(let x=0;x<C.g.length;x++)if(C.g[x]!=0)return!1;return!0}function v(C){return C.h==-1}s.l=function(C){return C=B(this,C),v(C)?-1:V(C)?0:1};function w(C){const x=C.g.length,E=[];for(let j=0;j<x;j++)E[j]=~C.g[j];return new o(E,~C.h).add(h)}s.abs=function(){return v(this)?w(this):this},s.add=function(C){const x=Math.max(this.g.length,C.g.length),E=[];let j=0;for(let L=0;L<=x;L++){let T=j+(this.i(L)&65535)+(C.i(L)&65535),k=(T>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);j=k>>>16,T&=65535,k&=65535,E[L]=k<<16|T}return new o(E,E[E.length-1]&-2147483648?-1:0)};function B(C,x){return C.add(w(x))}s.j=function(C){if(V(this)||V(C))return f;if(v(this))return v(C)?w(this).j(w(C)):w(w(this).j(C));if(v(C))return w(this.j(w(C)));if(this.l(b)<0&&C.l(b)<0)return m(this.m()*C.m());const x=this.g.length+C.g.length,E=[];for(var j=0;j<2*x;j++)E[j]=0;for(j=0;j<this.g.length;j++)for(let L=0;L<C.g.length;L++){const T=this.i(j)>>>16,k=this.i(j)&65535,_e=C.i(L)>>>16,Ue=C.i(L)&65535;E[2*j+2*L]+=k*Ue,P(E,2*j+2*L),E[2*j+2*L+1]+=T*Ue,P(E,2*j+2*L+1),E[2*j+2*L+1]+=k*_e,P(E,2*j+2*L+1),E[2*j+2*L+2]+=T*_e,P(E,2*j+2*L+2)}for(C=0;C<x;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=x;C<2*x;C++)E[C]=0;return new o(E,0)};function P(C,x){for(;(C[x]&65535)!=C[x];)C[x+1]+=C[x]>>>16,C[x]&=65535,x++}function F(C,x){this.g=C,this.h=x}function oe(C,x){if(V(x))throw Error("division by zero");if(V(C))return new F(f,f);if(v(C))return x=oe(w(C),x),new F(w(x.g),w(x.h));if(v(x))return x=oe(C,w(x)),new F(w(x.g),x.h);if(C.g.length>30){if(v(C)||v(x))throw Error("slowDivide_ only works with positive integers.");for(var E=h,j=x;j.l(C)<=0;)E=se(E),j=se(j);var L=M(E,1),T=M(j,1);for(j=M(j,2),E=M(E,2);!V(j);){var k=T.add(j);k.l(C)<=0&&(L=L.add(E),T=k),j=M(j,1),E=M(E,1)}return x=B(C,L.j(x)),new F(L,x)}for(L=f;C.l(x)>=0;){for(E=Math.max(1,Math.floor(C.m()/x.m())),j=Math.ceil(Math.log(E)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),T=m(E),k=T.j(x);v(k)||k.l(C)>0;)E-=j,T=m(E),k=T.j(x);V(T)&&(T=h),L=L.add(T),C=B(C,k)}return new F(L,C)}s.B=function(C){return oe(this,C).h},s.and=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)&C.i(j);return new o(E,this.h&C.h)},s.or=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)|C.i(j);return new o(E,this.h|C.h)},s.xor=function(C){const x=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<x;j++)E[j]=this.i(j)^C.i(j);return new o(E,this.h^C.h)};function se(C){const x=C.g.length+1,E=[];for(let j=0;j<x;j++)E[j]=C.i(j)<<1|C.i(j-1)>>>31;return new o(E,C.h)}function M(C,x){const E=x>>5;x%=32;const j=C.g.length-E,L=[];for(let T=0;T<j;T++)L[T]=x>0?C.i(T+E)>>>x|C.i(T+E+1)<<32-x:C.i(T+E);return new o(L,C.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Xh=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Cr=o}).apply(typeof tf<"u"?tf:typeof self<"u"?self:typeof window<"u"?window:{});var Ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jh,Bo,Zh,ll,yu,eg,tg,sg;(function(){var s,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ba=="object"&&Ba];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=t(this);function r(c,p){if(p)e:{var g=n;c=c.split(".");for(var D=0;D<c.length-1;D++){var $=c[D];if(!($ in g))break e;g=g[$]}c=c[c.length-1],D=g[c],p=p(D),p!=D&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],D;for(D in p)Object.prototype.hasOwnProperty.call(p,D)&&g.push([D,p[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),c.apply(this,D)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(D,$,X){for(var ve=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)ve[dt-2]=arguments[dt];return p.prototype[$].apply(D,ve)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function b(c){const p=c.length;if(p>0){const g=Array(p);for(let D=0;D<p;D++)g[D]=c[D];return g}return[]}function V(c,p){for(let D=1;D<arguments.length;D++){const $=arguments[D];var g=typeof $;if(g=g!="object"?g:$?Array.isArray($)?"array":g:"null",g=="array"||g=="object"&&typeof $.length=="number"){g=c.length||0;const X=$.length||0;c.length=g+X;for(let ve=0;ve<X;ve++)c[g+ve]=$[ve]}else c.push($)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(c){o.setTimeout(()=>{throw c},0)}function B(){var c=C;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class P{constructor(){this.h=this.g=null}add(p,g){const D=F.get();D.set(p,g),this.h?this.h.next=D:this.g=D,this.h=D}}var F=new v(()=>new oe,c=>c.reset());class oe{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let se,M=!1,C=new P,x=()=>{const c=Promise.resolve(void 0);se=()=>{c.then(E)}};function E(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){w(g)}var p=F;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}M=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function _e(c,p){L.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(_e,L),_e.prototype.init=function(c,p){const g=this.type=c.type,D=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ue="closure_listenable_"+(Math.random()*1e6|0),pe=0;function je(c,p,g,D,$){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!D,this.ha=$,this.key=++pe,this.da=this.fa=!1}function ft(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function qt(c,p,g){for(const D in c)p.call(g,c[D],D,c)}function Ht(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const He="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(c,p){let g,D;for(let $=1;$<arguments.length;$++){D=arguments[$];for(g in D)c[g]=D[g];for(let X=0;X<He.length;X++)g=He[X],Object.prototype.hasOwnProperty.call(D,g)&&(c[g]=D[g])}}function Le(c){this.src=c,this.g={},this.h=0}Le.prototype.add=function(c,p,g,D,$){const X=c.toString();c=this.g[X],c||(c=this.g[X]=[],this.h++);const ve=bt(c,p,D,$);return ve>-1?(p=c[ve],g||(p.fa=!1)):(p=new je(p,this.src,X,!!D,$),p.fa=g,c.push(p)),p};function ze(c,p){const g=p.type;if(g in c.g){var D=c.g[g],$=Array.prototype.indexOf.call(D,p,void 0),X;(X=$>=0)&&Array.prototype.splice.call(D,$,1),X&&(ft(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function bt(c,p,g,D){for(let $=0;$<c.length;++$){const X=c[$];if(!X.da&&X.listener==p&&X.capture==!!g&&X.ha==D)return $}return-1}var it="closure_lm_"+(Math.random()*1e6|0),St={};function nt(c,p,g,D,$){if(Array.isArray(p)){for(let X=0;X<p.length;X++)nt(c,p[X],g,D,$);return null}return g=$t(g),c&&c[Ue]?c.J(p,g,l(D)?!!D.capture:!1,$):ut(c,p,g,!1,D,$)}function ut(c,p,g,D,$,X){if(!p)throw Error("Invalid event type");const ve=l($)?!!$.capture:!!$;let dt=Ye(c);if(dt||(c[it]=dt=new Le(c)),g=dt.add(p,g,D,ve,X),g.proxy)return g;if(D=ms(),g.proxy=D,D.src=c,D.listener=g,c.addEventListener)T||($=ve),$===void 0&&($=!1),c.addEventListener(p.toString(),D,$);else if(c.attachEvent)c.attachEvent(Re(p.toString()),D);else if(c.addListener&&c.removeListener)c.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ms(){function c(g){return p.call(c.src,c.listener,g)}const p=we;return c}function K(c,p,g,D,$){if(Array.isArray(p))for(var X=0;X<p.length;X++)K(c,p[X],g,D,$);else D=l(D)?!!D.capture:!!D,g=$t(g),c&&c[Ue]?(c=c.i,X=String(p).toString(),X in c.g&&(p=c.g[X],g=bt(p,g,D,$),g>-1&&(ft(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[X],c.h--)))):c&&(c=Ye(c))&&(p=c.g[p.toString()],c=-1,p&&(c=bt(p,g,D,$)),(g=c>-1?p[c]:null)&&Te(g))}function Te(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Ue])ze(p.i,c);else{var g=c.type,D=c.proxy;p.removeEventListener?p.removeEventListener(g,D,c.capture):p.detachEvent?p.detachEvent(Re(g),D):p.addListener&&p.removeListener&&p.removeListener(D),(g=Ye(p))?(ze(g,c),g.h==0&&(g.src=null,p[it]=null)):ft(c)}}}function Re(c){return c in St?St[c]:St[c]="on"+c}function we(c,p){if(c.da)c=!0;else{p=new _e(p,this);const g=c.listener,D=c.ha||c.src;c.fa&&Te(c),c=g.call(D,p)}return c}function Ye(c){return c=c[it],c instanceof Le?c:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(c){return typeof c=="function"?c:(c[Tt]||(c[Tt]=function(p){return c.handleEvent(p)}),c[Tt])}function ct(){j.call(this),this.i=new Le(this),this.M=this,this.G=null}f(ct,j),ct.prototype[Ue]=!0,ct.prototype.removeEventListener=function(c,p,g,D){K(this,c,p,g,D)};function I(c,p){var g,D=c.G;if(D)for(g=[];D;D=D.G)g.push(D);if(c=c.M,D=p.type||p,typeof p=="string")p=new L(p,c);else if(p instanceof L)p.target=p.target||c;else{var $=p;p=new L(D,c),de(p,$)}$=!0;let X,ve;if(g)for(ve=g.length-1;ve>=0;ve--)X=p.g=g[ve],$=O(X,D,!0,p)&&$;if(X=p.g=c,$=O(X,D,!0,p)&&$,$=O(X,D,!1,p)&&$,g)for(ve=0;ve<g.length;ve++)X=p.g=g[ve],$=O(X,D,!1,p)&&$}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let D=0;D<g.length;D++)ft(g[D]);delete c.g[p],c.h--}}this.G=null},ct.prototype.J=function(c,p,g,D){return this.i.add(String(c),p,!1,g,D)},ct.prototype.K=function(c,p,g,D){return this.i.add(String(c),p,!0,g,D)};function O(c,p,g,D){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let $=!0;for(let X=0;X<p.length;++X){const ve=p[X];if(ve&&!ve.da&&ve.capture==g){const dt=ve.listener,Cs=ve.ha||ve.src;ve.fa&&ze(c.i,ve),$=dt.call(Cs,D)!==!1&&$}}return $&&!D.defaultPrevented}function Z(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function ye(c){c.g=Z(()=>{c.g=null,c.i&&(c.i=!1,ye(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ue extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){j.call(this),this.h=c,this.g={}}f(fe,j);var Ce=[];function Me(c){qt(c.g,function(p,g){this.g.hasOwnProperty(g)&&Te(p)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),Me(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var tt=o.JSON.stringify,Ae=o.JSON.parse,Rs=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function jt(){}function ee(){}var Ge={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function H(){L.call(this,"d")}f(H,L);function be(){L.call(this,"c")}f(be,L);var De={},Pe=null;function me(){return Pe=Pe||new ct}De.Ia="serverreachability";function Mt(c){L.call(this,De.Ia,c)}f(Mt,L);function mt(c){const p=me();I(p,new Mt(p))}De.STAT_EVENT="statevent";function Wt(c,p){L.call(this,De.STAT_EVENT,c),this.stat=p}f(Wt,L);function At(c){const p=me();I(p,new Wt(p,c))}De.Ja="timingevent";function ds(c,p){L.call(this,De.Ja,c),this.size=p}f(ds,L);function ss(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Ts(){this.g=!0}Ts.prototype.ua=function(){this.g=!1};function fn(c,p,g,D,$,X){c.info(function(){if(c.g)if(X){var ve="",dt=X.split("&");for(let Qt=0;Qt<dt.length;Qt++){var Cs=dt[Qt].split("=");if(Cs.length>1){const Ls=Cs[0];Cs=Cs[1];const jn=Ls.split("_");ve=jn.length>=2&&jn[1]=="type"?ve+(Ls+"="+Cs+"&"):ve+(Ls+"=redacted&")}}}else ve=null;else ve=X;return"XMLHTTP REQ ("+D+") [attempt "+$+"]: "+p+`
`+g+`
`+ve})}function Qs(c,p,g,D,$,X,ve){c.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+$+"]: "+p+`
`+g+`
`+X+" "+ve})}function pn(c,p,g,D){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Tn(c,g)+(D?" "+D:"")})}function Kr(c,p){c.info(function(){return"TIMEOUT: "+p})}Ts.prototype.info=function(){};function Tn(c,p){if(!c.g)return p;if(!p)return null;try{const X=JSON.parse(p);if(X){for(c=0;c<X.length;c++)if(Array.isArray(X[c])){var g=X[c];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var $=D[0];if($!="noop"&&$!="stop"&&$!="close")for(let ve=1;ve<D.length;ve++)D[ve]=""}}}}return tt(X)}catch{return p}}var en={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ln={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_;function Q(){}f(Q,jt),Q.prototype.g=function(){return new XMLHttpRequest},_=new Q;function y(c){return encodeURIComponent(String(c))}function R(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function S(c,p,g,D){this.j=c,this.i=p,this.l=g,this.S=D||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new q}function q(){this.i=null,this.g="",this.h=!1}var J={},W={};function G(c,p,g){c.M=1,c.A=Ni(Zt(p)),c.u=g,c.R=!0,te(c,null)}function te(c,p){c.F=Date.now(),Ne(c),c.B=Zt(c.A);var g=c.B,D=c.S;Array.isArray(D)||(D=[String(D)]),le(g.i,"t",D),c.C=0,g=c.j.L,c.h=new q,c.g=Ad(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ue(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,D=c.ba;var $="readystatechange";Array.isArray($)||($&&(Ce[0]=$.toString()),$=Ce);for(let X=0;X<$.length;X++){const ve=nt(g,$[X],D||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),mt(),fn(c.i,c.v,c.B,c.l,c.S,c.u)}S.prototype.ba=function(c){c=c.target;const p=this.O;p&&xn(c)==3?p.j():this.Y(c)},S.prototype.Y=function(c){try{if(c==this.g)e:{const dt=xn(this.g),Cs=this.g.ya(),Qt=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||pd(this.g)))){this.K||dt!=4||Cs==7||(Cs==8||Qt<=0?mt(3):mt(2)),Yt(this);var p=this.g.ca();this.X=p;var g=Oe(this);if(this.o=p==200,Qs(this.i,this.v,this.B,this.l,this.S,dt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var D,$=this.g;if((D=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(D)){var X=D;break t}}X=null}if(c=X)pn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gt(this,c);else{this.o=!1,this.m=3,At(12),fs(this),Dt(this);break e}}if(this.R){c=!0;let Ls;for(;!this.K&&this.C<g.length;)if(Ls=Fe(this,g),Ls==W){dt==4&&(this.m=4,At(14),c=!1),pn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ls==J){this.m=4,At(15),pn(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else pn(this.i,this.l,Ls,null),Gt(this,Ls);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||g.length!=0||this.h.h||(this.m=1,At(16),c=!1),this.o=this.o&&c,!c)pn(this.i,this.l,g,"[Invalid Chunked Response]"),fs(this),Dt(this);else if(g.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Cc(ve),ve.P=!0,At(11))}}else pn(this.i,this.l,g,null),Gt(this,g);dt==4&&fs(this),this.o&&!this.K&&(dt==4?vd(this.j,this):(this.o=!1,Ne(this)))}else fN(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),fs(this),Dt(this)}}}catch{}finally{}};function Oe(c){if(!Ke(c))return c.g.la();const p=pd(c.g);if(p==="")return"";let g="";const D=p.length,$=xn(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return fs(c),Dt(c),"";c.h.i=new o.TextDecoder}for(let X=0;X<D;X++)c.h.h=!0,g+=c.h.i.decode(p[X],{stream:!($&&X==D-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Ke(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Fe(c,p){var g=c.C,D=p.indexOf(`
`,g);return D==-1?W:(g=Number(p.substring(g,D)),isNaN(g)?J:(D+=1,D+g>p.length?W:(p=p.slice(D,D+g),c.C=D+g,p)))}S.prototype.cancel=function(){this.K=!0,fs(this)};function Ne(c){c.T=Date.now()+c.H,Ze(c,c.H)}function Ze(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ss(m(c.aa,c),p)}function Yt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}S.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Kr(this.i,this.B),this.M!=2&&(mt(),At(17)),fs(this),this.m=2,Dt(this)):Ze(this,this.T-c)};function Dt(c){c.j.I==0||c.K||vd(c.j,c)}function fs(c){Yt(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Me(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Gt(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||ke(g.h,c))){if(!c.L&&ke(g.h,c)&&g.I==3){try{var D=g.Ba.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var $=D;if($[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Ta(g),wa(g);else break e;Ec(g),At(18)}}else g.xa=$[1],0<g.xa-g.K&&$[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ss(m(g.Va,g),6e3));We(g.h)<=1&&g.ta&&(g.ta=void 0)}else Qr(g,11)}else if((c.L||g.g==c)&&Ta(g),!k(p))for($=g.Ba.g.parse(p),p=0;p<$.length;p++){let Qt=$[p];const Ls=Qt[0];if(!(Ls<=g.K))if(g.K=Ls,Qt=Qt[1],g.I==2)if(Qt[0]=="c"){g.M=Qt[1],g.ba=Qt[2];const jn=Qt[3];jn!=null&&(g.ka=jn,g.j.info("VER="+g.ka));const Yr=Qt[4];Yr!=null&&(g.za=Yr,g.j.info("SVER="+g.za));const mr=Qt[5];mr!=null&&typeof mr=="number"&&mr>0&&(D=1.5*mr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const dr=c.g;if(dr){const Pa=dr.g?dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pa){var X=D.h;X.g||Pa.indexOf("spdy")==-1&&Pa.indexOf("quic")==-1&&Pa.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Qe(X,X.h),X.h=null))}if(D.G){const Vc=dr.g?dr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vc&&(D.wa=Vc,yt(D.J,D.G,Vc))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var ve=c;if(D.na=kd(D,D.L?D.ba:null,D.W),ve.L){Je(D.h,ve);var dt=ve,Cs=D.O;Cs&&(dt.H=Cs),dt.D&&(Yt(dt),Ne(dt)),D.g=ve}else Nd(D);g.i.length>0&&Sa(g)}else Qt[0]!="stop"&&Qt[0]!="close"||Qr(g,7);else g.I==3&&(Qt[0]=="stop"||Qt[0]=="close"?Qt[0]=="stop"?Qr(g,7):Ac(g):Qt[0]!="noop"&&g.l&&g.l.qa(Qt),g.A=0)}}mt(4)}catch{}}var Ys=class{constructor(c,p){this.g=c,this.map=p}};function Gs(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ot(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function We(c){return c.h?1:c.g?c.g.size:0}function ke(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Qe(c,p){c.g?c.g.add(p):c.h=p}function Je(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Gs.prototype.cancel=function(){if(this.i=Nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Nt(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return b(c.i)}var Be=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rt(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const D=c[g].indexOf("=");let $,X=null;D>=0?($=c[g].substring(0,D),X=c[g].substring(D+1)):$=c[g],p($,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function gt(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof gt?(this.l=c.l,is(this,c.j),this.o=c.o,this.g=c.g,Pn(this,c.u),this.h=c.h,bi(this,ge(c.i)),this.m=c.m):c&&(p=String(c).match(Be))?(this.l=!1,is(this,p[1]||"",!0),this.o=lr(p[2]||""),this.g=lr(p[3]||"",!0),Pn(this,p[4]),this.h=lr(p[5]||"",!0),bi(this,p[6]||"",!0),this.m=lr(p[7]||"")):(this.l=!1,this.i=new ur(null,this.l))}gt.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(cr(p,go,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(cr(p,go,!0),"@"),c.push(y(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(cr(g,g.charAt(0)=="/"?vc:Va,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",cr(g,Dc)),c.join("")},gt.prototype.resolve=function(c){const p=Zt(this);let g=!!c.j;g?is(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var D=c.h;if(g)Pn(p,c.u);else if(g=!!c.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var $=p.h.lastIndexOf("/");$!=-1&&(D=p.h.slice(0,$+1)+D)}if($=D,$==".."||$==".")D="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){D=$.lastIndexOf("/",0)==0,$=$.split("/");const X=[];for(let ve=0;ve<$.length;){const dt=$[ve++];dt=="."?D&&ve==$.length&&X.push(""):dt==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),D&&ve==$.length&&X.push("")):(X.push(dt),D=!0)}D=X.join("/")}else D=$}return g?p.h=D:g=c.i.toString()!=="",g?bi(p,ge(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Zt(c){return new gt(c)}function is(c,p,g){c.j=g?lr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Pn(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function bi(c,p,g){p instanceof ur?(c.i=p,at(c.i,c.l)):(g||(p=cr(p,_c)),c.i=new ur(p,c.l))}function yt(c,p,g){c.i.set(p,g)}function Ni(c){return yt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function lr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function cr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Ca),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ca(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var go=/[#\/\?@]/g,Va=/[#\?:]/g,vc=/[#\?]/g,_c=/[#\?@]/g,Dc=/#/g;function ur(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function N(c){c.g||(c.g=new Map,c.h=0,c.i&&rt(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}s=ur.prototype,s.add=function(c,p){N(this),this.i=null,c=he(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function U(c,p){N(c),p=he(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y(c,p){return N(c),p=he(c,p),c.g.has(p)}s.forEach=function(c,p){N(this),this.g.forEach(function(g,D){g.forEach(function($){c.call(p,$,D,this)},this)},this)};function z(c,p){N(c);let g=[];if(typeof p=="string")Y(c,p)&&(g=g.concat(c.g.get(he(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}s.set=function(c,p){return N(this),this.i=null,c=he(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},s.get=function(c,p){return c?(c=z(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){U(c,p),g.length>0&&(c.i=null,c.g.set(he(c,p),b(g)),c.h+=g.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let D=0;D<p.length;D++){var g=p[D];const $=y(g);g=z(this,g);for(let X=0;X<g.length;X++){let ve=$;g[X]!==""&&(ve+="="+y(g[X])),c.push(ve)}}return this.i=c.join("&")};function ge(c){const p=new ur;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function he(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function at(c,p){p&&!c.j&&(N(c),c.i=null,c.g.forEach(function(g,D){const $=D.toLowerCase();D!=$&&(U(this,D),le(this,$,g))},c)),c.j=p}function pt(c,p){const g=new Ts;if(o.Image){const D=new Image;D.onload=d(Lt,g,"TestLoadImage: loaded",!0,p,D),D.onerror=d(Lt,g,"TestLoadImage: error",!1,p,D),D.onabort=d(Lt,g,"TestLoadImage: abort",!1,p,D),D.ontimeout=d(Lt,g,"TestLoadImage: timeout",!1,p,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=c}else p(!1)}function gs(c,p){const g=new Ts,D=new AbortController,$=setTimeout(()=>{D.abort(),Lt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:D.signal}).then(X=>{clearTimeout($),X.ok?Lt(g,"TestPingServer: ok",!0,p):Lt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout($),Lt(g,"TestPingServer: error",!1,p)})}function Lt(c,p,g,D,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),D(g)}catch{}}function Pt(){this.g=new Rs}function ns(c){this.i=c.Sb||null,this.h=c.ab||!1}f(ns,jt),ns.prototype.g=function(){return new Es(this.i,this.h)};function Es(c,p){ct.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Es,ct),s=Es.prototype,s.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ps(this)},s.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,es(this)),this.readyState=0},s.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Et(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Et(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}s.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?es(this):ps(this),this.readyState==3&&Et(this)}},s.Oa=function(c){this.g&&(this.response=this.responseText=c,es(this))},s.Na=function(c){this.g&&(this.response=c,es(this))},s.ga=function(){this.g&&es(this)};function es(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ps(c)}s.setRequestHeader=function(c,p){this.A.append(c,p)},s.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function ps(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function zt(c){let p="";return qt(c,function(g,D){p+=D,p+=":",p+=g,p+=`\r
`}),p}function Kt(c,p,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=zt(g),typeof c=="string"?g!=null&&y(g):yt(c,p,g))}function ht(c){ct.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ht,ct);var Jt=/^https?$/i,Nn=["POST","PUT"];s=ht.prototype,s.Fa=function(c){this.H=c},s.ea=function(c,p,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(X){In(this,X);return}if(c=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var $ in D)g.set($,D[$]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const X of D.keys())g.set(X,D.get(X));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(X=>X.toLowerCase()=="content-type"),$=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Nn,p,void 0)>=0)||D||$||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ve]of g)this.g.setRequestHeader(X,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(X){In(this,X)}};function In(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,xi(c),vi(c)}function xi(c){c.A||(c.A=!0,I(c,"complete"),I(c,"error"))}s.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,I(this,"complete"),I(this,"abort"),vi(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vi(this,!0)),ht.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kc(this):this.Xa())},s.Xa=function(){kc(this)};function kc(c){if(c.h&&typeof i<"u"){if(c.v&&xn(c)==4)setTimeout(c.Ca.bind(c),0);else if(I(c,"readystatechange"),xn(c)==4){c.h=!1;try{const X=c.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var D;if(D=X===0){let ve=String(c.D).match(Be)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),D=!Jt.test(ve?ve.toLowerCase():"")}g=D}if(g)I(c,"complete"),I(c,"success");else{c.o=6;try{var $=xn(c)>2?c.g.statusText:""}catch{$=""}c.l=$+" ["+c.ca()+"]",xi(c)}}finally{vi(c)}}}}function vi(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||I(c,"ready");try{g.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function xn(c){return c.g?c.g.readyState:0}s.ca=function(){try{return xn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ae(p)}};function pd(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function fN(c){const p={};c=(c.g&&xn(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<c.length;D++){if(k(c[D]))continue;var g=R(c[D]);const $=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const X=p[$]||[];p[$]=X,X.push(g)}Ht(p,function(D){return D.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yo(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function hd(c){this.za=0,this.i=[],this.j=new Ts,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yo("baseRetryDelayMs",5e3,c),this.Za=yo("retryDelaySeedMs",1e4,c),this.Ta=yo("forwardChannelMaxRetries",2,c),this.va=yo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Gs(c&&c.concurrentRequestLimit),this.Ba=new Pt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=hd.prototype,s.ka=8,s.I=1,s.connect=function(c,p,g,D){At(0),this.W=c,this.H=p||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=kd(this,null,this.W),Sa(this)};function Ac(c){if(gd(c),c.I==3){var p=c.V++,g=Zt(c.J);if(yt(g,"SID",c.M),yt(g,"RID",p),yt(g,"TYPE","terminate"),bo(c,g),p=new S(c,c.j,p),p.M=2,p.A=Ni(Zt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Ad(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Ne(p)}Dd(c)}function wa(c){c.g&&(Cc(c),c.g.cancel(),c.g=null)}function gd(c){wa(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ta(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Sa(c){if(!Ot(c.h)&&!c.m){c.m=!0;var p=c.Ea;se||x(),M||(se(),M=!0),C.add(p,c),c.D=0}}function pN(c,p){return We(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ss(m(c.Ea,c,p),_d(c,c.D)),c.D++,!0)}s.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const $=new S(this,this.j,c);let X=this.o;if(this.U&&(X?(X=ae(X),de(X,this.U)):X=this.U),this.u!==null||this.R||($.J=X,X=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=bd(this,$,p),g=Zt(this.J),yt(g,"RID",c),yt(g,"CVER",22),this.G&&yt(g,"X-HTTP-Session-Id",this.G),bo(this,g),X&&(this.R?p="headers="+y(zt(X))+"&"+p:this.u&&Kt(g,this.u,X)),Qe(this.h,$),this.Ra&&yt(g,"TYPE","init"),this.S?(yt(g,"$req",p),yt(g,"SID","null"),$.U=!0,G($,g,null)):G($,g,p),this.I=2}}else this.I==3&&(c?yd(this,c):this.i.length==0||Ot(this.h)||yd(this))};function yd(c,p){var g;p?g=p.l:g=c.V++;const D=Zt(c.J);yt(D,"SID",c.M),yt(D,"RID",g),yt(D,"AID",c.K),bo(c,D),c.u&&c.o&&Kt(D,c.u,c.o),g=new S(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=bd(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Qe(c.h,g),G(g,D,p)}function bo(c,p){c.H&&qt(c.H,function(g,D){yt(p,D,g)}),c.l&&qt({},function(g,D){yt(p,D,g)})}function bd(c,p,g){g=Math.min(c.i.length,g);const D=c.l?m(c.l.Ka,c.l,c):null;e:{var $=c.i;let dt=-1;for(;;){const Cs=["count="+g];dt==-1?g>0?(dt=$[0].g,Cs.push("ofs="+dt)):dt=0:Cs.push("ofs="+dt);let Qt=!0;for(let Ls=0;Ls<g;Ls++){var X=$[Ls].g;const jn=$[Ls].map;if(X-=dt,X<0)dt=Math.max(0,$[Ls].g-100),Qt=!1;else try{X="req"+X+"_"||"";try{var ve=jn instanceof Map?jn:Object.entries(jn);for(const[Yr,mr]of ve){let dr=mr;l(mr)&&(dr=tt(mr)),Cs.push(X+Yr+"="+encodeURIComponent(dr))}}catch(Yr){throw Cs.push(X+"type="+encodeURIComponent("_badmap")),Yr}}catch{D&&D(jn)}}if(Qt){ve=Cs.join("&");break e}}ve=void 0}return c=c.i.splice(0,g),p.G=c,ve}function Nd(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;se||x(),M||(se(),M=!0),C.add(p,c),c.A=0}}function Ec(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ss(m(c.Da,c),_d(c,c.A)),c.A++,!0)}s.Da=function(){if(this.v=null,xd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ss(m(this.Wa,this),c)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),wa(this),xd(this))};function Cc(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function xd(c){c.g=new S(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Zt(c.na);yt(p,"RID","rpc"),yt(p,"SID",c.M),yt(p,"AID",c.K),yt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&yt(p,"TO",c.ia),yt(p,"TYPE","xmlhttp"),bo(c,p),c.u&&c.o&&Kt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Ni(Zt(p)),g.u=null,g.R=!0,te(g,c)}s.Va=function(){this.C!=null&&(this.C=null,wa(this),Ec(this),At(19))};function Ta(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function vd(c,p){var g=null;if(c.g==p){Ta(c),Cc(c),c.g=null;var D=2}else if(ke(c.h,p))g=p.G,Je(c.h,p),D=1;else return;if(c.I!=0){if(p.o)if(D==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var $=c.D;D=me(),I(D,new ds(D,g)),Sa(c)}else Nd(c);else if($=p.m,$==3||$==0&&p.X>0||!(D==1&&pN(c,p)||D==2&&Ec(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),$){case 1:Qr(c,5);break;case 4:Qr(c,10);break;case 3:Qr(c,6);break;default:Qr(c,2)}}}function _d(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Qr(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),D=c.Ua;const $=!D;D=new gt(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||is(D,"https"),Ni(D),$?pt(D.toString(),g):gs(D.toString(),g)}else At(2);c.I=0,c.l&&c.l.pa(p),Dd(c),gd(c)}s.bb=function(c){c?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function Dd(c){if(c.I=0,c.ja=[],c.l){const p=Nt(c.h);(p.length!=0||c.i.length!=0)&&(V(c.ja,p),V(c.ja,c.i),c.h.i.length=0,b(c.i),c.i.length=0),c.l.oa()}}function kd(c,p,g){var D=g instanceof gt?Zt(g):new gt(g);if(D.g!="")p&&(D.g=p+"."+D.g),Pn(D,D.u);else{var $=o.location;D=$.protocol,p=p?p+"."+$.hostname:$.hostname,$=+$.port;const X=new gt(null);D&&is(X,D),p&&(X.g=p),$&&Pn(X,$),g&&(X.h=g),D=X}return g=c.G,p=c.wa,g&&p&&yt(D,g,p),yt(D,"VER",c.ka),bo(c,D),D}function Ad(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ht(new ns({ab:g})):new ht(c.ma),p.Fa(c.L),p}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ed(){}s=Ed.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function La(){}La.prototype.g=function(c,p){return new an(c,p)};function an(c,p){ct.call(this),this.g=new hd(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new _i(this)}f(an,ct),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Ac(this.g)},an.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=tt(c),c=g);p.i.push(new Ys(p.Ya++,c)),p.I==3&&Sa(p)},an.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,an.Z.N.call(this)};function Cd(c){H.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Cd,H);function Vd(){be.call(this),this.status=1}f(Vd,be);function _i(c){this.g=c}f(_i,Ed),_i.prototype.ra=function(){I(this.g,"a")},_i.prototype.qa=function(c){I(this.g,new Cd(c))},_i.prototype.pa=function(c){I(this.g,new Vd)},_i.prototype.oa=function(){I(this.g,"b")},La.prototype.createWebChannel=La.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,sg=function(){return new La},tg=function(){return me()},eg=De,yu={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,ll=en,Ln.COMPLETE="complete",Zh=Ln,ee.EventType=Ge,Ge.OPEN="a",Ge.CLOSE="b",Ge.ERROR="c",Ge.MESSAGE="d",ct.prototype.listen=ct.prototype.J,Bo=ee,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,Jh=ht}).apply(typeof Ba<"u"?Ba:typeof self<"u"?self:typeof window<"u"?window:{});const sf="@firebase/firestore",nf="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ro="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi=new Oh("@firebase/firestore");function Ui(){return oi.logLevel}function Ve(s,...e){if(oi.logLevel<=Vt.DEBUG){const t=e.map(lm);oi.debug(`Firestore (${ro}): ${s}`,...t)}}function rr(s,...e){if(oi.logLevel<=Vt.ERROR){const t=e.map(lm);oi.error(`Firestore (${ro}): ${s}`,...t)}}function Yi(s,...e){if(oi.logLevel<=Vt.WARN){const t=e.map(lm);oi.warn(`Firestore (${ro}): ${s}`,...t)}}function lm(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,ng(s,n,t)}function ng(s,e,t){let n=`FIRESTORE (${ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw rr(n),new Error(n)}function Ut(s,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,s||ng(e,r,n)}function et(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends ui{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ws.UNAUTHENTICATED))}shutdown(){}}class b_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class N_{constructor(e){this.t=e,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ut(this.o===void 0,42304);let n=this.i;const r=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ut(typeof n.accessToken=="string",31837,{l:n}),new rg(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string",2055,{h:e}),new Ws(e)}}class x_{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class v_{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new x_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ws.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ut(this.o===void 0,3512);const n=i=>{i.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ve("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const r=i=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rf(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ut(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new rf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=D_(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function vt(s,e){return s<e?-1:s>e?1:0}function bu(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const r=s.charAt(n),i=e.charAt(n);if(r!==i)return Hc(r)===Hc(i)?vt(r,i):Hc(r)?1:-1}return vt(s.length,e.length)}const k_=55296,A_=57343;function Hc(s){const e=s.charCodeAt(0);return e>=k_&&e<=A_}function Gi(s,e,t){return s.length===e.length&&s.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="__name__";class Bn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Xe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Xe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Bn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const i=Bn.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return vt(e.length,t.length)}static compareSegments(e,t){const n=Bn.isNumericId(e),r=Bn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Bn.extractNumericId(e).compare(Bn.extractNumericId(t)):bu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Cr.fromString(e.substring(4,e.length-2))}}class Xt extends Bn{construct(e,t,n){return new Xt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Xt(t)}static emptyPath(){return new Xt([])}}const E_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends Bn{construct(e,t,n){return new Hs(e,t,n)}static isValidIdentifier(e){return E_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===of}static keyField(){return new Hs([of])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ee(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ee(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(n+=l,r++):(i(),r++)}if(i(),o)throw new Ee(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(t)}static emptyPath(){return new Hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Xt.fromString(e))}static fromName(e){return new $e(Xt.fromString(e).popFirst(5))}static empty(){return new $e(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(s,e,t){if(!t)throw new Ee(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function C_(s,e,t,n){if(e===!0&&n===!0)throw new Ee(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function af(s){if(!$e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function lf(s){if($e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function og(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function zl(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Xe(12329,{type:typeof s})}function Ms(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ee(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=zl(s);throw new Ee(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function ga(s,e){if(!og(s))throw new Ee(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const o=s[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new Ee(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=-62135596800,uf=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*uf);return new xe(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<cf)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uf}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ga(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:ks("string",xe._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new xe(0,0))}static max(){return new st(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=-1;function V_(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,r=st.fromTimestamp(n===1e9?new xe(t+1,0):new xe(t,n));return new wr(r,$e.empty(),e)}function w_(s){return new wr(s.readTime,s.key,na)}class wr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new wr(st.min(),$e.empty(),na)}static max(){return new wr(st.max(),$e.empty(),na)}}function S_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=$e.comparator(s.documentKey,e.documentKey),t!==0?t:vt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==T_)throw s;Ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>n(u))}),o=!0,i===r&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(r=>r?ce.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,i)=>{n.push(t.call(this,r,i))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&n(o)},d=>r(d))}})}static doWhile(e,t){return new ce((n,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):n()};i()})}}function P_(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oo(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=-1;function Ql(s){return s==null}function _l(s){return s===0&&1/s==-1/0}function I_(s){return typeof s=="number"&&Number.isInteger(s)&&!_l(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="";function j_(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=mf(e)),e=R_(s.get(t),e);return mf(e)}function R_(s,e){let t=e;const n=s.length;for(let r=0;r<n;r++){const i=s.charAt(r);switch(i){case"\0":t+="";break;case ag:t+="";break;default:t+=i}}return t}function mf(s){return s+ag+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Br(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function lg(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new rs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ua(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ua(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ua(this.root,e,this.comparator,!0)}}class Ua{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??Bs.RED,this.left=r??Bs.EMPTY,this.right=i??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Bs(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Bs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xe(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw Xe(57766)}get value(){throw Xe(16141)}get color(){throw Xe(16727)}get left(){throw Xe(29726)}get right(){throw Xe(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ff(this.data.getIterator())}getIteratorFrom(e){return new ff(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ss(this.comparator);return t.data=e,t}}class ff{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new un([])}unionWith(e){let t=new Ss(Hs.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new cg("Invalid base64 string: "+i):i}}(e);return new Fs(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const B_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sr(s){if(Ut(!!s,39018),typeof s=="string"){let e=0;const t=B_.exec(s);if(Ut(!!t,46558,{timestamp:s}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Tr(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="server_timestamp",mg="__type__",dg="__previous_value__",fg="__local_write_time__";function mm(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[mg])==null?void 0:n.stringValue)===ug}function Yl(s){const e=s.mapValue.fields[dg];return mm(e)?Yl(e):e}function ra(s){const e=Sr(s.mapValue.fields[fg].timestampValue);return new xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,t,n,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Dl="(default)";class ia{constructor(e,t){this.projectId=e,this.database=t||Dl}static empty(){return new ia("","")}get isDefaultDatabase(){return this.database===Dl}isEqual(e){return e instanceof ia&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="__type__",H_="__max__",Ha={mapValue:{}},hg="__vector__",kl="value";function Lr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?mm(s)?4:O_(s)?9007199254740991:M_(s)?10:11:Xe(28295,{value:s})}function Kn(s,e){if(s===e)return!0;const t=Lr(s);if(t!==Lr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ra(s).isEqual(ra(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Sr(r.timestampValue),l=Sr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(r,i){return Tr(r.bytesValue).isEqual(Tr(i.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(r,i){return hs(r.geoPointValue.latitude)===hs(i.geoPointValue.latitude)&&hs(r.geoPointValue.longitude)===hs(i.geoPointValue.longitude)}(s,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return hs(r.integerValue)===hs(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=hs(r.doubleValue),l=hs(i.doubleValue);return o===l?_l(o)===_l(l):isNaN(o)&&isNaN(l)}return!1}(s,e);case 9:return Gi(s.arrayValue.values||[],e.arrayValue.values||[],Kn);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(df(o)!==df(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Kn(o[u],l[u])))return!1;return!0}(s,e);default:return Xe(52216,{left:s})}}function oa(s,e){return(s.values||[]).find(t=>Kn(t,e))!==void 0}function Xi(s,e){if(s===e)return 0;const t=Lr(s),n=Lr(e);if(t!==n)return vt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(s.booleanValue,e.booleanValue);case 2:return function(i,o){const l=hs(i.integerValue||i.doubleValue),u=hs(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(s,e);case 3:return pf(s.timestampValue,e.timestampValue);case 4:return pf(ra(s),ra(e));case 5:return bu(s.stringValue,e.stringValue);case 6:return function(i,o){const l=Tr(i),u=Tr(o);return l.compareTo(u)}(s.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=vt(l[m],u[m]);if(d!==0)return d}return vt(l.length,u.length)}(s.referenceValue,e.referenceValue);case 8:return function(i,o){const l=vt(hs(i.latitude),hs(o.latitude));return l!==0?l:vt(hs(i.longitude),hs(o.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return hf(s.arrayValue,e.arrayValue);case 10:return function(i,o){var h,b,V,v;const l=i.fields||{},u=o.fields||{},m=(h=l[kl])==null?void 0:h.arrayValue,d=(b=u[kl])==null?void 0:b.arrayValue,f=vt(((V=m==null?void 0:m.values)==null?void 0:V.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:hf(m,d)}(s.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ha.mapValue&&o===Ha.mapValue)return 0;if(i===Ha.mapValue)return 1;if(o===Ha.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=bu(u[f],d[f]);if(h!==0)return h;const b=Xi(l[u[f]],m[d[f]]);if(b!==0)return b}return vt(u.length,d.length)}(s.mapValue,e.mapValue);default:throw Xe(23264,{he:t})}}function pf(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return vt(s,e);const t=Sr(s),n=Sr(e),r=vt(t.seconds,n.seconds);return r!==0?r:vt(t.nanos,n.nanos)}function hf(s,e){const t=s.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const i=Xi(t[r],n[r]);if(i)return i}return vt(t.length,n.length)}function Ji(s){return Nu(s)}function Nu(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const n=Sr(t);return`time(${n.seconds},${n.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Tr(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return $e.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=Nu(i);return n+"]"}(s.arrayValue):"mapValue"in s?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of n)i?i=!1:r+=",",r+=`${o}:${Nu(t.fields[o])}`;return r+"}"}(s.mapValue):Xe(61005,{value:s})}function cl(s){switch(Lr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yl(s);return e?16+cl(e):16;case 5:return 2*s.stringValue.length;case 6:return Tr(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+cl(i),0)}(s.arrayValue);case 10:case 11:return function(n){let r=0;return Br(n.fields,(i,o)=>{r+=i.length+cl(o)}),r}(s.mapValue);default:throw Xe(13486,{value:s})}}function gf(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function xu(s){return!!s&&"integerValue"in s}function dm(s){return!!s&&"arrayValue"in s}function yf(s){return!!s&&"nullValue"in s}function bf(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function ul(s){return!!s&&"mapValue"in s}function M_(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[pg])==null?void 0:n.stringValue)===hg}function $o(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Br(s.mapValue.fields,(t,n)=>e.mapValue.fields[t]=$o(n)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$o(s.arrayValue.values[t]);return e}return{...s}}function O_(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===H_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ul(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$o(t)}setAll(e){let t=Hs.emptyPath(),n={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,n,r),n={},r=[],t=l.popLast()}o?n[l.lastSegment()]=$o(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());ul(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Kn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ul(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Br(t,(r,i)=>e[r]=i);for(const r of n)delete e[r]}clone(){return new on($o(this.value))}}function gg(s){const e=[];return Br(s.fields,(t,n)=>{const r=new Hs([t]);if(ul(n)){const i=gg(n.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,t,n,r,i,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new zs(e,0,st.min(),st.min(),st.min(),on.empty(),0)}static newFoundDocument(e,t,n,r){return new zs(e,1,t,st.min(),n,r,0)}static newNoDocument(e,t){return new zs(e,2,t,st.min(),st.min(),on.empty(),0)}static newUnknownDocument(e,t){return new zs(e,3,t,st.min(),st.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.position=e,this.inclusive=t}}function Nf(s,e,t){let n=0;for(let r=0;r<s.position.length;r++){const i=e[r],o=s.position[r];if(i.field.isKeyField()?n=$e.comparator($e.fromName(o.referenceValue),t.key):n=Xi(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function xf(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Kn(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,t="asc"){this.field=e,this.dir=t}}function F_(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{}class _s extends yg{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new $_(e,t,n):t==="array-contains"?new K_(e,n):t==="in"?new Q_(e,n):t==="not-in"?new Y_(e,n):t==="array-contains-any"?new G_(e,n):new _s(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new W_(e,n):new z_(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xi(t,this.value)):t!==null&&Lr(this.value)===Lr(t)&&this.matchesComparison(Xi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vn extends yg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Vn(e,t)}matches(e){return bg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bg(s){return s.op==="and"}function Ng(s){return q_(s)&&bg(s)}function q_(s){for(const e of s.filters)if(e instanceof Vn)return!1;return!0}function vu(s){if(s instanceof _s)return s.field.canonicalString()+s.op.toString()+Ji(s.value);if(Ng(s))return s.filters.map(e=>vu(e)).join(",");{const e=s.filters.map(t=>vu(t)).join(",");return`${s.op}(${e})`}}function xg(s,e){return s instanceof _s?function(n,r){return r instanceof _s&&n.op===r.op&&n.field.isEqual(r.field)&&Kn(n.value,r.value)}(s,e):s instanceof Vn?function(n,r){return r instanceof Vn&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,o,l)=>i&&xg(o,r.filters[l]),!0):!1}(s,e):void Xe(19439)}function vg(s){return s instanceof _s?function(t){return`${t.field.canonicalString()} ${t.op} ${Ji(t.value)}`}(s):s instanceof Vn?function(t){return t.op.toString()+" {"+t.getFilters().map(vg).join(" ,")+"}"}(s):"Filter"}class $_ extends _s{constructor(e,t,n){super(e,t,n),this.key=$e.fromName(n.referenceValue)}matches(e){const t=$e.comparator(e.key,this.key);return this.matchesComparison(t)}}class W_ extends _s{constructor(e,t){super(e,"in",t),this.keys=_g("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class z_ extends _s{constructor(e,t){super(e,"not-in",t),this.keys=_g("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _g(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(n=>$e.fromName(n.referenceValue))}class K_ extends _s{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dm(t)&&oa(t.arrayValue,this.value)}}class Q_ extends _s{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&oa(this.value.arrayValue,t)}}class Y_ extends _s{constructor(e,t){super(e,"not-in",t)}matches(e){if(oa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!oa(this.value.arrayValue,t)}}class G_ extends _s{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>oa(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,t=null,n=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function vf(s,e=null,t=[],n=[],r=null,i=null,o=null){return new X_(s,e,t,n,r,i,o)}function fm(s){const e=et(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Ql(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ji(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ji(n)).join(",")),e.Te=t}return e.Te}function pm(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!F_(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!xg(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!xf(s.startAt,e.startAt)&&xf(s.endAt,e.endAt)}function _u(s){return $e.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t=null,n=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function J_(s,e,t,n,r,i,o,l){return new ao(s,e,t,n,r,i,o,l)}function Gl(s){return new ao(s)}function _f(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Dg(s){return s.collectionGroup!==null}function Wo(s){const e=et(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ss(Hs.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new aa(i,n))}),t.has(Hs.keyField().canonicalString())||e.Ie.push(new aa(Hs.keyField(),n))}return e.Ie}function On(s){const e=et(s);return e.Ee||(e.Ee=Z_(e,Wo(s))),e.Ee}function Z_(s,e){if(s.limitType==="F")return vf(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new aa(r.field,i)});const t=s.endAt?new Al(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new Al(s.startAt.position,s.startAt.inclusive):null;return vf(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Du(s,e){const t=s.filters.concat([e]);return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ku(s,e,t){return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Xl(s,e){return pm(On(s),On(e))&&s.limitType===e.limitType}function kg(s){return`${fm(On(s))}|lt:${s.limitType}`}function Hi(s){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>vg(r)).join(", ")}]`),Ql(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Ji(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Ji(r)).join(",")),`Target(${n})`}(On(s))}; limitType=${s.limitType})`}function Jl(s,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):$e.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(s,e)&&function(n,r){for(const i of Wo(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(s,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(s,e)&&function(n,r){return!(n.startAt&&!function(o,l,u){const m=Nf(o,l,u);return o.inclusive?m<=0:m<0}(n.startAt,Wo(n),r)||n.endAt&&!function(o,l,u){const m=Nf(o,l,u);return o.inclusive?m>=0:m>0}(n.endAt,Wo(n),r))}(s,e)}function eD(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Ag(s){return(e,t)=>{let n=!1;for(const r of Wo(s)){const i=tD(r,e,t);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function tD(s,e,t){const n=s.field.isKeyField()?$e.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Xi(u,m):Xe(42886)}(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Xe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Br(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return lg(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new rs($e.comparator);function ir(){return sD}const Eg=new rs($e.comparator);function Uo(...s){let e=Eg;for(const t of s)e=e.insert(t.key,t);return e}function Cg(s){let e=Eg;return s.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Zr(){return zo()}function Vg(){return zo()}function zo(){return new mi(s=>s.toString(),(s,e)=>s.isEqual(e))}const nD=new rs($e.comparator),rD=new Ss($e.comparator);function _t(...s){let e=rD;for(const t of s)e=e.add(t);return e}const iD=new Ss(vt);function oD(){return iD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_l(e)?"-0":e}}function wg(s){return{integerValue:""+s}}function aD(s,e){return I_(e)?wg(e):hm(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(){this._=void 0}}function lD(s,e,t){return s instanceof la?function(r,i){const o={fields:{[mg]:{stringValue:ug},[fg]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&mm(i)&&(i=Yl(i)),i&&(o.fields[dg]=i),{mapValue:o}}(t,e):s instanceof ca?Tg(s,e):s instanceof ua?Lg(s,e):function(r,i){const o=Sg(r,i),l=Df(o)+Df(r.Ae);return xu(o)&&xu(r.Ae)?wg(l):hm(r.serializer,l)}(s,e)}function cD(s,e,t){return s instanceof ca?Tg(s,e):s instanceof ua?Lg(s,e):t}function Sg(s,e){return s instanceof El?function(n){return xu(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class la extends Zl{}class ca extends Zl{constructor(e){super(),this.elements=e}}function Tg(s,e){const t=Pg(e);for(const n of s.elements)t.some(r=>Kn(r,n))||t.push(n);return{arrayValue:{values:t}}}class ua extends Zl{constructor(e){super(),this.elements=e}}function Lg(s,e){let t=Pg(e);for(const n of s.elements)t=t.filter(r=>!Kn(r,n));return{arrayValue:{values:t}}}class El extends Zl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Df(s){return hs(s.integerValue||s.doubleValue)}function Pg(s){return dm(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,t){this.field=e,this.transform=t}}function mD(s,e){return s.field.isEqual(e.field)&&function(n,r){return n instanceof ca&&r instanceof ca||n instanceof ua&&r instanceof ua?Gi(n.elements,r.elements,Kn):n instanceof El&&r instanceof El?Kn(n.Ae,r.Ae):n instanceof la&&r instanceof la}(s.transform,e.transform)}class dD{constructor(e,t){this.version=e,this.transformResults=t}}class Zs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zs}static exists(e){return new Zs(void 0,e)}static updateTime(e){return new Zs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ml(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class ec{}function Ig(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new tc(s.key,Zs.none()):new ya(s.key,s.data,Zs.none());{const t=s.data,n=on.empty();let r=new Ss(Hs.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),r=r.add(i)}return new Ur(s.key,n,new un(r.toArray()),Zs.none())}}function fD(s,e,t){s instanceof ya?function(r,i,o){const l=r.value.clone(),u=Af(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(s,e,t):s instanceof Ur?function(r,i,o){if(!ml(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Af(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(jg(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(s,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ko(s,e,t,n){return s instanceof ya?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=i.value.clone(),d=Ef(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(s,e,t,n):s instanceof Ur?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=Ef(i.fieldTransforms,u,o),d=o.data;return d.setAll(jg(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(s,e,t,n):function(i,o,l){return ml(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(s,e,t)}function pD(s,e){let t=null;for(const n of s.fieldTransforms){const r=e.data.field(n.field),i=Sg(n.transform,r||null);i!=null&&(t===null&&(t=on.empty()),t.set(n.field,i))}return t||null}function kf(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Gi(n,r,(i,o)=>mD(i,o))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class ya extends ec{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ur extends ec{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function jg(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}}),e}function Af(s,e,t){const n=new Map;Ut(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let r=0;r<t.length;r++){const i=s[r],o=i.transform,l=e.data.field(i.field);n.set(i.field,cD(o,l,t[r]))}return n}function Ef(s,e,t){const n=new Map;for(const r of s){const i=r.transform,o=t.data.field(r.field);n.set(r.field,lD(i,o,e))}return n}class tc extends ec{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hD extends ec{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&fD(i,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Vg();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=Ig(o,l);u!==null&&n.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(st.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),_t())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(t,n)=>kf(t,n))&&Gi(this.baseMutations,e.baseMutations,(t,n)=>kf(t,n))}}class gm{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ut(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return nD}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new gm(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs,Ct;function ND(s){switch(s){case ie.OK:return Xe(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Xe(15467,{code:s})}}function Rg(s){if(s===void 0)return rr("GRPC error has no .code"),ie.UNKNOWN;switch(s){case bs.OK:return ie.OK;case bs.CANCELLED:return ie.CANCELLED;case bs.UNKNOWN:return ie.UNKNOWN;case bs.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case bs.INTERNAL:return ie.INTERNAL;case bs.UNAVAILABLE:return ie.UNAVAILABLE;case bs.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case bs.NOT_FOUND:return ie.NOT_FOUND;case bs.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case bs.ABORTED:return ie.ABORTED;case bs.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case bs.DATA_LOSS:return ie.DATA_LOSS;default:return Xe(39323,{code:s})}}(Ct=bs||(bs={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new Cr([4294967295,4294967295],0);function Cf(s){const e=xD().encode(s),t=new Xh;return t.update(e),new Uint8Array(t.digest())}function Vf(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Cr([t,n],0),new Cr([r,i],0)]}class ym{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ho(`Invalid padding: ${t}`);if(n<0)throw new Ho(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ho(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ho(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Cr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Cr.fromNumber(n)));return r.compare(vD)===1&&(r=new Cr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Cf(e),[n,r]=Vf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ym(i,r,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Cf(e),[n,r]=Vf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ho extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ba.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sc(st.min(),r,new rs(vt),ir(),_t())}}class ba{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ba(n,t,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Bg{constructor(e,t){this.targetId=e,this.Ce=t}}class Ug{constructor(e,t,n=Fs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class wf{constructor(){this.ve=0,this.Fe=Sf(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),n=_t();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Xe(38017,{changeType:i})}}),new ba(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Sf()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ut(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _D{constructor(e){this.Ge=e,this.ze=new Map,this.je=ir(),this.Je=Ma(),this.He=Ma(),this.Ye=new rs(vt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(_u(i))if(n===0){const o=new $e(i.path);this.et(t,o,zs.newNoDocument(o,st.min()))}else Ut(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=Tr(n).toUint8Array()}catch(u){if(u instanceof cg)return Yi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ym(o,r,i)}catch(u){return Yi(u instanceof Ho?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&_u(l.target)){const u=new $e(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,zs.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=_t();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new sc(e,t,this.Ye,this.je,n);return this.je=ir(),this.Je=Ma(),this.He=Ma(),this.Ye=new rs(vt),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new wf,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ss(vt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ss(vt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wf),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ma(){return new rs($e.comparator)}function Sf(){return new rs($e.comparator)}const DD={asc:"ASCENDING",desc:"DESCENDING"},kD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AD={and:"AND",or:"OR"};class ED{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Au(s,e){return s.useProto3Json||Ql(e)?e:{value:e}}function Cl(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hg(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function CD(s,e){return Cl(s,e.toTimestamp())}function Fn(s){return Ut(!!s,49232),st.fromTimestamp(function(t){const n=Sr(t);return new xe(n.seconds,n.nanos)}(s))}function bm(s,e){return Eu(s,e).canonicalString()}function Eu(s,e){const t=function(r){return new Xt(["projects",r.projectId,"databases",r.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Mg(s){const e=Xt.fromString(s);return Ut(Wg(e),10190,{key:e.toString()}),e}function Cu(s,e){return bm(s.databaseId,e.path)}function Mc(s,e){const t=Mg(e);if(t.get(1)!==s.databaseId.projectId)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new $e(Fg(t))}function Og(s,e){return bm(s.databaseId,e)}function VD(s){const e=Mg(s);return e.length===4?Xt.emptyPath():Fg(e)}function Vu(s){return new Xt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Fg(s){return Ut(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Tf(s,e,t){return{name:Cu(s,e),fields:t.value.mapValue.fields}}function wD(s,e){let t;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Xe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Ut(d===void 0||typeof d=="string",58123),Fs.fromBase64String(d||"")):(Ut(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Fs.fromUint8Array(d||new Uint8Array))}(s,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?ie.UNKNOWN:Rg(m.code);return new Ee(d,m.message||"")}(o);t=new Ug(n,r,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Mc(s,n.document.name),i=Fn(n.document.updateTime),o=n.document.createTime?Fn(n.document.createTime):st.min(),l=new on({mapValue:{fields:n.document.fields}}),u=zs.newFoundDocument(r,i,o,l),m=n.targetIds||[],d=n.removedTargetIds||[];t=new dl(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Mc(s,n.document),i=n.readTime?Fn(n.readTime):st.min(),o=zs.newNoDocument(r,i),l=n.removedTargetIds||[];t=new dl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Mc(s,n.document),i=n.removedTargetIds||[];t=new dl([],i,r,null)}else{if(!("filter"in e))return Xe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,o=new bD(r,i),l=n.targetId;t=new Bg(l,o)}}return t}function SD(s,e){let t;if(e instanceof ya)t={update:Tf(s,e.key,e.value)};else if(e instanceof tc)t={delete:Cu(s,e.key)};else if(e instanceof Ur)t={update:Tf(s,e.key,e.data),updateMask:HD(e.fieldMask)};else{if(!(e instanceof hD))return Xe(16599,{Vt:e.type});t={verify:Cu(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof la)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ca)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof El)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Xe(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:CD(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Xe(27497)}(s,e.precondition)),t}function TD(s,e){return s&&s.length>0?(Ut(e!==void 0,14353),s.map(t=>function(r,i){let o=r.updateTime?Fn(r.updateTime):Fn(i);return o.isEqual(st.min())&&(o=Fn(i)),new dD(o,r.transformResults||[])}(t,e))):[]}function LD(s,e){return{documents:[Og(s,e.path)]}}function PD(s,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Og(s,r);const i=function(m){if(m.length!==0)return $g(Vn.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Mi(h.field),direction:RD(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Au(s,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function ID(s){let e=VD(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Ut(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=qg(f);return h instanceof Vn&&Ng(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(V){return new aa(Oi(V.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Ql(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,b=f.values||[];return new Al(b,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,b=f.values||[];return new Al(b,h)}(t.endAt)),J_(e,r,o,i,l,"F",u,m)}function jD(s,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xe(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function qg(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Oi(t.unaryFilter.field);return _s.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Oi(t.unaryFilter.field);return _s.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Oi(t.unaryFilter.field);return _s.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oi(t.unaryFilter.field);return _s.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xe(61313);default:return Xe(60726)}}(s):s.fieldFilter!==void 0?function(t){return _s.create(Oi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xe(58110);default:return Xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Vn.create(t.compositeFilter.filters.map(n=>qg(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Xe(1026)}}(t.compositeFilter.op))}(s):Xe(30097,{filter:s})}function RD(s){return DD[s]}function BD(s){return kD[s]}function UD(s){return AD[s]}function Mi(s){return{fieldPath:s.canonicalString()}}function Oi(s){return Hs.fromServerFormat(s.fieldPath)}function $g(s){return s instanceof _s?function(t){if(t.op==="=="){if(bf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NAN"}};if(yf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NAN"}};if(yf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mi(t.field),op:BD(t.op),value:t.value}}}(s):s instanceof Vn?function(t){const n=t.getFilters().map(r=>$g(r));return n.length===1?n[0]:{compositeFilter:{op:UD(t.op),filters:n}}}(s):Xe(54877,{filter:s})}function HD(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Wg(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t,n,r,i=st.min(),o=st.min(),l=Fs.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.yt=e}}function OD(s){const e=ID({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ku(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(){this.Cn=new qD}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(wr.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(wr.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class qD{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ss(Xt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ss(Xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zg=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn(zg,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zi(0)}static cr(){return new Zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="LruGarbageCollector",$D=1048576;function If([s,e],[t,n]){const r=vt(s,t);return r===0?vt(e,n):r}class WD{constructor(e){this.Ir=e,this.buffer=new Ss(If),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();If(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(Pf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oo(t)?Ve(Pf,"Ignoring IndexedDB error during garbage collection: ",t):await io(t)}await this.Vr(3e5)})}}class KD{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(Kl.ce);const n=new WD(t);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Lf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(m=Date.now(),Ui()<=Vt.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function QD(s,e){return new KD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(){this.changes=new mi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,zs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Ko(n.mutation,r,un.empty(),xe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,_t()).next(()=>n))}getLocalViewOfDocuments(e,t,n=_t()){const r=Zr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(i=>{let o=Uo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Zr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,_t()))}populateOverlays(e,t,n){const r=[];return n.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,r){let i=ir();const o=zo(),l=function(){return zo()}();return t.forEach((u,m)=>{const d=n.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof Ur)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Ko(d.mutation,m,d.mutation.getFieldMask(),xe.now())):o.set(m.key,un.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new GD(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const n=zo();let r=new rs((o,l)=>o-l),i=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=n.get(u)||un.empty();d=l.applyToLocalView(m,d),n.set(u,d);const f=(r.get(l.batchId)||_t()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Vg();d.forEach(h=>{if(!i.has(h)){const b=Ig(t.get(h),n.get(h));b!==null&&f.set(h,b),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return $e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Dg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ce.resolve(Zr());let l=na,u=i;return o.next(m=>ce.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,_t())).next(d=>({batchId:l,changes:Cg(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $e(t)).next(n=>{let r=Uo();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=Uo();return this.indexManager.getCollectionParents(e,i).next(l=>ce.forEach(l,u=>{const m=function(f,h){return new ao(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,n,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,zs.newInvalidDocument(d)))});let l=Uo();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Ko(d.mutation,m,un.empty(),xe.now()),Jl(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Fn(r.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:OD(r.bundledQuery),readTime:Fn(r.readTime)}}(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this.overlays=new rs($e.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Zr();return ce.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&n.set(r,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,i)=>{this.St(e,t,i)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const r=Zr(),i=t.length+1,o=new $e(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new rs((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let d=i.get(m.largestBatchId);d===null&&(d=Zr(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=Zr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return ce.resolve(l)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new yD(t,n));let i=this.qr.get(t);i===void 0&&(i=_t(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.Qr=new Ss(Is.$r),this.Ur=new Ss(Is.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Is(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Is(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new $e(new Xt([])),n=new Is(t,e),r=new Is(t,e+1),i=[];return this.Ur.forEachInRange([n,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new $e(new Xt([])),n=new Is(t,e),r=new Is(t,e+1);let i=_t();return this.Ur.forEachInRange([n,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Is(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Is{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return $e.comparator(e.key,t.key)||vt(e.Yr,t.Yr)}static Kr(e,t){return vt(e.Yr,t.Yr)||$e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ss(Is.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new gD(i,t,n,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Is(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?um:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Is(t,0),r=new Is(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ss(vt);return t.forEach(r=>{const i=new Is(r,0),o=new Is(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{n=n.add(l.Yr)})}),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;$e.isDocumentKey(i)||(i=i.child(""));const o=new Is(new $e(i),0);let l=new Ss(vt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!n.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),ce.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(n=>{const r=this.Xr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ut(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,r=>{const i=new Is(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Is(t,0),r=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.ri=e,this.docs=function(){return new rs($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():zs.newInvalidDocument(t))}getEntries(e,t){let n=ir();return t.forEach(r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():zs.newInvalidDocument(r))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ir();const o=t.path,l=new $e(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||S_(w_(d),n)<=0||(r.has(d.key)||Jl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Xe(9500)}ii(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new nk(this)}getSize(e){return ce.resolve(this.size)}}class nk extends YD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.persistence=e,this.si=new mi(t=>fm(t),pm),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.oi=0,this._i=new Nm,this.targetCount=0,this.ai=Zi.ur()}forEachTarget(e,t){return this.si.forEach((n,r)=>t(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Zi(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t){this.ui={},this.overlays={},this.ci=new Kl(0),this.li=!1,this.li=!0,this.hi=new ek,this.referenceDelegate=e(this),this.Pi=new rk(this),this.indexManager=new FD,this.remoteDocumentCache=function(r){return new sk(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new MD(t),this.Ii=new JD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new tk(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve("MemoryPersistence","Starting transaction:",e);const r=new ik(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class ik extends L_{constructor(e){super(),this.currentSequenceNumber=e}}class xm{constructor(e){this.persistence=e,this.Ri=new Nm,this.Vi=null}static mi(e){return new xm(e)}get fi(){if(this.Vi)return this.Vi;throw Xe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,n=>{const r=$e.fromPath(n);return this.gi(e,r).next(i=>{i||t.removeEntry(r,st.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vl{constructor(e,t){this.persistence=e,this.pi=new mi(n=>j_(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=QD(this,t)}static mi(e,t){return new Vl(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(i=>i?ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(n++,i.removeEntry(o,st.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=cl(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=_t(),r=_t();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new vm(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return tv()?8:P_(Zx())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ok;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Ui()<=Vt.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",Hi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Ui()<=Vt.DEBUG&&Ve("QueryEngine","Query:",Hi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Ui()<=Vt.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",Hi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(t))):ce.resolve())}ys(e,t){if(_f(t))return ce.resolve(null);let n=On(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ku(t,null,"F"),n=On(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=_t(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ku(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,n,r){return _f(t)||r.isEqual(st.min())?ce.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?ce.resolve(null):(Ui()<=Vt.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Hi(t)),this.vs(e,o,t,V_(r,na)).next(l=>l))})}Ds(e,t){let n=new Ss(Ag(e));return t.forEach((r,i)=>{Jl(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Ui()<=Vt.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",Hi(t)),this.ps.getDocumentsMatchingQuery(e,t,wr.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="LocalStore",lk=3e8;class ck{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new rs(vt),this.xs=new mi(i=>fm(i),pm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function uk(s,e,t,n){return new ck(s,e,t,n)}async function Qg(s,e){const t=et(s);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let u=_t();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function mk(s,e){const t=et(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let b=ce.resolve();return h.forEach(V=>{b=b.next(()=>d.getEntry(u,V)).next(v=>{const w=m.docVersions.get(V);Ut(w!==null,48541),v.version.compareTo(w)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),b.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=_t();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Yg(s){const e=et(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function dk(s,e){const t=et(s),n=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let b=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?b=b.withResumeToken(Fs.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):d.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(d.resumeToken,n)),r=r.insert(f,b),function(v,w,B){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=lk?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(h,b,d)&&l.push(t.Pi.updateTargetData(i,b))});let u=ir(),m=_t();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(fk(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!n.isEqual(st.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return ce.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function fk(s,e,t){let n=_t(),r=_t();return t.forEach(i=>n=n.add(i)),e.getEntries(s,n).next(i=>{let o=ir();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(st.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Ve(_m,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function pk(s,e){const t=et(s);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=um),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function hk(s,e){const t=et(s);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Pi.getTargetData(n,e).next(i=>i?(r=i,ce.resolve(r)):t.Pi.allocateTargetId(n).next(o=>(r=new _r(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function wu(s,e,t){const n=et(s),r=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!oo(o))throw o;Ve(_m,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function jf(s,e,t){const n=et(s);let r=st.min(),i=_t();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=et(u),h=f.xs.get(d);return h!==void 0?ce.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(n,o,On(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?r:st.min(),t?i:_t())).next(l=>(gk(n,eD(e),l),{documents:l,Qs:i})))}function gk(s,e,t){let n=s.Os.get(e)||st.min();t.forEach((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),s.Os.set(e,n)}class Rf{constructor(){this.activeTargetIds=oD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yk{constructor(){this.Mo=new Rf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Rf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="ConnectivityMonitor";class Uf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Bf,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Bf,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa=null;function Su(){return Oa===null?Oa=function(){return 268435456+Math.round(2147483648*Math.random())}():Oa++,"0x"+Oa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc="RestConnection",Nk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Dl?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const o=Su(),l=this.zo(e,t.toUriEncodedString());Ve(Oc,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=ha(m);return this.Jo(e,l,u,n,d).then(f=>(Ve(Oc,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Yi(Oc,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",n),f})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ro}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),n&&n.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const n=Nk[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs="WebChannelConnection";class _k extends xk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=Su();return new Promise((l,u)=>{const m=new Jh;m.setWithCredentials(!0),m.listenOnce(Zh.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case ll.NO_ERROR:const f=m.getResponseJson();Ve(qs,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case ll.TIMEOUT:Ve(qs,`RPC '${e}' ${o} timed out`),u(new Ee(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ll.HTTP_ERROR:const h=m.getStatus();if(Ve(qs,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let b=m.getResponseJson();Array.isArray(b)&&(b=b[0]);const V=b==null?void 0:b.error;if(V&&V.status&&V.message){const v=function(B){const P=B.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(P)>=0?P:ie.UNKNOWN}(V.status);u(new Ee(v,V.message))}else u(new Ee(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new Ee(ie.UNAVAILABLE,"Connection failed."));break;default:Xe(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ve(qs,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);Ve(qs,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,n,15)})}T_(e,t,n){const r=Su(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sg(),l=tg(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=i.join("");Ve(qs,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,b=!1;const V=new vk({Yo:w=>{b?Ve(qs,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(h||(Ve(qs,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),Ve(qs,`RPC '${e}' stream ${r} sending:`,w),f.send(w))},Zo:()=>f.close()}),v=(w,B,P)=>{w.listen(B,F=>{try{P(F)}catch(oe){setTimeout(()=>{throw oe},0)}})};return v(f,Bo.EventType.OPEN,()=>{b||(Ve(qs,`RPC '${e}' stream ${r} transport opened.`),V.o_())}),v(f,Bo.EventType.CLOSE,()=>{b||(b=!0,Ve(qs,`RPC '${e}' stream ${r} transport closed`),V.a_(),this.E_(f))}),v(f,Bo.EventType.ERROR,w=>{b||(b=!0,Yi(qs,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),V.a_(new Ee(ie.UNAVAILABLE,"The operation could not be completed")))}),v(f,Bo.EventType.MESSAGE,w=>{var B;if(!b){const P=w.data[0];Ut(!!P,16349);const F=P,oe=(F==null?void 0:F.error)||((B=F[0])==null?void 0:B.error);if(oe){Ve(qs,`RPC '${e}' stream ${r} received error:`,oe);const se=oe.status;let M=function(E){const j=bs[E];if(j!==void 0)return Rg(j)}(se),C=oe.message;M===void 0&&(M=ie.INTERNAL,C="Unknown error status: "+se+" with message "+oe.message),b=!0,V.a_(new Ee(M,C)),f.close()}else Ve(qs,`RPC '${e}' stream ${r} received:`,P),V.u_(P)}}),v(l,eg.STAT_EVENT,w=>{w.stat===yu.PROXY?Ve(qs,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===yu.NOPROXY&&Ve(qs,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{V.__()},0),V}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Fc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(s){return new ED(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="PersistentStream";class Xg{constructor(e,t,n,r,i,o,l,u){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Gg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(rr(t.toString()),rr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===t&&this.G_(n,r)},n=>{e(()=>{const r=new Ee(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ve(Hf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Ve(Hf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dk extends Xg{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=wD(this.serializer,e),n=function(i){if(!("targetChange"in i))return st.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?st.min():o.readTime?Fn(o.readTime):st.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Vu(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=_u(u)?{documents:LD(i,u)}:{query:PD(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Hg(i,o.resumeToken);const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(st.min())>0){l.readTime=Cl(i,o.snapshotVersion.toTimestamp());const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const n=jD(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Vu(this.serializer),t.removeTarget=e,this.q_(t)}}class kk extends Xg{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ut(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ut(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TD(e.writeResults,e.commitTime),n=Fn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Vu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>SD(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{}class Ek extends Ak{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Eu(t,n),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(ie.UNKNOWN,i.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,Eu(t,n),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(ie.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ck{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(rr(t),this.aa=!1):Ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="RemoteStore";class Vk{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{di(this)&&(Ve(ai,"Restarting streams for network reachability change."),await async function(u){const m=et(u);m.Ea.add(4),await lo(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Na(m)}(this))})}),this.Ra=new Ck(n,r)}}async function Na(s){if(di(s))for(const e of s.da)await e(!0)}async function lo(s){for(const e of s.da)await e(!1)}function Jg(s,e){const t=et(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Em(t)?Am(t):co(t).O_()&&km(t,e))}function Dm(s,e){const t=et(s),n=co(t);t.Ia.delete(e),n.O_()&&Zg(t,e),t.Ia.size===0&&(n.O_()?n.L_():di(t)&&t.Ra.set("Unknown"))}function km(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}co(s).Y_(e)}function Zg(s,e){s.Va.Ue(e),co(s).Z_(e)}function Am(s){s.Va=new _D({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),co(s).start(),s.Ra.ua()}function Em(s){return di(s)&&!co(s).x_()&&s.Ia.size>0}function di(s){return et(s).Ea.size===0}function ey(s){s.Va=void 0}async function wk(s){s.Ra.set("Online")}async function Sk(s){s.Ia.forEach((e,t)=>{km(s,e)})}async function Tk(s,e){ey(s),Em(s)?(s.Ra.ha(e),Am(s)):s.Ra.set("Unknown")}async function Lk(s,e,t){if(s.Ra.set("Online"),e instanceof Ug&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(s,e)}catch(n){Ve(ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wl(s,n)}else if(e instanceof dl?s.Va.Ze(e):e instanceof Bg?s.Va.st(e):s.Va.tt(e),!t.isEqual(st.min()))try{const n=await Yg(s.localStore);t.compareTo(n)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Fs.EMPTY_BYTE_STRING,d.snapshotVersion)),Zg(i,u);const f=new _r(d.target,u,m,d.sequenceNumber);km(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(s,t)}catch(n){Ve(ai,"Failed to raise snapshot:",n),await wl(s,n)}}async function wl(s,e,t){if(!oo(e))throw e;s.Ea.add(1),await lo(s),s.Ra.set("Offline"),t||(t=()=>Yg(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{Ve(ai,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Na(s)})}function ty(s,e){return e().catch(t=>wl(s,t,e))}async function rc(s){const e=et(s),t=Pr(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:um;for(;Pk(e);)try{const r=await pk(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,Ik(e,r)}catch(r){await wl(e,r)}sy(e)&&ny(e)}function Pk(s){return di(s)&&s.Ta.length<10}function Ik(s,e){s.Ta.push(e);const t=Pr(s);t.O_()&&t.X_&&t.ea(e.mutations)}function sy(s){return di(s)&&!Pr(s).x_()&&s.Ta.length>0}function ny(s){Pr(s).start()}async function jk(s){Pr(s).ra()}async function Rk(s){const e=Pr(s);for(const t of s.Ta)e.ea(t.mutations)}async function Bk(s,e,t){const n=s.Ta.shift(),r=gm.from(n,e,t);await ty(s,()=>s.remoteSyncer.applySuccessfulWrite(r)),await rc(s)}async function Uk(s,e){e&&Pr(s).X_&&await async function(n,r){if(function(o){return ND(o)&&o!==ie.ABORTED}(r.code)){const i=n.Ta.shift();Pr(n).B_(),await ty(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await rc(n)}}(s,e),sy(s)&&ny(s)}async function Mf(s,e){const t=et(s);t.asyncQueue.verifyOperationInProgress(),Ve(ai,"RemoteStore received new credentials");const n=di(t);t.Ea.add(3),await lo(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Na(t)}async function Hk(s,e){const t=et(s);e?(t.Ea.delete(2),await Na(t)):e||(t.Ea.add(2),await lo(t),t.Ra.set("Unknown"))}function co(s){return s.ma||(s.ma=function(t,n,r){const i=et(t);return i.sa(),new Dk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:wk.bind(null,s),t_:Sk.bind(null,s),r_:Tk.bind(null,s),H_:Lk.bind(null,s)}),s.da.push(async e=>{e?(s.ma.B_(),Em(s)?Am(s):s.Ra.set("Unknown")):(await s.ma.stop(),ey(s))})),s.ma}function Pr(s){return s.fa||(s.fa=function(t,n,r){const i=et(t);return i.sa(),new kk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:jk.bind(null,s),r_:Uk.bind(null,s),ta:Rk.bind(null,s),na:Bk.bind(null,s)}),s.da.push(async e=>{e?(s.fa.B_(),await rc(s)):(await s.fa.stop(),s.Ta.length>0&&(Ve(ai,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))})),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,l=new Cm(e,t,o,r,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vm(s,e){if(rr("AsyncQueue",`${e}: ${s}`),oo(s))return new Ee(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{static emptySet(e){return new Ki(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||$e.comparator(t.key,n.key):(t,n)=>$e.comparator(t.key,n.key),this.keyedMap=Uo(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ki)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ki;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(){this.ga=new rs($e.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class eo{constructor(e,t,n,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new eo(e,t,Ki.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Ok{constructor(){this.queries=Ff(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=et(t),i=r.queries;r.queries=Ff(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new Ee(ie.ABORTED,"Firestore shutting down"))}}function Ff(){return new mi(s=>kg(s),Xl)}async function wm(s,e){const t=et(s);let n=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(n=2):(i=new Mk,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Vm(o,`Initialization of query '${Hi(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Tm(t)}async function Sm(s,e){const t=et(s),n=e.query;let r=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function Fk(s,e){const t=et(s);let n=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(n=!0);o.wa=r}}n&&Tm(t)}function qk(s,e,t){const n=et(s),r=n.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);n.queries.delete(e)}function Tm(s){s.Ca.forEach(e=>{e.next()})}var Tu,qf;(qf=Tu||(Tu={})).Ma="default",qf.Cache="cache";class Lm{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new eo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e){this.key=e}}class iy{constructor(e){this.key=e}}class $k{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=Ag(e),this.tu=new Ki(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Of,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),b=Jl(this.query,f)?f:null,V=!!h&&this.mutatedKeys.has(h.key),v=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let w=!1;h&&b?h.data.isEqual(b.data)?V!==v&&(n.track({type:3,doc:b}),w=!0):this.su(h,b)||(n.track({type:2,doc:b}),w=!0,(u&&this.eu(b,u)>0||m&&this.eu(b,m)<0)&&(l=!0)):!h&&b?(n.track({type:0,doc:b}),w=!0):h&&!b&&(n.track({type:1,doc:h}),w=!0,(u||m)&&(l=!0)),w&&(b?(o=o.add(b),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(b,V){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xe(20277,{Rt:w})}};return v(b)-v(V)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(n),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new eo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Of,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new iy(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new ry(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return eo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pm="SyncEngine";class Wk{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class zk{constructor(e){this.key=e,this.hu=!1}}class Kk{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new mi(l=>kg(l),Xl),this.Iu=new Map,this.Eu=new Set,this.du=new rs($e.comparator),this.Au=new Map,this.Ru=new Nm,this.Vu={},this.mu=new Map,this.fu=Zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qk(s,e,t=!0){const n=my(s);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await oy(n,e,t,!0),r}async function Yk(s,e){const t=my(s);await oy(t,e,!0,!1)}async function oy(s,e,t,n){const r=await hk(s.localStore,On(e)),i=r.targetId,o=s.sharedClientState.addLocalQueryTarget(i,t);let l;return n&&(l=await Gk(s,e,i,o==="current",r.resumeToken)),s.isPrimaryClient&&t&&Jg(s.remoteStore,r),l}async function Gk(s,e,t,n,r){s.pu=(f,h,b)=>async function(v,w,B,P){let F=w.view.ru(B);F.Cs&&(F=await jf(v.localStore,w.query,!1).then(({documents:C})=>w.view.ru(C,F)));const oe=P&&P.targetChanges.get(w.targetId),se=P&&P.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(F,v.isPrimaryClient,oe,se);return Wf(v,w.targetId,M.au),M.snapshot}(s,f,h,b);const i=await jf(s.localStore,e,!0),o=new $k(e,i.Qs),l=o.ru(i.documents),u=ba.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",r),m=o.applyChanges(l,s.isPrimaryClient,u);Wf(s,t,m.au);const d=new Wk(e,t,o);return s.Tu.set(e,d),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function Xk(s,e,t){const n=et(s),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter(o=>!Xl(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await wu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Dm(n.remoteStore,r.targetId),Lu(n,r.targetId)}).catch(io)):(Lu(n,r.targetId),await wu(n.localStore,r.targetId,!0))}async function Jk(s,e){const t=et(s),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Dm(t.remoteStore,n.targetId))}async function Zk(s,e,t){const n=oA(s);try{const r=await function(o,l){const u=et(o),m=xe.now(),d=l.reduce((b,V)=>b.add(V.key),_t());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",b=>{let V=ir(),v=_t();return u.Ns.getEntries(b,d).next(w=>{V=w,V.forEach((B,P)=>{P.isValidDocument()||(v=v.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(b,V)).next(w=>{f=w;const B=[];for(const P of l){const F=pD(P,f.get(P.key).overlayedDocument);F!=null&&B.push(new Ur(P.key,F,gg(F.value.mapValue),Zs.exists(!0)))}return u.mutationQueue.addMutationBatch(b,m,B,l)}).next(w=>{h=w;const B=w.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(b,w.batchId,B)})}).then(()=>({batchId:h.batchId,changes:Cg(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new rs(vt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(n,r.batchId,t),await xa(n,r.changes),await rc(n.remoteStore)}catch(r){const i=Vm(r,"Failed to persist write");t.reject(i)}}async function ay(s,e){const t=et(s);try{const n=await dk(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Ut(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ut(o.hu,14607):r.removedDocuments.size>0&&(Ut(o.hu,42227),o.hu=!1))}),await xa(t,n,e)}catch(n){await io(n)}}function $f(s,e,t){const n=et(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=et(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Tm(u)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function eA(s,e,t){const n=et(s);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),i=r&&r.key;if(i){let o=new rs($e.comparator);o=o.insert(i,zs.newNoDocument(i,st.min()));const l=_t().add(i),u=new sc(st.min(),new Map,new rs(vt),o,l);await ay(n,u),n.du=n.du.remove(i),n.Au.delete(e),Im(n)}else await wu(n.localStore,e,!1).then(()=>Lu(n,e,t)).catch(io)}async function tA(s,e){const t=et(s),n=e.batch.batchId;try{const r=await mk(t.localStore,e);cy(t,n,null),ly(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await xa(t,r)}catch(r){await io(r)}}async function sA(s,e,t){const n=et(s);try{const r=await function(o,l){const u=et(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Ut(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(n.localStore,e);cy(n,e,t),ly(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await xa(n,r)}catch(r){await io(r)}}function ly(s,e){(s.mu.get(e)||[]).forEach(t=>{t.resolve()}),s.mu.delete(e)}function cy(s,e,t){const n=et(s);let r=n.Vu[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function Lu(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach(n=>{s.Ru.containsKey(n)||uy(s,n)})}function uy(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Dm(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),Im(s))}function Wf(s,e,t){for(const n of t)n instanceof ry?(s.Ru.addReference(n.key,e),nA(s,n)):n instanceof iy?(Ve(Pm,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||uy(s,n.key)):Xe(19791,{wu:n})}function nA(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(Ve(Pm,"New document in limbo: "+t),s.Eu.add(n),Im(s))}function Im(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new $e(Xt.fromString(e)),n=s.fu.next();s.Au.set(n,new zk(t)),s.du=s.du.insert(t,n),Jg(s.remoteStore,new _r(On(Gl(t.path)),n,"TargetPurposeLimboResolution",Kl.ce))}}async function xa(s,e,t){const n=et(s),r=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((l,u)=>{o.push(n.pu(u,e,t).then(m=>{var d;if((m||t)&&n.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=vm.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),n.Pu.H_(r),await async function(u,m){const d=et(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ce.forEach(m,h=>ce.forEach(h.Es,b=>d.persistence.referenceDelegate.addReference(f,h.targetId,b)).next(()=>ce.forEach(h.ds,b=>d.persistence.referenceDelegate.removeReference(f,h.targetId,b)))))}catch(f){if(!oo(f))throw f;Ve(_m,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const b=d.Ms.get(h),V=b.snapshotVersion,v=b.withLastLimboFreeSnapshotVersion(V);d.Ms=d.Ms.insert(h,v)}}}(n.localStore,i))}async function rA(s,e){const t=et(s);if(!t.currentUser.isEqual(e)){Ve(Pm,"User change. New user:",e.toKey());const n=await Qg(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Ee(ie.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await xa(t,n.Ls)}}function iA(s,e){const t=et(s),n=t.Au.get(e);if(n&&n.hu)return _t().add(n.key);{let r=_t();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function my(s){const e=et(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ay.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eA.bind(null,e),e.Pu.H_=Fk.bind(null,e.eventManager),e.Pu.yu=qk.bind(null,e.eventManager),e}function oA(s){const e=et(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sA.bind(null,e),e}class Sl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return uk(this.persistence,new ak,e.initialUser,this.serializer)}Cu(e){return new Kg(xm.mi,this.serializer)}Du(e){return new yk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sl.provider={build:()=>new Sl};class aA extends Sl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ut(this.persistence.referenceDelegate instanceof Vl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new zD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new Kg(n=>Vl.mi(n,t),this.serializer)}}class Pu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$f(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=rA.bind(null,this.syncEngine),await Hk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ok}()}createDatastore(e){const t=nc(e.databaseInfo.databaseId),n=function(i){return new _k(i)}(e.databaseInfo);return function(i,o,l,u){return new Ek(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,i,o,l){return new Vk(n,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>$f(this.syncEngine,t,0),function(){return Uf.v()?new Uf:new bk}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new Kk(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=et(r);Ve(ai,"RemoteStore shutting down."),i.Ea.add(5),await lo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Pu.provider={build:()=>new Pu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):rr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir="FirestoreClient";class lA{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ws.UNAUTHENTICATED,this.clientId=cm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{Ve(Ir,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ve(Ir,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Vm(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qc(s,e){s.asyncQueue.verifyOperationInProgress(),Ve(Ir,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener(async r=>{n.isEqual(r)||(await Qg(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function zf(s,e){s.asyncQueue.verifyOperationInProgress();const t=await dy(s);Ve(Ir,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(n=>Mf(e.remoteStore,n)),s.setAppCheckTokenChangeListener((n,r)=>Mf(e.remoteStore,r)),s._onlineComponents=e}async function dy(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ve(Ir,"Using user provided OfflineComponentProvider");try{await qc(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===ie.FAILED_PRECONDITION||r.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Yi("Error using user provided cache. Falling back to memory cache: "+t),await qc(s,new Sl)}}else Ve(Ir,"Using default OfflineComponentProvider"),await qc(s,new aA(void 0));return s._offlineComponents}async function Rm(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ve(Ir,"Using user provided OnlineComponentProvider"),await zf(s,s._uninitializedComponentsProvider._online)):(Ve(Ir,"Using default OnlineComponentProvider"),await zf(s,new Pu))),s._onlineComponents}function fy(s){return dy(s).then(e=>e.persistence)}function py(s){return Rm(s).then(e=>e.remoteStore)}function cA(s){return Rm(s).then(e=>e.syncEngine)}async function Tl(s){const e=await Rm(s),t=e.eventManager;return t.onListen=Qk.bind(null,e.syncEngine),t.onUnlisten=Xk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Yk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Jk.bind(null,e.syncEngine),t}function uA(s){return s.asyncQueue.enqueue(async()=>{const e=await fy(s),t=await py(s);return e.setNetworkEnabled(!0),function(r){const i=et(r);return i.Ea.delete(0),Na(i)}(t)})}function mA(s){return s.asyncQueue.enqueue(async()=>{const e=await fy(s),t=await py(s);return e.setNetworkEnabled(!1),async function(r){const i=et(r);i.Ea.add(0),await lo(i),i.Ra.set("Offline")}(t)})}function dA(s,e,t={}){const n=new er;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f));const b=h.docs.has(l);!b&&h.fromCache?m.reject(new Ee(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&h.fromCache&&u&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(Gl(l.path),d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}function fA(s,e,t={}){const n=new er;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f)),h.fromCache&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(l,d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="firestore.googleapis.com",Qf=!0;class Yf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gy,this.ssl=Qf}else this.host=e.host,this.ssl=e.ssl??Qf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zg;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$D)throw new Ee(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}C_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ic{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new y_;switch(n.type){case"firstParty":return new v_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ee(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Kf.get(t);n&&(Ve("ComponentProvider","Removing Datastore"),Kf.delete(t),n.terminate())}(this),Promise.resolve()}}function pA(s,e,t,n={}){var m;s=Ms(s,ic);const r=ha(e),i=s._getSettings(),o={...i,emulatorOptions:s._getEmulatorOptions()},l=`${e}:${t}`;r&&(Bh(`https://${l}`),Hh("Firestore",!0)),i.host!==gy&&i.host!==l&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:n};if(!vl(u,o)&&(s._setSettings(u),n.mockUserToken)){let d,f;if(typeof n.mockUserToken=="string")d=n.mockUserToken,f=Ws.MOCK_USER;else{d=Uh(n.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Ee(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ws(h)}s._authCredentials=new b_(new rg(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class as{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new as(this.firestore,e,this._key)}toJSON(){return{type:as._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(ga(t,as._jsonSchema))return new as(e,n||null,new $e(Xt.fromString(t.referencePath)))}}as._jsonSchemaVersion="firestore/documentReference/1.0",as._jsonSchema={type:ks("string",as._jsonSchemaVersion),referencePath:ks("string")};class Vr extends Hr{constructor(e,t,n){super(e,t,Gl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new as(this.firestore,null,new $e(e))}withConverter(e){return new Vr(this.firestore,e,this._path)}}function qe(s,e,...t){if(s=Os(s),ig("collection","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return lf(n),new Vr(s,null,n)}{if(!(s instanceof as||s instanceof Vr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return lf(n),new Vr(s.firestore,null,n)}}function Se(s,e,...t){if(s=Os(s),arguments.length===1&&(e=cm.newId()),ig("doc","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return af(n),new as(s,null,new $e(n))}{if(!(s instanceof as||s instanceof Vr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return af(n),new as(s.firestore,s instanceof Vr?s.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="AsyncQueue";class Xf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Gg(this,"async_queue_retry"),this._c=()=>{const n=Fc();n&&Ve(Gf,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Fc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;Ve(Gf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,rr("INTERNAL UNHANDLED ERROR: ",Jf(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cm.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Xe(47125,{Pc:Jf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Jf(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(s){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(s,["next","error","complete"])}class bn extends ic{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Xf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xf(e),this._firestoreClient=void 0,await e}}}function hA(s,e){const t=typeof s=="object"?s:Qh(),n=typeof s=="string"?s:Dl,r=$h(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=jh("firestore");i&&pA(r,...i)}return r}function fi(s){if(s._terminated)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||gA(s),s._firestoreClient}function gA(s){var n,r,i;const e=s._freezeSettings(),t=function(l,u,m,d){return new U_(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hy(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,e);s._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new lA(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(s._componentsProvider))}function yA(s){return uA(fi(s=Ms(s,bn)))}function bA(s){return mA(fi(s=Ms(s,bn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(Fs.fromBase64String(e))}catch(t){throw new Ee(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yn(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ga(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:ks("string",yn._jsonSchemaVersion),bytes:ks("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qn._jsonSchemaVersion}}static fromJSON(e){if(ga(e,qn._jsonSchema))return new qn(e.latitude,e.longitude)}}qn._jsonSchemaVersion="firestore/geoPoint/1.0",qn._jsonSchema={type:ks("string",qn._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:$n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ga(e,$n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new $n(e.vectorValues);throw new Ee(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$n._jsonSchemaVersion="firestore/vectorValue/1.0",$n._jsonSchema={type:ks("string",$n._jsonSchemaVersion),vectorValues:ks("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=/^__.*__$/;class xA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms):new ya(e,this.data,t,this.fieldTransforms)}}class yy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ur(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function by(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xe(40011,{Ac:s})}}class Bm{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Bm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ll(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(by(this.Ac)&&NA.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vA{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||nc(e)}Cc(e,t,n,r=!1){return new Bm({Ac:e,methodName:t,Dc:n,path:Hs.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _a(s){const e=s._freezeSettings(),t=nc(s._databaseId);return new vA(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Um(s,e,t,n,r,i={}){const o=s.Cc(i.merge||i.mergeFields?2:0,e,t,r);Mm("Data must be an object, but it was:",o,n);const l=vy(n,o);let u,m;if(i.merge)u=new un(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=Iu(e,f,t);if(!o.contains(h))throw new Ee(ie.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Dy(d,h)||d.push(h)}u=new un(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new xA(new on(l),u,m)}class ac extends oc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ac}}class Hm extends oc{_toFieldTransform(e){return new uD(e.path,new la)}isEqual(e){return e instanceof Hm}}function Ny(s,e,t,n){const r=s.Cc(1,e,t);Mm("Data must be an object, but it was:",r,n);const i=[],o=on.empty();Br(n,(u,m)=>{const d=Om(e,u,t);m=Os(m);const f=r.yc(d);if(m instanceof ac)i.push(d);else{const h=Da(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new un(i);return new yy(o,l,r.fieldTransforms)}function xy(s,e,t,n,r,i){const o=s.Cc(1,e,t),l=[Iu(e,n,t)],u=[r];if(i.length%2!=0)throw new Ee(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Iu(e,i[h])),u.push(i[h+1]);const m=[],d=on.empty();for(let h=l.length-1;h>=0;--h)if(!Dy(m,l[h])){const b=l[h];let V=u[h];V=Os(V);const v=o.yc(b);if(V instanceof ac)m.push(b);else{const w=Da(V,v);w!=null&&(m.push(b),d.set(b,w))}}const f=new un(m);return new yy(d,f,o.fieldTransforms)}function _A(s,e,t,n=!1){return Da(t,s.Cc(n?4:3,e))}function Da(s,e){if(_y(s=Os(s)))return Mm("Unsupported field value:",e,s),vy(s,e);if(s instanceof oc)return function(n,r){if(!by(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let o=0;for(const l of n){let u=Da(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(s,e)}return function(n,r){if((n=Os(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return aD(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xe.fromDate(n);return{timestampValue:Cl(r.serializer,i)}}if(n instanceof xe){const i=new xe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Cl(r.serializer,i)}}if(n instanceof qn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yn)return{bytesValue:Hg(r.serializer,n._byteString)};if(n instanceof as){const i=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bm(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof $n)return function(o,l){return{mapValue:{fields:{[pg]:{stringValue:hg},[kl]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return hm(l.serializer,m)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${zl(n)}`)}(s,e)}function vy(s,e){const t={};return lg(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Br(s,(n,r)=>{const i=Da(r,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function _y(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof xe||s instanceof qn||s instanceof yn||s instanceof as||s instanceof oc||s instanceof $n)}function Mm(s,e,t){if(!_y(t)||!og(t)){const n=zl(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function Iu(s,e,t){if((e=Os(e))instanceof va)return e._internalPath;if(typeof e=="string")return Om(s,e);throw Ll("Field path arguments must be of type string or ",s,!1,void 0,t)}const DA=new RegExp("[~\\*/\\[\\]]");function Om(s,e,t){if(e.search(DA)>=0)throw Ll(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new va(...e.split("."))._internalPath}catch{throw Ll(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Ll(s,e,t,n,r){const i=n&&!n.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${r}`),u+=")"),new Ee(ie.INVALID_ARGUMENT,l+s+u)}function Dy(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new as(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kA extends ky{data(){return super.data()}}function lc(s,e){return typeof e=="string"?Om(s,e):e instanceof va?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ee(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fm{}class Ey extends Fm{}function xt(s,e,...t){let n=[];e instanceof Fm&&n.push(e),n=n.concat(t),function(i){const o=i.filter(u=>u instanceof qm).length,l=i.filter(u=>u instanceof cc).length;if(o>1||o>0&&l>0)throw new Ee(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)s=r._apply(s);return s}class cc extends Ey{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cc(e,t,n)}_apply(e){const t=this._parse(e);return Cy(e._query,t),new Hr(e.firestore,e.converter,Du(e._query,t))}_parse(e){const t=_a(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){tp(f,d);const V=[];for(const v of f)V.push(ep(u,i,v));h={arrayValue:{values:V}}}else h=ep(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||tp(f,d),h=_A(l,o,f,d==="in"||d==="not-in");return _s.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function js(s,e,t){const n=e,r=lc("where",s);return cc._create(r,n,t)}class qm extends Fm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qm(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Vn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)Cy(o,u),o=Du(o,u)}(e._query,t),new Hr(e.firestore,e.converter,Du(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $m extends Ey{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $m(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new aa(i,o)}(e._query,this._field,this._direction);return new Hr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new ao(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function ls(s,e="asc"){const t=e,n=lc("orderBy",s);return $m._create(n,t)}function ep(s,e,t){if(typeof(t=Os(t))=="string"){if(t==="")throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dg(e)&&t.indexOf("/")!==-1)throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Xt.fromString(t));if(!$e.isDocumentKey(n))throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return gf(s,new $e(n))}if(t instanceof as)return gf(s,t._key);throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zl(t)}.`)}function tp(s,e){if(!Array.isArray(s)||s.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cy(s,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(s.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AA{convertValue(e,t="none"){switch(Lr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Br(e,(r,i)=>{n[r]=this.convertValue(i,t)}),n}convertVectorValue(e){var n,r,i;const t=(i=(r=(n=e.fields)==null?void 0:n[kl].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>hs(o.doubleValue));return new $n(t)}convertGeoPoint(e){return new qn(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Yl(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ra(e));default:return null}}convertTimestamp(e){const t=Sr(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xt.fromString(e);Ut(Wg(n),9688,{name:e});const r=new ia(n.get(1),n.get(3)),i=new $e(n.popFirst(5));return r.isEqual(t)||rr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class Mo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ti extends ky{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(lc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ti._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ti._jsonSchemaVersion="firestore/documentSnapshot/1.0",ti._jsonSchema={type:ks("string",ti._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class fl extends ti{data(e={}){return super.data(e)}}class si{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Mo(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new fl(this._firestore,this._userDataWriter,n.key,n,new Mo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:EA(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=si._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EA(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xe(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(s){s=Ms(s,as);const e=Ms(s.firestore,bn);return dA(fi(e),s._key).then(t=>Vy(e,s,t))}si._jsonSchemaVersion="firestore/querySnapshot/1.0",si._jsonSchema={type:ks("string",si._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class zm extends AA{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new as(this.firestore,null,t)}}function wt(s){s=Ms(s,Hr);const e=Ms(s.firestore,bn),t=fi(e),n=new zm(e);return Ay(s._query),fA(t,s._query).then(r=>new si(e,n,s,r))}function li(s,e,t){s=Ms(s,as);const n=Ms(s.firestore,bn),r=Wm(s.converter,e,t);return ka(n,[Um(_a(n),"setDoc",s._key,r,s.converter!==null,t).toMutation(s._key,Zs.none())])}function Bt(s,e,t,...n){s=Ms(s,as);const r=Ms(s.firestore,bn),i=_a(r);let o;return o=typeof(e=Os(e))=="string"||e instanceof va?xy(i,"updateDoc",s._key,e,t,n):Ny(i,"updateDoc",s._key,e),ka(r,[o.toMutation(s._key,Zs.exists(!0))])}function Us(s){return ka(Ms(s.firestore,bn),[new tc(s._key,Zs.none())])}function Wn(s,e){const t=Ms(s.firestore,bn),n=Se(s),r=Wm(s.converter,e);return ka(t,[Um(_a(s.firestore),"addDoc",n._key,r,s.converter!==null,{}).toMutation(n._key,Zs.exists(!1))]).then(()=>n)}function dn(s,...e){var u,m,d;s=Os(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Zf(e[n])||(t=e[n++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Zf(e[n])){const f=e[n];e[n]=(u=f.next)==null?void 0:u.bind(f),e[n+1]=(m=f.error)==null?void 0:m.bind(f),e[n+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(s instanceof as)o=Ms(s.firestore,bn),l=Gl(s._key.path),i={next:f=>{e[n]&&e[n](Vy(o,s,f))},error:e[n+1],complete:e[n+2]};else{const f=Ms(s,Hr);o=Ms(f.firestore,bn),l=f._query;const h=new zm(o);i={next:b=>{e[n]&&e[n](new si(o,h,f,b))},error:e[n+1],complete:e[n+2]},Ay(s._query)}return function(h,b,V,v){const w=new jm(v),B=new Lm(b,w,V);return h.asyncQueue.enqueueAndForget(async()=>wm(await Tl(h),B)),()=>{w.Nu(),h.asyncQueue.enqueueAndForget(async()=>Sm(await Tl(h),B))}}(fi(o),l,r,i)}function ka(s,e){return function(n,r){const i=new er;return n.asyncQueue.enqueueAndForget(async()=>Zk(await cA(n),r,i)),i.promise}(fi(s),e)}function Vy(s,e,t){const n=t.docs.get(e._key),r=new zm(s);return new ti(s,r,e._key,n,new Mo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=_a(e)}set(e,t,n){this._verifyNotCommitted();const r=$c(e,this._firestore),i=Wm(r.converter,t,n),o=Um(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,Zs.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=$c(e,this._firestore);let o;return o=typeof(t=Os(t))=="string"||t instanceof va?xy(this._dataReader,"WriteBatch.update",i._key,t,n,r):Ny(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Zs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=$c(e,this._firestore);return this._mutations=this._mutations.concat(new tc(t._key,Zs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ee(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $c(s,e){if((s=Os(s)).firestore!==e)throw new Ee(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function os(){return new Hm("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(s){return fi(s=Ms(s,bn)),new CA(s,e=>ka(s,e))}(function(e,t=!0){(function(r){ro=r})(zh),ta(new Qi("firestore",(n,{instanceIdentifier:r,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new bn(new N_(n.getProvider("auth-internal")),new __(o,n.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ee(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ia(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Er(sf,nf,e),Er(sf,nf,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="firebasestorage.googleapis.com",Sy="storageBucket",wA=2*60*1e3,SA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends ui{constructor(e,t,n=0){super(Wc(e),`Firebase Storage: ${t} (${Wc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,us.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cs||(cs={}));function Wc(s){return"storage/"+s}function Km(){const s="An unknown error occurred, please check the error payload for server response.";return new us(cs.UNKNOWN,s)}function TA(s){return new us(cs.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function LA(s){return new us(cs.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function PA(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new us(cs.UNAUTHENTICATED,s)}function IA(){return new us(cs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function jA(s){return new us(cs.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function RA(){return new us(cs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BA(){return new us(cs.CANCELED,"User canceled the upload/download.")}function UA(s){return new us(cs.INVALID_URL,"Invalid URL '"+s+"'.")}function HA(s){return new us(cs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function MA(){return new us(cs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Sy+"' property when initializing the app?")}function OA(){return new us(cs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function FA(){return new us(cs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qA(s){return new us(cs.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ju(s){return new us(cs.INVALID_ARGUMENT,s)}function Ty(){return new us(cs.APP_DELETED,"The Firebase app was deleted.")}function $A(s){return new us(cs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Qo(s,e){return new us(cs.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function _o(s){throw new us(cs.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=mn.makeFromUrl(e,t)}catch{return new mn(e,"")}if(n.path==="")return n;throw HA(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(oe){oe.path.charAt(oe.path.length-1)==="/"&&(oe.path_=oe.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(oe){oe.path_=decodeURIComponent(oe.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",b=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),V={bucket:1,path:3},v=t===wy?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${w}`,"i"),F=[{regex:l,indices:u,postModify:i},{regex:b,indices:V,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let oe=0;oe<F.length;oe++){const se=F[oe],M=se.regex.exec(e);if(M){const C=M[se.indices.bucket];let x=M[se.indices.path];x||(x=""),n=new mn(C,x),se.postModify(n);break}}if(n==null)throw UA(e);return n}}class WA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(s,e,t){let n=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...w){m||(m=!0,e.apply(null,w))}function f(w){r=setTimeout(()=>{r=null,s(b,u())},w)}function h(){i&&clearTimeout(i)}function b(w,...B){if(m){h();return}if(w){h(),d.call(null,w,...B);return}if(u()||o){h(),d.call(null,w,...B);return}n<64&&(n*=2);let F;l===1?(l=2,F=0):F=(n+Math.random())*1e3,f(F)}let V=!1;function v(w){V||(V=!0,h(),!m&&(r!==null?(w||(l=2),clearTimeout(r),f(0)):w||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function KA(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(s){return s!==void 0}function YA(s){return typeof s=="object"&&!Array.isArray(s)}function Qm(s){return typeof s=="string"||s instanceof String}function sp(s){return Ym()&&s instanceof Blob}function Ym(){return typeof Blob<"u"}function np(s,e,t,n){if(n<e)throw ju(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw ju(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function Ly(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const r=e(n)+"="+e(s[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var ni;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ni||(ni={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(s,e){const t=s>=500&&s<600,r=[408,429].indexOf(s)!==-1,i=e.indexOf(s)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,t,n,r,i,o,l,u,m,d,f,h=!0,b=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((V,v)=>{this.resolve_=V,this.reject_=v,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Fa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===ni.NO_ERROR,u=i.getStatus();if(!l||GA(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ni.ABORT;n(!1,new Fa(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;n(!0,new Fa(m,i))})},t=(n,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());QA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=Km();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?Ty():BA();o(u)}else{const u=RA();o(u)}};this.canceled_?t(!1,new Fa(!1,null,!0)):this.backoffId_=zA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Fa{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function JA(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function ZA(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function eE(s,e){e&&(s["X-Firebase-GMPID"]=e)}function tE(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function sE(s,e,t,n,r,i,o=!0,l=!1){const u=Ly(s.urlParams),m=s.url+u,d=Object.assign({},s.headers);return eE(d,e),JA(d,t),ZA(d,i),tE(d,n),new XA(m,s.method,d,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rE(...s){const e=nE();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(Ym())return new Blob(s);throw new us(cs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function iE(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(s){if(typeof atob>"u")throw qA("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zc{constructor(e,t){this.data=e,this.contentType=t||null}}function aE(s,e){switch(s){case Mn.RAW:return new zc(Py(e));case Mn.BASE64:case Mn.BASE64URL:return new zc(Iy(s,e));case Mn.DATA_URL:return new zc(cE(e),uE(e))}throw Km()}function Py(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=s.charCodeAt(++t);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function lE(s){let e;try{e=decodeURIComponent(s)}catch{throw Qo(Mn.DATA_URL,"Malformed data URL.")}return Py(e)}function Iy(s,e){switch(s){case Mn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Mn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=oE(e)}catch(r){throw r.message.includes("polyfill")?r:Qo(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class jy{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Qo(Mn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=mE(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function cE(s){const e=new jy(s);return e.base64?Iy(Mn.BASE64,e.rest):lE(e.rest)}function uE(s){return new jy(s).contentType}function mE(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,t){let n=0,r="";sp(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(sp(this.data_)){const n=this.data_,r=iE(n,e,t);return r===null?null:new xr(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new xr(n,!0)}}static getBlob(...e){if(Ym()){const t=e.map(n=>n instanceof xr?n.data_:n);return new xr(rE.apply(null,t))}else{const t=e.map(o=>Qm(o)?aE(Mn.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let i=0;return t.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new xr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(s){let e;try{e=JSON.parse(s)}catch{return null}return YA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function fE(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function By(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(s,e){return e}class Xs{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||pE}}let qa=null;function hE(s){return!Qm(s)||s.length<2?s:By(s)}function Uy(){if(qa)return qa;const s=[];s.push(new Xs("bucket")),s.push(new Xs("generation")),s.push(new Xs("metageneration")),s.push(new Xs("name","fullPath",!0));function e(i,o){return hE(o)}const t=new Xs("name");t.xform=e,s.push(t);function n(i,o){return o!==void 0?Number(o):o}const r=new Xs("size");return r.xform=n,s.push(r),s.push(new Xs("timeCreated")),s.push(new Xs("updated")),s.push(new Xs("md5Hash",null,!0)),s.push(new Xs("cacheControl",null,!0)),s.push(new Xs("contentDisposition",null,!0)),s.push(new Xs("contentEncoding",null,!0)),s.push(new Xs("contentLanguage",null,!0)),s.push(new Xs("contentType",null,!0)),s.push(new Xs("metadata","customMetadata",!0)),qa=s,qa}function gE(s,e){function t(){const n=s.bucket,r=s.fullPath,i=new mn(n,r);return e._makeStorageReference(i)}Object.defineProperty(s,"ref",{get:t})}function yE(s,e,t){const n={};n.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];n[o.local]=o.xform(n,e[o.server])}return gE(n,s),n}function Hy(s,e,t){const n=Ry(e);return n===null?null:yE(s,n,t)}function bE(s,e,t,n){const r=Ry(e);if(r===null||!Qm(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(m=>{const d=s.bucket,f=s.fullPath,h="/b/"+o(d)+"/o/"+o(f),b=uc(h,t,n),V=Ly({alt:"media",token:m});return b+V})[0]}function NE(s,e){const t={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(t[i.server]=s[i.local])}return JSON.stringify(t)}class Gm{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(s){if(!s)throw Km()}function xE(s,e){function t(n,r){const i=Hy(s,r,e);return My(i!==null),i}return t}function vE(s,e){function t(n,r){const i=Hy(s,r,e);return My(i!==null),bE(i,r,s.host,s._protocol)}return t}function Oy(s){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=IA():r=PA():t.getStatus()===402?r=LA(s.bucket):t.getStatus()===403?r=jA(s.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Fy(s){const e=Oy(s);function t(n,r){let i=e(n,r);return n.getStatus()===404&&(i=TA(s.path)),i.serverResponse=r.serverResponse,i}return t}function _E(s,e,t){const n=e.fullServerUrl(),r=uc(n,s.host,s._protocol),i="GET",o=s.maxOperationRetryTime,l=new Gm(r,i,vE(s,t),o);return l.errorHandler=Fy(e),l}function DE(s,e){const t=e.fullServerUrl(),n=uc(t,s.host,s._protocol),r="DELETE",i=s.maxOperationRetryTime;function o(u,m){}const l=new Gm(n,r,o,i);return l.successCodes=[200,204],l.errorHandler=Fy(e),l}function kE(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function AE(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=kE(null,e)),n}function EE(s,e,t,n,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let F="";for(let oe=0;oe<2;oe++)F=F+Math.random().toString().slice(2);return F}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const m=AE(e,n,r),d=NE(m,t),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+m.contentType+`\r
\r
`,h=`\r
--`+u+"--",b=xr.getBlob(f,n,h);if(b===null)throw OA();const V={name:m.fullPath},v=uc(i,s.host,s._protocol),w="POST",B=s.maxUploadRetryTime,P=new Gm(v,w,xE(s,t),B);return P.urlParams=V,P.headers=o,P.body=b.uploadData(),P.errorHandler=Oy(e),P}class CE{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ni.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ni.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ni.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,i){if(this.sent_)throw _o("cannot .send() more than once");if(ha(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _o("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _o("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw _o("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _o("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VE extends CE{initXhr(){this.xhr_.responseType="text"}}function Xm(){return new VE}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t){this._service=e,t instanceof mn?this._location=t:this._location=mn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ci(e,t)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return By(this._location.path)}get storage(){return this._service}get parent(){const e=dE(this._location.path);if(e===null)return null;const t=new mn(this._location.bucket,e);return new ci(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $A(e)}}function wE(s,e,t){s._throwIfRoot("uploadBytes");const n=EE(s.storage,s._location,Uy(),new xr(e,!0),t);return s.storage.makeRequestWithTokens(n,Xm).then(r=>({metadata:r,ref:s}))}function SE(s){s._throwIfRoot("getDownloadURL");const e=_E(s.storage,s._location,Uy());return s.storage.makeRequestWithTokens(e,Xm).then(t=>{if(t===null)throw FA();return t})}function TE(s){s._throwIfRoot("deleteObject");const e=DE(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Xm)}function LE(s,e){const t=fE(s._location.path,e),n=new mn(s._location.bucket,t);return new ci(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(s){return/^[A-Za-z]+:\/\//.test(s)}function IE(s,e){return new ci(s,e)}function qy(s,e){if(s instanceof Jm){const t=s;if(t._bucket==null)throw MA();const n=new ci(t,t._bucket);return e!=null?qy(n,e):n}else return e!==void 0?LE(s,e):s}function jE(s,e){if(e&&PE(e)){if(s instanceof Jm)return IE(s,e);throw ju("To use ref(service, url), the first argument must be a Storage instance.")}else return qy(s,e)}function rp(s,e){const t=e==null?void 0:e[Sy];return t==null?null:mn.makeFromBucketSpec(t,s)}function RE(s,e,t,n={}){s.host=`${e}:${t}`;const r=ha(e);r&&(Bh(`https://${s.host}/b`),Hh("Storage",!0)),s._isUsingEmulator=!0,s._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(s._overrideAuthToken=typeof i=="string"?i:Uh(i,s.app.options.projectId))}class Jm{constructor(e,t,n,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=wy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wA,this._maxUploadRetryTime=SA,this._requests=new Set,r!=null?this._bucket=mn.makeFromBucketSpec(r,this._host):this._bucket=rp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=rp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){np("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){np("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wh(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ci(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new WA(Ty());{const o=sE(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const ip="@firebase/storage",op="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="storage";function Ru(s,e,t){return s=Os(s),wE(s,e,t)}function Bu(s){return s=Os(s),SE(s)}function BE(s){return s=Os(s),TE(s)}function Pl(s,e){return s=Os(s),jE(s,e)}function UE(s=Qh(),e){s=Os(s);const n=$h(s,$y).getImmediate({identifier:e}),r=jh("storage");return r&&HE(n,...r),n}function HE(s,e,t,n={}){RE(s,e,t,n)}function ME(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),r=s.getProvider("app-check-internal");return new Jm(t,n,r,e,zh)}function OE(){ta(new Qi($y,ME,"PUBLIC").setMultipleInstances(!0)),Er(ip,op,""),Er(ip,op,"esm2020")}OE();const FE={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Wy=Xd().length===0?Kh(FE):Xd()[0],re=hA(Wy),Il=UE(Wy),ap=async()=>{try{console.log("[Firebase]   ..."),await bA(re),await yA(re),console.log("[Firebase]   ")}catch(s){console.error("[Firebase]   :",s)}},$a=async s=>{const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")},qE=s=>{const t=new TextEncoder().encode(s);let n="";return t.forEach(r=>n+=String.fromCharCode(r)),btoa(n)},$E=s=>{const e=atob(s),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)},lp=s=>{const e={id:s.id,username:s.username,role:s.role,iat:Date.now(),exp:Date.now()+2592e6};return qE(JSON.stringify(e))},cp=s=>{try{if(s.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse($E(s));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},up={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Kc={async login(s){console.time("[Auth]   ");const e=up[s.username];if(e){if(s.password!==e.password)throw new Error("  .");const d=e.user,f=lp(d);return wt(xt(qe(re,"users"),js("username","==",s.username))).then(h=>{h.empty||Bt(Se(re,"users",h.docs[0].id),{lastLogin:os()}).catch(b=>console.error("lastLogin  :",b))}).catch(h=>console.error("Firestore  :",h)),console.timeEnd("[Auth]   "),{success:!0,token:f,user:d}}console.time("[Auth] Firestore ");const t=qe(re,"users"),n=xt(t,js("username","==",s.username)),r=await wt(n);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],o=i.data(),l=await $a(s.password);if(o.passwordHash){if(o.passwordHash!==l)throw new Error("  .")}else if(o.password){if(o.password.startsWith("$2b$")||o.password.startsWith("$2a$")){if(s.password!=="1234")throw new Error("  .")}else if(o.password!==s.password&&s.password!=="1234")throw new Error("  .")}else if(s.password!=="1234")throw new Error("  .");const u={id:i.id,username:o.username,name:o.name,email:o.email,role:o.role||"user",phone:o.phone,department:o.department,position:o.position,avatar:o.avatar},m=lp(u);return Bt(Se(re,"users",i.id),{lastLogin:os()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:m,user:u}},async getCurrentUser(s){const e=cp(s);if(!e)return null;const t=up[e.username];if(t)return t.user;try{const n=await It(Se(re,"users",e.id));if(!n.exists())return null;const r=n.data();return{id:n.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(n){return console.error("Firestore getCurrentUser error:",n),null}},async getUserById(s){const e=await It(Se(re,"users",s));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(s){const e=qe(re,"users"),t=xt(e,js("username","==",s)),n=await wt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const s=qe(re,"users");return(await wt(s)).docs.map(t=>{const n=t.data();return{id:t.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}})},async createUser(s){const{password:e,...t}=s,n=await $a(e),r=qe(re,"users"),i=Se(r),o={...t,passwordHash:n,createdAt:os(),updatedAt:os()};return await li(i,o),{id:i.id,...t}},async updateUser(s,e){const t=Se(re,"users",s);await Bt(t,{...e,updatedAt:os()});const r=(await It(t)).data();return{id:s,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(s,e,t){const n=await It(Se(re,"users",s));if(!n.exists())throw new Error("   .");const r=n.data(),i=await $a(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await $a(t);return await Bt(Se(re,"users",s),{passwordHash:o,updatedAt:os()}),!0},verifyToken:cp};class WE{async login(e){const t=await Kc.login(e);return t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}async getCurrentUser(){const e=this.getToken(),t=this.getUser();if(!e)return t;try{const n=await Kc.getCurrentUser(e);return n?(localStorage.setItem("user",JSON.stringify(n)),n):(console.log("Token invalid or expired, using cached user..."),t?(localStorage.removeItem("token"),t):null)}catch(n){return console.error("Get current user error:",n),t?(console.log("Using cached user data due to error"),t):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Kc.getAllUsers()}}const mp=new WE,Di=(s,e)=>({id:parseInt(s)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Qc={async getLibraryMeta(){const s=qe(re,"specbook_items"),e=xt(s,js("is_library","==",1),ls("category"),ls("name"));return(await wt(e)).docs.map(n=>Di(n.id,n.data()))},async getCategories(){const s=await this.getLibraryMeta();return[...new Set(s.map(t=>t.category))].sort()},async getProjectMeta(s){const e=qe(re,"specbook_items"),t=xt(e,js("project_id","==",s),ls("display_order"));return(await wt(t)).docs.map(r=>Di(r.id,r.data()))},async getItemById(s){const e=Se(re,"specbook_items",s),t=await It(e);return t.exists()?Di(t.id,t.data()):null},async getItemImage(s){const e=Se(re,"specbook_items",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{image_url:n.image_url||null,sub_images:n.sub_images||[]}},subscribeToLibraryItems(s){const e=qe(re,"specbook_items"),t=xt(e,js("is_library","==",1));return dn(t,r=>{const i=r.docs.map(o=>Di(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),s(i)})},subscribeToProjectItems(s,e){const t=qe(re,"specbook_items"),n=xt(t,js("project_id","==",s));return dn(n,i=>{const o=i.docs.map(l=>Di(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})},async updateCategories(s){const e=Se(re,"specbook_settings","categories");await li(e,{categories:s,updatedAt:os()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(s){try{const e=qe(re,"specbook_items"),t=await wt(e);let n=0;t.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>n&&(n=m)});const r=n+1;let i=null;if(s.image&&s.image.startsWith("data:")){const u=s.image.split(",")[1],m=s.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),b=new Array(h.length);for(let P=0;P<h.length;P++)b[P]=h.charCodeAt(P);const V=new Uint8Array(b),v=new Blob([V],{type:d}),w=`specbook/${r}-${Date.now()}.${f}`,B=Pl(Il,w);await Ru(B,v),i=await Bu(B)}const o=new Date().toISOString(),l=Se(re,"specbook_items",String(r));return await li(l,{name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade||null,created_at:o,updated_at:o}),console.log(" [Firestore]    :",r),{id:r,name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade,created_at:o,updated_at:o}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(s,e){try{const t=Se(re,"specbook_items",String(s)),n=await It(t);if(!n.exists())throw new Error("   .");const r=n.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const u=e.image.split(",")[1],m=e.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),b=new Array(h.length);for(let P=0;P<h.length;P++)b[P]=h.charCodeAt(P);const V=new Uint8Array(b),v=new Blob([V],{type:d}),w=`specbook/${s}-${Date.now()}.${f}`,B=Pl(Il,w);await Ru(B,v),i=await Bu(B)}const l={updated_at:new Date().toISOString()};return e.name!==void 0&&(l.name=e.name),e.category!==void 0&&(l.category=e.category),e.brand!==void 0&&(l.brand=e.brand),e.price!==void 0&&(l.price=e.price),e.description!==void 0&&(l.description=e.description),i!==r.image_url&&(l.image_url=i),e.sub_images!==void 0&&(l.sub_images=e.sub_images),e.project_id!==void 0&&(l.project_id=e.project_id),e.is_library!==void 0&&(l.is_library=e.is_library),e.display_order!==void 0&&(l.display_order=e.display_order),e.grade!==void 0&&(l.grade=e.grade),await Bt(t,l),console.log(" [Firestore]    :",s),Di(String(s),{...r,...l,image_url:i})}catch(t){throw console.error("[Firestore]    :",t),new Error(`  : ${t.message||"   "}`)}},async deleteItem(s){try{const e=Se(re,"specbook_items",String(s));await Us(e),console.log(" [Firestore]    :",s)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(s,e){try{const t=Se(re,"specbook_items",String(s));await Bt(t,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",s)}catch(t){throw console.error("[Firestore]    :",t),new Error(`   : ${t.message||"   "}`)}},async reorderItems(s){try{const e=VA(re);s.forEach(t=>{const n=Se(re,"specbook_items",String(t.id));e.update(n,{display_order:t.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},zE=10*60*1e3,KE=Wu((s,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<zE){console.log("[SpecbookStore]   , ");return}s({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const n=await Qc.getLibraryMeta();s({libraryItems:n,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",n.length," ")}catch(n){console.error("[SpecbookStore]   :",n),s({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const n=await Qc.getCategories();s({categories:n,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",n.length,"")}catch(n){console.error("[SpecbookStore]   :",n)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:n}=e();await Promise.all([t(),n()])},getLibraryItems:(t,n)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),n&&n.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return n.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:n}=e();return n.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const i=await Qc.getProjectMeta(t);return s(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{s(n=>{const r=new Map(n.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?s(n=>({libraryItems:[t,...n.libraryItems]})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?s(n=>({libraryItems:n.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,n,r)=>{n?s(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&s(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),zy=A.createContext(void 0);function QE({children:s}){const[e,t]=A.useState(null),[n,r]=A.useState(!0),i=zp(),o=KE(f=>f.preloadAll);A.useEffect(()=>{l()},[]);const l=async()=>{try{const f=localStorage.getItem("user");let h=null;if(f)try{h=JSON.parse(f)}catch{}if(h&&(t(h),o()),!localStorage.getItem("token")){r(!1);return}const V=await mp.getCurrentUser();V&&(t(V),localStorage.setItem("user",JSON.stringify(V)))}catch(f){console.error("Auth check error:",f)}finally{r(!1)}},u=async(f,h)=>{var b,V;try{const v=await mp.login({username:f,password:h}),w=v.token,B=v.user;localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(B)),Zo.defaults.headers.common.Authorization=`Bearer ${w}`,t(B),o(),ne.success(`${B.name}, !`);const P=sessionStorage.getItem("redirectAfterLogin");P?(sessionStorage.removeItem("redirectAfterLogin"),i(P)):i("/")}catch(v){const w=v;throw ne.error(((V=(b=w.response)==null?void 0:b.data)==null?void 0:V.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Zo.defaults.headers.common.Authorization,t(null),i("/login"),ne.success("")},d=f=>{t(f)};return a.jsxDEV(zy.Provider,{value:{user:e,loading:n,login:u,logout:m,updateUser:d},children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:131,columnNumber:5},this)}function Mr(){const s=A.useContext(zy);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const YE={};function GE(s,e){let t;try{t=s()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const ma=s=>e=>{try{const t=s(e);return t instanceof Promise?t:{then(n){return ma(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return ma(n)(t)}}}},XE=(s,e)=>(t,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,B)=>({...B,...w}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return s((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...w)},n,r);const d=ma(i.serialize),f=()=>{const w=i.partialize({...n()});let B;const P=d({state:w,version:i.version}).then(F=>m.setItem(i.name,F)).catch(F=>{B=F});if(B)throw B;return P},h=r.setState;r.setState=(w,B)=>{h(w,B),f()};const b=s((...w)=>{t(...w),f()},n,r);let V;const v=()=>{var w;if(!m)return;o=!1,l.forEach(P=>P(n()));const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,n()))||void 0;return ma(m.getItem.bind(m))(i.name).then(P=>{if(P)return i.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==i.version){if(i.migrate)return i.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var F;return V=i.merge(P,(F=n())!=null?F:b),t(V,!0),f()}).then(()=>{B==null||B(V,void 0),o=!0,u.forEach(P=>P(V))}).catch(P=>{B==null||B(void 0,P)})};return r.persist={setOptions:w=>{i={...i,...w},w.getStorage&&(m=w.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},v(),V||b},JE=(s,e)=>(t,n,r)=>{let i={storage:GE(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return s((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},n,r);const d=()=>{const v=i.partialize({...n()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,w)=>{f(v,w),d()};const h=s((...v)=>{t(...v),d()},n,r);r.getInitialState=()=>h;let b;const V=()=>{var v,w;if(!m)return;o=!1,l.forEach(P=>{var F;return P((F=n())!=null?F:h)});const B=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(v=n())!=null?v:h))||void 0;return ma(m.getItem.bind(m))(i.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==i.version){if(i.migrate)return[!0,i.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var F;const[oe,se]=P;if(b=i.merge(se,(F=n())!=null?F:h),t(b,!0),oe)return d()}).then(()=>{B==null||B(b,void 0),b=n(),o=!0,u.forEach(P=>P(b))}).catch(P=>{B==null||B(void 0,P)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>V(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||V(),b||h},ZE=(s,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((YE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),XE(s,e)):JE(s,e),Ky=ZE,Qy=Wu()(Ky((s,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const n={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};s(r=>({notifications:[n,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{s(n=>({notifications:n.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,n.unreadCount-1)}))},markAllAsRead:()=>{s(t=>({notifications:t.notifications.map(n=>({...n,read:!0})),unreadCount:0}))},deleteNotification:t=>{s(n=>{const r=n.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:n.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,n.unreadCount-1):n.unreadCount}})},clearAll:()=>{s({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:s=>({notifications:s.notifications,unreadCount:s.unreadCount})}));var eC={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},tC=function(e,t,n){var r,i=eC[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+" ":r+" ":r},sC={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},nC={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},rC={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},iC={date:Tc({formats:sC,defaultWidth:"full"}),time:Tc({formats:nC,defaultWidth:"full"}),dateTime:Tc({formats:rC,defaultWidth:"full"})},oC={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},aC=function(e,t,n,r){return oC[e]},lC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},cC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},uC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},mC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},dC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},fC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},pC=function(e,t){var n=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},hC={ordinalNumber:pC,era:No({values:lC,defaultWidth:"wide"}),quarter:No({values:cC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:No({values:uC,defaultWidth:"wide"}),day:No({values:mC,defaultWidth:"wide"}),dayPeriod:No({values:dC,defaultWidth:"wide",formattingValues:fC,defaultFormattingWidth:"wide"})},gC=/^(\d+)(|)?/i,yC=/\d+/i,bC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},NC={any:[/^(bc|)/i,/^(ad|)/i]},xC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},vC={any:[/1/i,/2/i,/3/i,/4/i]},_C={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},DC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},kC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},AC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},EC={any:/^(am|pm|||||||)/i},CC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},VC={ordinalNumber:UN({matchPattern:gC,parsePattern:yC,valueCallback:function(e){return parseInt(e,10)}}),era:xo({matchPatterns:bC,defaultMatchWidth:"wide",parsePatterns:NC,defaultParseWidth:"any"}),quarter:xo({matchPatterns:xC,defaultMatchWidth:"wide",parsePatterns:vC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:xo({matchPatterns:_C,defaultMatchWidth:"wide",parsePatterns:DC,defaultParseWidth:"any"}),day:xo({matchPatterns:kC,defaultMatchWidth:"wide",parsePatterns:AC,defaultParseWidth:"any"}),dayPeriod:xo({matchPatterns:EC,defaultMatchWidth:"any",parsePatterns:CC,defaultParseWidth:"any"})},xs={code:"ko",formatDistance:tC,formatLong:iC,formatRelative:aC,localize:hC,match:VC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const wC=({isOpen:s,onClose:e})=>{const t=zp(),{notifications:n,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Qy();if(!s)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(CN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(EN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Yp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(AN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Sc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Sc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),n.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(Qp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(ii,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Sc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:n.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:HN(new Date(h.createdAt),{addSuffix:!0,locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:b=>{b.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},ki="work_requests",Do=s=>{const e=s.data();return{_id:s.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof xe?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof xe?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ai={getAllWorkRequests:async()=>{const s=xt(qe(re,ki),ls("createdAt","desc"));return(await wt(s)).docs.map(Do)},getWorkRequestById:async s=>{const e=Se(re,ki,s),t=await It(e);return t.exists()?Do(t):null},createWorkRequest:async s=>{const e=xe.now(),t={project:s.project,requestType:s.requestType,description:s.description,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,dueDate:s.dueDate instanceof Date?xe.fromDate(s.dueDate):s.dueDate,requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status||"pending",priority:s.priority||"medium",notes:s.notes||"",createdAt:e,updatedAt:e},n=await Wn(qe(re,ki),t),r=await It(n);return Do(r)},updateWorkRequest:async(s,e)=>{const t=Se(re,ki,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.requestType!==void 0&&(n.requestType=e.requestType),e.description!==void 0&&(n.description=e.description),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(n.dueDate=e.dueDate instanceof Date?xe.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(n.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.status!==void 0&&(n.status=e.status),e.priority!==void 0&&(n.priority=e.priority),e.notes!==void 0&&(n.notes=e.notes),e.completedDate!==void 0&&(n.completedDate=e.completedDate instanceof Date?xe.fromDate(e.completedDate):e.completedDate),await Bt(t,n);const r=await It(t);return Do(r)},deleteWorkRequest:async s=>{const e=Se(re,ki,s);await Us(e)},subscribeToWorkRequests:s=>{const e=xt(qe(re,ki),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Do);s(n)})}},SC={getAllWorkRequests:()=>Ai.getAllWorkRequests(),getWorkRequestById:async s=>{const e=await Ai.getWorkRequestById(s);if(!e)throw new Error("Work request not found");return e},createWorkRequest:s=>Ai.createWorkRequest(s),updateWorkRequest:(s,e)=>Ai.updateWorkRequest(s,e),deleteWorkRequest:s=>Ai.deleteWorkRequest(s),subscribeToWorkRequests:Ai.subscribeToWorkRequests},Rt={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function b2(s,e){const t=qe(re,s);return(await Wn(t,{...e,createdAt:xe.now(),updatedAt:xe.now()})).id}function to(s){return!s||typeof s!="string"||s.startsWith("http://")||s.startsWith("https://")?!1:!!(s.startsWith("data:image")||s.length>1e3)}function TC(s){if(s.startsWith("data:")){const e=s.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function LC(s){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[s]||"jpg"}function PC(s){let e=s,t="image/jpeg";if(s.includes(",")){const o=s.split(",");e=o[1];const l=o[0].match(/data:([^;]+);/);l&&(t=l[1])}const n=atob(e),r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);const i=new Uint8Array(r);return new Blob([i],{type:t})}async function Yy(s,e,t,n){if(!to(t))return t;const r=TC(t),i=LC(r),o=n!==void 0?`image_${n}.${i}`:`main.${i}`,l=`${s}/${e}/${o}`,u=Pl(Il,l),m=PC(t);return await Ru(u,m,{contentType:r}),await Bu(u)}async function jl(s,e,t){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=await Yy(s,e,i,r);n.push(o)}return n}async function Gy(s){if(s.includes("firebasestorage.googleapis.com"))try{const e=s.match(/\/o\/(.+)\?/);if(e){const t=decodeURIComponent(e[1]),n=Pl(Il,t);await BE(n)}}catch(e){console.warn("  :",e)}}async function Xy(s){await Promise.all(s.map(e=>Gy(e)))}let ri=new Map,Fi=null;async function fr(){if(!(ri.size>0))return Fi||(Fi=(async()=>{try{const s=qe(re,Rt.PROJECTS);(await wt(s)).docs.forEach(t=>{const n=t.data();ri.set(t.id,{name:n.name||"",color:n.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ri.size,"")}catch(s){throw console.error("[paymentFirestoreService]    :",s),Fi=null,s}})(),Fi)}function ko(s){const e=ri.get(String(s.projectId))||{name:"",color:"#4A90E2"};return!e.name&&s.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:s.id,projectId:s.projectId,cacheSize:ri.size,cacheKeys:Array.from(ri.keys()).slice(0,5),vendorName:s.vendorName}),{id:s.id,project_id:s.projectId,project_name:e.name,project_color:e.color,user_id:s.userId||0,requester_name:s.requestedBy||"",approved_by:s.approvedBy||void 0,request_type:s.requestType||"material",vendor_name:s.vendorName||"",description:s.description||"",amount:s.amount||0,account_holder:s.accountHolder||"",bank_name:s.bankName||"",account_number:s.accountNumber||"",item_name:s.itemName||"",material_amount:s.materialAmount||0,labor_amount:s.laborAmount||0,original_material_amount:s.originalMaterialAmount||0,original_labor_amount:s.originalLaborAmount||0,apply_tax_deduction:s.applyTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,quick_text:s.quickText||"",images:s.images?JSON.stringify(s.images):"[]",notes:s.notes||"",status:s.status||"pending",created_at:s.createdAt||"",updated_at:s.updatedAt||"",paid_at:s.paidAt||void 0}}function dp(s){const e={};if(s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.request_type!==void 0&&(e.requestType=s.request_type),s.category!==void 0&&(e.requestType=s.category),s.vendor_name!==void 0&&(e.vendorName=s.vendor_name),s.process!==void 0&&(e.vendorName=s.process),s.description!==void 0&&(e.description=s.description),s.purpose!==void 0&&(e.description=s.purpose),s.amount!==void 0&&(e.amount=s.amount),s.account_holder!==void 0&&(e.accountHolder=s.account_holder),s.bank_name!==void 0&&(e.bankName=s.bank_name),s.account_number!==void 0&&(e.accountNumber=s.account_number),s.bankInfo!==void 0&&typeof s.bankInfo=="object"&&s.bankInfo!==null){const t=s.bankInfo;t.accountHolder&&(e.accountHolder=t.accountHolder),t.bankName&&(e.bankName=t.bankName),t.accountNumber&&(e.accountNumber=t.accountNumber)}return s.notes!==void 0&&(e.notes=s.notes),s.itemName!==void 0&&(e.itemName=s.itemName),s.item_name!==void 0&&(e.itemName=s.item_name),s.materialAmount!==void 0&&(e.materialAmount=s.materialAmount),s.laborAmount!==void 0&&(e.laborAmount=s.laborAmount),s.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=s.originalMaterialAmount),s.originalLaborAmount!==void 0&&(e.originalLaborAmount=s.originalLaborAmount),s.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=s.applyTaxDeduction),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),s.quickText!==void 0&&(e.quickText=s.quickText),s.images!==void 0&&(e.images=Array.isArray(s.images)?s.images:[]),s.status!==void 0&&(e.status=s.status),s.requestedBy!==void 0&&(e.requestedBy=s.requestedBy),e}const tn={getAllPayments:async()=>{await fr();const s=qe(re,Rt.PAYMENTS),e=xt(s,ls("id","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return ko({...r,id:parseInt(n.id)||r.id})})},getPaymentById:async s=>{await fr();const e=Se(re,Rt.PAYMENTS,s),t=await It(e);if(t.exists()){const n=t.data();return ko({...n,id:parseInt(t.id)||n.id})}return null},createPayment:async s=>{await fr();const e=qe(re,Rt.PAYMENTS),t=await wt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=n+1,i=dp(s),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},u=Se(re,Rt.PAYMENTS,String(r));if(await li(u,l),i.images&&i.images.length>0)if(i.images.some(d=>to(d))){const d=await jl("payments",String(r),i.images);await Bt(u,{images:d,imageCount:d.length}),l.images=d,l.imageCount=d.length}else await Bt(u,{images:i.images,imageCount:i.images.length}),l.images=i.images,l.imageCount=i.images.length;return ko(l)},updatePayment:async(s,e)=>{await fr();const t=Se(re,Rt.PAYMENTS,s),n=dp(e);await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(s,e)=>{console.log("[Firestore]   :",s,"->",e),await fr();const t=Se(re,Rt.PAYMENTS,s),n=new Date().toISOString(),r={status:e,updatedAt:n};e==="completed"&&(r.paidAt=n),await Bt(t,r),console.log("[Firestore]   :",s,"->",e);const i=await tn.getPaymentById(s);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(s,e,t)=>{await fr();const n=Se(re,Rt.PAYMENTS,s);await Bt(n,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(s,e)=>{const t=Se(re,Rt.PAYMENTS,s);let n=e;return e.length>0&&e.some(i=>to(i))&&(n=await jl("payments",s,e)),await Bt(t,{images:n,imageCount:n.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:n}},deletePayment:async s=>{const e=Se(re,Rt.PAYMENTS,s),t=await It(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Xy(n.images)}await Us(e)},subscribeToPayments:s=>{let e=null;return fr().then(()=>{const t=qe(re,Rt.PAYMENTS),n=xt(t,ls("id","desc"));e=dn(n,{includeMetadataChanges:!0},r=>{console.log("[ ]  :",r.docs.length,", fromCache:",r.metadata.fromCache);const i=r.docs.map(o=>{const l=o.data();return ko({...l,id:parseInt(o.id)||l.id})});s(i)},r=>{console.error("[ ]  :",r)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async s=>{await fr();const e=qe(re,Rt.PAYMENTS),t=xt(e,js("projectId","==",s),ls("id","desc"));return(await wt(t)).docs.map(r=>{const i=r.data();return ko({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ri.clear(),Fi=null}},ln={getAllPayments:()=>tn.getAllPayments(),getPaymentById:async s=>{const e=await tn.getPaymentById(s);if(!e)throw new Error("Payment not found");return e},createPayment:s=>tn.createPayment(s),updatePayment:(s,e)=>tn.updatePayment(s,e),updatePaymentStatus:(s,e)=>tn.updatePaymentStatus(s,e),updatePaymentAmounts:(s,e,t)=>tn.updatePaymentAmounts(s,e,t),updatePaymentImages:(s,e)=>tn.updatePaymentImages(s,e),deletePayment:s=>tn.deletePayment(s),sendTossPaymentSms:async s=>(await Zo.post("/payments/send-toss-payment-sms",s)).data,subscribeToPayments:tn.subscribeToPayments,getPaymentsByProject:tn.getPaymentsByProject,clearProjectsCache:tn.clearProjectsCache},Ei="as_requests",Ao=s=>{const e=s.data();return{_id:s.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof xe?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof xe?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ci={getAllASRequests:async()=>{const s=xt(qe(re,Ei),ls("createdAt","desc"));return(await wt(s)).docs.map(Ao)},getASRequestById:async s=>{const e=Se(re,Ei,s),t=await It(e);return t.exists()?Ao(t):null},createASRequest:async s=>{const e=xe.now(),t={project:s.project,client:s.client,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,status:s.status||"pending",notes:s.notes||"",createdAt:e,updatedAt:e};s.scheduledVisitDate&&(t.scheduledVisitDate=s.scheduledVisitDate instanceof Date?xe.fromDate(s.scheduledVisitDate):s.scheduledVisitDate),s.scheduledVisitTime&&(t.scheduledVisitTime=s.scheduledVisitTime),s.assignedTo&&(t.assignedTo=s.assignedTo);const n=await Wn(qe(re,Ei),t),r=await It(n);return Ao(r)},updateASRequest:async(s,e)=>{const t=Se(re,Ei,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(n.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(n.entrancePassword=e.entrancePassword),e.description!==void 0&&(n.description=e.description),e.scheduledVisitDate!==void 0&&(n.scheduledVisitDate=e.scheduledVisitDate instanceof Date?xe.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(n.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.completionDate!==void 0&&(n.completionDate=e.completionDate instanceof Date?xe.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(n.notes=e.notes),e.status!==void 0&&(n.status=e.status),await Bt(t,n);const r=await It(t);return Ao(r)},deleteASRequest:async s=>{const e=Se(re,Ei,s);await Us(e)},subscribeToASRequests:s=>{const e=xt(qe(re,Ei),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Ao);s(n)})}},Oo={getAllASRequests:()=>Ci.getAllASRequests(),getASRequestById:async s=>{const e=await Ci.getASRequestById(s);if(!e)throw new Error("AS Request not found");return e},createASRequest:s=>Ci.createASRequest(s),updateASRequest:(s,e)=>Ci.updateASRequest(s,e),deleteASRequest:s=>Ci.deleteASRequest(s),subscribeToASRequests:Ci.subscribeToASRequests};function Eo(s){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:s.id,id:parseInt(s.id)||0,name:s.name,client:{name:s.client||"",phone:"",address:s.address||""},location:{address:s.address||""},startDate:s.startDate||"",endDate:s.endDate||"",status:e[s.status]||"planning",budget:0,actualCost:0,manager:{_id:String(s.managerId||""),name:s.managerName||s.manager||"",username:s.managerUsername||""},fieldManagers:[],workers:[],colorCode:s.color||"#4A90E2",progress:0,description:s.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:s.createdAt||"",updatedAt:s.updatedAt||"",meetingNotes:s.meetingNotes||[],customerRequests:s.customerRequests||[],entrancePassword:s.entrancePassword||"",sitePassword:s.sitePassword||""}}function fp(s){var t,n,r,i,o,l,u,m;const e={};if(s.name!==void 0&&(e.name=s.name),s.client!==void 0&&(e.client=typeof s.client=="string"?s.client:((t=s.client)==null?void 0:t.name)||""),s.location!==void 0&&(e.address=typeof s.location=="string"?s.location:((n=s.location)==null?void 0:n.address)||""),s.address!==void 0&&(e.address=s.address),s.startDate!==void 0&&(e.startDate=typeof s.startDate=="string"?s.startDate:((o=(i=(r=s.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),s.endDate!==void 0&&(e.endDate=typeof s.endDate=="string"?s.endDate:((m=(u=(l=s.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),s.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[s.status]||"planning"}return s.description!==void 0&&(e.description=s.description),s.manager!==void 0&&(e.manager=s.manager),s.meetingNotes!==void 0&&(e.meetingNotes=s.meetingNotes),s.customerRequests!==void 0&&(e.customerRequests=s.customerRequests),s.entrancePassword!==void 0&&(e.entrancePassword=s.entrancePassword),s.sitePassword!==void 0&&(e.sitePassword=s.sitePassword),s.color!==void 0&&(e.color=s.color),s.colorCode!==void 0&&(e.color=s.colorCode),e}const yr={getAllProjects:async()=>{const s=qe(re,Rt.PROJECTS);return(await wt(s)).docs.map(n=>{const r=n.data();return Eo({...r,id:n.id})}).sort((n,r)=>(r.id||0)-(n.id||0))},getProjectById:async s=>{const e=Se(re,Rt.PROJECTS,s),t=await It(e);if(t.exists()){const n=t.data();return Eo({...n,id:t.id})}return null},createProject:async s=>{const e=qe(re,Rt.PROJECTS),t=await wt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=String(n+1),i=fp(s),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Se(re,Rt.PROJECTS,r);return await li(u,l),Eo(l)},updateProject:async(s,e)=>{const t=Se(re,Rt.PROJECTS,s),n=fp(e);await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await yr.getProjectById(s);if(!r)throw new Error("Project not found after update");return r},deleteProject:async s=>{const e=Se(re,Rt.PROJECTS,s);await Us(e)},subscribeToProjects:s=>{const e=qe(re,Rt.PROJECTS);return dn(e,t=>{const n=t.docs.map(r=>{const i=r.data();return Eo({...i,id:r.id})});n.sort((r,i)=>(i.id||0)-(r.id||0)),s(n)})},subscribeToProject:(s,e)=>{const t=Se(re,Rt.PROJECTS,s);return dn(t,n=>{if(n.exists()){const r=n.data();e(Eo({...r,id:n.id}))}else e(null)})}},$i={getAllProjects:()=>yr.getAllProjects(),getProjectById:async s=>{const e=await yr.getProjectById(s);if(!e)throw new Error("Project not found");return e},createProject:s=>yr.createProject(s),updateProject:(s,e)=>yr.updateProject(s,e),deleteProject:s=>yr.deleteProject(s),subscribeToProjects:yr.subscribeToProjects,subscribeToProject:yr.subscribeToProject},Yc=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Wa={async getAllQuoteInquiries(){const s=qe(re,"quote_inquiries"),e=xt(s,ls("createdAt","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return{id:n.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Yc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(s){const e=Se(re,"quote_inquiries",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{id:t.id,name:n.name||"",phone:n.phone||"",email:n.email||"",address:n.address,projectType:n.projectType,budget:n.budget,message:n.message||"",createdAt:Yc(n.createdAt),isRead:n.isRead||!1}},async createQuoteInquiry(s){const e=qe(re,"quote_inquiries"),t={...s,isRead:!1,createdAt:os()};return{id:(await Wn(e,t)).id,...s,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(s){const e=Se(re,"quote_inquiries",s);await Bt(e,{isRead:!0,updatedAt:os()})},async deleteQuoteInquiry(s){const e=Se(re,"quote_inquiries",s);await Us(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(s){const e=qe(re,"quote_inquiries"),t=xt(e,ls("createdAt","desc"));return dn(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:Yc(l.createdAt),isRead:l.isRead||!1}});s(i)})}},pl={getAllQuoteInquiries:()=>Wa.getAllQuoteInquiries(),markAsRead:s=>Wa.markAsRead(s),deleteQuoteInquiry:s=>Wa.deleteQuoteInquiry(s),subscribeToQuoteInquiries:Wa.subscribeToQuoteInquiries},IC=()=>typeof window<"u"?window.location.origin:"",jC=IC();class RC{constructor(){wd(this,"socket",null)}connect(e){return this.socket=Fo(jC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var n;(n=this.socket)==null||n.on(e,t)}emit(e,t){var n;(n=this.socket)==null||n.emit(e,t)}off(e,t){var n;(n=this.socket)==null||n.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Rl=new RC,BC=()=>{var ae,He;const{user:s,logout:e,loading:t}=Mr(),[n,r]=A.useState(!1),[i,o]=A.useState(!1),[l,u]=A.useState(!1),m=bN(),{unreadCount:d}=Qy(),[f,h]=A.useState(0),[b,V]=A.useState(0),[v,w]=A.useState(0),[B,P]=A.useState(0),[F,oe]=A.useState(!1),[se,M]=A.useState(0),[C,x]=A.useState(!1),E=A.useRef(0),j=A.useRef(null),L=80,T=A.useCallback(de=>{if(window.scrollY>0)return!1;let Le=de;for(;Le&&Le!==document.body;){const bt=window.getComputedStyle(Le).overflowY;if((bt==="auto"||bt==="scroll")&&Le.scrollTop>0)return!1;Le=Le.parentElement}return!0},[]),k=A.useCallback(de=>{if(window.innerWidth>=768)return;const Le=de.target;T(Le)&&(E.current=de.touches[0].clientY,oe(!0))},[T]),_e=A.useCallback(de=>{if(!F||C)return;const Le=de.target;if(!T(Le)){oe(!1),M(0);return}const bt=de.touches[0].clientY-E.current;if(bt>0){const it=Math.min(bt*.5,120);M(it)}else oe(!1),M(0)},[F,C,T]),Ue=A.useCallback(()=>{F&&(se>=L&&!C?(x(!0),M(50),setTimeout(()=>{window.location.reload()},300)):M(0),oe(!1))},[F,se,C]);if(A.useEffect(()=>{u(!1)},[m.pathname]),A.useEffect(()=>{const de=Le=>{u(Le.detail.isOpen)};return window.addEventListener("mobileFormStateChange",de),()=>window.removeEventListener("mobileFormStateChange",de)},[]),A.useEffect(()=>{const de=()=>{P(Le=>Math.max(0,Le-1))};return window.addEventListener("quoteInquiryRead",de),()=>window.removeEventListener("quoteInquiryRead",de)},[]),A.useEffect(()=>{const de=()=>{V(Le=>Math.max(0,Le-1))};return window.addEventListener("paymentCompleted",de),()=>window.removeEventListener("paymentCompleted",de)},[]),A.useEffect(()=>{const de=Rl.getSocket();if(!de||!s)return;const Le=async()=>{try{const[ze,bt]=await Promise.all([ln.getAllPayments(),$i.getAllProjects()]);let it=ze;if(s.name===""){const St=bt.map(nt=>nt.name);it=ze.filter(nt=>St.includes(nt.project))}V(it.filter(St=>St.status==="pending").length)}catch(ze){console.error("Failed to refresh payment count:",ze)}};return de.on("payment:refresh",Le),()=>{de.off("payment:refresh",Le)}},[s]),A.useEffect(()=>{if(!s)return;const de=async()=>{try{const[ze,bt,it,St]=await Promise.all([SC.getAllWorkRequests(),ln.getAllPayments(),Oo.getAllASRequests(),$i.getAllProjects()]);h(ze.filter(ut=>ut.assignedTo===s.name&&ut.status==="pending").length);let nt=bt;if(s.name===""){const ut=St.map(ms=>ms.name);nt=bt.filter(ms=>ut.includes(ms.project))}if(V(nt.filter(ut=>ut.status==="pending").length),w(it.filter(ut=>ut.status==="in-progress").length),s.role==="admin"||s.role==="manager")try{const ms=(await pl.getAllQuoteInquiries()).filter(K=>!K.isRead).length;P(ms)}catch(ut){console.error("Failed to load quote inquiry count:",ut)}}catch(ze){console.error("Failed to load badge counts:",ze)}};de();const Le=setInterval(de,3e4);return()=>clearInterval(Le)},[s]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!s){const de=window.location.pathname+window.location.search;return de&&de!=="/login"&&de!=="/"&&sessionStorage.setItem("redirectAfterLogin",de),a.jsxDEV(Kp,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const pe=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...b>0&&{badge:b}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],je=pe.filter(de=>!de.roles||de.roles.includes((s==null?void 0:s.role)||"")),ft=((ae=pe.find(de=>de.href===m.pathname))==null?void 0:ae.name)||"",Ht=(()=>{const de=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(de)?()=>{const ze=new CustomEvent("headerAddButtonClick");window.dispatchEvent(ze)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Dn("fixed inset-0 z-40 lg:hidden",n?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>Dn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>Dn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Le?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ft&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ft},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ht&&a.jsxDEV("button",{onClick:Ht,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(vs,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(Wi,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:s==null?void 0:s.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:s==null?void 0:s.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(He=s==null?void 0:s.name)==null?void 0:He.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:je.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Le})=>Dn("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Le?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:_e,onTouchEnd:Ue,children:[se>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:se,transition:F?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Dn("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",C&&"animate-spin"),style:{transform:`rotate(${C?0:se*2}deg)`,opacity:Math.min(se/L,1)},children:a.jsxDEV(VN,{className:Dn("w-5 h-5",se>=L?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:se>0?`translateY(${se}px)`:"none",transition:F?"none":"transform 0.2s ease-out"},children:a.jsxDEV(NN,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(wC,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},UC=s=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,n=s==="emergency"?5:3;let r=0;const i=()=>{if(r>=n)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=s==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<n&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},HC=s=>{if("vibrate"in navigator){const e=s==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},MC=(s,e)=>{UC(s),HC(s),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},OC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Vi="schedules",Co=s=>{const e=s.data();return{_id:s.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof xe?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof xe?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof xe?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},wi={getAllSchedules:async()=>{const s=xt(qe(re,Vi),ls("startDate","desc"));return(await wt(s)).docs.map(Co)},getScheduleById:async s=>{const e=Se(re,Vi,s),t=await It(e);return t.exists()?Co(t):null},createSchedule:async s=>{const e=xe.now(),t={project:typeof s.project=="string"?{_id:s.project,name:s.project}:s.project,title:s.title,type:s.type||"other",phase:s.phase||"",startDate:s.startDate instanceof Date?xe.fromDate(s.startDate):s.startDate,endDate:s.endDate instanceof Date?xe.fromDate(s.endDate):s.endDate,allDay:s.allDay??!0,assignedTo:s.assignedTo||[],description:s.description||"",location:s.location||"",priority:s.priority||"medium",progress:s.progress??0,isCompleted:s.isCompleted??!1,time:s.time||"",asRequestId:s.asRequestId||null,createdAt:e,updatedAt:e},n=await Wn(qe(re,Vi),t),r=await It(n);return Co(r)},updateSchedule:async(s,e)=>{const t=Se(re,Vi,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(n.title=e.title),e.type!==void 0&&(n.type=e.type),e.phase!==void 0&&(n.phase=e.phase),e.startDate!==void 0&&(n.startDate=e.startDate instanceof Date?xe.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(n.endDate=e.endDate instanceof Date?xe.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(n.allDay=e.allDay),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.description!==void 0&&(n.description=e.description),e.location!==void 0&&(n.location=e.location),e.priority!==void 0&&(n.priority=e.priority),e.progress!==void 0&&(n.progress=e.progress),e.isCompleted!==void 0&&(n.isCompleted=e.isCompleted,e.isCompleted&&(n.completedAt=xe.now())),e.time!==void 0&&(n.time=e.time),await Bt(t,n);const r=await It(t);return Co(r)},deleteSchedule:async s=>{const e=Se(re,Vi,s);await Us(e)},subscribeToSchedules:s=>{const e=xt(qe(re,Vi),ls("startDate","desc"));return dn(e,t=>{const n=t.docs.map(Co);s(n)})}},za={getAllSchedules:()=>wi.getAllSchedules(),getScheduleById:async s=>{const e=await wi.getScheduleById(s);if(!e)throw new Error("Schedule not found");return e},createSchedule:s=>wi.createSchedule(s),updateSchedule:(s,e)=>wi.updateSchedule(s,e),deleteSchedule:s=>wi.deleteSchedule(s),subscribeToSchedules:wi.subscribeToSchedules},Si="contractors",Vo=s=>{const e=s.data();return{_id:s.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ti={getAllContractors:async()=>{const s=xt(qe(re,Si),ls("name","asc"));return(await wt(s)).docs.map(Vo)},getContractorById:async s=>{const e=Se(re,Si,s),t=await It(e);return t.exists()?Vo(t):null},createContractor:async s=>{const e=xe.now(),t={rank:s.rank||"",companyName:s.companyName||"",name:s.name,position:s.position||"",process:s.process,contact:s.contact||"",accountNumber:s.accountNumber,notes:s.notes||"",createdAt:e,updatedAt:e},n=await Wn(qe(re,Si),t),r=await It(n);return Vo(r)},updateContractor:async(s,e)=>{const t=Se(re,Si,s),n={updatedAt:xe.now()};e.rank!==void 0&&(n.rank=e.rank),e.companyName!==void 0&&(n.companyName=e.companyName),e.name!==void 0&&(n.name=e.name),e.position!==void 0&&(n.position=e.position),e.process!==void 0&&(n.process=e.process),e.contact!==void 0&&(n.contact=e.contact),e.accountNumber!==void 0&&(n.accountNumber=e.accountNumber),e.notes!==void 0&&(n.notes=e.notes),await Bt(t,n);const r=await It(t);return Vo(r)},deleteContractor:async s=>{const e=Se(re,Si,s);await Us(e)},subscribeToContractors:s=>{const e=xt(qe(re,Si),ls("name","asc"));return dn(e,t=>{const n=t.docs.map(Vo);s(n)})}},Zn={getAllContractors:()=>Ti.getAllContractors(),getContractorById:async s=>{const e=await Ti.getContractorById(s);if(!e)throw new Error("Contractor not found");return e},createContractor:s=>Ti.createContractor(s),updateContractor:(s,e)=>Ti.updateContractor(s,e),deleteContractor:s=>Ti.deleteContractor(s),subscribeToContractors:Ti.subscribeToContractors},Li="construction_payments",wo=s=>{const e=s.data();let t=e.payments||[];if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}Array.isArray(t)||(t=[]);const n=t.map(i=>{let o=i.types||[];if(typeof o=="string")try{o=JSON.parse(o)}catch{o=[o]}return Array.isArray(o)||(o=[]),{types:o,type:o[0]||i.type||"",amount:i.amount||0,date:i.date instanceof xe?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof xe?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof xe?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof xe?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof xe?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:s.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:n,expectedPaymentDates:r,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Pi={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const s=await wt(qe(re,Li));console.log("[ConstructionPayment] Firestore :",s.size," ");const e=s.docs.map(wo).filter(t=>t.project&&t.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(s){return console.error("[ConstructionPayment] Firestore  :",s),[]}},getConstructionPaymentById:async s=>{const e=Se(re,Li,s),t=await It(e);return t.exists()?wo(t):null},createConstructionPayment:async s=>{const e=xe.now(),t=(s.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?xe.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),n={};s.expectedPaymentDates&&(s.expectedPaymentDates.contract&&(n.contract=s.expectedPaymentDates.contract instanceof Date?xe.fromDate(s.expectedPaymentDates.contract):s.expectedPaymentDates.contract),s.expectedPaymentDates.start&&(n.start=s.expectedPaymentDates.start instanceof Date?xe.fromDate(s.expectedPaymentDates.start):s.expectedPaymentDates.start),s.expectedPaymentDates.middle&&(n.middle=s.expectedPaymentDates.middle instanceof Date?xe.fromDate(s.expectedPaymentDates.middle):s.expectedPaymentDates.middle),s.expectedPaymentDates.final&&(n.final=s.expectedPaymentDates.final instanceof Date?xe.fromDate(s.expectedPaymentDates.final):s.expectedPaymentDates.final));const r={project:s.project,client:s.client,totalAmount:s.totalAmount,vatType:s.vatType,vatPercentage:s.vatPercentage,vatAmount:s.vatAmount,payments:t,expectedPaymentDates:n,createdAt:e,updatedAt:e},i=await Wn(qe(re,Li),r),o=await It(i);return wo(o)},updateConstructionPayment:async(s,e)=>{const t=Se(re,Li,s),n={updatedAt:xe.now()};if(e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.totalAmount!==void 0&&(n.totalAmount=e.totalAmount),e.vatType!==void 0&&(n.vatType=e.vatType),e.vatPercentage!==void 0&&(n.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(n.vatAmount=e.vatAmount),e.payments!==void 0&&(n.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?xe.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?xe.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?xe.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?xe.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?xe.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),n.expectedPaymentDates=i}await Bt(t,n);const r=await It(t);return wo(r)},deleteConstructionPayment:async s=>{const e=Se(re,Li,s);await Us(e)},subscribeToConstructionPayments:s=>{const e=xt(qe(re,Li),ls("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(wo);s(n)})}},Ka={getAllConstructionPayments:()=>Pi.getAllConstructionPayments(),getConstructionPaymentById:async s=>{const e=await Pi.getConstructionPaymentById(s);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:s=>Pi.createConstructionPayment(s),updateConstructionPayment:(s,e)=>Pi.updateConstructionPayment(s,e),deleteConstructionPayment:s=>Pi.deleteConstructionPayment(s),subscribeToConstructionPayments:Pi.subscribeToConstructionPayments};let hl=new Map,So=null;async function FC(){if(!(hl.size>0))return So||(So=(async()=>{try{const s=qe(re,Rt.PROJECTS);(await wt(s)).docs.forEach(t=>{const n=t.data(),r=parseInt(t.id);!isNaN(r)&&n.name&&hl.set(n.name,r)}),console.log("[executionRecordFirestoreService]    :",hl.size,"")}catch(s){throw console.error("[executionRecordFirestoreService]    :",s),So=null,s}})(),So)}function Ii(s){return{id:s.id,project_id:s.projectId,project_name:s.projectName||"",author:s.author||"",date:s.date||"",process:s.process||"",item_name:s.itemName||"",material_cost:s.materialCost||0,labor_cost:s.laborCost||0,vat_amount:s.vatAmount||0,total_amount:s.totalAmount||0,notes:s.notes||"",images:s.images||[],payment_id:s.paymentId,includes_tax_deduction:s.includesTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,created_at:s.createdAt||"",updated_at:s.updatedAt||""}}function pp(s){const e={};return s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.project_name!==void 0&&(e.projectName=s.project_name),s.projectName!==void 0&&(e.projectName=s.projectName),s.author!==void 0&&(e.author=s.author),s.date!==void 0&&(e.date=s.date),s.process!==void 0&&(e.process=s.process),s.item_name!==void 0&&(e.itemName=s.item_name),s.itemName!==void 0&&(e.itemName=s.itemName),s.material_cost!==void 0&&(e.materialCost=s.material_cost),s.materialCost!==void 0&&(e.materialCost=s.materialCost),s.labor_cost!==void 0&&(e.laborCost=s.labor_cost),s.laborCost!==void 0&&(e.laborCost=s.laborCost),s.vat_amount!==void 0&&(e.vatAmount=s.vat_amount),s.vatAmount!==void 0&&(e.vatAmount=s.vatAmount),s.total_amount!==void 0&&(e.totalAmount=s.total_amount),s.totalAmount!==void 0&&(e.totalAmount=s.totalAmount),s.notes!==void 0&&(e.notes=s.notes),s.images!==void 0&&(e.images=s.images),s.payment_id!==void 0&&(e.paymentId=s.payment_id),s.paymentId!==void 0&&(e.paymentId=s.paymentId),s.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=s.includes_tax_deduction===!0||s.includes_tax_deduction===1),s.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=s.includesTaxDeduction),s.includes_vat!==void 0&&(e.includesVAT=s.includes_vat===!0||s.includes_vat===1),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),e}const Jn={getAllRecords:async()=>{const s=qe(re,Rt.EXECUTION_RECORDS),e=xt(s,ls("id","desc"));return(await wt(e)).docs.map(n=>{const r=n.data();return Ii({...r,id:parseInt(n.id)||r.id})})},getRecordById:async s=>{const e=Se(re,Rt.EXECUTION_RECORDS,s),t=await It(e);if(t.exists()){const n=t.data();return Ii({...n,id:parseInt(t.id)||n.id})}return null},createRecord:async s=>{await FC();const e=qe(re,Rt.EXECUTION_RECORDS),t=await wt(e);let n=0;t.docs.forEach(f=>{const h=parseInt(f.id);!isNaN(h)&&h>n&&(n=h)});const r=n+1,i=pp(s),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const f=hl.get(u);f?(l=f,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:[],imageCount:0},d=Se(re,Rt.EXECUTION_RECORDS,String(r));if(await li(d,m),i.images&&i.images.length>0)if(i.images.some(h=>to(h))){const h=await jl("execution_records",String(r),i.images);await Bt(d,{images:h,imageCount:h.length}),m.images=h,m.imageCount=h.length}else await Bt(d,{images:i.images,imageCount:i.images.length}),m.images=i.images,m.imageCount=i.images.length;return Ii(m)},updateRecord:async(s,e)=>{const t=Se(re,Rt.EXECUTION_RECORDS,s),n=pp(e);n.images!==void 0&&(n.images.some(o=>to(o))&&(n.images=await jl("execution_records",s,n.images)),n.imageCount=n.images.length),await Bt(t,{...n,updatedAt:new Date().toISOString()});const r=await Jn.getRecordById(s);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async s=>{const e=Se(re,Rt.EXECUTION_RECORDS,s),t=await It(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Xy(n.images)}await Us(e)},subscribeToRecords:s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,ls("id","desc"));return dn(t,n=>{const r=n.docs.map(i=>{const o=i.data();return Ii({...o,id:parseInt(i.id)||o.id})});s(r)})},getRecordsByProject:async s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,js("projectId","==",s),ls("id","desc"));return(await wt(t)).docs.map(r=>{const i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async s=>{const e=qe(re,Rt.EXECUTION_RECORDS),t=xt(e,js("paymentId","==",s)),n=await wt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})}},Qa={getAllRecords:()=>Jn.getAllRecords(),getRecordById:async s=>{const e=await Jn.getRecordById(s);if(!e)throw new Error("Execution record not found");return e},createRecord:s=>Jn.createRecord(s),updateRecord:(s,e)=>Jn.updateRecord(s,e),deleteRecord:s=>Jn.deleteRecord(s),subscribeToRecords:Jn.subscribeToRecords,getRecordsByProject:Jn.getRecordsByProject,getRecordByPaymentId:Jn.getRecordByPaymentId},tr=Wu()(Ky((s,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>s({projects:t}),addProject:t=>s(n=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...n.projects],constructionPayments:[r,...n.constructionPayments]}}),updateProject:(t,n)=>s(r=>({projects:r.projects.map(i=>i.id===t?{...i,...n}:i)})),deleteProject:t=>s(n=>({projects:n.projects.filter(r=>r.id!==t),constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>s({schedules:t}),addSchedule:t=>s(n=>({schedules:[t,...n.schedules]})),updateSchedule:(t,n)=>s(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...n}:i)})),deleteSchedule:t=>s(n=>({schedules:n.schedules.filter(r=>r.id!==t)})),setPayments:t=>s({payments:t}),addPayment:t=>s(n=>({payments:[t,...n.payments]})),updatePayment:(t,n)=>s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)})),deletePayment:t=>s(n=>({payments:n.payments.filter(r=>r.id!==t)})),setContractors:t=>s({contractors:t}),addContractor:t=>s(n=>({contractors:[t,...n.contractors]})),updateContractor:(t,n)=>s(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...n}:i)})),deleteContractor:t=>s(n=>({contractors:n.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>s({constructionPayments:t}),addConstructionPayment:t=>s(n=>({constructionPayments:[t,...n.constructionPayments]})),updateConstructionPayment:(t,n)=>s(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...n}:i)})),deleteConstructionPayment:t=>s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>s({asRequests:t}),addASRequest:t=>s(n=>({asRequests:[t,...n.asRequests]})),updateASRequest:(t,n)=>s(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...n}:i)})),deleteASRequest:t=>s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>s({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),s(n=>{const r=[t,...n.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,n)=>s(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...n}:i)})),deleteExecutionRecord:t=>s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await ln.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const n=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));n.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(n.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",n.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(V=>V.id)),f=n.filter(V=>!d.has(V.id)),b=[...m.map(V=>({...V,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",b.length),s({payments:b})}else console.log("[loadPaymentsFromAPI]    - API  "),s({payments:n})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const n=`temp_${Date.now()}`,r={...t,id:n,_addedAt:Date.now(),_tempId:n};s(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",n);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await ln.createPayment(u),d=String(m.id);return s(f=>({payments:f.payments.map(h=>h._tempId===n?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),s(o=>({payments:o.payments.filter(l=>l._tempId!==n)})),i}},updatePaymentInAPI:async(t,n)=>{try{if(n.status&&Object.keys(n).length===1)await ln.updatePaymentStatus(t,n.status);else{let r=n.project;if(n.project){const o=e().projects.find(l=>l.name===n.project);r=o?o.id:n.project}await ln.updatePayment(t,{projectId:r,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,materialAmount:n.materialAmount,laborAmount:n.laborAmount,originalMaterialAmount:n.originalMaterialAmount,originalLaborAmount:n.originalLaborAmount,category:n.category,urgency:n.urgency,bankInfo:n.bankInfo,notes:n.notes,requestDate:n.requestDate,includesVAT:n.includesVAT,applyTaxDeduction:n.applyTaxDeduction})}s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await ln.deletePayment(t),s(n=>({payments:n.payments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete payment from API:",n),n}},loadSchedulesFromAPI:async()=>{try{const t=await za.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const n=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});n.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),s({schedules:n})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const n=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:n};s(l=>({schedules:[...l.schedules,r]}));try{const l=await za.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};s(f=>({schedules:f.schedules.map(h=>h.id===n?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),s(u=>({schedules:u.schedules.filter(m=>m.id!==n)})),l}},updateScheduleInAPI:async(t,n)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:n});const l={};n.project!==void 0&&(l.project=n.project),n.title!==void 0&&(l.title=n.title),n.type!==void 0&&(l.type=n.type),n.start!==void 0&&(l.startDate=n.start),n.end!==void 0&&(l.endDate=n.end),n.location!==void 0&&(l.location=n.location),n.description!==void 0&&(l.description=n.description),n.attendees!==void 0&&(l.assignedTo=n.attendees),n.time!==void 0&&(l.time=n.time),console.log(" Sending update data:",l);const u=await za.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};s(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:n}=e(),r=n.find(o=>o.id===t);if(r){s(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await za.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&s(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const n=(await $i.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});s({projects:n})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var n,r;try{const i=await $i.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((n=i.meetingNotes)==null?void 0:n.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};s(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,n)=>{var r,i;try{const o=await $i.updateProject(t,n),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:typeof o.manager=="object"&&o.manager!==null?o.manager.name||"":o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};s(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await $i.deleteProject(t),s(n=>({projects:n.projects.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete project from API:",n),n}},loadContractorsFromAPI:async()=>{try{const n=(await Zn.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));s({contractors:n})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const n=await Zn.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:n._id,rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)};s(i=>({contractors:[r,...i.contractors]}))}catch(n){throw console.error("Failed to add contractor to API:",n),n}},updateContractorInAPI:async(t,n)=>{try{const r=await Zn.updateContractor(t,{rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};s(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await Zn.deleteContractor(t),s(n=>({contractors:n.contractors.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete contractor from API:",n),n}},loadConstructionPaymentsFromAPI:async()=>{try{const n=(await Ka.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});s({constructionPayments:n})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var n;try{const r=await Ka.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((n=r.payments)==null?void 0:n.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};s(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,n)=>{var r;try{const i=await Ka.updateConstructionPayment(t,n);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};s(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await Ka.deleteConstructionPayment(t),s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete construction payment from API:",n),n}},loadASRequestsFromAPI:async()=>{try{const n=(await Oo.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));s({asRequests:n})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const n=await Oo.createASRequest(t),r={id:n._id,project:n.project,client:n.client,requestDate:new Date(n.requestDate),siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,scheduledVisitDate:n.scheduledVisitDate?new Date(n.scheduledVisitDate):void 0,scheduledVisitTime:n.scheduledVisitTime,assignedTo:Array.isArray(n.assignedTo)?n.assignedTo:[],completionDate:n.completionDate?new Date(n.completionDate):void 0,notes:n.notes};return s(i=>({asRequests:[r,...i.asRequests]})),r}catch(n){throw console.error("Failed to add AS request to API:",n),n}},updateASRequestInAPI:async(t,n)=>{try{const r=await Oo.updateASRequest(t,n),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};s(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Oo.deleteASRequest(t),s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete AS request from API:",n),n}},loadExecutionRecordsFromAPI:async()=>{try{const t=await Qa.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const n=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));s({executionRecords:n})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const n=await Qa.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(n.id),project:n.project_name,author:n.author||void 0,date:new Date(n.date),process:n.process||void 0,itemName:n.item_name,materialCost:n.material_cost||0,laborCost:n.labor_cost||0,vatAmount:n.vat_amount||0,totalAmount:n.total_amount||0,notes:n.notes||void 0,paymentId:n.payment_id?String(n.payment_id):void 0,includesTaxDeduction:n.includes_tax_deduction===1,includesVat:n.includes_vat===1,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",n.includes_vat),s(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(n){throw console.error("Failed to add execution record to API:",n),n}},updateExecutionRecordInAPI:async(t,n)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",n);try{let r;if(n.date){const i=n.date instanceof Date?n.date:new Date(n.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:n.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat),await Qa.updateRecord(t,{project_name:n.project,author:n.author,date:r,process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,images:n.images,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),s(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...n,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await Qa.deleteRecord(t),s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete execution record from API:",n),n}}}),{name:"interior-management-storage",partialize:s=>({...s,payments:s.payments.map(e=>{const{images:t,...n}=e;return n}),executionRecords:s.executionRecords.map(e=>{const{images:t,...n}=e;return n})}),storage:{getItem:s=>{var u,m,d,f,h,b,V;const e=localStorage.getItem(s);if(!e)return null;const{state:t}=JSON.parse(e),n=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var w;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((w=v.payments)==null?void 0:w.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=n.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:n,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((b=t.asRequests)==null?void 0:b.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((V=t.executionRecords)==null?void 0:V.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(s,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(s,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:s=>localStorage.removeItem(s)}}));var Aa=s=>s.type==="checkbox",ei=s=>s instanceof Date,Js=s=>s==null;const Jy=s=>typeof s=="object";var As=s=>!Js(s)&&!Array.isArray(s)&&Jy(s)&&!ei(s),qC=s=>As(s)&&s.target?Aa(s.target)?s.target.checked:s.target.value:s,$C=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,WC=(s,e)=>s.has($C(e)),zC=s=>{const e=s.constructor&&s.constructor.prototype;return As(e)&&e.hasOwnProperty("isPrototypeOf")},Zm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ps(s){let e;const t=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)e=new Date(s);else if(!(Zm&&(s instanceof Blob||n))&&(t||As(s)))if(e=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!zC(s))e=s;else for(const r in s)s.hasOwnProperty(r)&&(e[r]=Ps(s[r]));else return s;return e}var mc=s=>/^\w*$/.test(s),Ns=s=>s===void 0,ed=s=>Array.isArray(s)?s.filter(Boolean):[],td=s=>ed(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Ie=(s,e,t)=>{if(!e||!As(s))return t;const n=(mc(e)?[e]:td(e)).reduce((r,i)=>Js(r)?r:r[i],s);return Ns(n)||n===s?Ns(s[e])?t:s[e]:n},Un=s=>typeof s=="boolean",ts=(s,e,t)=>{let n=-1;const r=mc(e)?[e]:td(e),i=r.length,o=i-1;for(;++n<i;){const l=r[n];let u=t;if(n!==o){const m=s[l];u=As(m)||Array.isArray(m)?m:isNaN(+r[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;s[l]=u,s=s[l]}};const hp={BLUR:"blur",FOCUS_OUT:"focusout"},An={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Gn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},KC=lt.createContext(null);KC.displayName="HookFormContext";var QC=(s,e,t,n=!0)=>{const r={defaultValues:e._defaultValues};for(const i in s)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==An.all&&(e._proxyFormState[o]=!n||An.all),s[o]}});return r};const YC=typeof window<"u"?lt.useLayoutEffect:lt.useEffect;var cn=s=>typeof s=="string",GC=(s,e,t,n,r)=>cn(s)?(n&&e.watch.add(s),Ie(t,s,r)):Array.isArray(s)?s.map(i=>(n&&e.watch.add(i),Ie(t,i))):(n&&(e.watchAll=!0),t),Uu=s=>Js(s)||!Jy(s);function vr(s,e,t=new WeakSet){if(Uu(s)||Uu(e))return s===e;if(ei(s)&&ei(e))return s.getTime()===e.getTime();const n=Object.keys(s),r=Object.keys(e);if(n.length!==r.length)return!1;if(t.has(s)||t.has(e))return!0;t.add(s),t.add(e);for(const i of n){const o=s[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ei(o)&&ei(l)||As(o)&&As(l)||Array.isArray(o)&&Array.isArray(l)?!vr(o,l,t):o!==l)return!1}}return!0}var XC=(s,e,t,n,r)=>e?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[n]:r||!0}}:{},Yo=s=>Array.isArray(s)?s:[s],gp=()=>{let s=[];return{get observers(){return s},next:r=>{for(const i of s)i.next&&i.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(i=>i!==r)}}),unsubscribe:()=>{s=[]}}};function Zy(s,e){const t={};for(const n in s)if(s.hasOwnProperty(n)){const r=s[n],i=e[n];if(r&&As(r)&&i){const o=Zy(r,i);As(o)&&(t[n]=o)}else s[n]&&(t[n]=i)}return t}var sn=s=>As(s)&&!Object.keys(s).length,sd=s=>s.type==="file",En=s=>typeof s=="function",Bl=s=>{if(!Zm)return!1;const e=s?s.ownerDocument:0;return s instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},eb=s=>s.type==="select-multiple",nd=s=>s.type==="radio",JC=s=>nd(s)||Aa(s),Gc=s=>Bl(s)&&s.isConnected;function ZC(s,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)s=Ns(s)?n++:s[e[n++]];return s}function e1(s){for(const e in s)if(s.hasOwnProperty(e)&&!Ns(s[e]))return!1;return!0}function ys(s,e){const t=Array.isArray(e)?e:mc(e)?[e]:td(e),n=t.length===1?s:ZC(s,t),r=t.length-1,i=t[r];return n&&delete n[i],r!==0&&(As(n)&&sn(n)||Array.isArray(n)&&e1(n))&&ys(s,t.slice(0,-1)),s}var t1=s=>{for(const e in s)if(En(s[e]))return!0;return!1};function tb(s){return Array.isArray(s)||As(s)&&!t1(s)}function Hu(s,e={}){for(const t in s)tb(s[t])?(e[t]=Array.isArray(s[t])?[]:{},Hu(s[t],e[t])):Js(s[t])||(e[t]=!0);return e}function qi(s,e,t){t||(t=Hu(e));for(const n in s)tb(s[n])?Ns(e)||Uu(t[n])?t[n]=Hu(s[n],Array.isArray(s[n])?[]:{}):qi(s[n],Js(e)?{}:e[n],t[n]):t[n]=!vr(s[n],e[n]);return t}const yp={value:!1,isValid:!1},bp={value:!0,isValid:!0};var sb=s=>{if(Array.isArray(s)){if(s.length>1){const e=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Ns(s[0].attributes.value)?Ns(s[0].value)||s[0].value===""?bp:{value:s[0].value,isValid:!0}:bp:yp}return yp},nb=(s,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>Ns(s)?s:e?s===""?NaN:s&&+s:t&&cn(s)?new Date(s):n?n(s):s;const Np={isValid:!1,value:null};var rb=s=>Array.isArray(s)?s.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Np):Np;function xp(s){const e=s.ref;return sd(e)?e.files:nd(e)?rb(s.refs).value:eb(e)?[...e.selectedOptions].map(({value:t})=>t):Aa(e)?sb(s.refs).value:nb(Ns(e.value)?s.ref.value:e.value,s)}var s1=(s,e,t,n)=>{const r={};for(const i of s){const o=Ie(e,i);o&&ts(r,i,o._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:n}},Ul=s=>s instanceof RegExp,To=s=>Ns(s)?s:Ul(s)?s.source:As(s)?Ul(s.value)?s.value.source:s.value:s,vp=s=>({isOnSubmit:!s||s===An.onSubmit,isOnBlur:s===An.onBlur,isOnChange:s===An.onChange,isOnAll:s===An.all,isOnTouch:s===An.onTouched});const _p="AsyncFunction";var n1=s=>!!s&&!!s.validate&&!!(En(s.validate)&&s.validate.constructor.name===_p||As(s.validate)&&Object.values(s.validate).find(e=>e.constructor.name===_p)),r1=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),Dp=(s,e,t)=>!t&&(e.watchAll||e.watch.has(s)||[...e.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const Go=(s,e,t,n)=>{for(const r of t||Object.keys(s)){const i=Ie(s,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!n)return!0;if(o.ref&&e(o.ref,o.name)&&!n)return!0;if(Go(l,e))break}else if(As(l)&&Go(l,e))break}}};function kp(s,e,t){const n=Ie(s,t);if(n||mc(t))return{error:n,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Ie(e,i),l=Ie(s,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var i1=(s,e,t,n)=>{t(s);const{name:r,...i}=s;return sn(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!n||An.all))},o1=(s,e,t)=>!s||!e||s===e||Yo(s).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),a1=(s,e,t,n,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||s):(t?n.isOnBlur:r.isOnBlur)?!s:(t?n.isOnChange:r.isOnChange)?s:!0,l1=(s,e)=>!ed(Ie(s,e)).length&&ys(s,e),c1=(s,e,t)=>{const n=Yo(Ie(s,t));return ts(n,"root",e[t]),ts(s,t,n),s};function Ap(s,e,t="validate"){if(cn(s)||Array.isArray(s)&&s.every(cn)||Un(s)&&!s)return{type:t,message:cn(s)?s:"",ref:e}}var ji=s=>As(s)&&!Ul(s)?s:{value:s,message:""},Ep=async(s,e,t,n,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:b,validate:V,name:v,valueAsNumber:w,mount:B}=s._f,P=Ie(t,v);if(!B||e.has(v))return{};const F=l?l[0]:o,oe=T=>{r&&F.reportValidity&&(F.setCustomValidity(Un(T)?"":T||""),F.reportValidity())},se={},M=nd(o),C=Aa(o),x=M||C,E=(w||sd(o))&&Ns(o.value)&&Ns(P)||Bl(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,j=XC.bind(null,v,n,se),L=(T,k,_e,Ue=Gn.maxLength,pe=Gn.minLength)=>{const je=T?k:_e;se[v]={type:T?Ue:pe,message:je,ref:o,...j(T?Ue:pe,je)}};if(i?!Array.isArray(P)||!P.length:u&&(!x&&(E||Js(P))||Un(P)&&!P||C&&!sb(l).isValid||M&&!rb(l).isValid)){const{value:T,message:k}=cn(u)?{value:!!u,message:u}:ji(u);if(T&&(se[v]={type:Gn.required,message:k,ref:F,...j(Gn.required,k)},!n))return oe(k),se}if(!E&&(!Js(f)||!Js(h))){let T,k;const _e=ji(h),Ue=ji(f);if(!Js(P)&&!isNaN(P)){const pe=o.valueAsNumber||P&&+P;Js(_e.value)||(T=pe>_e.value),Js(Ue.value)||(k=pe<Ue.value)}else{const pe=o.valueAsDate||new Date(P),je=Ht=>new Date(new Date().toDateString()+" "+Ht),ft=o.type=="time",qt=o.type=="week";cn(_e.value)&&P&&(T=ft?je(P)>je(_e.value):qt?P>_e.value:pe>new Date(_e.value)),cn(Ue.value)&&P&&(k=ft?je(P)<je(Ue.value):qt?P<Ue.value:pe<new Date(Ue.value))}if((T||k)&&(L(!!T,_e.message,Ue.message,Gn.max,Gn.min),!n))return oe(se[v].message),se}if((m||d)&&!E&&(cn(P)||i&&Array.isArray(P))){const T=ji(m),k=ji(d),_e=!Js(T.value)&&P.length>+T.value,Ue=!Js(k.value)&&P.length<+k.value;if((_e||Ue)&&(L(_e,T.message,k.message),!n))return oe(se[v].message),se}if(b&&!E&&cn(P)){const{value:T,message:k}=ji(b);if(Ul(T)&&!P.match(T)&&(se[v]={type:Gn.pattern,message:k,ref:o,...j(Gn.pattern,k)},!n))return oe(k),se}if(V){if(En(V)){const T=await V(P,t),k=Ap(T,F);if(k&&(se[v]={...k,...j(Gn.validate,k.message)},!n))return oe(k.message),se}else if(As(V)){let T={};for(const k in V){if(!sn(T)&&!n)break;const _e=Ap(await V[k](P,t),F,k);_e&&(T={..._e,...j(k,_e.message)},oe(_e.message),n&&(se[v]=T))}if(!sn(T)&&(se[v]={ref:F,...T},!n))return se}}return oe(!0),se};const u1={mode:An.onSubmit,reValidateMode:An.onChange,shouldFocusError:!0};function m1(s={}){let e={...u1,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:En(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},r=As(e.defaultValues)||As(e.values)?Ps(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Ps(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:gp(),state:gp()},b=e.criteriaMode===An.all,V=I=>O=>{clearTimeout(m),m=setTimeout(I,O)},v=async I=>{if(!e.disabled&&(d.isValid||f.isValid||I)){const O=e.resolver?sn((await C()).errors):await E(n,!0);O!==t.isValid&&h.state.next({isValid:O})}},w=(I,O)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((I||Array.from(l.mount)).forEach(Z=>{Z&&(O?ts(t.validatingFields,Z,O):ys(t.validatingFields,Z))}),h.state.next({validatingFields:t.validatingFields,isValidating:!sn(t.validatingFields)}))},B=(I,O=[],Z,ye,ue=!0,fe=!0)=>{if(ye&&Z&&!e.disabled){if(o.action=!0,fe&&Array.isArray(Ie(n,I))){const Ce=Z(Ie(n,I),ye.argA,ye.argB);ue&&ts(n,I,Ce)}if(fe&&Array.isArray(Ie(t.errors,I))){const Ce=Z(Ie(t.errors,I),ye.argA,ye.argB);ue&&ts(t.errors,I,Ce),l1(t.errors,I)}if((d.touchedFields||f.touchedFields)&&fe&&Array.isArray(Ie(t.touchedFields,I))){const Ce=Z(Ie(t.touchedFields,I),ye.argA,ye.argB);ue&&ts(t.touchedFields,I,Ce)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=qi(r,i)),h.state.next({name:I,isDirty:L(I,O),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ts(i,I,O)},P=(I,O)=>{ts(t.errors,I,O),h.state.next({errors:t.errors})},F=I=>{t.errors=I,h.state.next({errors:t.errors,isValid:!1})},oe=(I,O,Z,ye)=>{const ue=Ie(n,I);if(ue){const fe=Ie(i,I,Ns(Z)?Ie(r,I):Z);Ns(fe)||ye&&ye.defaultChecked||O?ts(i,I,O?fe:xp(ue._f)):_e(I,fe),o.mount&&v()}},se=(I,O,Z,ye,ue)=>{let fe=!1,Ce=!1;const Me={name:I};if(!e.disabled){if(!Z||ye){(d.isDirty||f.isDirty)&&(Ce=t.isDirty,t.isDirty=Me.isDirty=L(),fe=Ce!==Me.isDirty);const tt=vr(Ie(r,I),O);Ce=!!Ie(t.dirtyFields,I),tt?ys(t.dirtyFields,I):ts(t.dirtyFields,I,!0),Me.dirtyFields=t.dirtyFields,fe=fe||(d.dirtyFields||f.dirtyFields)&&Ce!==!tt}if(Z){const tt=Ie(t.touchedFields,I);tt||(ts(t.touchedFields,I,Z),Me.touchedFields=t.touchedFields,fe=fe||(d.touchedFields||f.touchedFields)&&tt!==Z)}fe&&ue&&h.state.next(Me)}return fe?Me:{}},M=(I,O,Z,ye)=>{const ue=Ie(t.errors,I),fe=(d.isValid||f.isValid)&&Un(O)&&t.isValid!==O;if(e.delayError&&Z?(u=V(()=>P(I,Z)),u(e.delayError)):(clearTimeout(m),u=null,Z?ts(t.errors,I,Z):ys(t.errors,I)),(Z?!vr(ue,Z):ue)||!sn(ye)||fe){const Ce={...ye,...fe&&Un(O)?{isValid:O}:{},errors:t.errors,name:I};t={...t,...Ce},h.state.next(Ce)}},C=async I=>{w(I,!0);const O=await e.resolver(i,e.context,s1(I||l.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return w(I),O},x=async I=>{const{errors:O}=await C(I);if(I)for(const Z of I){const ye=Ie(O,Z);ye?ts(t.errors,Z,ye):ys(t.errors,Z)}else t.errors=O;return O},E=async(I,O,Z={valid:!0})=>{for(const ye in I){const ue=I[ye];if(ue){const{_f:fe,...Ce}=ue;if(fe){const Me=l.array.has(fe.name),tt=ue._f&&n1(ue._f);tt&&d.validatingFields&&w([fe.name],!0);const Ae=await Ep(ue,l.disabled,i,b,e.shouldUseNativeValidation&&!O,Me);if(tt&&d.validatingFields&&w([fe.name]),Ae[fe.name]&&(Z.valid=!1,O))break;!O&&(Ie(Ae,fe.name)?Me?c1(t.errors,Ae,fe.name):ts(t.errors,fe.name,Ae[fe.name]):ys(t.errors,fe.name))}!sn(Ce)&&await E(Ce,O,Z)}}return Z.valid},j=()=>{for(const I of l.unMount){const O=Ie(n,I);O&&(O._f.refs?O._f.refs.every(Z=>!Gc(Z)):!Gc(O._f.ref))&&it(I)}l.unMount=new Set},L=(I,O)=>!e.disabled&&(I&&O&&ts(i,I,O),!vr(Ht(),r)),T=(I,O,Z)=>GC(I,l,{...o.mount?i:Ns(O)?r:cn(I)?{[I]:O}:O},Z,O),k=I=>ed(Ie(o.mount?i:r,I,e.shouldUnregister?Ie(r,I,[]):[])),_e=(I,O,Z={})=>{const ye=Ie(n,I);let ue=O;if(ye){const fe=ye._f;fe&&(!fe.disabled&&ts(i,I,nb(O,fe)),ue=Bl(fe.ref)&&Js(O)?"":O,eb(fe.ref)?[...fe.ref.options].forEach(Ce=>Ce.selected=ue.includes(Ce.value)):fe.refs?Aa(fe.ref)?fe.refs.forEach(Ce=>{(!Ce.defaultChecked||!Ce.disabled)&&(Array.isArray(ue)?Ce.checked=!!ue.find(Me=>Me===Ce.value):Ce.checked=ue===Ce.value||!!ue)}):fe.refs.forEach(Ce=>Ce.checked=Ce.value===ue):sd(fe.ref)?fe.ref.value="":(fe.ref.value=ue,fe.ref.type||h.state.next({name:I,values:Ps(i)})))}(Z.shouldDirty||Z.shouldTouch)&&se(I,ue,Z.shouldTouch,Z.shouldDirty,!0),Z.shouldValidate&&qt(I)},Ue=(I,O,Z)=>{for(const ye in O){if(!O.hasOwnProperty(ye))return;const ue=O[ye],fe=I+"."+ye,Ce=Ie(n,fe);(l.array.has(I)||As(ue)||Ce&&!Ce._f)&&!ei(ue)?Ue(fe,ue,Z):_e(fe,ue,Z)}},pe=(I,O,Z={})=>{const ye=Ie(n,I),ue=l.array.has(I),fe=Ps(O);ts(i,I,fe),ue?(h.array.next({name:I,values:Ps(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&Z.shouldDirty&&h.state.next({name:I,dirtyFields:qi(r,i),isDirty:L(I,fe)})):ye&&!ye._f&&!Js(fe)?Ue(I,fe,Z):_e(I,fe,Z),Dp(I,l)&&h.state.next({...t,name:I}),h.state.next({name:o.mount?I:void 0,values:Ps(i)})},je=async I=>{o.mount=!0;const O=I.target;let Z=O.name,ye=!0;const ue=Ie(n,Z),fe=tt=>{ye=Number.isNaN(tt)||ei(tt)&&isNaN(tt.getTime())||vr(tt,Ie(i,Z,tt))},Ce=vp(e.mode),Me=vp(e.reValidateMode);if(ue){let tt,Ae;const Rs=O.type?xp(ue._f):qC(I),jt=I.type===hp.BLUR||I.type===hp.FOCUS_OUT,ee=!r1(ue._f)&&!e.resolver&&!Ie(t.errors,Z)&&!ue._f.deps||a1(jt,Ie(t.touchedFields,Z),t.isSubmitted,Me,Ce),Ge=Dp(Z,l,jt);ts(i,Z,Rs),jt?(!O||!O.readOnly)&&(ue._f.onBlur&&ue._f.onBlur(I),u&&u(0)):ue._f.onChange&&ue._f.onChange(I);const H=se(Z,Rs,jt),be=!sn(H)||Ge;if(!jt&&h.state.next({name:Z,type:I.type,values:Ps(i)}),ee)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?jt&&v():jt||v()),be&&h.state.next({name:Z,...Ge?{}:H});if(!jt&&Ge&&h.state.next({...t}),e.resolver){const{errors:De}=await C([Z]);if(fe(Rs),ye){const Pe=kp(t.errors,n,Z),me=kp(De,n,Pe.name||Z);tt=me.error,Z=me.name,Ae=sn(De)}}else w([Z],!0),tt=(await Ep(ue,l.disabled,i,b,e.shouldUseNativeValidation))[Z],w([Z]),fe(Rs),ye&&(tt?Ae=!1:(d.isValid||f.isValid)&&(Ae=await E(n,!0)));ye&&(ue._f.deps&&(!Array.isArray(ue._f.deps)||ue._f.deps.length>0)&&qt(ue._f.deps),M(Z,Ae,tt,H))}},ft=(I,O)=>{if(Ie(t.errors,O)&&I.focus)return I.focus(),1},qt=async(I,O={})=>{let Z,ye;const ue=Yo(I);if(e.resolver){const fe=await x(Ns(I)?I:ue);Z=sn(fe),ye=I?!ue.some(Ce=>Ie(fe,Ce)):Z}else I?(ye=(await Promise.all(ue.map(async fe=>{const Ce=Ie(n,fe);return await E(Ce&&Ce._f?{[fe]:Ce}:Ce)}))).every(Boolean),!(!ye&&!t.isValid)&&v()):ye=Z=await E(n);return h.state.next({...!cn(I)||(d.isValid||f.isValid)&&Z!==t.isValid?{}:{name:I},...e.resolver||!I?{isValid:Z}:{},errors:t.errors}),O.shouldFocus&&!ye&&Go(n,ft,I?ue:l.mount),ye},Ht=(I,O)=>{let Z={...o.mount?i:r};return O&&(Z=Zy(O.dirtyFields?t.dirtyFields:t.touchedFields,Z)),Ns(I)?Z:cn(I)?Ie(Z,I):I.map(ye=>Ie(Z,ye))},ae=(I,O)=>({invalid:!!Ie((O||t).errors,I),isDirty:!!Ie((O||t).dirtyFields,I),error:Ie((O||t).errors,I),isValidating:!!Ie(t.validatingFields,I),isTouched:!!Ie((O||t).touchedFields,I)}),He=I=>{I&&Yo(I).forEach(O=>ys(t.errors,O)),h.state.next({errors:I?t.errors:{}})},de=(I,O,Z)=>{const ye=(Ie(n,I,{_f:{}})._f||{}).ref,ue=Ie(t.errors,I)||{},{ref:fe,message:Ce,type:Me,...tt}=ue;ts(t.errors,I,{...tt,...O,ref:ye}),h.state.next({name:I,errors:t.errors,isValid:!1}),Z&&Z.shouldFocus&&ye&&ye.focus&&ye.focus()},Le=(I,O)=>En(I)?h.state.subscribe({next:Z=>"values"in Z&&I(T(void 0,O),Z)}):T(I,O,!0),ze=I=>h.state.subscribe({next:O=>{o1(I.name,O.name,I.exact)&&i1(O,I.formState||d,Tt,I.reRenderRoot)&&I.callback({values:{...i},...t,...O,defaultValues:r})}}).unsubscribe,bt=I=>(o.mount=!0,f={...f,...I.formState},ze({...I,formState:f})),it=(I,O={})=>{for(const Z of I?Yo(I):l.mount)l.mount.delete(Z),l.array.delete(Z),O.keepValue||(ys(n,Z),ys(i,Z)),!O.keepError&&ys(t.errors,Z),!O.keepDirty&&ys(t.dirtyFields,Z),!O.keepTouched&&ys(t.touchedFields,Z),!O.keepIsValidating&&ys(t.validatingFields,Z),!e.shouldUnregister&&!O.keepDefaultValue&&ys(r,Z);h.state.next({values:Ps(i)}),h.state.next({...t,...O.keepDirty?{isDirty:L()}:{}}),!O.keepIsValid&&v()},St=({disabled:I,name:O})=>{(Un(I)&&o.mount||I||l.disabled.has(O))&&(I?l.disabled.add(O):l.disabled.delete(O))},nt=(I,O={})=>{let Z=Ie(n,I);const ye=Un(O.disabled)||Un(e.disabled);return ts(n,I,{...Z||{},_f:{...Z&&Z._f?Z._f:{ref:{name:I}},name:I,mount:!0,...O}}),l.mount.add(I),Z?St({disabled:Un(O.disabled)?O.disabled:e.disabled,name:I}):oe(I,!0,O.value),{...ye?{disabled:O.disabled||e.disabled}:{},...e.progressive?{required:!!O.required,min:To(O.min),max:To(O.max),minLength:To(O.minLength),maxLength:To(O.maxLength),pattern:To(O.pattern)}:{},name:I,onChange:je,onBlur:je,ref:ue=>{if(ue){nt(I,O),Z=Ie(n,I);const fe=Ns(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,Ce=JC(fe),Me=Z._f.refs||[];if(Ce?Me.find(tt=>tt===fe):fe===Z._f.ref)return;ts(n,I,{_f:{...Z._f,...Ce?{refs:[...Me.filter(Gc),fe,...Array.isArray(Ie(r,I))?[{}]:[]],ref:{type:fe.type,name:I}}:{ref:fe}}}),oe(I,!1,void 0,fe)}else Z=Ie(n,I,{}),Z._f&&(Z._f.mount=!1),(e.shouldUnregister||O.shouldUnregister)&&!(WC(l.array,I)&&o.action)&&l.unMount.add(I)}}},ut=()=>e.shouldFocusError&&Go(n,ft,l.mount),ms=I=>{Un(I)&&(h.state.next({disabled:I}),Go(n,(O,Z)=>{const ye=Ie(n,Z);ye&&(O.disabled=ye._f.disabled||I,Array.isArray(ye._f.refs)&&ye._f.refs.forEach(ue=>{ue.disabled=ye._f.disabled||I}))},0,!1))},K=(I,O)=>async Z=>{let ye;Z&&(Z.preventDefault&&Z.preventDefault(),Z.persist&&Z.persist());let ue=Ps(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:Ce}=await C();t.errors=fe,ue=Ps(Ce)}else await E(n);if(l.disabled.size)for(const fe of l.disabled)ys(ue,fe);if(ys(t.errors,"root"),sn(t.errors)){h.state.next({errors:{}});try{await I(ue,Z)}catch(fe){ye=fe}}else O&&await O({...t.errors},Z),ut(),setTimeout(ut);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:sn(t.errors)&&!ye,submitCount:t.submitCount+1,errors:t.errors}),ye)throw ye},Te=(I,O={})=>{Ie(n,I)&&(Ns(O.defaultValue)?pe(I,Ps(Ie(r,I))):(pe(I,O.defaultValue),ts(r,I,Ps(O.defaultValue))),O.keepTouched||ys(t.touchedFields,I),O.keepDirty||(ys(t.dirtyFields,I),t.isDirty=O.defaultValue?L(I,Ps(Ie(r,I))):L()),O.keepError||(ys(t.errors,I),d.isValid&&v()),h.state.next({...t}))},Re=(I,O={})=>{const Z=I?Ps(I):r,ye=Ps(Z),ue=sn(I),fe=ue?r:ye;if(O.keepDefaultValues||(r=Z),!O.keepValues){if(O.keepDirtyValues){const Ce=new Set([...l.mount,...Object.keys(qi(r,i))]);for(const Me of Array.from(Ce))Ie(t.dirtyFields,Me)?ts(fe,Me,Ie(i,Me)):pe(Me,Ie(fe,Me))}else{if(Zm&&Ns(I))for(const Ce of l.mount){const Me=Ie(n,Ce);if(Me&&Me._f){const tt=Array.isArray(Me._f.refs)?Me._f.refs[0]:Me._f.ref;if(Bl(tt)){const Ae=tt.closest("form");if(Ae){Ae.reset();break}}}}if(O.keepFieldsRef)for(const Ce of l.mount)pe(Ce,Ie(fe,Ce));else n={}}i=e.shouldUnregister?O.keepDefaultValues?Ps(r):{}:Ps(fe),h.array.next({values:{...fe}}),h.state.next({values:{...fe}})}l={mount:O.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!O.keepIsValid||!!O.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:O.keepSubmitCount?t.submitCount:0,isDirty:ue?!1:O.keepDirty?t.isDirty:!!(O.keepDefaultValues&&!vr(I,r)),isSubmitted:O.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ue?{}:O.keepDirtyValues?O.keepDefaultValues&&i?qi(r,i):t.dirtyFields:O.keepDefaultValues&&I?qi(r,I):O.keepDirty?t.dirtyFields:{},touchedFields:O.keepTouched?t.touchedFields:{},errors:O.keepErrors?t.errors:{},isSubmitSuccessful:O.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},we=(I,O)=>Re(En(I)?I(i):I,O),Ye=(I,O={})=>{const Z=Ie(n,I),ye=Z&&Z._f;if(ye){const ue=ye.refs?ye.refs[0]:ye.ref;ue.focus&&(ue.focus(),O.shouldSelect&&En(ue.select)&&ue.select())}},Tt=I=>{t={...t,...I}},ct={control:{register:nt,unregister:it,getFieldState:ae,handleSubmit:K,setError:de,_subscribe:ze,_runSchema:C,_focusError:ut,_getWatch:T,_getDirty:L,_setValid:v,_setFieldArray:B,_setDisabledField:St,_setErrors:F,_getFieldArray:k,_reset:Re,_resetDefaultValues:()=>En(e.defaultValues)&&e.defaultValues().then(I=>{we(I,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:ms,_subjects:h,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(I){o=I},get _defaultValues(){return r},get _names(){return l},set _names(I){l=I},get _formState(){return t},get _options(){return e},set _options(I){e={...e,...I}}},subscribe:bt,trigger:qt,register:nt,handleSubmit:K,watch:Le,setValue:pe,getValues:Ht,reset:we,resetField:Te,clearErrors:He,unregister:it,setError:de,setFocus:Ye,getFieldState:ae};return{...ct,formControl:ct}}function rd(s={}){const e=lt.useRef(void 0),t=lt.useRef(void 0),[n,r]=lt.useState({isDirty:!1,isValidating:!1,isLoading:En(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:En(s.defaultValues)?void 0:s.defaultValues});if(!e.current)if(s.formControl)e.current={...s.formControl,formState:n},s.defaultValues&&!En(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...l}=m1(s);e.current={...l,formState:n}}const i=e.current.control;return i._options=s,YC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),lt.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),lt.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),lt.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),lt.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),lt.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),lt.useEffect(()=>{s.values&&!vr(s.values,t.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=s.values,r(o=>({...o}))):i._resetDefaultValues()},[i,s.values]),lt.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=QC(n,i),e.current}const Cp=["","","","","","",""],ib=({event:s,slotInfo:e,defaultProjectName:t,onClose:n,onSave:r,onDelete:i})=>{const[o,l]=A.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:b}=rd({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:V}=tr(),[v,w]=A.useState([]),[B,P]=A.useState(""),[F,oe]=A.useState(!1),[se,M]=A.useState(""),[C,x]=A.useState(9),[E,j]=A.useState(0),[L,T]=A.useState(""),k=f("projectId");A.useEffect(()=>{if(k){const ae=V.find(He=>He.id===k||He.id===parseInt(k)||He.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,V,v]),A.useEffect(()=>{console.log(" Modal mount - initializing states"),w([]),T(""),P("")},[]),A.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!s,eventId:s==null?void 0:s.id,hasSlotInfo:!!e,hasMergedEvents:!!(s!=null&&s.mergedEventIds)}),s&&s.id){console.log(" ScheduleModal processing event:",{title:s.title,projectId:s.projectId,projectName:s.projectName,start:s.start,assignedTo:s.assignedTo,time:s.time});const ae=s.originalTitle||s.title,He=/ - (|) \d{1,2}$/,de=ae.replace(He,"");if(d("title",de,{shouldValidate:!1,shouldDirty:!1}),d("date",Ft(s.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",s.description||"",{shouldValidate:!1,shouldDirty:!1}),s.projectId&&s.projectId!==""&&s.projectId!=="undefined")console.log(" Setting projectId from event:",s.projectId),d("projectId",s.projectId,{shouldValidate:!1,shouldDirty:!1}),T("");else if(s.projectName){const ze=V.find(bt=>bt.name===s.projectName);console.log(" Finding project by name:",s.projectName,"found:",ze),ze?(console.log(" Setting projectId from found project:",ze.id),d("projectId",ze.id,{shouldValidate:!1,shouldDirty:!1}),T("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),T(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),T("");const Le=s.assignedTo||s.attendees||[];if(console.log(" Setting selectedMembers to:",Le),w(Array.isArray(Le)?Le:[]),s.time&&s.time!=="-"){console.log(" Setting time from event:",{eventTime:s.time,parsedHours:s.time.split(":")[0],parsedMinutes:s.time.split(":")[1]}),oe(!0);const[ze,bt]=s.time.split(":"),it=parseInt(ze,10),St=parseInt(bt,10);it>=12?(M(""),x(it===12?12:it-12)):(M(""),x(it===0?12:it)),j(St),console.log(" Time state set:",{hasTime:!0,period:it>=12?"":"",hour:it>=12?it===12?12:it-12:it===0?12:it,minute:St})}else console.log(" No time in event, setting hasTime to false"),oe(!1),M(""),x(9),j(0)}else if(e&&!s&&(console.log(" New schedule from slot:",e),b({projectId:"",title:"",date:Ft(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),w([]),T(""),t)){const ae=V.find(He=>He.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[s==null?void 0:s.id]);const _e=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),w(He=>{console.log(" Previous members in setState:",He);const de=He.includes(ae)?He.filter(Le=>Le!==ae):[...He,ae];return console.log(" Updated members after toggle:",de),de})},Ue=()=>{const ae="HV LAB";v.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He.filter(de=>de!==""),ae])},pe=()=>{const ae="";v.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He,ae])},je=()=>{const ae="";v.includes(ae)?w(He=>He.filter(de=>de!==ae)):w(He=>[...He,ae])},ft=()=>{B.trim()&&!v.includes(B.trim())&&(w(ae=>[...ae,B.trim()]),P(""))},qt=ae=>{w(He=>He.filter(de=>de!==ae))},Ht=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",F),console.log(" timePeriod:",se,"timeHour:",C,"timeMinute:",E),console.log(" Available projects:",V.map(nt=>({id:nt.id,name:nt.name,idType:typeof nt.id}))),console.log(" Merged event IDs:",s==null?void 0:s.mergedEventIds);const He=/ - (|) \d{1,2}$/,de=ae.title.replace(He,"").trim();let Le="",ze="";if(ae.projectId){const nt=V.find(ut=>ut.id===ae.projectId||ut.id===parseInt(ae.projectId)||ut.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",nt),Le=(nt==null?void 0:nt.name)||"",ze=ae.projectId}else Le="",ze="";console.log(" Final projectId:",ze,"projectName:",Le,"cleanedTitle:",de);const bt=new Date(ae.date);let it="-";if(F){let nt=C;se===""&&C!==12?nt=C+12:se===""&&C===12&&(nt=0),it=`${nt.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`,console.log(" Time calculated:",it)}else console.log(" No time set (hasTime is false)");const St={...s,title:de,start:bt,end:bt,projectId:ze,projectName:Le,assignedTo:v,description:ae.description||"",time:it,mergedEventIds:s==null?void 0:s.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",St);try{await r(St),console.log(" onSave completed successfully")}catch(nt){throw console.error(" onSave failed:",nt),nt}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ht),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),V.filter(ae=>s!=null&&s.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>oe(!F),className:`px-3 py-1.5 text-xs rounded border transition-colors ${F?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:F?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),F&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${se===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>M(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${se===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:C,onChange:ae=>x(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:E,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:Ue,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:pe,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:je,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Cp.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>_e(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!Cp.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>qt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>P(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ft())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ft,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:s&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(s.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(ii,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:n,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Mu=s=>{if(!s||s==="-")return"";const[e,t]=s.split(":"),n=parseInt(e,10),r=parseInt(t,10),i=n>=12?"":"",o=n%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},Hl=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Xo=s=>{if(!s)return s;const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Hl)if(n===r)return t.slice(0,-1).join(" ").trim()}for(const n of Hl)if(e.endsWith(n))return e.substring(0,e.length-n.length).trim()||e;return e},Ya=s=>{const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Hl)if(n===r)return r}for(const n of Hl)if(e.endsWith(n))return n;return""},d1=["","","","","","",""],f1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Xc=["","","/","","","","","","","","","","","","",""],p1={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},h1={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Vp=d1,g1=()=>{const{schedules:s,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:n}=tr(),{user:r}=Mr(),[i,o]=A.useState(!1);A.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Vp.filter(d=>d!==l)]:Vp,m=d=>{const f=s.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const w=new Set;return v.filter(B=>{const F=`${Ft(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return w.has(F)?!1:(w.add(F),!0)})},b=h(f.filter(v=>Pd(new Date(v.start)))),V=h(f.filter(v=>ON(new Date(v.start))&&!Pd(new Date(v.start))).sort((v,w)=>new Date(v.start).getTime()-new Date(w.start).getTime())).slice(0,3);return{todaySchedules:b,upcomingSchedules:V,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),b=f.length+h.length,V=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${V?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),V&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[V&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(Wi,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${V&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((w,B)=>{const P=B.project||"-";return w[P]||(w[P]=[]),w[P].push(B),w},{});return Object.entries(v).map(([w,B])=>{const P=d===l;return a.jsxDEV("div",{className:`border-l-3 ${P?"border-gray-400":"border-gray-900"} ${P?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${P?"bg-amber-100":"bg-gray-100"} border-b ${P?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:w},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(F=>{const oe=F.time&&F.time!=="-"?` - ${Mu(F.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",F.title,oe]},F.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},w,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(wN,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((w,B)=>{const P=Ft(new Date(B.start),"MM.dd",{locale:xs}),F=B.project||"-",oe=`${P}|${F}`;return w[oe]||(w[oe]={date:P,project:F,schedules:[]}),w[oe].schedules.push(B),w},{});return Object.values(v).map(({date:w,project:B,schedules:P})=>{const oe=P.length>0&&MN(new Date(P[0].start))?`${w} ()`:w;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:oe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:P.map(se=>{const M=se.time&&se.time!=="-"?` - ${Mu(se.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",se.title,M]},se.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${w}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),b===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&a.jsxDEV(ib,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await n(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},dc=()=>{const{user:s}=Mr(),{projects:e}=tr();return A.useMemo(()=>s?s.name===""?e.filter(n=>{const i=(n.manager?n.manager.split(",").map(l=>l.trim()):[]).includes(""),o=n.team&&Array.isArray(n.team)&&n.team.includes("");return i||o}):e:[],[s,e])},y1=({value:s,detailValue:e="",onChange:t,onDetailChange:n,placeholder:r=" ",error:i})=>{const[o,l]=A.useState(!1),[u,m]=A.useState(s),[d,f]=A.useState(e),h=A.useRef(null);A.useEffect(()=>{const B=P=>{h.current&&!h.current.contains(P.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),A.useEffect(()=>{m(s)},[s]),A.useEffect(()=>{f(e)},[e]);const b=()=>new Promise((B,P)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const F=document.createElement("script");F.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",F.async=!0,F.onload=()=>B(!0),F.onerror=()=>P(new Error("Kakao Postcode   ")),document.head.appendChild(F)}),V=B=>{const P=B.roadAddr||B.jibunAddr;m(P),t(P,d),l(!1)},v=B=>{const P=B.target.value;f(P),n&&n(P),u&&t(u,P)},w=async()=>{try{(!window.daum||!window.daum.Postcode)&&await b(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const P={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};V(P)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>w(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Gp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},wp=["","","","","","",""],b1=({project:s,onClose:e,onSave:t})=>{const{register:n,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=rd({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=A.useState([]),[d,f]=A.useState(""),[h,b]=A.useState(""),[V,v]=A.useState(""),[w,B]=A.useState(!1);A.useEffect(()=>{var M;if(s){const C=s.location?s.location.split(","):["",""],x=((M=C[0])==null?void 0:M.trim())||s.location||"",E=C.length>1?C.slice(1).join(",").trim():"";o({name:s.name,client:s.client||"",location:x,detailLocation:E,startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:""}),b(x),v(E);const j=s.manager?s.manager.split(",").map(L=>L.trim()).filter(L=>L&&L!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),b(""),v(""),m([])},[s,o]);const P=M=>{m(C=>C.includes(M)?C.filter(x=>x!==M):[...C,M])},F=()=>{d.trim()&&!u.includes(d.trim())&&(m(M=>[...M,d.trim()]),f(""))},oe=M=>{m(C=>C.filter(x=>x!==M))},se=async M=>{if(w)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",M);const C=h&&V?`${h}, ${V}`:h||M.location,x={name:M.name,client:M.client,location:C,manager:u.join(", "),contractAmount:(s==null?void 0:s.contractAmount)??0,spent:(s==null?void 0:s.spent)??0,status:(s==null?void 0:s.status)??"planning",progress:(s==null?void 0:s.progress)??0,description:(s==null?void 0:s.description)??"",meetingNotes:(s==null?void 0:s.meetingNotes)??[],customerRequests:(s==null?void 0:s.customerRequests)??[],entrancePassword:(s==null?void 0:s.entrancePassword)??"",sitePassword:(s==null?void 0:s.sitePassword)??""};if(M.startDate&&M.startDate!=="")x.startDate=M.startDate,console.log(" Setting startDate from form:",M.startDate);else if(s!=null&&s.startDate){const E=typeof s.startDate=="string"&&s.startDate.includes("T")?s.startDate.split("T")[0]:s.startDate;x.startDate=E,console.log(" Keeping existing startDate:",x.startDate)}if(M.endDate&&M.endDate!=="")x.endDate=M.endDate,console.log(" Setting endDate from form:",M.endDate);else if(s!=null&&s.endDate){const E=typeof s.endDate=="string"&&s.endDate.includes("T")?s.endDate.split("T")[0]:s.endDate;x.endDate=E,console.log(" Keeping existing endDate:",x.endDate)}console.log(" ProjectModal onSubmit - Final formData:",x);try{await t(x)}catch(E){throw B(!1),E}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(se),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...n("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...n("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(y1,{value:h,detailValue:V,onChange:(M,C)=>{b(M),v(C||""),i("location",M),i("detailLocation",C||"")},onDetailChange:M=>{v(M),i("detailLocation",M)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...n("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...n("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[wp.map(M=>a.jsxDEV("button",{type:"button",onClick:()=>P(M),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(M)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:M},M,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(M=>!wp.includes(M)).map(M=>a.jsxDEV("button",{type:"button",onClick:()=>oe(M),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[M," "]},M,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyPress:M=>{M.key==="Enter"&&(M.preventDefault(),F())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:F,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:w,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:w?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},N1=({projectName:s,meetingNotes:e,onClose:t,onSave:n,onDelete:r})=>{const[i,o]=A.useState(""),[l,u]=A.useState(new Date().toISOString().split("T")[0]),[m,d]=A.useState(!1),[f,h]=A.useState(!1),b=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},V=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await n(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},w=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:b,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:V,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ft(new Date(B.date),"yyyy.MM.dd (eee)",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>w(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},x1=({projectName:s,customerRequests:e,onClose:t,onSave:n,onToggleComplete:r,onDelete:i})=>{const[o,l]=A.useState(""),[u,m]=A.useState(new Date().toISOString().split("T")[0]),[d,f]=A.useState(!1),[h,b]=A.useState(!1),V=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}b(!0);try{await n(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{b(!1)}}},w=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=se=>{window.confirm("  ?")&&i(se)},P=se=>{r(se)},F=e.filter(se=>!se.completed),oe=e.filter(se=>se.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:se=>se.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:V,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:se=>m(se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:se=>l(se.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:w,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[F.map(se=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>P(se.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(SN,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:se.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ft(new Date(se.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(se.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},se.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),oe.map(se=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>P(se.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(TN,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:se.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ft(new Date(se.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(se.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},se.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},v1=({projectName:s,entrancePassword:e,sitePassword:t,onClose:n,onSave:r})=>{const[i,o]=A.useState(e||""),[l,u]=A.useState(t||""),[m,d]=A.useState(!1),[f,h]=A.useState(!1),b=()=>{d(!0)},V=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:w=>w.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:V,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},_1=({projectName:s,onClose:e})=>{var o;const[t,n]=A.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>n({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>n({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>n({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>n({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>n({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>n({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&n({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>n({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Xp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ft(new Date(t.startDate),"yyyy",{locale:xs}),"",Ft(new Date(t.startDate),"MM",{locale:xs}),"",Ft(new Date(t.startDate),"dd",{locale:xs})," ~ ",Ft(new Date(t.endDate),"yyyy",{locale:xs}),"",Ft(new Date(t.endDate),"MM",{locale:xs}),"",Ft(new Date(t.endDate),"dd",{locale:xs})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},D1=()=>{const{loadProjectsFromAPI:s,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:n}=tr(),{user:r}=Mr(),i=dc(),[o,l]=A.useState("in-progress"),[u,m]=A.useState("grid"),[d,f]=A.useState(!1),[h,b]=A.useState(null),[V,v]=A.useState(!1),[w,B]=A.useState(!1),[P,F]=A.useState(!1),[oe,se]=A.useState(!1),[M,C]=A.useState(null),x=(K,Te)=>`lastViewed_${r==null?void 0:r.id}_${K}_${Te}`,E=(K,Te)=>{const Re=x(K,Te),we=localStorage.getItem(Re);return we?parseInt(we,10):0},j=(K,Te)=>{const Re=x(K,Te);localStorage.setItem(Re,Date.now().toString())},L=(K,Te)=>{const Re=E(K.id,Te);return Te==="meeting"?(K.meetingNotes||[]).some(Ye=>(Ye.createdAt?new Date(Ye.createdAt).getTime():new Date(Ye.date).getTime())>Re):(K.customerRequests||[]).some(Ye=>!Ye.completed)};A.useEffect(()=>{s().catch(K=>{console.error("Failed to load projects:",K),ne.error("   ")})},[s]),A.useEffect(()=>{const K=()=>{b(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const T=(K,Te)=>{if(!K||!Te)return 0;const Re=new Date,we=new Date(K),Ye=new Date(Te);if(Re<we)return 0;if(Re>Ye)return 100;const Tt=Math.ceil((Ye.getTime()-we.getTime())/(1e3*60*60*24)),$t=Math.ceil((Re.getTime()-we.getTime())/(1e3*60*60*24)),ct=Math.round($t/Tt*100);return Math.min(100,Math.max(0,ct))},k=K=>{b(K),f(!0)},_e=async(K,Te)=>{if(window.confirm(`"${Te}"  ?

    .`))try{await n(K),ne.success(" ")}catch(Re){console.error("Failed to delete project:",Re),ne.error("  ")}},Ue=async K=>{try{if(h)await t(h.id,K),ne.success(" ");else{const Te={id:"",...K,team:K.team||[]};await e(Te),ne.success(" "),l(K.status||"planning")}f(!1),b(null)}catch(Te){console.error("Failed to save project:",Te),ne.error("  ")}},pe=async(K,Te)=>{try{await t(K,{status:Te}),ne.success(" ")}catch(Re){console.error("Failed to update project status:",Re),ne.error("  ")}},je=K=>{C(K),v(!0),j(K.id,"meeting")},ft=K=>{C(K),B(!0),j(K.id,"request")},qt=K=>{C(K),F(!0)},Ht=K=>{C(K),se(!0)},ae=async(K,Te)=>{if(!M)return;const Re=M.entrancePassword,we=M.sitePassword;C({...M,entrancePassword:K,sitePassword:Te});try{await t(M.id,{entrancePassword:K,sitePassword:Te}),ne.success(" ")}catch(Ye){console.error("Failed to save passwords:",Ye),ne.error("  "),C({...M,entrancePassword:Re,sitePassword:we})}},He=async(K,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:K,date:Te,createdAt:new Date},we=[...M.meetingNotes||[],Re];C({...M,meetingNotes:we});try{await t(M.id,{meetingNotes:we}),ne.success("  ")}catch(Ye){console.error("Failed to save meeting note:",Ye),ne.error("   "),C({...M,meetingNotes:M.meetingNotes||[]})}},de=async(K,Te)=>{if(!M)return;const Re={id:Date.now().toString(),content:K,completed:!1,createdAt:Te},we=[...M.customerRequests||[],Re];C({...M,customerRequests:we});try{await t(M.id,{customerRequests:we}),ne.success("  ")}catch(Ye){console.error("Failed to save customer request:",Ye),ne.error("   "),C({...M,customerRequests:M.customerRequests||[]})}},Le=async K=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.map(we=>we.id===K?{...we,completed:!we.completed}:we);C({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ne.success("  ")}catch(we){console.error("Failed to toggle request:",we),ne.error("  "),C({...M,customerRequests:Te})}},ze=async K=>{if(!M)return;const Te=M.meetingNotes||[],Re=Te.filter(we=>we.id!==K);C({...M,meetingNotes:Re});try{await t(M.id,{meetingNotes:Re}),ne.success("  ")}catch(we){console.error("Failed to delete meeting note:",we),ne.error(" "),C({...M,meetingNotes:Te})}},bt=async K=>{if(!M)return;const Te=M.customerRequests||[],Re=Te.filter(we=>we.id!==K);C({...M,customerRequests:Re});try{await t(M.id,{customerRequests:Re}),ne.success("  ")}catch(we){console.error("Failed to delete customer request:",we),ne.error(" "),C({...M,customerRequests:Te})}},it=({project:K})=>{const Re={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:we=>pe(K.id,we.target.value),className:Dn("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Re.color),onClick:we=>we.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},nt=(()=>{let K=i;return o!=="all"&&(K=K.filter(Te=>Te.status===o)),r!=null&&r.name&&(K=[...K].sort((Te,Re)=>{var Tt,$t;const we=Te.manager===r.name||((Tt=Te.team)==null?void 0:Tt.includes(r.name)),Ye=Re.manager===r.name||(($t=Re.team)==null?void 0:$t.includes(r.name));return we&&!Ye?-1:!we&&Ye?1:0})),K})(),ut={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},ms=({project:K})=>{var Re,we,Ye;const Te=T(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ht(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${Ft(K.startDate,"MM.dd (eee)",{locale:xs})} - ${Ft(K.endDate,"MM.dd (eee)",{locale:xs})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>qt(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>je(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Re=K.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=K.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),L(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ye=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Ye.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var ct;const Tt=((ct=K.customerRequests)==null?void 0:ct.filter(I=>!I.completed))||[],$t=Tt[Tt.length-1];return a.jsxDEV("div",{onClick:()=>ft(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Tt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Tt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),L(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),$t?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:$t.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>_e(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ut.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ut.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ut.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Dn("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Dn("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Dn("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Dn("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{b(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(Wi,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:nt.map(K=>a.jsxDEV(ms,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:nt.map(K=>{var Re,we,Ye,Tt;const Te=T(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[Ft(K.startDate,"yyyy.MM.dd (eee)",{locale:xs})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ft(K.endDate,"yyyy.MM.dd (eee)",{locale:xs})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ht(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>qt(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Te}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Te,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>je(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Re=K.meetingNotes)==null?void 0:Re.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(we=K.meetingNotes)==null?void 0:we.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),L(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ye=K.meetingNotes)!=null&&Ye.length?((Tt=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Tt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var I;const $t=((I=K.customerRequests)==null?void 0:I.filter(O=>!O.completed))||[],ct=$t[$t.length-1];return a.jsxDEV("div",{onClick:()=>ft(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",$t.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",$t.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),L(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:ct?ct.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>_e(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(b1,{project:h,onClose:()=>{f(!1),b(null)},onSave:Ue},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),V&&M&&a.jsxDEV(N1,{projectName:M.name,meetingNotes:M.meetingNotes||[],onClose:()=>{v(!1),C(null)},onSave:He,onDelete:ze},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),w&&M&&a.jsxDEV(x1,{projectName:M.name,customerRequests:M.customerRequests||[],onClose:()=>{B(!1),C(null)},onSave:de,onToggleComplete:Le,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),P&&M&&a.jsxDEV(v1,{projectName:M.name,entrancePassword:M.entrancePassword||"",sitePassword:M.sitePassword||"",onClose:()=>{F(!1),C(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),oe&&M&&a.jsxDEV(_1,{projectName:M.name,onClose:()=>{se(!1),C(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var id={},ob={exports:{}};(function(s){function e(t){return t&&t.__esModule?t:{default:t}}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ob);var Ks=ob.exports,od={},ab={exports:{}},lb={exports:{}},cb={exports:{}},ub={exports:{}};(function(s){function e(t){"@babel/helpers - typeof";return s.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ub);var uo=ub.exports,mb={exports:{}};(function(s){var e=uo.default;function t(n,r){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(mb);var k1=mb.exports;(function(s){var e=uo.default,t=k1;function n(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(cb);var db=cb.exports;(function(s){var e=db;function t(n,r,i){return(r=e(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(lb);var fb=lb.exports;(function(s){var e=fb;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function n(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(ab);var Or=ab.exports,pb={exports:{}},hb={exports:{}};(function(s){function e(t,n){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(n.indexOf(i)!==-1)continue;r[i]=t[i]}return r}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(hb);var A1=hb.exports;(function(s){var e=A1;function t(n,r){if(n==null)return{};var i,o,l=e(n,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(l[i]=n[i])}return l}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(pb);var ad=pb.exports,gb={exports:{}};(function(s){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(gb);var pi=gb.exports,yb={exports:{}};(function(s){var e=db;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function n(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(yb);var hi=yb.exports,bb={exports:{}},Nb={exports:{}};(function(s){function e(t){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Nb);var E1=Nb.exports,xb={exports:{}};(function(s){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s.exports=e=function(){return!!t},s.exports.__esModule=!0,s.exports.default=s.exports)()}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(xb);var C1=xb.exports,vb={exports:{}},_b={exports:{}};(function(s){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(_b);var V1=_b.exports;(function(s){var e=uo.default,t=V1;function n(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(vb);var w1=vb.exports;(function(s){var e=E1,t=C1,n=w1;function r(i,o,l){return o=e(o),n(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}s.exports=r,s.exports.__esModule=!0,s.exports.default=s.exports})(bb);var mo=bb.exports,Db={exports:{}},kb={exports:{}};(function(s){function e(t,n){return s.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},s.exports.__esModule=!0,s.exports.default=s.exports,e(t,n)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(kb);var S1=kb.exports;(function(s){var e=S1;function t(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&e(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Db);var fo=Db.exports;const Ea=fa(FN);var Cn={},so={};Object.defineProperty(so,"__esModule",{value:!0});so.views=so.navigate=void 0;so.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};so.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var T1=Ks.default;Object.defineProperty(Cn,"__esModule",{value:!0});Cn.views=Cn.dateRangeFormat=Cn.dateFormat=Cn.accessor=Cn.DayLayoutAlgorithmPropType=void 0;var rn=T1(Jp),Sp=so,Tp=Object.keys(Sp.views).map(function(s){return Sp.views[s]});Cn.accessor=rn.default.oneOfType([rn.default.string,rn.default.func]);Cn.dateFormat=rn.default.any;Cn.dateRangeFormat=rn.default.func;Cn.views=rn.default.oneOfType([rn.default.arrayOf(rn.default.oneOf(Tp)),rn.default.objectOf(function(s,e){var t=Tp.indexOf(e)!==-1&&typeof s[e]=="boolean";if(t)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return rn.default.elementType.apply(rn.default,[s,e].concat(r))})]);Cn.DayLayoutAlgorithmPropType=rn.default.oneOfType([rn.default.oneOf(["overlap","no-overlap"]),rn.default.func]);var fc={},po={},L1=Ks.default;Object.defineProperty(po,"__esModule",{value:!0});po.accessor=Ab;po.wrapAccessor=void 0;var P1=L1(uo);function Ab(s,e){var t=null;return typeof e=="function"?t=e(s):typeof e=="string"&&(0,P1.default)(s)==="object"&&s!=null&&e in s&&(t=s[e]),t}po.wrapAccessor=function(e){return function(t){return Ab(t,e)}};var gi={},I1=Ks.default;Object.defineProperty(gi,"__esModule",{value:!0});gi.DnDContext=void 0;var j1=I1(A);gi.DnDContext=j1.default.createContext();var yi=Ks.default;Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var R1=yi(Or),B1=yi(pi),U1=yi(hi),H1=yi(mo),M1=yi(fo),Ri=yi(A),Lp=yi(Ea),Pp=po,O1=gi,Eb=function(s){function e(){var t;(0,B1.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,H1.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,R1.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,M1.default)(e,s),(0,U1.default)(e,[{key:"renderAnchor",value:function(n){var r=n==="Up"||n==="Down"?"ns":"ew";return Ri.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(n)]},Ri.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var n=this.props,r=n.event,i=n.type,o=n.continuesPrior,l=n.continuesAfter,u=n.resizable,m=this.props.children;if(r.__isPreview)return Ri.default.cloneElement(m,{className:(0,Lp.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,b=f?!!(0,Pp.accessor)(r,f):!0;if(!b)return m;var V=u&&(h?!!(0,Pp.accessor)(r,h):!0);if(V||b){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(V){var w=null,B=null;i==="date"?(w=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(w=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),v.children=Ri.default.createElement("div",{className:"rbc-addons-dnd-resizable"},w,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Lp.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=Ri.default.cloneElement(m,v)}return m}}])}(Ri.default.Component);Eb.contextType=O1.DnDContext;fc.default=Eb;var pc={},Cb={exports:{}};(function(s){var e=uo.default;function t(n,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(s.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var b in u)b!=="default"&&{}.hasOwnProperty.call(u,b)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,b))&&(f.get||f.set)?d(h,b,f):h[b]=u[b]);return h},s.exports.__esModule=!0,s.exports.default=s.exports)(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Cb);var Vb=Cb.exports;function ld(s,e,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!0),s){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,n),s.dispatchEvent(r)}}function F1(s){var e=kn(s,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function q1(s,e,t){t===void 0&&(t=5);var n=!1,r=setTimeout(function(){n||ld(s,"transitionend",!0)},e+t),i=Ml(s,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(r),i()}}function cd(s,e,t,n){t==null&&(t=F1(s)||0);var r=q1(s,t,n),i=Ml(s,"transitionend",e);return function(){r(),i()}}var Ip={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function jp(s){var e=s.node,t=s.properties,n=s.duration,r=n===void 0?200:n,i=s.easing,o=s.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var b=t[h];qN(h)?m+=h+"("+b+") ":(u[h]=b,l.push($N(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(kn(e,Ip),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=cd(e,d,r);return e.clientLeft,kn(e,u),{cancel:function(){f(),kn(e,Ip)}}}function wb(s,e,t,n,r){if(!("nodeType"in s))return jp(s);if(!e)throw new Error("must include properties to animate");return typeof n=="function"&&(r=n,n=""),jp({node:s,properties:e,duration:t,easing:n,callback:r})}function Sb(s,e,t){if(s){if(typeof t>"u")return s.getAttribute(e);!t&&t!==""?s.removeAttribute(e):s.setAttribute(e,String(t))}}function Tb(s){return s?Array.from(s.children):[]}function Lb(s){if(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}return null}var $1=Function.prototype.bind.call(Function.prototype.call,[].slice);function Pb(s){return s?$1(s.childNodes):[]}function Ib(s,e){return function(n){var r=n.currentTarget,i=n.target,o=zu(r,s);o.some(function(l){return Ku(l,i)})&&e.call(this,n)}}function jb(s,e){return s&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(s,e.nextSibling):e.parentNode.appendChild(s),s):null}var W1=/^(?:input|select|textarea|button)$/i;function Rb(s){return s?W1.test(s.nodeName):!1}function Bb(s){return s?!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length):!1}function Ub(s,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var n=[];s;s=s.nextElementSibling)if(s!==e){if(t&&Qu(s,t))break;n.push(s)}return n}function Hb(s,e){return Ub(s,s,e)}function z1(s,e){var t=null,n=[];for(t=s?s[e]:null;t&&t.nodeType!==9;)n.push(t),t=t[e]||null;return n}function Mb(s){return z1(s,"parentElement")}function Ob(s,e){return s&&e?(e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s),s):null}function Fb(s){return s&&s.parentNode?(s.parentNode.removeChild(s),s):null}function ud(s,e){var t=kn(s,"position"),n=t==="absolute",r=s.ownerDocument;if(t==="fixed")return r||document;for(;(s=s.parentNode)&&!WN(s);){var i=n&&kn(s,"position")==="static",o=(kn(s,"overflow")||"")+(kn(s,"overflow-y")||"")+kn(s,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Ol(s)<s.scrollHeight))return s}return r||document}function qb(s,e){var t=yl(s),n={top:0,left:0};if(s){var r=e||ud(s),i=zN(r),o=bl(r),l=Ol(r,!0);i||(n=yl(r)),t={top:t.top-n.top,left:t.left-n.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Yu(function(){return bl(r,o)});return function(){return Gu(f)}}}function $b(s){return Ub(s&&s.parentElement?s.parentElement.firstElementChild:null,s)}var K1=/&nbsp;/gi,Q1=/\xA0/g,Y1=/\s+([^\s])/gm;function Wb(s,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var n="";return s&&(n=(s.textContent||"").replace(K1," ").replace(Q1," "),e&&(n=n.trim()),t&&(n=n.replace(Y1," $1"))),n}function zb(s,e){s.classList?s.classList.toggle(e):Xu(s,e)?Ju(s,e):Zu(s,e)}const G1={addEventListener:uh,removeEventListener:ch,triggerEvent:ld,animate:wb,filter:Ib,listen:Ml,style:kn,getComputedStyle:lh,attribute:Sb,activeElement:ah,ownerDocument:oh,ownerWindow:ih,requestAnimationFrame:Yu,cancelAnimationFrame:Gu,matches:Qu,height:Ol,width:rh,offset:yl,offsetParent:nh,position:sh,contains:Ku,scrollbarSize:th,scrollLeft:eh,scrollParent:ud,scrollTo:qb,scrollTop:bl,querySelectorAll:zu,closest:Zp,addClass:Zu,removeClass:Ju,hasClass:Xu,toggleClass:zb,transitionEnd:cd,childNodes:Pb,childElements:Tb,nextUntil:Hb,parents:Mb,siblings:$b,clear:Lb,insertAfter:jb,isInput:Rb,isVisible:Bb,prepend:Ob,remove:Fb,text:Wb},X1=Object.freeze(Object.defineProperty({__proto__:null,activeElement:ah,addClass:Zu,addEventListener:uh,animate:wb,attribute:Sb,cancelAnimationFrame:Gu,childElements:Tb,childNodes:Pb,clear:Lb,closest:Zp,contains:Ku,default:G1,filter:Ib,getComputedStyle:lh,hasClass:Xu,height:Ol,insertAfter:jb,isInput:Rb,isVisible:Bb,listen:Ml,matches:Qu,nextUntil:Hb,offset:yl,offsetParent:nh,ownerDocument:oh,ownerWindow:ih,parents:Mb,position:sh,prepend:Ob,querySelectorAll:zu,remove:Fb,removeClass:Ju,removeEventListener:ch,requestAnimationFrame:Yu,scrollLeft:eh,scrollParent:ud,scrollTo:qb,scrollTop:bl,scrollbarSize:th,siblings:$b,style:kn,text:Wb,toggleClass:zb,transitionEnd:cd,triggerEvent:ld,width:rh},Symbol.toStringTag,{value:"Module"})),J1=fa(X1);var Ou={exports:{}};(function(s,e){e.__esModule=!0,e.default=n;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(r,i){return t(r.querySelectorAll(i))}s.exports=e.default})(Ou,Ou.exports);var Z1=Ou.exports,wn={};const eV=fa(KN),tV=fa(QN),sV=fa(YN);var ho=Ks.default;Object.defineProperty(wn,"__esModule",{value:!0});wn.default=void 0;wn.getBoundsForNode=da;wn.getEventNodeFromPoint=Qb;wn.getShowMoreNodeFromPoint=Yb;wn.isEvent=lV;wn.isShowMore=cV;wn.objectsCollide=qu;var nV=ho(uo),rV=ho(pi),iV=ho(hi),Fu=ho(eV),Kb=ho(tV),oV=ho(sV);function $s(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,oV.default)(t,s,e,{passive:!1})}function aV(s,e,t){return!s||(0,Fu.default)(s,document.elementFromPoint(e,t))}function Qb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,Kb.default)(r,".rbc-event",s)}function Yb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,Kb.default)(r,".rbc-show-more",s)}function lV(s,e){return!!Qb(s,e)}function cV(s,e){return!!Yb(s,e)}function Lo(s){var e=s;return s.touches&&s.touches.length&&(e=s.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Rp=5,uV=250,mV=function(){function s(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.global,r=n===void 0?!1:n,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,rV.default)(this,s),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=$s("touchmove",function(){},window),this._removeKeyDownListener=$s("keydown",this._keyListener),this._removeKeyUpListener=$s("keyup",this._keyListener),this._removeDropFromOutsideListener=$s("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=$s("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,iV.default)(s,[{key:"on",value:function(t,n){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(n),{remove:function(){var o=r.indexOf(n);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var n=this._selectRect;return!n||!this.selecting?!1:qu(n,da(t))}},{key:"filter",value:function(t){var n=this._selectRect;return!n||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,n){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=$s("touchmove",function(){return d()}),l=$s("touchend",function(){return d()})},m=$s("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&u(n),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,n=$s("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=$s("mousedown",t._handleInitialEvent)}),r=$s("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var n=Lo(t),r=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!aV(u,r,i))){if(!this.globalMouse&&u&&!(0,Fu.default)(u,t.target)){var f=dV(0),h=f.top,b=f.left,V=f.bottom,v=f.right;if(d=da(u),m=qu({top:d.top-h,left:d.left-b,bottom:d.bottom+V,right:d.right+v},{top:l,left:o}),!m)return}var w=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(w!==!1)switch(t.type){case"mousedown":this._removeEndListener=$s("mouseup",this._handleTerminatingEvent),this._onEscListener=$s("keydown",this._handleTerminatingEvent),this._removeMoveListener=$s("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=$s("touchend",this._handleTerminatingEvent),this._removeMoveListener=$s("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var n=t.target,r=this.validContainers;return!r||!r.length||!n?!0:r.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var n=this.selecting,r=this._selectRect;if(!n&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Fu.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(t):n?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<uV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,r=n.x,i=n.y,o=Lo(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),b=this.selecting,V=this.isClick(l,u);V&&!b&&!(m||d)||(!b&&!V&&this.emit("selectStart",this._initialEventData),V||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,n){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Rp&&Math.abs(n-o)<=Rp}}])}();function dV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,nV.default)(s)!=="object"&&(s={top:s,left:s,right:s,bottom:s}),s}function qu(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=da(s),r=n.top,i=n.left,o=n.right,l=o===void 0?i:o,u=n.bottom,m=u===void 0?r:u,d=da(e),f=d.top,h=d.left,b=d.right,V=b===void 0?h:b,v=d.bottom,w=v===void 0?f:v;return!(m-t<f||r+t>w||l-t<h||i+t>V)}function da(s){if(!s.getBoundingClientRect)return s;var e=s.getBoundingClientRect(),t=e.left+Bp("left"),n=e.top+Bp("top");return{top:n,left:t,right:(s.offsetWidth||0)+t,bottom:(s.offsetHeight||0)+n}}function Bp(s){if(s==="left")return window.pageXOffset||document.body.scrollLeft||0;if(s==="top")return window.pageYOffset||document.body.scrollTop||0}wn.default=mV;var hc={},gc=Ks.default;Object.defineProperty(hc,"__esModule",{value:!0});hc.default=void 0;var fV=gc(fb),Up=gc(Or),pV=gc(Ea),Po=gc(A);function Ga(s){return typeof s=="string"?s:s+"%"}function hV(s){var e=s.style,t=s.className,n=s.event,r=s.accessors,i=s.rtl,o=s.selected,l=s.label,u=s.continuesPrior,m=s.continuesAfter,d=s.getters,f=s.onClick,h=s.onDoubleClick,b=s.isBackgroundEvent,V=s.onKeyPress,v=s.components,w=v.event,B=v.eventWrapper,P=r.title(n),F=r.tooltip(n),oe=r.end(n),se=r.start(n),M=d.eventProp(n,se,oe,o),C=[Po.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Po.default.createElement("div",{key:"2",className:"rbc-event-content"},w?Po.default.createElement(w,{event:n,title:P}):P)],x=e.height,E=e.top,j=e.width,L=e.xOffset,T=(0,Up.default)((0,Up.default)({},M.style),{},(0,fV.default)({top:Ga(E),height:Ga(x),width:Ga(j)},i?"right":"left",Ga(L)));return Po.default.createElement(B,Object.assign({type:"time"},s),Po.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:T,onKeyDown:V,title:F?(typeof l=="string"?l+": ":"")+F:void 0,className:(0,pV.default)(b?"rbc-background-event":"rbc-event",t,M.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},C))}hc.default=hV;var or={},Gb=Ks.default;Object.defineProperty(or,"__esModule",{value:!0});or.dragAccessors=void 0;or.eventTimes=DV;or.mergeComponents=vV;or.pointInColumn=_V;var gV=Gb(Or),yV=Gb(ad),Hp=po,bV=A,NV=["children"];or.dragAccessors={start:(0,Hp.wrapAccessor)(function(s){return s.start}),end:(0,Hp.wrapAccessor)(function(s){return s.end})};function xV(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];var n=function(i){var o=i.children,l=(0,yV.default)(i,NV);return e.filter(Boolean).reduceRight(function(u,m){return(0,bV.createElement)(m,l,u)},o)};return n}function vV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),n=(0,gV.default)({},s);return t.forEach(function(r){n[r]=s[r]?xV(s[r],e[r]):e[r]}),n}function _V(s,e){var t=s.left,n=s.right,r=s.top,i=e.x,o=e.y;return i<n+10&&i>t&&o>r}function DV(s,e,t){var n=e.start(s),r=e.end(s),i=t.eq(n,r,"minutes")&&t.diff(n,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(n,r,"milliseconds");return{start:n,end:r,duration:o}}var kV=Vb.default,Fr=Ks.default;Object.defineProperty(pc,"__esModule",{value:!0});pc.default=void 0;var pr=Fr(Or),AV=Fr(pi),EV=Fr(hi),CV=Fr(mo),VV=Fr(fo),Jc=J1,wV=Fr(Z1),Gr=Fr(A),SV=gi,hr=kV(wn),TV=Fr(hc),Xn=or,Xb=function(s){function e(){var t;(0,AV.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,CV.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,Xn.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),b=(0,Xn.eventTimes)(u,d,t.props.localizer),V=b.duration,v=t.props.localizer.add(h,V,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,Xn.eventTimes)(f,u,d),b=h.duration,V=m.nextSlot(o),v=!isNaN(b);if(v){var w=d.add(o,b,"milliseconds");V=new Date(Math.max(w,V))}return V},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,wV.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Jc.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Jc.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new hr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Jc.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,Xn.pointInColumn)((0,hr.getBoundsForNode)(l),f);var b=(0,hr.getEventNodeFromPoint)(l,f);if(!b)return!1;t.eventOffsetTop=f.y-(0,hr.getBoundsForNode)(b).top}),m.on("selecting",function(f){var h=(0,hr.getBoundsForNode)(l),b=t.context.draggable.dragAndDropAction;b.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),b.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,hr.getBoundsForNode)(l);(0,Xn.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var b=(0,hr.getBoundsForNode)(l);if(!(0,Xn.pointInColumn)(b,f))return t.reset();t.handleDragOverFromOutside(f,b)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,hr.getBoundsForNode)(l);u=!1;var b=t.context.draggable.dragAndDropAction;if(b.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,Xn.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Gr.default.createRef(),t}return(0,VV.default)(e,s),(0,EV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,pr.default)((0,pr.default)({},n),{},{start:i,end:o})})}},{key:"handleResize",value:function(n,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(n,r),b=(0,Xn.eventTimes)(d,o,u),V=b.start,v=b.end,w;if(f==="UP"){var B=u.min(h,l.closestSlotFromDate(v,-1));w=l.getRange(B,v),w=(0,pr.default)((0,pr.default)({},w),{},{endDate:v})}else if(f==="DOWN"){var P=u.max(h,l.closestSlotFromDate(V));w=l.getRange(V,P),w=(0,pr.default)((0,pr.default)({},w),{},{startDate:V})}this.update(d,w)}},{key:"renderContent",value:function(){var n=this.props,r=n.children,i=n.accessors,o=n.components,l=n.getters,u=n.slotMetrics,m=n.localizer,d=this.state,f=d.event,h=d.top,b=d.height;if(!f)return r;var V=r.props.children,v=f.start,w=f.end,B,P="eventTimeRangeFormat",F=u.startsBeforeDay(v),oe=u.startsAfterDay(w);return F?P="eventTimeRangeEndFormat":oe&&(P="eventTimeRangeStartFormat"),F&&oe?B=m.messages.allDay:B=m.format({start:v,end:w},P),Gr.default.cloneElement(r,{children:Gr.default.createElement(Gr.default.Fragment,null,V,f&&Gr.default.createElement(TV.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:b,width:100},getters:l,components:o,accessors:(0,pr.default)((0,pr.default)({},i),Xn.dragAccessors),continuesPrior:F,continuesAfter:oe}))})}},{key:"render",value:function(){return Gr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Gr.default.Component);Xb.contextType=SV.DnDContext;pc.default=Xb;var yc={},Jb={exports:{}},Zb={exports:{}},eN={exports:{}};(function(s){function e(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(eN);var tN=eN.exports;(function(s){var e=tN;function t(n){if(Array.isArray(n))return e(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Zb);var LV=Zb.exports,sN={exports:{}};(function(s){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(sN);var PV=sN.exports,nN={exports:{}};(function(s){var e=tN;function t(n,r){if(n){if(typeof n=="string")return e(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,r):void 0}}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(nN);var IV=nN.exports,rN={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(rN);var jV=rN.exports;(function(s){var e=LV,t=PV,n=IV,r=jV;function i(o){return e(o)||t(o)||n(o)||r()}s.exports=i,s.exports.__esModule=!0,s.exports.default=s.exports})(Jb);var iN=Jb.exports,bc={},Nc={},xc={},qr=Ks.default;Object.defineProperty(xc,"__esModule",{value:!0});xc.default=void 0;var Mp=qr(Or),RV=qr(ad),BV=qr(pi),UV=qr(hi),HV=qr(mo),MV=qr(fo),Io=qr(A),OV=qr(Ea),FV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],qV=function(s){function e(){return(0,BV.default)(this,e),(0,HV.default)(this,e,arguments)}return(0,MV.default)(e,s),(0,UV.default)(e,[{key:"render",value:function(){var n=this.props,r=n.style,i=n.className,o=n.event,l=n.selected,u=n.isAllDay,m=n.onSelect,d=n.onDoubleClick,f=n.onKeyPress,h=n.localizer,b=n.continuesPrior,V=n.continuesAfter,v=n.accessors,w=n.getters,B=n.children,P=n.components,F=P.event,oe=P.eventWrapper,se=n.slotStart,M=n.slotEnd,C=(0,RV.default)(n,FV);delete C.resizable;var x=v.title(o),E=v.tooltip(o),j=v.end(o),L=v.start(o),T=v.allDay(o),k=u||T||h.diff(L,h.ceil(j,"day"),"day")>1,_e=w.eventProp(o,L,j,l),Ue=Io.default.createElement("div",{className:"rbc-event-content",title:E||void 0},F?Io.default.createElement(F,{event:o,continuesPrior:b,continuesAfter:V,title:x,isAllDay:T,localizer:h,slotStart:se,slotEnd:M}):x);return Io.default.createElement(oe,Object.assign({},this.props,{type:"date"}),Io.default.createElement("div",Object.assign({},C,{style:(0,Mp.default)((0,Mp.default)({},_e.style),r),className:(0,OV.default)("rbc-event",i,_e.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":b,"rbc-event-continues-after":V}),onClick:function(je){return m&&m(o,je)},onDoubleClick:function(je){return d&&d(o,je)},onKeyDown:function(je){return f&&f(o,je)}}),typeof B=="function"?B(Ue):Ue))}}])}(Io.default.Component);xc.default=qV;var $r={},$V=Ks.default;Object.defineProperty($r,"__esModule",{value:!0});$r.dateCellSelection=QV;$r.getSlotAtX=oN;$r.isSelected=zV;$r.pointInBox=KV;$r.slotWidth=md;var WV=$V(GN);function zV(s,e){return!s||e==null?!1:(0,WV.default)(s,e)}function md(s,e){var t=s.right-s.left,n=t/e;return n}function oN(s,e,t,n){var r=md(s,n);return t?n-1-Math.floor((e-s.left)/r):Math.floor((e-s.left)/r)}function KV(s,e){var t=e.x,n=e.y;return n>=s.top&&n<=s.bottom&&t>=s.left&&t<=s.right}function QV(s,e,t,n,r){var i=-1,o=-1,l=n-1,u=md(e,n),m=oN(e,t.x,r,n),d=e.top<t.y&&e.bottom>t.y,f=e.top<s.y&&e.bottom>s.y,h=s.y>e.bottom,b=e.top>s.y,V=t.top<e.top&&t.bottom>e.bottom;return V&&(i=0,o=l),d&&(b?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((s.x-e.left)/u):Math.floor((s.x-e.left)/u),d?m<i?i=m:o=m:s.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var dd=Ks.default;Object.defineProperty(Nc,"__esModule",{value:!0});Nc.default=void 0;var Rn=dd(Jp),Op=dd(A),YV=dd(xc),GV=$r;Nc.default={propTypes:{slotMetrics:Rn.default.object.isRequired,selected:Rn.default.object,isAllDay:Rn.default.bool,accessors:Rn.default.object.isRequired,localizer:Rn.default.object.isRequired,components:Rn.default.object.isRequired,getters:Rn.default.object.isRequired,onSelect:Rn.default.func,onDoubleClick:Rn.default.func,onKeyPress:Rn.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var n=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,b=d.continuesPrior(t),V=d.continuesAfter(t);return Op.default.createElement(YV.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:b,continuesAfter:V,slotStart:d.first,slotEnd:d.last,selected:(0,GV.isSelected)(t,n),resizable:h})},renderSpan:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return Op.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Wr=Ks.default;Object.defineProperty(bc,"__esModule",{value:!0});bc.default=void 0;var XV=Wr(Or),JV=Wr(pi),ZV=Wr(hi),ew=Wr(mo),tw=Wr(fo),sw=Wr(Ea),Fp=Wr(A),gl=Wr(Nc),aN=function(s){function e(){return(0,JV.default)(this,e),(0,ew.default)(this,e,arguments)}return(0,tw.default)(e,s),(0,ZV.default)(e,[{key:"render",value:function(){var n=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return Fp.default.createElement("div",{className:(0,sw.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,b=d.left,V=d.right,v=d.span,w="_lvl_"+f,B=b-u,P=gl.default.renderEvent(n.props,h);return B&&m.push(gl.default.renderSpan(o,B,"".concat(w,"_gap"))),m.push(gl.default.renderSpan(o,v,w,P)),u=V+1,m},[]))}}])}(Fp.default.Component);aN.defaultProps=(0,XV.default)({},gl.default.defaultProps);bc.default=aN;var ar={},lN=Ks.default;Object.defineProperty(ar,"__esModule",{value:!0});ar.endOfRange=cN;ar.eventLevels=iw;ar.eventSegments=rw;ar.inRange=ow;ar.segsOverlap=uN;ar.sortEvents=$u;ar.sortWeekEvents=aw;var Zc=lN(iN),nw=lN(XN);function cN(s){var e=s.dateRange,t=s.unit,n=t===void 0?"day":t,r=s.localizer;return{first:e[0],last:r.add(e[e.length-1],1,n)}}function rw(s,e,t,n){var r=cN({dateRange:e,localizer:n}),i=r.first,o=r.last,l=n.diff(i,o,"day"),u=n.max(n.startOf(t.start(s),"day"),i),m=n.min(n.ceil(t.end(s),"day"),o),d=(0,nw.default)(e,function(h){return n.isSameDate(h,u)}),f=n.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-n.segmentOffset,1),{event:s,span:f,left:d+1,right:Math.max(d+f,1)}}function iw(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,n,r,i=[],o=[];for(t=0;t<s.length;t++){for(r=s[t],n=0;n<i.length&&uN(r,i[n]);n++);n>=e?o.push(r):(i[n]||(i[n]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function ow(s,e,t,n,r){var i={start:n.start(s),end:n.end(s)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function uN(s,e){return e.some(function(t){return t.left<=s.right&&t.right>=s.left})}function aw(s,e,t){var n=(0,Zc.default)(s),r=[],i=[];n.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return $u(u,m,e,t)}),l=i.sort(function(u,m){return $u(u,m,e,t)});return[].concat((0,Zc.default)(o),(0,Zc.default)(l))}function $u(s,e,t,n){var r={start:t.start(s),end:t.end(s),allDay:t.allDay(s)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return n.sortEvents({evtA:r,evtB:i})}var lw=Vb.default,zr=Ks.default;Object.defineProperty(yc,"__esModule",{value:!0});yc.default=void 0;var Xa=zr(Or),cw=zr(iN),uw=zr(pi),mw=zr(hi),dw=zr(mo),fw=zr(fo),Ja=zr(A),pw=zr(bc),Bi=lw(wn),hw=ar,gr=$r,Za=or,gw=gi,mN=function(s){function e(){var t;(0,uw.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,dw.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,gr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,b=d.rtl,V=d.localizer,v=(0,gr.getSlotAtX)(l,o.x,b,h.slots),w=h.getDateForSlot(v),B=(0,Za.eventTimes)(m,f,V),P=B.start,F=B.duration;P=V.merge(w,P);var oe=V.add(P,F,"milliseconds");t.update(m,P,oe)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,gr.getSlotAtX)(l,o.x,d,m.slots),b=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:b,end:f.add(b,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Bi.default(function(){return l},{validContainers:(0,cw.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,b=(0,Bi.getBoundsForNode)(o),V=(0,gr.pointInBox)(b,d);return h==="move"||h==="resize"&&(!f||V)}),m.on("selecting",function(d){var f=(0,Bi.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Bi.getBoundsForNode)(o);t.state.segment&&((0,gr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Bi.getBoundsForNode)(o);(0,gr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Bi.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Ja.default.createRef(),t}return(0,fw.default)(e,s),(0,mw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,r,i){var o=(0,hw.eventSegments)((0,Xa.default)((0,Xa.default)({},n),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Za.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(n,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,b=(0,Za.eventTimes)(o,m,h),V=b.start,v=b.end,w=(0,gr.getSlotAtX)(r,n.x,f,d.slots),B=d.getDateForSlot(w),P=(0,gr.pointInBox)(r,n);if(l==="RIGHT"){if(P){if(d.last<V)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(B,1,"day"):v=B}else if(h.inRange(V,d.first,d.last)||r.bottom<n.y&&+d.first>+V)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var F=m.end(o);v=h.merge(v,F),h.lt(v,V)&&(v=F)}else if(l==="LEFT"){if(P){if(d.first>v)return this.reset();V=B}else if(h.inRange(v,d.first,d.last)||r.top>n.y&&h.lt(d.last,v))V=h.add(d.first,-1,"milliseconds");else{this.reset();return}var oe=m.start(o);V=h.merge(V,oe),h.gt(V,v)&&(V=oe)}this.update(o,V,v)}},{key:"render",value:function(){var n=this.props,r=n.children,i=n.accessors,o=this.state.segment;return Ja.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&Ja.default.createElement(pw.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,Xa.default)((0,Xa.default)({},i),Za.dragAccessors)})))}}])}(Ja.default.Component);mN.contextType=gw.DnDContext;yc.default=mN;var Sn=Ks.default;Object.defineProperty(od,"__esModule",{value:!0});od.default=ww;var el=Sn(Or),yw=Sn(ad),bw=Sn(pi),Nw=Sn(hi),xw=Sn(mo),vw=Sn(fo),eu=Sn(A),_w=Sn(Ea),Dw=Sn(fc),kw=Sn(pc),Aw=Sn(yc),Ew=or,Cw=gi,Vw=["selectable","elementProps","components"];function ww(s){var e=function(t){function n(){var r;(0,bw.default)(this,n);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,xw.default)(this,n,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,b=h.onEventDrop,V=h.onEventResize;d==="move"&&b&&b(u),d==="resize"&&V&&V(u)}},r.state={interacting:!1},r}return(0,vw.default)(n,t),(0,Nw.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,yw.default)(i,Vw),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,Ew.mergeComponents)(u,{eventWrapper:Dw.default,eventContainerWrapper:kw.default,weekWrapper:Aw.default});var f=this.props.onDropFromOutside?(0,el.default)((0,el.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,_w.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return eu.default.createElement(Cw.DnDContext.Provider,{value:h},eu.default.createElement(s,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(eu.default.Component);return e.defaultProps=(0,el.default)((0,el.default)({},s.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var Sw=Ks.default;Object.defineProperty(id,"__esModule",{value:!0});var dN=id.default=void 0,Tw=Sw(od);dN=id.default=Tw.default;const br={async getAllProcesses(){try{const s=qe(re,"processes"),e=xt(s,ls("order","asc")),t=await wt(e);return t.empty?this.getDefaultProcesses():t.docs.map(n=>{const r=n.data();return{id:parseInt(n.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(s){return console.error("[Firestore]    :",s),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,t)=>({id:t+1,name:e,order:t,isDefault:!0}))},async createProcess(s,e){try{const t=qe(re,"processes"),n=await wt(t);let r=0;n.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>r&&(r=m)});const i=r+1,o=Se(re,"processes",String(i)),l=new Date().toISOString();return await li(o,{name:s,order:e,isDefault:!1,createdAt:l,updatedAt:os()}),console.log(" [Firestore]   :",i),{id:i,name:s,order:e,isDefault:!1,createdAt:l}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async updateProcess(s,e){try{const t=Se(re,"processes",String(s)),n=await It(t);if(!n.exists())throw new Error("   .");const r=n.data(),i={updatedAt:os()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Bt(t,i),console.log(" [Firestore]   :",s),{id:s,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async deleteProcess(s){try{const e=Se(re,"processes",String(s));await Us(e),console.log(" [Firestore]   :",s)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(s){try{const e=s.map((t,n)=>{const r=Se(re,"processes",String(t));return Bt(r,{order:n,updatedAt:os()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(s){const e=qe(re,"processes"),t=xt(e,ls("order","asc"));return dn(t,r=>{if(r.empty){s(br.getDefaultProcesses());return}const i=r.docs.map(o=>{const l=o.data();return{id:parseInt(o.id)||0,name:l.name||"",order:l.order||0,isDefault:l.isDefault||!1}});s(i)})}},Lw={getAllProcesses:()=>br.getAllProcesses(),createProcess:(s,e)=>br.createProcess(s,e),updateProcess:(s,e)=>br.updateProcess(s,e),deleteProcess:s=>br.deleteProcess(s),reorderProcesses:s=>br.reorderProcesses(s),subscribeToProcesses:br.subscribeToProcesses,getDefaultProcesses:br.getDefaultProcesses},Pw=dN(JN),Iw=f1;ot.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:s=>s<12?"":"",week:{dow:0,doy:1}});ot.locale("ko");const jw=ZN(ot),qp=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],Rw=lt.memo(({onSave:s,onCancel:e,processList:t})=>{const[n,r]=A.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=A.useState(i);A.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:n,onChange:m=>r(m.target.value),onBlur:()=>{n.trim()?s(n.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?n.trim()?s(n.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),$p=s=>s,Jo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},Bw=lt.memo(({date:s,label:e,filteredEvents:t,selectedDate:n,user:r,isMobileView:i})=>{const o=ot(s).format("YYYY-MM-DD"),l=Jo[o],u=!!Jo[o],m=n&&ot(s).isSame(n,"day"),d=t.filter(M=>ot(M.start).isSame(s,"day")),f=d.length,h=d.filter(M=>M.assignedTo&&M.assignedTo.includes((r==null?void 0:r.name)||"")).length,b=f-h,V=e.replace(/^0/,""),v=s.getDay()===0,w=s.getDay()===6;let B="#000000";u||v?B="#dc2626":w&&(B="#3b82f6");const P=ot(s).isSame(ot(),"day");let F="#d1d5db";u||v?F="#fecaca":w&&(F="#bfdbfe");const oe=V.length===2,se=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:P?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:P?"700":"400",paddingLeft:oe?"0px":"4px",...P&&{backgroundColor:F,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:se,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((M,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:b}).map((M,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:se,children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),Uw=lt.memo(({event:s,user:e,filterProject:t,isEditing:n,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",b=s.assignedTo||[],[V,v]=A.useState(!1),w=lt.useRef(null),B=()=>{const pe=window.innerWidth,je=window.innerHeight;return pe>=768&&pe<1024||pe>=1024&&je>pe},[P,F]=A.useState(B),[oe,se]=A.useState(!1);lt.useRef(null),lt.useRef(!1);const[M,C]=A.useState(r||""),x=lt.useRef(n);A.useEffect(()=>{n&&!x.current&&r!==void 0&&C(r),x.current=n},[n,r]);const E=e!=null&&e.name?e.name.slice(-2):null,j=E&&["",""].includes(E),L=E&&["","",""].includes(E),T=(e==null?void 0:e.name)&&(b.includes(e.name)||b.includes("HV LAB")||b.includes("")&&L||b.includes("")&&j);A.useEffect(()=>{const pe=()=>{F(B())};return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const k=pe=>{C(pe)},_e=()=>{M!=null&&M.trim()&&o&&(i&&i(M),o()),u&&u()},Ue=pe=>{pe.stopPropagation(),(pe.key==="Enter"||pe.key==="Escape")&&pe.currentTarget.blur()};return P?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{se(!0),v(!0)},onMouseLeave:()=>{se(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[V&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:w,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!s.isASVisit&&s.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",$p(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&b.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:b.map((pe,je)=>{const ft=pe==="HV LAB"||pe===""&&j||pe===""&&L||pe===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ft?"bold":"normal"},children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),je<b.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:pe=>k(pe.target.value),onBlur:_e,onKeyDown:Ue,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:T?"underline":"none",textDecorationColor:T?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:s.title,children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),oe&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),s.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",s.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),b.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",b.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!s.isASVisit&&s.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",$p(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:M,onChange:pe=>k(pe.target.value),onBlur:_e,onKeyDown:Ue,onClick:pe=>pe.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:T?"underline":"none",textDecorationColor:T?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&b.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:b.map((pe,je)=>{const ft=pe==="HV LAB"||pe===""&&j||pe===""&&L||pe===(e==null?void 0:e.name);return a.jsxDEV(lt.Fragment,{children:[a.jsxDEV("span",{className:ft?"font-bold":"",children:pe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),je<b.length-1&&""]},pe,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),V&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:w,onMouseDown:pe=>{pe.stopPropagation(),pe.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&n&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(pe=>a.jsxDEV("option",{value:pe},pe,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),Hw=()=>{const{schedules:s,setSchedules:e,addSchedule:t,deleteSchedule:n,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=tr(),{user:b}=Mr(),V=dc(),[v,w]=A.useState(!1);A.useEffect(()=>{const N=()=>{const U=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;w(U)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const B=N=>!N||N==="-"?"":v?N:Mu(N),P=b!=null&&b.name?b.name.slice(-2):null;console.log(" Current user:",b==null?void 0:b.name,"Short name:",P);const F=lt.useRef(!1);A.useEffect(()=>{F.current||(F.current=!0,r().catch(N=>{console.error("Failed to load schedules:",N),ne.error("  ")}))},[r]);const[oe,se]=A.useState([]);A.useEffect(()=>{const N=async U=>{if((U.ctrlKey||U.metaKey)&&U.key==="z"){const Y=U.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(oe.length>0){U.preventDefault();const z=oe[oe.length-1];try{const le=z.type==="as_visit"||z.type==="expected_payment"?"other":z.type;await i({id:"",title:z.originalTitle||z.title,start:z.start,end:z.end,type:le,project:z.originalProjectName||z.projectName,attendees:z.assignedTo||[],time:z.time,description:z.description}),se(ge=>ge.slice(0,-1)),ne.success(" ")}catch(le){console.error("  :",le),ne.error("  ")}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[oe,i]);const[M,C]=A.useState([]),[x,E]=A.useState(!1),[j,L]=A.useState(""),[T,k]=A.useState(null),[_e,Ue]=A.useState(""),[pe,je]=A.useState(!1),[ft,qt]=A.useState(null),[Ht,ae]=A.useState(null),He=A.useCallback(async()=>{je(!0);try{const N=await Lw.getAllProcesses();C(N)}catch(N){console.error("   :",N),C([])}finally{je(!1)}},[]);A.useEffect(()=>{He()},[He]);const de=A.useMemo(()=>M.length>0?M.map(N=>N.name):Iw,[M]),Le=async()=>{if(j.trim())try{const N=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(N.ok)L(""),He(),ne.success(" ");else{const U=await N.json();ne.error(U.error||"  ")}}catch(N){console.error("  :",N),ne.error("  ")}},ze=async()=>{if(!(!T||!_e.trim()))try{const N=await fetch(`/api/processes/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_e.trim()})});if(N.ok)k(null),Ue(""),He(),ne.success(" ");else{const U=await N.json();ne.error(U.error||"  ")}}catch(N){console.error("  :",N),ne.error("  ")}},bt=async N=>{if(confirm("   ?"))try{const U=await fetch(`/api/processes/${N}`,{method:"DELETE"});if(U.ok)He(),ne.success(" ");else{const Y=await U.json();ne.error(Y.error||"  ")}}catch(U){console.error("  :",U),ne.error("  ")}},it=N=>{qt(N)},St=(N,U)=>{N.preventDefault(),ft!==null&&ft!==U&&ae(U)},nt=async()=>{if(ft!==null&&Ht!==null&&ft!==Ht){const N=[...M],[U]=N.splice(ft,1);N.splice(Ht,0,U),C(N);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:N.map(z=>({id:z.id}))})})).ok||(He(),ne.error("  "))}catch(Y){console.error("  :",Y),He(),ne.error("  ")}}qt(null),ae(null)},ut=N=>{const U=V.findIndex(Y=>Y.name===N);return U>=0?qp[U%qp.length]:"#e8e2ea"},ms=V.map(N=>N.name),K=s.filter(N=>!N.asRequestId).filter(N=>(b==null?void 0:b.name)===""?N.project===""||ms.includes(N.project):!0).map(N=>{const U=V.find(he=>he.name===N.project);let Y=N.project===""?"[]":N.project;if(U&&N.project!==""){const he=U.name.length>2?U.name.substring(0,2):U.name,pt=(U.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";Y=gs?`${he}_${gs}`:he}const z=N.time,le=z&&z!=="-"?` - ${B(z)}`:"",ge=N.attendees||[];return{id:N.id,title:N.title+le,originalTitle:N.title,start:N.start,end:N.end,projectId:(U==null?void 0:U.id)||"",projectName:Y||"",originalProjectName:N.project||"",type:N.type||"other",phase:"",assignedTo:ge,priority:"medium",allDay:!z||z==="-",color:ut(N.project||""),isASVisit:!1,time:z,description:N.description}}),Te=u.filter(N=>N.scheduledVisitDate).filter(N=>(b==null?void 0:b.name)===""?ms.includes(N.project):!0).map(N=>{const U=N.scheduledVisitTime,Y=U&&U!=="-"?` - ${B(U)}`:"",z=V.find(he=>he.name===N.project);let le=N.project;if(z){const he=z.name.length>2?z.name.substring(0,2):z.name,pt=(z.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";le=gs?`${he}_${gs}`:he}const ge=`[AS] ${le}`;return{id:`as-${N.id}`,title:ge+Y,originalTitle:ge,start:N.scheduledVisitDate,end:N.scheduledVisitDate,projectId:(z==null?void 0:z.id)||"",projectName:le,originalProjectName:N.project,type:"as_visit",phase:"",assignedTo:N.assignedTo?Array.isArray(N.assignedTo)?N.assignedTo:N.assignedTo.split(",").map(he=>he.trim()):[],priority:"high",allDay:!U||U==="-",color:"#FEF3C7",isASVisit:!0,time:U,description:N.description}}),Re=(b==null?void 0:b.role)==="manager"?f.flatMap(N=>{var ge,he,at,pt,gs,Lt,Pt,ns;const U=V.find(Es=>Es.name===N.project);if(!U){const Es=[],Et=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),es=new Set(N.payments.flatMap(ps=>{var zt;return((zt=ps.type)==null?void 0:zt.split(", ").map(Kt=>Kt.trim()))||[]}));return!es.has("")&&((ge=N.expectedPaymentDates)!=null&&ge.contract)&&Es.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),!es.has("")&&((he=N.expectedPaymentDates)!=null&&he.start)&&Es.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!es.has("")&&((at=N.expectedPaymentDates)!=null&&at.middle)&&Es.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Et*.4).toLocaleString()}`}),!es.has("")&&((pt=N.expectedPaymentDates)!=null&&pt.final)&&Es.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Et*.1).toLocaleString()}`}),Es}if(!U.startDate||!U.endDate)return[];const Y=N.totalAmount+(N.vatType==="percentage"?N.totalAmount*(N.vatPercentage/100):N.vatAmount),z=new Set(N.payments.flatMap(Es=>{var Et;return((Et=Es.type)==null?void 0:Et.split(", ").map(es=>es.trim()))||[]})),le=[];return!z.has("")&&((gs=N.expectedPaymentDates)!=null&&gs.contract)&&le.push({id:`payment-${N.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.contract),end:new Date(N.expectedPaymentDates.contract),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!z.has("")&&((Lt=N.expectedPaymentDates)!=null&&Lt.start)&&le.push({id:`payment-${N.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.start),end:new Date(N.expectedPaymentDates.start),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!z.has("")&&((Pt=N.expectedPaymentDates)!=null&&Pt.middle)&&le.push({id:`payment-${N.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.middle),end:new Date(N.expectedPaymentDates.middle),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!z.has("")&&((ns=N.expectedPaymentDates)!=null&&ns.final)&&le.push({id:`payment-${N.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(N.expectedPaymentDates.final),end:new Date(N.expectedPaymentDates.final),projectId:U.id||"",projectName:N.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],we=[...K,...Te,...Re],Ye=A.useCallback(N=>{if(!(b!=null&&b.name))return!1;const U=N.assignedTo||[],Y=b.name.slice(-2),z=["",""].includes(Y),le=["","",""].includes(Y);return U.includes(b.name)||U.includes("HV LAB")||U.includes("")&&le||U.includes("")&&z},[b==null?void 0:b.name]),Tt=(N,U)=>{if(!U)return[...N].sort((le,ge)=>{const he=Ye(le),at=Ye(ge);return he&&!at?-1:!he&&at?1:le.start.getTime()-ge.start.getTime()});const Y=new Map;N.forEach(le=>{const ge=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ge){const he=`single_${le.id}`;Y.set(he,[le])}else{const he=le.start.toISOString().split("T")[0],at=[...le.assignedTo].sort().join(","),pt=`${he}_${le.projectName}_${at}`;Y.has(pt)||Y.set(pt,[]),Y.get(pt).push(le)}});const z=[];return Y.forEach(le=>{if(le.length===1)z.push(le[0]);else{const ge=le[0],he=le.map(Pt=>Pt.originalTitle||Pt.title),at=[...new Set(he)],pt=le.map(Pt=>{const ns=Pt.originalTitle||Pt.title;return ns.startsWith(ge.projectName+" - ")?ns.substring(ge.projectName.length+3):ns}),gs=[...new Set(pt)],Lt={...ge,id:le[0].id,title:gs.join(", "),originalTitle:at.join(", "),description:le.map(Pt=>Pt.description||Pt.originalTitle||Pt.title).join(`
`),assignedTo:[...new Set(le.flatMap(Pt=>Pt.assignedTo))],mergedEventIds:le.map(Pt=>Pt.id)};z.push(Lt)}}),z.sort((le,ge)=>{const he=Ye(le),at=Ye(ge);return he&&!at?-1:!he&&at?1:le.start.getTime()-ge.start.getTime()})},[$t,ct]=A.useState("month"),[I,O]=A.useState(new Date),[Z,ye]=A.useState(!1),[ue,fe]=A.useState(null),[Ce,Me]=A.useState(null),tt=`schedule_filterProject_${(b==null?void 0:b.id)||"guest"}`,[Ae,Rs]=A.useState(()=>{const N=localStorage.getItem(tt);return N||((b==null?void 0:b.name)===""&&V.length>0?V[0].name:"all")});A.useEffect(()=>{localStorage.setItem(tt,Ae)},[Ae,tt]),A.useCallback(()=>{document.body.classList.add("printing-schedule");const N=Ae==="all"?" ":Ae,U=ot(I).format("YYYY MM"),Y=document.title;document.title=`${N} - ${U} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[Ae,I]);const jt=Tt(we,Ae==="all"),[ee,Ge]=A.useState(window.innerWidth<768?new Date:null),[H,be]=A.useState(null),De=lt.useRef(null),Pe=lt.useRef(!1),[me,Mt]=A.useState(null),mt=lt.useRef(!1),Wt=lt.useRef(!1);A.useEffect(()=>{const N=z=>{z.key==="Control"&&(Wt.current=!0)},U=z=>{z.key==="Control"&&(Wt.current=!1)},Y=()=>{Wt.current=!1};return window.addEventListener("keydown",N),window.addEventListener("keyup",U),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",N),window.removeEventListener("keyup",U),window.removeEventListener("blur",Y)}},[]),A.useEffect(()=>{if(!H)return;let N=null;const U=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy")},Y=ge=>{ge.preventDefault(),ge.dataTransfer&&(ge.dataTransfer.dropEffect="copy");const at=ge.target.closest(".rbc-day-bg");N&&N!==at&&(N.style.backgroundColor=""),at&&(at.style.backgroundColor="rgba(59, 130, 246, 0.15)",N=at)},z=()=>{N&&(N.style.backgroundColor="",N=null)},le=ge=>{ge.preventDefault(),N&&(N.style.backgroundColor="",N=null)};return document.addEventListener("dragenter",U),document.addEventListener("dragover",Y),document.addEventListener("dragend",z),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",U),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",z),document.removeEventListener("drop",le),N&&(N.style.backgroundColor="")}},[H]);const[At,ds]=A.useState(null),[ss,Ts]=A.useState(null),[fn,Qs]=A.useState(""),[pn,Kr]=A.useState(!1),[Tn,en]=A.useState(null),[Ln,_]=A.useState(!1),[Q,y]=A.useState(""),[R,S]=A.useState(null),[q,J]=A.useState({x:0,y:0}),[W,G]=A.useState({x:0,y:0}),[te,Oe]=A.useState(!1),Ke=8;A.useEffect(()=>{if(!R)return;const N=Y=>{J({x:Y.clientX,y:Y.clientY});const z=Math.abs(Y.clientX-W.x),le=Math.abs(Y.clientY-W.y);(z>Ke||le>Ke)&&Oe(!0)},U=()=>{S(null),Oe(!1)};return window.addEventListener("mousemove",N),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",U)}},[R,W]);const Fe=lt.useRef(!1),Ne=A.useCallback(async({event:N,start:U,end:Y})=>{if(N.isASVisit||N.isExpectedPayment){ne.error("    ");return}const z=U instanceof Date?U:new Date(U),le=Y instanceof Date?Y:new Date(Y);if(Wt.current)try{const he=N.mergedEventIds||[N.id],at=s.filter(pt=>he.includes(pt.id));for(const pt of at)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:pt.title,start:z,end:le,project:pt.project,attendees:pt.attendees||[],time:pt.time,priority:pt.priority||"medium"});ne.success(" ")}catch(he){console.error("  :",he),ne.error("  ")}else{const he=N.mergedEventIds||[N.id];try{for(const at of he)await o(at,{start:z,end:le})}catch(at){console.error("  :",at),ne.error("  "),r()}}},[s,o,i,r]),Ze=A.useCallback(({event:N,action:U})=>{var z;if(N.isASVisit||N.isExpectedPayment||N.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((z=le.textContent)!=null&&z.includes(N.originalTitle||N.title)){const ge=le.getBoundingClientRect();G({x:ge.left,y:ge.top}),J({x:ge.left,y:ge.top});break}Oe(!1),S(N)},[]),Yt=A.useCallback(async(N,U,Y=!1)=>{if(Ae==="all"){ne.error("  ");return}const z={id:"",title:N,start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(z)}catch(le){console.error("  :",le),ne.error("  ")}},[Ae,i,b]),Dt=A.useCallback(({start:N})=>{const U=H||De.current;U&&Ae!=="all"&&(Pe.current=!0,mt.current=!0,requestAnimationFrame(()=>{mt.current=!1}),ds(null),Ts(null),Qs(""),Yt(U,N),requestAnimationFrame(()=>{be(null),De.current=null,Pe.current=!1}))},[H,Ae,Yt]),fs=A.useCallback(()=>{const N=H||De.current;return N?{title:N}:null},[H]),Gt=A.useCallback(async N=>{if(!N.trim()||!At||Ae==="all"){ds(null);return}const U=At;ds(null);const Y={id:"",title:N.trim(),start:U,end:U,type:"construction",project:Ae,location:"",attendees:b!=null&&b.name?[b.name]:[],description:""};try{await i(Y)}catch(z){console.error("  :",z),ne.error("  ")}},[At,Ae,i,b]),Ys=A.useCallback(()=>{ds(null)},[]),Gs=A.useCallback(async()=>{var N;if(!ss||!fn.trim()){Ts(null),Qs("");return}try{const U=((N=ss.mergedEventIds)==null?void 0:N[0])||ss.id;await o(U,{title:fn.trim()})}catch(U){console.error("  :",U),ne.error("  ")}Ts(null),Qs("")},[ss,fn,o]),Ot=A.useCallback(async N=>{se(Y=>[...Y,N]);const U=N.mergedEventIds||[N.id];ne.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(U.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),ne.error("  "),se(z=>z.slice(0,-1))}Ts(null),Qs("")},[l]),We=Ae==="all"?jt:jt.filter(N=>(N.originalProjectName||N.projectName)===Ae),ke=lt.useMemo(()=>{const N=Ae!=="all",U=new Map;We.forEach(z=>{const le=ot(z.start).format("YYYY-MM-DD");U.has(le)||U.set(le,[]),U.get(le).push(z)});const Y=[];return U.forEach(z=>{if(N)z.forEach((le,ge)=>{const he=ot(le.start).startOf("day").add(ge,"milliseconds").toDate();Y.push({...le,start:he,allDay:!1})});else{const le=[],ge=[];z.forEach(he=>{Ye(he)?le.push(he):ge.push(he)}),le.forEach((he,at)=>{const pt=ot(he.start).startOf("day").add(at,"milliseconds").toDate();Y.push({...he,start:pt,allDay:!1})}),ge.forEach((he,at)=>{const pt=ot(he.start).startOf("day").add(1e3+at,"milliseconds").toDate();Y.push({...he,start:pt,allDay:!1})})}}),Y.sort((z,le)=>z.start.getTime()-le.start.getTime())},[We,Ye,Ae]),Qe=lt.useMemo(()=>{if(At&&Ae!=="all"){const N=ot(At).format("YYYY-MM-DD"),U=ke.filter(ge=>ot(ge.start).format("YYYY-MM-DD")===N),Y=U.length>0?Math.max(...U.map(ge=>ge.start.getTime())):ot(At).startOf("day").valueOf(),z=new Date(Y+1),le={id:"__inline_add__",title:"",start:z,end:z,projectId:"",projectName:Ae,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...ke,le]}return ke},[ke,At,Ae]);A.useEffect(()=>{(b==null?void 0:b.name)===""&&V.length>0&&(Ae==="all"||!V.find(N=>N.name===Ae))&&Rs(V[0].name)},[V,b]),A.useEffect(()=>{const N=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(he=>{he.style.display="none",he.style.visibility="hidden",he.style.opacity="0",he.style.pointerEvents="none",he.style.position="absolute",he.style.left="-9999px",he.style.top="-9999px",he.style.zIndex="-1"})};N();const U=new MutationObserver(N),Y=document.querySelector(".rbc-calendar");Y&&U.observe(Y,{childList:!0,subtree:!0});const z=new MutationObserver(N);return z.observe(document.body,{childList:!0,subtree:!0}),()=>{U.disconnect(),z.disconnect()}},[$t,I]);const[Je,Nt]=A.useState({date:null,projectId:"",title:""}),Be=lt.useRef(!1),rt=lt.useRef(null),gt=N=>{if(Fe.current){Fe.current=!1;return}if(N.id==="__inline_add__")return;Be.current=!0,rt.current&&clearTimeout(rt.current);const U=Ae!=="all",Y=window.innerWidth<768;if(U&&!Y&&!N.isASVisit&&!N.isExpectedPayment)ds(null),Ts(N),Qs(N.originalTitle||N.title);else{const z={...N,title:N.originalTitle||N.title};Me(null),fe(z),ye(!0)}rt.current=setTimeout(()=>{Be.current=!1,rt.current=null},300)},Zt=N=>{const U=window.innerWidth,Y=U<768,z=U>=768&&U<1024,le=Ae==="all";if(mt.current)return;if(Y){if(N.start){Ge(N.start);const he=document.querySelector(".md\\:hidden.mt-3.bg-white");he&&he.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ge=N.action==="click"||N.action==="select";if(!(z&&!ge)){if(le){Be.current=!1,Ts(null),Qs(""),ds(null),Me(N),fe(null),ye(!0);return}if(!Be.current){if(me){Yt(me,N.start,!0);return}Ts(null),Qs(""),ds(N.start)}}},is=async()=>{if(!Je.projectId||!Je.title.trim()){alert("  ");return}const N=V.find(U=>U.id===Je.projectId);if(!(!N||!Je.date))try{await i({id:Date.now().toString(),title:Je.title,start:Je.date,end:Je.date,type:"other",project:N.name,location:"",attendees:[],description:""}),Nt({date:null,projectId:"",title:""}),Ge(null)}catch(U){console.error("Failed to add schedule:",U),ne.error("  ")}},Pn=N=>{if(N.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let U=N.color||"#E0E7FF",Y="#1f2937";if(N.isASVisit)U="#E8F5E9",Y="#1f2937";else{const z=N.assignedTo&&N.assignedTo.includes("HV LAB"),le=N.assignedTo&&N.assignedTo.includes("")&&P&&["",""].includes(P),ge=N.assignedTo&&N.assignedTo.includes("")&&P&&["","",""].includes(P);N.assignedTo&&N.assignedTo.includes((b==null?void 0:b.name)||"")||z||le||ge?(U="#FEF3C7",Y="#1f2937"):N.color||(U="#e8e2ea")}return{style:{backgroundColor:U,"--event-bg-color":U,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},bi=lt.useCallback(N=>{const U=ot(N).format("YYYY-MM-DD"),Y=!!Jo[U],z=ee&&ot(N).isSame(ee,"day"),le=window.innerWidth<768;let ge="";z&&(ge+="selected-date "),Y&&(ge+="holiday-date ");const he=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ge.trim(),style:he}},[ee]),[yt,Ni]=A.useState(window.innerWidth<768);A.useEffect(()=>{const N=()=>{Ni(window.innerWidth<768)};return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),A.useEffect(()=>{const N=()=>{const U=ee||new Date;Me({start:U,end:U}),fe(null),ye(!0)};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[ee]);const lr=lt.useCallback(({date:N,label:U})=>a.jsxDEV(Bw,{date:N,label:U,filteredEvents:Qe,selectedDate:ee,user:b,isMobileView:yt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[Qe,ee,b,yt]),cr=lt.useRef(fn);cr.current=fn;const Ca=lt.useCallback(N=>{Qs(N)},[]),go=lt.useCallback(()=>{Ts(null),Qs("")},[]),Va=lt.useCallback(({event:N})=>{if(N.id==="__inline_add__")return a.jsxDEV(Rw,{onSave:Gt,onCancel:Ys,processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const U=(ss==null?void 0:ss.id)===N.id||(ss==null?void 0:ss.mergedEventIds)&&ss.mergedEventIds.includes(N.id);return a.jsxDEV(Uw,{event:N,user:b,filterProject:Ae,isEditing:U,editTitle:U?cr.current:void 0,onEditTitleChange:U?Ca:void 0,onEditSave:U?Gs:void 0,onEditDelete:U?()=>Ot(N):void 0,onEditCancel:U?go:void 0,onHoverDelete:()=>Ot(N),onDeleteAction:()=>{Fe.current=!0},processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[b,Ae,ss,Gs,Ot,Gt,Ys,Ca,go,de]),vc=({onNavigate:N})=>{const[U,Y]=lt.useState(!1),[z,le]=lt.useState(ot(I).year()),[ge,he]=lt.useState(ot(I).month()),at=window.innerWidth<768,pt=()=>{le(ot(I).year()),he(ot(I).month()),Y(!0)},gs=()=>{O(ot().year(z).month(ge).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${at?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>N("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:pt,children:[a.jsxDEV("span",{children:ot(I).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ae==="all"?" ":Ae]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>N("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ae,onChange:Lt=>{Rs(Lt.target.value),Mt(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(b==null?void 0:b.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),V.filter(Lt=>Lt.status!=="completed").map(Lt=>a.jsxDEV("option",{value:Lt.name,children:Lt.name},Lt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),U&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(z-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[z,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(z+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Lt=>{const Pt=ge===Lt-1,ns=ot().year()===z&&ot().month()===Lt-1;return a.jsxDEV("button",{onClick:()=>he(Lt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Pt?"bg-gray-900 text-white":ns?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Lt,""]},Lt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{O(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:gs,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},_c=()=>null,Dc=A.useMemo(()=>({toolbar:vc,event:Va,month:{dateHeader:lr,showMore:_c}}),[lr,Va]),ur=lt.useMemo(()=>{if(!ee)return[];let N;if(yt)N=Qe.filter(Y=>ot(Y.start).isSame(ee,"day"));else{const Y=ot(ee).startOf("week"),z=ot(ee).endOf("week");N=Qe.filter(le=>{const ge=ot(le.start);return ge.isSameOrAfter(Y,"day")&&ge.isSameOrBefore(z,"day")})}const U=[...N].sort((Y,z)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),ge=Y.assignedTo&&Y.assignedTo.includes("")&&P&&["",""].includes(P),he=Y.assignedTo&&Y.assignedTo.includes("")&&P&&["","",""].includes(P),at=Y.assignedTo&&P&&Y.assignedTo.includes(P)||Y.assignedTo&&(b==null?void 0:b.name)&&Y.assignedTo.includes(b.name)||le||ge||he,pt=z.assignedTo&&z.assignedTo.includes("HV LAB"),gs=z.assignedTo&&z.assignedTo.includes("")&&P&&["",""].includes(P),Lt=z.assignedTo&&z.assignedTo.includes("")&&P&&["","",""].includes(P),Pt=z.assignedTo&&P&&z.assignedTo.includes(P)||z.assignedTo&&(b==null?void 0:b.name)&&z.assignedTo.includes(b.name)||pt||gs||Lt;return at&&!Pt?-1:!at&&Pt?1:new Date(Y.start).getTime()-new Date(z.start).getTime()});return console.log("Sorted events:",U.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:b==null?void 0:b.name,userShort:P}))),U},[ee,Qe,b,P,yt]);return A.useEffect(()=>{const U=setTimeout(()=>{const Y=yt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),z=document.querySelectorAll(".rbc-month-row"),le=[];z.forEach((Et,es)=>{const ps=Et.querySelectorAll(".rbc-date-cell");let zt=0;ps.forEach(Kt=>{const ht=Kt.querySelector("button");let Jt=ht==null?void 0:ht.textContent;if(!Jt){const Nn=Kt.querySelector("span");Jt=Nn==null?void 0:Nn.textContent}if(Jt&&!isNaN(parseInt(Jt))){const Nn=ot(I).date(parseInt(Jt)),In=Qe.filter(xi=>ot(xi.start).isSame(Nn,"day"));zt=Math.max(zt,In.length)}}),le.push(zt)});const ge=Ae&&Ae!=="all",he=100,at=ge?60:18,pt=25,gs=Math.floor((he-pt)/at),Lt=le.length,Pt=he*Lt,ns=le.map(Et=>Et<=gs?he:pt+Et*at+10),Es=ns.reduce((Et,es)=>Et+es,0);if(Es>Pt){const Et=ns.map((zt,Kt)=>({index:Kt,height:zt,overflow:zt>he})),es=Et.filter(zt=>zt.overflow).reduce((zt,Kt)=>zt+(Kt.height-he),0),ps=Et.filter(zt=>!zt.overflow);if(ps.length>0){const zt=Pt-es-ps.length*he,Kt=Math.max(50,he+zt/ps.length);z.forEach((ht,Jt)=>{const In=ns[Jt]>he?ns[Jt]:Kt;ht.style.height=`${In}px`,ht.style.minHeight=`${In}px`})}else{const zt=Pt/Es;z.forEach((Kt,ht)=>{const Jt=Math.max(80,ns[ht]*zt);Kt.style.height=`${Jt}px`,Kt.style.minHeight=`${Jt}px`})}}else{const Et=ns.reduce((Kt,ht)=>Kt+(ht>he?ht:0),0),es=ns.filter(Kt=>Kt<=he).length,ps=Pt-Et,zt=es>0?ps/es:he;z.forEach((Kt,ht)=>{const Jt=ns[ht]>he?ns[ht]:zt;Kt.style.height=`${Jt}px`,Kt.style.minHeight=`${Jt}px`})}Y.forEach(Et=>{const es=Et.querySelector("button");let ps=es==null?void 0:es.textContent;if(!ps){const Jt=Et.querySelector("span");ps=Jt==null?void 0:Jt.textContent}if(!ps||isNaN(parseInt(ps)))return;const zt=ot(I).date(parseInt(ps)),Kt=Qe.filter(Jt=>ot(Jt.start).isSame(zt,"day"));Kt.length>0?Et.setAttribute("data-event-count",Kt.length.toString()):Et.removeAttribute("data-event-count");const ht=zt.clone().toDate();if(ee&&ot(ht).isSame(ee,"day")?Et.classList.add("selected-date"):Et.classList.remove("selected-date"),yt){const Jt=Et,Nn=Jt._mobileClickHandler;Nn&&Et.removeEventListener("click",Nn);const In=xi=>{if(xi.target.closest(".rbc-event"))return;const vi=zt.clone().toDate();Ge(vi);const xn=document.querySelector(".md\\:hidden.mt-3.bg-white");xn&&xn.scrollIntoView({behavior:"smooth",block:"nearest"})};Jt._mobileClickHandler=In,Et.addEventListener("click",In,!0),Et.style.cursor="pointer",Et.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(U),yt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(z=>{const le=z,ge=le._mobileClickHandler;ge&&(z.removeEventListener("click",ge),delete le._mobileClickHandler)})}},[Qe,I,yt,ee,Ae]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[Je.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:ot(Je.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:Je.projectId,onChange:N=>Nt({...Je,projectId:N.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:V.filter(N=>N.status!=="completed").map(N=>a.jsxDEV("option",{value:N.id,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:Je.title,onChange:N=>Nt({...Je,title:N.target.value}),onKeyPress:N=>{N.key==="Enter"&&is()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:is,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Nt({date:null,projectId:"",title:""}),Ge(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ae!=="all"&&!yt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>E(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),me&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:de.map(N=>a.jsxDEV("div",{draggable:!0,onClick:()=>{Mt(me===N?null:N)},onDragStart:U=>{Pe.current=!1,Mt(null),be(N),De.current=N,U.dataTransfer.setData("text/plain",N),U.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Pe.current||(be(null),De.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${me===N?"bg-blue-500 text-white ring-2 ring-blue-300":H===N?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ae!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(Pw,{localizer:jw,events:Qe,startAccessor:"start",endAccessor:"end",view:$t,onView:ct,date:I,onNavigate:O,onSelectEvent:gt,onSelectSlot:Zt,onEventDrop:Ae!=="all"?Ne:void 0,onDragStart:Ae!=="all"?Ze:void 0,onDropFromOutside:Ae!=="all"?Dt:void 0,dragFromOutsideItem:Ae!=="all"?fs:void 0,draggableAccessor:N=>Ae!=="all"&&N.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:Pn,dayPropGetter:bi,components:Dc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:N=>`+${N} `}},`calendar-${Ae}-${(ee==null?void 0:ee.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ee&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:yt?ot(ee).format("MM DD (ddd)"):`${ot(ee).startOf("week").format("MM DD")} - ${ot(ee).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Jo[ot(ee).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Jo[ot(ee).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ae!=="all"&&a.jsxDEV("button",{onClick:()=>_(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Ge(null),en(null),_(!1),y("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:ur.length===0?a.jsxDEV("div",{className:"p-4",children:Ae!=="all"&&Ln?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:Q,onChange:N=>y(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Q.trim()){const U=ee||new Date,Y={id:"",title:Q.trim(),start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{_(!1),y("")}).catch(z=>{console.error("  :",z),ne.error("  ")})}else N.key==="Escape"&&(_(!1),y(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(Q.trim()){const N=ee||new Date,U={id:"",title:Q.trim(),start:N,end:N,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{_(!1),y("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{_(!1),y("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const N=ur.reduce((Y,z)=>{const le=ot(z.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(z),Y},{});return Object.keys(N).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!yt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:ot(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:N[Y].map(z=>{const le=z.assignedTo&&z.assignedTo.includes("HV LAB"),ge=z.assignedTo&&z.assignedTo.includes("")&&P&&["",""].includes(P),he=z.assignedTo&&z.assignedTo.includes("")&&P&&["","",""].includes(P),pt=z.assignedTo&&(z.assignedTo.includes((b==null?void 0:b.name)||"")||P&&z.assignedTo.includes(P))||le||ge||he,gs=!z.color&&!pt,Lt=!z.isASVisit&&!z.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Pt={...z,title:z.originalTitle||z.title};gt(Pt)},className:`p-3 cursor-pointer ${pt?"bg-yellow-50":""}`,style:gs?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:pt?"#FEF3C7":z.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:z.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),z.assignedTo&&z.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Es=>z.assignedTo.includes(Es))?"":z.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),z.projectName&&Ae==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:z.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Lt?a.jsxDEV("button",{onClick:Pt=>{Pt.stopPropagation(),en(z)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},z.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ae!=="all"&&Ln&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:Q,onChange:N=>y(N.target.value),onKeyDown:N=>{if(N.key==="Enter"&&Q.trim()){const U=ee||new Date,Y={id:"",title:Q.trim(),start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(Y).then(()=>{_(!1),y("")}).catch(z=>{console.error("  :",z),ne.error("  ")})}else N.key==="Escape"&&(_(!1),y(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(Q.trim()){const N=ee||new Date,U={id:"",title:Q.trim(),start:N,end:N,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};i(U).then(()=>{_(!1),y("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{_(!1),y("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),yt&&Ae!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:de.map(N=>a.jsxDEV("button",{onClick:async()=>{const U=ee||new Date;if(Ae!=="all"){const Y={id:"",title:N,start:U,end:U,project:Ae,attendees:b!=null&&b.name?[b.name]:[],type:"construction"};try{await i(Y)}catch(z){console.error("  :",z),ne.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),Z&&a.jsxDEV(ib,{event:ue,slotInfo:Ce,defaultProjectName:Ae!=="all"?Ae:void 0,onClose:()=>{ye(!1),fe(null),Me(null)},onSave:async N=>{console.log(" Schedule.tsx onSave called with newEvent:",N);try{if(ue)if(ue.id.startsWith("as-")){const U=ue.id.replace("as-","");let Y="";N.assignedTo&&Array.isArray(N.assignedTo)&&N.assignedTo.length>0?Y=N.assignedTo.join(", "):ue.assignedTo&&Array.isArray(ue.assignedTo)?Y=ue.assignedTo.join(", "):typeof ue.assignedTo=="string"&&(Y=ue.assignedTo),await m(U,{project:N.title||ue.title,assignedTo:Y,scheduledVisitDate:N.start,scheduledVisitTime:N.time||ue.time}),await d(),ye(!1)}else if(ue.id.startsWith("payment-")){const U=ue.id.split("-"),Y=U[1],z=U[2],le=f.find(ge=>ge.id===Y);if(le){const ge={...le.expectedPaymentDates};ge[z]=N.start,await h(Y,{expectedPaymentDates:ge})}}else{console.log(" Updating schedule with projectId:",N.projectId,"projectName:",N.projectName);let U=N.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(U=U.replace(Y,""),ue.mergedEventIds&&ue.mergedEventIds.length>0){console.log(" Updating merged schedules:",ue.mergedEventIds);const z=(ue.originalTitle||ue.title).split(", "),le=U.split(", ");for(let ge=0;ge<ue.mergedEventIds.length;ge++){const he=ue.mergedEventIds[ge],at=le[ge]||z[ge]||U;await o(he,{title:at.trim(),start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}}else await o(ue.id,{title:U,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName,location:"",attendees:N.assignedTo||[],description:N.description,time:N.time})}else{console.log(" Adding schedule with projectId:",N.projectId,"projectName:",N.projectName);const U={id:Date.now().toString(),title:N.title,start:N.start,end:N.end,type:"other",project:N.projectId||N.projectName||"",location:"",attendees:N.assignedTo||[],description:N.description||"",time:N.time||"-"};await i(U)}ye(!1)}catch(U){console.error("Failed to save schedule:",U),ne.error("  ")}},onDelete:async N=>{try{if(N.startsWith("payment-")){const U=N.split("-"),Y=U[1],z=U[2],le=f.find(ge=>ge.id===Y);if(le){const ge={...le.expectedPaymentDates};delete ge[z],await h(Y,{expectedPaymentDates:ge})}}else if(N.startsWith("as-")){const U=N.replace("as-","");await m(U,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const U=jt.find(Y=>Y.id===N);if(U!=null&&U.mergedEventIds&&U.mergedEventIds.length>0){console.log("Deleting merged schedules:",U.mergedEventIds);for(const Y of U.mergedEventIds)await l(Y)}else await l(N)}ye(!1)}catch(U){console.error("Failed to delete schedule:",U),ne.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),R&&te&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:q.x-50,top:q.y-15,backgroundColor:R.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:R.originalTitle||R.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Tn&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>en(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Tn.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>en(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const N=Tn.mergedEventIds||[Tn.id];await Promise.all(N.map(U=>l(U)))}catch(N){console.error("  :",N),ne.error(" ")}en(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),x&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{E(!1),k(null),L("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:N=>N.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{E(!1),k(null),L("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:N=>L(N.target.value),onKeyDown:N=>N.key==="Enter"&&Le(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Le,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:pe?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):M.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:M.map((N,U)=>a.jsxDEV("div",{draggable:(T==null?void 0:T.id)!==N.id,onDragStart:()=>it(U),onDragOver:Y=>St(Y,U),onDragEnd:nt,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ft===U?"opacity-50 bg-gray-100":""} ${Ht===U?"border-t-2 border-gray-400":""} ${(T==null?void 0:T.id)!==N.id?"cursor-grab active:cursor-grabbing":""}`,children:(T==null?void 0:T.id)===N.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:_e,onChange:Y=>Ue(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&ze(),Y.key==="Escape"&&(k(null),Ue(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:ze,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),Ue("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:U+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:N.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(N),Ue(N.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>bt(N.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),M.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},Mw=({projectName:s,onClose:e,type:t="cash"})=>{const n=t==="cash",r=n?"":"",i=n?"      .":"      .",[o,l]=A.useState({receiptDate:Ft(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],b=["","","",""],V=["","","","","","","","","",""];let v="",w=0;for(;f>0;){const B=f%1e4;if(B>0){let P="",F=B,oe=0;for(;F>0;){const se=F%10;se>0&&(P=V[se]+b[oe]+P),F=Math.floor(F/10),oe++}v=P+h[w]+v}f=Math.floor(f/1e4),w++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Xp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:n?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Ow="HVLabImageDB",Fw=1,jr="paymentRecordImages";let tl=null;const fd=()=>new Promise((s,e)=>{if(tl){s(tl);return}const t=indexedDB.open(Ow,Fw);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{tl=t.result,s(tl)},t.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains(jr)||r.createObjectStore(jr,{keyPath:"id"})}}),qw=async()=>{try{const s=await fd();return new Promise((e,t)=>{const i=s.transaction(jr,"readonly").objectStore(jr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(s){console.error("IndexedDB , localStorage :",s);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},$w=async(s,e)=>{try{const t=await fd();return new Promise((n,r)=>{const l=t.transaction(jr,"readwrite").objectStore(jr).put({id:s,images:e});l.onsuccess=()=>n(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},Ww=async s=>{try{const e=await fd();return new Promise((t,n)=>{const r=e.transaction(jr,"readwrite"),i=r.objectStore(jr);i.clear(),Object.entries(s).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),n(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},zw=async()=>{try{const s=localStorage.getItem("paymentRecordImages");if(s){const e=JSON.parse(s);Object.keys(e).length>0&&(await Ww(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(s){console.error(" :",s)}},sl=s=>{if(!s)return 0;try{const t=new Date(s).getTime();return isNaN(t)?0:t}catch{return 0}},Wp=(s,e,t)=>{if(!s)return null;try{const n=new Date(s);return isNaN(n.getTime())?null:Ft(n,e,t)}catch{return null}},Kw=()=>{const{payments:s,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:n,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=tr(),{user:l}=Mr(),u=dc(),[m,d]=A.useState(""),[f,h]=A.useState(null),[b,V]=A.useState(null),[v,w]=A.useState(!1),[B,P]=A.useState(!1),[F,oe]=A.useState(!1),[se,M]=A.useState(!1),[C,x]=A.useState(""),[E,j]=A.useState("form"),[L,T]=A.useState(!1),[k,_e]=A.useState(!1),Ue=A.useRef(null),[pe,je]=A.useState("pending"),[ft,qt]=A.useState("all"),[Ht,ae]=A.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[He,de]=A.useState(!1),[Le,ze]=A.useState(null),[bt,it]=A.useState(!1),[St,nt]=A.useState(""),[ut,ms]=A.useState(!1),K=A.useRef(!1),Te=A.useRef(!1),Re=A.useRef(null),[we,Ye]=A.useState([]),[Tt,$t]=A.useState([]),[ct,I]=A.useState(null),[O,Z]=A.useState([]),[ye,ue]=A.useState([]),[fe,Ce]=A.useState(!1),[Me,tt]=A.useState({}),[Ae,Rs]=A.useState(!1),jt=()=>{const _=localStorage.getItem("lastSelectedProject"),Q=u.filter(y=>y.status!=="completed");return _&&Q.some(y=>y.name===_)?_:Q.length>0?Q[0].name:""},[ee,Ge]=A.useState({project:"",date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});A.useEffect(()=>{(async()=>{try{const Q=await Zn.getAllContractors();Ye(Q.map(y=>({id:y._id||y.id,rank:y.rank,companyName:y.companyName,name:y.name,process:y.process,contact:y.contact,accountNumber:y.accountNumber,bankName:y.bankName,notes:y.notes,createdAt:new Date(y.createdAt),updatedAt:new Date(y.updatedAt)})))}catch(Q){console.error("Failed to load contractors:",Q)}})()},[]),A.useEffect(()=>{qt("all");const _=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);(async()=>{_&&(console.log("[]   - Firestore  "),await ap()),t().catch(R=>{console.error("Failed to load projects:",R)}),e().catch(R=>{console.error("Failed to load payments:",R)})})();const y=()=>{T(window.innerWidth<1024)};if(y(),window.addEventListener("resize",y),u.length>0&&!ee.project&&!Te.current){const R=jt();R&&(Ge(S=>({...S,project:R})),localStorage.setItem("lastSelectedProject",R))}return()=>window.removeEventListener("resize",y)},[]);const H=A.useRef(new Map);A.useEffect(()=>{console.log("[ ] Firestore  ...");const _=ln.subscribeToPayments(Q=>{console.log("[ ]  :",Q.length,""),Q.forEach(S=>{const q=String(S.id),J=H.current.get(q);if(J&&J!=="completed"&&S.status==="completed"){const W=s.find(G=>String(G.id)===q);(!W||W.status!=="completed")&&ne.success(`: ${S.project_name||""} ${S.item_name||""}`.trim(),{duration:4e3})}});const y=new Map;Q.forEach(S=>{y.set(String(S.id),S.status)}),H.current=y;const R=Q.map(S=>({id:String(S.id),project:S.project_name||"",purpose:S.description,process:S.vendor_name,itemName:S.item_name||"",amount:S.amount,materialAmount:S.material_amount||0,laborAmount:S.labor_amount||0,originalMaterialAmount:S.original_material_amount||0,originalLaborAmount:S.original_labor_amount||0,applyTaxDeduction:S.apply_tax_deduction===1,includesVAT:S.includes_vat===1,quickText:S.quick_text||"",images:(()=>{if(!S.images)return[];if(Array.isArray(S.images))return S.images;try{const q=JSON.parse(S.images);return Array.isArray(q)?q:[]}catch{return[]}})(),category:S.request_type,status:S.status,urgency:"normal",requestedBy:S.requester_name,requestDate:new Date(S.created_at),approvalDate:S.approved_at?new Date(S.approved_at):void 0,bankInfo:{accountHolder:S.account_holder||"",bankName:S.bank_name||"",accountNumber:S.account_number||""},attachments:[],notes:S.notes||"",completionDate:S.paid_at?new Date(S.paid_at):void 0}));if(Re.current)console.log("[ ]    -   :",Re.current);else{const S=R.filter(J=>J.status==="pending").length,q=R.filter(J=>J.status==="completed").length;console.log("[ ] Zustand  :",R.length," (:",S,", :",q,")"),tr.setState({payments:R})}});return()=>{console.log("[ ] Firestore  "),_()}},[]),A.useEffect(()=>{const _=async()=>{if(document.visibilityState==="visible"){if(Re.current){console.log("[]     - ");return}/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(console.log("[]  - Firestore  "),await ap())}};return document.addEventListener("visibilitychange",_),()=>{document.removeEventListener("visibilitychange",_)}},[]),A.useEffect(()=>{(async()=>{var R,S,q,J;if(K.current)return;const Q=new URLSearchParams(window.location.search),y=Q.get("complete")||Q.get("c");if(y){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",y),window.history.replaceState({},"","/payments"),Te.current=!0,j("list"),je("completed"),qt("all"),Ge(W=>({...W,project:""})),o(String(y),{status:"completed",completionDate:new Date}),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(y),{status:"completed"}),await e();const W=Rl.getSocket();W&&W.emit("payment:refresh",{paymentId:y,status:"completed",updatedAt:new Date().toISOString()})}catch(W){console.error("[ ]  :",W),o(String(y),{status:"pending",completionDate:void 0}),je("pending");let G="  ";((R=W.response)==null?void 0:R.status)===401?G=" .  ":((S=W.response)==null?void 0:S.status)===404?G="     (ID: "+y+")":(J=(q=W.response)==null?void 0:q.data)!=null&&J.error?G=W.response.data.error:W.message&&(G+=": "+W.message),ne.error(G)}}})()},[e,i,o,l]),A.useEffect(()=>{if(ee.process){const _=new Set(s.filter(S=>{var q;return S.status==="completed"&&((q=S.bankInfo)==null?void 0:q.accountHolder)}).map(S=>S.bankInfo.accountHolder.trim().toLowerCase())),Q=(S,q)=>{const J=S.toLowerCase(),W=q.toLowerCase();if(J.includes(W)||W.includes(J))return!0;const G=J.split("/").map(Oe=>Oe.trim()),te=W.replace(/$/,"").trim();for(const Oe of G)if(Oe===te||te.includes(Oe)||Oe.includes(te))return!0;return!1},R=we.filter(S=>{if(!Q(ee.process,S.process))return!1;const J=S.accountNumber&&S.accountNumber.trim()!=="",W=S.name.trim().toLowerCase(),G=_.has(W);return J||G}).sort((S,q)=>{const J=S.accountNumber&&S.accountNumber.trim()!=="",W=q.accountNumber&&q.accountNumber.trim()!=="";return J&&!W?-1:!J&&W?1:0});$t(R)}else $t([])},[ee.process,we,s]),A.useEffect(()=>{if(ee.process){const _=(R,S)=>{if(!S)return!1;const q=R.toLowerCase(),J=S.toLowerCase();if(q.includes(J)||J.includes(q))return!0;const W=q.split("/").map(te=>te.trim()),G=J.replace(/$/,"").trim();for(const te of W)if(te===G||G.includes(te)||te.includes(G))return!0;return!1},Q=s.filter(R=>{var S,q,J;return R.status==="completed"&&R.process&&_(ee.process,R.process)&&((S=R.bankInfo)==null?void 0:S.accountHolder)&&((q=R.bankInfo)==null?void 0:q.bankName)&&((J=R.bankInfo)==null?void 0:J.accountNumber)}),y=new Map;Q.forEach(R=>{const S=`${R.bankInfo.accountHolder}_${R.bankInfo.bankName}_${R.bankInfo.accountNumber}`;y.has(S)||y.set(S,{accountHolder:R.bankInfo.accountHolder,bankName:R.bankInfo.bankName,accountNumber:R.bankInfo.accountNumber,itemName:R.itemName||"",amount:R.amount||0})}),Z(Array.from(y.values()))}else Z([])},[ee.process,s]),A.useEffect(()=>{var Q;const _=((Q=ee.accountHolder)==null?void 0:Q.trim())||"";if(_.length>=1&&fe){const y=[],R=new Set;we.filter(S=>S.accountNumber&&S.accountNumber.trim()!=="").forEach(S=>{const q=S.name.trim(),J=q.toLowerCase(),W=_.toLowerCase();J.startsWith(W)&&!R.has(J)&&(R.add(J),y.push({name:q,bankName:S.bankName||"",accountNumber:S.accountNumber||"",source:"contractor"}))}),s.filter(S=>{var q;return S.status==="completed"&&((q=S.bankInfo)==null?void 0:q.accountHolder)}).forEach(S=>{const q=S.bankInfo.accountHolder.trim(),J=q.toLowerCase(),W=_.toLowerCase();J.startsWith(W)&&!R.has(J)&&(R.add(J),y.push({name:q,bankName:S.bankInfo.bankName||"",accountNumber:S.bankInfo.accountNumber||"",source:"payment"}))}),ue(y)}else ue([])},[ee.accountHolder,fe,we,s]);const be=_=>{const Q=_.split(`
`).map(W=>W.trim()).filter(W=>W),y={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},R=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],S=W=>{const G=["","","","","","","",""];for(const te of G)if(W.endsWith(te)&&W.length>te.length+1)return W.slice(0,-te.length);return W},q=W=>{if(!W||W.length<2||W.length>5||!/^[-]{2,5}$/.test(W)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(W)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(W))return!1;if(W.length>=2){const Oe=W.charAt(0),Ke=W.substring(0,2);if(["","","","","","",""].includes(Ke)||R.includes(Oe))return!0}return W.length>=2&&W.length<=4},J=Q.some(W=>W.includes(" ")||W.includes(""));if(Q.forEach((W,G)=>{if(W.includes("")&&W.includes(":")){const te=W.match(/\s*:\s*(.+)/);te&&(y.itemName=te[1].trim())}if(W.includes("")&&W.includes(":")){const te=W.match(/\s*:\s*(.+)/);te&&(y.bankInfo.accountHolder=te[1].trim())}if(W.includes("")&&W.includes(":")){const te=W.match(/\s*:\s*(.+)/);te&&(y.bankInfo.bankName=te[1].trim())}if(W.includes("")&&W.includes(":")){const te=W.match(/\s*:\s*(.+)/);te&&(y.bankInfo.accountNumber=te[1].trim())}if(W.includes("")&&W.includes(":")){const te=W.match(/\s*:\s*([\d,]+)?/);te&&(y.amounts.total=parseInt(te[1].replace(/,/g,"")))}}),!J){let W=-1;if(Q.forEach(G=>{const te=G.match(/\[([^\]]+)\]/);te&&!y.itemName&&(y.itemName=te[1].trim())}),Q.forEach((G,te)=>{if(G.includes("")||G.includes(" ")||G.includes("()")){y.includeVat=!0;const We=G.match(/(\d+)\s*\s*(\d+)\s*\s*?/),ke=G.match(/(\d+)\s*\s*?/),Qe=G.match(/([\d,]+)\s*/);if(We){const Je=parseInt(We[1])*1e4+parseInt(We[2])*1e3;y.amounts.total=Je}else if(ke){const Je=parseInt(ke[1])*1e4;y.amounts.total=Je}else if(Qe){const Je=parseInt(Qe[1].replace(/,/g,""));Je>=1e3&&(y.amounts.total=Je)}return}const Ke=G.match(/=\s*([\d,]+)\s*?/);let Fe=null;if(Ke){const We=parseInt(Ke[1].replace(/,/g,""));We>=1e3&&(y.amounts.total=We)}else{const We=G.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(We){const ke=parseInt(We[1])*1e4,Qe=parseInt(We[2])*1e3,Je=ke+Qe;G.includes("")||G.includes("")?y.amounts.material=Je:G.includes("")||G.includes("")?y.amounts.labor=Je:y.amounts.total||(y.amounts.total=Je),G=G.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Fe=We}else if(Fe=G.match(/(\d+)\s*\s*?/),Fe){const ke=parseInt(Fe[1])*1e4;G.includes("")||G.includes("")?y.amounts.material=ke:G.includes("")||G.includes("")?y.amounts.labor=ke:y.amounts.total||(y.amounts.total=ke),G=G.replace(/(\d+)\s*\s*?/g,"")}}G.includes("/")&&G.split("/").forEach(ke=>{const Qe=ke.trim();Qe.startsWith("[")||Qe.endsWith("]")||(/^[\d\-]+$/.test(Qe)&&Qe.replace(/\-/g,"").length>=10?y.bankInfo.accountNumber||(y.bankInfo.accountNumber=Qe):q(Qe)&&!y.bankInfo.accountHolder&&(y.bankInfo.accountHolder=Qe))});const Ne=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let Ze="",Yt=-1;for(const We of Ne){const ke=G.match(We);if(ke&&!y.bankInfo.accountNumber){Ze=ke[0],Yt=ke.index||-1,y.bankInfo.accountNumber=ke[0].trim().replace(/\s+/g,"-");const Je=G.substring(Yt+Ze.length).trim().split(/\s+/);for(const Nt of Je){if(Nt.startsWith("[")||Nt.endsWith("]"))continue;const Be=S(Nt);if(q(Be)){y.bankInfo.accountHolder=Be;break}}if(!y.bankInfo.accountHolder&&te>0){const Be=Q[te-1].split(/\s+/);for(const rt of Be){if(rt.startsWith("[")||rt.endsWith("]"))continue;const gt=S(rt);if(q(gt)){y.bankInfo.accountHolder=gt;break}}}if(!y.bankInfo.accountHolder&&te+1<Q.length){const Nt=Q[te+1],Be=Nt.split(/\s+/);for(const rt of Be){if(rt.startsWith("[")||rt.endsWith("]"))continue;const gt=S(rt);if(q(gt)){y.bankInfo.accountHolder=gt;break}}if(!y.bankInfo.accountHolder){const rt=Nt.match(/^([-]{2,6})/);if(rt){const gt=S(rt[1].trim());q(gt)&&(y.bankInfo.accountHolder=gt)}}}break}}const Dt=G.match(/[\d,]+/g);if(Dt){const We=Ze?Ze.split(/[\s\-]+/).filter(ke=>ke):[];Dt.forEach(ke=>{const Qe=parseInt(ke.replace(/,/g,"")),Je=ke.replace(/,/g,""),Nt=We.some(Be=>Be===Je);!y.bankInfo.accountNumber&&Je.length>=10&&Je.length<=20?(y.bankInfo.accountNumber=Je,Ze=Je):Qe>=1e3&&!Fe&&!Nt&&(G.includes("")||G.includes("")?y.amounts.material=Qe:G.includes("")||G.includes("")?y.amounts.labor=Qe:y.amounts.total||(y.amounts.total=Qe))})}const fs={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},Gt=Object.keys(fs).sort((We,ke)=>ke.length-We.length);for(const We of Gt)if(G.includes(We)){const ke=fs[We];y.bankInfo.bankName=ke,W=te;const Qe=new RegExp(`${We}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),Je=G.match(Qe);if(Je){const Nt=S(Je[1]);Nt&&!/^\d+$/.test(Nt)&&Nt!==""&&(y.bankInfo.accountHolder=Nt)}break}if(!y.bankInfo.bankName){const We=G.match(/([-]+)(|)/);We&&(y.bankInfo.bankName=We[0])}const Ys=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const We of Ys){const ke=G.match(We);if(ke&&!y.bankInfo.accountHolder){y.bankInfo.accountHolder=ke[0].trim();break}}const Gs=G.match(/\(([-]{2,5})\)/);if(Gs&&!y.bankInfo.accountHolder){const We=Gs[1];q(We)&&!["","",""].includes(We)&&(y.bankInfo.accountHolder=We)}if(!y.bankInfo.accountHolder){const We=/[-]{2,6}/g,ke=G.match(We);if(ke){const Qe=G.match(/\d{10,}/)||G.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),Je=G.match(/||||/);ke.forEach(Nt=>{const Be=S(Nt),rt=_.split(`
`)[te];if(rt&&rt.includes(`[${Nt}]`)||!q(Be)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Be))return;const Zt=G.indexOf(Nt);if(Zt>0){const is=G[Zt-1];if(/[-]/.test(is))return}if(Zt+Nt.length<G.length){const is=G[Zt+Nt.length];if(/[-]/.test(is))return}if(!(Gs&&Be===Gs[1])){if((Qe||Je)&&!y.bankInfo.accountHolder)y.bankInfo.accountHolder=Be;else if(!y.bankInfo.accountHolder){const is=/||||/,Pn=/\d{6,}/;(te>0&&(Pn.test(Q[te-1])||is.test(Q[te-1]))||te<Q.length-1&&(Pn.test(Q[te+1])||is.test(Q[te+1]))||is.test(G))&&(y.bankInfo.accountHolder=Be)}}})}}const Ot={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[We,ke]of Object.entries(Ot))if(G.includes(We)){y.vendor=ke;break}if(te===0&&!y.itemName){const We=G.replace(/[\[\]{}()<>]/g,"").trim();We&&!We.includes(" ")&&(q(We)||(y.itemName=We.substring(0,50)))}}),W>=0&&W+1<Q.length){const G=Q[W+1],te=G.trim();if(/^[-]{2,5}$/.test(te)&&q(te))y.bankInfo.accountHolder=te;else{const Oe=G.split(/\s+/);for(const Ke of Oe){const Fe=S(Ke);if(q(Fe)){y.bankInfo.accountHolder=Fe;break}}}}}if(y.itemName&&y.itemName.includes("")&&(y.vendor=""),y.itemName){const W=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],G=y.itemName.toLowerCase(),te=W.some(Ne=>G===Ne.toLowerCase()||G.startsWith(Ne.toLowerCase()+" ")||G.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Oe=/^[\d\-\s]/.test(y.itemName),Ke=/^\d{2,}[\s\-]?\d+/.test(y.itemName.replace(/[-]/g,"").trim()),Fe=y.bankInfo.accountHolder&&(y.itemName===y.bankInfo.accountHolder||y.itemName.includes(y.bankInfo.accountHolder));(te||Oe||Ke||Fe)&&(y.itemName=void 0)}return y},De=async()=>{var _,Q,y,R,S,q,J,W,G,te,Oe;try{const Ke=ee.quickText;if(!Ke.trim())return;let Fe=s;s.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(ke=>setTimeout(ke,100)),Fe=tr.getState().payments,console.log("payments  :",Fe.length,""));const Ne=be(Ke);console.log("  :",Ne);const Ze={project:ee.project,date:ee.date,quickText:ee.quickText,quickImages:ee.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};I(null),P(!1),oe(!1);let Yt=0;Ne.amounts.material&&(Yt+=Ne.amounts.material),Ne.amounts.labor&&(Yt+=Ne.amounts.labor),Ne.amounts.total&&!Ne.amounts.material&&!Ne.amounts.labor&&(Yt=Ne.amounts.total),Yt>0&&(Ze.amount=Yt),Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),Ne.bankInfo.accountHolder&&(Ze.accountHolder=Ne.bankInfo.accountHolder),Ne.bankInfo.accountNumber&&(Ze.accountNumber=Ne.bankInfo.accountNumber);const Dt=ke=>ke?ke.replace(/[^0-9]/g,""):"",fs=(ke,Qe)=>{if(!ke||!Qe)return!1;const Je=Dt(ke),Nt=Dt(Qe);if(!Je||!Nt)return!1;const Be=6;return Je.length<Be||Nt.length<Be?Je===Nt:Nt.includes(Je)||Je.includes(Nt)},Gt=Dt(Ne.bankInfo.accountNumber||""),Ys=Ne.bankInfo.accountHolder||"";let Gs=!1;console.log("===    ==="),console.log(" :",Ne.bankInfo.accountNumber),console.log(" :",Gt),console.log(" :",Ys),console.log(" :",we.length),console.log("  :",Fe.filter(ke=>ke.status==="completed").length);let Ot=we.find(ke=>{const Qe=Dt(ke.accountNumber||"");return Qe&&Qe===Gt});if(!Ot&&Gt&&(Ot=we.find(ke=>{const Qe=Dt(ke.accountNumber||"");return fs(Gt,Qe)})),Ot&&(Gs=!0),!Ot&&Ys&&(Ot=we.find(ke=>ke.name===Ys),Ot)){console.log("  :",Ot.name);const ke=((_=Ot.accountNumber)==null?void 0:_.replace(/[-\s]/g,""))||"";Gt&&!fs(Gt,ke)?(console.log("    ( ) -  "),Gs=!1):Gs=!0}if(Ot&&(Ot.name&&(Ze.accountHolder=Ot.name,console.log("  :",Ot.name)),Ot.bankName?Ze.bankName=Ot.bankName:Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),Gs&&(Ze.accountNumber=Ot.accountNumber||Ne.bankInfo.accountNumber),I(Ot.id||Ot._id||null),Ot.process&&(Ze.process=Ot.process)),!Ot){let ke=!1;console.log("===     ==="),console.log("  payments :",Fe.length,""),console.log(" :",Gt),console.log(" :",Ys);const Qe=Fe.filter(rt=>rt.status==="completed");console.log(" :",Qe.length);const Je=[...new Set(Qe.map(rt=>{var gt;return(gt=rt.bankInfo)==null?void 0:gt.accountHolder}).filter(Boolean))];console.log("   ( 20):",Je.slice(0,20)),console.log("  ():",Gt);const Nt=Qe.filter(rt=>{var gt;return(gt=rt.bankInfo)==null?void 0:gt.accountNumber}).map(rt=>{var gt,Zt,is;return{holder:(gt=rt.bankInfo)==null?void 0:gt.accountHolder,account:(Zt=rt.bankInfo)==null?void 0:Zt.accountNumber,clean:Dt(((is=rt.bankInfo)==null?void 0:is.accountNumber)||"")}}).filter(rt=>rt.clean.includes(Gt.substring(0,6))||Gt.includes(rt.clean.substring(0,6)));console.log("  :",Nt);let Be=Fe.find(rt=>{var is;const gt=Dt(((is=rt.bankInfo)==null?void 0:is.accountNumber)||"");return gt&&gt===Gt&&rt.status==="completed"});if(Be&&console.log("   :",(Q=Be.bankInfo)==null?void 0:Q.accountHolder,Be.process),!Be&&Gt&&(Be=Fe.find(rt=>{var Zt;const gt=Dt(((Zt=rt.bankInfo)==null?void 0:Zt.accountNumber)||"");return fs(Gt,gt)&&rt.status==="completed"}),Be&&console.log("   :",(y=Be.bankInfo)==null?void 0:y.accountHolder,Be.process)),Be&&(ke=!0),!Be&&Ys&&(Be=Fe.find(rt=>{var gt;return((gt=rt.bankInfo)==null?void 0:gt.accountHolder)===Ys&&rt.status==="completed"}),Be)){console.log("    :",(R=Be.bankInfo)==null?void 0:R.accountHolder,":",Be.process);const rt=Dt(((S=Be.bankInfo)==null?void 0:S.accountNumber)||"");Gt&&!fs(Gt,rt)?(console.log("    ( ) -  "),ke=!1):ke=!0}Be?(console.log(" :",{accountHolder:(q=Be.bankInfo)==null?void 0:q.accountHolder,accountNumber:(J=Be.bankInfo)==null?void 0:J.accountNumber,bankName:(W=Be.bankInfo)==null?void 0:W.bankName,process:Be.process,status:Be.status,paymentMatchedByAccountNumber:ke}),(G=Be.bankInfo)!=null&&G.accountHolder&&(Ze.accountHolder=Be.bankInfo.accountHolder,console.log("  :",Be.bankInfo.accountHolder)),(te=Be.bankInfo)!=null&&te.bankName?Ze.bankName=Be.bankInfo.bankName:Ne.bankInfo.bankName&&(Ze.bankName=Ne.bankInfo.bankName),ke&&(Ze.accountNumber=((Oe=Be.bankInfo)==null?void 0:Oe.accountNumber)||Ne.bankInfo.accountNumber),Be.process&&!Ze.process?(Ze.process=Be.process,console.log("    :",Be.process)):console.log("   - process:",Be.process,"updatedFormData.process:",Ze.process)):console.log("  ")}if(Ne.vendor&&(Ze.process=Ne.vendor),!Ze.process){const ke=Ke.toLowerCase();for(const Qe of Xc)if(ke.includes(Qe.toLowerCase())){Ze.process=Qe;break}}Ne.itemName&&(Ze.itemName=Ne.itemName),Ge(Ze),Ne.includeVat&&(P(!0),oe(!1));const We=[];if(Ne.amounts.material||Ne.amounts.labor||Ne.amounts.total){const ke=[];Ne.amounts.material&&ke.push(`: ${Ne.amounts.material.toLocaleString()}`),Ne.amounts.labor&&ke.push(`: ${Ne.amounts.labor.toLocaleString()}`),Ne.amounts.total&&!Ne.amounts.material&&!Ne.amounts.labor&&ke.push(`: ${Ne.amounts.total.toLocaleString()}`),We.push(ke.join(", "))}if(Ne.bankInfo.bankName||Ne.bankInfo.accountHolder){const ke=[];Ne.bankInfo.bankName&&ke.push(Ne.bankInfo.bankName),Ne.bankInfo.accountHolder&&ke.push(Ne.bankInfo.accountHolder),Ne.bankInfo.accountNumber&&ke.push(Ne.bankInfo.accountNumber),ke.length>0&&We.push(`: ${ke.join(" ")}`)}Ne.vendor&&We.push(`: ${Ne.vendor}`),Ne.includeVat&&We.push("  "),We.length>0?ne.success(`  !
${We.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):ne.info("  ...    .")}catch(Ke){console.error(" :",Ke),ne.error("   .")}};A.useEffect(()=>{(async()=>{try{await zw();const Q=await qw();tt(Q),Rs(!0)}catch(Q){console.error("  :",Q),Rs(!0)}})()},[]);const Pe=A.useRef({});A.useEffect(()=>{Ae&&(Object.entries(Me).forEach(([_,Q])=>{JSON.stringify(Pe.current[_])!==JSON.stringify(Q)&&$w(_,Q).catch(y=>{console.error("  :",y),ne.error("  ")})}),Pe.current={...Me})},[Me,Ae]);const me=A.useCallback(async _=>{var R;const Q=(R=_.clipboardData)==null?void 0:R.items;if(!Q)return;let y=!1;for(let S=0;S<Q.length;S++)if(Q[S].type.indexOf("image")!==-1){y=!0;break}if(y){if(!f){const S=document.activeElement;(S==null?void 0:S.tagName)==="INPUT"||(S==null?void 0:S.tagName)==="TEXTAREA"||(S==null?void 0:S.classList.contains("form-input"))||ne.error("  ");return}for(let S=0;S<Q.length;S++)if(Q[S].type.indexOf("image")!==-1){_.preventDefault();const q=Q[S].getAsFile();if(q){const J=new FileReader;J.onload=async W=>{var te;const G=(te=W.target)==null?void 0:te.result;if(G)try{const Oe=s.find(Ne=>Ne.id===f),Fe=[...(Oe==null?void 0:Oe.images)||Me[f]||[],G];await ln.updatePaymentImages(f,Fe),tt(Ne=>({...Ne,[f]:Fe})),await e(),ne.success(" ")}catch(Oe){console.error("  :",Oe),ne.error("  ")}},J.readAsDataURL(q)}}}},[f,s,Me,e]);A.useEffect(()=>(document.addEventListener("paste",me),()=>document.removeEventListener("paste",me)),[me]);const mt=[...(l==null?void 0:l.name)===""?s.filter(_=>u.some(Q=>Q.name===_.project)):s].sort((_,Q)=>new Date(Q.requestDate).getTime()-new Date(_.requestDate).getTime()),Wt=mt.filter(_=>{var q,J,W;if(!_||!_.id)return!1;const Q=m===""||((q=_.purpose)==null?void 0:q.toLowerCase().includes(m.toLowerCase()))||((J=_.itemName)==null?void 0:J.toLowerCase().includes(m.toLowerCase()))||((W=_.process)==null?void 0:W.toLowerCase().includes(m.toLowerCase())),y=pe==="pending"?_.status!=="completed":_.status==="completed",R=ft==="all"||!ft||_.project===ft,S=!Ht||pe!=="completed"||_.requestedBy===(l==null?void 0:l.username);return Q&&y&&R&&S}).sort((_,Q)=>!_&&!Q?0:_?Q?pe==="completed"?sl(Q.completionDate)-sl(_.completionDate):sl(Q.requestDate)-sl(_.requestDate):-1:1),At=_=>{const Q=_.id||_._id||null;if(ct===Q){I(null);const q=document.querySelector('input[placeholder=" "]');q&&setTimeout(()=>{q.focus()},100);return}I(Q);const y=Xo(_.name);let R=_.bankName||"",S=_.accountNumber||"";if(S&&!R){const q=S.trim().split(/\s+/);if(q.length>=2){const J=q[0];(J.includes("")||J.includes("")||J.includes("")||J.includes("")||J.includes(""))&&(R=J,S=q.slice(1).join(""))}}Ge(q=>({...q,accountHolder:y,bankName:R,accountNumber:S}))};Wt.reduce((_,Q)=>{const y=Q.materialAmount||0,R=Q.laborAmount||0,S=Q.amount||0;let q=y,J=R,W=0;return y===0&&R===0&&S>0?Q.includesVAT?(q=Math.round(S/1.1),W=S-q):(q=S,W=0):Q.includesVAT?(y>0&&(q=Math.round(y/1.1)),R>0&&(J=Math.round(R/1.1)),W=S-(q+J)):W=0,_.material+=q,_.labor+=J,_.vat+=W,_.total+=S,_},{material:0,labor:0,vat:0,total:0});const ds=async()=>{var Q,y,R;if(ut){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ee),!ee.project){ne.error(" ");return}if(!ee.itemName){ne.error(" ");return}const _=Number(ee.amount)||0;if(_===0){ne.error(" ");return}ms(!0);try{const S=F?Math.round(_*.967):_,q=new Date;if(b){const J={project:ee.project,requestDate:new Date(ee.date),purpose:ee.itemName,amount:S,category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:S,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,updatedAt:q};console.log(" Updating payment:",J),await i(b,J),ne.success(" "),V(null)}else{const J=ee.project||"",W={id:`payment_${Date.now()}`,project:J,requestDate:new Date(ee.date),requestedBy:(l==null?void 0:l.username)||"  ",purpose:ee.itemName,amount:S,status:"pending",category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:F,materialAmount:S,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,quickText:ee.quickText||"",images:ee.quickImages,attachments:[],createdAt:q,updatedAt:q};console.log(" Creating payment:",W),console.log(" Images in payment:",((Q=ee.quickImages)==null?void 0:Q.length)||0,"");const G=await n(W);if(Re.current=G,setTimeout(()=>{Re.current=null},1e4),ne.success(" "),ee.accountHolder&&ee.bankName&&ee.accountNumber){const te=B||F?"01074088864":"01089423283";try{await ln.sendTossPaymentSms({recipientPhone:te,accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber,amount:S,projectName:J,itemName:ee.itemName,process:ee.process,paymentId:G}),ne.success("   ")}catch(Oe){console.error("SMS  :",Oe),ne.error("  : "+(((R=(y=Oe.response)==null?void 0:y.data)==null?void 0:R.error)||Oe.message||"   "))}}}Ge(J=>({project:J.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),P(!1),oe(!1),I(null),window.innerWidth<768&&j("list")}catch(S){console.error(" Payment save error:",S),ne.error("  : "+S.message)}finally{ms(!1)}},ss=_=>{var Q,y,R,S;try{console.log("[handleEdit] Starting edit for payment:",_.id);const q=_.originalMaterialAmount!==void 0?_.originalMaterialAmount:_.materialAmount||0,J=_.originalLaborAmount!==void 0?_.originalLaborAmount:_.laborAmount||0,W={project:_.project||"",date:_.requestDate?Ft(new Date(_.requestDate),"yyyy-MM-dd"):Ft(new Date,"yyyy-MM-dd"),process:_.process||"",itemName:_.itemName||_.purpose||"",materialCost:q>0?q.toString():"",laborCost:J>0?J.toString():"",amount:((Q=_.amount)==null?void 0:Q.toString())||"",accountHolder:((y=_.bankInfo)==null?void 0:y.accountHolder)||"",bankName:((R=_.bankInfo)==null?void 0:R.bankName)||"",accountNumber:((S=_.bankInfo)==null?void 0:S.accountNumber)||"",images:_.attachments||[],quickText:_.quickText||"",quickImages:_.images||[]};console.log("[handleEdit] Setting form data:",W),Ge(W),P(_.includesVAT||!1),oe(_.applyTaxDeduction||!1),h(_.id),V(_.id),L&&j("form"),console.log("[handleEdit] Edit setup complete"),ne.success("  ")}catch(q){console.error("[handleEdit] Error:",q),ne.error("     ")}},Ts=async _=>{var Q,y,R;try{const S=((Q=_.bankInfo)==null?void 0:Q.accountHolder)||_.accountHolder,q=((y=_.bankInfo)==null?void 0:y.bankName)||_.bank,J=((R=_.bankInfo)==null?void 0:R.accountNumber)||_.accountNumber;if(!S||!q||!J){ne.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${q}
: ${J}
: ${_.amount.toLocaleString()}`))return;const G=J.replace(/[-\s]/g,""),te=h1[q]||q,Oe=p1[q]||"004",Ke="",Fe=`supertoss://send?amount=${_.amount}&bankCode=${Oe}&bank=${encodeURIComponent(te)}&accountNo=${G}&receiverName=${encodeURIComponent(Ke)}&toName=${encodeURIComponent(Ke)}`;let Ne=!1;try{window.location.href=Fe,Ne=!0,ne.success("  ...",{duration:3e3}),setTimeout(()=>{const Ze=/iPhone|iPad|iPod/i.test(navigator.userAgent),Yt=/Android/i.test(navigator.userAgent);(Ze||Yt)&&ne(`      .

: 
: ${J}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(Ze){console.error("   :",Ze),ne(`   .

: 
: ${q}
: ${J}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(S){console.error(" :",S),ne.error(`   : ${S.message}`)}},fn=async _=>{const Q=s.find(y=>y.id===_);if(Q&&Q.quickText){const y=localStorage.getItem("executionMemos"),R=y?JSON.parse(y):{};R[_]=Q.quickText,localStorage.setItem("executionMemos",JSON.stringify(R))}o(_,{status:"completed",completionDate:new Date}),de(!1),je("completed"),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(_,{status:"completed"});const y=Rl.getSocket();y&&y.emit("payment:refresh",{paymentId:_,status:"completed",projectName:(Q==null?void 0:Q.project)||"",itemName:(Q==null?void 0:Q.itemName)||(Q==null?void 0:Q.purpose)||"",completedBy:(l==null?void 0:l.username)||""})}catch(y){console.error(" API :",y),o(_,{status:"pending",completionDate:void 0}),je("pending"),ne.error("   -  ")}},Qs=async _=>{var R;if(!f){ne.error("  ");return}const y=Array.from(((R=_.target)==null?void 0:R.files)||[]).filter(S=>S.type.startsWith("image/"));if(y.length!==0){try{const S=await Promise.all(y.map(G=>new Promise((te,Oe)=>{const Ke=new FileReader;Ke.onload=Fe=>{var Ze;const Ne=(Ze=Fe.target)==null?void 0:Ze.result;Ne?te(Ne):Oe(new Error("  "))},Ke.onerror=()=>Oe(new Error("FileReader ")),Ke.readAsDataURL(G)}))),q=s.find(G=>G.id===f),W=[...(q==null?void 0:q.images)||Me[f]||[],...S];await ln.updatePaymentImages(f,W),tt(G=>({...G,[f]:W})),await e(),ne.success(`${S.length}  `)}catch(S){console.error("  :",S),ne.error("  ")}_.target.value=""}},pn=async _=>{if(f)try{const Q=s.find(S=>S.id===f),R=((Q==null?void 0:Q.images)||Me[f]||[]).filter((S,q)=>q!==_);await ln.updatePaymentImages(f,R),tt(S=>({...S,[f]:R})),await e()}catch(Q){console.error("  :",Q),ne.error("  ")}},Kr=_=>{x(_),M(!0)},Tn=_=>{_.preventDefault(),w(!0)},en=_=>{_.preventDefault(),w(!1)},Ln=async _=>{if(_.preventDefault(),w(!1),!f){ne.error("  ");return}const y=Array.from(_.dataTransfer.files).filter(R=>R.type.startsWith("image/"));if(y.length!==0)try{const R=await Promise.all(y.map(W=>new Promise((G,te)=>{const Oe=new FileReader;Oe.onload=Ke=>{var Ne;const Fe=(Ne=Ke.target)==null?void 0:Ne.result;Fe?G(Fe):te(new Error("  "))},Oe.onerror=()=>te(new Error("FileReader ")),Oe.readAsDataURL(W)}))),S=s.find(W=>W.id===f),J=[...(S==null?void 0:S.images)||Me[f]||[],...R];await ln.updatePaymentImages(f,J),tt(W=>({...W,[f]:J})),await e(),ne.success(`${R.length}  `)}catch(R){console.error("  :",R),ne.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ee.project,onChange:_=>{Ge({...ee,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2493,columnNumber:35},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2495,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2483,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2482,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2504,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2514,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2524,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2503,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2502,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2501,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${E!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ee.project,onChange:_=>{Ge({...ee,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2559,columnNumber:43},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2561,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2549,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:_=>Ge({...ee,bankName:_.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2569,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2570,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2571,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2572,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2573,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2574,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2575,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2576,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2577,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2578,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2579,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2580,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2581,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2564,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2548,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ee.quickText,onChange:_=>Ge({...ee,quickText:_.target.value}),onPaste:_=>{var y;const Q=(y=_.clipboardData)==null?void 0:y.items;if(Q){for(let R=0;R<Q.length;R++)if(Q[R].type.indexOf("image")!==-1){_.preventDefault();const S=Q[R].getAsFile();if(S){const q=new FileReader;q.onload=J=>{var G;const W=(G=J.target)==null?void 0:G.result;Ge(te=>({...te,quickImages:[...te.quickImages,W]}))},q.readAsDataURL(S)}break}}},onDragOver:_=>{_.preventDefault(),_.stopPropagation()},onDrop:_=>{_.preventDefault(),_.stopPropagation(),Array.from(_.dataTransfer.files).filter(R=>R.type.startsWith("image/")).forEach(R=>{const S=new FileReader;S.onload=q=>{var W;const J=(W=q.target)==null?void 0:W.result;Ge(G=>({...G,quickImages:[...G.quickImages,J]}))},S.readAsDataURL(R)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:L?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2588,columnNumber:15},void 0),ee.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ee.quickImages.map((_,Q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:_,alt:` ${Q+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2643,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Ge(y=>({...y,quickImages:y.quickImages.filter((R,S)=>S!==Q)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2648,columnNumber:23},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2642,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2640,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_=>{Array.from(_.target.files||[]).forEach(y=>{const R=new FileReader;R.onload=S=>{var J;const q=(J=S.target)==null?void 0:J.result;Ge(W=>({...W,quickImages:[...W.quickImages,q]}))},R.readAsDataURL(y)}),_.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2667,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2688,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2666,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:De,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2692,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2665,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2587,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ee.date&&`(${Ft(new Date(ee.date),"E",{locale:xs})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2705,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ee.date,onChange:_=>Ge({...ee,date:_.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2708,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2704,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2724,columnNumber:17},void 0),a.jsxDEV("button",{ref:Ue,type:"button",onClick:()=>_e(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ee.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2731,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2725,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2723,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2703,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ee.itemName,onChange:_=>Ge({...ee,itemName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2739,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2750,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ee.amount?Number(ee.amount).toLocaleString():"",onChange:_=>{const Q=_.target.value.replace(/[^0-9]/g,"");Ge({...ee,amount:Q})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2752,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2763,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2751,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2749,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{B||oe(!1),P(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2781,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2780,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{F||P(!1),oe(!F)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${F?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:F&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2799,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2798,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2801,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2748,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Tt.length>0||O.length>0&&!ct)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Tt.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2817,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Tt.map(_=>{const Q=_.id||_._id,y=ct===Q;return a.jsxDEV("button",{type:"button",onClick:()=>At(_),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${y?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Xo(_.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2833,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName||""," ",_.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2836,columnNumber:29},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2823,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2818,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2814,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${O.length===0||ct?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2849,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:O.map((_,Q)=>a.jsxDEV("button",{type:"button",onClick:()=>{Ge(y=>({...y,accountHolder:_.accountHolder,bankName:_.bankName,accountNumber:_.accountNumber})),Z([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:_.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2866,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName," ",_.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2869,columnNumber:27},void 0)]},Q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2852,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2846,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2812,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2881,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountHolder,onChange:_=>Ge({...ee,accountHolder:_.target.value}),onFocus:()=>Ce(!0),onBlur:()=>setTimeout(()=>Ce(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2882,columnNumber:17},void 0),fe&&ye.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:ye.map((_,Q)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:y=>y.preventDefault(),onClick:()=>{let y=_.bankName||"",R=_.accountNumber||"";const S=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],q={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const J of S)if(R.includes(J)){y||(y=q[J]||J),R=R.replace(J,"").trim();break}for(const J of S)if(y.includes(J)){const W=q[J]||J,G=y.replace(J,"").trim();G&&/\d/.test(G)&&(R=G),y=W;break}R=R.replace(/[^\d\-]/g,"").trim(),Ge({...ee,accountHolder:_.name,bankName:y||ee.bankName,accountNumber:R||ee.accountNumber}),Ce(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:_.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2982,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:_.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2983,columnNumber:25},void 0)]},`${_.name}-${Q}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2895,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2893,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2880,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2994,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:_=>Ge({...ee,bankName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3e3,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3001,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3002,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3003,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3004,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3005,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3006,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3007,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3008,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3009,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3010,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3011,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3013,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3014,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3015,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3017,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3018,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3019,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3021,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3022,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2995,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2993,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountNumber,onChange:_=>Ge({...ee,accountNumber:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3028,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3039,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||F)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",F&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3042,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const _=Number(ee.amount)||0;let Q=_;return F&&(Q=Math.round(_*.967)),Q.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3046,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3040,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3038,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[b&&a.jsxDEV("button",{onClick:()=>{V(null),Ge(_=>({project:_.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),P(!1),oe(!1),I(null),ne.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3065,columnNumber:19},void 0),a.jsxDEV("button",{onClick:_=>{console.log(" Payment button clicked!",_),console.log(" Button element:",_.currentTarget),console.log(" Form data:",ee),ds()},disabled:ut,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ut?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ut?"...":b?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3094,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3063,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2809,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2545,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${E!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>je("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:mt.filter(_=>_&&_.id&&_.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3133,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3124,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{je("completed"),Ge(_=>({..._,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${pe==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${pe==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:mt.filter(_=>_&&_.id&&_.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3152,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3139,columnNumber:17},void 0),pe==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ht,onChange:_=>{ae(_.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(_.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3161,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3160,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3123,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3122,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3121,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3176,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:Wt.length>0?a.jsxDEV("div",{className:"space-y-4",children:Wt.map(_=>{var J,W,G;const Q=_.amount||0,y=((J=_.bankInfo)==null?void 0:J.accountHolder)||_.accountHolder||"",R=((W=_.bankInfo)==null?void 0:W.bankName)||_.bank||"",S=((G=_.bankInfo)==null?void 0:G.accountNumber)||_.accountNumber||"",q=y&&R&&S?`${y} | ${R} ${S}`:" ";return a.jsxDEV("div",{onClick:()=>h(_.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===_.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[_.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",_.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3208,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:_.purpose||_.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3210,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3206,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:_.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3214,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3205,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[Q.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3217,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[_.requestedBy||"-","  ",Wp(_.requestDate,"MM/dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3220,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3216,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3204,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3228,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3229,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3230,columnNumber:25},void 0),_.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3233,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3234,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3232,columnNumber:27},void 0),_.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3239,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3240,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3238,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3227,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:q},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:te=>{te.stopPropagation(),ss(_)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(LN,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3259,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async te=>{te.stopPropagation(),window.confirm("  ?")&&(await r(_.id),ne.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ii,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3272,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3261,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3246,columnNumber:23},void 0),pe==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:te=>{if(te.stopPropagation(),_.status==="completed"){ne.info("   ");return}Ts(_)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${_.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:_.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3281,columnNumber:27},void 0),a.jsxDEV("button",{onClick:te=>{te.stopPropagation(),fn(_.id)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${_.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:_.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:te=>{_.status!=="completed"&&(te.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:te=>{_.status!=="completed"&&(te.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3299,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3280,columnNumber:25},void 0)]},_.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3194,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3180,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3330,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3178,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3117,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${E!=="image"?"hidden lg:flex":""}`,onDragOver:Tn,onDragLeave:en,onDrop:Ln,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:Qs,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3346,columnNumber:11},void 0),L&&f&&E==="image"&&(()=>{const _=mt.find(Q=>Q.id===f);return _?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:_.purpose||_.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3363,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[_.process||"-","  ",Wp(_.requestDate,"yyyy.MM.dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3364,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3362,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(_.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3368,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3361,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3360,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:_=>{var y;const Q=_.target;if(!Q.closest("img")&&!Q.closest("button")&&f){const R=mt.find(W=>W.id===f),S=(R==null?void 0:R.images)||[],q=Me[f]||[];(S.length>0?S:q).length>0&&((y=document.getElementById("image-file-input"))==null||y.click())}},children:f?(()=>{const _=mt.find(S=>S.id===f),Q=(_==null?void 0:_.images)||[],y=Me[f]||[],R=Q.length>0?Q:y;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3404,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(_==null?void 0:_.quickText)||(_==null?void 0:_.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3405,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3403,columnNumber:19},void 0),R.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:R.map((S,q)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:S,alt:` ${q+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:J=>{J.stopPropagation(),Kr(S)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3419,columnNumber:27},void 0),a.jsxDEV("button",{onClick:J=>{J.stopPropagation(),pn(q)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(vs,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3435,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3428,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[q+1,"/",R.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3437,columnNumber:27},void 0)]},q,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3418,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3416,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${R.length>0?"":"flex-1"}`,onClick:S=>S.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${R.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(tu,{className:`mx-auto text-gray-400 mb-1 ${R.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3456,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:R.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3457,columnNumber:23},void 0),R.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3451,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3446,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3401,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(jo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3470,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3471,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3469,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3378,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3338,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2539,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3486,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3491,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3487,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3485,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Xc.map(_=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:_}),_e(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ee.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3498,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3496,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),_e(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3495,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3484,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3483,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>_e(!1),children:a.jsxDEV("div",{onClick:_=>_.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:Ue.current?`${Ue.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:Ue.current?`${Ue.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3539,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>_e(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3544,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3540,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3538,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Xc.map(_=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:_}),_e(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ee.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3551,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3549,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),_e(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3568,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3548,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3530,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3481,columnNumber:9},void 0),se&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>M(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:_=>{_.stopPropagation(),M(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(vs,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3597,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3590,columnNumber:13},void 0),a.jsxDEV("img",{src:C,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:_=>_.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3599,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3589,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3585,columnNumber:9},void 0),bt&&a.jsxDEV(Mw,{projectName:St,onClose:()=>it(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3611,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2480,columnNumber:5},void 0)},Xr=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),hn={async getSpaces(s){const e=qe(re,"finish_check_spaces");let t;s?t=xt(e,js("project_id","==",s)):t=xt(e);const r=(await wt(t)).docs.sort((o,l)=>(o.data().display_order||0)-(l.data().display_order||0)),i=[];for(const o of r){const l=o.data(),u=qe(re,"finish_check_items"),m=xt(u,js("space_id","==",o.id)),f=(await wt(m)).docs.sort((b,V)=>(b.data().display_order||0)-(V.data().display_order||0)),h=[];for(const b of f){const V=b.data(),v=qe(re,"finish_check_images"),w=xt(v,js("item_id","==",b.id)),P=(await wt(w)).docs.map(F=>({id:F.id,item_id:b.id,filename:F.data().filename||null,created_at:Xr(F.data().created_at)}));h.push({id:b.id,space_id:o.id,content:V.content||"",is_completed:V.is_completed||0,is_priority:V.is_priority||0,completed_at:V.completed_at?Xr(V.completed_at):null,display_order:V.display_order||0,created_at:Xr(V.created_at),updated_at:Xr(V.updated_at),images:P})}i.push({id:o.id,name:l.name||"",project_id:l.project_id||null,display_order:l.display_order||0,created_at:Xr(l.created_at),updated_at:Xr(l.updated_at),items:h})}return i},async createSpace(s,e){const t=qe(re,"finish_check_spaces"),n=xt(t,js("project_id","==",e)),i=(await wt(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={name:s,project_id:e,display_order:i+1,created_at:os(),updated_at:os()};return{id:(await Wn(t,o)).id,name:s,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(s,e){const t=Se(re,"finish_check_spaces",s);await Bt(t,{name:e,updated_at:os()})},async deleteSpace(s){const e=qe(re,"finish_check_items"),t=xt(e,js("space_id","==",s)),n=await wt(t);for(const r of n.docs){const i=qe(re,"finish_check_images"),o=xt(i,js("item_id","==",r.id)),l=await wt(o);for(const u of l.docs)await Us(Se(re,"finish_check_images",u.id));await Us(Se(re,"finish_check_items",r.id))}await Us(Se(re,"finish_check_spaces",s))},async createItem(s,e){const t=qe(re,"finish_check_items"),n=xt(t,js("space_id","==",s)),i=(await wt(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:os(),updated_at:os()};return{id:(await Wn(t,o)).id,space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(s,e){const t=Se(re,"finish_check_items",s);await Bt(t,{content:e,updated_at:os()})},async deleteItem(s){const e=qe(re,"finish_check_images"),t=xt(e,js("item_id","==",s)),n=await wt(t);for(const r of n.docs)await Us(Se(re,"finish_check_images",r.id));await Us(Se(re,"finish_check_items",s))},async toggleItem(s){const e=Se(re,"finish_check_items",s),t=await It(e);if(!t.exists())throw new Error("   .");const n=t.data(),r=n.is_completed?0:1;return await Bt(e,{is_completed:r,completed_at:r?os():null,updated_at:os()}),{id:s,space_id:n.space_id,content:n.content,is_completed:r,is_priority:n.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:n.display_order||0,created_at:Xr(n.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(s){const e=Se(re,"finish_check_items",s),t=await It(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await Bt(e,{is_priority:r,updated_at:os()}),{is_priority:r}},async getImageData(s){const e=Se(re,"finish_check_images",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{image_data:n.image_url||n.image_data||""}},async uploadImage(s,e,t){const n=qe(re,"finish_check_images"),r={item_id:s,image_data:"",image_url:"",filename:t,created_at:os()},i=await Wn(n,r);let o=e;if(to(e)){const l=await Yy("finish_check",i.id,e);await Bt(i,{image_url:l,image_data:""}),o=l}else await Bt(i,{image_data:e});return{id:i.id,item_id:s,image_data:o,filename:t,created_at:new Date().toISOString()}},async deleteImage(s){const e=Se(re,"finish_check_images",s),t=await It(e);if(t.exists()){const n=t.data();n.image_url&&await Gy(n.image_url)}await Us(e)}},vn={getSpaces:s=>hn.getSpaces(s),createSpace:(s,e)=>hn.createSpace(s,e),updateSpace:(s,e)=>hn.updateSpace(String(s),e),deleteSpace:s=>hn.deleteSpace(String(s)),createItem:(s,e)=>hn.createItem(String(s),e),updateItem:(s,e)=>hn.updateItem(String(s),e),deleteItem:s=>hn.deleteItem(String(s)),toggleItem:s=>hn.toggleItem(String(s)),togglePriority:s=>hn.togglePriority(String(s)),getImageData:s=>hn.getImageData(String(s)),uploadImage:(s,e,t)=>hn.uploadImage(String(s),e,t),deleteImage:s=>hn.deleteImage(String(s))},Qw=()=>{var ee,Ge;const{user:s}=Mr(),{loadProjectsFromAPI:e,projects:t}=tr(),n=dc(),[r,i]=A.useState([]),[o,l]=A.useState(!0),[u,m]=A.useState(null),[d,f]=A.useState([]),[h,b]=A.useState(!1),[V,v]=A.useState(""),[w,B]=A.useState(""),[P,F]=A.useState(null),[oe,se]=A.useState(null),[M,C]=A.useState(""),[x,E]=A.useState(null),[j,L]=A.useState(""),[T,k]=A.useState(null),[_e,Ue]=A.useState(new Set),pe=A.useRef(null),[je,ft]=A.useState(window.innerWidth<768),[qt,Ht]=A.useState(!1),[ae,He]=A.useState(null),[de,Le]=A.useState(new Set),[ze,bt]=A.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[it,St]=A.useState(!1),[nt,ut]=A.useState(!1),[ms,K]=A.useState(new Set);A.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(ze))},[ze]),A.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const be=()=>{ft(window.innerWidth<768)};return window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)},[]),A.useEffect(()=>{o||Te()},[n,o]),A.useEffect(()=>{u!==null&&Re()},[u]),A.useEffect(()=>{u!==null&&(s!=null&&s.id)&&localStorage.setItem(`finishCheck_selectedProject_${s.id}`,u.toString())},[u,s==null?void 0:s.id]),A.useEffect(()=>{if(!je&&T){const H=async be=>{var Pe;const De=(Pe=be.clipboardData)==null?void 0:Pe.items;if(De){for(let me=0;me<De.length;me++)if(De[me].type.indexOf("image")!==-1){be.preventDefault();const Mt=De[me].getAsFile();Mt&&await Ce(T,Mt)}}};return document.addEventListener("paste",H),()=>document.removeEventListener("paste",H)}},[T,je]);const Te=async()=>{try{const H=n.map(De=>({id:De.id,title:De.name}));i(H);const be=s!=null&&s.id?localStorage.getItem(`finishCheck_selectedProject_${s.id}`):null;be&&H.some(De=>De.id===Number(be))?m(Number(be)):H.length>0&&m(H[0].id)}catch(H){console.error("Failed to load projects:",H),ne.error("   ")}},Re=async()=>{try{d.length===0&&b(!0);const be=(await vn.getSpaces(u||void 0)).map(De=>({...De,items:De.items.map(Pe=>({...Pe,images:Pe.images||[]}))}));f(be)}catch(H){console.error("Failed to load spaces:",H),ne.error("   ")}finally{b(!1)}},we=async H=>{if(ms.has(Number(H)))return null;try{K(Pe=>new Set(Pe).add(Number(H)));const be=await vn.getImageData(H),De=(be==null?void 0:be.image_data)||null;return f(Pe=>Pe.map(me=>({...me,items:me.items.map(Mt=>({...Mt,images:Mt.images.map(mt=>String(mt.id)===String(H)?{...mt,image_data:De}:mt)}))}))),De}catch(be){return console.error("   :",be),null}finally{K(be=>{const De=new Set(be);return De.delete(Number(H)),De})}},Ye=async H=>{const be=d.find(me=>me.items.some(Mt=>Mt.id===H)),De=be==null?void 0:be.items.find(me=>me.id===H);if(!De)return;const Pe=De.images.filter(me=>!me.image_data);await Promise.all(Pe.map(me=>we(me.id)))},Tt=async()=>{if(!nt){if(!V.trim()){ne.error("  ");return}if(!u){ne.error(" ");return}ut(!0);try{const H=await vn.createSpace(V.trim(),u),be={...H,items:H.items||[]};f([...d,be]),v(""),St(!1),ne.success(" ")}catch(H){console.error("Failed to add space:",H),ne.error("  ")}finally{ut(!1)}}},$t=async(H,be)=>{if(!be.trim()){ne.error("  ");return}try{await vn.updateSpace(H,be.trim()),f(d.map(De=>String(De.id)===String(H)?{...De,name:be.trim()}:De)),se(null),C(""),ne.success("  ")}catch(De){console.error("Failed to update space:",De),ne.error("  ")}},ct=H=>{He(H),Le(new Set)},I=async()=>{if(ae!==null){if(de.size===0){ne.error("  ");return}try{await Promise.all(Array.from(de).map(H=>vn.deleteItem(H))),f(d.map(H=>String(H.id)===String(ae)?{...H,items:H.items.filter(be=>!de.has(be.id))}:H)),ne.success(`${de.size}  `),He(null),Le(new Set)}catch(H){console.error("Failed to delete items:",H),ne.error("  ")}}},O=async()=>{if(ae===null)return;const H=d.find(be=>String(be.id)===String(ae));if(H&&confirm(`"${H.name}"  ?

        .`))try{await vn.deleteSpace(ae),f(d.filter(be=>String(be.id)!==String(ae))),ne.success(" "),He(null),Le(new Set)}catch(be){console.error("Failed to delete space:",be),ne.error("  ")}},Z=async H=>{if(!w.trim()){ne.error("  ");return}const be=-Date.now(),De={id:be,space_id:H,content:w.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(me=>String(me.id)===String(H)?{...me,items:[...me.items,De]}:me));const Pe=w.trim();B(""),F(null);try{const me=await vn.createItem(H,Pe);f(Mt=>Mt.map(mt=>String(mt.id)===String(H)?{...mt,items:mt.items.map(Wt=>Wt.id===be?{...me,images:[]}:Wt)}:mt))}catch(me){console.error("Failed to add item:",me),f(Mt=>Mt.map(mt=>String(mt.id)===String(H)?{...mt,items:mt.items.filter(Wt=>Wt.id!==be)}:mt)),ne.error("  ")}},ye=async H=>{try{const be=await vn.toggleItem(H);f(d.map(De=>({...De,items:De.items.map(Pe=>String(Pe.id)===String(H)?{...Pe,...be}:Pe)})))}catch(be){console.error("Failed to toggle item:",be),ne.error("   ")}},ue=async H=>{try{const be=await vn.togglePriority(H);f(d.map(De=>({...De,items:De.items.map(Pe=>String(Pe.id)===String(H)?{...Pe,is_priority:be.is_priority}:Pe)})))}catch(be){console.error("Failed to toggle priority:",be),ne.error("  ")}},fe=H=>new Promise((be,De)=>{const Pe=new FileReader;Pe.readAsDataURL(H),Pe.onload=()=>be(Pe.result),Pe.onerror=me=>De(me)}),Ce=async(H,be)=>{var me,Mt;if(!["image/jpeg","image/png","image/webp"].includes(be.type)){ne.error("JPEG, PNG, WebP    ");return}const Pe=5*1024*1024;if(be.size>Pe){ne.error("  5MB  ");return}try{Ue(At=>new Set([...At,Number(H)]));const mt=await fe(be),Wt=await vn.uploadImage(H,mt,be.name);f(d.map(At=>({...At,items:At.items.map(ds=>String(ds.id)===String(H)?{...ds,images:[...ds.images,Wt]}:ds)}))),ne.success(" ")}catch(mt){console.error("Failed to upload image:",mt),ne.error(((Mt=(me=mt.response)==null?void 0:me.data)==null?void 0:Mt.error)||"  ")}finally{Ue(mt=>{const Wt=new Set(mt);return Wt.delete(Number(H)),Wt})}},Me=async(H,be)=>{const De=be.target.files;if(!(!De||De.length===0)){for(let Pe=0;Pe<De.length;Pe++)await Ce(H,De[Pe]);pe.current&&(pe.current.value="")}},tt=async(H,be)=>{if(confirm("  ?"))try{await vn.deleteImage(be),f(d.map(De=>({...De,items:De.items.map(Pe=>String(Pe.id)===String(H)?{...Pe,images:Pe.images.filter(me=>String(me.id)!==String(be))}:Pe)}))),ne.success(" ")}catch(De){console.error("Failed to delete image:",De),ne.error("  ")}},Ae=async(H,be)=>{H.preventDefault(),H.stopPropagation();const De=H.dataTransfer.files;if(!(!De||De.length===0))for(let Pe=0;Pe<De.length;Pe++)De[Pe].type.startsWith("image/")&&await Ce(be,De[Pe])},Rs=H=>{H.preventDefault(),H.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const jt=T?d.flatMap(H=>H.items).find(H=>H.id===T):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:pe,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:H=>{T&&Me(T,H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:je?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:H=>{const be=H.target.value?Number(H.target.value):null;m(be)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(H=>a.jsxDEV("option",{value:H.id,children:H.title},H.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>St(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(Wi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:H=>{const be=H.target.value?Number(H.target.value):null;m(be)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(H=>a.jsxDEV("option",{value:H.id,children:H.title},H.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:V,onChange:H=>v(H.target.value),onKeyPress:H=>{H.key==="Enter"&&Tt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Tt,disabled:nt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(Wi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>bt(!ze),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((H,be)=>{const De=H.items.filter(me=>!me.is_completed).sort((me,Mt)=>(Mt.is_priority||0)-(me.is_priority||0)),Pe=H.items.filter(me=>me.is_completed);return ze&&De.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[oe===H.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:M,onChange:me=>C(me.target.value),onKeyPress:me=>{me.key==="Enter"?$t(H.id,M):me.key==="Escape"&&(se(null),C(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>$t(H.id,M),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(Qp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{se(null),C("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:be+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),H.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Pe.length,"/",H.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{P===H.id?(F(null),B("")):F(H.id)},className:`p-1 transition-colors ${P===H.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(Wi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{se(H.id),C(H.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>ct(H.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),P===H.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:w,onChange:me=>B(me.target.value),onKeyPress:me=>{me.key==="Enter"&&w.trim()&&Z(H.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>Z(H.id),disabled:!w.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),De.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:De.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>ye(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!je&&T===me.id?"font-semibold":""}`,onClick:async()=>{je||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:je?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),je&&Ht(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Sd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!ze&&Pe.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Pe.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>ye(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!je&&T===me.id?"font-semibold":""}`,onClick:async()=>{je||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:je?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),je&&Ht(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Sd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!je&&T&&jt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var H;return(H=pe.current)==null?void 0:H.click()},disabled:_e.has(T),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),_e.has(T)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:H=>Ae(H,T),onDragOver:Rs,children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(jo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(H=>a.jsxDEV("div",{className:"relative group",children:[H.image_data?a.jsxDEV("img",{src:H.image_data,alt:H.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>tt(T,H.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Td,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),H.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:H.filename,children:H.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),je&&qt&&T&&jt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ht(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:jt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var H;return(H=pe.current)==null?void 0:H.click()},disabled:_e.has(T),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),_e.has(T)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:jt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(jo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:jt.images.map(H=>a.jsxDEV("div",{className:"relative",children:[H.image_data?a.jsxDEV("img",{src:H.image_data,alt:H.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>tt(T,H.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Td,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),H.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:H.filename,children:H.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ee=d.find(H=>H.id===ae))==null?void 0:ee.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{He(null),Le(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Ge=d.find(H=>H.id===ae))==null?void 0:Ge.items.map(H=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const be=new Set(de);be.has(H.id)?be.delete(H.id):be.add(H.id),Le(be)},children:[a.jsxDEV("input",{type:"checkbox",checked:de.has(H.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${H.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:H.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},H.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:I,disabled:de.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",de.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:O,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{He(null),Le(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),it&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{St(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:V,onChange:H=>v(H.target.value),onKeyPress:H=>{H.key==="Enter"&&V.trim()&&Tt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{St(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:Tt,disabled:!V.trim()||nt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:nt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function Yw(){const[s,e]=A.useState([]),[t,n]=A.useState(!1),[r,i]=A.useState(null),[o,l]=A.useState(!1),[u,m]=A.useState(null),[d,f]=A.useState(""),[h,b]=A.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[V,v]=A.useState(!1);A.useEffect(()=>{w()},[]),A.useEffect(()=>{const x=()=>{B()};return window.addEventListener("headerAddButtonClick",x),()=>window.removeEventListener("headerAddButtonClick",x)},[]);const w=async()=>{var x,E;try{s.length===0&&n(!0),i(null);const j=await Zn.getAllContractors();e(j.map(L=>({id:L._id,rank:L.rank,companyName:L.companyName,name:L.name,position:L.position,process:L.process,contact:L.contact,accountNumber:L.accountNumber,notes:L.notes,createdAt:new Date(L.createdAt),updatedAt:new Date(L.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const L=j instanceof Error&&((E=(x=j.response)==null?void 0:x.data)==null?void 0:E.message);i(L||"   .")}finally{n(!1)}},B=x=>{if(x){m(x);let E="",j=x.accountNumber||"";if(x.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const _e of k)if(x.accountNumber.startsWith(_e)){E=_e,j=x.accountNumber.substring(_e.length).trim();break}}let L=x.name,T=x.position||"";T||(T=Ya(x.name),L=Xo(x.name)),b({rank:x.rank||"",companyName:x.companyName||"",name:L,position:T,process:x.process,contact:x.contact||"",bankName:E,accountNumber:j,notes:x.notes||""})}else m(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},P=()=>{l(!1),m(null),b({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},F=async x=>{var j,L;if(x.preventDefault(),V)return;v(!0);const E=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const T={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:E,notes:h.notes};u?await Zn.updateContractor(u.id,T):await Zn.createContractor(T),await w(),P()}catch(T){console.error("Failed to save contractor:",T);const k=T instanceof Error&&((L=(j=T.response)==null?void 0:j.data)==null?void 0:L.message);alert(k||"  .")}finally{v(!1)}},oe=async x=>{var E,j;if(window.confirm("   ?"))try{await Zn.deleteContractor(x),await w()}catch(L){console.error("Failed to delete contractor:",L);const T=L instanceof Error&&((j=(E=L.response)==null?void 0:E.data)==null?void 0:j.message);alert(T||"  .")}},se=()=>"border-gray-200 text-gray-600 bg-gray-50",M=x=>x?x==="1"?1:x==="1()"?2:x==="2"?3:x==="2()"?4:x==="3"?5:x==="3()"?6:x===""?100:x===""?200:999:999,C=s.filter(x=>x.name.toLowerCase().includes(d.toLowerCase())||x.process.toLowerCase().includes(d.toLowerCase())||x.accountNumber.toLowerCase().includes(d.toLowerCase())||x.contact&&x.contact.toLowerCase().includes(d.toLowerCase())||x.rank&&x.rank.toLowerCase().includes(d.toLowerCase())||x.companyName&&x.companyName.toLowerCase().includes(d.toLowerCase())).sort((x,E)=>{const j=M(x.rank)-M(E.rank);if(j!==0)return j;const L=x.process.localeCompare(E.process,"ko");return L!==0?L:x.name.localeCompare(E.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Gp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:x=>f(x.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):C.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):C.map(x=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${se(x.rank)}`,children:x.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:Xo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.position||Ya(x.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:w,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):C.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):C.map(x=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[x.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${se(x.rank)}`,children:x.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),x.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:x.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Xo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(x.position||Ya(x.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.position||Ya(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),x.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),x.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:x.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:P,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(vs,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:F,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:x=>b({...h,rank:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:x=>b({...h,companyName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:x=>b({...h,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:x=>b({...h,position:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:x=>b({...h,process:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:x=>b({...h,contact:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:x=>b({...h,bankName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:x=>b({...h,accountNumber:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:x=>b({...h,notes:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:V,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:V?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const Gw=()=>{const[s,e]=A.useState([]),[t,n]=A.useState(null),[r,i]=A.useState(!1),o=A.useRef(null);A.useEffect(()=>(o.current=pl.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{o.current&&o.current()}),[]);const l=async f=>{try{await pl.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{n(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await pl.deleteQuoteInquiry(f),(t==null?void 0:t.id)===f&&n(null),ne.success(" ")}catch(b){console.error("Failed to delete inquiry:",b),ne.error("  ")}},d=s.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:s.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ft(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ii,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Ld,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>n(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ft(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(PN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Ld,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(IN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(jN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(RN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},Xw=()=>{const{login:s}=Mr(),[e,t]=A.useState(!1),{register:n,handleSubmit:r,setValue:i,formState:{errors:o}}=rd(),l=async m=>{t(!0);try{await s(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...n("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...n("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(BN,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},Jw=A.lazy(()=>Qn(()=>import("./Drawings-BHm7icV_.js"),__vite__mapDeps([0,1,2,3,4,5]))),Zw=A.lazy(()=>Qn(()=>import("./SiteLog-Cb3gXYnk.js"),__vite__mapDeps([6,1,4,2,3,5]))),e2=A.lazy(()=>Qn(()=>import("./AfterService-CUrfhe4J.js"),__vite__mapDeps([7,1,2,4,3,5]))),t2=A.lazy(()=>Qn(()=>import("./AdditionalWork-DwM1Hv-d.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),s2=A.lazy(()=>Qn(()=>import("./ConstructionPayment-D6Ee-IfZ.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),n2=A.lazy(()=>Qn(()=>import("./WorkRequest-yxDp_JYV.js"),__vite__mapDeps([11,1,2,4,3,5]))),r2=A.lazy(()=>Qn(()=>import("./Specbook-q8ys50F5.js"),__vite__mapDeps([12,1,2,3,4,5]))),i2=A.lazy(()=>Qn(()=>import("./EstimatePreview-D8T5-HFO.js"),__vite__mapDeps([13,1,2,3,4,5]))),o2=A.lazy(()=>Qn(()=>import("./ExecutionHistory-DPO74lec.js"),__vite__mapDeps([14,1,4,2,3,5]))),a2=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),l2=new DN({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function c2(){const[s,e]=A.useState(!1);return A.useEffect(()=>{const t=Bx({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),ne.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{ne.dismiss(),ne.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});OC();const n=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(n,5e3);const r=setInterval(n,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Fo(u,{transports:["websocket","polling"]}),Rl.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;MC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(kN,{client:l2,children:a.jsxDEV(xN,{children:a.jsxDEV(QE,{children:[a.jsxDEV(A.Suspense,{fallback:a.jsxDEV(a2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(vN,{children:[a.jsxDEV(Vs,{path:"/login",element:a.jsxDEV(Xw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Vs,{path:"/",element:a.jsxDEV(BC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Vs,{index:!0,element:a.jsxDEV(Kp,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Vs,{path:"dashboard",element:a.jsxDEV(g1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Vs,{path:"projects",element:a.jsxDEV(D1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Vs,{path:"schedule",element:a.jsxDEV(Hw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Vs,{path:"drawings",element:a.jsxDEV(Jw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Vs,{path:"site-log",element:a.jsxDEV(Zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Vs,{path:"after-service",element:a.jsxDEV(e2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Vs,{path:"additional-work",element:a.jsxDEV(t2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Vs,{path:"construction-payment",element:a.jsxDEV(s2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Vs,{path:"contractors",element:a.jsxDEV(Yw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Vs,{path:"work-request",element:a.jsxDEV(n2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Vs,{path:"finish-check",element:a.jsxDEV(Qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Vs,{path:"specbook",element:a.jsxDEV(r2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Vs,{path:"estimate-preview",element:a.jsxDEV(i2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Vs,{path:"execution-history",element:a.jsxDEV(o2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Vs,{path:"payments",element:a.jsxDEV(Kw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Vs,{path:"quote-inquiry",element:a.jsxDEV(Gw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(q0,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(s){for(const e of s)e.update()});dh(document.getElementById("root")).render(a.jsxDEV(A.StrictMode,{children:a.jsxDEV(c2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{rd as A,xs as B,Mu as C,SC as D,Qc as E,KE as F,b2 as G,Rt as H,$w as I,ln as J,zw as K,qw as L,Xc as P,xe as T,re as a,Us as b,os as c,Se as d,Il as e,Bu as f,It as g,Mr as h,dc as i,a as j,qe as k,dn as l,wt as m,Xy as n,ls as o,to as p,xt as q,Pl as r,li as s,jl as t,Ru as u,Bt as v,js as w,Wn as x,tr as y,ne as z};
