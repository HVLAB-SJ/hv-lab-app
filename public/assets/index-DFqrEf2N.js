const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-r98kK_a3.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-Te8ejAPf.js","assets/AfterService-C7OE_g4K.js","assets/AdditionalWork-uo_Q3Yx3.js","assets/additionalWorkService-BOvKAmUa.js","assets/ConstructionPayment-Bq_JqbJk.js","assets/WorkRequest-CrI5I5sr.js","assets/Specbook-ex4eaY73.js","assets/EstimatePreview-BYkkcMmJ.js","assets/ExecutionHistory-CjmLe6sX.js"])))=>i.map(i=>d[i]);
var hN=Object.defineProperty;var gN=(s,e,t)=>e in s?hN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var wd=(s,e,t)=>gN(s,typeof e!="symbol"?e+"":e,t);import{r as D,b as yN,u as zp,d as bN,N as Kp,e as wc,O as NN,R as ut,f as fa,B as xN,h as vN,i as Vs}from"./vendor-react-DN7YJcfR.js";import{a as _N,c as Wu,Q as DN,b as kN}from"./vendor-data-DrLf5NIQ.js";import{B as Sc,X as vs,C as Qp,T as ai,a as AN,b as Yp,W as EN,c as CN,d as Cn,P as Wi,R as VN,e as wN,S as Gp,f as SN,g as TN,h as Xp,i as LN,U as tu,I as jo,j as su,k as Sd,l as Td,m as Ld,n as PN,M as IN,o as jN,p as RN,L as BN}from"./vendor-ui-D8A9iq7X.js";import{k as Tc,l as No,m as xo,n as UN,o as HN,p as qt,q as MN,r as Pd,s as ON,t as lt}from"./vendor-date-DbWJ9m7c.js";import{c as FN,p as Jp,l as Ml,s as Vn,i as qN,h as $N,q as zu,a as Ku,m as Qu,b as WN,d as Ol,o as yl,e as zN,f as bl,r as Yu,g as Gu,j as Xu,k as Ju,n as Zu,t as Zp,u as eh,v as th,w as sh,x as nh,y as rh,z as ih,A as oh,B as ah,C as lh,D as ch,E as uh,F as KN,G as QN,H as YN,I as GN,J as XN,K as JN,L as ZN}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var mh={exports:{}},nu={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var s=D,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),C=Symbol.iterator,v="@@iterator";function V(I){if(I===null||typeof I!="object")return null;var pe=C&&I[C]||I[v];return typeof pe=="function"?pe:null}var B=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function T(I){{for(var pe=arguments.length,N=new Array(pe>1?pe-1:0),R=1;R<pe;R++)N[R-1]=arguments[R];q("error",I,N)}}function q(I,pe,N){{var R=B.ReactDebugCurrentFrame,j=R.getStackAddendum();j!==""&&(pe+="%s",N=N.concat([j]));var Q=N.map(function(H){return String(H)});Q.unshift("Warning: "+pe),Function.prototype.apply.call(console[I],console,Q)}}var oe=!1,te=!1,O=!1,E=!1,x=!1,A;A=Symbol.for("react.module.reference");function P(I){return!!(typeof I=="string"||typeof I=="function"||I===n||I===i||x||I===r||I===m||I===d||E||I===y||oe||te||O||typeof I=="object"&&I!==null&&(I.$$typeof===h||I.$$typeof===f||I.$$typeof===o||I.$$typeof===l||I.$$typeof===u||I.$$typeof===A||I.getModuleId!==void 0))}function S(I,pe,N){var R=I.displayName;if(R)return R;var j=pe.displayName||pe.name||"";return j!==""?N+"("+j+")":N}function w(I){return I.displayName||"Context"}function k(I){if(I==null)return null;if(typeof I.tag=="number"&&T("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof I=="function")return I.displayName||I.name||null;if(typeof I=="string")return I;switch(I){case n:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof I=="object")switch(I.$$typeof){case l:var pe=I;return w(pe)+".Consumer";case o:var N=I;return w(N._context)+".Provider";case u:return S(I,I.render,"ForwardRef");case f:var R=I.displayName||null;return R!==null?R:k(I.type)||"Memo";case h:{var j=I,Q=j._payload,H=j._init;try{return k(H(Q))}catch{return null}}}return null}var Ae=Object.assign,He=0,ye,Be,gt,$t,Ft,ae,Me;function de(){}de.__reactDisabledLog=!0;function Ie(){{if(He===0){ye=console.log,Be=console.info,gt=console.warn,$t=console.error,Ft=console.group,ae=console.groupCollapsed,Me=console.groupEnd;var I={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:I,log:I,warn:I,error:I,group:I,groupCollapsed:I,groupEnd:I})}He++}}function ze(){{if(He--,He===0){var I={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Ae({},I,{value:ye}),info:Ae({},I,{value:Be}),warn:Ae({},I,{value:gt}),error:Ae({},I,{value:$t}),group:Ae({},I,{value:Ft}),groupCollapsed:Ae({},I,{value:ae}),groupEnd:Ae({},I,{value:Me})})}He<0&&T("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var xt=B.ReactCurrentDispatcher,it;function Tt(I,pe,N){{if(it===void 0)try{throw Error()}catch(j){var R=j.stack.trim().match(/\n( *(at )?)/);it=R&&R[1]||""}return`
`+it+I}}var nt=!1,ft;{var us=typeof WeakMap=="function"?WeakMap:Map;ft=new us}function K(I,pe){if(!I||nt)return"";{var N=ft.get(I);if(N!==void 0)return N}var R;nt=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Q;Q=xt.current,xt.current=null,Ie();try{if(pe){var H=function(){throw Error()};if(Object.defineProperty(H.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(H,[])}catch(Ke){R=Ke}Reflect.construct(I,[],H)}else{try{H.call()}catch(Ke){R=Ke}I.call(H.prototype)}}else{try{throw Error()}catch(Ke){R=Ke}I()}}catch(Ke){if(Ke&&R&&typeof Ke.stack=="string"){for(var W=Ke.stack.split(`
`),re=R.stack.split(`
`),Y=W.length-1,Z=re.length-1;Y>=1&&Z>=0&&W[Y]!==re[Z];)Z--;for(;Y>=1&&Z>=0;Y--,Z--)if(W[Y]!==re[Z]){if(Y!==1||Z!==1)do if(Y--,Z--,Z<0||W[Y]!==re[Z]){var he=`
`+W[Y].replace(" at new "," at ");return I.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",I.displayName)),typeof I=="function"&&ft.set(I,he),he}while(Y>=1&&Z>=0);break}}}finally{nt=!1,xt.current=Q,ze(),Error.prepareStackTrace=j}var Je=I?I.displayName||I.name:"",pt=Je?Tt(Je):"";return typeof I=="function"&&ft.set(I,pt),pt}function Pe(I,pe,N){return K(I,!1)}function Fe(I){var pe=I.prototype;return!!(pe&&pe.isReactComponent)}function Te(I,pe,N){if(I==null)return"";if(typeof I=="function")return K(I,Fe(I));if(typeof I=="string")return Tt(I);switch(I){case m:return Tt("Suspense");case d:return Tt("SuspenseList")}if(typeof I=="object")switch(I.$$typeof){case u:return Pe(I.render);case f:return Te(I.type,pe,N);case h:{var R=I,j=R._payload,Q=R._init;try{return Te(Q(j),pe,N)}catch{}}}return""}var Ye=Object.prototype.hasOwnProperty,Lt={},Wt=B.ReactDebugCurrentFrame;function mt(I){if(I){var pe=I._owner,N=Te(I.type,I._source,pe?pe.type:null);Wt.setExtraStackFrame(N)}else Wt.setExtraStackFrame(null)}function L(I,pe,N,R,j){{var Q=Function.call.bind(Ye);for(var H in I)if(Q(I,H)){var W=void 0;try{if(typeof I[H]!="function"){var re=Error((R||"React class")+": "+N+" type `"+H+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof I[H]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw re.name="Invariant Violation",re}W=I[H](pe,H,R,N,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Y){W=Y}W&&!(W instanceof Error)&&(mt(j),T("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",R||"React class",N,H,typeof W),mt(null)),W instanceof Error&&!(W.message in Lt)&&(Lt[W.message]=!0,mt(j),T("Failed %s type: %s",N,W.message),mt(null))}}}var F=Array.isArray;function J(I){return F(I)}function xe(I){{var pe=typeof Symbol=="function"&&Symbol.toStringTag,N=pe&&I[Symbol.toStringTag]||I.constructor.name||"Object";return N}}function ue(I){try{return fe(I),!1}catch{return!0}}function fe(I){return""+I}function we(I){if(ue(I))return T("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",xe(I)),fe(I)}var Oe=B.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0},Ee,Bs,Bt;Bt={};function ee(I){if(Ye.call(I,"ref")){var pe=Object.getOwnPropertyDescriptor(I,"ref").get;if(pe&&pe.isReactWarning)return!1}return I.ref!==void 0}function Ge(I){if(Ye.call(I,"key")){var pe=Object.getOwnPropertyDescriptor(I,"key").get;if(pe&&pe.isReactWarning)return!1}return I.key!==void 0}function M(I,pe){if(typeof I.ref=="string"&&Oe.current&&pe&&Oe.current.stateNode!==pe){var N=k(Oe.current.type);Bt[N]||(T('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Oe.current.type),I.ref),Bt[N]=!0)}}function ge(I,pe){{var N=function(){Ee||(Ee=!0,T("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",pe))};N.isReactWarning=!0,Object.defineProperty(I,"key",{get:N,configurable:!0})}}function ke(I,pe){{var N=function(){Bs||(Bs=!0,T("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",pe))};N.isReactWarning=!0,Object.defineProperty(I,"ref",{get:N,configurable:!0})}}var je=function(I,pe,N,R,j,Q,H){var W={$$typeof:e,type:I,key:pe,ref:N,props:H,_owner:Q};return W._store={},Object.defineProperty(W._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(W,"_self",{configurable:!1,enumerable:!1,writable:!1,value:R}),Object.defineProperty(W,"_source",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.freeze&&(Object.freeze(W.props),Object.freeze(W)),W};function me(I,pe,N,R,j){{var Q,H={},W=null,re=null;N!==void 0&&(we(N),W=""+N),Ge(pe)&&(we(pe.key),W=""+pe.key),ee(pe)&&(re=pe.ref,M(pe,j));for(Q in pe)Ye.call(pe,Q)&&!et.hasOwnProperty(Q)&&(H[Q]=pe[Q]);if(I&&I.defaultProps){var Y=I.defaultProps;for(Q in Y)H[Q]===void 0&&(H[Q]=Y[Q])}if(W||re){var Z=typeof I=="function"?I.displayName||I.name||"Unknown":I;W&&ge(H,Z),re&&ke(H,Z)}return je(I,W,re,j,R,Oe.current,H)}}var Ut=B.ReactCurrentOwner,At=B.ReactDebugCurrentFrame;function Qt(I){if(I){var pe=I._owner,N=Te(I.type,I._source,pe?pe.type:null);At.setExtraStackFrame(N)}else At.setExtraStackFrame(null)}var vt;vt=!1;function fs(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function zt(){{if(Ut.current){var I=k(Ut.current.type);if(I)return`

Check the render method of \``+I+"`."}return""}}function ps(I){{if(I!==void 0){var pe=I.fileName.replace(/^.*[\\\/]/,""),N=I.lineNumber;return`

Check your code at `+pe+":"+N+"."}return""}}var gn={};function Js(I){{var pe=zt();if(!pe){var N=typeof I=="string"?I:I.displayName||I.name;N&&(pe=`

Check the top-level render call using <`+N+">.")}return pe}}function yn(I,pe){{if(!I._store||I._store.validated||I.key!=null)return;I._store.validated=!0;var N=Js(pe);if(gn[N])return;gn[N]=!0;var R="";I&&I._owner&&I._owner!==Ut.current&&(R=" It was passed a child from "+k(I._owner.type)+"."),Qt(I),T('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',N,R),Qt(null)}}function Gr(I,pe){{if(typeof I!="object")return;if(J(I))for(var N=0;N<I.length;N++){var R=I[N];fs(R)&&yn(R,pe)}else if(fs(I))I._store&&(I._store.validated=!0);else if(I){var j=V(I);if(typeof j=="function"&&j!==I.entries)for(var Q=j.call(I),H;!(H=Q.next()).done;)fs(H.value)&&yn(H.value,pe)}}}function jn(I){{var pe=I.type;if(pe==null||typeof pe=="string")return;var N;if(typeof pe=="function")N=pe.propTypes;else if(typeof pe=="object"&&(pe.$$typeof===u||pe.$$typeof===f))N=pe.propTypes;else return;if(N){var R=k(pe);L(N,I.props,"prop",R,I)}else if(pe.PropTypes!==void 0&&!vt){vt=!0;var j=k(pe);T("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",j||"Unknown")}typeof pe.getDefaultProps=="function"&&!pe.getDefaultProps.isReactClassApproved&&T("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function sn(I){{for(var pe=Object.keys(I.props),N=0;N<pe.length;N++){var R=pe[N];if(R!=="children"&&R!=="key"){Qt(I),T("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",R),Qt(null);break}}I.ref!==null&&(Qt(I),T("Invalid attribute `ref` supplied to `React.Fragment`."),Qt(null))}}var Rn={};function Us(I,pe,N,R,j,Q){{var H=P(I);if(!H){var W="";(I===void 0||typeof I=="object"&&I!==null&&Object.keys(I).length===0)&&(W+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var re=ps(j);re?W+=re:W+=zt();var Y;I===null?Y="null":J(I)?Y="array":I!==void 0&&I.$$typeof===e?(Y="<"+(k(I.type)||"Unknown")+" />",W=" Did you accidentally export a JSX literal instead of a component?"):Y=typeof I,T("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Y,W)}var Z=me(I,pe,N,j,Q);if(Z==null)return Z;if(H){var he=pe.children;if(he!==void 0)if(R)if(J(he)){for(var Je=0;Je<he.length;Je++)Gr(he[Je],I);Object.freeze&&Object.freeze(he)}else T("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Gr(he,I)}if(Ye.call(pe,"key")){var pt=k(I),Ke=Object.keys(pe).filter(function(Hs){return Hs!=="key"}),_e=Ke.length>0?"{key: someKey, "+Ke.join(": ..., ")+": ...}":"{key: someKey}";if(!Rn[pt+_e]){var ot=Ke.length>0?"{"+Ke.join(": ..., ")+": ...}":"{}";T(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,_e,pt,ot,pt),Rn[pt+_e]=!0}}return I===n?sn(Z):jn(Z),Z}}var Ts=Us;nu.Fragment=n,nu.jsxDEV=Ts})();mh.exports=nu;var a=mh.exports,dh,Id=yN;{var jd=Id.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;dh=function(s,e){jd.usingClientEntryPoint=!0;try{return Id.createRoot(s,e)}finally{jd.usingClientEntryPoint=!1}}}const e0="modulepreload",t0=function(s){return"/"+s},Rd={},Xn=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=t0(u),u in Rd)return;Rd[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":e0,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let s0={data:""},n0=s=>{if(typeof window=="object"){let e=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(s||document.head).appendChild(e),e.firstChild}return s||s0},r0=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,i0=/\/\*[^]*?\*\/|  +/g,Bd=/\n+/g,vr=(s,e)=>{let t="",n="",r="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?vr(o,i):i+"{"+vr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=vr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=vr.p?vr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+n},Zn={},fh=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+fh(s[t]);return e}return s},o0=(s,e,t,n,r)=>{let i=fh(s),o=Zn[i]||(Zn[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Zn[o]){let u=i!==s?s:(m=>{let d,f,h=[{}];for(;d=r0.exec(m.replace(i0,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Bd," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Bd," ").trim();return h[0]})(s);Zn[o]=vr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Zn.g?Zn.g:null;return t&&(Zn.g=Zn[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Zn[o],e,n,l),o},a0=(s,e,t)=>s.reduce((n,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":vr(l,""):l===!1?"":l}return n+r+(o??"")},"");function Fl(s){let e=this||{},t=s.call?s(e.p):s;return o0(t.unshift?t.raw?a0(t,[].slice.call(arguments,1),e.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):t,n0(e.target),e.g,e.o,e.k)}let ph,ru,iu;Fl.bind({g:1});let ar=Fl.bind({k:1});function l0(s,e,t,n){vr.p=e,ph=s,ru=t,iu=n}function Hr(s,e){let t=this||{};return function(){let n=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:ru&&ru()},l),t.o=/ *go\d+/.test(u),l.className=Fl.apply(t,n)+(u?" "+u:"");let m=s;return s[0]&&(m=l.as||s,delete l.as),iu&&m[0]&&iu(l),ph(m,l)}return r}}var c0=s=>typeof s=="function",Nl=(s,e)=>c0(s)?s(e):s,u0=(()=>{let s=0;return()=>(++s).toString()})(),hh=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),m0=20,em="default",gh=(s,e)=>{let{toastLimit:t}=s.settings;switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:n}=e;return gh(s,{type:s.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...s,toasts:s.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let i=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},nl=[],yh={toasts:[],pausedAt:void 0,settings:{toastLimit:m0}},Fn={},bh=(s,e=em)=>{Fn[e]=gh(Fn[e]||yh,s),nl.forEach(([t,n])=>{t===e&&n(Fn[e])})},Nh=s=>Object.keys(Fn).forEach(e=>bh(s,e)),d0=s=>Object.keys(Fn).find(e=>Fn[e].toasts.some(t=>t.id===s)),ql=(s=em)=>e=>{bh(e,s)},f0={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},p0=(s={},e=em)=>{let[t,n]=D.useState(Fn[e]||yh),r=D.useRef(Fn[e]);D.useEffect(()=>(r.current!==Fn[e]&&n(Fn[e]),nl.push([e,n]),()=>{let o=nl.findIndex(([l])=>l===e);o>-1&&nl.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...s,...s[o.type],...o,removeDelay:o.removeDelay||((l=s[o.type])==null?void 0:l.removeDelay)||(s==null?void 0:s.removeDelay),duration:o.duration||((u=s[o.type])==null?void 0:u.duration)||(s==null?void 0:s.duration)||f0[o.type],style:{...s.style,...(m=s[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},h0=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||u0()}),pa=s=>(e,t)=>{let n=h0(e,s,t);return ql(n.toasterId||d0(n.id))({type:2,toast:n}),n.id},ws=(s,e)=>pa("blank")(s,e);ws.error=pa("error");ws.success=pa("success");ws.loading=pa("loading");ws.custom=pa("custom");ws.dismiss=(s,e)=>{let t={type:3,toastId:s};e?ql(e)(t):Nh(t)};ws.dismissAll=s=>ws.dismiss(void 0,s);ws.remove=(s,e)=>{let t={type:4,toastId:s};e?ql(e)(t):Nh(t)};ws.removeAll=s=>ws.remove(void 0,s);ws.promise=(s,e,t)=>{let n=ws.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof s=="function"&&(s=s()),s.then(r=>{let i=e.success?Nl(e.success,r):void 0;return i?ws.success(i,{id:n,...t,...t==null?void 0:t.success}):ws.dismiss(n),r}).catch(r=>{let i=e.error?Nl(e.error,r):void 0;i?ws.error(i,{id:n,...t,...t==null?void 0:t.error}):ws.dismiss(n)}),s};var g0=1e3,y0=(s,e="default")=>{let{toasts:t,pausedAt:n}=p0(s,e),r=D.useRef(new Map).current,i=D.useCallback((f,h=g0)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,y)},[]);D.useEffect(()=>{if(n)return;let f=Date.now(),h=t.map(y=>{if(y.duration===1/0)return;let C=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(C<0){y.visible&&ws.dismiss(y.id);return}return setTimeout(()=>ws.dismiss(y.id,e),C)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[t,n,e]);let o=D.useCallback(ql(e),[e]),l=D.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=D.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=D.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),d=D.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:C=8,defaultPosition:v}=h||{},V=t.filter(q=>(q.position||v)===(f.position||v)&&q.height),B=V.findIndex(q=>q.id===f.id),T=V.filter((q,oe)=>oe<B&&q.visible).length;return V.filter(q=>q.visible).slice(...y?[T+1]:[0,T]).reduce((q,oe)=>q+(oe.height||0)+C,0)},[t]);return D.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},b0=ar`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,N0=ar`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,x0=ar`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,v0=Hr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${b0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${N0} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${x0} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_0=ar`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,D0=Hr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${_0} 1s linear infinite;
`,k0=ar`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,A0=ar`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,E0=Hr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${k0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${A0} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,C0=Hr("div")`
  position: absolute;
`,V0=Hr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,w0=ar`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,S0=Hr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${w0} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,T0=({toast:s})=>{let{icon:e,type:t,iconTheme:n}=s;return e!==void 0?typeof e=="string"?D.createElement(S0,null,e):e:t==="blank"?null:D.createElement(V0,null,D.createElement(D0,{...n}),t!=="loading"&&D.createElement(C0,null,t==="error"?D.createElement(v0,{...n}):D.createElement(E0,{...n})))},L0=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,P0=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,I0="0%{opacity:0;} 100%{opacity:1;}",j0="0%{opacity:1;} 100%{opacity:0;}",R0=Hr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,B0=Hr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,U0=(s,e)=>{let t=s.includes("top")?1:-1,[n,r]=hh()?[I0,j0]:[L0(t),P0(t)];return{animation:e?`${ar(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ar(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},H0=D.memo(({toast:s,position:e,style:t,children:n})=>{let r=s.height?U0(s.position||e||"top-center",s.visible):{opacity:0},i=D.createElement(T0,{toast:s}),o=D.createElement(B0,{...s.ariaProps},Nl(s.message,s));return D.createElement(R0,{className:s.className,style:{...r,...t,...s.style}},typeof n=="function"?n({icon:i,message:o}):D.createElement(D.Fragment,null,i,o))});l0(D.createElement);var M0=({id:s,className:e,style:t,onHeightUpdate:n,children:r})=>{let i=D.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(s,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[s,n]);return D.createElement("div",{ref:i,className:e,style:t},r)},O0=(s,e)=>{let t=s.includes("top"),n=t?{top:0}:{bottom:0},r=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hh()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...r}},F0=Fl`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ia=16,q0=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:n,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=y0(t,i);return D.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ia,left:Ia,right:Ia,bottom:Ia,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:s,gutter:n,defaultPosition:e}),y=O0(f,h);return D.createElement(M0,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?F0:"",style:y},d.type==="custom"?Nl(d.message,d):r?r(d):D.createElement(H0,{toast:d,position:f}))}))},se=ws;const Yn=Object.create(null);Yn.open="0";Yn.close="1";Yn.ping="2";Yn.pong="3";Yn.message="4";Yn.upgrade="5";Yn.noop="6";const rl=Object.create(null);Object.keys(Yn).forEach(s=>{rl[Yn[s]]=s});const ou={type:"error",data:"parser error"},xh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vh=typeof ArrayBuffer=="function",_h=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,tm=({type:s,data:e},t,n)=>xh&&e instanceof Blob?t?n(e):Ud(e,n):vh&&(e instanceof ArrayBuffer||_h(e))?t?n(e):Ud(new Blob([e]),n):n(Yn[s]+(e||"")),Ud=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Hd(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Lc;function $0(s,e){if(xh&&s.data instanceof Blob)return s.data.arrayBuffer().then(Hd).then(e);if(vh&&(s.data instanceof ArrayBuffer||_h(s.data)))return e(Hd(s.data));tm(s,!1,t=>{Lc||(Lc=new TextEncoder),e(Lc.encode(t))})}const Md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ro=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Md.length;s++)Ro[Md.charCodeAt(s)]=s;const W0=s=>{let e=s.length*.75,t=s.length,n,r=0,i,o,l,u;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(n=0;n<t;n+=4)i=Ro[s.charCodeAt(n)],o=Ro[s.charCodeAt(n+1)],l=Ro[s.charCodeAt(n+2)],u=Ro[s.charCodeAt(n+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},z0=typeof ArrayBuffer=="function",sm=(s,e)=>{if(typeof s!="string")return{type:"message",data:Dh(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:K0(s.substring(1),e)}:rl[t]?s.length>1?{type:rl[t],data:s.substring(1)}:{type:rl[t]}:ou},K0=(s,e)=>{if(z0){const t=W0(s);return Dh(t,e)}else return{base64:!0,data:s}},Dh=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},kh="",Q0=(s,e)=>{const t=s.length,n=new Array(t);let r=0;s.forEach((i,o)=>{tm(i,!1,l=>{n[o]=l,++r===t&&e(n.join(kh))})})},Y0=(s,e)=>{const t=s.split(kh),n=[];for(let r=0;r<t.length;r++){const i=sm(t[r],e);if(n.push(i),i.type==="error")break}return n};function G0(){return new TransformStream({transform(s,e){$0(s,t=>{const n=t.length;let r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Pc;function ja(s){return s.reduce((e,t)=>e+t.length,0)}function Ra(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let r=0;r<e;r++)t[r]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function X0(s,e){Pc||(Pc=new TextDecoder);const t=[];let n=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(ja(t)<1)break;const u=Ra(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(ja(t)<2)break;const u=Ra(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(ja(t)<8)break;const u=Ra(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(ou);break}r=d*Math.pow(2,32)+m.getUint32(4),n=3}else{if(ja(t)<r)break;const u=Ra(t,r);l.enqueue(sm(i?u:Pc.decode(u),e)),n=0}if(r===0||r>s){l.enqueue(ou);break}}}})}const Ah=4;function Ds(s){if(s)return J0(s)}function J0(s){for(var e in Ds.prototype)s[e]=Ds.prototype[e];return s}Ds.prototype.on=Ds.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Ds.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Ds.prototype.off=Ds.prototype.removeListener=Ds.prototype.removeAllListeners=Ds.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Ds.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};Ds.prototype.emitReserved=Ds.prototype.emit;Ds.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ds.prototype.hasListeners=function(s){return!!this.listeners(s).length};const $l=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Nn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Z0="arraybuffer";function Eh(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const ex=Nn.setTimeout,tx=Nn.clearTimeout;function Wl(s,e){e.useNativeTimers?(s.setTimeoutFn=ex.bind(Nn),s.clearTimeoutFn=tx.bind(Nn)):(s.setTimeoutFn=Nn.setTimeout.bind(Nn),s.clearTimeoutFn=Nn.clearTimeout.bind(Nn))}const sx=1.33;function nx(s){return typeof s=="string"?rx(s):Math.ceil((s.byteLength||s.size)*sx)}function rx(s){let e=0,t=0;for(let n=0,r=s.length;n<r;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Ch(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ix(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function ox(s){let e={},t=s.split("&");for(let n=0,r=t.length;n<r;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class ax extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class nm extends Ds{constructor(e){super(),this.writable=!1,Wl(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new ax(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=sm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=ix(e);return t.length?"?"+t:""}}class lx extends nm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Y0(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Q0(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Ch()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Vh=!1;try{Vh=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const cx=Vh;function ux(){}class mx extends lx{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}let zi=class il extends Ds{constructor(e,t,n){super(),this.createRequest=e,Wl(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=Eh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var r;n.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=il.requestsCount++,il.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ux,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete il.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};zi.requestsCount=0;zi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Od);else if(typeof addEventListener=="function"){const s="onpagehide"in Nn?"pagehide":"unload";addEventListener(s,Od,!1)}}function Od(){for(let s in zi.requests)zi.requests.hasOwnProperty(s)&&zi.requests[s].abort()}const dx=function(){const s=wh({xdomain:!1});return s&&s.responseType!==null}();class fx extends mx{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=dx&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new zi(wh,this.uri(),e)}}function wh(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||cx))return new XMLHttpRequest}catch{}if(!e)try{return new Nn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Sh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class px extends nm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Sh?{}:Eh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;tm(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}r&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ch()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Ic=Nn.WebSocket||Nn.MozWebSocket;class hx extends px{createSocket(e,t,n){return Sh?new Ic(e,t,n):t?new Ic(e,t):new Ic(e)}doWrite(e,t){this.ws.send(t)}}class gx extends nm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=X0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=G0();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&$l(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const yx={websocket:hx,webtransport:gx,polling:fx},bx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function au(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let r=bx.exec(s||""),i={},o=14;for(;o--;)i[Nx[o]]=r[o]||"";return t!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=xx(i,i.path),i.queryKey=vx(i,i.query),i}function xx(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function vx(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,i){r&&(t[r]=i)}),t}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",ol=[];lu&&addEventListener("offline",()=>{ol.forEach(s=>s())},!1);class Ar extends Ds{constructor(e,t){if(super(),this.binaryType=Z0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=au(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=au(t.host).host);Wl(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const r=n.prototype.name;this.transports.push(r),this._transportsByName[r]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ox(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ol.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Ah,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Ar.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Ar.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+=nx(r)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,$l(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if(typeof t=="function"&&(r=t,t=void 0),typeof n=="function"&&(r=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Ar.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=ol.indexOf(this._offlineEventListener);n!==-1&&ol.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Ar.protocol=Ah;class _x extends Ar{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Ar.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ar.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){n||(n=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Dx=class extends _x{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>yx[r]).filter(r=>!!r)),super(e,n)}};function kx(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=au(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}const Ax=typeof ArrayBuffer=="function",Ex=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Th=Object.prototype.toString,Cx=typeof Blob=="function"||typeof Blob<"u"&&Th.call(Blob)==="[object BlobConstructor]",Vx=typeof File=="function"||typeof File<"u"&&Th.call(File)==="[object FileConstructor]";function rm(s){return Ax&&(s instanceof ArrayBuffer||Ex(s))||Cx&&s instanceof Blob||Vx&&s instanceof File}function al(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(al(s[t]))return!0;return!1}if(rm(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return al(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&al(s[t]))return!0;return!1}function wx(s){const e=[],t=s.data,n=s;return n.data=cu(t,e),n.attachments=e.length,{packet:n,buffers:e}}function cu(s,e){if(!s)return s;if(rm(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=cu(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=cu(s[n],e));return t}return s}function Sx(s,e){return s.data=uu(s.data,e),delete s.attachments,s}function uu(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=uu(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=uu(s[t],e));return s}const Tx=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Lx=5;var Et;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(Et||(Et={}));class Px{constructor(e){this.replacer=e}encode(e){return(e.type===Et.EVENT||e.type===Et.ACK)&&al(e)?this.encodeAsBinary({type:e.type===Et.EVENT?Et.BINARY_EVENT:Et.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Et.BINARY_EVENT||e.type===Et.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=wx(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function Fd(s){return Object.prototype.toString.call(s)==="[object Object]"}class im extends Ds{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Et.BINARY_EVENT;n||t.type===Et.BINARY_ACK?(t.type=n?Et.EVENT:Et.ACK,this.reconstructor=new Ix(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(rm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(Et[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Et.BINARY_EVENT||n.type===Et.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(i,t)}else n.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(im.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Et.CONNECT:return Fd(t);case Et.DISCONNECT:return t===void 0;case Et.CONNECT_ERROR:return typeof t=="string"||Fd(t);case Et.EVENT:case Et.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Tx.indexOf(t[0])===-1);case Et.ACK:case Et.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ix{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Sx(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const jx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:im,Encoder:Px,get PacketType(){return Et},protocol:Lx},Symbol.toStringTag,{value:"Module"}));function En(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const Rx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Lh extends Ds{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[En(e,"open",this.onopen.bind(this)),En(e,"packet",this.onpacket.bind(this)),En(e,"error",this.onerror.bind(this)),En(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,i;if(Rx.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:Et.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{const i=(o,l)=>o?r(o):n(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Et.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Et.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Et.EVENT:case Et.BINARY_EVENT:this.onevent(e);break;case Et.ACK:case Et.BINARY_ACK:this.onack(e);break;case Et.DISCONNECT:this.ondisconnect();break;case Et.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:Et.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Et.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function no(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}no.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};no.prototype.reset=function(){this.attempts=0};no.prototype.setMin=function(s){this.ms=s};no.prototype.setMax=function(s){this.max=s};no.prototype.setJitter=function(s){this.jitter=s};class mu extends Ds{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Wl(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new no({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||jx;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Dx(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=En(t,"open",function(){n.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=En(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(En(e,"ping",this.onping.bind(this)),En(e,"data",this.ondata.bind(this)),En(e,"error",this.onerror.bind(this)),En(e,"close",this.onclose.bind(this)),En(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){$l(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Lh(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const vo={};function Fo(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=kx(s,e.path||"/socket.io"),n=t.source,r=t.id,i=t.path,o=vo[r]&&i in vo[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new mu(n,e):(vo[r]||(vo[r]=new mu(n,e)),u=vo[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Fo,{Manager:mu,Socket:Lh,io:Fo,connect:Fo});function Bx(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Xn(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,l==null||l.addEventListener("controlling",C=>{C.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",C=>{typeof C.isUpdate>"u"?typeof C.isExternal<"u"?C.isExternal?y():!h&&(n==null||n()):C.isExternal?window.location.reload():!h&&(n==null||n()):C.isUpdate||n==null||n()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const Ux=()=>{if(typeof window<"u"){const s=window.location.hostname;if(s==="hvlab.app"||s.includes("hv-lab-app")||s.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},Hx=Ux(),Zo=_N.create({baseURL:Hx,headers:{"Content-Type":"application/json"}});Zo.interceptors.request.use(s=>{const e=localStorage.getItem("token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));Zo.interceptors.response.use(s=>s,s=>{var e,t,n;return((e=s.response)==null?void 0:e.status)===401&&!((n=(t=s.config)==null?void 0:t.url)!=null&&n.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Mx=()=>{};var qd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Ox=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const r=s[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=s[t++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=s[t++],o=s[t++],l=s[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=s[t++],o=s[t++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ih={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<s.length;r+=3){const i=s[r],o=r+1<s.length,l=o?s[r+1]:0,u=r+2<s.length,m=u?s[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(h=64)),n.push(t[d],t[f],t[h],t[y])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Ph(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Ox(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<s.length;){const i=t[s.charAt(r++)],l=r<s.length?t[s.charAt(r)]:0;++r;const m=r<s.length?t[s.charAt(r)]:64;++r;const f=r<s.length?t[s.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new Fx;const h=i<<2|l>>4;if(n.push(h),m!==64){const y=l<<4&240|m>>2;if(n.push(y),f!==64){const C=m<<6&192|f;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Fx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qx=function(s){const e=Ph(s);return Ih.encodeByteArray(e,!0)},xl=function(s){return qx(s).replace(/\./g,"")},$x=function(s){try{return Ih.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=()=>Wx().__FIREBASE_DEFAULTS__,Kx=()=>{if(typeof process>"u"||typeof qd>"u")return;const s=qd.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Qx=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&$x(s[1]);return e&&JSON.parse(e)},om=()=>{try{return Mx()||zx()||Kx()||Qx()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Yx=s=>{var e,t;return(t=(e=om())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},jh=s=>{const e=Yx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Rh=()=>{var s;return(s=om())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bh(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=s.iat||0,i=s.sub||s.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...s};return[xl(JSON.stringify(t)),xl(JSON.stringify(o)),""].join(".")}const qo={};function Xx(){const s={prod:[],emulator:[]};for(const e of Object.keys(qo))qo[e]?s.emulator.push(e):s.prod.push(e);return s}function Jx(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let $d=!1;function Hh(s,e){if(typeof window>"u"||typeof document>"u"||!ha(window.location.host)||qo[s]===e||qo[s]||$d)return;qo[s]=e;function t(h){return`__firebase__banner__${h}`}const n="__firebase__banner",i=Xx().prod.length>0;function o(){const h=document.getElementById(n);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{$d=!0,o()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=Jx(n),y=t("text"),C=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),V=document.getElementById(v)||document.createElement("a"),B=t("preprendIcon"),T=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const q=h.element;l(q),d(V,v);const oe=m();u(T,B),q.append(T,C,V,oe),document.body.appendChild(q)}i?(C.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ev(){var e;const s=(e=om())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tv(){return!ev()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sv(){try{return typeof indexedDB=="object"}catch{return!1}}function nv(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="FirebaseError";class di extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=rv,Object.setPrototypeOf(this,di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mh.prototype.create)}}class Mh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?iv(i,n):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new di(r,l,n)}}function iv(s,e){return s.replace(ov,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const ov=/\{\$([^}]+)}/g;function vl(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const i=s[r],o=e[r];if(Wd(i)&&Wd(o)){if(!vl(i,o))return!1}else if(i!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function Wd(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(s){return s&&s._delegate?s._delegate:s}class Qi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Gx;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cv(e))try{this.getOrInitializeService({instanceIdentifier:ti})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ti){return this.instances.has(e)}getOptions(e=ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:lv(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ti){return this.component?this.component.multipleInstances?e:ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lv(s){return s===ti?void 0:s}function cv(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new av(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(wt||(wt={}));const mv={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},dv=wt.INFO,fv={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},pv=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),r=fv[e];if(r)console[r](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Oh{constructor(e){this.name=e,this._logLevel=dv,this._logHandler=pv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}const hv=(s,e)=>e.some(t=>s instanceof t);let zd,Kd;function gv(){return zd||(zd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yv(){return Kd||(Kd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fh=new WeakMap,du=new WeakMap,qh=new WeakMap,jc=new WeakMap,am=new WeakMap;function bv(s){const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("success",i),s.removeEventListener("error",o)},i=()=>{t(Er(s.result)),r()},o=()=>{n(s.error),r()};s.addEventListener("success",i),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Fh.set(t,s)}).catch(()=>{}),am.set(e,s),e}function Nv(s){if(du.has(s))return;const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("complete",i),s.removeEventListener("error",o),s.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",i),s.addEventListener("error",o),s.addEventListener("abort",o)});du.set(s,e)}let fu={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return du.get(s);if(e==="objectStoreNames")return s.objectStoreNames||qh.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Er(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function xv(s){fu=s(fu)}function vv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Rc(this),e,...t);return qh.set(n,e.sort?e.sort():[e]),Er(n)}:yv().includes(s)?function(...e){return s.apply(Rc(this),e),Er(Fh.get(this))}:function(...e){return Er(s.apply(Rc(this),e))}}function _v(s){return typeof s=="function"?vv(s):(s instanceof IDBTransaction&&Nv(s),hv(s,gv())?new Proxy(s,fu):s)}function Er(s){if(s instanceof IDBRequest)return bv(s);if(jc.has(s))return jc.get(s);const e=_v(s);return e!==s&&(jc.set(s,e),am.set(e,s)),e}const Rc=s=>am.get(s);function Dv(s,e,{blocked:t,upgrade:n,blocking:r,terminated:i}={}){const o=indexedDB.open(s,e),l=Er(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Er(o.result),u.oldVersion,u.newVersion,Er(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const kv=["get","getKey","getAll","getAllKeys","count"],Av=["put","add","delete","clear"],Bc=new Map;function Qd(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Bc.get(e))return Bc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=Av.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||kv.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return n&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Bc.set(e,i),i}xv(s=>({...s,get:(e,t,n)=>Qd(e,t)||s.get(e,t,n),has:(e,t)=>!!Qd(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cv(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Cv(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pu="@firebase/app",Yd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr=new Oh("@firebase/app"),Vv="@firebase/app-compat",wv="@firebase/analytics-compat",Sv="@firebase/analytics",Tv="@firebase/app-check-compat",Lv="@firebase/app-check",Pv="@firebase/auth",Iv="@firebase/auth-compat",jv="@firebase/database",Rv="@firebase/data-connect",Bv="@firebase/database-compat",Uv="@firebase/functions",Hv="@firebase/functions-compat",Mv="@firebase/installations",Ov="@firebase/installations-compat",Fv="@firebase/messaging",qv="@firebase/messaging-compat",$v="@firebase/performance",Wv="@firebase/performance-compat",zv="@firebase/remote-config",Kv="@firebase/remote-config-compat",Qv="@firebase/storage",Yv="@firebase/storage-compat",Gv="@firebase/firestore",Xv="@firebase/ai",Jv="@firebase/firestore-compat",Zv="firebase",e_="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="[DEFAULT]",t_={[pu]:"fire-core",[Vv]:"fire-core-compat",[Sv]:"fire-analytics",[wv]:"fire-analytics-compat",[Lv]:"fire-app-check",[Tv]:"fire-app-check-compat",[Pv]:"fire-auth",[Iv]:"fire-auth-compat",[jv]:"fire-rtdb",[Rv]:"fire-data-connect",[Bv]:"fire-rtdb-compat",[Uv]:"fire-fn",[Hv]:"fire-fn-compat",[Mv]:"fire-iid",[Ov]:"fire-iid-compat",[Fv]:"fire-fcm",[qv]:"fire-fcm-compat",[$v]:"fire-perf",[Wv]:"fire-perf-compat",[zv]:"fire-rc",[Kv]:"fire-rc-compat",[Qv]:"fire-gcs",[Yv]:"fire-gcs-compat",[Gv]:"fire-fst",[Jv]:"fire-fst-compat",[Xv]:"fire-vertex","fire-js":"fire-js",[Zv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new Map,s_=new Map,gu=new Map;function Gd(s,e){try{s.container.addComponent(e)}catch(t){lr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ta(s){const e=s.name;if(gu.has(e))return lr.debug(`There were multiple attempts to register component ${e}.`),!1;gu.set(e,s);for(const t of ea.values())Gd(t,s);for(const t of s_.values())Gd(t,s);return!0}function $h(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Wh(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cr=new Mh("app","Firebase",n_);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Cr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=e_;function Kh(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:hu,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw Cr.create("bad-app-name",{appName:String(r)});if(t||(t=Rh()),!t)throw Cr.create("no-options");const i=ea.get(r);if(i){if(vl(t,i.options)&&vl(n,i.config))return i;throw Cr.create("duplicate-app",{appName:r})}const o=new uv(r);for(const u of gu.values())o.addComponent(u);const l=new r_(t,n,o);return ea.set(r,l),l}function Qh(s=hu){const e=ea.get(s);if(!e&&s===hu&&Rh())return Kh();if(!e)throw Cr.create("no-app",{appName:s});return e}function Xd(){return Array.from(ea.values())}function Vr(s,e,t){let n=t_[s]??s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),lr.warn(o.join(" "));return}ta(new Qi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="firebase-heartbeat-database",o_=1,sa="firebase-heartbeat-store";let Uc=null;function Yh(){return Uc||(Uc=Dv(i_,o_,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(sa)}catch(t){console.warn(t)}}}}).catch(s=>{throw Cr.create("idb-open",{originalErrorMessage:s.message})})),Uc}async function a_(s){try{const t=(await Yh()).transaction(sa),n=await t.objectStore(sa).get(Gh(s));return await t.done,n}catch(e){if(e instanceof di)lr.warn(e.message);else{const t=Cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});lr.warn(t.message)}}}async function Jd(s,e){try{const n=(await Yh()).transaction(sa,"readwrite");await n.objectStore(sa).put(e,Gh(s)),await n.done}catch(t){if(t instanceof di)lr.warn(t.message);else{const n=Cr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});lr.warn(n.message)}}}function Gh(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=1024,c_=30;class u_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new d_(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Zd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>c_){const o=f_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){lr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Zd(),{heartbeatsToSend:n,unsentEntries:r}=m_(this._heartbeatsCache.heartbeats),i=xl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return lr.warn(t),""}}}function Zd(){return new Date().toISOString().substring(0,10)}function m_(s,e=l_){const t=[];let n=s.slice();for(const r of s){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),ef(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ef(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class d_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sv()?nv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await a_(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function ef(s){return xl(JSON.stringify({version:2,heartbeats:s})).length}function f_(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(s){ta(new Qi("platform-logger",e=>new Ev(e),"PRIVATE")),ta(new Qi("heartbeat",e=>new u_(e),"PRIVATE")),Vr(pu,Yd,s),Vr(pu,Yd,"esm2020"),Vr("fire-js","")}p_("");var h_="firebase",g_="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vr(h_,g_,"app");var tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wr,Xh;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,x){function A(){}A.prototype=x.prototype,E.F=x.prototype,E.prototype=new A,E.prototype.constructor=E,E.D=function(P,S,w){for(var k=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)k[Ae-2]=arguments[Ae];return x.prototype[S].apply(P,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,x,A){A||(A=0);const P=Array(16);if(typeof x=="string")for(var S=0;S<16;++S)P[S]=x.charCodeAt(A++)|x.charCodeAt(A++)<<8|x.charCodeAt(A++)<<16|x.charCodeAt(A++)<<24;else for(S=0;S<16;++S)P[S]=x[A++]|x[A++]<<8|x[A++]<<16|x[A++]<<24;x=E.g[0],A=E.g[1],S=E.g[2];let w=E.g[3],k;k=x+(w^A&(S^w))+P[0]+3614090360&4294967295,x=A+(k<<7&4294967295|k>>>25),k=w+(S^x&(A^S))+P[1]+3905402710&4294967295,w=x+(k<<12&4294967295|k>>>20),k=S+(A^w&(x^A))+P[2]+606105819&4294967295,S=w+(k<<17&4294967295|k>>>15),k=A+(x^S&(w^x))+P[3]+3250441966&4294967295,A=S+(k<<22&4294967295|k>>>10),k=x+(w^A&(S^w))+P[4]+4118548399&4294967295,x=A+(k<<7&4294967295|k>>>25),k=w+(S^x&(A^S))+P[5]+1200080426&4294967295,w=x+(k<<12&4294967295|k>>>20),k=S+(A^w&(x^A))+P[6]+2821735955&4294967295,S=w+(k<<17&4294967295|k>>>15),k=A+(x^S&(w^x))+P[7]+4249261313&4294967295,A=S+(k<<22&4294967295|k>>>10),k=x+(w^A&(S^w))+P[8]+1770035416&4294967295,x=A+(k<<7&4294967295|k>>>25),k=w+(S^x&(A^S))+P[9]+2336552879&4294967295,w=x+(k<<12&4294967295|k>>>20),k=S+(A^w&(x^A))+P[10]+4294925233&4294967295,S=w+(k<<17&4294967295|k>>>15),k=A+(x^S&(w^x))+P[11]+2304563134&4294967295,A=S+(k<<22&4294967295|k>>>10),k=x+(w^A&(S^w))+P[12]+1804603682&4294967295,x=A+(k<<7&4294967295|k>>>25),k=w+(S^x&(A^S))+P[13]+4254626195&4294967295,w=x+(k<<12&4294967295|k>>>20),k=S+(A^w&(x^A))+P[14]+2792965006&4294967295,S=w+(k<<17&4294967295|k>>>15),k=A+(x^S&(w^x))+P[15]+1236535329&4294967295,A=S+(k<<22&4294967295|k>>>10),k=x+(S^w&(A^S))+P[1]+4129170786&4294967295,x=A+(k<<5&4294967295|k>>>27),k=w+(A^S&(x^A))+P[6]+3225465664&4294967295,w=x+(k<<9&4294967295|k>>>23),k=S+(x^A&(w^x))+P[11]+643717713&4294967295,S=w+(k<<14&4294967295|k>>>18),k=A+(w^x&(S^w))+P[0]+3921069994&4294967295,A=S+(k<<20&4294967295|k>>>12),k=x+(S^w&(A^S))+P[5]+3593408605&4294967295,x=A+(k<<5&4294967295|k>>>27),k=w+(A^S&(x^A))+P[10]+38016083&4294967295,w=x+(k<<9&4294967295|k>>>23),k=S+(x^A&(w^x))+P[15]+3634488961&4294967295,S=w+(k<<14&4294967295|k>>>18),k=A+(w^x&(S^w))+P[4]+3889429448&4294967295,A=S+(k<<20&4294967295|k>>>12),k=x+(S^w&(A^S))+P[9]+568446438&4294967295,x=A+(k<<5&4294967295|k>>>27),k=w+(A^S&(x^A))+P[14]+3275163606&4294967295,w=x+(k<<9&4294967295|k>>>23),k=S+(x^A&(w^x))+P[3]+4107603335&4294967295,S=w+(k<<14&4294967295|k>>>18),k=A+(w^x&(S^w))+P[8]+1163531501&4294967295,A=S+(k<<20&4294967295|k>>>12),k=x+(S^w&(A^S))+P[13]+2850285829&4294967295,x=A+(k<<5&4294967295|k>>>27),k=w+(A^S&(x^A))+P[2]+4243563512&4294967295,w=x+(k<<9&4294967295|k>>>23),k=S+(x^A&(w^x))+P[7]+1735328473&4294967295,S=w+(k<<14&4294967295|k>>>18),k=A+(w^x&(S^w))+P[12]+2368359562&4294967295,A=S+(k<<20&4294967295|k>>>12),k=x+(A^S^w)+P[5]+4294588738&4294967295,x=A+(k<<4&4294967295|k>>>28),k=w+(x^A^S)+P[8]+2272392833&4294967295,w=x+(k<<11&4294967295|k>>>21),k=S+(w^x^A)+P[11]+1839030562&4294967295,S=w+(k<<16&4294967295|k>>>16),k=A+(S^w^x)+P[14]+4259657740&4294967295,A=S+(k<<23&4294967295|k>>>9),k=x+(A^S^w)+P[1]+2763975236&4294967295,x=A+(k<<4&4294967295|k>>>28),k=w+(x^A^S)+P[4]+1272893353&4294967295,w=x+(k<<11&4294967295|k>>>21),k=S+(w^x^A)+P[7]+4139469664&4294967295,S=w+(k<<16&4294967295|k>>>16),k=A+(S^w^x)+P[10]+3200236656&4294967295,A=S+(k<<23&4294967295|k>>>9),k=x+(A^S^w)+P[13]+681279174&4294967295,x=A+(k<<4&4294967295|k>>>28),k=w+(x^A^S)+P[0]+3936430074&4294967295,w=x+(k<<11&4294967295|k>>>21),k=S+(w^x^A)+P[3]+3572445317&4294967295,S=w+(k<<16&4294967295|k>>>16),k=A+(S^w^x)+P[6]+76029189&4294967295,A=S+(k<<23&4294967295|k>>>9),k=x+(A^S^w)+P[9]+3654602809&4294967295,x=A+(k<<4&4294967295|k>>>28),k=w+(x^A^S)+P[12]+3873151461&4294967295,w=x+(k<<11&4294967295|k>>>21),k=S+(w^x^A)+P[15]+530742520&4294967295,S=w+(k<<16&4294967295|k>>>16),k=A+(S^w^x)+P[2]+3299628645&4294967295,A=S+(k<<23&4294967295|k>>>9),k=x+(S^(A|~w))+P[0]+4096336452&4294967295,x=A+(k<<6&4294967295|k>>>26),k=w+(A^(x|~S))+P[7]+1126891415&4294967295,w=x+(k<<10&4294967295|k>>>22),k=S+(x^(w|~A))+P[14]+2878612391&4294967295,S=w+(k<<15&4294967295|k>>>17),k=A+(w^(S|~x))+P[5]+4237533241&4294967295,A=S+(k<<21&4294967295|k>>>11),k=x+(S^(A|~w))+P[12]+1700485571&4294967295,x=A+(k<<6&4294967295|k>>>26),k=w+(A^(x|~S))+P[3]+2399980690&4294967295,w=x+(k<<10&4294967295|k>>>22),k=S+(x^(w|~A))+P[10]+4293915773&4294967295,S=w+(k<<15&4294967295|k>>>17),k=A+(w^(S|~x))+P[1]+2240044497&4294967295,A=S+(k<<21&4294967295|k>>>11),k=x+(S^(A|~w))+P[8]+1873313359&4294967295,x=A+(k<<6&4294967295|k>>>26),k=w+(A^(x|~S))+P[15]+4264355552&4294967295,w=x+(k<<10&4294967295|k>>>22),k=S+(x^(w|~A))+P[6]+2734768916&4294967295,S=w+(k<<15&4294967295|k>>>17),k=A+(w^(S|~x))+P[13]+1309151649&4294967295,A=S+(k<<21&4294967295|k>>>11),k=x+(S^(A|~w))+P[4]+4149444226&4294967295,x=A+(k<<6&4294967295|k>>>26),k=w+(A^(x|~S))+P[11]+3174756917&4294967295,w=x+(k<<10&4294967295|k>>>22),k=S+(x^(w|~A))+P[2]+718787259&4294967295,S=w+(k<<15&4294967295|k>>>17),k=A+(w^(S|~x))+P[9]+3951481745&4294967295,E.g[0]=E.g[0]+x&4294967295,E.g[1]=E.g[1]+(S+(k<<21&4294967295|k>>>11))&4294967295,E.g[2]=E.g[2]+S&4294967295,E.g[3]=E.g[3]+w&4294967295}n.prototype.v=function(E,x){x===void 0&&(x=E.length);const A=x-this.blockSize,P=this.C;let S=this.h,w=0;for(;w<x;){if(S==0)for(;w<=A;)r(this,E,w),w+=this.blockSize;if(typeof E=="string"){for(;w<x;)if(P[S++]=E.charCodeAt(w++),S==this.blockSize){r(this,P),S=0;break}}else for(;w<x;)if(P[S++]=E[w++],S==this.blockSize){r(this,P),S=0;break}}this.h=S,this.o+=x},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var x=1;x<E.length-8;++x)E[x]=0;x=this.o*8;for(var A=E.length-8;A<E.length;++A)E[A]=x&255,x/=256;for(this.v(E),E=Array(16),x=0,A=0;A<4;++A)for(let P=0;P<32;P+=8)E[x++]=this.g[A]>>>P&255;return E};function i(E,x){var A=l;return Object.prototype.hasOwnProperty.call(A,E)?A[E]:A[E]=x(E)}function o(E,x){this.h=x;const A=[];let P=!0;for(let S=E.length-1;S>=0;S--){const w=E[S]|0;P&&w==x||(A[S]=w,P=!1)}this.g=A}var l={};function u(E){return-128<=E&&E<128?i(E,function(x){return new o([x|0],x<0?-1:0)}):new o([E|0],E<0?-1:0)}function m(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return V(m(-E));const x=[];let A=1;for(let P=0;E>=A;P++)x[P]=E/A|0,A*=4294967296;return new o(x,0)}function d(E,x){if(E.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(E.charAt(0)=="-")return V(d(E.substring(1),x));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=m(Math.pow(x,8));let P=f;for(let w=0;w<E.length;w+=8){var S=Math.min(8,E.length-w);const k=parseInt(E.substring(w,w+S),x);S<8?(S=m(Math.pow(x,S)),P=P.j(S).add(m(k))):(P=P.j(A),P=P.add(m(k)))}return P}var f=u(0),h=u(1),y=u(16777216);s=o.prototype,s.m=function(){if(v(this))return-V(this).m();let E=0,x=1;for(let A=0;A<this.g.length;A++){const P=this.i(A);E+=(P>=0?P:4294967296+P)*x,x*=4294967296}return E},s.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(v(this))return"-"+V(this).toString(E);const x=m(Math.pow(E,6));var A=this;let P="";for(;;){const S=oe(A,x).g;A=B(A,S.j(x));let w=((A.g.length>0?A.g[0]:A.h)>>>0).toString(E);if(A=S,C(A))return w+P;for(;w.length<6;)w="0"+w;P=w+P}},s.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(let x=0;x<E.g.length;x++)if(E.g[x]!=0)return!1;return!0}function v(E){return E.h==-1}s.l=function(E){return E=B(this,E),v(E)?-1:C(E)?0:1};function V(E){const x=E.g.length,A=[];for(let P=0;P<x;P++)A[P]=~E.g[P];return new o(A,~E.h).add(h)}s.abs=function(){return v(this)?V(this):this},s.add=function(E){const x=Math.max(this.g.length,E.g.length),A=[];let P=0;for(let S=0;S<=x;S++){let w=P+(this.i(S)&65535)+(E.i(S)&65535),k=(w>>>16)+(this.i(S)>>>16)+(E.i(S)>>>16);P=k>>>16,w&=65535,k&=65535,A[S]=k<<16|w}return new o(A,A[A.length-1]&-2147483648?-1:0)};function B(E,x){return E.add(V(x))}s.j=function(E){if(C(this)||C(E))return f;if(v(this))return v(E)?V(this).j(V(E)):V(V(this).j(E));if(v(E))return V(this.j(V(E)));if(this.l(y)<0&&E.l(y)<0)return m(this.m()*E.m());const x=this.g.length+E.g.length,A=[];for(var P=0;P<2*x;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(let S=0;S<E.g.length;S++){const w=this.i(P)>>>16,k=this.i(P)&65535,Ae=E.i(S)>>>16,He=E.i(S)&65535;A[2*P+2*S]+=k*He,T(A,2*P+2*S),A[2*P+2*S+1]+=w*He,T(A,2*P+2*S+1),A[2*P+2*S+1]+=k*Ae,T(A,2*P+2*S+1),A[2*P+2*S+2]+=w*Ae,T(A,2*P+2*S+2)}for(E=0;E<x;E++)A[E]=A[2*E+1]<<16|A[2*E];for(E=x;E<2*x;E++)A[E]=0;return new o(A,0)};function T(E,x){for(;(E[x]&65535)!=E[x];)E[x+1]+=E[x]>>>16,E[x]&=65535,x++}function q(E,x){this.g=E,this.h=x}function oe(E,x){if(C(x))throw Error("division by zero");if(C(E))return new q(f,f);if(v(E))return x=oe(V(E),x),new q(V(x.g),V(x.h));if(v(x))return x=oe(E,V(x)),new q(V(x.g),x.h);if(E.g.length>30){if(v(E)||v(x))throw Error("slowDivide_ only works with positive integers.");for(var A=h,P=x;P.l(E)<=0;)A=te(A),P=te(P);var S=O(A,1),w=O(P,1);for(P=O(P,2),A=O(A,2);!C(P);){var k=w.add(P);k.l(E)<=0&&(S=S.add(A),w=k),P=O(P,1),A=O(A,1)}return x=B(E,S.j(x)),new q(S,x)}for(S=f;E.l(x)>=0;){for(A=Math.max(1,Math.floor(E.m()/x.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),w=m(A),k=w.j(x);v(k)||k.l(E)>0;)A-=P,w=m(A),k=w.j(x);C(w)&&(w=h),S=S.add(w),E=B(E,k)}return new q(S,E)}s.B=function(E){return oe(this,E).h},s.and=function(E){const x=Math.max(this.g.length,E.g.length),A=[];for(let P=0;P<x;P++)A[P]=this.i(P)&E.i(P);return new o(A,this.h&E.h)},s.or=function(E){const x=Math.max(this.g.length,E.g.length),A=[];for(let P=0;P<x;P++)A[P]=this.i(P)|E.i(P);return new o(A,this.h|E.h)},s.xor=function(E){const x=Math.max(this.g.length,E.g.length),A=[];for(let P=0;P<x;P++)A[P]=this.i(P)^E.i(P);return new o(A,this.h^E.h)};function te(E){const x=E.g.length+1,A=[];for(let P=0;P<x;P++)A[P]=E.i(P)<<1|E.i(P-1)>>>31;return new o(A,E.h)}function O(E,x){const A=x>>5;x%=32;const P=E.g.length-A,S=[];for(let w=0;w<P;w++)S[w]=x>0?E.i(w+A)>>>x|E.i(w+A+1)<<32-x:E.i(w+A);return new o(S,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Xh=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,wr=o}).apply(typeof tf<"u"?tf:typeof self<"u"?self:typeof window<"u"?window:{});var Ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jh,Bo,Zh,ll,yu,eg,tg,sg;(function(){var s,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ba=="object"&&Ba];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=t(this);function r(c,p){if(p)e:{var g=n;c=c.split(".");for(var _=0;_<c.length-1;_++){var $=c[_];if(!($ in g))break e;g=g[$]}c=c[c.length-1],_=g[c],p=p(_),p!=_&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],_;for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&g.push([_,p[_]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(_,$,X){for(var De=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)De[ht-2]=arguments[ht];return p.prototype[$].apply(_,De)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let _=0;_<p;_++)g[_]=c[_];return g}return[]}function C(c,p){for(let _=1;_<arguments.length;_++){const $=arguments[_];var g=typeof $;if(g=g!="object"?g:$?Array.isArray($)?"array":g:"null",g=="array"||g=="object"&&typeof $.length=="number"){g=c.length||0;const X=$.length||0;c.length=g+X;for(let De=0;De<X;De++)c[g+De]=$[De]}else c.push($)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function V(c){o.setTimeout(()=>{throw c},0)}function B(){var c=E;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class T{constructor(){this.h=this.g=null}add(p,g){const _=q.get();_.set(p,g),this.h?this.h.next=_:this.g=_,this.h=_}}var q=new v(()=>new oe,c=>c.reset());class oe{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let te,O=!1,E=new T,x=()=>{const c=Promise.resolve(void 0);te=()=>{c.then(A)}};function A(){for(var c;c=B();){try{c.h.call(c.g)}catch(g){V(g)}var p=q;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}O=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var w=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function Ae(c,p){S.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(Ae,S),Ae.prototype.init=function(c,p){const g=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Ae.Z.h.call(this)},Ae.prototype.h=function(){Ae.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var He="closure_listenable_"+(Math.random()*1e6|0),ye=0;function Be(c,p,g,_,$){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!_,this.ha=$,this.key=++ye,this.da=this.fa=!1}function gt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function $t(c,p,g){for(const _ in c)p.call(g,c[_],_,c)}function Ft(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(c,p){let g,_;for(let $=1;$<arguments.length;$++){_=arguments[$];for(g in _)c[g]=_[g];for(let X=0;X<Me.length;X++)g=Me[X],Object.prototype.hasOwnProperty.call(_,g)&&(c[g]=_[g])}}function Ie(c){this.src=c,this.g={},this.h=0}Ie.prototype.add=function(c,p,g,_,$){const X=c.toString();c=this.g[X],c||(c=this.g[X]=[],this.h++);const De=xt(c,p,_,$);return De>-1?(p=c[De],g||(p.fa=!1)):(p=new Be(p,this.src,X,!!_,$),p.fa=g,c.push(p)),p};function ze(c,p){const g=p.type;if(g in c.g){var _=c.g[g],$=Array.prototype.indexOf.call(_,p,void 0),X;(X=$>=0)&&Array.prototype.splice.call(_,$,1),X&&(gt(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function xt(c,p,g,_){for(let $=0;$<c.length;++$){const X=c[$];if(!X.da&&X.listener==p&&X.capture==!!g&&X.ha==_)return $}return-1}var it="closure_lm_"+(Math.random()*1e6|0),Tt={};function nt(c,p,g,_,$){if(Array.isArray(p)){for(let X=0;X<p.length;X++)nt(c,p[X],g,_,$);return null}return g=Wt(g),c&&c[He]?c.J(p,g,l(_)?!!_.capture:!1,$):ft(c,p,g,!1,_,$)}function ft(c,p,g,_,$,X){if(!p)throw Error("Invalid event type");const De=l($)?!!$.capture:!!$;let ht=Ye(c);if(ht||(c[it]=ht=new Ie(c)),g=ht.add(p,g,_,De,X),g.proxy)return g;if(_=us(),g.proxy=_,_.src=c,_.listener=g,c.addEventListener)w||($=De),$===void 0&&($=!1),c.addEventListener(p.toString(),_,$);else if(c.attachEvent)c.attachEvent(Fe(p.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function us(){function c(g){return p.call(c.src,c.listener,g)}const p=Te;return c}function K(c,p,g,_,$){if(Array.isArray(p))for(var X=0;X<p.length;X++)K(c,p[X],g,_,$);else _=l(_)?!!_.capture:!!_,g=Wt(g),c&&c[He]?(c=c.i,X=String(p).toString(),X in c.g&&(p=c.g[X],g=xt(p,g,_,$),g>-1&&(gt(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[X],c.h--)))):c&&(c=Ye(c))&&(p=c.g[p.toString()],c=-1,p&&(c=xt(p,g,_,$)),(g=c>-1?p[c]:null)&&Pe(g))}function Pe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[He])ze(p.i,c);else{var g=c.type,_=c.proxy;p.removeEventListener?p.removeEventListener(g,_,c.capture):p.detachEvent?p.detachEvent(Fe(g),_):p.addListener&&p.removeListener&&p.removeListener(_),(g=Ye(p))?(ze(g,c),g.h==0&&(g.src=null,p[it]=null)):gt(c)}}}function Fe(c){return c in Tt?Tt[c]:Tt[c]="on"+c}function Te(c,p){if(c.da)c=!0;else{p=new Ae(p,this);const g=c.listener,_=c.ha||c.src;c.fa&&Pe(c),c=g.call(_,p)}return c}function Ye(c){return c=c[it],c instanceof Ie?c:null}var Lt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wt(c){return typeof c=="function"?c:(c[Lt]||(c[Lt]=function(p){return c.handleEvent(p)}),c[Lt])}function mt(){P.call(this),this.i=new Ie(this),this.M=this,this.G=null}f(mt,P),mt.prototype[He]=!0,mt.prototype.removeEventListener=function(c,p,g,_){K(this,c,p,g,_)};function L(c,p){var g,_=c.G;if(_)for(g=[];_;_=_.G)g.push(_);if(c=c.M,_=p.type||p,typeof p=="string")p=new S(p,c);else if(p instanceof S)p.target=p.target||c;else{var $=p;p=new S(_,c),de(p,$)}$=!0;let X,De;if(g)for(De=g.length-1;De>=0;De--)X=p.g=g[De],$=F(X,_,!0,p)&&$;if(X=p.g=c,$=F(X,_,!0,p)&&$,$=F(X,_,!1,p)&&$,g)for(De=0;De<g.length;De++)X=p.g=g[De],$=F(X,_,!1,p)&&$}mt.prototype.N=function(){if(mt.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let _=0;_<g.length;_++)gt(g[_]);delete c.g[p],c.h--}}this.G=null},mt.prototype.J=function(c,p,g,_){return this.i.add(String(c),p,!1,g,_)},mt.prototype.K=function(c,p,g,_){return this.i.add(String(c),p,!0,g,_)};function F(c,p,g,_){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let $=!0;for(let X=0;X<p.length;++X){const De=p[X];if(De&&!De.da&&De.capture==g){const ht=De.listener,Cs=De.ha||De.src;De.fa&&ze(c.i,De),$=ht.call(Cs,_)!==!1&&$}}return $&&!_.defaultPrevented}function J(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function xe(c){c.g=J(()=>{c.g=null,c.i&&(c.i=!1,xe(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ue extends P{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){P.call(this),this.h=c,this.g={}}f(fe,P);var we=[];function Oe(c){$t(c.g,function(p,g){this.g.hasOwnProperty(g)&&Pe(p)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),Oe(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=o.JSON.stringify,Ee=o.JSON.parse,Bs=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Bt(){}function ee(){}var Ge={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function M(){S.call(this,"d")}f(M,S);function ge(){S.call(this,"c")}f(ge,S);var ke={},je=null;function me(){return je=je||new mt}ke.Ia="serverreachability";function Ut(c){S.call(this,ke.Ia,c)}f(Ut,S);function At(c){const p=me();L(p,new Ut(p))}ke.STAT_EVENT="statevent";function Qt(c,p){S.call(this,ke.STAT_EVENT,c),this.stat=p}f(Qt,S);function vt(c){const p=me();L(p,new Qt(p,c))}ke.Ja="timingevent";function fs(c,p){S.call(this,ke.Ja,c),this.size=p}f(fs,S);function zt(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function ps(){this.g=!0}ps.prototype.ua=function(){this.g=!1};function gn(c,p,g,_,$,X){c.info(function(){if(c.g)if(X){var De="",ht=X.split("&");for(let Gt=0;Gt<ht.length;Gt++){var Cs=ht[Gt].split("=");if(Cs.length>1){const Ps=Cs[0];Cs=Cs[1];const Un=Ps.split("_");De=Un.length>=2&&Un[1]=="type"?De+(Ps+"="+Cs+"&"):De+(Ps+"=redacted&")}}}else De=null;else De=X;return"XMLHTTP REQ ("+_+") [attempt "+$+"]: "+p+`
`+g+`
`+De})}function Js(c,p,g,_,$,X,De){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+$+"]: "+p+`
`+g+`
`+X+" "+De})}function yn(c,p,g,_){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+jn(c,g)+(_?" "+_:"")})}function Gr(c,p){c.info(function(){return"TIMEOUT: "+p})}ps.prototype.info=function(){};function jn(c,p){if(!c.g)return p;if(!p)return null;try{const X=JSON.parse(p);if(X){for(c=0;c<X.length;c++)if(Array.isArray(X[c])){var g=X[c];if(!(g.length<2)){var _=g[1];if(Array.isArray(_)&&!(_.length<1)){var $=_[0];if($!="noop"&&$!="stop"&&$!="close")for(let De=1;De<_.length;De++)_[De]=""}}}}return et(X)}catch{return p}}var sn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Rn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Us;function Ts(){}f(Ts,Bt),Ts.prototype.g=function(){return new XMLHttpRequest},Us=new Ts;function I(c){return encodeURIComponent(String(c))}function pe(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function N(c,p,g,_){this.j=c,this.i=p,this.l=g,this.S=_||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new R}function R(){this.i=null,this.g="",this.h=!1}var j={},Q={};function H(c,p,g){c.M=1,c.A=hs(dt(p)),c.u=g,c.R=!0,W(c,null)}function W(c,p){c.F=Date.now(),he(c),c.B=dt(c.A);var g=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),le(g.i,"t",_),c.C=0,g=c.j.L,c.h=new R,c.g=Ad(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ue(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,_=c.ba;var $="readystatechange";Array.isArray($)||($&&(we[0]=$.toString()),$=we);for(let X=0;X<$.length;X++){const De=nt(g,$[X],_||p.handleEvent,!1,p.h||p);if(!De)break;p.g[De.key]=De}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),At(),gn(c.i,c.v,c.B,c.l,c.S,c.u)}N.prototype.ba=function(c){c=c.target;const p=this.O;p&&kn(c)==3?p.j():this.Y(c)},N.prototype.Y=function(c){try{if(c==this.g)e:{const ht=kn(this.g),Cs=this.g.ya(),Gt=this.g.ca();if(!(ht<3)&&(ht!=3||this.g&&(this.h.h||this.g.la()||pd(this.g)))){this.K||ht!=4||Cs==7||(Cs==8||Gt<=0?At(3):At(2)),pt(this);var p=this.g.ca();this.X=p;var g=re(this);if(this.o=p==200,Js(this.i,this.v,this.B,this.l,this.S,ht,p),this.o){if(this.U&&!this.L){t:{if(this.g){var _,$=this.g;if((_=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_)){var X=_;break t}}X=null}if(c=X)yn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ot(this,c);else{this.o=!1,this.m=3,vt(12),_e(this),Ke(this);break e}}if(this.R){c=!0;let Ps;for(;!this.K&&this.C<g.length;)if(Ps=Z(this,g),Ps==Q){ht==4&&(this.m=4,vt(14),c=!1),yn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ps==j){this.m=4,vt(15),yn(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else yn(this.i,this.l,Ps,null),ot(this,Ps);if(Y(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||g.length!=0||this.h.h||(this.m=1,vt(16),c=!1),this.o=this.o&&c,!c)yn(this.i,this.l,g,"[Invalid Chunked Response]"),_e(this),Ke(this);else if(g.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Cc(De),De.P=!0,vt(11))}}else yn(this.i,this.l,g,null),ot(this,g);ht==4&&_e(this),this.o&&!this.K&&(ht==4?vd(this.j,this):(this.o=!1,he(this)))}else fN(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,vt(12)):(this.m=0,vt(13)),_e(this),Ke(this)}}}catch{}finally{}};function re(c){if(!Y(c))return c.g.la();const p=pd(c.g);if(p==="")return"";let g="";const _=p.length,$=kn(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return _e(c),Ke(c),"";c.h.i=new o.TextDecoder}for(let X=0;X<_;X++)c.h.h=!0,g+=c.h.i.decode(p[X],{stream:!($&&X==_-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Y(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Z(c,p){var g=c.C,_=p.indexOf(`
`,g);return _==-1?Q:(g=Number(p.substring(g,_)),isNaN(g)?j:(_+=1,_+g>p.length?Q:(p=p.slice(_,_+g),c.C=_+g,p)))}N.prototype.cancel=function(){this.K=!0,_e(this)};function he(c){c.T=Date.now()+c.H,Je(c,c.H)}function Je(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=zt(m(c.aa,c),p)}function pt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}N.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Gr(this.i,this.B),this.M!=2&&(At(),vt(17)),_e(this),this.m=2,Ke(this)):Je(this,this.T-c)};function Ke(c){c.j.I==0||c.K||vd(c.j,c)}function _e(c){pt(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Oe(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function ot(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Ms(g.h,c))){if(!c.L&&Ms(g.h,c)&&g.I==3){try{var _=g.Ba.g.parse(p)}catch{_=null}if(Array.isArray(_)&&_.length==3){var $=_;if($[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Ta(g),wa(g);else break e;Ec(g),vt(18)}}else g.xa=$[1],0<g.xa-g.K&&$[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=zt(m(g.Va,g),6e3));ts(g.h)<=1&&g.ta&&(g.ta=void 0)}else Xr(g,11)}else if((c.L||g.g==c)&&Ta(g),!k(p))for($=g.Ba.g.parse(p),p=0;p<$.length;p++){let Gt=$[p];const Ps=Gt[0];if(!(Ps<=g.K))if(g.K=Ps,Gt=Gt[1],g.I==2)if(Gt[0]=="c"){g.M=Gt[1],g.ba=Gt[2];const Un=Gt[3];Un!=null&&(g.ka=Un,g.j.info("VER="+g.ka));const Jr=Gt[4];Jr!=null&&(g.za=Jr,g.j.info("SVER="+g.za));const pr=Gt[5];pr!=null&&typeof pr=="number"&&pr>0&&(_=1.5*pr,g.O=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const hr=c.g;if(hr){const Pa=hr.g?hr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pa){var X=_.h;X.g||Pa.indexOf("spdy")==-1&&Pa.indexOf("quic")==-1&&Pa.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(ss(X,X.h),X.h=null))}if(_.G){const Vc=hr.g?hr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vc&&(_.wa=Vc,Qe(_.J,_.G,Vc))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),_=g;var De=c;if(_.na=kd(_,_.L?_.ba:null,_.W),De.L){yt(_.h,De);var ht=De,Cs=_.O;Cs&&(ht.H=Cs),ht.D&&(pt(ht),he(ht)),_.g=De}else Nd(_);g.i.length>0&&Sa(g)}else Gt[0]!="stop"&&Gt[0]!="close"||Xr(g,7);else g.I==3&&(Gt[0]=="stop"||Gt[0]=="close"?Gt[0]=="stop"?Xr(g,7):Ac(g):Gt[0]!="noop"&&g.l&&g.l.qa(Gt),g.A=0)}}At(4)}catch{}}var Hs=class{constructor(c,p){this.g=c,this.map=p}};function Ls(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nn(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function ts(c){return c.h?1:c.g?c.g.size:0}function Ms(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function ss(c,p){c.g?c.g.add(p):c.h=p}function yt(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Ls.prototype.cancel=function(){if(this.i=qe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function qe(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var Ce=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rt(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const _=c[g].indexOf("=");let $,X=null;_>=0?($=c[g].substring(0,_),X=c[g].substring(_+1)):$=c[g],p($,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function at(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof at?(this.l=c.l,Ue(this,c.j),this.o=c.o,this.g=c.g,tt(this,c.u),this.h=c.h,Rt(this,Ne(c.i)),this.m=c.m):c&&(p=String(c).match(Ce))?(this.l=!1,Ue(this,p[1]||"",!0),this.o=_n(p[2]||""),this.g=_n(p[3]||"",!0),tt(this,p[4]),this.h=_n(p[5]||"",!0),Rt(this,p[6]||"",!0),this.m=_n(p[7]||"")):(this.l=!1,this.i=new fr(null,this.l))}at.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(Jn(p,go,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Jn(p,go,!0),"@"),c.push(I(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Jn(g,g.charAt(0)=="/"?vc:Va,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Jn(g,Dc)),c.join("")},at.prototype.resolve=function(c){const p=dt(this);let g=!!c.j;g?Ue(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var _=c.h;if(g)tt(p,c.u);else if(g=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var $=p.h.lastIndexOf("/");$!=-1&&(_=p.h.slice(0,$+1)+_)}if($=_,$==".."||$==".")_="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){_=$.lastIndexOf("/",0)==0,$=$.split("/");const X=[];for(let De=0;De<$.length;){const ht=$[De++];ht=="."?_&&De==$.length&&X.push(""):ht==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),_&&De==$.length&&X.push("")):(X.push(ht),_=!0)}_=X.join("/")}else _=$}return g?p.h=_:g=c.i.toString()!=="",g?Rt(p,Ne(c.i)):g=!!c.m,g&&(p.m=c.m),p};function dt(c){return new at(c)}function Ue(c,p,g){c.j=g?_n(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function tt(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Rt(c,p,g){p instanceof fr?(c.i=p,ct(c.i,c.l)):(g||(p=Jn(p,_c)),c.i=new fr(p,c.l))}function Qe(c,p,g){c.i.set(p,g)}function hs(c){return Qe(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function _n(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Jn(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Ca),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ca(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var go=/[#\/\?@]/g,Va=/[#\?:]/g,vc=/[#\?]/g,_c=/[#\?@]/g,Dc=/#/g;function fr(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&rt(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}s=fr.prototype,s.add=function(c,p){b(this),this.i=null,c=be(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function U(c,p){b(c),p=be(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function G(c,p){return b(c),p=be(c,p),c.g.has(p)}s.forEach=function(c,p){b(this),this.g.forEach(function(g,_){g.forEach(function($){c.call(p,$,_,this)},this)},this)};function z(c,p){b(c);let g=[];if(typeof p=="string")G(c,p)&&(g=g.concat(c.g.get(be(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}s.set=function(c,p){return b(this),this.i=null,c=be(this,c),G(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},s.get=function(c,p){return c?(c=z(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){U(c,p),g.length>0&&(c.i=null,c.g.set(be(c,p),y(g)),c.h+=g.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let _=0;_<p.length;_++){var g=p[_];const $=I(g);g=z(this,g);for(let X=0;X<g.length;X++){let De=$;g[X]!==""&&(De+="="+I(g[X])),c.push(De)}}return this.i=c.join("&")};function Ne(c){const p=new fr;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function be(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function ct(c,p){p&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,_){const $=_.toLowerCase();_!=$&&(U(this,_),le(this,$,g))},c)),c.j=p}function bt(c,p){const g=new ps;if(o.Image){const _=new Image;_.onload=d(Pt,g,"TestLoadImage: loaded",!0,p,_),_.onerror=d(Pt,g,"TestLoadImage: error",!1,p,_),_.onabort=d(Pt,g,"TestLoadImage: abort",!1,p,_),_.ontimeout=d(Pt,g,"TestLoadImage: timeout",!1,p,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else p(!1)}function gs(c,p){const g=new ps,_=new AbortController,$=setTimeout(()=>{_.abort(),Pt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:_.signal}).then(X=>{clearTimeout($),X.ok?Pt(g,"TestPingServer: ok",!0,p):Pt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout($),Pt(g,"TestPingServer: error",!1,p)})}function Pt(c,p,g,_,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),_(g)}catch{}}function It(){this.g=new Bs}function ns(c){this.i=c.Sb||null,this.h=c.ab||!1}f(ns,Bt),ns.prototype.g=function(){return new Es(this.i,this.h)};function Es(c,p){mt.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Es,mt),s=Es.prototype,s.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ms(this)},s.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Zt(this)),this.readyState=0},s.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ms(this)),this.g&&(this.readyState=3,ms(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ct(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ct(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}s.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Zt(this):ms(this),this.readyState==3&&Ct(this)}},s.Oa=function(c){this.g&&(this.response=this.responseText=c,Zt(this))},s.Na=function(c){this.g&&(this.response=c,Zt(this))},s.ga=function(){this.g&&Zt(this)};function Zt(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ms(c)}s.setRequestHeader=function(c,p){this.A.append(c,p)},s.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function ms(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Kt(c){let p="";return $t(c,function(g,_){p+=_,p+=":",p+=g,p+=`\r
`}),p}function Yt(c,p,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Kt(g),typeof c=="string"?g!=null&&I(g):Qe(c,p,g))}function Nt(c){mt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Nt,mt);var Jt=/^https?$/i,Dn=["POST","PUT"];s=Nt.prototype,s.Fa=function(c){this.H=c},s.ea=function(c,p,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Us.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(X){Bn(this,X);return}if(c=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var $ in _)g.set($,_[$]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const X of _.keys())g.set(X,_.get(X));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(X=>X.toLowerCase()=="content-type"),$=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Dn,p,void 0)>=0)||_||$||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,De]of g)this.g.setRequestHeader(X,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(X){Bn(this,X)}};function Bn(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,xi(c),vi(c)}function xi(c){c.A||(c.A=!0,L(c,"complete"),L(c,"error"))}s.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,L(this,"complete"),L(this,"abort"),vi(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vi(this,!0)),Nt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kc(this):this.Xa())},s.Xa=function(){kc(this)};function kc(c){if(c.h&&typeof i<"u"){if(c.v&&kn(c)==4)setTimeout(c.Ca.bind(c),0);else if(L(c,"readystatechange"),kn(c)==4){c.h=!1;try{const X=c.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var _;if(_=X===0){let De=String(c.D).match(Ce)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),_=!Jt.test(De?De.toLowerCase():"")}g=_}if(g)L(c,"complete"),L(c,"success");else{c.o=6;try{var $=kn(c)>2?c.g.statusText:""}catch{$=""}c.l=$+" ["+c.ca()+"]",xi(c)}}finally{vi(c)}}}}function vi(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||L(c,"ready");try{g.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function kn(c){return c.g?c.g.readyState:0}s.ca=function(){try{return kn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ee(p)}};function pd(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function fN(c){const p={};c=(c.g&&kn(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(k(c[_]))continue;var g=pe(c[_]);const $=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const X=p[$]||[];p[$]=X,X.push(g)}Ft(p,function(_){return _.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yo(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function hd(c){this.za=0,this.i=[],this.j=new ps,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yo("baseRetryDelayMs",5e3,c),this.Za=yo("retryDelaySeedMs",1e4,c),this.Ta=yo("forwardChannelMaxRetries",2,c),this.va=yo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Ls(c&&c.concurrentRequestLimit),this.Ba=new It,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=hd.prototype,s.ka=8,s.I=1,s.connect=function(c,p,g,_){vt(0),this.W=c,this.H=p||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.J=kd(this,null,this.W),Sa(this)};function Ac(c){if(gd(c),c.I==3){var p=c.V++,g=dt(c.J);if(Qe(g,"SID",c.M),Qe(g,"RID",p),Qe(g,"TYPE","terminate"),bo(c,g),p=new N(c,c.j,p),p.M=2,p.A=hs(dt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=Ad(p.j,null),p.g.ea(p.A)),p.F=Date.now(),he(p)}Dd(c)}function wa(c){c.g&&(Cc(c),c.g.cancel(),c.g=null)}function gd(c){wa(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ta(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Sa(c){if(!nn(c.h)&&!c.m){c.m=!0;var p=c.Ea;te||x(),O||(te(),O=!0),E.add(p,c),c.D=0}}function pN(c,p){return ts(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=zt(m(c.Ea,c,p),_d(c,c.D)),c.D++,!0)}s.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const $=new N(this,this.j,c);let X=this.o;if(this.U&&(X?(X=ae(X),de(X,this.U)):X=this.U),this.u!==null||this.R||($.J=X,X=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(p+=_,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=bd(this,$,p),g=dt(this.J),Qe(g,"RID",c),Qe(g,"CVER",22),this.G&&Qe(g,"X-HTTP-Session-Id",this.G),bo(this,g),X&&(this.R?p="headers="+I(Kt(X))+"&"+p:this.u&&Yt(g,this.u,X)),ss(this.h,$),this.Ra&&Qe(g,"TYPE","init"),this.S?(Qe(g,"$req",p),Qe(g,"SID","null"),$.U=!0,H($,g,null)):H($,g,p),this.I=2}}else this.I==3&&(c?yd(this,c):this.i.length==0||nn(this.h)||yd(this))};function yd(c,p){var g;p?g=p.l:g=c.V++;const _=dt(c.J);Qe(_,"SID",c.M),Qe(_,"RID",g),Qe(_,"AID",c.K),bo(c,_),c.u&&c.o&&Yt(_,c.u,c.o),g=new N(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=bd(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),ss(c.h,g),H(g,_,p)}function bo(c,p){c.H&&$t(c.H,function(g,_){Qe(p,_,g)}),c.l&&$t({},function(g,_){Qe(p,_,g)})}function bd(c,p,g){g=Math.min(c.i.length,g);const _=c.l?m(c.l.Ka,c.l,c):null;e:{var $=c.i;let ht=-1;for(;;){const Cs=["count="+g];ht==-1?g>0?(ht=$[0].g,Cs.push("ofs="+ht)):ht=0:Cs.push("ofs="+ht);let Gt=!0;for(let Ps=0;Ps<g;Ps++){var X=$[Ps].g;const Un=$[Ps].map;if(X-=ht,X<0)ht=Math.max(0,$[Ps].g-100),Gt=!1;else try{X="req"+X+"_"||"";try{var De=Un instanceof Map?Un:Object.entries(Un);for(const[Jr,pr]of De){let hr=pr;l(pr)&&(hr=et(pr)),Cs.push(X+Jr+"="+encodeURIComponent(hr))}}catch(Jr){throw Cs.push(X+"type="+encodeURIComponent("_badmap")),Jr}}catch{_&&_(Un)}}if(Gt){De=Cs.join("&");break e}}De=void 0}return c=c.i.splice(0,g),p.G=c,De}function Nd(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;te||x(),O||(te(),O=!0),E.add(p,c),c.A=0}}function Ec(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=zt(m(c.Da,c),_d(c,c.A)),c.A++,!0)}s.Da=function(){if(this.v=null,xd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=zt(m(this.Wa,this),c)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,vt(10),wa(this),xd(this))};function Cc(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function xd(c){c.g=new N(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=dt(c.na);Qe(p,"RID","rpc"),Qe(p,"SID",c.M),Qe(p,"AID",c.K),Qe(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&Qe(p,"TO",c.ia),Qe(p,"TYPE","xmlhttp"),bo(c,p),c.u&&c.o&&Yt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=hs(dt(p)),g.u=null,g.R=!0,W(g,c)}s.Va=function(){this.C!=null&&(this.C=null,wa(this),Ec(this),vt(19))};function Ta(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function vd(c,p){var g=null;if(c.g==p){Ta(c),Cc(c),c.g=null;var _=2}else if(Ms(c.h,p))g=p.G,yt(c.h,p),_=1;else return;if(c.I!=0){if(p.o)if(_==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var $=c.D;_=me(),L(_,new fs(_,g)),Sa(c)}else Nd(c);else if($=p.m,$==3||$==0&&p.X>0||!(_==1&&pN(c,p)||_==2&&Ec(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),$){case 1:Xr(c,5);break;case 4:Xr(c,10);break;case 3:Xr(c,6);break;default:Xr(c,2)}}}function _d(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Xr(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),_=c.Ua;const $=!_;_=new at(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ue(_,"https"),hs(_),$?bt(_.toString(),g):gs(_.toString(),g)}else vt(2);c.I=0,c.l&&c.l.pa(p),Dd(c),gd(c)}s.bb=function(c){c?(this.j.info("Successfully pinged google.com"),vt(2)):(this.j.info("Failed to ping google.com"),vt(1))};function Dd(c){if(c.I=0,c.ja=[],c.l){const p=qe(c.h);(p.length!=0||c.i.length!=0)&&(C(c.ja,p),C(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function kd(c,p,g){var _=g instanceof at?dt(g):new at(g);if(_.g!="")p&&(_.g=p+"."+_.g),tt(_,_.u);else{var $=o.location;_=$.protocol,p=p?p+"."+$.hostname:$.hostname,$=+$.port;const X=new at(null);_&&Ue(X,_),p&&(X.g=p),$&&tt(X,$),g&&(X.h=g),_=X}return g=c.G,p=c.wa,g&&p&&Qe(_,g,p),Qe(_,"VER",c.ka),bo(c,_),_}function Ad(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new Nt(new ns({ab:g})):new Nt(c.ma),p.Fa(c.L),p}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ed(){}s=Ed.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function La(){}La.prototype.g=function(c,p){return new un(c,p)};function un(c,p){mt.call(this),this.g=new hd(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new _i(this)}f(un,mt),un.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},un.prototype.close=function(){Ac(this.g)},un.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=et(c),c=g);p.i.push(new Hs(p.Ya++,c)),p.I==3&&Sa(p)},un.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,un.Z.N.call(this)};function Cd(c){M.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Cd,M);function Vd(){ge.call(this),this.status=1}f(Vd,ge);function _i(c){this.g=c}f(_i,Ed),_i.prototype.ra=function(){L(this.g,"a")},_i.prototype.qa=function(c){L(this.g,new Cd(c))},_i.prototype.pa=function(c){L(this.g,new Vd)},_i.prototype.oa=function(){L(this.g,"b")},La.prototype.createWebChannel=La.prototype.g,un.prototype.send=un.prototype.o,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,sg=function(){return new La},tg=function(){return me()},eg=ke,yu={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sn.NO_ERROR=0,sn.TIMEOUT=8,sn.HTTP_ERROR=6,ll=sn,Rn.COMPLETE="complete",Zh=Rn,ee.EventType=Ge,Ge.OPEN="a",Ge.CLOSE="b",Ge.ERROR="c",Ge.MESSAGE="d",mt.prototype.listen=mt.prototype.J,Bo=ee,Nt.prototype.listenOnce=Nt.prototype.K,Nt.prototype.getLastError=Nt.prototype.Ha,Nt.prototype.getLastErrorCode=Nt.prototype.ya,Nt.prototype.getStatus=Nt.prototype.ca,Nt.prototype.getResponseJson=Nt.prototype.La,Nt.prototype.getResponseText=Nt.prototype.la,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Fa,Jh=Nt}).apply(typeof Ba<"u"?Ba:typeof self<"u"?self:typeof window<"u"?window:{});const sf="@firebase/firestore",nf="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ys.UNAUTHENTICATED=new Ys(null),Ys.GOOGLE_CREDENTIALS=new Ys("google-credentials-uid"),Ys.FIRST_PARTY=new Ys("first-party-uid"),Ys.MOCK_USER=new Ys("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ro="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=new Oh("@firebase/firestore");function Ui(){return li.logLevel}function Se(s,...e){if(li.logLevel<=wt.DEBUG){const t=e.map(lm);li.debug(`Firestore (${ro}): ${s}`,...t)}}function cr(s,...e){if(li.logLevel<=wt.ERROR){const t=e.map(lm);li.error(`Firestore (${ro}): ${s}`,...t)}}function Yi(s,...e){if(li.logLevel<=wt.WARN){const t=e.map(lm);li.warn(`Firestore (${ro}): ${s}`,...t)}}function lm(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,ng(s,n,t)}function ng(s,e,t){let n=`FIRESTORE (${ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw cr(n),new Error(n)}function Ot(s,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,s||ng(e,r,n)}function Ze(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends di{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ys.UNAUTHENTICATED))}shutdown(){}}class b_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class N_{constructor(e){this.t=e,this.currentUser=Ys.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ot(this.o===void 0,42304);let n=this.i;const r=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let i=new ir;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ir,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ir)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ot(typeof n.accessToken=="string",31837,{l:n}),new rg(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new Ys(e)}}class x_{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ys.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class v_{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new x_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ys.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ot(this.o===void 0,3512);const n=i=>{i.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const r=i=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rf(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new rf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=D_(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Dt(s,e){return s<e?-1:s>e?1:0}function bu(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const r=s.charAt(n),i=e.charAt(n);if(r!==i)return Hc(r)===Hc(i)?Dt(r,i):Hc(r)?1:-1}return Dt(s.length,e.length)}const k_=55296,A_=57343;function Hc(s){const e=s.charCodeAt(0);return e>=k_&&e<=A_}function Gi(s,e,t){return s.length===e.length&&s.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="__name__";class Mn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Xe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Xe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Mn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Mn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const i=Mn.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return Dt(e.length,t.length)}static compareSegments(e,t){const n=Mn.isNumericId(e),r=Mn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Mn.extractNumericId(e).compare(Mn.extractNumericId(t)):bu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return wr.fromString(e.substring(4,e.length-2))}}class Xt extends Mn{construct(e,t,n){return new Xt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ve(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Xt(t)}static emptyPath(){return new Xt([])}}const E_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qs extends Mn{construct(e,t,n){return new qs(e,t,n)}static isValidIdentifier(e){return E_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===of}static keyField(){return new qs([of])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ve(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ve(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ve(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(n+=l,r++):(i(),r++)}if(i(),o)throw new Ve(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qs(t)}static emptyPath(){return new qs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.path=e}static fromPath(e){return new We(Xt.fromString(e))}static fromName(e){return new We(Xt.fromString(e).popFirst(5))}static empty(){return new We(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new We(new Xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(s,e,t){if(!t)throw new Ve(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function C_(s,e,t,n){if(e===!0&&n===!0)throw new Ve(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function af(s){if(!We.isDocumentKey(s))throw new Ve(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function lf(s){if(We.isDocumentKey(s))throw new Ve(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function og(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function zl(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Xe(12329,{type:typeof s})}function $s(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ve(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=zl(s);throw new Ve(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function ga(s,e){if(!og(s))throw new Ve(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const o=s[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new Ve(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=-62135596800,uf=1e6;class ve{static now(){return ve.fromMillis(Date.now())}static fromDate(e){return ve.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*uf);return new ve(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<cf)throw new Ve(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uf}_compareTo(e){return this.seconds===e.seconds?Dt(this.nanoseconds,e.nanoseconds):Dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ve._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ga(e,ve._jsonSchema))return new ve(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ve._jsonSchemaVersion="firestore/timestamp/1.0",ve._jsonSchema={type:ks("string",ve._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new ve(0,0))}static max(){return new st(new ve(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=-1;function V_(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,r=st.fromTimestamp(n===1e9?new ve(t+1,0):new ve(t,n));return new Lr(r,We.empty(),e)}function w_(s){return new Lr(s.readTime,s.key,na)}class Lr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Lr(st.min(),We.empty(),na)}static max(){return new Lr(st.max(),We.empty(),na)}}function S_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=We.comparator(s.documentKey,e.documentKey),t!==0?t:Dt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==T_)throw s;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>n(u))}),o=!0,i===r&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(r=>r?ce.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,i)=>{n.push(t.call(this,r,i))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&n(o)},d=>r(d))}})}static doWhile(e,t){return new ce((n,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):n()};i()})}}function P_(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oo(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=-1;function Ql(s){return s==null}function _l(s){return s===0&&1/s==-1/0}function I_(s){return typeof s=="number"&&Number.isInteger(s)&&!_l(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="";function j_(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=mf(e)),e=R_(s.get(t),e);return mf(e)}function R_(s,e){let t=e;const n=s.length;for(let r=0;r<n;r++){const i=s.charAt(r);switch(i){case"\0":t+="";break;case ag:t+="";break;default:t+=i}}return t}function mf(s){return s+ag+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Mr(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function lg(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t){this.comparator=e,this.root=t||Os.EMPTY}insert(e,t){return new rs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Os.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Os.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ua(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ua(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ua(this.root,e,this.comparator,!0)}}class Ua{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Os{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??Os.RED,this.left=r??Os.EMPTY,this.right=i??Os.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Os(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Os.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Os.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Os.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Os.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xe(27949);return e+(this.isRed()?0:1)}}Os.EMPTY=null,Os.RED=!0,Os.BLACK=!1;Os.EMPTY=new class{constructor(){this.size=0}get key(){throw Xe(57766)}get value(){throw Xe(16141)}get color(){throw Xe(16727)}get left(){throw Xe(29726)}get right(){throw Xe(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Os(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ff(this.data.getIterator())}getIteratorFrom(e){return new ff(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ss(this.comparator);return t.data=e,t}}class ff{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(qs.comparator)}static empty(){return new fn([])}unionWith(e){let t=new Ss(qs.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new cg("Invalid base64 string: "+i):i}}(e);return new zs(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new zs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zs.EMPTY_BYTE_STRING=new zs("");const B_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pr(s){if(Ot(!!s,39018),typeof s=="string"){let e=0;const t=B_.exec(s);if(Ot(!!t,46558,{timestamp:s}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ds(s.seconds),nanos:ds(s.nanos)}}function ds(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ir(s){return typeof s=="string"?zs.fromBase64String(s):zs.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="server_timestamp",mg="__type__",dg="__previous_value__",fg="__local_write_time__";function mm(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[mg])==null?void 0:n.stringValue)===ug}function Yl(s){const e=s.mapValue.fields[dg];return mm(e)?Yl(e):e}function ra(s){const e=Pr(s.mapValue.fields[fg].timestampValue);return new ve(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,t,n,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Dl="(default)";class ia{constructor(e,t){this.projectId=e,this.database=t||Dl}static empty(){return new ia("","")}get isDefaultDatabase(){return this.database===Dl}isEqual(e){return e instanceof ia&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="__type__",H_="__max__",Ha={mapValue:{}},hg="__vector__",kl="value";function jr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?mm(s)?4:O_(s)?9007199254740991:M_(s)?10:11:Xe(28295,{value:s})}function Gn(s,e){if(s===e)return!0;const t=jr(s);if(t!==jr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ra(s).isEqual(ra(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Pr(r.timestampValue),l=Pr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(r,i){return Ir(r.bytesValue).isEqual(Ir(i.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(r,i){return ds(r.geoPointValue.latitude)===ds(i.geoPointValue.latitude)&&ds(r.geoPointValue.longitude)===ds(i.geoPointValue.longitude)}(s,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ds(r.integerValue)===ds(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=ds(r.doubleValue),l=ds(i.doubleValue);return o===l?_l(o)===_l(l):isNaN(o)&&isNaN(l)}return!1}(s,e);case 9:return Gi(s.arrayValue.values||[],e.arrayValue.values||[],Gn);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(df(o)!==df(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Gn(o[u],l[u])))return!1;return!0}(s,e);default:return Xe(52216,{left:s})}}function oa(s,e){return(s.values||[]).find(t=>Gn(t,e))!==void 0}function Xi(s,e){if(s===e)return 0;const t=jr(s),n=jr(e);if(t!==n)return Dt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Dt(s.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ds(i.integerValue||i.doubleValue),u=ds(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(s,e);case 3:return pf(s.timestampValue,e.timestampValue);case 4:return pf(ra(s),ra(e));case 5:return bu(s.stringValue,e.stringValue);case 6:return function(i,o){const l=Ir(i),u=Ir(o);return l.compareTo(u)}(s.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=Dt(l[m],u[m]);if(d!==0)return d}return Dt(l.length,u.length)}(s.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Dt(ds(i.latitude),ds(o.latitude));return l!==0?l:Dt(ds(i.longitude),ds(o.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return hf(s.arrayValue,e.arrayValue);case 10:return function(i,o){var h,y,C,v;const l=i.fields||{},u=o.fields||{},m=(h=l[kl])==null?void 0:h.arrayValue,d=(y=u[kl])==null?void 0:y.arrayValue,f=Dt(((C=m==null?void 0:m.values)==null?void 0:C.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:hf(m,d)}(s.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ha.mapValue&&o===Ha.mapValue)return 0;if(i===Ha.mapValue)return 1;if(o===Ha.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=bu(u[f],d[f]);if(h!==0)return h;const y=Xi(l[u[f]],m[d[f]]);if(y!==0)return y}return Dt(u.length,d.length)}(s.mapValue,e.mapValue);default:throw Xe(23264,{he:t})}}function pf(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Dt(s,e);const t=Pr(s),n=Pr(e),r=Dt(t.seconds,n.seconds);return r!==0?r:Dt(t.nanos,n.nanos)}function hf(s,e){const t=s.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const i=Xi(t[r],n[r]);if(i)return i}return Dt(t.length,n.length)}function Ji(s){return Nu(s)}function Nu(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const n=Pr(t);return`time(${n.seconds},${n.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Ir(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return We.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=Nu(i);return n+"]"}(s.arrayValue):"mapValue"in s?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of n)i?i=!1:r+=",",r+=`${o}:${Nu(t.fields[o])}`;return r+"}"}(s.mapValue):Xe(61005,{value:s})}function cl(s){switch(jr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yl(s);return e?16+cl(e):16;case 5:return 2*s.stringValue.length;case 6:return Ir(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+cl(i),0)}(s.arrayValue);case 10:case 11:return function(n){let r=0;return Mr(n.fields,(i,o)=>{r+=i.length+cl(o)}),r}(s.mapValue);default:throw Xe(13486,{value:s})}}function gf(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function xu(s){return!!s&&"integerValue"in s}function dm(s){return!!s&&"arrayValue"in s}function yf(s){return!!s&&"nullValue"in s}function bf(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function ul(s){return!!s&&"mapValue"in s}function M_(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[pg])==null?void 0:n.stringValue)===hg}function $o(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Mr(s.mapValue.fields,(t,n)=>e.mapValue.fields[t]=$o(n)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$o(s.arrayValue.values[t]);return e}return{...s}}function O_(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===H_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.value=e}static empty(){return new cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ul(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$o(t)}setAll(e){let t=qs.emptyPath(),n={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,n,r),n={},r=[],t=l.popLast()}o?n[l.lastSegment()]=$o(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());ul(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ul(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Mr(t,(r,i)=>e[r]=i);for(const r of n)delete e[r]}clone(){return new cn($o(this.value))}}function gg(s){const e=[];return Mr(s.fields,(t,n)=>{const r=new qs([t]);if(ul(n)){const i=gg(n.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,t,n,r,i,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Gs(e,0,st.min(),st.min(),st.min(),cn.empty(),0)}static newFoundDocument(e,t,n,r){return new Gs(e,1,t,st.min(),n,r,0)}static newNoDocument(e,t){return new Gs(e,2,t,st.min(),st.min(),cn.empty(),0)}static newUnknownDocument(e,t){return new Gs(e,3,t,st.min(),st.min(),cn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.position=e,this.inclusive=t}}function Nf(s,e,t){let n=0;for(let r=0;r<s.position.length;r++){const i=e[r],o=s.position[r];if(i.field.isKeyField()?n=We.comparator(We.fromName(o.referenceValue),t.key):n=Xi(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function xf(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Gn(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,t="asc"){this.field=e,this.dir=t}}function F_(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{}class _s extends yg{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new $_(e,t,n):t==="array-contains"?new K_(e,n):t==="in"?new Q_(e,n):t==="not-in"?new Y_(e,n):t==="array-contains-any"?new G_(e,n):new _s(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new W_(e,n):new z_(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xi(t,this.value)):t!==null&&jr(this.value)===jr(t)&&this.matchesComparison(Xi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ln extends yg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ln(e,t)}matches(e){return bg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bg(s){return s.op==="and"}function Ng(s){return q_(s)&&bg(s)}function q_(s){for(const e of s.filters)if(e instanceof Ln)return!1;return!0}function vu(s){if(s instanceof _s)return s.field.canonicalString()+s.op.toString()+Ji(s.value);if(Ng(s))return s.filters.map(e=>vu(e)).join(",");{const e=s.filters.map(t=>vu(t)).join(",");return`${s.op}(${e})`}}function xg(s,e){return s instanceof _s?function(n,r){return r instanceof _s&&n.op===r.op&&n.field.isEqual(r.field)&&Gn(n.value,r.value)}(s,e):s instanceof Ln?function(n,r){return r instanceof Ln&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,o,l)=>i&&xg(o,r.filters[l]),!0):!1}(s,e):void Xe(19439)}function vg(s){return s instanceof _s?function(t){return`${t.field.canonicalString()} ${t.op} ${Ji(t.value)}`}(s):s instanceof Ln?function(t){return t.op.toString()+" {"+t.getFilters().map(vg).join(" ,")+"}"}(s):"Filter"}class $_ extends _s{constructor(e,t,n){super(e,t,n),this.key=We.fromName(n.referenceValue)}matches(e){const t=We.comparator(e.key,this.key);return this.matchesComparison(t)}}class W_ extends _s{constructor(e,t){super(e,"in",t),this.keys=_g("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class z_ extends _s{constructor(e,t){super(e,"not-in",t),this.keys=_g("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _g(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(n=>We.fromName(n.referenceValue))}class K_ extends _s{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dm(t)&&oa(t.arrayValue,this.value)}}class Q_ extends _s{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&oa(this.value.arrayValue,t)}}class Y_ extends _s{constructor(e,t){super(e,"not-in",t)}matches(e){if(oa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!oa(this.value.arrayValue,t)}}class G_ extends _s{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>oa(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,t=null,n=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function vf(s,e=null,t=[],n=[],r=null,i=null,o=null){return new X_(s,e,t,n,r,i,o)}function fm(s){const e=Ze(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Ql(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ji(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ji(n)).join(",")),e.Te=t}return e.Te}function pm(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!F_(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!xg(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!xf(s.startAt,e.startAt)&&xf(s.endAt,e.endAt)}function _u(s){return We.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t=null,n=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function J_(s,e,t,n,r,i,o,l){return new ao(s,e,t,n,r,i,o,l)}function Gl(s){return new ao(s)}function _f(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Dg(s){return s.collectionGroup!==null}function Wo(s){const e=Ze(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ss(qs.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new aa(i,n))}),t.has(qs.keyField().canonicalString())||e.Ie.push(new aa(qs.keyField(),n))}return e.Ie}function $n(s){const e=Ze(s);return e.Ee||(e.Ee=Z_(e,Wo(s))),e.Ee}function Z_(s,e){if(s.limitType==="F")return vf(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new aa(r.field,i)});const t=s.endAt?new Al(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new Al(s.startAt.position,s.startAt.inclusive):null;return vf(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Du(s,e){const t=s.filters.concat([e]);return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ku(s,e,t){return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Xl(s,e){return pm($n(s),$n(e))&&s.limitType===e.limitType}function kg(s){return`${fm($n(s))}|lt:${s.limitType}`}function Hi(s){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>vg(r)).join(", ")}]`),Ql(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Ji(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Ji(r)).join(",")),`Target(${n})`}($n(s))}; limitType=${s.limitType})`}function Jl(s,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):We.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(s,e)&&function(n,r){for(const i of Wo(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(s,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(s,e)&&function(n,r){return!(n.startAt&&!function(o,l,u){const m=Nf(o,l,u);return o.inclusive?m<=0:m<0}(n.startAt,Wo(n),r)||n.endAt&&!function(o,l,u){const m=Nf(o,l,u);return o.inclusive?m>=0:m>0}(n.endAt,Wo(n),r))}(s,e)}function eD(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Ag(s){return(e,t)=>{let n=!1;for(const r of Wo(s)){const i=tD(r,e,t);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function tD(s,e,t){const n=s.field.isKeyField()?We.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Xi(u,m):Xe(42886)}(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Xe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Mr(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return lg(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new rs(We.comparator);function ur(){return sD}const Eg=new rs(We.comparator);function Uo(...s){let e=Eg;for(const t of s)e=e.insert(t.key,t);return e}function Cg(s){let e=Eg;return s.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function si(){return zo()}function Vg(){return zo()}function zo(){return new fi(s=>s.toString(),(s,e)=>s.isEqual(e))}const nD=new rs(We.comparator),rD=new Ss(We.comparator);function kt(...s){let e=rD;for(const t of s)e=e.add(t);return e}const iD=new Ss(Dt);function oD(){return iD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_l(e)?"-0":e}}function wg(s){return{integerValue:""+s}}function aD(s,e){return I_(e)?wg(e):hm(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(){this._=void 0}}function lD(s,e,t){return s instanceof la?function(r,i){const o={fields:{[mg]:{stringValue:ug},[fg]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&mm(i)&&(i=Yl(i)),i&&(o.fields[dg]=i),{mapValue:o}}(t,e):s instanceof ca?Tg(s,e):s instanceof ua?Lg(s,e):function(r,i){const o=Sg(r,i),l=Df(o)+Df(r.Ae);return xu(o)&&xu(r.Ae)?wg(l):hm(r.serializer,l)}(s,e)}function cD(s,e,t){return s instanceof ca?Tg(s,e):s instanceof ua?Lg(s,e):t}function Sg(s,e){return s instanceof El?function(n){return xu(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class la extends Zl{}class ca extends Zl{constructor(e){super(),this.elements=e}}function Tg(s,e){const t=Pg(e);for(const n of s.elements)t.some(r=>Gn(r,n))||t.push(n);return{arrayValue:{values:t}}}class ua extends Zl{constructor(e){super(),this.elements=e}}function Lg(s,e){let t=Pg(e);for(const n of s.elements)t=t.filter(r=>!Gn(r,n));return{arrayValue:{values:t}}}class El extends Zl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Df(s){return ds(s.integerValue||s.doubleValue)}function Pg(s){return dm(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,t){this.field=e,this.transform=t}}function mD(s,e){return s.field.isEqual(e.field)&&function(n,r){return n instanceof ca&&r instanceof ca||n instanceof ua&&r instanceof ua?Gi(n.elements,r.elements,Gn):n instanceof El&&r instanceof El?Gn(n.Ae,r.Ae):n instanceof la&&r instanceof la}(s.transform,e.transform)}class dD{constructor(e,t){this.version=e,this.transformResults=t}}class tn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tn}static exists(e){return new tn(void 0,e)}static updateTime(e){return new tn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ml(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class ec{}function Ig(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new tc(s.key,tn.none()):new ya(s.key,s.data,tn.none());{const t=s.data,n=cn.empty();let r=new Ss(qs.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),r=r.add(i)}return new Or(s.key,n,new fn(r.toArray()),tn.none())}}function fD(s,e,t){s instanceof ya?function(r,i,o){const l=r.value.clone(),u=Af(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(s,e,t):s instanceof Or?function(r,i,o){if(!ml(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Af(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(jg(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(s,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ko(s,e,t,n){return s instanceof ya?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=i.value.clone(),d=Ef(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(s,e,t,n):s instanceof Or?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=Ef(i.fieldTransforms,u,o),d=o.data;return d.setAll(jg(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(s,e,t,n):function(i,o,l){return ml(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(s,e,t)}function pD(s,e){let t=null;for(const n of s.fieldTransforms){const r=e.data.field(n.field),i=Sg(n.transform,r||null);i!=null&&(t===null&&(t=cn.empty()),t.set(n.field,i))}return t||null}function kf(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Gi(n,r,(i,o)=>mD(i,o))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class ya extends ec{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Or extends ec{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function jg(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}}),e}function Af(s,e,t){const n=new Map;Ot(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let r=0;r<t.length;r++){const i=s[r],o=i.transform,l=e.data.field(i.field);n.set(i.field,cD(o,l,t[r]))}return n}function Ef(s,e,t){const n=new Map;for(const r of s){const i=r.transform,o=t.data.field(r.field);n.set(r.field,lD(i,o,e))}return n}class tc extends ec{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hD extends ec{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&fD(i,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Vg();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=Ig(o,l);u!==null&&n.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(st.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),kt())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(t,n)=>kf(t,n))&&Gi(this.baseMutations,e.baseMutations,(t,n)=>kf(t,n))}}class gm{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ot(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return nD}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new gm(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs,Vt;function ND(s){switch(s){case ie.OK:return Xe(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Xe(15467,{code:s})}}function Rg(s){if(s===void 0)return cr("GRPC error has no .code"),ie.UNKNOWN;switch(s){case bs.OK:return ie.OK;case bs.CANCELLED:return ie.CANCELLED;case bs.UNKNOWN:return ie.UNKNOWN;case bs.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case bs.INTERNAL:return ie.INTERNAL;case bs.UNAVAILABLE:return ie.UNAVAILABLE;case bs.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case bs.NOT_FOUND:return ie.NOT_FOUND;case bs.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case bs.ABORTED:return ie.ABORTED;case bs.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case bs.DATA_LOSS:return ie.DATA_LOSS;default:return Xe(39323,{code:s})}}(Vt=bs||(bs={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new wr([4294967295,4294967295],0);function Cf(s){const e=xD().encode(s),t=new Xh;return t.update(e),new Uint8Array(t.digest())}function Vf(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new wr([t,n],0),new wr([r,i],0)]}class ym{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ho(`Invalid padding: ${t}`);if(n<0)throw new Ho(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ho(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ho(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=wr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(wr.fromNumber(n)));return r.compare(vD)===1&&(r=new wr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Cf(e),[n,r]=Vf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ym(i,r,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Cf(e),[n,r]=Vf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ho extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ba.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sc(st.min(),r,new rs(Dt),ur(),kt())}}class ba{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ba(n,t,kt(),kt(),kt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Bg{constructor(e,t){this.targetId=e,this.Ce=t}}class Ug{constructor(e,t,n=zs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class wf{constructor(){this.ve=0,this.Fe=Sf(),this.Me=zs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=kt(),t=kt(),n=kt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Xe(38017,{changeType:i})}}),new ba(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Sf()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _D{constructor(e){this.Ge=e,this.ze=new Map,this.je=ur(),this.Je=Ma(),this.He=Ma(),this.Ye=new rs(Dt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(_u(i))if(n===0){const o=new We(i.path);this.et(t,o,Gs.newNoDocument(o,st.min()))}else Ot(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=Ir(n).toUint8Array()}catch(u){if(u instanceof cg)return Yi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ym(o,r,i)}catch(u){return Yi(u instanceof Ho?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&_u(l.target)){const u=new We(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Gs.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=kt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new sc(e,t,this.Ye,this.je,n);return this.je=ur(),this.Je=Ma(),this.He=Ma(),this.Ye=new rs(Dt),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new wf,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ss(Dt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ss(Dt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Se("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wf),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ma(){return new rs(We.comparator)}function Sf(){return new rs(We.comparator)}const DD={asc:"ASCENDING",desc:"DESCENDING"},kD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AD={and:"AND",or:"OR"};class ED{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Au(s,e){return s.useProto3Json||Ql(e)?e:{value:e}}function Cl(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hg(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function CD(s,e){return Cl(s,e.toTimestamp())}function Wn(s){return Ot(!!s,49232),st.fromTimestamp(function(t){const n=Pr(t);return new ve(n.seconds,n.nanos)}(s))}function bm(s,e){return Eu(s,e).canonicalString()}function Eu(s,e){const t=function(r){return new Xt(["projects",r.projectId,"databases",r.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Mg(s){const e=Xt.fromString(s);return Ot(Wg(e),10190,{key:e.toString()}),e}function Cu(s,e){return bm(s.databaseId,e.path)}function Mc(s,e){const t=Mg(e);if(t.get(1)!==s.databaseId.projectId)throw new Ve(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ve(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new We(Fg(t))}function Og(s,e){return bm(s.databaseId,e)}function VD(s){const e=Mg(s);return e.length===4?Xt.emptyPath():Fg(e)}function Vu(s){return new Xt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Fg(s){return Ot(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Tf(s,e,t){return{name:Cu(s,e),fields:t.value.mapValue.fields}}function wD(s,e){let t;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Xe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Ot(d===void 0||typeof d=="string",58123),zs.fromBase64String(d||"")):(Ot(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),zs.fromUint8Array(d||new Uint8Array))}(s,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?ie.UNKNOWN:Rg(m.code);return new Ve(d,m.message||"")}(o);t=new Ug(n,r,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Mc(s,n.document.name),i=Wn(n.document.updateTime),o=n.document.createTime?Wn(n.document.createTime):st.min(),l=new cn({mapValue:{fields:n.document.fields}}),u=Gs.newFoundDocument(r,i,o,l),m=n.targetIds||[],d=n.removedTargetIds||[];t=new dl(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Mc(s,n.document),i=n.readTime?Wn(n.readTime):st.min(),o=Gs.newNoDocument(r,i),l=n.removedTargetIds||[];t=new dl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Mc(s,n.document),i=n.removedTargetIds||[];t=new dl([],i,r,null)}else{if(!("filter"in e))return Xe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,o=new bD(r,i),l=n.targetId;t=new Bg(l,o)}}return t}function SD(s,e){let t;if(e instanceof ya)t={update:Tf(s,e.key,e.value)};else if(e instanceof tc)t={delete:Cu(s,e.key)};else if(e instanceof Or)t={update:Tf(s,e.key,e.data),updateMask:HD(e.fieldMask)};else{if(!(e instanceof hD))return Xe(16599,{Vt:e.type});t={verify:Cu(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof la)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ca)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof El)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Xe(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:CD(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Xe(27497)}(s,e.precondition)),t}function TD(s,e){return s&&s.length>0?(Ot(e!==void 0,14353),s.map(t=>function(r,i){let o=r.updateTime?Wn(r.updateTime):Wn(i);return o.isEqual(st.min())&&(o=Wn(i)),new dD(o,r.transformResults||[])}(t,e))):[]}function LD(s,e){return{documents:[Og(s,e.path)]}}function PD(s,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Og(s,r);const i=function(m){if(m.length!==0)return $g(Ln.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Mi(h.field),direction:RD(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Au(s,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function ID(s){let e=VD(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Ot(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=qg(f);return h instanceof Ln&&Ng(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(C){return new aa(Oi(C.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Ql(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,y=f.values||[];return new Al(y,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,y=f.values||[];return new Al(y,h)}(t.endAt)),J_(e,r,o,i,l,"F",u,m)}function jD(s,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xe(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function qg(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Oi(t.unaryFilter.field);return _s.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Oi(t.unaryFilter.field);return _s.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Oi(t.unaryFilter.field);return _s.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oi(t.unaryFilter.field);return _s.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xe(61313);default:return Xe(60726)}}(s):s.fieldFilter!==void 0?function(t){return _s.create(Oi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xe(58110);default:return Xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Ln.create(t.compositeFilter.filters.map(n=>qg(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Xe(1026)}}(t.compositeFilter.op))}(s):Xe(30097,{filter:s})}function RD(s){return DD[s]}function BD(s){return kD[s]}function UD(s){return AD[s]}function Mi(s){return{fieldPath:s.canonicalString()}}function Oi(s){return qs.fromServerFormat(s.fieldPath)}function $g(s){return s instanceof _s?function(t){if(t.op==="=="){if(bf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NAN"}};if(yf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NAN"}};if(yf(t.value))return{unaryFilter:{field:Mi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mi(t.field),op:BD(t.op),value:t.value}}}(s):s instanceof Ln?function(t){const n=t.getFilters().map(r=>$g(r));return n.length===1?n[0]:{compositeFilter:{op:UD(t.op),filters:n}}}(s):Xe(54877,{filter:s})}function HD(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Wg(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,t,n,r,i=st.min(),o=st.min(),l=zs.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new kr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.yt=e}}function OD(s){const e=ID({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ku(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(){this.Cn=new qD}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Lr.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Lr.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class qD{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ss(Xt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ss(Xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zg=41943040;class an{static withCacheSize(e){return new an(e,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */an.DEFAULT_COLLECTION_PERCENTILE=10,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,an.DEFAULT=new an(zg,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),an.DISABLED=new an(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zi(0)}static cr(){return new Zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="LruGarbageCollector",$D=1048576;function If([s,e],[t,n]){const r=Dt(s,t);return r===0?Dt(e,n):r}class WD{constructor(e){this.Ir=e,this.buffer=new Ss(If),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();If(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Se(Pf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oo(t)?Se(Pf,"Ignoring IndexedDB error during garbage collection: ",t):await io(t)}await this.Vr(3e5)})}}class KD{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(Kl.ce);const n=new WD(t);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Lf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(m=Date.now(),Ui()<=wt.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function QD(s,e){return new KD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(){this.changes=new fi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Ko(n.mutation,r,fn.empty(),ve.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,kt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=kt()){const r=si();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(i=>{let o=Uo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=si();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,kt()))}populateOverlays(e,t,n){const r=[];return n.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,r){let i=ur();const o=zo(),l=function(){return zo()}();return t.forEach((u,m)=>{const d=n.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof Or)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Ko(d.mutation,m,d.mutation.getFieldMask(),ve.now())):o.set(m.key,fn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new GD(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const n=zo();let r=new rs((o,l)=>o-l),i=kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=n.get(u)||fn.empty();d=l.applyToLocalView(m,d),n.set(u,d);const f=(r.get(l.batchId)||kt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Vg();d.forEach(h=>{if(!i.has(h)){const y=Ig(t.get(h),n.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return We.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Dg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ce.resolve(si());let l=na,u=i;return o.next(m=>ce.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,kt())).next(d=>({batchId:l,changes:Cg(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new We(t)).next(n=>{let r=Uo();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=Uo();return this.indexManager.getCollectionParents(e,i).next(l=>ce.forEach(l,u=>{const m=function(f,h){return new ao(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,n,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,Gs.newInvalidDocument(d)))});let l=Uo();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Ko(d.mutation,m,fn.empty(),ve.now()),Jl(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Wn(r.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:OD(r.bundledQuery),readTime:Wn(r.readTime)}}(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this.overlays=new rs(We.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=si();return ce.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&n.set(r,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,i)=>{this.St(e,t,i)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const r=si(),i=t.length+1,o=new We(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new rs((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let d=i.get(m.largestBatchId);d===null&&(d=si(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=si(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return ce.resolve(l)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new yD(t,n));let i=this.qr.get(t);i===void 0&&(i=kt(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(){this.sessionToken=zs.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.Qr=new Ss(js.$r),this.Ur=new Ss(js.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new js(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new js(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new We(new Xt([])),n=new js(t,e),r=new js(t,e+1),i=[];return this.Ur.forEachInRange([n,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new We(new Xt([])),n=new js(t,e),r=new js(t,e+1);let i=kt();return this.Ur.forEachInRange([n,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new js(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class js{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return We.comparator(e.key,t.key)||Dt(e.Yr,t.Yr)}static Kr(e,t){return Dt(e.Yr,t.Yr)||We.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ss(js.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new gD(i,t,n,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new js(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?um:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new js(t,0),r=new js(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ss(Dt);return t.forEach(r=>{const i=new js(r,0),o=new js(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{n=n.add(l.Yr)})}),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;We.isDocumentKey(i)||(i=i.child(""));const o=new js(new We(i),0);let l=new Ss(Dt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!n.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),ce.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(n=>{const r=this.Xr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,r=>{const i=new js(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new js(t,0),r=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.ri=e,this.docs=function(){return new rs(We.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():Gs.newInvalidDocument(t))}getEntries(e,t){let n=ur();return t.forEach(r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():Gs.newInvalidDocument(r))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ur();const o=t.path,l=new We(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||S_(w_(d),n)<=0||(r.has(d.key)||Jl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Xe(9500)}ii(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new nk(this)}getSize(e){return ce.resolve(this.size)}}class nk extends YD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.persistence=e,this.si=new fi(t=>fm(t),pm),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.oi=0,this._i=new Nm,this.targetCount=0,this.ai=Zi.ur()}forEachTarget(e,t){return this.si.forEach((n,r)=>t(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Zi(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t){this.ui={},this.overlays={},this.ci=new Kl(0),this.li=!1,this.li=!0,this.hi=new ek,this.referenceDelegate=e(this),this.Pi=new rk(this),this.indexManager=new FD,this.remoteDocumentCache=function(r){return new sk(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new MD(t),this.Ii=new JD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new tk(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Se("MemoryPersistence","Starting transaction:",e);const r=new ik(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class ik extends L_{constructor(e){super(),this.currentSequenceNumber=e}}class xm{constructor(e){this.persistence=e,this.Ri=new Nm,this.Vi=null}static mi(e){return new xm(e)}get fi(){if(this.Vi)return this.Vi;throw Xe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,n=>{const r=We.fromPath(n);return this.gi(e,r).next(i=>{i||t.removeEntry(r,st.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vl{constructor(e,t){this.persistence=e,this.pi=new fi(n=>j_(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=QD(this,t)}static mi(e,t){return new Vl(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(i=>i?ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(n++,i.removeEntry(o,st.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=cl(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=kt(),r=kt();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new vm(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return tv()?8:P_(Zx())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ok;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Ui()<=wt.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",Hi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Ui()<=wt.DEBUG&&Se("QueryEngine","Query:",Hi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Ui()<=wt.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",Hi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$n(t))):ce.resolve())}ys(e,t){if(_f(t))return ce.resolve(null);let n=$n(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ku(t,null,"F"),n=$n(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=kt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ku(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,n,r){return _f(t)||r.isEqual(st.min())?ce.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?ce.resolve(null):(Ui()<=wt.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Hi(t)),this.vs(e,o,t,V_(r,na)).next(l=>l))})}Ds(e,t){let n=new Ss(Ag(e));return t.forEach((r,i)=>{Jl(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Ui()<=wt.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",Hi(t)),this.ps.getDocumentsMatchingQuery(e,t,Lr.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="LocalStore",lk=3e8;class ck{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new rs(Dt),this.xs=new fi(i=>fm(i),pm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function uk(s,e,t,n){return new ck(s,e,t,n)}async function Qg(s,e){const t=Ze(s);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let u=kt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function mk(s,e){const t=Ze(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let y=ce.resolve();return h.forEach(C=>{y=y.next(()=>d.getEntry(u,C)).next(v=>{const V=m.docVersions.get(C);Ot(V!==null,48541),v.version.compareTo(V)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=kt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Yg(s){const e=Ze(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function dk(s,e){const t=Ze(s),n=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(zs.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,n)),r=r.insert(f,y),function(v,V,B){return v.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=lk?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(h,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=ur(),m=kt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(fk(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!n.isEqual(st.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return ce.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function fk(s,e,t){let n=kt(),r=kt();return t.forEach(i=>n=n.add(i)),e.getEntries(s,n).next(i=>{let o=ur();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(st.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Se(_m,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function pk(s,e){const t=Ze(s);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=um),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function hk(s,e){const t=Ze(s);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Pi.getTargetData(n,e).next(i=>i?(r=i,ce.resolve(r)):t.Pi.allocateTargetId(n).next(o=>(r=new kr(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function wu(s,e,t){const n=Ze(s),r=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!oo(o))throw o;Se(_m,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function jf(s,e,t){const n=Ze(s);let r=st.min(),i=kt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=Ze(u),h=f.xs.get(d);return h!==void 0?ce.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(n,o,$n(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?r:st.min(),t?i:kt())).next(l=>(gk(n,eD(e),l),{documents:l,Qs:i})))}function gk(s,e,t){let n=s.Os.get(e)||st.min();t.forEach((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),s.Os.set(e,n)}class Rf{constructor(){this.activeTargetIds=oD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yk{constructor(){this.Mo=new Rf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Rf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="ConnectivityMonitor";class Uf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Se(Bf,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Se(Bf,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa=null;function Su(){return Oa===null?Oa=function(){return 268435456+Math.round(2147483648*Math.random())}():Oa++,"0x"+Oa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc="RestConnection",Nk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Dl?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const o=Su(),l=this.zo(e,t.toUriEncodedString());Se(Oc,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=ha(m);return this.Jo(e,l,u,n,d).then(f=>(Se(Oc,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Yi(Oc,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",n),f})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ro}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),n&&n.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const n=Nk[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="WebChannelConnection";class _k extends xk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=Su();return new Promise((l,u)=>{const m=new Jh;m.setWithCredentials(!0),m.listenOnce(Zh.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case ll.NO_ERROR:const f=m.getResponseJson();Se(Ks,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case ll.TIMEOUT:Se(Ks,`RPC '${e}' ${o} timed out`),u(new Ve(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ll.HTTP_ERROR:const h=m.getStatus();if(Se(Ks,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const v=function(B){const T=B.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(T)>=0?T:ie.UNKNOWN}(C.status);u(new Ve(v,C.message))}else u(new Ve(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new Ve(ie.UNAVAILABLE,"Connection failed."));break;default:Xe(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Se(Ks,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);Se(Ks,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,n,15)})}T_(e,t,n){const r=Su(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sg(),l=tg(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=i.join("");Se(Ks,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,y=!1;const C=new vk({Yo:V=>{y?Se(Ks,`Not sending because RPC '${e}' stream ${r} is closed:`,V):(h||(Se(Ks,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),Se(Ks,`RPC '${e}' stream ${r} sending:`,V),f.send(V))},Zo:()=>f.close()}),v=(V,B,T)=>{V.listen(B,q=>{try{T(q)}catch(oe){setTimeout(()=>{throw oe},0)}})};return v(f,Bo.EventType.OPEN,()=>{y||(Se(Ks,`RPC '${e}' stream ${r} transport opened.`),C.o_())}),v(f,Bo.EventType.CLOSE,()=>{y||(y=!0,Se(Ks,`RPC '${e}' stream ${r} transport closed`),C.a_(),this.E_(f))}),v(f,Bo.EventType.ERROR,V=>{y||(y=!0,Yi(Ks,`RPC '${e}' stream ${r} transport errored. Name:`,V.name,"Message:",V.message),C.a_(new Ve(ie.UNAVAILABLE,"The operation could not be completed")))}),v(f,Bo.EventType.MESSAGE,V=>{var B;if(!y){const T=V.data[0];Ot(!!T,16349);const q=T,oe=(q==null?void 0:q.error)||((B=q[0])==null?void 0:B.error);if(oe){Se(Ks,`RPC '${e}' stream ${r} received error:`,oe);const te=oe.status;let O=function(A){const P=bs[A];if(P!==void 0)return Rg(P)}(te),E=oe.message;O===void 0&&(O=ie.INTERNAL,E="Unknown error status: "+te+" with message "+oe.message),y=!0,C.a_(new Ve(O,E)),f.close()}else Se(Ks,`RPC '${e}' stream ${r} received:`,T),C.u_(T)}}),v(l,eg.STAT_EVENT,V=>{V.stat===yu.PROXY?Se(Ks,`RPC '${e}' stream ${r} detected buffering proxy`):V.stat===yu.NOPROXY&&Se(Ks,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Fc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(s){return new ED(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Se("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="PersistentStream";class Xg{constructor(e,t,n,r,i,o,l,u){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Gg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(cr(t.toString()),cr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===t&&this.G_(n,r)},n=>{e(()=>{const r=new Ve(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Se(Hf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Se(Hf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dk extends Xg{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=wD(this.serializer,e),n=function(i){if(!("targetChange"in i))return st.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?st.min():o.readTime?Wn(o.readTime):st.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Vu(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=_u(u)?{documents:LD(i,u)}:{query:PD(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Hg(i,o.resumeToken);const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(st.min())>0){l.readTime=Cl(i,o.snapshotVersion.toTimestamp());const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const n=jD(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Vu(this.serializer),t.removeTarget=e,this.q_(t)}}class kk extends Xg{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TD(e.writeResults,e.commitTime),n=Wn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Vu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>SD(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{}class Ek extends Ak{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ve(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Eu(t,n),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ve(ie.UNKNOWN,i.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,Eu(t,n),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ve(ie.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ck{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(cr(t),this.aa=!1):Se("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci="RemoteStore";class Vk{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{pi(this)&&(Se(ci,"Restarting streams for network reachability change."),await async function(u){const m=Ze(u);m.Ea.add(4),await lo(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Na(m)}(this))})}),this.Ra=new Ck(n,r)}}async function Na(s){if(pi(s))for(const e of s.da)await e(!0)}async function lo(s){for(const e of s.da)await e(!1)}function Jg(s,e){const t=Ze(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Em(t)?Am(t):co(t).O_()&&km(t,e))}function Dm(s,e){const t=Ze(s),n=co(t);t.Ia.delete(e),n.O_()&&Zg(t,e),t.Ia.size===0&&(n.O_()?n.L_():pi(t)&&t.Ra.set("Unknown"))}function km(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}co(s).Y_(e)}function Zg(s,e){s.Va.Ue(e),co(s).Z_(e)}function Am(s){s.Va=new _D({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),co(s).start(),s.Ra.ua()}function Em(s){return pi(s)&&!co(s).x_()&&s.Ia.size>0}function pi(s){return Ze(s).Ea.size===0}function ey(s){s.Va=void 0}async function wk(s){s.Ra.set("Online")}async function Sk(s){s.Ia.forEach((e,t)=>{km(s,e)})}async function Tk(s,e){ey(s),Em(s)?(s.Ra.ha(e),Am(s)):s.Ra.set("Unknown")}async function Lk(s,e,t){if(s.Ra.set("Online"),e instanceof Ug&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(s,e)}catch(n){Se(ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wl(s,n)}else if(e instanceof dl?s.Va.Ze(e):e instanceof Bg?s.Va.st(e):s.Va.tt(e),!t.isEqual(st.min()))try{const n=await Yg(s.localStore);t.compareTo(n)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(zs.EMPTY_BYTE_STRING,d.snapshotVersion)),Zg(i,u);const f=new kr(d.target,u,m,d.sequenceNumber);km(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(s,t)}catch(n){Se(ci,"Failed to raise snapshot:",n),await wl(s,n)}}async function wl(s,e,t){if(!oo(e))throw e;s.Ea.add(1),await lo(s),s.Ra.set("Offline"),t||(t=()=>Yg(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{Se(ci,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Na(s)})}function ty(s,e){return e().catch(t=>wl(s,t,e))}async function rc(s){const e=Ze(s),t=Rr(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:um;for(;Pk(e);)try{const r=await pk(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,Ik(e,r)}catch(r){await wl(e,r)}sy(e)&&ny(e)}function Pk(s){return pi(s)&&s.Ta.length<10}function Ik(s,e){s.Ta.push(e);const t=Rr(s);t.O_()&&t.X_&&t.ea(e.mutations)}function sy(s){return pi(s)&&!Rr(s).x_()&&s.Ta.length>0}function ny(s){Rr(s).start()}async function jk(s){Rr(s).ra()}async function Rk(s){const e=Rr(s);for(const t of s.Ta)e.ea(t.mutations)}async function Bk(s,e,t){const n=s.Ta.shift(),r=gm.from(n,e,t);await ty(s,()=>s.remoteSyncer.applySuccessfulWrite(r)),await rc(s)}async function Uk(s,e){e&&Rr(s).X_&&await async function(n,r){if(function(o){return ND(o)&&o!==ie.ABORTED}(r.code)){const i=n.Ta.shift();Rr(n).B_(),await ty(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await rc(n)}}(s,e),sy(s)&&ny(s)}async function Mf(s,e){const t=Ze(s);t.asyncQueue.verifyOperationInProgress(),Se(ci,"RemoteStore received new credentials");const n=pi(t);t.Ea.add(3),await lo(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Na(t)}async function Hk(s,e){const t=Ze(s);e?(t.Ea.delete(2),await Na(t)):e||(t.Ea.add(2),await lo(t),t.Ra.set("Unknown"))}function co(s){return s.ma||(s.ma=function(t,n,r){const i=Ze(t);return i.sa(),new Dk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:wk.bind(null,s),t_:Sk.bind(null,s),r_:Tk.bind(null,s),H_:Lk.bind(null,s)}),s.da.push(async e=>{e?(s.ma.B_(),Em(s)?Am(s):s.Ra.set("Unknown")):(await s.ma.stop(),ey(s))})),s.ma}function Rr(s){return s.fa||(s.fa=function(t,n,r){const i=Ze(t);return i.sa(),new kk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:jk.bind(null,s),r_:Uk.bind(null,s),ta:Rk.bind(null,s),na:Bk.bind(null,s)}),s.da.push(async e=>{e?(s.fa.B_(),await rc(s)):(await s.fa.stop(),s.Ta.length>0&&(Se(ci,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))})),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ir,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,l=new Cm(e,t,o,r,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vm(s,e){if(cr("AsyncQueue",`${e}: ${s}`),oo(s))return new Ve(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{static emptySet(e){return new Ki(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||We.comparator(t.key,n.key):(t,n)=>We.comparator(t.key,n.key),this.keyedMap=Uo(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ki)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ki;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(){this.ga=new rs(We.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class eo{constructor(e,t,n,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new eo(e,t,Ki.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Ok{constructor(){this.queries=Ff(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=Ze(t),i=r.queries;r.queries=Ff(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new Ve(ie.ABORTED,"Firestore shutting down"))}}function Ff(){return new fi(s=>kg(s),Xl)}async function wm(s,e){const t=Ze(s);let n=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(n=2):(i=new Mk,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Vm(o,`Initialization of query '${Hi(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Tm(t)}async function Sm(s,e){const t=Ze(s),n=e.query;let r=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function Fk(s,e){const t=Ze(s);let n=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(n=!0);o.wa=r}}n&&Tm(t)}function qk(s,e,t){const n=Ze(s),r=n.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);n.queries.delete(e)}function Tm(s){s.Ca.forEach(e=>{e.next()})}var Tu,qf;(qf=Tu||(Tu={})).Ma="default",qf.Cache="cache";class Lm{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new eo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e){this.key=e}}class iy{constructor(e){this.key=e}}class $k{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=kt(),this.mutatedKeys=kt(),this.eu=Ag(e),this.tu=new Ki(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Of,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=Jl(this.query,f)?f:null,C=!!h&&this.mutatedKeys.has(h.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let V=!1;h&&y?h.data.isEqual(y.data)?C!==v&&(n.track({type:3,doc:y}),V=!0):this.su(h,y)||(n.track({type:2,doc:y}),V=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!h&&y?(n.track({type:0,doc:y}),V=!0):h&&!y&&(n.track({type:1,doc:h}),V=!0,(u||m)&&(l=!0)),V&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,C){const v=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xe(20277,{Rt:V})}};return v(y)-v(C)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(n),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new eo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Of,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=kt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new iy(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new ry(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return eo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pm="SyncEngine";class Wk{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class zk{constructor(e){this.key=e,this.hu=!1}}class Kk{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new fi(l=>kg(l),Xl),this.Iu=new Map,this.Eu=new Set,this.du=new rs(We.comparator),this.Au=new Map,this.Ru=new Nm,this.Vu={},this.mu=new Map,this.fu=Zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qk(s,e,t=!0){const n=my(s);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await oy(n,e,t,!0),r}async function Yk(s,e){const t=my(s);await oy(t,e,!0,!1)}async function oy(s,e,t,n){const r=await hk(s.localStore,$n(e)),i=r.targetId,o=s.sharedClientState.addLocalQueryTarget(i,t);let l;return n&&(l=await Gk(s,e,i,o==="current",r.resumeToken)),s.isPrimaryClient&&t&&Jg(s.remoteStore,r),l}async function Gk(s,e,t,n,r){s.pu=(f,h,y)=>async function(v,V,B,T){let q=V.view.ru(B);q.Cs&&(q=await jf(v.localStore,V.query,!1).then(({documents:E})=>V.view.ru(E,q)));const oe=T&&T.targetChanges.get(V.targetId),te=T&&T.targetMismatches.get(V.targetId)!=null,O=V.view.applyChanges(q,v.isPrimaryClient,oe,te);return Wf(v,V.targetId,O.au),O.snapshot}(s,f,h,y);const i=await jf(s.localStore,e,!0),o=new $k(e,i.Qs),l=o.ru(i.documents),u=ba.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",r),m=o.applyChanges(l,s.isPrimaryClient,u);Wf(s,t,m.au);const d=new Wk(e,t,o);return s.Tu.set(e,d),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function Xk(s,e,t){const n=Ze(s),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter(o=>!Xl(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await wu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Dm(n.remoteStore,r.targetId),Lu(n,r.targetId)}).catch(io)):(Lu(n,r.targetId),await wu(n.localStore,r.targetId,!0))}async function Jk(s,e){const t=Ze(s),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Dm(t.remoteStore,n.targetId))}async function Zk(s,e,t){const n=oA(s);try{const r=await function(o,l){const u=Ze(o),m=ve.now(),d=l.reduce((y,C)=>y.add(C.key),kt());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=ur(),v=kt();return u.Ns.getEntries(y,d).next(V=>{C=V,C.forEach((B,T)=>{T.isValidDocument()||(v=v.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,C)).next(V=>{f=V;const B=[];for(const T of l){const q=pD(T,f.get(T.key).overlayedDocument);q!=null&&B.push(new Or(T.key,q,gg(q.value.mapValue),tn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,B,l)}).next(V=>{h=V;const B=V.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,V.batchId,B)})}).then(()=>({batchId:h.batchId,changes:Cg(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new rs(Dt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(n,r.batchId,t),await xa(n,r.changes),await rc(n.remoteStore)}catch(r){const i=Vm(r,"Failed to persist write");t.reject(i)}}async function ay(s,e){const t=Ze(s);try{const n=await dk(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Ot(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ot(o.hu,14607):r.removedDocuments.size>0&&(Ot(o.hu,42227),o.hu=!1))}),await xa(t,n,e)}catch(n){await io(n)}}function $f(s,e,t){const n=Ze(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=Ze(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Tm(u)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function eA(s,e,t){const n=Ze(s);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),i=r&&r.key;if(i){let o=new rs(We.comparator);o=o.insert(i,Gs.newNoDocument(i,st.min()));const l=kt().add(i),u=new sc(st.min(),new Map,new rs(Dt),o,l);await ay(n,u),n.du=n.du.remove(i),n.Au.delete(e),Im(n)}else await wu(n.localStore,e,!1).then(()=>Lu(n,e,t)).catch(io)}async function tA(s,e){const t=Ze(s),n=e.batch.batchId;try{const r=await mk(t.localStore,e);cy(t,n,null),ly(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await xa(t,r)}catch(r){await io(r)}}async function sA(s,e,t){const n=Ze(s);try{const r=await function(o,l){const u=Ze(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Ot(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(n.localStore,e);cy(n,e,t),ly(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await xa(n,r)}catch(r){await io(r)}}function ly(s,e){(s.mu.get(e)||[]).forEach(t=>{t.resolve()}),s.mu.delete(e)}function cy(s,e,t){const n=Ze(s);let r=n.Vu[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function Lu(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach(n=>{s.Ru.containsKey(n)||uy(s,n)})}function uy(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Dm(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),Im(s))}function Wf(s,e,t){for(const n of t)n instanceof ry?(s.Ru.addReference(n.key,e),nA(s,n)):n instanceof iy?(Se(Pm,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||uy(s,n.key)):Xe(19791,{wu:n})}function nA(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(Se(Pm,"New document in limbo: "+t),s.Eu.add(n),Im(s))}function Im(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new We(Xt.fromString(e)),n=s.fu.next();s.Au.set(n,new zk(t)),s.du=s.du.insert(t,n),Jg(s.remoteStore,new kr($n(Gl(t.path)),n,"TargetPurposeLimboResolution",Kl.ce))}}async function xa(s,e,t){const n=Ze(s),r=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((l,u)=>{o.push(n.pu(u,e,t).then(m=>{var d;if((m||t)&&n.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=vm.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),n.Pu.H_(r),await async function(u,m){const d=Ze(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ce.forEach(m,h=>ce.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>ce.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!oo(f))throw f;Se(_m,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),C=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(C);d.Ms=d.Ms.insert(h,v)}}}(n.localStore,i))}async function rA(s,e){const t=Ze(s);if(!t.currentUser.isEqual(e)){Se(Pm,"User change. New user:",e.toKey());const n=await Qg(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Ve(ie.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await xa(t,n.Ls)}}function iA(s,e){const t=Ze(s),n=t.Au.get(e);if(n&&n.hu)return kt().add(n.key);{let r=kt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function my(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ay.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eA.bind(null,e),e.Pu.H_=Fk.bind(null,e.eventManager),e.Pu.yu=qk.bind(null,e.eventManager),e}function oA(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sA.bind(null,e),e}class Sl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return uk(this.persistence,new ak,e.initialUser,this.serializer)}Cu(e){return new Kg(xm.mi,this.serializer)}Du(e){return new yk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sl.provider={build:()=>new Sl};class aA extends Sl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ot(this.persistence.referenceDelegate instanceof Vl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new zD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?an.withCacheSize(this.cacheSizeBytes):an.DEFAULT;return new Kg(n=>Vl.mi(n,t),this.serializer)}}class Pu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$f(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=rA.bind(null,this.syncEngine),await Hk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ok}()}createDatastore(e){const t=nc(e.databaseInfo.databaseId),n=function(i){return new _k(i)}(e.databaseInfo);return function(i,o,l,u){return new Ek(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,i,o,l){return new Vk(n,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>$f(this.syncEngine,t,0),function(){return Uf.v()?new Uf:new bk}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new Kk(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=Ze(r);Se(ci,"RemoteStore shutting down."),i.Ea.add(5),await lo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Pu.provider={build:()=>new Pu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):cr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br="FirestoreClient";class lA{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ys.UNAUTHENTICATED,this.clientId=cm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{Se(Br,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Se(Br,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ir;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Vm(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qc(s,e){s.asyncQueue.verifyOperationInProgress(),Se(Br,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener(async r=>{n.isEqual(r)||(await Qg(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function zf(s,e){s.asyncQueue.verifyOperationInProgress();const t=await dy(s);Se(Br,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(n=>Mf(e.remoteStore,n)),s.setAppCheckTokenChangeListener((n,r)=>Mf(e.remoteStore,r)),s._onlineComponents=e}async function dy(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Se(Br,"Using user provided OfflineComponentProvider");try{await qc(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===ie.FAILED_PRECONDITION||r.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Yi("Error using user provided cache. Falling back to memory cache: "+t),await qc(s,new Sl)}}else Se(Br,"Using default OfflineComponentProvider"),await qc(s,new aA(void 0));return s._offlineComponents}async function Rm(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Se(Br,"Using user provided OnlineComponentProvider"),await zf(s,s._uninitializedComponentsProvider._online)):(Se(Br,"Using default OnlineComponentProvider"),await zf(s,new Pu))),s._onlineComponents}function fy(s){return dy(s).then(e=>e.persistence)}function py(s){return Rm(s).then(e=>e.remoteStore)}function cA(s){return Rm(s).then(e=>e.syncEngine)}async function Tl(s){const e=await Rm(s),t=e.eventManager;return t.onListen=Qk.bind(null,e.syncEngine),t.onUnlisten=Xk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Yk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Jk.bind(null,e.syncEngine),t}function uA(s){return s.asyncQueue.enqueue(async()=>{const e=await fy(s),t=await py(s);return e.setNetworkEnabled(!0),function(r){const i=Ze(r);return i.Ea.delete(0),Na(i)}(t)})}function mA(s){return s.asyncQueue.enqueue(async()=>{const e=await fy(s),t=await py(s);return e.setNetworkEnabled(!1),async function(r){const i=Ze(r);i.Ea.add(0),await lo(i),i.Ra.set("Offline")}(t)})}function dA(s,e,t={}){const n=new ir;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f));const y=h.docs.has(l);!y&&h.fromCache?m.reject(new Ve(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&u&&u.source==="server"?m.reject(new Ve(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(Gl(l.path),d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}function fA(s,e,t={}){const n=new ir;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f)),h.fromCache&&u.source==="server"?m.reject(new Ve(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(l,d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="firestore.googleapis.com",Qf=!0;class Yf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gy,this.ssl=Qf}else this.host=e.host,this.ssl=e.ssl??Qf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zg;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$D)throw new Ve(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}C_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ve(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ve(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ve(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ic{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new y_;switch(n.type){case"firstParty":return new v_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ve(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Kf.get(t);n&&(Se("ComponentProvider","Removing Datastore"),Kf.delete(t),n.terminate())}(this),Promise.resolve()}}function pA(s,e,t,n={}){var m;s=$s(s,ic);const r=ha(e),i=s._getSettings(),o={...i,emulatorOptions:s._getEmulatorOptions()},l=`${e}:${t}`;r&&(Bh(`https://${l}`),Hh("Firestore",!0)),i.host!==gy&&i.host!==l&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:n};if(!vl(u,o)&&(s._setSettings(u),n.mockUserToken)){let d,f;if(typeof n.mockUserToken=="string")d=n.mockUserToken,f=Ys.MOCK_USER;else{d=Uh(n.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Ve(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ys(h)}s._authCredentials=new b_(new rg(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Fr(this.firestore,e,this._query)}}class os{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new os(this.firestore,e,this._key)}toJSON(){return{type:os._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(ga(t,os._jsonSchema))return new os(e,n||null,new We(Xt.fromString(t.referencePath)))}}os._jsonSchemaVersion="firestore/documentReference/1.0",os._jsonSchema={type:ks("string",os._jsonSchemaVersion),referencePath:ks("string")};class Sr extends Fr{constructor(e,t,n){super(e,t,Gl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new os(this.firestore,null,new We(e))}withConverter(e){return new Sr(this.firestore,e,this._path)}}function $e(s,e,...t){if(s=Ws(s),ig("collection","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return lf(n),new Sr(s,null,n)}{if(!(s instanceof os||s instanceof Sr))throw new Ve(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return lf(n),new Sr(s.firestore,null,n)}}function Le(s,e,...t){if(s=Ws(s),arguments.length===1&&(e=cm.newId()),ig("doc","path",e),s instanceof ic){const n=Xt.fromString(e,...t);return af(n),new os(s,null,new We(n))}{if(!(s instanceof os||s instanceof Sr))throw new Ve(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Xt.fromString(e,...t));return af(n),new os(s.firestore,s instanceof Sr?s.converter:null,new We(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="AsyncQueue";class Xf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Gg(this,"async_queue_retry"),this._c=()=>{const n=Fc();n&&Se(Gf,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Fc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new ir;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;Se(Gf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,cr("INTERNAL UNHANDLED ERROR: ",Jf(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cm.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Xe(47125,{Pc:Jf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Jf(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(s){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(s,["next","error","complete"])}class vn extends ic{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Xf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xf(e),this._firestoreClient=void 0,await e}}}function hA(s,e){const t=typeof s=="object"?s:Qh(),n=typeof s=="string"?s:Dl,r=$h(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=jh("firestore");i&&pA(r,...i)}return r}function hi(s){if(s._terminated)throw new Ve(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||gA(s),s._firestoreClient}function gA(s){var n,r,i;const e=s._freezeSettings(),t=function(l,u,m,d){return new U_(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hy(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,e);s._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new lA(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(s._componentsProvider))}function yA(s){return uA(hi(s=$s(s,vn)))}function bA(s){return mA(hi(s=$s(s,vn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xn(zs.fromBase64String(e))}catch(t){throw new Ve(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xn(zs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ga(e,xn._jsonSchema))return xn.fromBase64String(e.bytes)}}xn._jsonSchemaVersion="firestore/bytes/1.0",xn._jsonSchema={type:ks("string",xn._jsonSchemaVersion),bytes:ks("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ve(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Dt(this._lat,e._lat)||Dt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zn._jsonSchemaVersion}}static fromJSON(e){if(ga(e,zn._jsonSchema))return new zn(e.latitude,e.longitude)}}zn._jsonSchemaVersion="firestore/geoPoint/1.0",zn._jsonSchema={type:ks("string",zn._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Kn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ga(e,Kn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Kn(e.vectorValues);throw new Ve(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Kn._jsonSchemaVersion="firestore/vectorValue/1.0",Kn._jsonSchema={type:ks("string",Kn._jsonSchemaVersion),vectorValues:ks("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=/^__.*__$/;class xA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Or(e,this.data,this.fieldMask,t,this.fieldTransforms):new ya(e,this.data,t,this.fieldTransforms)}}class yy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Or(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function by(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xe(40011,{Ac:s})}}class Bm{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Bm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ll(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(by(this.Ac)&&NA.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vA{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||nc(e)}Cc(e,t,n,r=!1){return new Bm({Ac:e,methodName:t,Dc:n,path:qs.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _a(s){const e=s._freezeSettings(),t=nc(s._databaseId);return new vA(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Um(s,e,t,n,r,i={}){const o=s.Cc(i.merge||i.mergeFields?2:0,e,t,r);Mm("Data must be an object, but it was:",o,n);const l=vy(n,o);let u,m;if(i.merge)u=new fn(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=Iu(e,f,t);if(!o.contains(h))throw new Ve(ie.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Dy(d,h)||d.push(h)}u=new fn(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new xA(new cn(l),u,m)}class ac extends oc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ac}}class Hm extends oc{_toFieldTransform(e){return new uD(e.path,new la)}isEqual(e){return e instanceof Hm}}function Ny(s,e,t,n){const r=s.Cc(1,e,t);Mm("Data must be an object, but it was:",r,n);const i=[],o=cn.empty();Mr(n,(u,m)=>{const d=Om(e,u,t);m=Ws(m);const f=r.yc(d);if(m instanceof ac)i.push(d);else{const h=Da(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new fn(i);return new yy(o,l,r.fieldTransforms)}function xy(s,e,t,n,r,i){const o=s.Cc(1,e,t),l=[Iu(e,n,t)],u=[r];if(i.length%2!=0)throw new Ve(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Iu(e,i[h])),u.push(i[h+1]);const m=[],d=cn.empty();for(let h=l.length-1;h>=0;--h)if(!Dy(m,l[h])){const y=l[h];let C=u[h];C=Ws(C);const v=o.yc(y);if(C instanceof ac)m.push(y);else{const V=Da(C,v);V!=null&&(m.push(y),d.set(y,V))}}const f=new fn(m);return new yy(d,f,o.fieldTransforms)}function _A(s,e,t,n=!1){return Da(t,s.Cc(n?4:3,e))}function Da(s,e){if(_y(s=Ws(s)))return Mm("Unsupported field value:",e,s),vy(s,e);if(s instanceof oc)return function(n,r){if(!by(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let o=0;for(const l of n){let u=Da(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(s,e)}return function(n,r){if((n=Ws(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return aD(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ve.fromDate(n);return{timestampValue:Cl(r.serializer,i)}}if(n instanceof ve){const i=new ve(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Cl(r.serializer,i)}}if(n instanceof zn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xn)return{bytesValue:Hg(r.serializer,n._byteString)};if(n instanceof os){const i=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bm(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Kn)return function(o,l){return{mapValue:{fields:{[pg]:{stringValue:hg},[kl]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return hm(l.serializer,m)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${zl(n)}`)}(s,e)}function vy(s,e){const t={};return lg(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mr(s,(n,r)=>{const i=Da(r,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function _y(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof ve||s instanceof zn||s instanceof xn||s instanceof os||s instanceof oc||s instanceof Kn)}function Mm(s,e,t){if(!_y(t)||!og(t)){const n=zl(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function Iu(s,e,t){if((e=Ws(e))instanceof va)return e._internalPath;if(typeof e=="string")return Om(s,e);throw Ll("Field path arguments must be of type string or ",s,!1,void 0,t)}const DA=new RegExp("[~\\*/\\[\\]]");function Om(s,e,t){if(e.search(DA)>=0)throw Ll(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new va(...e.split("."))._internalPath}catch{throw Ll(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Ll(s,e,t,n,r){const i=n&&!n.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${r}`),u+=")"),new Ve(ie.INVALID_ARGUMENT,l+s+u)}function Dy(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new os(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kA extends ky{data(){return super.data()}}function lc(s,e){return typeof e=="string"?Om(s,e):e instanceof va?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ve(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fm{}class Ey extends Fm{}function _t(s,e,...t){let n=[];e instanceof Fm&&n.push(e),n=n.concat(t),function(i){const o=i.filter(u=>u instanceof qm).length,l=i.filter(u=>u instanceof cc).length;if(o>1||o>0&&l>0)throw new Ve(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)s=r._apply(s);return s}class cc extends Ey{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cc(e,t,n)}_apply(e){const t=this._parse(e);return Cy(e._query,t),new Fr(e.firestore,e.converter,Du(e._query,t))}_parse(e){const t=_a(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ve(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){tp(f,d);const C=[];for(const v of f)C.push(ep(u,i,v));h={arrayValue:{values:C}}}else h=ep(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||tp(f,d),h=_A(l,o,f,d==="in"||d==="not-in");return _s.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Rs(s,e,t){const n=e,r=lc("where",s);return cc._create(r,n,t)}class qm extends Fm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qm(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Ln.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)Cy(o,u),o=Du(o,u)}(e._query,t),new Fr(e.firestore,e.converter,Du(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $m extends Ey{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $m(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new Ve(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ve(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new aa(i,o)}(e._query,this._field,this._direction);return new Fr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new ao(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function as(s,e="asc"){const t=e,n=lc("orderBy",s);return $m._create(n,t)}function ep(s,e,t){if(typeof(t=Ws(t))=="string"){if(t==="")throw new Ve(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dg(e)&&t.indexOf("/")!==-1)throw new Ve(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Xt.fromString(t));if(!We.isDocumentKey(n))throw new Ve(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return gf(s,new We(n))}if(t instanceof os)return gf(s,t._key);throw new Ve(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zl(t)}.`)}function tp(s,e){if(!Array.isArray(s)||s.length===0)throw new Ve(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cy(s,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(s.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ve(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AA{convertValue(e,t="none"){switch(jr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ds(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Mr(e,(r,i)=>{n[r]=this.convertValue(i,t)}),n}convertVectorValue(e){var n,r,i;const t=(i=(r=(n=e.fields)==null?void 0:n[kl].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>ds(o.doubleValue));return new Kn(t)}convertGeoPoint(e){return new zn(ds(e.latitude),ds(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Yl(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ra(e));default:return null}}convertTimestamp(e){const t=Pr(e);return new ve(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xt.fromString(e);Ot(Wg(n),9688,{name:e});const r=new ia(n.get(1),n.get(3)),i=new We(n.popFirst(5));return r.isEqual(t)||cr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class Mo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ri extends ky{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(lc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ri._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ri._jsonSchemaVersion="firestore/documentSnapshot/1.0",ri._jsonSchema={type:ks("string",ri._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class fl extends ri{data(e={}){return super.data(e)}}class ii{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Mo(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new fl(this._firestore,this._userDataWriter,n.key,n,new Mo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:EA(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ii._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EA(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xe(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(s){s=$s(s,os);const e=$s(s.firestore,vn);return dA(hi(e),s._key).then(t=>Vy(e,s,t))}ii._jsonSchemaVersion="firestore/querySnapshot/1.0",ii._jsonSchema={type:ks("string",ii._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class zm extends AA{constructor(e){super(),this.firestore=e}convertBytes(e){return new xn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new os(this.firestore,null,t)}}function St(s){s=$s(s,Fr);const e=$s(s.firestore,vn),t=hi(e),n=new zm(e);return Ay(s._query),fA(t,s._query).then(r=>new ii(e,n,s,r))}function ui(s,e,t){s=$s(s,os);const n=$s(s.firestore,vn),r=Wm(s.converter,e,t);return ka(n,[Um(_a(n),"setDoc",s._key,r,s.converter!==null,t).toMutation(s._key,tn.none())])}function Mt(s,e,t,...n){s=$s(s,os);const r=$s(s.firestore,vn),i=_a(r);let o;return o=typeof(e=Ws(e))=="string"||e instanceof va?xy(i,"updateDoc",s._key,e,t,n):Ny(i,"updateDoc",s._key,e),ka(r,[o.toMutation(s._key,tn.exists(!0))])}function Fs(s){return ka($s(s.firestore,vn),[new tc(s._key,tn.none())])}function Qn(s,e){const t=$s(s.firestore,vn),n=Le(s),r=Wm(s.converter,e);return ka(t,[Um(_a(s.firestore),"addDoc",n._key,r,s.converter!==null,{}).toMutation(n._key,tn.exists(!1))]).then(()=>n)}function hn(s,...e){var u,m,d;s=Ws(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Zf(e[n])||(t=e[n++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Zf(e[n])){const f=e[n];e[n]=(u=f.next)==null?void 0:u.bind(f),e[n+1]=(m=f.error)==null?void 0:m.bind(f),e[n+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(s instanceof os)o=$s(s.firestore,vn),l=Gl(s._key.path),i={next:f=>{e[n]&&e[n](Vy(o,s,f))},error:e[n+1],complete:e[n+2]};else{const f=$s(s,Fr);o=$s(f.firestore,vn),l=f._query;const h=new zm(o);i={next:y=>{e[n]&&e[n](new ii(o,h,f,y))},error:e[n+1],complete:e[n+2]},Ay(s._query)}return function(h,y,C,v){const V=new jm(v),B=new Lm(y,V,C);return h.asyncQueue.enqueueAndForget(async()=>wm(await Tl(h),B)),()=>{V.Nu(),h.asyncQueue.enqueueAndForget(async()=>Sm(await Tl(h),B))}}(hi(o),l,r,i)}function ka(s,e){return function(n,r){const i=new ir;return n.asyncQueue.enqueueAndForget(async()=>Zk(await cA(n),r,i)),i.promise}(hi(s),e)}function Vy(s,e,t){const n=t.docs.get(e._key),r=new zm(s);return new ri(s,r,e._key,n,new Mo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=_a(e)}set(e,t,n){this._verifyNotCommitted();const r=$c(e,this._firestore),i=Wm(r.converter,t,n),o=Um(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,tn.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=$c(e,this._firestore);let o;return o=typeof(t=Ws(t))=="string"||t instanceof va?xy(this._dataReader,"WriteBatch.update",i._key,t,n,r):Ny(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,tn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=$c(e,this._firestore);return this._mutations=this._mutations.concat(new tc(t._key,tn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $c(s,e){if((s=Ws(s)).firestore!==e)throw new Ve(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function is(){return new Hm("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(s){return hi(s=$s(s,vn)),new CA(s,e=>ka(s,e))}(function(e,t=!0){(function(r){ro=r})(zh),ta(new Qi("firestore",(n,{instanceIdentifier:r,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new vn(new N_(n.getProvider("auth-internal")),new __(o,n.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ve(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ia(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Vr(sf,nf,e),Vr(sf,nf,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="firebasestorage.googleapis.com",Sy="storageBucket",wA=2*60*1e3,SA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends di{constructor(e,t,n=0){super(Wc(e),`Firebase Storage: ${t} (${Wc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ls;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ls||(ls={}));function Wc(s){return"storage/"+s}function Km(){const s="An unknown error occurred, please check the error payload for server response.";return new cs(ls.UNKNOWN,s)}function TA(s){return new cs(ls.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function LA(s){return new cs(ls.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function PA(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new cs(ls.UNAUTHENTICATED,s)}function IA(){return new cs(ls.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function jA(s){return new cs(ls.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function RA(){return new cs(ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BA(){return new cs(ls.CANCELED,"User canceled the upload/download.")}function UA(s){return new cs(ls.INVALID_URL,"Invalid URL '"+s+"'.")}function HA(s){return new cs(ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function MA(){return new cs(ls.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Sy+"' property when initializing the app?")}function OA(){return new cs(ls.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function FA(){return new cs(ls.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qA(s){return new cs(ls.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ju(s){return new cs(ls.INVALID_ARGUMENT,s)}function Ty(){return new cs(ls.APP_DELETED,"The Firebase app was deleted.")}function $A(s){return new cs(ls.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Qo(s,e){return new cs(ls.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function _o(s){throw new cs(ls.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=pn.makeFromUrl(e,t)}catch{return new pn(e,"")}if(n.path==="")return n;throw HA(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(oe){oe.path.charAt(oe.path.length-1)==="/"&&(oe.path_=oe.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(oe){oe.path_=decodeURIComponent(oe.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),C={bucket:1,path:3},v=t===wy?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",B=new RegExp(`^https?://${v}/${r}/${V}`,"i"),q=[{regex:l,indices:u,postModify:i},{regex:y,indices:C,postModify:m},{regex:B,indices:{bucket:1,path:2},postModify:m}];for(let oe=0;oe<q.length;oe++){const te=q[oe],O=te.regex.exec(e);if(O){const E=O[te.indices.bucket];let x=O[te.indices.path];x||(x=""),n=new pn(E,x),te.postModify(n);break}}if(n==null)throw UA(e);return n}}class WA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(s,e,t){let n=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...V){m||(m=!0,e.apply(null,V))}function f(V){r=setTimeout(()=>{r=null,s(y,u())},V)}function h(){i&&clearTimeout(i)}function y(V,...B){if(m){h();return}if(V){h(),d.call(null,V,...B);return}if(u()||o){h(),d.call(null,V,...B);return}n<64&&(n*=2);let q;l===1?(l=2,q=0):q=(n+Math.random())*1e3,f(q)}let C=!1;function v(V){C||(C=!0,h(),!m&&(r!==null?(V||(l=2),clearTimeout(r),f(0)):V||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function KA(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(s){return s!==void 0}function YA(s){return typeof s=="object"&&!Array.isArray(s)}function Qm(s){return typeof s=="string"||s instanceof String}function sp(s){return Ym()&&s instanceof Blob}function Ym(){return typeof Blob<"u"}function np(s,e,t,n){if(n<e)throw ju(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw ju(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function Ly(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const r=e(n)+"="+e(s[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var oi;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(oi||(oi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(s,e){const t=s>=500&&s<600,r=[408,429].indexOf(s)!==-1,i=e.indexOf(s)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,t,n,r,i,o,l,u,m,d,f,h=!0,y=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,v)=>{this.resolve_=C,this.reject_=v,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Fa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===oi.NO_ERROR,u=i.getStatus();if(!l||GA(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===oi.ABORT;n(!1,new Fa(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;n(!0,new Fa(m,i))})},t=(n,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());QA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=Km();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?Ty():BA();o(u)}else{const u=RA();o(u)}};this.canceled_?t(!1,new Fa(!1,null,!0)):this.backoffId_=zA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Fa{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function JA(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function ZA(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function eE(s,e){e&&(s["X-Firebase-GMPID"]=e)}function tE(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function sE(s,e,t,n,r,i,o=!0,l=!1){const u=Ly(s.urlParams),m=s.url+u,d=Object.assign({},s.headers);return eE(d,e),JA(d,t),ZA(d,i),tE(d,n),new XA(m,s.method,d,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rE(...s){const e=nE();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(Ym())return new Blob(s);throw new cs(ls.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function iE(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(s){if(typeof atob>"u")throw qA("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zc{constructor(e,t){this.data=e,this.contentType=t||null}}function aE(s,e){switch(s){case qn.RAW:return new zc(Py(e));case qn.BASE64:case qn.BASE64URL:return new zc(Iy(s,e));case qn.DATA_URL:return new zc(cE(e),uE(e))}throw Km()}function Py(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=s.charCodeAt(++t);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function lE(s){let e;try{e=decodeURIComponent(s)}catch{throw Qo(qn.DATA_URL,"Malformed data URL.")}return Py(e)}function Iy(s,e){switch(s){case qn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case qn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=oE(e)}catch(r){throw r.message.includes("polyfill")?r:Qo(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class jy{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Qo(qn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=mE(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function cE(s){const e=new jy(s);return e.base64?Iy(qn.BASE64,e.rest):lE(e.rest)}function uE(s){return new jy(s).contentType}function mE(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,t){let n=0,r="";sp(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(sp(this.data_)){const n=this.data_,r=iE(n,e,t);return r===null?null:new _r(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new _r(n,!0)}}static getBlob(...e){if(Ym()){const t=e.map(n=>n instanceof _r?n.data_:n);return new _r(rE.apply(null,t))}else{const t=e.map(o=>Qm(o)?aE(qn.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let i=0;return t.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new _r(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(s){let e;try{e=JSON.parse(s)}catch{return null}return YA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function fE(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function By(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(s,e){return e}class Zs{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||pE}}let qa=null;function hE(s){return!Qm(s)||s.length<2?s:By(s)}function Uy(){if(qa)return qa;const s=[];s.push(new Zs("bucket")),s.push(new Zs("generation")),s.push(new Zs("metageneration")),s.push(new Zs("name","fullPath",!0));function e(i,o){return hE(o)}const t=new Zs("name");t.xform=e,s.push(t);function n(i,o){return o!==void 0?Number(o):o}const r=new Zs("size");return r.xform=n,s.push(r),s.push(new Zs("timeCreated")),s.push(new Zs("updated")),s.push(new Zs("md5Hash",null,!0)),s.push(new Zs("cacheControl",null,!0)),s.push(new Zs("contentDisposition",null,!0)),s.push(new Zs("contentEncoding",null,!0)),s.push(new Zs("contentLanguage",null,!0)),s.push(new Zs("contentType",null,!0)),s.push(new Zs("metadata","customMetadata",!0)),qa=s,qa}function gE(s,e){function t(){const n=s.bucket,r=s.fullPath,i=new pn(n,r);return e._makeStorageReference(i)}Object.defineProperty(s,"ref",{get:t})}function yE(s,e,t){const n={};n.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];n[o.local]=o.xform(n,e[o.server])}return gE(n,s),n}function Hy(s,e,t){const n=Ry(e);return n===null?null:yE(s,n,t)}function bE(s,e,t,n){const r=Ry(e);if(r===null||!Qm(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(m=>{const d=s.bucket,f=s.fullPath,h="/b/"+o(d)+"/o/"+o(f),y=uc(h,t,n),C=Ly({alt:"media",token:m});return y+C})[0]}function NE(s,e){const t={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(t[i.server]=s[i.local])}return JSON.stringify(t)}class Gm{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(s){if(!s)throw Km()}function xE(s,e){function t(n,r){const i=Hy(s,r,e);return My(i!==null),i}return t}function vE(s,e){function t(n,r){const i=Hy(s,r,e);return My(i!==null),bE(i,r,s.host,s._protocol)}return t}function Oy(s){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=IA():r=PA():t.getStatus()===402?r=LA(s.bucket):t.getStatus()===403?r=jA(s.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Fy(s){const e=Oy(s);function t(n,r){let i=e(n,r);return n.getStatus()===404&&(i=TA(s.path)),i.serverResponse=r.serverResponse,i}return t}function _E(s,e,t){const n=e.fullServerUrl(),r=uc(n,s.host,s._protocol),i="GET",o=s.maxOperationRetryTime,l=new Gm(r,i,vE(s,t),o);return l.errorHandler=Fy(e),l}function DE(s,e){const t=e.fullServerUrl(),n=uc(t,s.host,s._protocol),r="DELETE",i=s.maxOperationRetryTime;function o(u,m){}const l=new Gm(n,r,o,i);return l.successCodes=[200,204],l.errorHandler=Fy(e),l}function kE(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function AE(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=kE(null,e)),n}function EE(s,e,t,n,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let q="";for(let oe=0;oe<2;oe++)q=q+Math.random().toString().slice(2);return q}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const m=AE(e,n,r),d=NE(m,t),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+m.contentType+`\r
\r
`,h=`\r
--`+u+"--",y=_r.getBlob(f,n,h);if(y===null)throw OA();const C={name:m.fullPath},v=uc(i,s.host,s._protocol),V="POST",B=s.maxUploadRetryTime,T=new Gm(v,V,xE(s,t),B);return T.urlParams=C,T.headers=o,T.body=y.uploadData(),T.errorHandler=Oy(e),T}class CE{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=oi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=oi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=oi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,i){if(this.sent_)throw _o("cannot .send() more than once");if(ha(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _o("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _o("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw _o("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _o("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VE extends CE{initXhr(){this.xhr_.responseType="text"}}function Xm(){return new VE}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){this._service=e,t instanceof pn?this._location=t:this._location=pn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new mi(e,t)}get root(){const e=new pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return By(this._location.path)}get storage(){return this._service}get parent(){const e=dE(this._location.path);if(e===null)return null;const t=new pn(this._location.bucket,e);return new mi(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $A(e)}}function wE(s,e,t){s._throwIfRoot("uploadBytes");const n=EE(s.storage,s._location,Uy(),new _r(e,!0),t);return s.storage.makeRequestWithTokens(n,Xm).then(r=>({metadata:r,ref:s}))}function SE(s){s._throwIfRoot("getDownloadURL");const e=_E(s.storage,s._location,Uy());return s.storage.makeRequestWithTokens(e,Xm).then(t=>{if(t===null)throw FA();return t})}function TE(s){s._throwIfRoot("deleteObject");const e=DE(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Xm)}function LE(s,e){const t=fE(s._location.path,e),n=new pn(s._location.bucket,t);return new mi(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(s){return/^[A-Za-z]+:\/\//.test(s)}function IE(s,e){return new mi(s,e)}function qy(s,e){if(s instanceof Jm){const t=s;if(t._bucket==null)throw MA();const n=new mi(t,t._bucket);return e!=null?qy(n,e):n}else return e!==void 0?LE(s,e):s}function jE(s,e){if(e&&PE(e)){if(s instanceof Jm)return IE(s,e);throw ju("To use ref(service, url), the first argument must be a Storage instance.")}else return qy(s,e)}function rp(s,e){const t=e==null?void 0:e[Sy];return t==null?null:pn.makeFromBucketSpec(t,s)}function RE(s,e,t,n={}){s.host=`${e}:${t}`;const r=ha(e);r&&(Bh(`https://${s.host}/b`),Hh("Storage",!0)),s._isUsingEmulator=!0,s._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(s._overrideAuthToken=typeof i=="string"?i:Uh(i,s.app.options.projectId))}class Jm{constructor(e,t,n,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=wy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wA,this._maxUploadRetryTime=SA,this._requests=new Set,r!=null?this._bucket=pn.makeFromBucketSpec(r,this._host):this._bucket=rp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,e):this._bucket=rp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){np("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){np("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wh(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new mi(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new WA(Ty());{const o=sE(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const ip="@firebase/storage",op="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="storage";function Ru(s,e,t){return s=Ws(s),wE(s,e,t)}function Bu(s){return s=Ws(s),SE(s)}function BE(s){return s=Ws(s),TE(s)}function Pl(s,e){return s=Ws(s),jE(s,e)}function UE(s=Qh(),e){s=Ws(s);const n=$h(s,$y).getImmediate({identifier:e}),r=jh("storage");return r&&HE(n,...r),n}function HE(s,e,t,n={}){RE(s,e,t,n)}function ME(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),r=s.getProvider("app-check-internal");return new Jm(t,n,r,e,zh)}function OE(){ta(new Qi($y,ME,"PUBLIC").setMultipleInstances(!0)),Vr(ip,op,""),Vr(ip,op,"esm2020")}OE();const FE={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Wy=Xd().length===0?Kh(FE):Xd()[0],ne=hA(Wy),Il=UE(Wy),ap=async()=>{try{console.log("[Firebase]   ..."),await bA(ne),await yA(ne),console.log("[Firebase]   ")}catch(s){console.error("[Firebase]   :",s)}},$a=async s=>{const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")},qE=s=>{const t=new TextEncoder().encode(s);let n="";return t.forEach(r=>n+=String.fromCharCode(r)),btoa(n)},$E=s=>{const e=atob(s),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)},lp=s=>{const e={id:s.id,username:s.username,role:s.role,iat:Date.now(),exp:Date.now()+2592e6};return qE(JSON.stringify(e))},cp=s=>{try{if(s.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse($E(s));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},up={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Kc={async login(s){console.time("[Auth]   ");const e=up[s.username];if(e){if(s.password!==e.password)throw new Error("  .");const d=e.user,f=lp(d);return St(_t($e(ne,"users"),Rs("username","==",s.username))).then(h=>{h.empty||Mt(Le(ne,"users",h.docs[0].id),{lastLogin:is()}).catch(y=>console.error("lastLogin  :",y))}).catch(h=>console.error("Firestore  :",h)),console.timeEnd("[Auth]   "),{success:!0,token:f,user:d}}console.time("[Auth] Firestore ");const t=$e(ne,"users"),n=_t(t,Rs("username","==",s.username)),r=await St(n);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],o=i.data(),l=await $a(s.password);if(o.passwordHash){if(o.passwordHash!==l)throw new Error("  .")}else if(o.password){if(o.password.startsWith("$2b$")||o.password.startsWith("$2a$")){if(s.password!=="1234")throw new Error("  .")}else if(o.password!==s.password&&s.password!=="1234")throw new Error("  .")}else if(s.password!=="1234")throw new Error("  .");const u={id:i.id,username:o.username,name:o.name,email:o.email,role:o.role||"user",phone:o.phone,department:o.department,position:o.position,avatar:o.avatar},m=lp(u);return Mt(Le(ne,"users",i.id),{lastLogin:is()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:m,user:u}},async getCurrentUser(s){const e=cp(s);if(!e)return null;const t=up[e.username];if(t)return t.user;try{const n=await jt(Le(ne,"users",e.id));if(!n.exists())return null;const r=n.data();return{id:n.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(n){return console.error("Firestore getCurrentUser error:",n),null}},async getUserById(s){const e=await jt(Le(ne,"users",s));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(s){const e=$e(ne,"users"),t=_t(e,Rs("username","==",s)),n=await St(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const s=$e(ne,"users");return(await St(s)).docs.map(t=>{const n=t.data();return{id:t.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}})},async createUser(s){const{password:e,...t}=s,n=await $a(e),r=$e(ne,"users"),i=Le(r),o={...t,passwordHash:n,createdAt:is(),updatedAt:is()};return await ui(i,o),{id:i.id,...t}},async updateUser(s,e){const t=Le(ne,"users",s);await Mt(t,{...e,updatedAt:is()});const r=(await jt(t)).data();return{id:s,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(s,e,t){const n=await jt(Le(ne,"users",s));if(!n.exists())throw new Error("   .");const r=n.data(),i=await $a(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await $a(t);return await Mt(Le(ne,"users",s),{passwordHash:o,updatedAt:is()}),!0},verifyToken:cp};class WE{async login(e){const t=await Kc.login(e);return t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}async getCurrentUser(){const e=this.getToken(),t=this.getUser();if(!e)return t;try{const n=await Kc.getCurrentUser(e);return n?(localStorage.setItem("user",JSON.stringify(n)),n):(console.log("Token invalid or expired, using cached user..."),t?(localStorage.removeItem("token"),t):null)}catch(n){return console.error("Get current user error:",n),t?(console.log("Using cached user data due to error"),t):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Kc.getAllUsers()}}const mp=new WE,Di=(s,e)=>({id:parseInt(s)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Qc={async getLibraryMeta(){const s=$e(ne,"specbook_items"),e=_t(s,Rs("is_library","==",1),as("category"),as("name"));return(await St(e)).docs.map(n=>Di(n.id,n.data()))},async getCategories(){const s=await this.getLibraryMeta();return[...new Set(s.map(t=>t.category))].sort()},async getProjectMeta(s){const e=$e(ne,"specbook_items"),t=_t(e,Rs("project_id","==",s),as("display_order"));return(await St(t)).docs.map(r=>Di(r.id,r.data()))},async getItemById(s){const e=Le(ne,"specbook_items",s),t=await jt(e);return t.exists()?Di(t.id,t.data()):null},async getItemImage(s){const e=Le(ne,"specbook_items",s),t=await jt(e);if(!t.exists())return null;const n=t.data();return{image_url:n.image_url||null,sub_images:n.sub_images||[]}},subscribeToLibraryItems(s){const e=$e(ne,"specbook_items"),t=_t(e,Rs("is_library","==",1));return hn(t,r=>{const i=r.docs.map(o=>Di(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),s(i)})},subscribeToProjectItems(s,e){const t=$e(ne,"specbook_items"),n=_t(t,Rs("project_id","==",s));return hn(n,i=>{const o=i.docs.map(l=>Di(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})},async updateCategories(s){const e=Le(ne,"specbook_settings","categories");await ui(e,{categories:s,updatedAt:is()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(s){try{const e=$e(ne,"specbook_items"),t=await St(e);let n=0;t.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>n&&(n=m)});const r=n+1;let i=null;if(s.image&&s.image.startsWith("data:")){const u=s.image.split(",")[1],m=s.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),y=new Array(h.length);for(let T=0;T<h.length;T++)y[T]=h.charCodeAt(T);const C=new Uint8Array(y),v=new Blob([C],{type:d}),V=`specbook/${r}-${Date.now()}.${f}`,B=Pl(Il,V);await Ru(B,v),i=await Bu(B)}const o=new Date().toISOString(),l=Le(ne,"specbook_items",String(r));return await ui(l,{name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade||null,created_at:o,updated_at:o}),console.log(" [Firestore]    :",r),{id:r,name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade,created_at:o,updated_at:o}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(s,e){try{const t=Le(ne,"specbook_items",String(s)),n=await jt(t);if(!n.exists())throw new Error("   .");const r=n.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const u=e.image.split(",")[1],m=e.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),y=new Array(h.length);for(let T=0;T<h.length;T++)y[T]=h.charCodeAt(T);const C=new Uint8Array(y),v=new Blob([C],{type:d}),V=`specbook/${s}-${Date.now()}.${f}`,B=Pl(Il,V);await Ru(B,v),i=await Bu(B)}const l={updated_at:new Date().toISOString()};return e.name!==void 0&&(l.name=e.name),e.category!==void 0&&(l.category=e.category),e.brand!==void 0&&(l.brand=e.brand),e.price!==void 0&&(l.price=e.price),e.description!==void 0&&(l.description=e.description),i!==r.image_url&&(l.image_url=i),e.sub_images!==void 0&&(l.sub_images=e.sub_images),e.project_id!==void 0&&(l.project_id=e.project_id),e.is_library!==void 0&&(l.is_library=e.is_library),e.display_order!==void 0&&(l.display_order=e.display_order),e.grade!==void 0&&(l.grade=e.grade),await Mt(t,l),console.log(" [Firestore]    :",s),Di(String(s),{...r,...l,image_url:i})}catch(t){throw console.error("[Firestore]    :",t),new Error(`  : ${t.message||"   "}`)}},async deleteItem(s){try{const e=Le(ne,"specbook_items",String(s));await Fs(e),console.log(" [Firestore]    :",s)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(s,e){try{const t=Le(ne,"specbook_items",String(s));await Mt(t,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",s)}catch(t){throw console.error("[Firestore]    :",t),new Error(`   : ${t.message||"   "}`)}},async reorderItems(s){try{const e=VA(ne);s.forEach(t=>{const n=Le(ne,"specbook_items",String(t.id));e.update(n,{display_order:t.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},zE=10*60*1e3,KE=Wu((s,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<zE){console.log("[SpecbookStore]   , ");return}s({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const n=await Qc.getLibraryMeta();s({libraryItems:n,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",n.length," ")}catch(n){console.error("[SpecbookStore]   :",n),s({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const n=await Qc.getCategories();s({categories:n,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",n.length,"")}catch(n){console.error("[SpecbookStore]   :",n)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:n}=e();await Promise.all([t(),n()])},getLibraryItems:(t,n)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),n&&n.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return n.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:n}=e();return n.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const i=await Qc.getProjectMeta(t);return s(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{s(n=>{const r=new Map(n.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?s(n=>({libraryItems:[t,...n.libraryItems]})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?s(n=>({libraryItems:n.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,n,r)=>{n?s(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&s(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),zy=D.createContext(void 0);function QE({children:s}){const[e,t]=D.useState(null),[n,r]=D.useState(!0),i=zp(),o=KE(f=>f.preloadAll);D.useEffect(()=>{l()},[]);const l=async()=>{try{const f=localStorage.getItem("user");let h=null;if(f)try{h=JSON.parse(f)}catch{}if(h&&(t(h),o()),!localStorage.getItem("token")){r(!1);return}const C=await mp.getCurrentUser();C&&(t(C),localStorage.setItem("user",JSON.stringify(C)))}catch(f){console.error("Auth check error:",f)}finally{r(!1)}},u=async(f,h)=>{var y,C;try{const v=await mp.login({username:f,password:h}),V=v.token,B=v.user;localStorage.setItem("token",V),localStorage.setItem("user",JSON.stringify(B)),Zo.defaults.headers.common.Authorization=`Bearer ${V}`,t(B),o(),se.success(`${B.name}, !`);const T=sessionStorage.getItem("redirectAfterLogin");T?(sessionStorage.removeItem("redirectAfterLogin"),i(T)):i("/")}catch(v){const V=v;throw se.error(((C=(y=V.response)==null?void 0:y.data)==null?void 0:C.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete Zo.defaults.headers.common.Authorization,t(null),i("/login"),se.success("")},d=f=>{t(f)};return a.jsxDEV(zy.Provider,{value:{user:e,loading:n,login:u,logout:m,updateUser:d},children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:131,columnNumber:5},this)}function qr(){const s=D.useContext(zy);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const YE={};function GE(s,e){let t;try{t=s()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const ma=s=>e=>{try{const t=s(e);return t instanceof Promise?t:{then(n){return ma(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return ma(n)(t)}}}},XE=(s,e)=>(t,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:V=>V,version:0,merge:(V,B)=>({...B,...V}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return s((...V)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...V)},n,r);const d=ma(i.serialize),f=()=>{const V=i.partialize({...n()});let B;const T=d({state:V,version:i.version}).then(q=>m.setItem(i.name,q)).catch(q=>{B=q});if(B)throw B;return T},h=r.setState;r.setState=(V,B)=>{h(V,B),f()};const y=s((...V)=>{t(...V),f()},n,r);let C;const v=()=>{var V;if(!m)return;o=!1,l.forEach(T=>T(n()));const B=((V=i.onRehydrateStorage)==null?void 0:V.call(i,n()))||void 0;return ma(m.getItem.bind(m))(i.name).then(T=>{if(T)return i.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return i.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var q;return C=i.merge(T,(q=n())!=null?q:y),t(C,!0),f()}).then(()=>{B==null||B(C,void 0),o=!0,u.forEach(T=>T(C))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:V=>{i={...i,...V},V.getStorage&&(m=V.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:V=>(l.add(V),()=>{l.delete(V)}),onFinishHydration:V=>(u.add(V),()=>{u.delete(V)})},v(),C||y},JE=(s,e)=>(t,n,r)=>{let i={storage:GE(()=>localStorage),partialize:v=>v,version:0,merge:(v,V)=>({...V,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return s((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},n,r);const d=()=>{const v=i.partialize({...n()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,V)=>{f(v,V),d()};const h=s((...v)=>{t(...v),d()},n,r);r.getInitialState=()=>h;let y;const C=()=>{var v,V;if(!m)return;o=!1,l.forEach(T=>{var q;return T((q=n())!=null?q:h)});const B=((V=i.onRehydrateStorage)==null?void 0:V.call(i,(v=n())!=null?v:h))||void 0;return ma(m.getItem.bind(m))(i.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return[!0,i.migrate(T.state,T.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var q;const[oe,te]=T;if(y=i.merge(te,(q=n())!=null?q:h),t(y,!0),oe)return d()}).then(()=>{B==null||B(y,void 0),y=n(),o=!0,u.forEach(T=>T(y))}).catch(T=>{B==null||B(void 0,T)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||C(),y||h},ZE=(s,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((YE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),XE(s,e)):JE(s,e),Ky=ZE,Qy=Wu()(Ky((s,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const n={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};s(r=>({notifications:[n,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{s(n=>({notifications:n.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,n.unreadCount-1)}))},markAllAsRead:()=>{s(t=>({notifications:t.notifications.map(n=>({...n,read:!0})),unreadCount:0}))},deleteNotification:t=>{s(n=>{const r=n.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:n.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,n.unreadCount-1):n.unreadCount}})},clearAll:()=>{s({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:s=>({notifications:s.notifications,unreadCount:s.unreadCount})}));var eC={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},tC=function(e,t,n){var r,i=eC[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+" ":r+" ":r},sC={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},nC={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},rC={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},iC={date:Tc({formats:sC,defaultWidth:"full"}),time:Tc({formats:nC,defaultWidth:"full"}),dateTime:Tc({formats:rC,defaultWidth:"full"})},oC={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},aC=function(e,t,n,r){return oC[e]},lC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},cC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},uC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},mC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},dC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},fC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},pC=function(e,t){var n=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},hC={ordinalNumber:pC,era:No({values:lC,defaultWidth:"wide"}),quarter:No({values:cC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:No({values:uC,defaultWidth:"wide"}),day:No({values:mC,defaultWidth:"wide"}),dayPeriod:No({values:dC,defaultWidth:"wide",formattingValues:fC,defaultFormattingWidth:"wide"})},gC=/^(\d+)(|)?/i,yC=/\d+/i,bC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},NC={any:[/^(bc|)/i,/^(ad|)/i]},xC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},vC={any:[/1/i,/2/i,/3/i,/4/i]},_C={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},DC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},kC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},AC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},EC={any:/^(am|pm|||||||)/i},CC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},VC={ordinalNumber:UN({matchPattern:gC,parsePattern:yC,valueCallback:function(e){return parseInt(e,10)}}),era:xo({matchPatterns:bC,defaultMatchWidth:"wide",parsePatterns:NC,defaultParseWidth:"any"}),quarter:xo({matchPatterns:xC,defaultMatchWidth:"wide",parsePatterns:vC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:xo({matchPatterns:_C,defaultMatchWidth:"wide",parsePatterns:DC,defaultParseWidth:"any"}),day:xo({matchPatterns:kC,defaultMatchWidth:"wide",parsePatterns:AC,defaultParseWidth:"any"}),dayPeriod:xo({matchPatterns:EC,defaultMatchWidth:"any",parsePatterns:CC,defaultParseWidth:"any"})},xs={code:"ko",formatDistance:tC,formatLong:iC,formatRelative:aC,localize:hC,match:VC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const wC=({isOpen:s,onClose:e})=>{const t=zp(),{notifications:n,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=Qy();if(!s)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(CN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(EN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Yp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(AN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Sc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Sc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),n.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(Qp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(ai,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Sc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:n.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:HN(new Date(h.createdAt),{addSuffix:!0,locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},ki="work_requests",Do=s=>{const e=s.data();return{_id:s.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof ve?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof ve?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof ve?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof ve?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof ve?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ai={getAllWorkRequests:async()=>{const s=_t($e(ne,ki),as("createdAt","desc"));return(await St(s)).docs.map(Do)},getWorkRequestById:async s=>{const e=Le(ne,ki,s),t=await jt(e);return t.exists()?Do(t):null},createWorkRequest:async s=>{const e=ve.now(),t={project:s.project,requestType:s.requestType,description:s.description,requestDate:s.requestDate instanceof Date?ve.fromDate(s.requestDate):s.requestDate,dueDate:s.dueDate instanceof Date?ve.fromDate(s.dueDate):s.dueDate,requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status||"pending",priority:s.priority||"medium",notes:s.notes||"",createdAt:e,updatedAt:e},n=await Qn($e(ne,ki),t),r=await jt(n);return Do(r)},updateWorkRequest:async(s,e)=>{const t=Le(ne,ki,s),n={updatedAt:ve.now()};e.project!==void 0&&(n.project=e.project),e.requestType!==void 0&&(n.requestType=e.requestType),e.description!==void 0&&(n.description=e.description),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?ve.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(n.dueDate=e.dueDate instanceof Date?ve.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(n.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.status!==void 0&&(n.status=e.status),e.priority!==void 0&&(n.priority=e.priority),e.notes!==void 0&&(n.notes=e.notes),e.completedDate!==void 0&&(n.completedDate=e.completedDate instanceof Date?ve.fromDate(e.completedDate):e.completedDate),await Mt(t,n);const r=await jt(t);return Do(r)},deleteWorkRequest:async s=>{const e=Le(ne,ki,s);await Fs(e)},subscribeToWorkRequests:s=>{const e=_t($e(ne,ki),as("createdAt","desc"));return hn(e,t=>{const n=t.docs.map(Do);s(n)})}},SC={getAllWorkRequests:()=>Ai.getAllWorkRequests(),getWorkRequestById:async s=>{const e=await Ai.getWorkRequestById(s);if(!e)throw new Error("Work request not found");return e},createWorkRequest:s=>Ai.createWorkRequest(s),updateWorkRequest:(s,e)=>Ai.updateWorkRequest(s,e),deleteWorkRequest:s=>Ai.deleteWorkRequest(s),subscribeToWorkRequests:Ai.subscribeToWorkRequests},Ht={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function b2(s,e){const t=$e(ne,s);return(await Qn(t,{...e,createdAt:ve.now(),updatedAt:ve.now()})).id}function to(s){return!s||typeof s!="string"||s.startsWith("http://")||s.startsWith("https://")?!1:!!(s.startsWith("data:image")||s.length>1e3)}function TC(s){if(s.startsWith("data:")){const e=s.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function LC(s){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[s]||"jpg"}function PC(s){let e=s,t="image/jpeg";if(s.includes(",")){const o=s.split(",");e=o[1];const l=o[0].match(/data:([^;]+);/);l&&(t=l[1])}const n=atob(e),r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);const i=new Uint8Array(r);return new Blob([i],{type:t})}async function Yy(s,e,t,n){if(!to(t))return t;const r=TC(t),i=LC(r),o=n!==void 0?`image_${n}.${i}`:`main.${i}`,l=`${s}/${e}/${o}`,u=Pl(Il,l),m=PC(t);return await Ru(u,m,{contentType:r}),await Bu(u)}async function jl(s,e,t){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=await Yy(s,e,i,r);n.push(o)}return n}async function Gy(s){if(s.includes("firebasestorage.googleapis.com"))try{const e=s.match(/\/o\/(.+)\?/);if(e){const t=decodeURIComponent(e[1]),n=Pl(Il,t);await BE(n)}}catch(e){console.warn("  :",e)}}async function Xy(s){await Promise.all(s.map(e=>Gy(e)))}let Tr=new Map,Fi=null;async function er(){if(!(Tr.size>0))return Fi||(Fi=(async()=>{try{const s=$e(ne,Ht.PROJECTS);(await St(s)).docs.forEach(t=>{const n=t.data();Tr.set(t.id,{name:n.name||"",color:n.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",Tr.size,"")}catch(s){throw console.error("[paymentFirestoreService]    :",s),Fi=null,s}})(),Fi)}function ko(s){const e=Tr.get(String(s.projectId))||{name:"",color:"#4A90E2"};return!e.name&&s.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:s.id,projectId:s.projectId,cacheSize:Tr.size,cacheKeys:Array.from(Tr.keys()).slice(0,5),vendorName:s.vendorName}),{id:s.id,project_id:s.projectId,project_name:e.name,project_color:e.color,user_id:s.userId||0,requester_name:s.requestedBy||"",approved_by:s.approvedBy||void 0,request_type:s.requestType||"material",vendor_name:s.vendorName||"",description:s.description||"",amount:s.amount||0,account_holder:s.accountHolder||"",bank_name:s.bankName||"",account_number:s.accountNumber||"",item_name:s.itemName||"",material_amount:s.materialAmount||0,labor_amount:s.laborAmount||0,original_material_amount:s.originalMaterialAmount||0,original_labor_amount:s.originalLaborAmount||0,apply_tax_deduction:s.applyTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,quick_text:s.quickText||"",images:s.images?JSON.stringify(s.images):"[]",notes:s.notes||"",status:s.status||"pending",created_at:s.createdAt||"",updated_at:s.updatedAt||"",paid_at:s.paidAt||void 0}}function dp(s){const e={};if(s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.request_type!==void 0&&(e.requestType=s.request_type),s.category!==void 0&&(e.requestType=s.category),s.vendor_name!==void 0&&(e.vendorName=s.vendor_name),s.process!==void 0&&(e.vendorName=s.process),s.description!==void 0&&(e.description=s.description),s.purpose!==void 0&&(e.description=s.purpose),s.amount!==void 0&&(e.amount=s.amount),s.account_holder!==void 0&&(e.accountHolder=s.account_holder),s.bank_name!==void 0&&(e.bankName=s.bank_name),s.account_number!==void 0&&(e.accountNumber=s.account_number),s.bankInfo!==void 0&&typeof s.bankInfo=="object"&&s.bankInfo!==null){const t=s.bankInfo;t.accountHolder&&(e.accountHolder=t.accountHolder),t.bankName&&(e.bankName=t.bankName),t.accountNumber&&(e.accountNumber=t.accountNumber)}return s.notes!==void 0&&(e.notes=s.notes),s.itemName!==void 0&&(e.itemName=s.itemName),s.item_name!==void 0&&(e.itemName=s.item_name),s.materialAmount!==void 0&&(e.materialAmount=s.materialAmount),s.laborAmount!==void 0&&(e.laborAmount=s.laborAmount),s.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=s.originalMaterialAmount),s.originalLaborAmount!==void 0&&(e.originalLaborAmount=s.originalLaborAmount),s.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=s.applyTaxDeduction),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),s.quickText!==void 0&&(e.quickText=s.quickText),s.images!==void 0&&(e.images=Array.isArray(s.images)?s.images:[]),s.status!==void 0&&(e.status=s.status),s.requestedBy!==void 0&&(e.requestedBy=s.requestedBy),e}const rn={getAllPayments:async()=>{await er();const s=$e(ne,Ht.PAYMENTS),e=_t(s,as("id","desc"));return(await St(e)).docs.map(n=>{const r=n.data();return ko({...r,id:parseInt(n.id)||r.id})})},getPaymentById:async s=>{await er();const e=Le(ne,Ht.PAYMENTS,s),t=await jt(e);if(t.exists()){const n=t.data();return ko({...n,id:parseInt(t.id)||n.id})}return null},createPayment:async s=>{await er();const e=$e(ne,Ht.PAYMENTS),t=await St(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=n+1,i=dp(s),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestedBy:i.requestedBy||"",requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},u=Le(ne,Ht.PAYMENTS,String(r));if(await ui(u,l),i.images&&i.images.length>0)if(i.images.some(d=>to(d))){const d=await jl("payments",String(r),i.images);await Mt(u,{images:d,imageCount:d.length}),l.images=d,l.imageCount=d.length}else await Mt(u,{images:i.images,imageCount:i.images.length}),l.images=i.images,l.imageCount=i.images.length;return ko(l)},updatePayment:async(s,e)=>{await er();const t=Le(ne,Ht.PAYMENTS,s),n=dp(e);await Mt(t,{...n,updatedAt:new Date().toISOString()});const r=await rn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(s,e)=>{console.log("[Firestore]   :",s,"->",e),await er();const t=Le(ne,Ht.PAYMENTS,s),n=new Date().toISOString(),r={status:e,updatedAt:n};e==="completed"&&(r.paidAt=n),await Mt(t,r),console.log("[Firestore]   :",s,"->",e);const i=await rn.getPaymentById(s);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(s,e,t)=>{await er();const n=Le(ne,Ht.PAYMENTS,s);await Mt(n,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await rn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(s,e)=>{const t=Le(ne,Ht.PAYMENTS,s);let n=e;return e.length>0&&e.some(i=>to(i))&&(n=await jl("payments",s,e)),await Mt(t,{images:n,imageCount:n.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:n}},deletePayment:async s=>{const e=Le(ne,Ht.PAYMENTS,s),t=await jt(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Xy(n.images)}await Fs(e)},subscribeToPayments:s=>{console.log("[paymentFirestoreService] subscribeToPayments ");let e=null,t=!0;const n=async()=>{try{er().catch(o=>{console.warn("[paymentFirestoreService]    :",o)});const r=$e(ne,Ht.PAYMENTS),i=_t(r,as("id","desc"));console.log("[paymentFirestoreService] Firestore onSnapshot  ..."),e=hn(i,{includeMetadataChanges:!1},async o=>{if(!t){console.log("[ ]   - ");return}if(console.log("[ ]  :",o.docs.length,", fromCache:",o.metadata.fromCache,"hasPendingWrites:",o.metadata.hasPendingWrites),o.docChanges().forEach(u=>{const m=u.doc.data();console.log(`[ ] : ${u.type} - ID: ${u.doc.id}, status: ${m.status}`)}),Tr.size===0)try{await er()}catch{console.warn("[ ]     -  ")}const l=o.docs.map(u=>{const m=u.data();return ko({...m,id:parseInt(u.id)||m.id})});s(l)},o=>{console.error("[ ]  :",o),t&&(console.log("[ ] 5   ..."),setTimeout(()=>{t&&n()},5e3))})}catch(r){console.error("[paymentFirestoreService]   :",r),t&&setTimeout(()=>{t&&n()},3e3)}};return n(),()=>{console.log("[paymentFirestoreService]   "),t=!1,e&&(e(),e=null)}},getPaymentsByProject:async s=>{await er();const e=$e(ne,Ht.PAYMENTS),t=_t(e,Rs("projectId","==",s),as("id","desc"));return(await St(t)).docs.map(r=>{const i=r.data();return ko({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{Tr.clear(),Fi=null}},mn={getAllPayments:()=>rn.getAllPayments(),getPaymentById:async s=>{const e=await rn.getPaymentById(s);if(!e)throw new Error("Payment not found");return e},createPayment:s=>rn.createPayment(s),updatePayment:(s,e)=>rn.updatePayment(s,e),updatePaymentStatus:(s,e)=>rn.updatePaymentStatus(s,e),updatePaymentAmounts:(s,e,t)=>rn.updatePaymentAmounts(s,e,t),updatePaymentImages:(s,e)=>rn.updatePaymentImages(s,e),deletePayment:s=>rn.deletePayment(s),sendTossPaymentSms:async s=>(await Zo.post("/payments/send-toss-payment-sms",s)).data,subscribeToPayments:rn.subscribeToPayments,getPaymentsByProject:rn.getPaymentsByProject,clearProjectsCache:rn.clearProjectsCache},Ei="as_requests",Ao=s=>{const e=s.data();return{_id:s.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof ve?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof ve?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof ve?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof ve?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof ve?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ci={getAllASRequests:async()=>{const s=_t($e(ne,Ei),as("createdAt","desc"));return(await St(s)).docs.map(Ao)},getASRequestById:async s=>{const e=Le(ne,Ei,s),t=await jt(e);return t.exists()?Ao(t):null},createASRequest:async s=>{const e=ve.now(),t={project:s.project,client:s.client,requestDate:s.requestDate instanceof Date?ve.fromDate(s.requestDate):s.requestDate,siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,status:s.status||"pending",notes:s.notes||"",createdAt:e,updatedAt:e};s.scheduledVisitDate&&(t.scheduledVisitDate=s.scheduledVisitDate instanceof Date?ve.fromDate(s.scheduledVisitDate):s.scheduledVisitDate),s.scheduledVisitTime&&(t.scheduledVisitTime=s.scheduledVisitTime),s.assignedTo&&(t.assignedTo=s.assignedTo);const n=await Qn($e(ne,Ei),t),r=await jt(n);return Ao(r)},updateASRequest:async(s,e)=>{const t=Le(ne,Ei,s),n={updatedAt:ve.now()};e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?ve.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(n.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(n.entrancePassword=e.entrancePassword),e.description!==void 0&&(n.description=e.description),e.scheduledVisitDate!==void 0&&(n.scheduledVisitDate=e.scheduledVisitDate instanceof Date?ve.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(n.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.completionDate!==void 0&&(n.completionDate=e.completionDate instanceof Date?ve.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(n.notes=e.notes),e.status!==void 0&&(n.status=e.status),await Mt(t,n);const r=await jt(t);return Ao(r)},deleteASRequest:async s=>{const e=Le(ne,Ei,s);await Fs(e)},subscribeToASRequests:s=>{const e=_t($e(ne,Ei),as("createdAt","desc"));return hn(e,t=>{const n=t.docs.map(Ao);s(n)})}},Oo={getAllASRequests:()=>Ci.getAllASRequests(),getASRequestById:async s=>{const e=await Ci.getASRequestById(s);if(!e)throw new Error("AS Request not found");return e},createASRequest:s=>Ci.createASRequest(s),updateASRequest:(s,e)=>Ci.updateASRequest(s,e),deleteASRequest:s=>Ci.deleteASRequest(s),subscribeToASRequests:Ci.subscribeToASRequests};function Eo(s){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:s.id,id:parseInt(s.id)||0,name:s.name,client:{name:s.client||"",phone:"",address:s.address||""},location:{address:s.address||""},startDate:s.startDate||"",endDate:s.endDate||"",status:e[s.status]||"planning",budget:0,actualCost:0,manager:{_id:String(s.managerId||""),name:s.managerName||s.manager||"",username:s.managerUsername||""},fieldManagers:[],workers:[],colorCode:s.color||"#4A90E2",progress:0,description:s.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:s.createdAt||"",updatedAt:s.updatedAt||"",meetingNotes:s.meetingNotes||[],customerRequests:s.customerRequests||[],entrancePassword:s.entrancePassword||"",sitePassword:s.sitePassword||""}}function fp(s){var t,n,r,i,o,l,u,m;const e={};if(s.name!==void 0&&(e.name=s.name),s.client!==void 0&&(e.client=typeof s.client=="string"?s.client:((t=s.client)==null?void 0:t.name)||""),s.location!==void 0&&(e.address=typeof s.location=="string"?s.location:((n=s.location)==null?void 0:n.address)||""),s.address!==void 0&&(e.address=s.address),s.startDate!==void 0&&(e.startDate=typeof s.startDate=="string"?s.startDate:((o=(i=(r=s.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),s.endDate!==void 0&&(e.endDate=typeof s.endDate=="string"?s.endDate:((m=(u=(l=s.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),s.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[s.status]||"planning"}return s.description!==void 0&&(e.description=s.description),s.manager!==void 0&&(e.manager=s.manager),s.meetingNotes!==void 0&&(e.meetingNotes=s.meetingNotes),s.customerRequests!==void 0&&(e.customerRequests=s.customerRequests),s.entrancePassword!==void 0&&(e.entrancePassword=s.entrancePassword),s.sitePassword!==void 0&&(e.sitePassword=s.sitePassword),s.color!==void 0&&(e.color=s.color),s.colorCode!==void 0&&(e.color=s.colorCode),e}const Nr={getAllProjects:async()=>{const s=$e(ne,Ht.PROJECTS);return(await St(s)).docs.map(n=>{const r=n.data();return Eo({...r,id:n.id})}).sort((n,r)=>(r.id||0)-(n.id||0))},getProjectById:async s=>{const e=Le(ne,Ht.PROJECTS,s),t=await jt(e);if(t.exists()){const n=t.data();return Eo({...n,id:t.id})}return null},createProject:async s=>{const e=$e(ne,Ht.PROJECTS),t=await St(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=String(n+1),i=fp(s),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Le(ne,Ht.PROJECTS,r);return await ui(u,l),Eo(l)},updateProject:async(s,e)=>{const t=Le(ne,Ht.PROJECTS,s),n=fp(e);await Mt(t,{...n,updatedAt:new Date().toISOString()});const r=await Nr.getProjectById(s);if(!r)throw new Error("Project not found after update");return r},deleteProject:async s=>{const e=Le(ne,Ht.PROJECTS,s);await Fs(e)},subscribeToProjects:s=>{const e=$e(ne,Ht.PROJECTS);return hn(e,t=>{const n=t.docs.map(r=>{const i=r.data();return Eo({...i,id:r.id})});n.sort((r,i)=>(i.id||0)-(r.id||0)),s(n)})},subscribeToProject:(s,e)=>{const t=Le(ne,Ht.PROJECTS,s);return hn(t,n=>{if(n.exists()){const r=n.data();e(Eo({...r,id:n.id}))}else e(null)})}},$i={getAllProjects:()=>Nr.getAllProjects(),getProjectById:async s=>{const e=await Nr.getProjectById(s);if(!e)throw new Error("Project not found");return e},createProject:s=>Nr.createProject(s),updateProject:(s,e)=>Nr.updateProject(s,e),deleteProject:s=>Nr.deleteProject(s),subscribeToProjects:Nr.subscribeToProjects,subscribeToProject:Nr.subscribeToProject},Yc=s=>s?typeof s=="string"?s:s instanceof ve?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Wa={async getAllQuoteInquiries(){const s=$e(ne,"quote_inquiries"),e=_t(s,as("createdAt","desc"));return(await St(e)).docs.map(n=>{const r=n.data();return{id:n.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Yc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(s){const e=Le(ne,"quote_inquiries",s),t=await jt(e);if(!t.exists())return null;const n=t.data();return{id:t.id,name:n.name||"",phone:n.phone||"",email:n.email||"",address:n.address,projectType:n.projectType,budget:n.budget,message:n.message||"",createdAt:Yc(n.createdAt),isRead:n.isRead||!1}},async createQuoteInquiry(s){const e=$e(ne,"quote_inquiries"),t={...s,isRead:!1,createdAt:is()};return{id:(await Qn(e,t)).id,...s,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(s){const e=Le(ne,"quote_inquiries",s);await Mt(e,{isRead:!0,updatedAt:is()})},async deleteQuoteInquiry(s){const e=Le(ne,"quote_inquiries",s);await Fs(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(s){const e=$e(ne,"quote_inquiries"),t=_t(e,as("createdAt","desc"));return hn(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:Yc(l.createdAt),isRead:l.isRead||!1}});s(i)})}},pl={getAllQuoteInquiries:()=>Wa.getAllQuoteInquiries(),markAsRead:s=>Wa.markAsRead(s),deleteQuoteInquiry:s=>Wa.deleteQuoteInquiry(s),subscribeToQuoteInquiries:Wa.subscribeToQuoteInquiries},IC=()=>typeof window<"u"?window.location.origin:"",jC=IC();class RC{constructor(){wd(this,"socket",null)}connect(e){return this.socket=Fo(jC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var n;(n=this.socket)==null||n.on(e,t)}emit(e,t){var n;(n=this.socket)==null||n.emit(e,t)}off(e,t){var n;(n=this.socket)==null||n.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Rl=new RC,BC=()=>{var ae,Me;const{user:s,logout:e,loading:t}=qr(),[n,r]=D.useState(!1),[i,o]=D.useState(!1),[l,u]=D.useState(!1),m=bN(),{unreadCount:d}=Qy(),[f,h]=D.useState(0),[y,C]=D.useState(0),[v,V]=D.useState(0),[B,T]=D.useState(0),[q,oe]=D.useState(!1),[te,O]=D.useState(0),[E,x]=D.useState(!1),A=D.useRef(0),P=D.useRef(null),S=80,w=D.useCallback(de=>{if(window.scrollY>0)return!1;let Ie=de;for(;Ie&&Ie!==document.body;){const xt=window.getComputedStyle(Ie).overflowY;if((xt==="auto"||xt==="scroll")&&Ie.scrollTop>0)return!1;Ie=Ie.parentElement}return!0},[]),k=D.useCallback(de=>{if(window.innerWidth>=768)return;const Ie=de.target;w(Ie)&&(A.current=de.touches[0].clientY,oe(!0))},[w]),Ae=D.useCallback(de=>{if(!q||E)return;const Ie=de.target;if(!w(Ie)){oe(!1),O(0);return}const xt=de.touches[0].clientY-A.current;if(xt>0){const it=Math.min(xt*.5,120);O(it)}else oe(!1),O(0)},[q,E,w]),He=D.useCallback(()=>{q&&(te>=S&&!E?(x(!0),O(50),setTimeout(()=>{window.location.reload()},300)):O(0),oe(!1))},[q,te,E]);if(D.useEffect(()=>{u(!1)},[m.pathname]),D.useEffect(()=>{const de=Ie=>{u(Ie.detail.isOpen)};return window.addEventListener("mobileFormStateChange",de),()=>window.removeEventListener("mobileFormStateChange",de)},[]),D.useEffect(()=>{const de=()=>{T(Ie=>Math.max(0,Ie-1))};return window.addEventListener("quoteInquiryRead",de),()=>window.removeEventListener("quoteInquiryRead",de)},[]),D.useEffect(()=>{const de=()=>{C(Ie=>Math.max(0,Ie-1))};return window.addEventListener("paymentCompleted",de),()=>window.removeEventListener("paymentCompleted",de)},[]),D.useEffect(()=>{const de=Rl.getSocket();if(!de||!s)return;const Ie=async()=>{try{const[ze,xt]=await Promise.all([mn.getAllPayments(),$i.getAllProjects()]);let it=ze;if(s.name===""){const Tt=xt.map(nt=>nt.name);it=ze.filter(nt=>Tt.includes(nt.project))}C(it.filter(Tt=>Tt.status==="pending").length)}catch(ze){console.error("Failed to refresh payment count:",ze)}};return de.on("payment:refresh",Ie),()=>{de.off("payment:refresh",Ie)}},[s]),D.useEffect(()=>{if(!s)return;const de=async()=>{try{const[ze,xt,it,Tt]=await Promise.all([SC.getAllWorkRequests(),mn.getAllPayments(),Oo.getAllASRequests(),$i.getAllProjects()]);h(ze.filter(ft=>ft.assignedTo===s.name&&ft.status==="pending").length);let nt=xt;if(s.name===""){const ft=Tt.map(us=>us.name);nt=xt.filter(us=>ft.includes(us.project))}if(C(nt.filter(ft=>ft.status==="pending").length),V(it.filter(ft=>ft.status==="in-progress").length),s.role==="admin"||s.role==="manager")try{const us=(await pl.getAllQuoteInquiries()).filter(K=>!K.isRead).length;T(us)}catch(ft){console.error("Failed to load quote inquiry count:",ft)}}catch(ze){console.error("Failed to load badge counts:",ze)}};de();const Ie=setInterval(de,3e4);return()=>clearInterval(Ie)},[s]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!s){const de=window.location.pathname+window.location.search;return de&&de!=="/login"&&de!=="/"&&sessionStorage.setItem("redirectAfterLogin",de),a.jsxDEV(Kp,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const ye=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...B>0&&{badge:B}},{name:"",href:"/contractors"}],Be=ye.filter(de=>!de.roles||de.roles.includes((s==null?void 0:s.role)||"")),gt=((ae=ye.find(de=>de.href===m.pathname))==null?void 0:ae.name)||"",Ft=(()=>{const de=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(de)?()=>{const ze=new CustomEvent("headerAddButtonClick");window.dispatchEvent(ze)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Cn("fixed inset-0 z-40 lg:hidden",n?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Be.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Cn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Be.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Cn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),gt&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:gt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ft&&a.jsxDEV("button",{onClick:Ft,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(vs,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV(Wi,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:s==null?void 0:s.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:s==null?void 0:s.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Me=s==null?void 0:s.name)==null?void 0:Me.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Be.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Cn("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Ie?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:P,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:Ae,onTouchEnd:He,children:[te>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:te,transition:q?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Cn("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",E&&"animate-spin"),style:{transform:`rotate(${E?0:te*2}deg)`,opacity:Math.min(te/S,1)},children:a.jsxDEV(VN,{className:Cn("w-5 h-5",te>=S?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:te>0?`translateY(${te}px)`:"none",transition:q?"none":"transform 0.2s ease-out"},children:a.jsxDEV(NN,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(wC,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},UC=s=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,n=s==="emergency"?5:3;let r=0;const i=()=>{if(r>=n)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=s==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<n&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},HC=s=>{if("vibrate"in navigator){const e=s==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},MC=(s,e)=>{UC(s),HC(s),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},OC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Vi="schedules",Co=s=>{const e=s.data();return{_id:s.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof ve?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof ve?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof ve?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof ve?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof ve?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},wi={getAllSchedules:async()=>{const s=_t($e(ne,Vi),as("startDate","desc"));return(await St(s)).docs.map(Co)},getScheduleById:async s=>{const e=Le(ne,Vi,s),t=await jt(e);return t.exists()?Co(t):null},createSchedule:async s=>{const e=ve.now(),t={project:typeof s.project=="string"?{_id:s.project,name:s.project}:s.project,title:s.title,type:s.type||"other",phase:s.phase||"",startDate:s.startDate instanceof Date?ve.fromDate(s.startDate):s.startDate,endDate:s.endDate instanceof Date?ve.fromDate(s.endDate):s.endDate,allDay:s.allDay??!0,assignedTo:s.assignedTo||[],description:s.description||"",location:s.location||"",priority:s.priority||"medium",progress:s.progress??0,isCompleted:s.isCompleted??!1,time:s.time||"",asRequestId:s.asRequestId||null,createdAt:e,updatedAt:e},n=await Qn($e(ne,Vi),t),r=await jt(n);return Co(r)},updateSchedule:async(s,e)=>{const t=Le(ne,Vi,s),n={updatedAt:ve.now()};e.project!==void 0&&(n.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(n.title=e.title),e.type!==void 0&&(n.type=e.type),e.phase!==void 0&&(n.phase=e.phase),e.startDate!==void 0&&(n.startDate=e.startDate instanceof Date?ve.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(n.endDate=e.endDate instanceof Date?ve.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(n.allDay=e.allDay),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.description!==void 0&&(n.description=e.description),e.location!==void 0&&(n.location=e.location),e.priority!==void 0&&(n.priority=e.priority),e.progress!==void 0&&(n.progress=e.progress),e.isCompleted!==void 0&&(n.isCompleted=e.isCompleted,e.isCompleted&&(n.completedAt=ve.now())),e.time!==void 0&&(n.time=e.time),await Mt(t,n);const r=await jt(t);return Co(r)},deleteSchedule:async s=>{const e=Le(ne,Vi,s);await Fs(e)},subscribeToSchedules:s=>{const e=_t($e(ne,Vi),as("startDate","desc"));return hn(e,t=>{const n=t.docs.map(Co);s(n)})}},za={getAllSchedules:()=>wi.getAllSchedules(),getScheduleById:async s=>{const e=await wi.getScheduleById(s);if(!e)throw new Error("Schedule not found");return e},createSchedule:s=>wi.createSchedule(s),updateSchedule:(s,e)=>wi.updateSchedule(s,e),deleteSchedule:s=>wi.deleteSchedule(s),subscribeToSchedules:wi.subscribeToSchedules},Si="contractors",Vo=s=>{const e=s.data();return{_id:s.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof ve?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof ve?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ti={getAllContractors:async()=>{const s=_t($e(ne,Si),as("name","asc"));return(await St(s)).docs.map(Vo)},getContractorById:async s=>{const e=Le(ne,Si,s),t=await jt(e);return t.exists()?Vo(t):null},createContractor:async s=>{const e=ve.now(),t={rank:s.rank||"",companyName:s.companyName||"",name:s.name,position:s.position||"",process:s.process,contact:s.contact||"",accountNumber:s.accountNumber,notes:s.notes||"",createdAt:e,updatedAt:e},n=await Qn($e(ne,Si),t),r=await jt(n);return Vo(r)},updateContractor:async(s,e)=>{const t=Le(ne,Si,s),n={updatedAt:ve.now()};e.rank!==void 0&&(n.rank=e.rank),e.companyName!==void 0&&(n.companyName=e.companyName),e.name!==void 0&&(n.name=e.name),e.position!==void 0&&(n.position=e.position),e.process!==void 0&&(n.process=e.process),e.contact!==void 0&&(n.contact=e.contact),e.accountNumber!==void 0&&(n.accountNumber=e.accountNumber),e.notes!==void 0&&(n.notes=e.notes),await Mt(t,n);const r=await jt(t);return Vo(r)},deleteContractor:async s=>{const e=Le(ne,Si,s);await Fs(e)},subscribeToContractors:s=>{const e=_t($e(ne,Si),as("name","asc"));return hn(e,t=>{const n=t.docs.map(Vo);s(n)})}},rr={getAllContractors:()=>Ti.getAllContractors(),getContractorById:async s=>{const e=await Ti.getContractorById(s);if(!e)throw new Error("Contractor not found");return e},createContractor:s=>Ti.createContractor(s),updateContractor:(s,e)=>Ti.updateContractor(s,e),deleteContractor:s=>Ti.deleteContractor(s),subscribeToContractors:Ti.subscribeToContractors},Li="construction_payments",wo=s=>{const e=s.data();let t=e.payments||[];if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}Array.isArray(t)||(t=[]);const n=t.map(i=>{let o=i.types||[];if(typeof o=="string")try{o=JSON.parse(o)}catch{o=[o]}return Array.isArray(o)||(o=[]),{types:o,type:o[0]||i.type||"",amount:i.amount||0,date:i.date instanceof ve?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof ve?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof ve?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof ve?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof ve?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:s.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:n,expectedPaymentDates:r,createdAt:e.createdAt instanceof ve?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof ve?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Pi={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const s=await St($e(ne,Li));console.log("[ConstructionPayment] Firestore :",s.size," ");const e=s.docs.map(wo).filter(t=>t.project&&t.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(s){return console.error("[ConstructionPayment] Firestore  :",s),[]}},getConstructionPaymentById:async s=>{const e=Le(ne,Li,s),t=await jt(e);return t.exists()?wo(t):null},createConstructionPayment:async s=>{const e=ve.now(),t=(s.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?ve.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),n={};s.expectedPaymentDates&&(s.expectedPaymentDates.contract&&(n.contract=s.expectedPaymentDates.contract instanceof Date?ve.fromDate(s.expectedPaymentDates.contract):s.expectedPaymentDates.contract),s.expectedPaymentDates.start&&(n.start=s.expectedPaymentDates.start instanceof Date?ve.fromDate(s.expectedPaymentDates.start):s.expectedPaymentDates.start),s.expectedPaymentDates.middle&&(n.middle=s.expectedPaymentDates.middle instanceof Date?ve.fromDate(s.expectedPaymentDates.middle):s.expectedPaymentDates.middle),s.expectedPaymentDates.final&&(n.final=s.expectedPaymentDates.final instanceof Date?ve.fromDate(s.expectedPaymentDates.final):s.expectedPaymentDates.final));const r={project:s.project,client:s.client,totalAmount:s.totalAmount,vatType:s.vatType,vatPercentage:s.vatPercentage,vatAmount:s.vatAmount,payments:t,expectedPaymentDates:n,createdAt:e,updatedAt:e},i=await Qn($e(ne,Li),r),o=await jt(i);return wo(o)},updateConstructionPayment:async(s,e)=>{const t=Le(ne,Li,s),n={updatedAt:ve.now()};if(e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.totalAmount!==void 0&&(n.totalAmount=e.totalAmount),e.vatType!==void 0&&(n.vatType=e.vatType),e.vatPercentage!==void 0&&(n.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(n.vatAmount=e.vatAmount),e.payments!==void 0&&(n.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?ve.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?ve.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?ve.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?ve.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?ve.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),n.expectedPaymentDates=i}await Mt(t,n);const r=await jt(t);return wo(r)},deleteConstructionPayment:async s=>{const e=Le(ne,Li,s);await Fs(e)},subscribeToConstructionPayments:s=>{const e=_t($e(ne,Li),as("createdAt","desc"));return hn(e,t=>{const n=t.docs.map(wo);s(n)})}},Ka={getAllConstructionPayments:()=>Pi.getAllConstructionPayments(),getConstructionPaymentById:async s=>{const e=await Pi.getConstructionPaymentById(s);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:s=>Pi.createConstructionPayment(s),updateConstructionPayment:(s,e)=>Pi.updateConstructionPayment(s,e),deleteConstructionPayment:s=>Pi.deleteConstructionPayment(s),subscribeToConstructionPayments:Pi.subscribeToConstructionPayments};let hl=new Map,So=null;async function FC(){if(!(hl.size>0))return So||(So=(async()=>{try{const s=$e(ne,Ht.PROJECTS);(await St(s)).docs.forEach(t=>{const n=t.data(),r=parseInt(t.id);!isNaN(r)&&n.name&&hl.set(n.name,r)}),console.log("[executionRecordFirestoreService]    :",hl.size,"")}catch(s){throw console.error("[executionRecordFirestoreService]    :",s),So=null,s}})(),So)}function Ii(s){return{id:s.id,project_id:s.projectId,project_name:s.projectName||"",author:s.author||"",date:s.date||"",process:s.process||"",item_name:s.itemName||"",material_cost:s.materialCost||0,labor_cost:s.laborCost||0,vat_amount:s.vatAmount||0,total_amount:s.totalAmount||0,notes:s.notes||"",images:s.images||[],payment_id:s.paymentId,includes_tax_deduction:s.includesTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,created_at:s.createdAt||"",updated_at:s.updatedAt||""}}function pp(s){const e={};return s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.project_name!==void 0&&(e.projectName=s.project_name),s.projectName!==void 0&&(e.projectName=s.projectName),s.author!==void 0&&(e.author=s.author),s.date!==void 0&&(e.date=s.date),s.process!==void 0&&(e.process=s.process),s.item_name!==void 0&&(e.itemName=s.item_name),s.itemName!==void 0&&(e.itemName=s.itemName),s.material_cost!==void 0&&(e.materialCost=s.material_cost),s.materialCost!==void 0&&(e.materialCost=s.materialCost),s.labor_cost!==void 0&&(e.laborCost=s.labor_cost),s.laborCost!==void 0&&(e.laborCost=s.laborCost),s.vat_amount!==void 0&&(e.vatAmount=s.vat_amount),s.vatAmount!==void 0&&(e.vatAmount=s.vatAmount),s.total_amount!==void 0&&(e.totalAmount=s.total_amount),s.totalAmount!==void 0&&(e.totalAmount=s.totalAmount),s.notes!==void 0&&(e.notes=s.notes),s.images!==void 0&&(e.images=s.images),s.payment_id!==void 0&&(e.paymentId=s.payment_id),s.paymentId!==void 0&&(e.paymentId=s.paymentId),s.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=s.includes_tax_deduction===!0||s.includes_tax_deduction===1),s.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=s.includesTaxDeduction),s.includes_vat!==void 0&&(e.includesVAT=s.includes_vat===!0||s.includes_vat===1),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),e}const nr={getAllRecords:async()=>{const s=$e(ne,Ht.EXECUTION_RECORDS),e=_t(s,as("id","desc"));return(await St(e)).docs.map(n=>{const r=n.data();return Ii({...r,id:parseInt(n.id)||r.id})})},getRecordById:async s=>{const e=Le(ne,Ht.EXECUTION_RECORDS,s),t=await jt(e);if(t.exists()){const n=t.data();return Ii({...n,id:parseInt(t.id)||n.id})}return null},createRecord:async s=>{await FC();const e=$e(ne,Ht.EXECUTION_RECORDS),t=await St(e);let n=0;t.docs.forEach(f=>{const h=parseInt(f.id);!isNaN(h)&&h>n&&(n=h)});const r=n+1,i=pp(s),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const f=hl.get(u);f?(l=f,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:[],imageCount:0},d=Le(ne,Ht.EXECUTION_RECORDS,String(r));if(await ui(d,m),i.images&&i.images.length>0)if(i.images.some(h=>to(h))){const h=await jl("execution_records",String(r),i.images);await Mt(d,{images:h,imageCount:h.length}),m.images=h,m.imageCount=h.length}else await Mt(d,{images:i.images,imageCount:i.images.length}),m.images=i.images,m.imageCount=i.images.length;return Ii(m)},updateRecord:async(s,e)=>{const t=Le(ne,Ht.EXECUTION_RECORDS,s),n=pp(e);n.images!==void 0&&(n.images.some(o=>to(o))&&(n.images=await jl("execution_records",s,n.images)),n.imageCount=n.images.length),await Mt(t,{...n,updatedAt:new Date().toISOString()});const r=await nr.getRecordById(s);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async s=>{const e=Le(ne,Ht.EXECUTION_RECORDS,s),t=await jt(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Xy(n.images)}await Fs(e)},subscribeToRecords:s=>{const e=$e(ne,Ht.EXECUTION_RECORDS),t=_t(e,as("id","desc"));return hn(t,n=>{const r=n.docs.map(i=>{const o=i.data();return Ii({...o,id:parseInt(i.id)||o.id})});s(r)})},getRecordsByProject:async s=>{const e=$e(ne,Ht.EXECUTION_RECORDS),t=_t(e,Rs("projectId","==",s),as("id","desc"));return(await St(t)).docs.map(r=>{const i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async s=>{const e=$e(ne,Ht.EXECUTION_RECORDS),t=_t(e,Rs("paymentId","==",s)),n=await St(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return Ii({...i,id:parseInt(r.id)||i.id})}},Qa={getAllRecords:()=>nr.getAllRecords(),getRecordById:async s=>{const e=await nr.getRecordById(s);if(!e)throw new Error("Execution record not found");return e},createRecord:s=>nr.createRecord(s),updateRecord:(s,e)=>nr.updateRecord(s,e),deleteRecord:s=>nr.deleteRecord(s),subscribeToRecords:nr.subscribeToRecords,getRecordsByProject:nr.getRecordsByProject,getRecordByPaymentId:nr.getRecordByPaymentId},or=Wu()(Ky((s,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>s({projects:t}),addProject:t=>s(n=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...n.projects],constructionPayments:[r,...n.constructionPayments]}}),updateProject:(t,n)=>s(r=>({projects:r.projects.map(i=>i.id===t?{...i,...n}:i)})),deleteProject:t=>s(n=>({projects:n.projects.filter(r=>r.id!==t),constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>s({schedules:t}),addSchedule:t=>s(n=>({schedules:[t,...n.schedules]})),updateSchedule:(t,n)=>s(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...n}:i)})),deleteSchedule:t=>s(n=>({schedules:n.schedules.filter(r=>r.id!==t)})),setPayments:t=>s({payments:t}),addPayment:t=>s(n=>({payments:[t,...n.payments]})),updatePayment:(t,n)=>s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)})),deletePayment:t=>s(n=>({payments:n.payments.filter(r=>r.id!==t)})),setContractors:t=>s({contractors:t}),addContractor:t=>s(n=>({contractors:[t,...n.contractors]})),updateContractor:(t,n)=>s(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...n}:i)})),deleteContractor:t=>s(n=>({contractors:n.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>s({constructionPayments:t}),addConstructionPayment:t=>s(n=>({constructionPayments:[t,...n.constructionPayments]})),updateConstructionPayment:(t,n)=>s(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...n}:i)})),deleteConstructionPayment:t=>s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>s({asRequests:t}),addASRequest:t=>s(n=>({asRequests:[t,...n.asRequests]})),updateASRequest:(t,n)=>s(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...n}:i)})),deleteASRequest:t=>s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>s({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),s(n=>{const r=[t,...n.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,n)=>s(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...n}:i)})),deleteExecutionRecord:t=>s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await mn.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const n=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));n.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(n.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",n.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(C=>C.id)),f=n.filter(C=>!d.has(C.id)),y=[...m.map(C=>({...C,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),s({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),s({payments:n})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const n=`temp_${Date.now()}`,r={...t,id:n,_addedAt:Date.now(),_tempId:n};s(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",n);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await mn.createPayment(u),d=String(m.id);return s(f=>({payments:f.payments.map(h=>h._tempId===n?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),s(o=>({payments:o.payments.filter(l=>l._tempId!==n)})),i}},updatePaymentInAPI:async(t,n)=>{try{if(n.status&&Object.keys(n).length===1)await mn.updatePaymentStatus(t,n.status);else{let r=n.project;if(n.project){const o=e().projects.find(l=>l.name===n.project);r=o?o.id:n.project}await mn.updatePayment(t,{projectId:r,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,materialAmount:n.materialAmount,laborAmount:n.laborAmount,originalMaterialAmount:n.originalMaterialAmount,originalLaborAmount:n.originalLaborAmount,category:n.category,urgency:n.urgency,bankInfo:n.bankInfo,notes:n.notes,requestDate:n.requestDate,includesVAT:n.includesVAT,applyTaxDeduction:n.applyTaxDeduction})}s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await mn.deletePayment(t),s(n=>({payments:n.payments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete payment from API:",n),n}},loadSchedulesFromAPI:async()=>{try{const t=await za.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const n=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});n.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),s({schedules:n})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const n=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:n};s(l=>({schedules:[...l.schedules,r]}));try{const l=await za.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};s(f=>({schedules:f.schedules.map(h=>h.id===n?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),s(u=>({schedules:u.schedules.filter(m=>m.id!==n)})),l}},updateScheduleInAPI:async(t,n)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:n});const l={};n.project!==void 0&&(l.project=n.project),n.title!==void 0&&(l.title=n.title),n.type!==void 0&&(l.type=n.type),n.start!==void 0&&(l.startDate=n.start),n.end!==void 0&&(l.endDate=n.end),n.location!==void 0&&(l.location=n.location),n.description!==void 0&&(l.description=n.description),n.attendees!==void 0&&(l.assignedTo=n.attendees),n.time!==void 0&&(l.time=n.time),console.log(" Sending update data:",l);const u=await za.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};s(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:n}=e(),r=n.find(o=>o.id===t);if(r){s(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await za.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&s(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const n=(await $i.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});s({projects:n})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var n,r;try{const i=await $i.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((n=i.meetingNotes)==null?void 0:n.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};s(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,n)=>{var r,i;try{const o=await $i.updateProject(t,n),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:typeof o.manager=="object"&&o.manager!==null?o.manager.name||"":o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};s(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await $i.deleteProject(t),s(n=>({projects:n.projects.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete project from API:",n),n}},loadContractorsFromAPI:async()=>{try{const n=(await rr.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));s({contractors:n})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const n=await rr.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:n._id,rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)};s(i=>({contractors:[r,...i.contractors]}))}catch(n){throw console.error("Failed to add contractor to API:",n),n}},updateContractorInAPI:async(t,n)=>{try{const r=await rr.updateContractor(t,{rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};s(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await rr.deleteContractor(t),s(n=>({contractors:n.contractors.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete contractor from API:",n),n}},loadConstructionPaymentsFromAPI:async()=>{try{const n=(await Ka.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});s({constructionPayments:n})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var n;try{const r=await Ka.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((n=r.payments)==null?void 0:n.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};s(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,n)=>{var r;try{const i=await Ka.updateConstructionPayment(t,n);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};s(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await Ka.deleteConstructionPayment(t),s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete construction payment from API:",n),n}},loadASRequestsFromAPI:async()=>{try{const n=(await Oo.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));s({asRequests:n})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const n=await Oo.createASRequest(t),r={id:n._id,project:n.project,client:n.client,requestDate:new Date(n.requestDate),siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,scheduledVisitDate:n.scheduledVisitDate?new Date(n.scheduledVisitDate):void 0,scheduledVisitTime:n.scheduledVisitTime,assignedTo:Array.isArray(n.assignedTo)?n.assignedTo:[],completionDate:n.completionDate?new Date(n.completionDate):void 0,notes:n.notes};return s(i=>({asRequests:[r,...i.asRequests]})),r}catch(n){throw console.error("Failed to add AS request to API:",n),n}},updateASRequestInAPI:async(t,n)=>{try{const r=await Oo.updateASRequest(t,n),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};s(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Oo.deleteASRequest(t),s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete AS request from API:",n),n}},loadExecutionRecordsFromAPI:async()=>{try{const t=await Qa.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const n=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));s({executionRecords:n})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const n=await Qa.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(n.id),project:n.project_name,author:n.author||void 0,date:new Date(n.date),process:n.process||void 0,itemName:n.item_name,materialCost:n.material_cost||0,laborCost:n.labor_cost||0,vatAmount:n.vat_amount||0,totalAmount:n.total_amount||0,notes:n.notes||void 0,paymentId:n.payment_id?String(n.payment_id):void 0,includesTaxDeduction:n.includes_tax_deduction===1,includesVat:n.includes_vat===1,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",n.includes_vat),s(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(n){throw console.error("Failed to add execution record to API:",n),n}},updateExecutionRecordInAPI:async(t,n)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",n);try{let r;if(n.date){const i=n.date instanceof Date?n.date:new Date(n.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:n.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat),await Qa.updateRecord(t,{project_name:n.project,author:n.author,date:r,process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,images:n.images,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),s(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...n,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await Qa.deleteRecord(t),s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete execution record from API:",n),n}}}),{name:"interior-management-storage",partialize:s=>({...s,payments:s.payments.map(e=>{const{images:t,...n}=e;return n}),executionRecords:s.executionRecords.map(e=>{const{images:t,...n}=e;return n})}),storage:{getItem:s=>{var u,m,d,f,h,y,C;const e=localStorage.getItem(s);if(!e)return null;const{state:t}=JSON.parse(e),n=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var V;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((V=v.payments)==null?void 0:V.map(B=>({...B,date:new Date(B.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=n.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:n,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((C=t.executionRecords)==null?void 0:C.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(s,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(s,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:s=>localStorage.removeItem(s)}}));var Aa=s=>s.type==="checkbox",ni=s=>s instanceof Date,en=s=>s==null;const Jy=s=>typeof s=="object";var As=s=>!en(s)&&!Array.isArray(s)&&Jy(s)&&!ni(s),qC=s=>As(s)&&s.target?Aa(s.target)?s.target.checked:s.target.value:s,$C=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,WC=(s,e)=>s.has($C(e)),zC=s=>{const e=s.constructor&&s.constructor.prototype;return As(e)&&e.hasOwnProperty("isPrototypeOf")},Zm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Is(s){let e;const t=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)e=new Date(s);else if(!(Zm&&(s instanceof Blob||n))&&(t||As(s)))if(e=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!zC(s))e=s;else for(const r in s)s.hasOwnProperty(r)&&(e[r]=Is(s[r]));else return s;return e}var mc=s=>/^\w*$/.test(s),Ns=s=>s===void 0,ed=s=>Array.isArray(s)?s.filter(Boolean):[],td=s=>ed(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Re=(s,e,t)=>{if(!e||!As(s))return t;const n=(mc(e)?[e]:td(e)).reduce((r,i)=>en(r)?r:r[i],s);return Ns(n)||n===s?Ns(s[e])?t:s[e]:n},On=s=>typeof s=="boolean",es=(s,e,t)=>{let n=-1;const r=mc(e)?[e]:td(e),i=r.length,o=i-1;for(;++n<i;){const l=r[n];let u=t;if(n!==o){const m=s[l];u=As(m)||Array.isArray(m)?m:isNaN(+r[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;s[l]=u,s=s[l]}};const hp={BLUR:"blur",FOCUS_OUT:"focusout"},wn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},tr={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},KC=ut.createContext(null);KC.displayName="HookFormContext";var QC=(s,e,t,n=!0)=>{const r={defaultValues:e._defaultValues};for(const i in s)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==wn.all&&(e._proxyFormState[o]=!n||wn.all),s[o]}});return r};const YC=typeof window<"u"?ut.useLayoutEffect:ut.useEffect;var dn=s=>typeof s=="string",GC=(s,e,t,n,r)=>dn(s)?(n&&e.watch.add(s),Re(t,s,r)):Array.isArray(s)?s.map(i=>(n&&e.watch.add(i),Re(t,i))):(n&&(e.watchAll=!0),t),Uu=s=>en(s)||!Jy(s);function Dr(s,e,t=new WeakSet){if(Uu(s)||Uu(e))return s===e;if(ni(s)&&ni(e))return s.getTime()===e.getTime();const n=Object.keys(s),r=Object.keys(e);if(n.length!==r.length)return!1;if(t.has(s)||t.has(e))return!0;t.add(s),t.add(e);for(const i of n){const o=s[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ni(o)&&ni(l)||As(o)&&As(l)||Array.isArray(o)&&Array.isArray(l)?!Dr(o,l,t):o!==l)return!1}}return!0}var XC=(s,e,t,n,r)=>e?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[n]:r||!0}}:{},Yo=s=>Array.isArray(s)?s:[s],gp=()=>{let s=[];return{get observers(){return s},next:r=>{for(const i of s)i.next&&i.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(i=>i!==r)}}),unsubscribe:()=>{s=[]}}};function Zy(s,e){const t={};for(const n in s)if(s.hasOwnProperty(n)){const r=s[n],i=e[n];if(r&&As(r)&&i){const o=Zy(r,i);As(o)&&(t[n]=o)}else s[n]&&(t[n]=i)}return t}var on=s=>As(s)&&!Object.keys(s).length,sd=s=>s.type==="file",Sn=s=>typeof s=="function",Bl=s=>{if(!Zm)return!1;const e=s?s.ownerDocument:0;return s instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},eb=s=>s.type==="select-multiple",nd=s=>s.type==="radio",JC=s=>nd(s)||Aa(s),Gc=s=>Bl(s)&&s.isConnected;function ZC(s,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)s=Ns(s)?n++:s[e[n++]];return s}function e1(s){for(const e in s)if(s.hasOwnProperty(e)&&!Ns(s[e]))return!1;return!0}function ys(s,e){const t=Array.isArray(e)?e:mc(e)?[e]:td(e),n=t.length===1?s:ZC(s,t),r=t.length-1,i=t[r];return n&&delete n[i],r!==0&&(As(n)&&on(n)||Array.isArray(n)&&e1(n))&&ys(s,t.slice(0,-1)),s}var t1=s=>{for(const e in s)if(Sn(s[e]))return!0;return!1};function tb(s){return Array.isArray(s)||As(s)&&!t1(s)}function Hu(s,e={}){for(const t in s)tb(s[t])?(e[t]=Array.isArray(s[t])?[]:{},Hu(s[t],e[t])):en(s[t])||(e[t]=!0);return e}function qi(s,e,t){t||(t=Hu(e));for(const n in s)tb(s[n])?Ns(e)||Uu(t[n])?t[n]=Hu(s[n],Array.isArray(s[n])?[]:{}):qi(s[n],en(e)?{}:e[n],t[n]):t[n]=!Dr(s[n],e[n]);return t}const yp={value:!1,isValid:!1},bp={value:!0,isValid:!0};var sb=s=>{if(Array.isArray(s)){if(s.length>1){const e=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Ns(s[0].attributes.value)?Ns(s[0].value)||s[0].value===""?bp:{value:s[0].value,isValid:!0}:bp:yp}return yp},nb=(s,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>Ns(s)?s:e?s===""?NaN:s&&+s:t&&dn(s)?new Date(s):n?n(s):s;const Np={isValid:!1,value:null};var rb=s=>Array.isArray(s)?s.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Np):Np;function xp(s){const e=s.ref;return sd(e)?e.files:nd(e)?rb(s.refs).value:eb(e)?[...e.selectedOptions].map(({value:t})=>t):Aa(e)?sb(s.refs).value:nb(Ns(e.value)?s.ref.value:e.value,s)}var s1=(s,e,t,n)=>{const r={};for(const i of s){const o=Re(e,i);o&&es(r,i,o._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:n}},Ul=s=>s instanceof RegExp,To=s=>Ns(s)?s:Ul(s)?s.source:As(s)?Ul(s.value)?s.value.source:s.value:s,vp=s=>({isOnSubmit:!s||s===wn.onSubmit,isOnBlur:s===wn.onBlur,isOnChange:s===wn.onChange,isOnAll:s===wn.all,isOnTouch:s===wn.onTouched});const _p="AsyncFunction";var n1=s=>!!s&&!!s.validate&&!!(Sn(s.validate)&&s.validate.constructor.name===_p||As(s.validate)&&Object.values(s.validate).find(e=>e.constructor.name===_p)),r1=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),Dp=(s,e,t)=>!t&&(e.watchAll||e.watch.has(s)||[...e.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const Go=(s,e,t,n)=>{for(const r of t||Object.keys(s)){const i=Re(s,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!n)return!0;if(o.ref&&e(o.ref,o.name)&&!n)return!0;if(Go(l,e))break}else if(As(l)&&Go(l,e))break}}};function kp(s,e,t){const n=Re(s,t);if(n||mc(t))return{error:n,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Re(e,i),l=Re(s,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var i1=(s,e,t,n)=>{t(s);const{name:r,...i}=s;return on(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!n||wn.all))},o1=(s,e,t)=>!s||!e||s===e||Yo(s).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),a1=(s,e,t,n,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||s):(t?n.isOnBlur:r.isOnBlur)?!s:(t?n.isOnChange:r.isOnChange)?s:!0,l1=(s,e)=>!ed(Re(s,e)).length&&ys(s,e),c1=(s,e,t)=>{const n=Yo(Re(s,t));return es(n,"root",e[t]),es(s,t,n),s};function Ap(s,e,t="validate"){if(dn(s)||Array.isArray(s)&&s.every(dn)||On(s)&&!s)return{type:t,message:dn(s)?s:"",ref:e}}var ji=s=>As(s)&&!Ul(s)?s:{value:s,message:""},Ep=async(s,e,t,n,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:y,validate:C,name:v,valueAsNumber:V,mount:B}=s._f,T=Re(t,v);if(!B||e.has(v))return{};const q=l?l[0]:o,oe=w=>{r&&q.reportValidity&&(q.setCustomValidity(On(w)?"":w||""),q.reportValidity())},te={},O=nd(o),E=Aa(o),x=O||E,A=(V||sd(o))&&Ns(o.value)&&Ns(T)||Bl(o)&&o.value===""||T===""||Array.isArray(T)&&!T.length,P=XC.bind(null,v,n,te),S=(w,k,Ae,He=tr.maxLength,ye=tr.minLength)=>{const Be=w?k:Ae;te[v]={type:w?He:ye,message:Be,ref:o,...P(w?He:ye,Be)}};if(i?!Array.isArray(T)||!T.length:u&&(!x&&(A||en(T))||On(T)&&!T||E&&!sb(l).isValid||O&&!rb(l).isValid)){const{value:w,message:k}=dn(u)?{value:!!u,message:u}:ji(u);if(w&&(te[v]={type:tr.required,message:k,ref:q,...P(tr.required,k)},!n))return oe(k),te}if(!A&&(!en(f)||!en(h))){let w,k;const Ae=ji(h),He=ji(f);if(!en(T)&&!isNaN(T)){const ye=o.valueAsNumber||T&&+T;en(Ae.value)||(w=ye>Ae.value),en(He.value)||(k=ye<He.value)}else{const ye=o.valueAsDate||new Date(T),Be=Ft=>new Date(new Date().toDateString()+" "+Ft),gt=o.type=="time",$t=o.type=="week";dn(Ae.value)&&T&&(w=gt?Be(T)>Be(Ae.value):$t?T>Ae.value:ye>new Date(Ae.value)),dn(He.value)&&T&&(k=gt?Be(T)<Be(He.value):$t?T<He.value:ye<new Date(He.value))}if((w||k)&&(S(!!w,Ae.message,He.message,tr.max,tr.min),!n))return oe(te[v].message),te}if((m||d)&&!A&&(dn(T)||i&&Array.isArray(T))){const w=ji(m),k=ji(d),Ae=!en(w.value)&&T.length>+w.value,He=!en(k.value)&&T.length<+k.value;if((Ae||He)&&(S(Ae,w.message,k.message),!n))return oe(te[v].message),te}if(y&&!A&&dn(T)){const{value:w,message:k}=ji(y);if(Ul(w)&&!T.match(w)&&(te[v]={type:tr.pattern,message:k,ref:o,...P(tr.pattern,k)},!n))return oe(k),te}if(C){if(Sn(C)){const w=await C(T,t),k=Ap(w,q);if(k&&(te[v]={...k,...P(tr.validate,k.message)},!n))return oe(k.message),te}else if(As(C)){let w={};for(const k in C){if(!on(w)&&!n)break;const Ae=Ap(await C[k](T,t),q,k);Ae&&(w={...Ae,...P(k,Ae.message)},oe(Ae.message),n&&(te[v]=w))}if(!on(w)&&(te[v]={ref:q,...w},!n))return te}}return oe(!0),te};const u1={mode:wn.onSubmit,reValidateMode:wn.onChange,shouldFocusError:!0};function m1(s={}){let e={...u1,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Sn(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},r=As(e.defaultValues)||As(e.values)?Is(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Is(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:gp(),state:gp()},y=e.criteriaMode===wn.all,C=L=>F=>{clearTimeout(m),m=setTimeout(L,F)},v=async L=>{if(!e.disabled&&(d.isValid||f.isValid||L)){const F=e.resolver?on((await E()).errors):await A(n,!0);F!==t.isValid&&h.state.next({isValid:F})}},V=(L,F)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((L||Array.from(l.mount)).forEach(J=>{J&&(F?es(t.validatingFields,J,F):ys(t.validatingFields,J))}),h.state.next({validatingFields:t.validatingFields,isValidating:!on(t.validatingFields)}))},B=(L,F=[],J,xe,ue=!0,fe=!0)=>{if(xe&&J&&!e.disabled){if(o.action=!0,fe&&Array.isArray(Re(n,L))){const we=J(Re(n,L),xe.argA,xe.argB);ue&&es(n,L,we)}if(fe&&Array.isArray(Re(t.errors,L))){const we=J(Re(t.errors,L),xe.argA,xe.argB);ue&&es(t.errors,L,we),l1(t.errors,L)}if((d.touchedFields||f.touchedFields)&&fe&&Array.isArray(Re(t.touchedFields,L))){const we=J(Re(t.touchedFields,L),xe.argA,xe.argB);ue&&es(t.touchedFields,L,we)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=qi(r,i)),h.state.next({name:L,isDirty:S(L,F),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else es(i,L,F)},T=(L,F)=>{es(t.errors,L,F),h.state.next({errors:t.errors})},q=L=>{t.errors=L,h.state.next({errors:t.errors,isValid:!1})},oe=(L,F,J,xe)=>{const ue=Re(n,L);if(ue){const fe=Re(i,L,Ns(J)?Re(r,L):J);Ns(fe)||xe&&xe.defaultChecked||F?es(i,L,F?fe:xp(ue._f)):Ae(L,fe),o.mount&&v()}},te=(L,F,J,xe,ue)=>{let fe=!1,we=!1;const Oe={name:L};if(!e.disabled){if(!J||xe){(d.isDirty||f.isDirty)&&(we=t.isDirty,t.isDirty=Oe.isDirty=S(),fe=we!==Oe.isDirty);const et=Dr(Re(r,L),F);we=!!Re(t.dirtyFields,L),et?ys(t.dirtyFields,L):es(t.dirtyFields,L,!0),Oe.dirtyFields=t.dirtyFields,fe=fe||(d.dirtyFields||f.dirtyFields)&&we!==!et}if(J){const et=Re(t.touchedFields,L);et||(es(t.touchedFields,L,J),Oe.touchedFields=t.touchedFields,fe=fe||(d.touchedFields||f.touchedFields)&&et!==J)}fe&&ue&&h.state.next(Oe)}return fe?Oe:{}},O=(L,F,J,xe)=>{const ue=Re(t.errors,L),fe=(d.isValid||f.isValid)&&On(F)&&t.isValid!==F;if(e.delayError&&J?(u=C(()=>T(L,J)),u(e.delayError)):(clearTimeout(m),u=null,J?es(t.errors,L,J):ys(t.errors,L)),(J?!Dr(ue,J):ue)||!on(xe)||fe){const we={...xe,...fe&&On(F)?{isValid:F}:{},errors:t.errors,name:L};t={...t,...we},h.state.next(we)}},E=async L=>{V(L,!0);const F=await e.resolver(i,e.context,s1(L||l.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return V(L),F},x=async L=>{const{errors:F}=await E(L);if(L)for(const J of L){const xe=Re(F,J);xe?es(t.errors,J,xe):ys(t.errors,J)}else t.errors=F;return F},A=async(L,F,J={valid:!0})=>{for(const xe in L){const ue=L[xe];if(ue){const{_f:fe,...we}=ue;if(fe){const Oe=l.array.has(fe.name),et=ue._f&&n1(ue._f);et&&d.validatingFields&&V([fe.name],!0);const Ee=await Ep(ue,l.disabled,i,y,e.shouldUseNativeValidation&&!F,Oe);if(et&&d.validatingFields&&V([fe.name]),Ee[fe.name]&&(J.valid=!1,F))break;!F&&(Re(Ee,fe.name)?Oe?c1(t.errors,Ee,fe.name):es(t.errors,fe.name,Ee[fe.name]):ys(t.errors,fe.name))}!on(we)&&await A(we,F,J)}}return J.valid},P=()=>{for(const L of l.unMount){const F=Re(n,L);F&&(F._f.refs?F._f.refs.every(J=>!Gc(J)):!Gc(F._f.ref))&&it(L)}l.unMount=new Set},S=(L,F)=>!e.disabled&&(L&&F&&es(i,L,F),!Dr(Ft(),r)),w=(L,F,J)=>GC(L,l,{...o.mount?i:Ns(F)?r:dn(L)?{[L]:F}:F},J,F),k=L=>ed(Re(o.mount?i:r,L,e.shouldUnregister?Re(r,L,[]):[])),Ae=(L,F,J={})=>{const xe=Re(n,L);let ue=F;if(xe){const fe=xe._f;fe&&(!fe.disabled&&es(i,L,nb(F,fe)),ue=Bl(fe.ref)&&en(F)?"":F,eb(fe.ref)?[...fe.ref.options].forEach(we=>we.selected=ue.includes(we.value)):fe.refs?Aa(fe.ref)?fe.refs.forEach(we=>{(!we.defaultChecked||!we.disabled)&&(Array.isArray(ue)?we.checked=!!ue.find(Oe=>Oe===we.value):we.checked=ue===we.value||!!ue)}):fe.refs.forEach(we=>we.checked=we.value===ue):sd(fe.ref)?fe.ref.value="":(fe.ref.value=ue,fe.ref.type||h.state.next({name:L,values:Is(i)})))}(J.shouldDirty||J.shouldTouch)&&te(L,ue,J.shouldTouch,J.shouldDirty,!0),J.shouldValidate&&$t(L)},He=(L,F,J)=>{for(const xe in F){if(!F.hasOwnProperty(xe))return;const ue=F[xe],fe=L+"."+xe,we=Re(n,fe);(l.array.has(L)||As(ue)||we&&!we._f)&&!ni(ue)?He(fe,ue,J):Ae(fe,ue,J)}},ye=(L,F,J={})=>{const xe=Re(n,L),ue=l.array.has(L),fe=Is(F);es(i,L,fe),ue?(h.array.next({name:L,values:Is(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&J.shouldDirty&&h.state.next({name:L,dirtyFields:qi(r,i),isDirty:S(L,fe)})):xe&&!xe._f&&!en(fe)?He(L,fe,J):Ae(L,fe,J),Dp(L,l)&&h.state.next({...t,name:L}),h.state.next({name:o.mount?L:void 0,values:Is(i)})},Be=async L=>{o.mount=!0;const F=L.target;let J=F.name,xe=!0;const ue=Re(n,J),fe=et=>{xe=Number.isNaN(et)||ni(et)&&isNaN(et.getTime())||Dr(et,Re(i,J,et))},we=vp(e.mode),Oe=vp(e.reValidateMode);if(ue){let et,Ee;const Bs=F.type?xp(ue._f):qC(L),Bt=L.type===hp.BLUR||L.type===hp.FOCUS_OUT,ee=!r1(ue._f)&&!e.resolver&&!Re(t.errors,J)&&!ue._f.deps||a1(Bt,Re(t.touchedFields,J),t.isSubmitted,Oe,we),Ge=Dp(J,l,Bt);es(i,J,Bs),Bt?(!F||!F.readOnly)&&(ue._f.onBlur&&ue._f.onBlur(L),u&&u(0)):ue._f.onChange&&ue._f.onChange(L);const M=te(J,Bs,Bt),ge=!on(M)||Ge;if(!Bt&&h.state.next({name:J,type:L.type,values:Is(i)}),ee)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?Bt&&v():Bt||v()),ge&&h.state.next({name:J,...Ge?{}:M});if(!Bt&&Ge&&h.state.next({...t}),e.resolver){const{errors:ke}=await E([J]);if(fe(Bs),xe){const je=kp(t.errors,n,J),me=kp(ke,n,je.name||J);et=me.error,J=me.name,Ee=on(ke)}}else V([J],!0),et=(await Ep(ue,l.disabled,i,y,e.shouldUseNativeValidation))[J],V([J]),fe(Bs),xe&&(et?Ee=!1:(d.isValid||f.isValid)&&(Ee=await A(n,!0)));xe&&(ue._f.deps&&(!Array.isArray(ue._f.deps)||ue._f.deps.length>0)&&$t(ue._f.deps),O(J,Ee,et,M))}},gt=(L,F)=>{if(Re(t.errors,F)&&L.focus)return L.focus(),1},$t=async(L,F={})=>{let J,xe;const ue=Yo(L);if(e.resolver){const fe=await x(Ns(L)?L:ue);J=on(fe),xe=L?!ue.some(we=>Re(fe,we)):J}else L?(xe=(await Promise.all(ue.map(async fe=>{const we=Re(n,fe);return await A(we&&we._f?{[fe]:we}:we)}))).every(Boolean),!(!xe&&!t.isValid)&&v()):xe=J=await A(n);return h.state.next({...!dn(L)||(d.isValid||f.isValid)&&J!==t.isValid?{}:{name:L},...e.resolver||!L?{isValid:J}:{},errors:t.errors}),F.shouldFocus&&!xe&&Go(n,gt,L?ue:l.mount),xe},Ft=(L,F)=>{let J={...o.mount?i:r};return F&&(J=Zy(F.dirtyFields?t.dirtyFields:t.touchedFields,J)),Ns(L)?J:dn(L)?Re(J,L):L.map(xe=>Re(J,xe))},ae=(L,F)=>({invalid:!!Re((F||t).errors,L),isDirty:!!Re((F||t).dirtyFields,L),error:Re((F||t).errors,L),isValidating:!!Re(t.validatingFields,L),isTouched:!!Re((F||t).touchedFields,L)}),Me=L=>{L&&Yo(L).forEach(F=>ys(t.errors,F)),h.state.next({errors:L?t.errors:{}})},de=(L,F,J)=>{const xe=(Re(n,L,{_f:{}})._f||{}).ref,ue=Re(t.errors,L)||{},{ref:fe,message:we,type:Oe,...et}=ue;es(t.errors,L,{...et,...F,ref:xe}),h.state.next({name:L,errors:t.errors,isValid:!1}),J&&J.shouldFocus&&xe&&xe.focus&&xe.focus()},Ie=(L,F)=>Sn(L)?h.state.subscribe({next:J=>"values"in J&&L(w(void 0,F),J)}):w(L,F,!0),ze=L=>h.state.subscribe({next:F=>{o1(L.name,F.name,L.exact)&&i1(F,L.formState||d,Lt,L.reRenderRoot)&&L.callback({values:{...i},...t,...F,defaultValues:r})}}).unsubscribe,xt=L=>(o.mount=!0,f={...f,...L.formState},ze({...L,formState:f})),it=(L,F={})=>{for(const J of L?Yo(L):l.mount)l.mount.delete(J),l.array.delete(J),F.keepValue||(ys(n,J),ys(i,J)),!F.keepError&&ys(t.errors,J),!F.keepDirty&&ys(t.dirtyFields,J),!F.keepTouched&&ys(t.touchedFields,J),!F.keepIsValidating&&ys(t.validatingFields,J),!e.shouldUnregister&&!F.keepDefaultValue&&ys(r,J);h.state.next({values:Is(i)}),h.state.next({...t,...F.keepDirty?{isDirty:S()}:{}}),!F.keepIsValid&&v()},Tt=({disabled:L,name:F})=>{(On(L)&&o.mount||L||l.disabled.has(F))&&(L?l.disabled.add(F):l.disabled.delete(F))},nt=(L,F={})=>{let J=Re(n,L);const xe=On(F.disabled)||On(e.disabled);return es(n,L,{...J||{},_f:{...J&&J._f?J._f:{ref:{name:L}},name:L,mount:!0,...F}}),l.mount.add(L),J?Tt({disabled:On(F.disabled)?F.disabled:e.disabled,name:L}):oe(L,!0,F.value),{...xe?{disabled:F.disabled||e.disabled}:{},...e.progressive?{required:!!F.required,min:To(F.min),max:To(F.max),minLength:To(F.minLength),maxLength:To(F.maxLength),pattern:To(F.pattern)}:{},name:L,onChange:Be,onBlur:Be,ref:ue=>{if(ue){nt(L,F),J=Re(n,L);const fe=Ns(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,we=JC(fe),Oe=J._f.refs||[];if(we?Oe.find(et=>et===fe):fe===J._f.ref)return;es(n,L,{_f:{...J._f,...we?{refs:[...Oe.filter(Gc),fe,...Array.isArray(Re(r,L))?[{}]:[]],ref:{type:fe.type,name:L}}:{ref:fe}}}),oe(L,!1,void 0,fe)}else J=Re(n,L,{}),J._f&&(J._f.mount=!1),(e.shouldUnregister||F.shouldUnregister)&&!(WC(l.array,L)&&o.action)&&l.unMount.add(L)}}},ft=()=>e.shouldFocusError&&Go(n,gt,l.mount),us=L=>{On(L)&&(h.state.next({disabled:L}),Go(n,(F,J)=>{const xe=Re(n,J);xe&&(F.disabled=xe._f.disabled||L,Array.isArray(xe._f.refs)&&xe._f.refs.forEach(ue=>{ue.disabled=xe._f.disabled||L}))},0,!1))},K=(L,F)=>async J=>{let xe;J&&(J.preventDefault&&J.preventDefault(),J.persist&&J.persist());let ue=Is(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:we}=await E();t.errors=fe,ue=Is(we)}else await A(n);if(l.disabled.size)for(const fe of l.disabled)ys(ue,fe);if(ys(t.errors,"root"),on(t.errors)){h.state.next({errors:{}});try{await L(ue,J)}catch(fe){xe=fe}}else F&&await F({...t.errors},J),ft(),setTimeout(ft);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:on(t.errors)&&!xe,submitCount:t.submitCount+1,errors:t.errors}),xe)throw xe},Pe=(L,F={})=>{Re(n,L)&&(Ns(F.defaultValue)?ye(L,Is(Re(r,L))):(ye(L,F.defaultValue),es(r,L,Is(F.defaultValue))),F.keepTouched||ys(t.touchedFields,L),F.keepDirty||(ys(t.dirtyFields,L),t.isDirty=F.defaultValue?S(L,Is(Re(r,L))):S()),F.keepError||(ys(t.errors,L),d.isValid&&v()),h.state.next({...t}))},Fe=(L,F={})=>{const J=L?Is(L):r,xe=Is(J),ue=on(L),fe=ue?r:xe;if(F.keepDefaultValues||(r=J),!F.keepValues){if(F.keepDirtyValues){const we=new Set([...l.mount,...Object.keys(qi(r,i))]);for(const Oe of Array.from(we))Re(t.dirtyFields,Oe)?es(fe,Oe,Re(i,Oe)):ye(Oe,Re(fe,Oe))}else{if(Zm&&Ns(L))for(const we of l.mount){const Oe=Re(n,we);if(Oe&&Oe._f){const et=Array.isArray(Oe._f.refs)?Oe._f.refs[0]:Oe._f.ref;if(Bl(et)){const Ee=et.closest("form");if(Ee){Ee.reset();break}}}}if(F.keepFieldsRef)for(const we of l.mount)ye(we,Re(fe,we));else n={}}i=e.shouldUnregister?F.keepDefaultValues?Is(r):{}:Is(fe),h.array.next({values:{...fe}}),h.state.next({values:{...fe}})}l={mount:F.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!F.keepIsValid||!!F.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:F.keepSubmitCount?t.submitCount:0,isDirty:ue?!1:F.keepDirty?t.isDirty:!!(F.keepDefaultValues&&!Dr(L,r)),isSubmitted:F.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ue?{}:F.keepDirtyValues?F.keepDefaultValues&&i?qi(r,i):t.dirtyFields:F.keepDefaultValues&&L?qi(r,L):F.keepDirty?t.dirtyFields:{},touchedFields:F.keepTouched?t.touchedFields:{},errors:F.keepErrors?t.errors:{},isSubmitSuccessful:F.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Te=(L,F)=>Fe(Sn(L)?L(i):L,F),Ye=(L,F={})=>{const J=Re(n,L),xe=J&&J._f;if(xe){const ue=xe.refs?xe.refs[0]:xe.ref;ue.focus&&(ue.focus(),F.shouldSelect&&Sn(ue.select)&&ue.select())}},Lt=L=>{t={...t,...L}},mt={control:{register:nt,unregister:it,getFieldState:ae,handleSubmit:K,setError:de,_subscribe:ze,_runSchema:E,_focusError:ft,_getWatch:w,_getDirty:S,_setValid:v,_setFieldArray:B,_setDisabledField:Tt,_setErrors:q,_getFieldArray:k,_reset:Fe,_resetDefaultValues:()=>Sn(e.defaultValues)&&e.defaultValues().then(L=>{Te(L,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:P,_disableForm:us,_subjects:h,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(L){o=L},get _defaultValues(){return r},get _names(){return l},set _names(L){l=L},get _formState(){return t},get _options(){return e},set _options(L){e={...e,...L}}},subscribe:xt,trigger:$t,register:nt,handleSubmit:K,watch:Ie,setValue:ye,getValues:Ft,reset:Te,resetField:Pe,clearErrors:Me,unregister:it,setError:de,setFocus:Ye,getFieldState:ae};return{...mt,formControl:mt}}function rd(s={}){const e=ut.useRef(void 0),t=ut.useRef(void 0),[n,r]=ut.useState({isDirty:!1,isValidating:!1,isLoading:Sn(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:Sn(s.defaultValues)?void 0:s.defaultValues});if(!e.current)if(s.formControl)e.current={...s.formControl,formState:n},s.defaultValues&&!Sn(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...l}=m1(s);e.current={...l,formState:n}}const i=e.current.control;return i._options=s,YC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),ut.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),ut.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),ut.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),ut.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),ut.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),ut.useEffect(()=>{s.values&&!Dr(s.values,t.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=s.values,r(o=>({...o}))):i._resetDefaultValues()},[i,s.values]),ut.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=QC(n,i),e.current}const Cp=["","","","","","",""],ib=({event:s,slotInfo:e,defaultProjectName:t,onClose:n,onSave:r,onDelete:i})=>{const[o,l]=D.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:y}=rd({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:C}=or(),[v,V]=D.useState([]),[B,T]=D.useState(""),[q,oe]=D.useState(!1),[te,O]=D.useState(""),[E,x]=D.useState(9),[A,P]=D.useState(0),[S,w]=D.useState(""),k=f("projectId");D.useEffect(()=>{if(k){const ae=C.find(Me=>Me.id===k||Me.id===parseInt(k)||Me.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,C,v]),D.useEffect(()=>{console.log(" Modal mount - initializing states"),V([]),w(""),T("")},[]),D.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!s,eventId:s==null?void 0:s.id,hasSlotInfo:!!e,hasMergedEvents:!!(s!=null&&s.mergedEventIds)}),s&&s.id){console.log(" ScheduleModal processing event:",{title:s.title,projectId:s.projectId,projectName:s.projectName,start:s.start,assignedTo:s.assignedTo,time:s.time});const ae=s.originalTitle||s.title,Me=/ - (|) \d{1,2}$/,de=ae.replace(Me,"");if(d("title",de,{shouldValidate:!1,shouldDirty:!1}),d("date",qt(s.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",s.description||"",{shouldValidate:!1,shouldDirty:!1}),s.projectId&&s.projectId!==""&&s.projectId!=="undefined")console.log(" Setting projectId from event:",s.projectId),d("projectId",s.projectId,{shouldValidate:!1,shouldDirty:!1}),w("");else if(s.projectName){const ze=C.find(xt=>xt.name===s.projectName);console.log(" Finding project by name:",s.projectName,"found:",ze),ze?(console.log(" Setting projectId from found project:",ze.id),d("projectId",ze.id,{shouldValidate:!1,shouldDirty:!1}),w("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),w(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),w("");const Ie=s.assignedTo||s.attendees||[];if(console.log(" Setting selectedMembers to:",Ie),V(Array.isArray(Ie)?Ie:[]),s.time&&s.time!=="-"){console.log(" Setting time from event:",{eventTime:s.time,parsedHours:s.time.split(":")[0],parsedMinutes:s.time.split(":")[1]}),oe(!0);const[ze,xt]=s.time.split(":"),it=parseInt(ze,10),Tt=parseInt(xt,10);it>=12?(O(""),x(it===12?12:it-12)):(O(""),x(it===0?12:it)),P(Tt),console.log(" Time state set:",{hasTime:!0,period:it>=12?"":"",hour:it>=12?it===12?12:it-12:it===0?12:it,minute:Tt})}else console.log(" No time in event, setting hasTime to false"),oe(!1),O(""),x(9),P(0)}else if(e&&!s&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:qt(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),V([]),w(""),t)){const ae=C.find(Me=>Me.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[s==null?void 0:s.id]);const Ae=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),V(Me=>{console.log(" Previous members in setState:",Me);const de=Me.includes(ae)?Me.filter(Ie=>Ie!==ae):[...Me,ae];return console.log(" Updated members after toggle:",de),de})},He=()=>{const ae="HV LAB";v.includes(ae)?V(Me=>Me.filter(de=>de!==ae)):V(Me=>[...Me.filter(de=>de!==""),ae])},ye=()=>{const ae="";v.includes(ae)?V(Me=>Me.filter(de=>de!==ae)):V(Me=>[...Me,ae])},Be=()=>{const ae="";v.includes(ae)?V(Me=>Me.filter(de=>de!==ae)):V(Me=>[...Me,ae])},gt=()=>{B.trim()&&!v.includes(B.trim())&&(V(ae=>[...ae,B.trim()]),T(""))},$t=ae=>{V(Me=>Me.filter(de=>de!==ae))},Ft=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",q),console.log(" timePeriod:",te,"timeHour:",E,"timeMinute:",A),console.log(" Available projects:",C.map(nt=>({id:nt.id,name:nt.name,idType:typeof nt.id}))),console.log(" Merged event IDs:",s==null?void 0:s.mergedEventIds);const Me=/ - (|) \d{1,2}$/,de=ae.title.replace(Me,"").trim();let Ie="",ze="";if(ae.projectId){const nt=C.find(ft=>ft.id===ae.projectId||ft.id===parseInt(ae.projectId)||ft.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",nt),Ie=(nt==null?void 0:nt.name)||"",ze=ae.projectId}else Ie="",ze="";console.log(" Final projectId:",ze,"projectName:",Ie,"cleanedTitle:",de);const xt=new Date(ae.date);let it="-";if(q){let nt=E;te===""&&E!==12?nt=E+12:te===""&&E===12&&(nt=0),it=`${nt.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}`,console.log(" Time calculated:",it)}else console.log(" No time set (hasTime is false)");const Tt={...s,title:de,start:xt,end:xt,projectId:ze,projectName:Ie,assignedTo:v,description:ae.description||"",time:it,mergedEventIds:s==null?void 0:s.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",Tt);try{await r(Tt),console.log(" onSave completed successfully")}catch(nt){throw console.error(" onSave failed:",nt),nt}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ft),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),C.filter(ae=>s!=null&&s.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>oe(!q),className:`px-3 py-1.5 text-xs rounded border transition-colors ${q?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:q?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),q&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:E,onChange:ae=>x(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:A,onChange:ae=>P(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:He,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ye,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:Be,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Cp.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>Ae(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!Cp.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>$t(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:ae=>T(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),gt())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:gt,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:s&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(s.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(ai,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:n,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Mu=s=>{if(!s||s==="-")return"";const[e,t]=s.split(":"),n=parseInt(e,10),r=parseInt(t,10),i=n>=12?"":"",o=n%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},Hl=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Xo=s=>{if(!s)return s;const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Hl)if(n===r)return t.slice(0,-1).join(" ").trim()}for(const n of Hl)if(e.endsWith(n))return e.substring(0,e.length-n.length).trim()||e;return e},Ya=s=>{const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Hl)if(n===r)return r}for(const n of Hl)if(e.endsWith(n))return n;return""},d1=["","","","","","",""],f1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Xc=["","","/","","","","","","","","","","","","",""],p1={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},h1={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Vp=d1,g1=()=>{const{schedules:s,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:n}=or(),{user:r}=qr(),[i,o]=D.useState(!1);D.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Vp.filter(d=>d!==l)]:Vp,m=d=>{const f=s.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const V=new Set;return v.filter(B=>{const q=`${qt(new Date(B.start),"yyyy-MM-dd")}|${B.project}|${B.title}`;return V.has(q)?!1:(V.add(q),!0)})},y=h(f.filter(v=>Pd(new Date(v.start)))),C=h(f.filter(v=>ON(new Date(v.start))&&!Pd(new Date(v.start))).sort((v,V)=>new Date(v.start).getTime()-new Date(V.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:C,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),y=f.length+h.length,C=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${C?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),C&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[C&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV(Wi,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${C&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((V,B)=>{const T=B.project||"-";return V[T]||(V[T]=[]),V[T].push(B),V},{});return Object.entries(v).map(([V,B])=>{const T=d===l;return a.jsxDEV("div",{className:`border-l-3 ${T?"border-gray-400":"border-gray-900"} ${T?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${T?"bg-amber-100":"bg-gray-100"} border-b ${T?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:B.map(q=>{const oe=q.time&&q.time!=="-"?` - ${Mu(q.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",q.title,oe]},q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},V,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(wN,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((V,B)=>{const T=qt(new Date(B.start),"MM.dd",{locale:xs}),q=B.project||"-",oe=`${T}|${q}`;return V[oe]||(V[oe]={date:T,project:q,schedules:[]}),V[oe].schedules.push(B),V},{});return Object.values(v).map(({date:V,project:B,schedules:T})=>{const oe=T.length>0&&MN(new Date(T[0].start))?`${V} ()`:V;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:B},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:oe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:T.map(te=>{const O=te.time&&te.time!=="-"?` - ${Mu(te.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",te.title,O]},te.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${V}-${B}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&a.jsxDEV(ib,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await n(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},dc=()=>{const{user:s}=qr(),{projects:e}=or();return D.useMemo(()=>s?s.name===""?e.filter(n=>{const i=(n.manager?n.manager.split(",").map(l=>l.trim()):[]).includes(""),o=n.team&&Array.isArray(n.team)&&n.team.includes("");return i||o}):e:[],[s,e])},y1=({value:s,detailValue:e="",onChange:t,onDetailChange:n,placeholder:r=" ",error:i})=>{const[o,l]=D.useState(!1),[u,m]=D.useState(s),[d,f]=D.useState(e),h=D.useRef(null);D.useEffect(()=>{const B=T=>{h.current&&!h.current.contains(T.target)&&l(!1)};return o&&document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[o]),D.useEffect(()=>{m(s)},[s]),D.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((B,T)=>{if(window.daum&&window.daum.Postcode){B(!0);return}const q=document.createElement("script");q.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",q.async=!0,q.onload=()=>B(!0),q.onerror=()=>T(new Error("Kakao Postcode   ")),document.head.appendChild(q)}),C=B=>{const T=B.roadAddr||B.jibunAddr;m(T),t(T,d),l(!1)},v=B=>{const T=B.target.value;f(T),n&&n(T),u&&t(u,T)},V=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(B){const T={roadAddr:B.roadAddress,jibunAddr:B.jibunAddress||B.autoJibunAddress||"",zipNo:B.zonecode,bdNm:B.buildingName,siNm:B.sido,sggNm:B.sigungu,emdNm:B.bname,rn:B.roadname};C(T)}}).open()}catch(B){console.error("  :",B),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>V(),onChange:B=>{m(B.target.value),t(B.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Gp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:V,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},wp=["","","","","","",""],b1=({project:s,onClose:e,onSave:t})=>{const{register:n,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=rd({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=D.useState([]),[d,f]=D.useState(""),[h,y]=D.useState(""),[C,v]=D.useState(""),[V,B]=D.useState(!1);D.useEffect(()=>{var O;if(s){const E=s.location?s.location.split(","):["",""],x=((O=E[0])==null?void 0:O.trim())||s.location||"",A=E.length>1?E.slice(1).join(",").trim():"";o({name:s.name,client:s.client||"",location:x,detailLocation:A,startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:""}),y(x),v(A);const P=s.manager?s.manager.split(",").map(S=>S.trim()).filter(S=>S&&S!==""):[];m(P)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[s,o]);const T=O=>{m(E=>E.includes(O)?E.filter(x=>x!==O):[...E,O])},q=()=>{d.trim()&&!u.includes(d.trim())&&(m(O=>[...O,d.trim()]),f(""))},oe=O=>{m(E=>E.filter(x=>x!==O))},te=async O=>{if(V)return;B(!0),console.log(" ProjectModal onSubmit - Raw form data:",O);const E=h&&C?`${h}, ${C}`:h||O.location,x={name:O.name,client:O.client,location:E,manager:u.join(", "),contractAmount:(s==null?void 0:s.contractAmount)??0,spent:(s==null?void 0:s.spent)??0,status:(s==null?void 0:s.status)??"planning",progress:(s==null?void 0:s.progress)??0,description:(s==null?void 0:s.description)??"",meetingNotes:(s==null?void 0:s.meetingNotes)??[],customerRequests:(s==null?void 0:s.customerRequests)??[],entrancePassword:(s==null?void 0:s.entrancePassword)??"",sitePassword:(s==null?void 0:s.sitePassword)??""};if(O.startDate&&O.startDate!=="")x.startDate=O.startDate,console.log(" Setting startDate from form:",O.startDate);else if(s!=null&&s.startDate){const A=typeof s.startDate=="string"&&s.startDate.includes("T")?s.startDate.split("T")[0]:s.startDate;x.startDate=A,console.log(" Keeping existing startDate:",x.startDate)}if(O.endDate&&O.endDate!=="")x.endDate=O.endDate,console.log(" Setting endDate from form:",O.endDate);else if(s!=null&&s.endDate){const A=typeof s.endDate=="string"&&s.endDate.includes("T")?s.endDate.split("T")[0]:s.endDate;x.endDate=A,console.log(" Keeping existing endDate:",x.endDate)}console.log(" ProjectModal onSubmit - Final formData:",x);try{await t(x)}catch(A){throw B(!1),A}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(te),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...n("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...n("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(y1,{value:h,detailValue:C,onChange:(O,E)=>{y(O),v(E||""),i("location",O),i("detailLocation",E||"")},onDetailChange:O=>{v(O),i("detailLocation",O)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...n("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...n("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[wp.map(O=>a.jsxDEV("button",{type:"button",onClick:()=>T(O),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(O)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:O},O,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(O=>!wp.includes(O)).map(O=>a.jsxDEV("button",{type:"button",onClick:()=>oe(O),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[O," "]},O,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:O=>f(O.target.value),onKeyPress:O=>{O.key==="Enter"&&(O.preventDefault(),q())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:q,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:V,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:V?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},N1=({projectName:s,meetingNotes:e,onClose:t,onSave:n,onDelete:r})=>{const[i,o]=D.useState(""),[l,u]=D.useState(new Date().toISOString().split("T")[0]),[m,d]=D.useState(!1),[f,h]=D.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},C=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await n(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},V=B=>{window.confirm("   ?")&&r(B)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:B=>B.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:B=>u(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:B=>o(B.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(B=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:qt(new Date(B.date),"yyyy.MM.dd (eee)",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:B.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>V(B.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},B.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},x1=({projectName:s,customerRequests:e,onClose:t,onSave:n,onToggleComplete:r,onDelete:i})=>{const[o,l]=D.useState(""),[u,m]=D.useState(new Date().toISOString().split("T")[0]),[d,f]=D.useState(!1),[h,y]=D.useState(!1),C=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await n(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},V=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},B=te=>{window.confirm("  ?")&&i(te)},T=te=>{r(te)},q=e.filter(te=>!te.completed),oe=e.filter(te=>te.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:te=>te.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:C,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:te=>m(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:te=>l(te.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:V,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[q.map(te=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(te.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(SN,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:qt(new Date(te.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),oe.map(te=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>T(te.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(TN,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:qt(new Date(te.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>B(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},v1=({projectName:s,entrancePassword:e,sitePassword:t,onClose:n,onSave:r})=>{const[i,o]=D.useState(e||""),[l,u]=D.useState(t||""),[m,d]=D.useState(!1),[f,h]=D.useState(!1),y=()=>{d(!0)},C=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:V=>V.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:V=>o(V.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:V=>u(V.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:C,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},_1=({projectName:s,onClose:e})=>{var o;const[t,n]=D.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>n({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>n({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>n({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>n({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>n({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>n({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&n({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>n({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Xp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[qt(new Date(t.startDate),"yyyy",{locale:xs}),"",qt(new Date(t.startDate),"MM",{locale:xs}),"",qt(new Date(t.startDate),"dd",{locale:xs})," ~ ",qt(new Date(t.endDate),"yyyy",{locale:xs}),"",qt(new Date(t.endDate),"MM",{locale:xs}),"",qt(new Date(t.endDate),"dd",{locale:xs})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},D1=()=>{const{loadProjectsFromAPI:s,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:n}=or(),{user:r}=qr(),i=dc(),[o,l]=D.useState("in-progress"),[u,m]=D.useState("grid"),[d,f]=D.useState(!1),[h,y]=D.useState(null),[C,v]=D.useState(!1),[V,B]=D.useState(!1),[T,q]=D.useState(!1),[oe,te]=D.useState(!1),[O,E]=D.useState(null),x=(K,Pe)=>`lastViewed_${r==null?void 0:r.id}_${K}_${Pe}`,A=(K,Pe)=>{const Fe=x(K,Pe),Te=localStorage.getItem(Fe);return Te?parseInt(Te,10):0},P=(K,Pe)=>{const Fe=x(K,Pe);localStorage.setItem(Fe,Date.now().toString())},S=(K,Pe)=>{const Fe=A(K.id,Pe);return Pe==="meeting"?(K.meetingNotes||[]).some(Ye=>(Ye.createdAt?new Date(Ye.createdAt).getTime():new Date(Ye.date).getTime())>Fe):(K.customerRequests||[]).some(Ye=>!Ye.completed)};D.useEffect(()=>{s().catch(K=>{console.error("Failed to load projects:",K),se.error("   ")})},[s]),D.useEffect(()=>{const K=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",K),()=>window.removeEventListener("headerAddButtonClick",K)},[]);const w=(K,Pe)=>{if(!K||!Pe)return 0;const Fe=new Date,Te=new Date(K),Ye=new Date(Pe);if(Fe<Te)return 0;if(Fe>Ye)return 100;const Lt=Math.ceil((Ye.getTime()-Te.getTime())/(1e3*60*60*24)),Wt=Math.ceil((Fe.getTime()-Te.getTime())/(1e3*60*60*24)),mt=Math.round(Wt/Lt*100);return Math.min(100,Math.max(0,mt))},k=K=>{y(K),f(!0)},Ae=async(K,Pe)=>{if(window.confirm(`"${Pe}"  ?

    .`))try{await n(K),se.success(" ")}catch(Fe){console.error("Failed to delete project:",Fe),se.error("  ")}},He=async K=>{try{if(h)await t(h.id,K),se.success(" ");else{const Pe={id:"",...K,team:K.team||[]};await e(Pe),se.success(" "),l(K.status||"planning")}f(!1),y(null)}catch(Pe){console.error("Failed to save project:",Pe),se.error("  ")}},ye=async(K,Pe)=>{try{await t(K,{status:Pe}),se.success(" ")}catch(Fe){console.error("Failed to update project status:",Fe),se.error("  ")}},Be=K=>{E(K),v(!0),P(K.id,"meeting")},gt=K=>{E(K),B(!0),P(K.id,"request")},$t=K=>{E(K),q(!0)},Ft=K=>{E(K),te(!0)},ae=async(K,Pe)=>{if(!O)return;const Fe=O.entrancePassword,Te=O.sitePassword;E({...O,entrancePassword:K,sitePassword:Pe});try{await t(O.id,{entrancePassword:K,sitePassword:Pe}),se.success(" ")}catch(Ye){console.error("Failed to save passwords:",Ye),se.error("  "),E({...O,entrancePassword:Fe,sitePassword:Te})}},Me=async(K,Pe)=>{if(!O)return;const Fe={id:Date.now().toString(),content:K,date:Pe,createdAt:new Date},Te=[...O.meetingNotes||[],Fe];E({...O,meetingNotes:Te});try{await t(O.id,{meetingNotes:Te}),se.success("  ")}catch(Ye){console.error("Failed to save meeting note:",Ye),se.error("   "),E({...O,meetingNotes:O.meetingNotes||[]})}},de=async(K,Pe)=>{if(!O)return;const Fe={id:Date.now().toString(),content:K,completed:!1,createdAt:Pe},Te=[...O.customerRequests||[],Fe];E({...O,customerRequests:Te});try{await t(O.id,{customerRequests:Te}),se.success("  ")}catch(Ye){console.error("Failed to save customer request:",Ye),se.error("   "),E({...O,customerRequests:O.customerRequests||[]})}},Ie=async K=>{if(!O)return;const Pe=O.customerRequests||[],Fe=Pe.map(Te=>Te.id===K?{...Te,completed:!Te.completed}:Te);E({...O,customerRequests:Fe});try{await t(O.id,{customerRequests:Fe}),se.success("  ")}catch(Te){console.error("Failed to toggle request:",Te),se.error("  "),E({...O,customerRequests:Pe})}},ze=async K=>{if(!O)return;const Pe=O.meetingNotes||[],Fe=Pe.filter(Te=>Te.id!==K);E({...O,meetingNotes:Fe});try{await t(O.id,{meetingNotes:Fe}),se.success("  ")}catch(Te){console.error("Failed to delete meeting note:",Te),se.error(" "),E({...O,meetingNotes:Pe})}},xt=async K=>{if(!O)return;const Pe=O.customerRequests||[],Fe=Pe.filter(Te=>Te.id!==K);E({...O,customerRequests:Fe});try{await t(O.id,{customerRequests:Fe}),se.success("  ")}catch(Te){console.error("Failed to delete customer request:",Te),se.error(" "),E({...O,customerRequests:Pe})}},it=({project:K})=>{const Fe={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[K.status];return a.jsxDEV("select",{value:K.status,onChange:Te=>ye(K.id,Te.target.value),className:Cn("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Fe.color),onClick:Te=>Te.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},nt=(()=>{let K=i;return o!=="all"&&(K=K.filter(Pe=>Pe.status===o)),r!=null&&r.name&&(K=[...K].sort((Pe,Fe)=>{var Lt,Wt;const Te=Pe.manager===r.name||((Lt=Pe.team)==null?void 0:Lt.includes(r.name)),Ye=Fe.manager===r.name||((Wt=Fe.team)==null?void 0:Wt.includes(r.name));return Te&&!Ye?-1:!Te&&Ye?1:0})),K})(),ft={planning:i.filter(K=>K.status==="planning").length,inProgress:i.filter(K=>K.status==="in-progress").length,completed:i.filter(K=>K.status==="completed").length,onHold:i.filter(K=>K.status==="on-hold").length},us=({project:K})=>{var Fe,Te,Ye;const Pe=w(K.startDate,K.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ft(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.startDate&&K.endDate?`${qt(K.startDate,"MM.dd (eee)",{locale:xs})} - ${qt(K.endDate,"MM.dd (eee)",{locale:xs})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",K.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>$t(K),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>Be(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Fe=K.meetingNotes)==null?void 0:Fe.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Te=K.meetingNotes)==null?void 0:Te.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),K.meetingNotes&&K.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Ye=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Ye.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var mt;const Lt=((mt=K.customerRequests)==null?void 0:mt.filter(L=>!L.completed))||[],Wt=Lt[Lt.length-1];return a.jsxDEV("div",{onClick:()=>gt(K),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",Lt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Lt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),Wt?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:Wt.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>Ae(K.id,K.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:ft.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:ft.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:ft.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(K=>a.jsxDEV("button",{onClick:()=>l(K.id),className:Cn("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===K.id?`border-gray-700 ${K.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[K.label,a.jsxDEV("span",{className:Cn("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===K.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:K.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Cn("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Cn("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV(Wi,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:nt.map(K=>a.jsxDEV(us,{project:K},K.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:nt.map(K=>{var Fe,Te,Ye,Lt;const Pe=w(K.startDate,K.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:K.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:K.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[K.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:K.startDate&&K.endDate?a.jsxDEV(a.Fragment,{children:[qt(K.startDate,"yyyy.MM.dd (eee)",{locale:xs})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),qt(K.endDate,"yyyy.MM.dd (eee)",{locale:xs})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[K.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ft(K),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(it,{project:K},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>$t(K),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Pe}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Pe,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>Be(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Fe=K.meetingNotes)==null?void 0:Fe.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Te=K.meetingNotes)==null?void 0:Te.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),S(K,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Ye=K.meetingNotes)!=null&&Ye.length?((Lt=K.meetingNotes[K.meetingNotes.length-1])==null?void 0:Lt.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var L;const Wt=((L=K.customerRequests)==null?void 0:L.filter(F=>!F.completed))||[],mt=Wt[Wt.length-1];return a.jsxDEV("div",{onClick:()=>gt(K),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",Wt.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",Wt.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),S(K,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:mt?mt.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(K),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>Ae(K.id,K.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},K.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(b1,{project:h,onClose:()=>{f(!1),y(null)},onSave:He},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),C&&O&&a.jsxDEV(N1,{projectName:O.name,meetingNotes:O.meetingNotes||[],onClose:()=>{v(!1),E(null)},onSave:Me,onDelete:ze},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),V&&O&&a.jsxDEV(x1,{projectName:O.name,customerRequests:O.customerRequests||[],onClose:()=>{B(!1),E(null)},onSave:de,onToggleComplete:Ie,onDelete:xt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),T&&O&&a.jsxDEV(v1,{projectName:O.name,entrancePassword:O.entrancePassword||"",sitePassword:O.sitePassword||"",onClose:()=>{q(!1),E(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),oe&&O&&a.jsxDEV(_1,{projectName:O.name,onClose:()=>{te(!1),E(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var id={},ob={exports:{}};(function(s){function e(t){return t&&t.__esModule?t:{default:t}}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ob);var Xs=ob.exports,od={},ab={exports:{}},lb={exports:{}},cb={exports:{}},ub={exports:{}};(function(s){function e(t){"@babel/helpers - typeof";return s.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ub);var uo=ub.exports,mb={exports:{}};(function(s){var e=uo.default;function t(n,r){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(mb);var k1=mb.exports;(function(s){var e=uo.default,t=k1;function n(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(cb);var db=cb.exports;(function(s){var e=db;function t(n,r,i){return(r=e(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(lb);var fb=lb.exports;(function(s){var e=fb;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function n(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(ab);var $r=ab.exports,pb={exports:{}},hb={exports:{}};(function(s){function e(t,n){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(n.indexOf(i)!==-1)continue;r[i]=t[i]}return r}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(hb);var A1=hb.exports;(function(s){var e=A1;function t(n,r){if(n==null)return{};var i,o,l=e(n,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(l[i]=n[i])}return l}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(pb);var ad=pb.exports,gb={exports:{}};(function(s){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(gb);var gi=gb.exports,yb={exports:{}};(function(s){var e=db;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function n(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(yb);var yi=yb.exports,bb={exports:{}},Nb={exports:{}};(function(s){function e(t){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Nb);var E1=Nb.exports,xb={exports:{}};(function(s){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s.exports=e=function(){return!!t},s.exports.__esModule=!0,s.exports.default=s.exports)()}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(xb);var C1=xb.exports,vb={exports:{}},_b={exports:{}};(function(s){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(_b);var V1=_b.exports;(function(s){var e=uo.default,t=V1;function n(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(vb);var w1=vb.exports;(function(s){var e=E1,t=C1,n=w1;function r(i,o,l){return o=e(o),n(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}s.exports=r,s.exports.__esModule=!0,s.exports.default=s.exports})(bb);var mo=bb.exports,Db={exports:{}},kb={exports:{}};(function(s){function e(t,n){return s.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},s.exports.__esModule=!0,s.exports.default=s.exports,e(t,n)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(kb);var S1=kb.exports;(function(s){var e=S1;function t(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&e(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Db);var fo=Db.exports;const Ea=fa(FN);var Tn={},so={};Object.defineProperty(so,"__esModule",{value:!0});so.views=so.navigate=void 0;so.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};so.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var T1=Xs.default;Object.defineProperty(Tn,"__esModule",{value:!0});Tn.views=Tn.dateRangeFormat=Tn.dateFormat=Tn.accessor=Tn.DayLayoutAlgorithmPropType=void 0;var ln=T1(Jp),Sp=so,Tp=Object.keys(Sp.views).map(function(s){return Sp.views[s]});Tn.accessor=ln.default.oneOfType([ln.default.string,ln.default.func]);Tn.dateFormat=ln.default.any;Tn.dateRangeFormat=ln.default.func;Tn.views=ln.default.oneOfType([ln.default.arrayOf(ln.default.oneOf(Tp)),ln.default.objectOf(function(s,e){var t=Tp.indexOf(e)!==-1&&typeof s[e]=="boolean";if(t)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return ln.default.elementType.apply(ln.default,[s,e].concat(r))})]);Tn.DayLayoutAlgorithmPropType=ln.default.oneOfType([ln.default.oneOf(["overlap","no-overlap"]),ln.default.func]);var fc={},po={},L1=Xs.default;Object.defineProperty(po,"__esModule",{value:!0});po.accessor=Ab;po.wrapAccessor=void 0;var P1=L1(uo);function Ab(s,e){var t=null;return typeof e=="function"?t=e(s):typeof e=="string"&&(0,P1.default)(s)==="object"&&s!=null&&e in s&&(t=s[e]),t}po.wrapAccessor=function(e){return function(t){return Ab(t,e)}};var bi={},I1=Xs.default;Object.defineProperty(bi,"__esModule",{value:!0});bi.DnDContext=void 0;var j1=I1(D);bi.DnDContext=j1.default.createContext();var Ni=Xs.default;Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var R1=Ni($r),B1=Ni(gi),U1=Ni(yi),H1=Ni(mo),M1=Ni(fo),Ri=Ni(D),Lp=Ni(Ea),Pp=po,O1=bi,Eb=function(s){function e(){var t;(0,B1.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,H1.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,R1.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,M1.default)(e,s),(0,U1.default)(e,[{key:"renderAnchor",value:function(n){var r=n==="Up"||n==="Down"?"ns":"ew";return Ri.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(n)]},Ri.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var n=this.props,r=n.event,i=n.type,o=n.continuesPrior,l=n.continuesAfter,u=n.resizable,m=this.props.children;if(r.__isPreview)return Ri.default.cloneElement(m,{className:(0,Lp.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,Pp.accessor)(r,f):!0;if(!y)return m;var C=u&&(h?!!(0,Pp.accessor)(r,h):!0);if(C||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(C){var V=null,B=null;i==="date"?(V=!o&&this.renderAnchor("Left"),B=!l&&this.renderAnchor("Right")):(V=!o&&this.renderAnchor("Up"),B=!l&&this.renderAnchor("Down")),v.children=Ri.default.createElement("div",{className:"rbc-addons-dnd-resizable"},V,m.props.children,B)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Lp.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=Ri.default.cloneElement(m,v)}return m}}])}(Ri.default.Component);Eb.contextType=O1.DnDContext;fc.default=Eb;var pc={},Cb={exports:{}};(function(s){var e=uo.default;function t(n,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(s.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(h,y,f):h[y]=u[y]);return h},s.exports.__esModule=!0,s.exports.default=s.exports)(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Cb);var Vb=Cb.exports;function ld(s,e,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!0),s){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,n),s.dispatchEvent(r)}}function F1(s){var e=Vn(s,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function q1(s,e,t){t===void 0&&(t=5);var n=!1,r=setTimeout(function(){n||ld(s,"transitionend",!0)},e+t),i=Ml(s,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(r),i()}}function cd(s,e,t,n){t==null&&(t=F1(s)||0);var r=q1(s,t,n),i=Ml(s,"transitionend",e);return function(){r(),i()}}var Ip={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function jp(s){var e=s.node,t=s.properties,n=s.duration,r=n===void 0?200:n,i=s.easing,o=s.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var y=t[h];qN(h)?m+=h+"("+y+") ":(u[h]=y,l.push($N(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(Vn(e,Ip),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=cd(e,d,r);return e.clientLeft,Vn(e,u),{cancel:function(){f(),Vn(e,Ip)}}}function wb(s,e,t,n,r){if(!("nodeType"in s))return jp(s);if(!e)throw new Error("must include properties to animate");return typeof n=="function"&&(r=n,n=""),jp({node:s,properties:e,duration:t,easing:n,callback:r})}function Sb(s,e,t){if(s){if(typeof t>"u")return s.getAttribute(e);!t&&t!==""?s.removeAttribute(e):s.setAttribute(e,String(t))}}function Tb(s){return s?Array.from(s.children):[]}function Lb(s){if(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}return null}var $1=Function.prototype.bind.call(Function.prototype.call,[].slice);function Pb(s){return s?$1(s.childNodes):[]}function Ib(s,e){return function(n){var r=n.currentTarget,i=n.target,o=zu(r,s);o.some(function(l){return Ku(l,i)})&&e.call(this,n)}}function jb(s,e){return s&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(s,e.nextSibling):e.parentNode.appendChild(s),s):null}var W1=/^(?:input|select|textarea|button)$/i;function Rb(s){return s?W1.test(s.nodeName):!1}function Bb(s){return s?!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length):!1}function Ub(s,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var n=[];s;s=s.nextElementSibling)if(s!==e){if(t&&Qu(s,t))break;n.push(s)}return n}function Hb(s,e){return Ub(s,s,e)}function z1(s,e){var t=null,n=[];for(t=s?s[e]:null;t&&t.nodeType!==9;)n.push(t),t=t[e]||null;return n}function Mb(s){return z1(s,"parentElement")}function Ob(s,e){return s&&e?(e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s),s):null}function Fb(s){return s&&s.parentNode?(s.parentNode.removeChild(s),s):null}function ud(s,e){var t=Vn(s,"position"),n=t==="absolute",r=s.ownerDocument;if(t==="fixed")return r||document;for(;(s=s.parentNode)&&!WN(s);){var i=n&&Vn(s,"position")==="static",o=(Vn(s,"overflow")||"")+(Vn(s,"overflow-y")||"")+Vn(s,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Ol(s)<s.scrollHeight))return s}return r||document}function qb(s,e){var t=yl(s),n={top:0,left:0};if(s){var r=e||ud(s),i=zN(r),o=bl(r),l=Ol(r,!0);i||(n=yl(r)),t={top:t.top-n.top,left:t.left-n.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Yu(function(){return bl(r,o)});return function(){return Gu(f)}}}function $b(s){return Ub(s&&s.parentElement?s.parentElement.firstElementChild:null,s)}var K1=/&nbsp;/gi,Q1=/\xA0/g,Y1=/\s+([^\s])/gm;function Wb(s,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var n="";return s&&(n=(s.textContent||"").replace(K1," ").replace(Q1," "),e&&(n=n.trim()),t&&(n=n.replace(Y1," $1"))),n}function zb(s,e){s.classList?s.classList.toggle(e):Xu(s,e)?Ju(s,e):Zu(s,e)}const G1={addEventListener:uh,removeEventListener:ch,triggerEvent:ld,animate:wb,filter:Ib,listen:Ml,style:Vn,getComputedStyle:lh,attribute:Sb,activeElement:ah,ownerDocument:oh,ownerWindow:ih,requestAnimationFrame:Yu,cancelAnimationFrame:Gu,matches:Qu,height:Ol,width:rh,offset:yl,offsetParent:nh,position:sh,contains:Ku,scrollbarSize:th,scrollLeft:eh,scrollParent:ud,scrollTo:qb,scrollTop:bl,querySelectorAll:zu,closest:Zp,addClass:Zu,removeClass:Ju,hasClass:Xu,toggleClass:zb,transitionEnd:cd,childNodes:Pb,childElements:Tb,nextUntil:Hb,parents:Mb,siblings:$b,clear:Lb,insertAfter:jb,isInput:Rb,isVisible:Bb,prepend:Ob,remove:Fb,text:Wb},X1=Object.freeze(Object.defineProperty({__proto__:null,activeElement:ah,addClass:Zu,addEventListener:uh,animate:wb,attribute:Sb,cancelAnimationFrame:Gu,childElements:Tb,childNodes:Pb,clear:Lb,closest:Zp,contains:Ku,default:G1,filter:Ib,getComputedStyle:lh,hasClass:Xu,height:Ol,insertAfter:jb,isInput:Rb,isVisible:Bb,listen:Ml,matches:Qu,nextUntil:Hb,offset:yl,offsetParent:nh,ownerDocument:oh,ownerWindow:ih,parents:Mb,position:sh,prepend:Ob,querySelectorAll:zu,remove:Fb,removeClass:Ju,removeEventListener:ch,requestAnimationFrame:Yu,scrollLeft:eh,scrollParent:ud,scrollTo:qb,scrollTop:bl,scrollbarSize:th,siblings:$b,style:Vn,text:Wb,toggleClass:zb,transitionEnd:cd,triggerEvent:ld,width:rh},Symbol.toStringTag,{value:"Module"})),J1=fa(X1);var Ou={exports:{}};(function(s,e){e.__esModule=!0,e.default=n;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(r,i){return t(r.querySelectorAll(i))}s.exports=e.default})(Ou,Ou.exports);var Z1=Ou.exports,Pn={};const eV=fa(KN),tV=fa(QN),sV=fa(YN);var ho=Xs.default;Object.defineProperty(Pn,"__esModule",{value:!0});Pn.default=void 0;Pn.getBoundsForNode=da;Pn.getEventNodeFromPoint=Qb;Pn.getShowMoreNodeFromPoint=Yb;Pn.isEvent=lV;Pn.isShowMore=cV;Pn.objectsCollide=qu;var nV=ho(uo),rV=ho(gi),iV=ho(yi),Fu=ho(eV),Kb=ho(tV),oV=ho(sV);function Qs(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,oV.default)(t,s,e,{passive:!1})}function aV(s,e,t){return!s||(0,Fu.default)(s,document.elementFromPoint(e,t))}function Qb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,Kb.default)(r,".rbc-event",s)}function Yb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,Kb.default)(r,".rbc-show-more",s)}function lV(s,e){return!!Qb(s,e)}function cV(s,e){return!!Yb(s,e)}function Lo(s){var e=s;return s.touches&&s.touches.length&&(e=s.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Rp=5,uV=250,mV=function(){function s(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.global,r=n===void 0?!1:n,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,rV.default)(this,s),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Qs("touchmove",function(){},window),this._removeKeyDownListener=Qs("keydown",this._keyListener),this._removeKeyUpListener=Qs("keyup",this._keyListener),this._removeDropFromOutsideListener=Qs("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Qs("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,iV.default)(s,[{key:"on",value:function(t,n){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(n),{remove:function(){var o=r.indexOf(n);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var n=this._selectRect;return!n||!this.selecting?!1:qu(n,da(t))}},{key:"filter",value:function(t){var n=this._selectRect;return!n||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,n){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=Qs("touchmove",function(){return d()}),l=Qs("touchend",function(){return d()})},m=Qs("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&u(n),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,n=Qs("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Qs("mousedown",t._handleInitialEvent)}),r=Qs("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var n=Lo(t),r=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!aV(u,r,i))){if(!this.globalMouse&&u&&!(0,Fu.default)(u,t.target)){var f=dV(0),h=f.top,y=f.left,C=f.bottom,v=f.right;if(d=da(u),m=qu({top:d.top-h,left:d.left-y,bottom:d.bottom+C,right:d.right+v},{top:l,left:o}),!m)return}var V=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(V!==!1)switch(t.type){case"mousedown":this._removeEndListener=Qs("mouseup",this._handleTerminatingEvent),this._onEscListener=Qs("keydown",this._handleTerminatingEvent),this._removeMoveListener=Qs("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Qs("touchend",this._handleTerminatingEvent),this._removeMoveListener=Qs("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var n=t.target,r=this.validContainers;return!r||!r.length||!n?!0:r.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var n=this.selecting,r=this._selectRect;if(!n&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Fu.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(t):n?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<uV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,r=n.x,i=n.y,o=Lo(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),y=this.selecting,C=this.isClick(l,u);C&&!y&&!(m||d)||(!y&&!C&&this.emit("selectStart",this._initialEventData),C||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,n){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Rp&&Math.abs(n-o)<=Rp}}])}();function dV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,nV.default)(s)!=="object"&&(s={top:s,left:s,right:s,bottom:s}),s}function qu(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=da(s),r=n.top,i=n.left,o=n.right,l=o===void 0?i:o,u=n.bottom,m=u===void 0?r:u,d=da(e),f=d.top,h=d.left,y=d.right,C=y===void 0?h:y,v=d.bottom,V=v===void 0?f:v;return!(m-t<f||r+t>V||l-t<h||i+t>C)}function da(s){if(!s.getBoundingClientRect)return s;var e=s.getBoundingClientRect(),t=e.left+Bp("left"),n=e.top+Bp("top");return{top:n,left:t,right:(s.offsetWidth||0)+t,bottom:(s.offsetHeight||0)+n}}function Bp(s){if(s==="left")return window.pageXOffset||document.body.scrollLeft||0;if(s==="top")return window.pageYOffset||document.body.scrollTop||0}Pn.default=mV;var hc={},gc=Xs.default;Object.defineProperty(hc,"__esModule",{value:!0});hc.default=void 0;var fV=gc(fb),Up=gc($r),pV=gc(Ea),Po=gc(D);function Ga(s){return typeof s=="string"?s:s+"%"}function hV(s){var e=s.style,t=s.className,n=s.event,r=s.accessors,i=s.rtl,o=s.selected,l=s.label,u=s.continuesPrior,m=s.continuesAfter,d=s.getters,f=s.onClick,h=s.onDoubleClick,y=s.isBackgroundEvent,C=s.onKeyPress,v=s.components,V=v.event,B=v.eventWrapper,T=r.title(n),q=r.tooltip(n),oe=r.end(n),te=r.start(n),O=d.eventProp(n,te,oe,o),E=[Po.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Po.default.createElement("div",{key:"2",className:"rbc-event-content"},V?Po.default.createElement(V,{event:n,title:T}):T)],x=e.height,A=e.top,P=e.width,S=e.xOffset,w=(0,Up.default)((0,Up.default)({},O.style),{},(0,fV.default)({top:Ga(A),height:Ga(x),width:Ga(P)},i?"right":"left",Ga(S)));return Po.default.createElement(B,Object.assign({type:"time"},s),Po.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:w,onKeyDown:C,title:q?(typeof l=="string"?l+": ":"")+q:void 0,className:(0,pV.default)(y?"rbc-background-event":"rbc-event",t,O.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},E))}hc.default=hV;var mr={},Gb=Xs.default;Object.defineProperty(mr,"__esModule",{value:!0});mr.dragAccessors=void 0;mr.eventTimes=DV;mr.mergeComponents=vV;mr.pointInColumn=_V;var gV=Gb($r),yV=Gb(ad),Hp=po,bV=D,NV=["children"];mr.dragAccessors={start:(0,Hp.wrapAccessor)(function(s){return s.start}),end:(0,Hp.wrapAccessor)(function(s){return s.end})};function xV(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];var n=function(i){var o=i.children,l=(0,yV.default)(i,NV);return e.filter(Boolean).reduceRight(function(u,m){return(0,bV.createElement)(m,l,u)},o)};return n}function vV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),n=(0,gV.default)({},s);return t.forEach(function(r){n[r]=s[r]?xV(s[r],e[r]):e[r]}),n}function _V(s,e){var t=s.left,n=s.right,r=s.top,i=e.x,o=e.y;return i<n+10&&i>t&&o>r}function DV(s,e,t){var n=e.start(s),r=e.end(s),i=t.eq(n,r,"minutes")&&t.diff(n,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(n,r,"milliseconds");return{start:n,end:r,duration:o}}var kV=Vb.default,Wr=Xs.default;Object.defineProperty(pc,"__esModule",{value:!0});pc.default=void 0;var gr=Wr($r),AV=Wr(gi),EV=Wr(yi),CV=Wr(mo),VV=Wr(fo),Jc=J1,wV=Wr(Z1),Zr=Wr(D),SV=bi,yr=kV(Pn),TV=Wr(hc),sr=mr,Xb=function(s){function e(){var t;(0,AV.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,CV.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,sr.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,sr.eventTimes)(u,d,t.props.localizer),C=y.duration,v=t.props.localizer.add(h,C,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,sr.eventTimes)(f,u,d),y=h.duration,C=m.nextSlot(o),v=!isNaN(y);if(v){var V=d.add(o,y,"milliseconds");C=new Date(Math.max(V,C))}return C},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,wV.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Jc.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Jc.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new yr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Jc.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,sr.pointInColumn)((0,yr.getBoundsForNode)(l),f);var y=(0,yr.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,yr.getBoundsForNode)(y).top}),m.on("selecting",function(f){var h=(0,yr.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,yr.getBoundsForNode)(l);(0,sr.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,yr.getBoundsForNode)(l);if(!(0,sr.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,yr.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,sr.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Zr.default.createRef(),t}return(0,VV.default)(e,s),(0,EV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,gr.default)((0,gr.default)({},n),{},{start:i,end:o})})}},{key:"handleResize",value:function(n,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(n,r),y=(0,sr.eventTimes)(d,o,u),C=y.start,v=y.end,V;if(f==="UP"){var B=u.min(h,l.closestSlotFromDate(v,-1));V=l.getRange(B,v),V=(0,gr.default)((0,gr.default)({},V),{},{endDate:v})}else if(f==="DOWN"){var T=u.max(h,l.closestSlotFromDate(C));V=l.getRange(C,T),V=(0,gr.default)((0,gr.default)({},V),{},{startDate:C})}this.update(d,V)}},{key:"renderContent",value:function(){var n=this.props,r=n.children,i=n.accessors,o=n.components,l=n.getters,u=n.slotMetrics,m=n.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var C=r.props.children,v=f.start,V=f.end,B,T="eventTimeRangeFormat",q=u.startsBeforeDay(v),oe=u.startsAfterDay(V);return q?T="eventTimeRangeEndFormat":oe&&(T="eventTimeRangeStartFormat"),q&&oe?B=m.messages.allDay:B=m.format({start:v,end:V},T),Zr.default.cloneElement(r,{children:Zr.default.createElement(Zr.default.Fragment,null,C,f&&Zr.default.createElement(TV.default,{event:f,label:B,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:l,components:o,accessors:(0,gr.default)((0,gr.default)({},i),sr.dragAccessors),continuesPrior:q,continuesAfter:oe}))})}},{key:"render",value:function(){return Zr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Zr.default.Component);Xb.contextType=SV.DnDContext;pc.default=Xb;var yc={},Jb={exports:{}},Zb={exports:{}},eN={exports:{}};(function(s){function e(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(eN);var tN=eN.exports;(function(s){var e=tN;function t(n){if(Array.isArray(n))return e(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Zb);var LV=Zb.exports,sN={exports:{}};(function(s){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(sN);var PV=sN.exports,nN={exports:{}};(function(s){var e=tN;function t(n,r){if(n){if(typeof n=="string")return e(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,r):void 0}}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(nN);var IV=nN.exports,rN={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(rN);var jV=rN.exports;(function(s){var e=LV,t=PV,n=IV,r=jV;function i(o){return e(o)||t(o)||n(o)||r()}s.exports=i,s.exports.__esModule=!0,s.exports.default=s.exports})(Jb);var iN=Jb.exports,bc={},Nc={},xc={},zr=Xs.default;Object.defineProperty(xc,"__esModule",{value:!0});xc.default=void 0;var Mp=zr($r),RV=zr(ad),BV=zr(gi),UV=zr(yi),HV=zr(mo),MV=zr(fo),Io=zr(D),OV=zr(Ea),FV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],qV=function(s){function e(){return(0,BV.default)(this,e),(0,HV.default)(this,e,arguments)}return(0,MV.default)(e,s),(0,UV.default)(e,[{key:"render",value:function(){var n=this.props,r=n.style,i=n.className,o=n.event,l=n.selected,u=n.isAllDay,m=n.onSelect,d=n.onDoubleClick,f=n.onKeyPress,h=n.localizer,y=n.continuesPrior,C=n.continuesAfter,v=n.accessors,V=n.getters,B=n.children,T=n.components,q=T.event,oe=T.eventWrapper,te=n.slotStart,O=n.slotEnd,E=(0,RV.default)(n,FV);delete E.resizable;var x=v.title(o),A=v.tooltip(o),P=v.end(o),S=v.start(o),w=v.allDay(o),k=u||w||h.diff(S,h.ceil(P,"day"),"day")>1,Ae=V.eventProp(o,S,P,l),He=Io.default.createElement("div",{className:"rbc-event-content",title:A||void 0},q?Io.default.createElement(q,{event:o,continuesPrior:y,continuesAfter:C,title:x,isAllDay:w,localizer:h,slotStart:te,slotEnd:O}):x);return Io.default.createElement(oe,Object.assign({},this.props,{type:"date"}),Io.default.createElement("div",Object.assign({},E,{style:(0,Mp.default)((0,Mp.default)({},Ae.style),r),className:(0,OV.default)("rbc-event",i,Ae.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":C}),onClick:function(Be){return m&&m(o,Be)},onDoubleClick:function(Be){return d&&d(o,Be)},onKeyDown:function(Be){return f&&f(o,Be)}}),typeof B=="function"?B(He):He))}}])}(Io.default.Component);xc.default=qV;var Kr={},$V=Xs.default;Object.defineProperty(Kr,"__esModule",{value:!0});Kr.dateCellSelection=QV;Kr.getSlotAtX=oN;Kr.isSelected=zV;Kr.pointInBox=KV;Kr.slotWidth=md;var WV=$V(GN);function zV(s,e){return!s||e==null?!1:(0,WV.default)(s,e)}function md(s,e){var t=s.right-s.left,n=t/e;return n}function oN(s,e,t,n){var r=md(s,n);return t?n-1-Math.floor((e-s.left)/r):Math.floor((e-s.left)/r)}function KV(s,e){var t=e.x,n=e.y;return n>=s.top&&n<=s.bottom&&t>=s.left&&t<=s.right}function QV(s,e,t,n,r){var i=-1,o=-1,l=n-1,u=md(e,n),m=oN(e,t.x,r,n),d=e.top<t.y&&e.bottom>t.y,f=e.top<s.y&&e.bottom>s.y,h=s.y>e.bottom,y=e.top>s.y,C=t.top<e.top&&t.bottom>e.bottom;return C&&(i=0,o=l),d&&(y?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((s.x-e.left)/u):Math.floor((s.x-e.left)/u),d?m<i?i=m:o=m:s.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var dd=Xs.default;Object.defineProperty(Nc,"__esModule",{value:!0});Nc.default=void 0;var Hn=dd(Jp),Op=dd(D),YV=dd(xc),GV=Kr;Nc.default={propTypes:{slotMetrics:Hn.default.object.isRequired,selected:Hn.default.object,isAllDay:Hn.default.bool,accessors:Hn.default.object.isRequired,localizer:Hn.default.object.isRequired,components:Hn.default.object.isRequired,getters:Hn.default.object.isRequired,onSelect:Hn.default.func,onDoubleClick:Hn.default.func,onKeyPress:Hn.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var n=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(t),C=d.continuesAfter(t);return Op.default.createElement(YV.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:C,slotStart:d.first,slotEnd:d.last,selected:(0,GV.isSelected)(t,n),resizable:h})},renderSpan:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return Op.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var Qr=Xs.default;Object.defineProperty(bc,"__esModule",{value:!0});bc.default=void 0;var XV=Qr($r),JV=Qr(gi),ZV=Qr(yi),ew=Qr(mo),tw=Qr(fo),sw=Qr(Ea),Fp=Qr(D),gl=Qr(Nc),aN=function(s){function e(){return(0,JV.default)(this,e),(0,ew.default)(this,e,arguments)}return(0,tw.default)(e,s),(0,ZV.default)(e,[{key:"render",value:function(){var n=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return Fp.default.createElement("div",{className:(0,sw.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,y=d.left,C=d.right,v=d.span,V="_lvl_"+f,B=y-u,T=gl.default.renderEvent(n.props,h);return B&&m.push(gl.default.renderSpan(o,B,"".concat(V,"_gap"))),m.push(gl.default.renderSpan(o,v,V,T)),u=C+1,m},[]))}}])}(Fp.default.Component);aN.defaultProps=(0,XV.default)({},gl.default.defaultProps);bc.default=aN;var dr={},lN=Xs.default;Object.defineProperty(dr,"__esModule",{value:!0});dr.endOfRange=cN;dr.eventLevels=iw;dr.eventSegments=rw;dr.inRange=ow;dr.segsOverlap=uN;dr.sortEvents=$u;dr.sortWeekEvents=aw;var Zc=lN(iN),nw=lN(XN);function cN(s){var e=s.dateRange,t=s.unit,n=t===void 0?"day":t,r=s.localizer;return{first:e[0],last:r.add(e[e.length-1],1,n)}}function rw(s,e,t,n){var r=cN({dateRange:e,localizer:n}),i=r.first,o=r.last,l=n.diff(i,o,"day"),u=n.max(n.startOf(t.start(s),"day"),i),m=n.min(n.ceil(t.end(s),"day"),o),d=(0,nw.default)(e,function(h){return n.isSameDate(h,u)}),f=n.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-n.segmentOffset,1),{event:s,span:f,left:d+1,right:Math.max(d+f,1)}}function iw(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,n,r,i=[],o=[];for(t=0;t<s.length;t++){for(r=s[t],n=0;n<i.length&&uN(r,i[n]);n++);n>=e?o.push(r):(i[n]||(i[n]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function ow(s,e,t,n,r){var i={start:n.start(s),end:n.end(s)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function uN(s,e){return e.some(function(t){return t.left<=s.right&&t.right>=s.left})}function aw(s,e,t){var n=(0,Zc.default)(s),r=[],i=[];n.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return $u(u,m,e,t)}),l=i.sort(function(u,m){return $u(u,m,e,t)});return[].concat((0,Zc.default)(o),(0,Zc.default)(l))}function $u(s,e,t,n){var r={start:t.start(s),end:t.end(s),allDay:t.allDay(s)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return n.sortEvents({evtA:r,evtB:i})}var lw=Vb.default,Yr=Xs.default;Object.defineProperty(yc,"__esModule",{value:!0});yc.default=void 0;var Xa=Yr($r),cw=Yr(iN),uw=Yr(gi),mw=Yr(yi),dw=Yr(mo),fw=Yr(fo),Ja=Yr(D),pw=Yr(bc),Bi=lw(Pn),hw=dr,br=Kr,Za=mr,gw=bi,mN=function(s){function e(){var t;(0,uw.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,dw.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,br.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,C=d.localizer,v=(0,br.getSlotAtX)(l,o.x,y,h.slots),V=h.getDateForSlot(v),B=(0,Za.eventTimes)(m,f,C),T=B.start,q=B.duration;T=C.merge(V,T);var oe=C.add(T,q,"milliseconds");t.update(m,T,oe)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,br.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Bi.default(function(){return l},{validContainers:(0,cw.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,y=(0,Bi.getBoundsForNode)(o),C=(0,br.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||C)}),m.on("selecting",function(d){var f=(0,Bi.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Bi.getBoundsForNode)(o);t.state.segment&&((0,br.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Bi.getBoundsForNode)(o);(0,br.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Bi.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Ja.default.createRef(),t}return(0,fw.default)(e,s),(0,mw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,r,i){var o=(0,hw.eventSegments)((0,Xa.default)((0,Xa.default)({},n),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Za.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(n,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,y=(0,Za.eventTimes)(o,m,h),C=y.start,v=y.end,V=(0,br.getSlotAtX)(r,n.x,f,d.slots),B=d.getDateForSlot(V),T=(0,br.pointInBox)(r,n);if(l==="RIGHT"){if(T){if(d.last<C)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(B,1,"day"):v=B}else if(h.inRange(C,d.first,d.last)||r.bottom<n.y&&+d.first>+C)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var q=m.end(o);v=h.merge(v,q),h.lt(v,C)&&(v=q)}else if(l==="LEFT"){if(T){if(d.first>v)return this.reset();C=B}else if(h.inRange(v,d.first,d.last)||r.top>n.y&&h.lt(d.last,v))C=h.add(d.first,-1,"milliseconds");else{this.reset();return}var oe=m.start(o);C=h.merge(C,oe),h.gt(C,v)&&(C=oe)}this.update(o,C,v)}},{key:"render",value:function(){var n=this.props,r=n.children,i=n.accessors,o=this.state.segment;return Ja.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&Ja.default.createElement(pw.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,Xa.default)((0,Xa.default)({},i),Za.dragAccessors)})))}}])}(Ja.default.Component);mN.contextType=gw.DnDContext;yc.default=mN;var In=Xs.default;Object.defineProperty(od,"__esModule",{value:!0});od.default=ww;var el=In($r),yw=In(ad),bw=In(gi),Nw=In(yi),xw=In(mo),vw=In(fo),eu=In(D),_w=In(Ea),Dw=In(fc),kw=In(pc),Aw=In(yc),Ew=mr,Cw=bi,Vw=["selectable","elementProps","components"];function ww(s){var e=function(t){function n(){var r;(0,bw.default)(this,n);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,xw.default)(this,n,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,y=h.onEventDrop,C=h.onEventResize;d==="move"&&y&&y(u),d==="resize"&&C&&C(u)}},r.state={interacting:!1},r}return(0,vw.default)(n,t),(0,Nw.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,yw.default)(i,Vw),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,Ew.mergeComponents)(u,{eventWrapper:Dw.default,eventContainerWrapper:kw.default,weekWrapper:Aw.default});var f=this.props.onDropFromOutside?(0,el.default)((0,el.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,_w.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return eu.default.createElement(Cw.DnDContext.Provider,{value:h},eu.default.createElement(s,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(eu.default.Component);return e.defaultProps=(0,el.default)((0,el.default)({},s.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var Sw=Xs.default;Object.defineProperty(id,"__esModule",{value:!0});var dN=id.default=void 0,Tw=Sw(od);dN=id.default=Tw.default;const xr={async getAllProcesses(){try{const s=$e(ne,"processes"),e=_t(s,as("order","asc")),t=await St(e);return t.empty?this.getDefaultProcesses():t.docs.map(n=>{const r=n.data();return{id:parseInt(n.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(s){return console.error("[Firestore]    :",s),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,t)=>({id:t+1,name:e,order:t,isDefault:!0}))},async createProcess(s,e){try{const t=$e(ne,"processes"),n=await St(t);let r=0;n.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>r&&(r=m)});const i=r+1,o=Le(ne,"processes",String(i)),l=new Date().toISOString();return await ui(o,{name:s,order:e,isDefault:!1,createdAt:l,updatedAt:is()}),console.log(" [Firestore]   :",i),{id:i,name:s,order:e,isDefault:!1,createdAt:l}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async updateProcess(s,e){try{const t=Le(ne,"processes",String(s)),n=await jt(t);if(!n.exists())throw new Error("   .");const r=n.data(),i={updatedAt:is()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Mt(t,i),console.log(" [Firestore]   :",s),{id:s,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async deleteProcess(s){try{const e=Le(ne,"processes",String(s));await Fs(e),console.log(" [Firestore]   :",s)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(s){try{const e=s.map((t,n)=>{const r=Le(ne,"processes",String(t));return Mt(r,{order:n,updatedAt:is()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(s){const e=$e(ne,"processes"),t=_t(e,as("order","asc"));return hn(t,r=>{if(r.empty){s(xr.getDefaultProcesses());return}const i=r.docs.map(o=>{const l=o.data();return{id:parseInt(o.id)||0,name:l.name||"",order:l.order||0,isDefault:l.isDefault||!1}});s(i)})}},Lw={getAllProcesses:()=>xr.getAllProcesses(),createProcess:(s,e)=>xr.createProcess(s,e),updateProcess:(s,e)=>xr.updateProcess(s,e),deleteProcess:s=>xr.deleteProcess(s),reorderProcesses:s=>xr.reorderProcesses(s),subscribeToProcesses:xr.subscribeToProcesses,getDefaultProcesses:xr.getDefaultProcesses},Pw=dN(JN),Iw=f1;lt.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:s=>s<12?"":"",week:{dow:0,doy:1}});lt.locale("ko");const jw=ZN(lt),qp=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],Rw=ut.memo(({onSave:s,onCancel:e,processList:t})=>{const[n,r]=D.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=D.useState(i);D.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:n,onChange:m=>r(m.target.value),onBlur:()=>{n.trim()?s(n.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?n.trim()?s(n.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),$p=s=>s,Jo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},Bw=ut.memo(({date:s,label:e,filteredEvents:t,selectedDate:n,user:r,isMobileView:i})=>{const o=lt(s).format("YYYY-MM-DD"),l=Jo[o],u=!!Jo[o],m=n&&lt(s).isSame(n,"day"),d=t.filter(O=>lt(O.start).isSame(s,"day")),f=d.length,h=d.filter(O=>O.assignedTo&&O.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,C=e.replace(/^0/,""),v=s.getDay()===0,V=s.getDay()===6;let B="#000000";u||v?B="#dc2626":V&&(B="#3b82f6");const T=lt(s).isSame(lt(),"day");let q="#d1d5db";u||v?q="#fecaca":V&&(q="#bfdbfe");const oe=C.length===2,te=i?{backgroundColor:"transparent",color:B,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:T?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:B,fontWeight:T?"700":"400",paddingLeft:oe?"0px":"4px",...T&&{backgroundColor:q,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:te,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((O,E)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${E}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((O,E)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${E}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:te,children:C},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),Uw=ut.memo(({event:s,user:e,filterProject:t,isEditing:n,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",y=s.assignedTo||[],[C,v]=D.useState(!1),V=ut.useRef(null),B=()=>{const ye=window.innerWidth,Be=window.innerHeight;return ye>=768&&ye<1024||ye>=1024&&Be>ye},[T,q]=D.useState(B),[oe,te]=D.useState(!1);ut.useRef(null),ut.useRef(!1);const[O,E]=D.useState(r||""),x=ut.useRef(n);D.useEffect(()=>{n&&!x.current&&r!==void 0&&E(r),x.current=n},[n,r]);const A=e!=null&&e.name?e.name.slice(-2):null,P=A&&["",""].includes(A),S=A&&["","",""].includes(A),w=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&S||y.includes("")&&P);D.useEffect(()=>{const ye=()=>{q(B())};return window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[]);const k=ye=>{E(ye)},Ae=()=>{O!=null&&O.trim()&&o&&(i&&i(O),o()),u&&u()},He=ye=>{ye.stopPropagation(),(ye.key==="Enter"||ye.key==="Escape")&&ye.currentTarget.blur()};return T?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{te(!0),v(!0)},onMouseLeave:()=>{te(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[C&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:V,onMouseDown:ye=>{ye.stopPropagation(),ye.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!s.isASVisit&&s.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",$p(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((ye,Be)=>{const gt=ye==="HV LAB"||ye===""&&P||ye===""&&S||ye===(e==null?void 0:e.name);return a.jsxDEV(ut.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:gt?"bold":"normal"},children:ye},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Be<y.length-1&&""]},ye,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:ye=>k(ye.target.value),onBlur:Ae,onKeyDown:He,onClick:ye=>ye.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:w?"underline":"none",textDecorationColor:w?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:s.title,children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),oe&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),s.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",s.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!s.isASVisit&&s.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",$p(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:ye=>k(ye.target.value),onBlur:Ae,onKeyDown:He,onClick:ye=>ye.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:w?"underline":"none",textDecorationColor:w?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((ye,Be)=>{const gt=ye==="HV LAB"||ye===""&&P||ye===""&&S||ye===(e==null?void 0:e.name);return a.jsxDEV(ut.Fragment,{children:[a.jsxDEV("span",{className:gt?"font-bold":"",children:ye},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Be<y.length-1&&""]},ye,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),C&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:V,onMouseDown:ye=>{ye.stopPropagation(),ye.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&n&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(ye=>a.jsxDEV("option",{value:ye},ye,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),Hw=()=>{const{schedules:s,setSchedules:e,addSchedule:t,deleteSchedule:n,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=or(),{user:y}=qr(),C=dc(),[v,V]=D.useState(!1);D.useEffect(()=>{const b=()=>{const U=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;V(U)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const B=b=>!b||b==="-"?"":v?b:Mu(b),T=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",T);const q=ut.useRef(!1);D.useEffect(()=>{q.current||(q.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),se.error("  ")}))},[r]);const[oe,te]=D.useState([]);D.useEffect(()=>{const b=async U=>{if((U.ctrlKey||U.metaKey)&&U.key==="z"){const G=U.target;if(G.tagName==="INPUT"||G.tagName==="TEXTAREA"||G.isContentEditable)return;if(oe.length>0){U.preventDefault();const z=oe[oe.length-1];try{const le=z.type==="as_visit"||z.type==="expected_payment"?"other":z.type;await i({id:"",title:z.originalTitle||z.title,start:z.start,end:z.end,type:le,project:z.originalProjectName||z.projectName,attendees:z.assignedTo||[],time:z.time,description:z.description}),te(Ne=>Ne.slice(0,-1)),se.success(" ")}catch(le){console.error("  :",le),se.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[oe,i]);const[O,E]=D.useState([]),[x,A]=D.useState(!1),[P,S]=D.useState(""),[w,k]=D.useState(null),[Ae,He]=D.useState(""),[ye,Be]=D.useState(!1),[gt,$t]=D.useState(null),[Ft,ae]=D.useState(null),Me=D.useCallback(async()=>{Be(!0);try{const b=await Lw.getAllProcesses();E(b)}catch(b){console.error("   :",b),E([])}finally{Be(!1)}},[]);D.useEffect(()=>{Me()},[Me]);const de=D.useMemo(()=>O.length>0?O.map(b=>b.name):Iw,[O]),Ie=async()=>{if(P.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:P.trim()})});if(b.ok)S(""),Me(),se.success(" ");else{const U=await b.json();se.error(U.error||"  ")}}catch(b){console.error("  :",b),se.error("  ")}},ze=async()=>{if(!(!w||!Ae.trim()))try{const b=await fetch(`/api/processes/${w.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ae.trim()})});if(b.ok)k(null),He(""),Me(),se.success(" ");else{const U=await b.json();se.error(U.error||"  ")}}catch(b){console.error("  :",b),se.error("  ")}},xt=async b=>{if(confirm("   ?"))try{const U=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(U.ok)Me(),se.success(" ");else{const G=await U.json();se.error(G.error||"  ")}}catch(U){console.error("  :",U),se.error("  ")}},it=b=>{$t(b)},Tt=(b,U)=>{b.preventDefault(),gt!==null&&gt!==U&&ae(U)},nt=async()=>{if(gt!==null&&Ft!==null&&gt!==Ft){const b=[...O],[U]=b.splice(gt,1);b.splice(Ft,0,U),E(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(z=>({id:z.id}))})})).ok||(Me(),se.error("  "))}catch(G){console.error("  :",G),Me(),se.error("  ")}}$t(null),ae(null)},ft=b=>{const U=C.findIndex(G=>G.name===b);return U>=0?qp[U%qp.length]:"#e8e2ea"},us=C.map(b=>b.name),K=s.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||us.includes(b.project):!0).map(b=>{const U=C.find(be=>be.name===b.project);let G=b.project===""?"[]":b.project;if(U&&b.project!==""){const be=U.name.length>2?U.name.substring(0,2):U.name,bt=(U.location||"").match(/([A-Za-z]?\d+)/),gs=bt?bt[1]:"";G=gs?`${be}_${gs}`:be}const z=b.time,le=z&&z!=="-"?` - ${B(z)}`:"",Ne=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(U==null?void 0:U.id)||"",projectName:G||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:Ne,priority:"medium",allDay:!z||z==="-",color:ft(b.project||""),isASVisit:!1,time:z,description:b.description}}),Pe=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?us.includes(b.project):!0).map(b=>{const U=b.scheduledVisitTime,G=U&&U!=="-"?` - ${B(U)}`:"",z=C.find(be=>be.name===b.project);let le=b.project;if(z){const be=z.name.length>2?z.name.substring(0,2):z.name,bt=(z.location||"").match(/([A-Za-z]?\d+)/),gs=bt?bt[1]:"";le=gs?`${be}_${gs}`:be}const Ne=`[AS] ${le}`;return{id:`as-${b.id}`,title:Ne+G,originalTitle:Ne,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(z==null?void 0:z.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(be=>be.trim()):[],priority:"high",allDay:!U||U==="-",color:"#FEF3C7",isASVisit:!0,time:U,description:b.description}}),Fe=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var Ne,be,ct,bt,gs,Pt,It,ns;const U=C.find(Es=>Es.name===b.project);if(!U){const Es=[],Ct=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),Zt=new Set(b.payments.flatMap(ms=>{var Kt;return((Kt=ms.type)==null?void 0:Kt.split(", ").map(Yt=>Yt.trim()))||[]}));return!Zt.has("")&&((Ne=b.expectedPaymentDates)!=null&&Ne.contract)&&Es.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Ct*.1).toLocaleString()}`}),!Zt.has("")&&((be=b.expectedPaymentDates)!=null&&be.start)&&Es.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Ct*.4).toLocaleString()}`}),!Zt.has("")&&((ct=b.expectedPaymentDates)!=null&&ct.middle)&&Es.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Ct*.4).toLocaleString()}`}),!Zt.has("")&&((bt=b.expectedPaymentDates)!=null&&bt.final)&&Es.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Ct*.1).toLocaleString()}`}),Es}if(!U.startDate||!U.endDate)return[];const G=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),z=new Set(b.payments.flatMap(Es=>{var Ct;return((Ct=Es.type)==null?void 0:Ct.split(", ").map(Zt=>Zt.trim()))||[]})),le=[];return!z.has("")&&((gs=b.expectedPaymentDates)!=null&&gs.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:U.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(G*.1).toLocaleString()}`}),!z.has("")&&((Pt=b.expectedPaymentDates)!=null&&Pt.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:U.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(G*.4).toLocaleString()}`}),!z.has("")&&((It=b.expectedPaymentDates)!=null&&It.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:U.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(G*.4).toLocaleString()}`}),!z.has("")&&((ns=b.expectedPaymentDates)!=null&&ns.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:U.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(G*.1).toLocaleString()}`}),le}):[],Te=[...K,...Pe,...Fe],Ye=D.useCallback(b=>{if(!(y!=null&&y.name))return!1;const U=b.assignedTo||[],G=y.name.slice(-2),z=["",""].includes(G),le=["","",""].includes(G);return U.includes(y.name)||U.includes("HV LAB")||U.includes("")&&le||U.includes("")&&z},[y==null?void 0:y.name]),Lt=(b,U)=>{if(!U)return[...b].sort((le,Ne)=>{const be=Ye(le),ct=Ye(Ne);return be&&!ct?-1:!be&&ct?1:le.start.getTime()-Ne.start.getTime()});const G=new Map;b.forEach(le=>{const Ne=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||Ne){const be=`single_${le.id}`;G.set(be,[le])}else{const be=le.start.toISOString().split("T")[0],ct=[...le.assignedTo].sort().join(","),bt=`${be}_${le.projectName}_${ct}`;G.has(bt)||G.set(bt,[]),G.get(bt).push(le)}});const z=[];return G.forEach(le=>{if(le.length===1)z.push(le[0]);else{const Ne=le[0],be=le.map(It=>It.originalTitle||It.title),ct=[...new Set(be)],bt=le.map(It=>{const ns=It.originalTitle||It.title;return ns.startsWith(Ne.projectName+" - ")?ns.substring(Ne.projectName.length+3):ns}),gs=[...new Set(bt)],Pt={...Ne,id:le[0].id,title:gs.join(", "),originalTitle:ct.join(", "),description:le.map(It=>It.description||It.originalTitle||It.title).join(`
`),assignedTo:[...new Set(le.flatMap(It=>It.assignedTo))],mergedEventIds:le.map(It=>It.id)};z.push(Pt)}}),z.sort((le,Ne)=>{const be=Ye(le),ct=Ye(Ne);return be&&!ct?-1:!be&&ct?1:le.start.getTime()-Ne.start.getTime()})},[Wt,mt]=D.useState("month"),[L,F]=D.useState(new Date),[J,xe]=D.useState(!1),[ue,fe]=D.useState(null),[we,Oe]=D.useState(null),et=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[Ee,Bs]=D.useState(()=>{const b=localStorage.getItem(et);return b||((y==null?void 0:y.name)===""&&C.length>0?C[0].name:"all")});D.useEffect(()=>{localStorage.setItem(et,Ee)},[Ee,et]),D.useCallback(()=>{document.body.classList.add("printing-schedule");const b=Ee==="all"?" ":Ee,U=lt(L).format("YYYY MM"),G=document.title;document.title=`${b} - ${U} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=G},100)},[Ee,L]);const Bt=Lt(Te,Ee==="all"),[ee,Ge]=D.useState(window.innerWidth<768?new Date:null),[M,ge]=D.useState(null),ke=ut.useRef(null),je=ut.useRef(!1),[me,Ut]=D.useState(null),At=ut.useRef(!1),Qt=ut.useRef(!1);D.useEffect(()=>{const b=z=>{z.key==="Control"&&(Qt.current=!0)},U=z=>{z.key==="Control"&&(Qt.current=!1)},G=()=>{Qt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",U),window.addEventListener("blur",G),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",U),window.removeEventListener("blur",G)}},[]),D.useEffect(()=>{if(!M)return;let b=null;const U=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy")},G=Ne=>{Ne.preventDefault(),Ne.dataTransfer&&(Ne.dataTransfer.dropEffect="copy");const ct=Ne.target.closest(".rbc-day-bg");b&&b!==ct&&(b.style.backgroundColor=""),ct&&(ct.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=ct)},z=()=>{b&&(b.style.backgroundColor="",b=null)},le=Ne=>{Ne.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",U),document.addEventListener("dragover",G),document.addEventListener("dragend",z),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",U),document.removeEventListener("dragover",G),document.removeEventListener("dragend",z),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[M]);const[vt,fs]=D.useState(null),[zt,ps]=D.useState(null),[gn,Js]=D.useState(""),[yn,Gr]=D.useState(!1),[jn,sn]=D.useState(null),[Rn,Us]=D.useState(!1),[Ts,I]=D.useState(""),[pe,N]=D.useState(null),[R,j]=D.useState({x:0,y:0}),[Q,H]=D.useState({x:0,y:0}),[W,re]=D.useState(!1),Y=8;D.useEffect(()=>{if(!pe)return;const b=G=>{j({x:G.clientX,y:G.clientY});const z=Math.abs(G.clientX-Q.x),le=Math.abs(G.clientY-Q.y);(z>Y||le>Y)&&re(!0)},U=()=>{N(null),re(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",U)}},[pe,Q]);const Z=ut.useRef(!1),he=D.useCallback(async({event:b,start:U,end:G})=>{if(b.isASVisit||b.isExpectedPayment){se.error("    ");return}const z=U instanceof Date?U:new Date(U),le=G instanceof Date?G:new Date(G);if(Qt.current)try{const be=b.mergedEventIds||[b.id],ct=s.filter(bt=>be.includes(bt.id));for(const bt of ct)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:bt.title,start:z,end:le,project:bt.project,attendees:bt.attendees||[],time:bt.time,priority:bt.priority||"medium"});se.success(" ")}catch(be){console.error("  :",be),se.error("  ")}else{const be=b.mergedEventIds||[b.id];try{for(const ct of be)await o(ct,{start:z,end:le})}catch(ct){console.error("  :",ct),se.error("  "),r()}}},[s,o,i,r]),Je=D.useCallback(({event:b,action:U})=>{var z;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const G=document.querySelectorAll(".rbc-event");for(const le of G)if((z=le.textContent)!=null&&z.includes(b.originalTitle||b.title)){const Ne=le.getBoundingClientRect();H({x:Ne.left,y:Ne.top}),j({x:Ne.left,y:Ne.top});break}re(!1),N(b)},[]),pt=D.useCallback(async(b,U,G=!1)=>{if(Ee==="all"){se.error("  ");return}const z={id:"",title:b,start:U,end:U,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(z)}catch(le){console.error("  :",le),se.error("  ")}},[Ee,i,y]),Ke=D.useCallback(({start:b})=>{const U=M||ke.current;U&&Ee!=="all"&&(je.current=!0,At.current=!0,requestAnimationFrame(()=>{At.current=!1}),fs(null),ps(null),Js(""),pt(U,b),requestAnimationFrame(()=>{ge(null),ke.current=null,je.current=!1}))},[M,Ee,pt]),_e=D.useCallback(()=>{const b=M||ke.current;return b?{title:b}:null},[M]),ot=D.useCallback(async b=>{if(!b.trim()||!vt||Ee==="all"){fs(null);return}const U=vt;fs(null);const G={id:"",title:b.trim(),start:U,end:U,type:"construction",project:Ee,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(G)}catch(z){console.error("  :",z),se.error("  ")}},[vt,Ee,i,y]),Hs=D.useCallback(()=>{fs(null)},[]),Ls=D.useCallback(async()=>{var b;if(!zt||!gn.trim()){ps(null),Js("");return}try{const U=((b=zt.mergedEventIds)==null?void 0:b[0])||zt.id;await o(U,{title:gn.trim()})}catch(U){console.error("  :",U),se.error("  ")}ps(null),Js("")},[zt,gn,o]),nn=D.useCallback(async b=>{te(G=>[...G,b]);const U=b.mergedEventIds||[b.id];se.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(U.map(G=>l(G)))}catch(G){console.error("  :",G),se.error("  "),te(z=>z.slice(0,-1))}ps(null),Js("")},[l]),ts=Ee==="all"?Bt:Bt.filter(b=>(b.originalProjectName||b.projectName)===Ee),Ms=ut.useMemo(()=>{const b=Ee!=="all",U=new Map;ts.forEach(z=>{const le=lt(z.start).format("YYYY-MM-DD");U.has(le)||U.set(le,[]),U.get(le).push(z)});const G=[];return U.forEach(z=>{if(b)z.forEach((le,Ne)=>{const be=lt(le.start).startOf("day").add(Ne,"milliseconds").toDate();G.push({...le,start:be,allDay:!1})});else{const le=[],Ne=[];z.forEach(be=>{Ye(be)?le.push(be):Ne.push(be)}),le.forEach((be,ct)=>{const bt=lt(be.start).startOf("day").add(ct,"milliseconds").toDate();G.push({...be,start:bt,allDay:!1})}),Ne.forEach((be,ct)=>{const bt=lt(be.start).startOf("day").add(1e3+ct,"milliseconds").toDate();G.push({...be,start:bt,allDay:!1})})}}),G.sort((z,le)=>z.start.getTime()-le.start.getTime())},[ts,Ye,Ee]),ss=ut.useMemo(()=>{if(vt&&Ee!=="all"){const b=lt(vt).format("YYYY-MM-DD"),U=Ms.filter(Ne=>lt(Ne.start).format("YYYY-MM-DD")===b),G=U.length>0?Math.max(...U.map(Ne=>Ne.start.getTime())):lt(vt).startOf("day").valueOf(),z=new Date(G+1),le={id:"__inline_add__",title:"",start:z,end:z,projectId:"",projectName:Ee,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Ms,le]}return Ms},[Ms,vt,Ee]);D.useEffect(()=>{(y==null?void 0:y.name)===""&&C.length>0&&(Ee==="all"||!C.find(b=>b.name===Ee))&&Bs(C[0].name)},[C,y]),D.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(be=>{be.style.display="none",be.style.visibility="hidden",be.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(be=>{be.style.display="none",be.style.visibility="hidden",be.style.opacity="0",be.style.pointerEvents="none",be.style.position="absolute",be.style.left="-9999px",be.style.top="-9999px",be.style.zIndex="-1"})};b();const U=new MutationObserver(b),G=document.querySelector(".rbc-calendar");G&&U.observe(G,{childList:!0,subtree:!0});const z=new MutationObserver(b);return z.observe(document.body,{childList:!0,subtree:!0}),()=>{U.disconnect(),z.disconnect()}},[Wt,L]);const[yt,qe]=D.useState({date:null,projectId:"",title:""}),Ce=ut.useRef(!1),rt=ut.useRef(null),at=b=>{if(Z.current){Z.current=!1;return}if(b.id==="__inline_add__")return;Ce.current=!0,rt.current&&clearTimeout(rt.current);const U=Ee!=="all",G=window.innerWidth<768;if(U&&!G&&!b.isASVisit&&!b.isExpectedPayment)fs(null),ps(b),Js(b.originalTitle||b.title);else{const z={...b,title:b.originalTitle||b.title};Oe(null),fe(z),xe(!0)}rt.current=setTimeout(()=>{Ce.current=!1,rt.current=null},300)},dt=b=>{const U=window.innerWidth,G=U<768,z=U>=768&&U<1024,le=Ee==="all";if(At.current)return;if(G){if(b.start){Ge(b.start);const be=document.querySelector(".md\\:hidden.mt-3.bg-white");be&&be.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const Ne=b.action==="click"||b.action==="select";if(!(z&&!Ne)){if(le){Ce.current=!1,ps(null),Js(""),fs(null),Oe(b),fe(null),xe(!0);return}if(!Ce.current){if(me){pt(me,b.start,!0);return}ps(null),Js(""),fs(b.start)}}},Ue=async()=>{if(!yt.projectId||!yt.title.trim()){alert("  ");return}const b=C.find(U=>U.id===yt.projectId);if(!(!b||!yt.date))try{await i({id:Date.now().toString(),title:yt.title,start:yt.date,end:yt.date,type:"other",project:b.name,location:"",attendees:[],description:""}),qe({date:null,projectId:"",title:""}),Ge(null)}catch(U){console.error("Failed to add schedule:",U),se.error("  ")}},tt=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let U=b.color||"#E0E7FF",G="#1f2937";if(b.isASVisit)U="#E8F5E9",G="#1f2937";else{const z=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&T&&["",""].includes(T),Ne=b.assignedTo&&b.assignedTo.includes("")&&T&&["","",""].includes(T);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||z||le||Ne?(U="#FEF3C7",G="#1f2937"):b.color||(U="#e8e2ea")}return{style:{backgroundColor:U,"--event-bg-color":U,borderRadius:"6px",color:G,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},Rt=ut.useCallback(b=>{const U=lt(b).format("YYYY-MM-DD"),G=!!Jo[U],z=ee&&lt(b).isSame(ee,"day"),le=window.innerWidth<768;let Ne="";z&&(Ne+="selected-date "),G&&(Ne+="holiday-date ");const be=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:Ne.trim(),style:be}},[ee]),[Qe,hs]=D.useState(window.innerWidth<768);D.useEffect(()=>{const b=()=>{hs(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),D.useEffect(()=>{const b=()=>{const U=ee||new Date;Oe({start:U,end:U}),fe(null),xe(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ee]);const _n=ut.useCallback(({date:b,label:U})=>a.jsxDEV(Bw,{date:b,label:U,filteredEvents:ss,selectedDate:ee,user:y,isMobileView:Qe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[ss,ee,y,Qe]),Jn=ut.useRef(gn);Jn.current=gn;const Ca=ut.useCallback(b=>{Js(b)},[]),go=ut.useCallback(()=>{ps(null),Js("")},[]),Va=ut.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(Rw,{onSave:ot,onCancel:Hs,processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const U=(zt==null?void 0:zt.id)===b.id||(zt==null?void 0:zt.mergedEventIds)&&zt.mergedEventIds.includes(b.id);return a.jsxDEV(Uw,{event:b,user:y,filterProject:Ee,isEditing:U,editTitle:U?Jn.current:void 0,onEditTitleChange:U?Ca:void 0,onEditSave:U?Ls:void 0,onEditDelete:U?()=>nn(b):void 0,onEditCancel:U?go:void 0,onHoverDelete:()=>nn(b),onDeleteAction:()=>{Z.current=!0},processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,Ee,zt,Ls,nn,ot,Hs,Ca,go,de]),vc=({onNavigate:b})=>{const[U,G]=ut.useState(!1),[z,le]=ut.useState(lt(L).year()),[Ne,be]=ut.useState(lt(L).month()),ct=window.innerWidth<768,bt=()=>{le(lt(L).year()),be(lt(L).month()),G(!0)},gs=()=>{F(lt().year(z).month(Ne).toDate()),G(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${ct?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:bt,children:[a.jsxDEV("span",{children:lt(L).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",Ee==="all"?" ":Ee]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:Ee,onChange:Pt=>{Bs(Pt.target.value),Ut(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),C.filter(Pt=>Pt.status!=="completed").map(Pt=>a.jsxDEV("option",{value:Pt.name,children:Pt.name},Pt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),U&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>G(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(z-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[z,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(z+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Pt=>{const It=Ne===Pt-1,ns=lt().year()===z&&lt().month()===Pt-1;return a.jsxDEV("button",{onClick:()=>be(Pt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${It?"bg-gray-900 text-white":ns?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Pt,""]},Pt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{F(new Date),G(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:gs,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},_c=()=>null,Dc=D.useMemo(()=>({toolbar:vc,event:Va,month:{dateHeader:_n,showMore:_c}}),[_n,Va]),fr=ut.useMemo(()=>{if(!ee)return[];let b;if(Qe)b=ss.filter(G=>lt(G.start).isSame(ee,"day"));else{const G=lt(ee).startOf("week"),z=lt(ee).endOf("week");b=ss.filter(le=>{const Ne=lt(le.start);return Ne.isSameOrAfter(G,"day")&&Ne.isSameOrBefore(z,"day")})}const U=[...b].sort((G,z)=>{const le=G.assignedTo&&G.assignedTo.includes("HV LAB"),Ne=G.assignedTo&&G.assignedTo.includes("")&&T&&["",""].includes(T),be=G.assignedTo&&G.assignedTo.includes("")&&T&&["","",""].includes(T),ct=G.assignedTo&&T&&G.assignedTo.includes(T)||G.assignedTo&&(y==null?void 0:y.name)&&G.assignedTo.includes(y.name)||le||Ne||be,bt=z.assignedTo&&z.assignedTo.includes("HV LAB"),gs=z.assignedTo&&z.assignedTo.includes("")&&T&&["",""].includes(T),Pt=z.assignedTo&&z.assignedTo.includes("")&&T&&["","",""].includes(T),It=z.assignedTo&&T&&z.assignedTo.includes(T)||z.assignedTo&&(y==null?void 0:y.name)&&z.assignedTo.includes(y.name)||bt||gs||Pt;return ct&&!It?-1:!ct&&It?1:new Date(G.start).getTime()-new Date(z.start).getTime()});return console.log("Sorted events:",U.map(G=>({title:G.title,assignedTo:G.assignedTo,user:y==null?void 0:y.name,userShort:T}))),U},[ee,ss,y,T,Qe]);return D.useEffect(()=>{const U=setTimeout(()=>{const G=Qe?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),z=document.querySelectorAll(".rbc-month-row"),le=[];z.forEach((Ct,Zt)=>{const ms=Ct.querySelectorAll(".rbc-date-cell");let Kt=0;ms.forEach(Yt=>{const Nt=Yt.querySelector("button");let Jt=Nt==null?void 0:Nt.textContent;if(!Jt){const Dn=Yt.querySelector("span");Jt=Dn==null?void 0:Dn.textContent}if(Jt&&!isNaN(parseInt(Jt))){const Dn=lt(L).date(parseInt(Jt)),Bn=ss.filter(xi=>lt(xi.start).isSame(Dn,"day"));Kt=Math.max(Kt,Bn.length)}}),le.push(Kt)});const Ne=Ee&&Ee!=="all",be=100,ct=Ne?60:18,bt=25,gs=Math.floor((be-bt)/ct),Pt=le.length,It=be*Pt,ns=le.map(Ct=>Ct<=gs?be:bt+Ct*ct+10),Es=ns.reduce((Ct,Zt)=>Ct+Zt,0);if(Es>It){const Ct=ns.map((Kt,Yt)=>({index:Yt,height:Kt,overflow:Kt>be})),Zt=Ct.filter(Kt=>Kt.overflow).reduce((Kt,Yt)=>Kt+(Yt.height-be),0),ms=Ct.filter(Kt=>!Kt.overflow);if(ms.length>0){const Kt=It-Zt-ms.length*be,Yt=Math.max(50,be+Kt/ms.length);z.forEach((Nt,Jt)=>{const Bn=ns[Jt]>be?ns[Jt]:Yt;Nt.style.height=`${Bn}px`,Nt.style.minHeight=`${Bn}px`})}else{const Kt=It/Es;z.forEach((Yt,Nt)=>{const Jt=Math.max(80,ns[Nt]*Kt);Yt.style.height=`${Jt}px`,Yt.style.minHeight=`${Jt}px`})}}else{const Ct=ns.reduce((Yt,Nt)=>Yt+(Nt>be?Nt:0),0),Zt=ns.filter(Yt=>Yt<=be).length,ms=It-Ct,Kt=Zt>0?ms/Zt:be;z.forEach((Yt,Nt)=>{const Jt=ns[Nt]>be?ns[Nt]:Kt;Yt.style.height=`${Jt}px`,Yt.style.minHeight=`${Jt}px`})}G.forEach(Ct=>{const Zt=Ct.querySelector("button");let ms=Zt==null?void 0:Zt.textContent;if(!ms){const Jt=Ct.querySelector("span");ms=Jt==null?void 0:Jt.textContent}if(!ms||isNaN(parseInt(ms)))return;const Kt=lt(L).date(parseInt(ms)),Yt=ss.filter(Jt=>lt(Jt.start).isSame(Kt,"day"));Yt.length>0?Ct.setAttribute("data-event-count",Yt.length.toString()):Ct.removeAttribute("data-event-count");const Nt=Kt.clone().toDate();if(ee&&lt(Nt).isSame(ee,"day")?Ct.classList.add("selected-date"):Ct.classList.remove("selected-date"),Qe){const Jt=Ct,Dn=Jt._mobileClickHandler;Dn&&Ct.removeEventListener("click",Dn);const Bn=xi=>{if(xi.target.closest(".rbc-event"))return;const vi=Kt.clone().toDate();Ge(vi);const kn=document.querySelector(".md\\:hidden.mt-3.bg-white");kn&&kn.scrollIntoView({behavior:"smooth",block:"nearest"})};Jt._mobileClickHandler=Bn,Ct.addEventListener("click",Bn,!0),Ct.style.cursor="pointer",Ct.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(U),Qe&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(z=>{const le=z,Ne=le._mobileClickHandler;Ne&&(z.removeEventListener("click",Ne),delete le._mobileClickHandler)})}},[ss,L,Qe,ee,Ee]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[yt.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:lt(yt.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:yt.projectId,onChange:b=>qe({...yt,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:C.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:yt.title,onChange:b=>qe({...yt,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&Ue()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:Ue,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{qe({date:null,projectId:"",title:""}),Ge(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[Ee!=="all"&&!Qe&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>A(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),me&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:de.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{Ut(me===b?null:b)},onDragStart:U=>{je.current=!1,Ut(null),ge(b),ke.current=b,U.dataTransfer.setData("text/plain",b),U.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{je.current||(ge(null),ke.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${me===b?"bg-blue-500 text-white ring-2 ring-blue-300":M===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${Ee!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(Pw,{localizer:jw,events:ss,startAccessor:"start",endAccessor:"end",view:Wt,onView:mt,date:L,onNavigate:F,onSelectEvent:at,onSelectSlot:dt,onEventDrop:Ee!=="all"?he:void 0,onDragStart:Ee!=="all"?Je:void 0,onDropFromOutside:Ee!=="all"?Ke:void 0,dragFromOutsideItem:Ee!=="all"?_e:void 0,draggableAccessor:b=>Ee!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:tt,dayPropGetter:Rt,components:Dc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${Ee}-${(ee==null?void 0:ee.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ee&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:Qe?lt(ee).format("MM DD (ddd)"):`${lt(ee).startOf("week").format("MM DD")} - ${lt(ee).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Jo[lt(ee).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Jo[lt(ee).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[Ee!=="all"&&a.jsxDEV("button",{onClick:()=>Us(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Ge(null),sn(null),Us(!1),I("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:fr.length===0?a.jsxDEV("div",{className:"p-4",children:Ee!=="all"&&Rn?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:Ts,onChange:b=>I(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&Ts.trim()){const U=ee||new Date,G={id:"",title:Ts.trim(),start:U,end:U,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(G).then(()=>{Us(!1),I("")}).catch(z=>{console.error("  :",z),se.error("  ")})}else b.key==="Escape"&&(Us(!1),I(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(Ts.trim()){const b=ee||new Date,U={id:"",title:Ts.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(U).then(()=>{Us(!1),I("")}).catch(G=>{console.error("  :",G),se.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{Us(!1),I("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=fr.reduce((G,z)=>{const le=lt(z.start).format("YYYY-MM-DD");return G[le]||(G[le]=[]),G[le].push(z),G},{});return Object.keys(b).sort().map(G=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!Qe&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:lt(G).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[G].map(z=>{const le=z.assignedTo&&z.assignedTo.includes("HV LAB"),Ne=z.assignedTo&&z.assignedTo.includes("")&&T&&["",""].includes(T),be=z.assignedTo&&z.assignedTo.includes("")&&T&&["","",""].includes(T),bt=z.assignedTo&&(z.assignedTo.includes((y==null?void 0:y.name)||"")||T&&z.assignedTo.includes(T))||le||Ne||be,gs=!z.color&&!bt,Pt=!z.isASVisit&&!z.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const It={...z,title:z.originalTitle||z.title};at(It)},className:`p-3 cursor-pointer ${bt?"bg-yellow-50":""}`,style:gs?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:bt?"#FEF3C7":z.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:z.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),z.assignedTo&&z.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Es=>z.assignedTo.includes(Es))?"":z.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),z.projectName&&Ee==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:z.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Pt?a.jsxDEV("button",{onClick:It=>{It.stopPropagation(),sn(z)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},z.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},G,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),Ee!=="all"&&Rn&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:Ts,onChange:b=>I(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&Ts.trim()){const U=ee||new Date,G={id:"",title:Ts.trim(),start:U,end:U,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(G).then(()=>{Us(!1),I("")}).catch(z=>{console.error("  :",z),se.error("  ")})}else b.key==="Escape"&&(Us(!1),I(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(Ts.trim()){const b=ee||new Date,U={id:"",title:Ts.trim(),start:b,end:b,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(U).then(()=>{Us(!1),I("")}).catch(G=>{console.error("  :",G),se.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{Us(!1),I("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),Qe&&Ee!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:de.map(b=>a.jsxDEV("button",{onClick:async()=>{const U=ee||new Date;if(Ee!=="all"){const G={id:"",title:b,start:U,end:U,project:Ee,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(G)}catch(z){console.error("  :",z),se.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),J&&a.jsxDEV(ib,{event:ue,slotInfo:we,defaultProjectName:Ee!=="all"?Ee:void 0,onClose:()=>{xe(!1),fe(null),Oe(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ue)if(ue.id.startsWith("as-")){const U=ue.id.replace("as-","");let G="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?G=b.assignedTo.join(", "):ue.assignedTo&&Array.isArray(ue.assignedTo)?G=ue.assignedTo.join(", "):typeof ue.assignedTo=="string"&&(G=ue.assignedTo),await m(U,{project:b.title||ue.title,assignedTo:G,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ue.time}),await d(),xe(!1)}else if(ue.id.startsWith("payment-")){const U=ue.id.split("-"),G=U[1],z=U[2],le=f.find(Ne=>Ne.id===G);if(le){const Ne={...le.expectedPaymentDates};Ne[z]=b.start,await h(G,{expectedPaymentDates:Ne})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let U=b.title;const G=/ - (|) \d{1,2}( \d{1,2})?$/;if(U=U.replace(G,""),ue.mergedEventIds&&ue.mergedEventIds.length>0){console.log(" Updating merged schedules:",ue.mergedEventIds);const z=(ue.originalTitle||ue.title).split(", "),le=U.split(", ");for(let Ne=0;Ne<ue.mergedEventIds.length;Ne++){const be=ue.mergedEventIds[Ne],ct=le[Ne]||z[Ne]||U;await o(be,{title:ct.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ue.id,{title:U,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const U={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(U)}xe(!1)}catch(U){console.error("Failed to save schedule:",U),se.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const U=b.split("-"),G=U[1],z=U[2],le=f.find(Ne=>Ne.id===G);if(le){const Ne={...le.expectedPaymentDates};delete Ne[z],await h(G,{expectedPaymentDates:Ne})}}else if(b.startsWith("as-")){const U=b.replace("as-","");await m(U,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const U=Bt.find(G=>G.id===b);if(U!=null&&U.mergedEventIds&&U.mergedEventIds.length>0){console.log("Deleting merged schedules:",U.mergedEventIds);for(const G of U.mergedEventIds)await l(G)}else await l(b)}xe(!1)}catch(U){console.error("Failed to delete schedule:",U),se.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),pe&&W&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:R.x-50,top:R.y-15,backgroundColor:pe.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:pe.originalTitle||pe.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),jn&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>sn(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:jn.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>sn(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=jn.mergedEventIds||[jn.id];await Promise.all(b.map(U=>l(U)))}catch(b){console.error("  :",b),se.error(" ")}sn(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),x&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{A(!1),k(null),S("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{A(!1),k(null),S("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:P,onChange:b=>S(b.target.value),onKeyDown:b=>b.key==="Enter"&&Ie(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Ie,disabled:!P.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:ye?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):O.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:O.map((b,U)=>a.jsxDEV("div",{draggable:(w==null?void 0:w.id)!==b.id,onDragStart:()=>it(U),onDragOver:G=>Tt(G,U),onDragEnd:nt,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${gt===U?"opacity-50 bg-gray-100":""} ${Ft===U?"border-t-2 border-gray-400":""} ${(w==null?void 0:w.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(w==null?void 0:w.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:Ae,onChange:G=>He(G.target.value),onKeyDown:G=>{G.key==="Enter"&&ze(),G.key==="Escape"&&(k(null),He(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:ze,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),He("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:U+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),He(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>xt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),O.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},Mw=({projectName:s,onClose:e,type:t="cash"})=>{const n=t==="cash",r=n?"":"",i=n?"      .":"      .",[o,l]=D.useState({receiptDate:qt(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],C=["","","","","","","","","",""];let v="",V=0;for(;f>0;){const B=f%1e4;if(B>0){let T="",q=B,oe=0;for(;q>0;){const te=q%10;te>0&&(T=C[te]+y[oe]+T),q=Math.floor(q/10),oe++}v=T+h[V]+v}f=Math.floor(f/1e4),V++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Xp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:n?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:qt(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:qt(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Ow="HVLabImageDB",Fw=1,Ur="paymentRecordImages";let tl=null;const fd=()=>new Promise((s,e)=>{if(tl){s(tl);return}const t=indexedDB.open(Ow,Fw);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{tl=t.result,s(tl)},t.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains(Ur)||r.createObjectStore(Ur,{keyPath:"id"})}}),qw=async()=>{try{const s=await fd();return new Promise((e,t)=>{const i=s.transaction(Ur,"readonly").objectStore(Ur).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(s){console.error("IndexedDB , localStorage :",s);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},$w=async(s,e)=>{try{const t=await fd();return new Promise((n,r)=>{const l=t.transaction(Ur,"readwrite").objectStore(Ur).put({id:s,images:e});l.onsuccess=()=>n(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},Ww=async s=>{try{const e=await fd();return new Promise((t,n)=>{const r=e.transaction(Ur,"readwrite"),i=r.objectStore(Ur);i.clear(),Object.entries(s).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),n(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},zw=async()=>{try{const s=localStorage.getItem("paymentRecordImages");if(s){const e=JSON.parse(s);Object.keys(e).length>0&&(await Ww(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(s){console.error(" :",s)}},sl=s=>{if(!s)return 0;try{const t=new Date(s).getTime();return isNaN(t)?0:t}catch{return 0}},Wp=(s,e,t)=>{if(!s)return null;try{const n=new Date(s);return isNaN(n.getTime())?null:qt(n,e,t)}catch{return null}},Kw=()=>{const{payments:s,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:n,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=or(),{user:l}=qr(),u=dc(),[m,d]=D.useState(""),[f,h]=D.useState(null),[y,C]=D.useState(null),[v,V]=D.useState(!1),[B,T]=D.useState(!1),[q,oe]=D.useState(!1),[te,O]=D.useState(!1),[E,x]=D.useState(""),[A,P]=D.useState("form"),[S,w]=D.useState(!1),[k,Ae]=D.useState(!1),He=D.useRef(null),[ye,Be]=D.useState("pending"),[gt,$t]=D.useState("all"),[Ft,ae]=D.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Me,de]=D.useState(!1),[Ie,ze]=D.useState(null),[xt,it]=D.useState(!1),[Tt,nt]=D.useState(""),[ft,us]=D.useState(!1),K=D.useRef(!1),Pe=D.useRef(!1),Fe=D.useRef(null),[Te,Ye]=D.useState([]),[Lt,Wt]=D.useState([]),[mt,L]=D.useState(null),[F,J]=D.useState([]),[xe,ue]=D.useState([]),[fe,we]=D.useState(!1),[Oe,et]=D.useState({}),[Ee,Bs]=D.useState(!1),Bt=()=>{const N=localStorage.getItem("lastSelectedProject"),R=u.filter(j=>j.status!=="completed");return N&&R.some(j=>j.name===N)?N:R.length>0?R[0].name:""},[ee,Ge]=D.useState({project:"",date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});D.useEffect(()=>{(async()=>{try{const R=await rr.getAllContractors();Ye(R.map(j=>({id:j._id||j.id,rank:j.rank,companyName:j.companyName,name:j.name,process:j.process,contact:j.contact,accountNumber:j.accountNumber,bankName:j.bankName,notes:j.notes,createdAt:new Date(j.createdAt),updatedAt:new Date(j.updatedAt)})))}catch(R){console.error("Failed to load contractors:",R)}})()},[]),D.useEffect(()=>{$t("all");const N=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);(async()=>{N&&(console.log("[]   - Firestore  "),await ap()),t().catch(Q=>{console.error("Failed to load projects:",Q)}),e().catch(Q=>{console.error("Failed to load payments:",Q)})})();const j=()=>{w(window.innerWidth<1024)};if(j(),window.addEventListener("resize",j),u.length>0&&!ee.project&&!Pe.current){const Q=Bt();Q&&(Ge(H=>({...H,project:Q})),localStorage.setItem("lastSelectedProject",Q))}return()=>window.removeEventListener("resize",j)},[]);const M=D.useRef(new Map),ge=D.useRef(null),ke=D.useRef(Date.now()),je=D.useCallback(N=>N.map(R=>({id:String(R.id),project:R.project_name||"",purpose:R.description,process:R.vendor_name,itemName:R.item_name||"",amount:R.amount,materialAmount:R.material_amount||0,laborAmount:R.labor_amount||0,originalMaterialAmount:R.original_material_amount||0,originalLaborAmount:R.original_labor_amount||0,applyTaxDeduction:R.apply_tax_deduction===1,includesVAT:R.includes_vat===1,quickText:R.quick_text||"",images:(()=>{if(!R.images)return[];if(Array.isArray(R.images))return R.images;try{const j=JSON.parse(R.images);return Array.isArray(j)?j:[]}catch{return[]}})(),category:R.request_type,status:R.status,urgency:"normal",requestedBy:R.requester_name,requestDate:new Date(R.created_at),approvalDate:R.approved_at?new Date(R.approved_at):void 0,bankInfo:{accountHolder:R.account_holder||"",bankName:R.bank_name||"",accountNumber:R.account_number||""},attachments:[],notes:R.notes||"",completionDate:R.paid_at?new Date(R.paid_at):void 0})),[]),me=D.useCallback(()=>{console.log("[ ] Firestore  ..."),ge.current&&(ge.current(),ge.current=null),ge.current=mn.subscribeToPayments(N=>{console.log("[ ]  :",N.length,""),ke.current=Date.now(),N.forEach(W=>{const re=String(W.id),Y=M.current.get(re);if(Y&&Y!=="completed"&&W.status==="completed"){const Z=s.find(he=>String(he.id)===re);(!Z||Z.status!=="completed")&&se.success(`: ${W.project_name||""} ${W.item_name||""}`.trim(),{duration:4e3})}});const R=new Map;N.forEach(W=>{R.set(String(W.id),W.status)}),M.current=R;const j=je(N),Q=j.filter(W=>W.status==="pending").length,H=j.filter(W=>W.status==="completed").length;console.log("[ ] Zustand  :",j.length," (:",Q,", :",H,")"),or.setState({payments:j})})},[je,s]);D.useEffect(()=>(me(),()=>{console.log("[ ] Firestore  "),ge.current&&(ge.current(),ge.current=null)}),[]),D.useEffect(()=>{const N=async()=>{if(document.visibilityState==="visible"){if(Fe.current){console.log("[]     - ");return}const R=Date.now()-ke.current;if(console.log("[]   -   :",Math.round(R/1e3),""),R>3e4){console.log("[]   - Firestore  "),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(console.log("[]  - Firestore  "),await ap()),me();try{await e(),console.log("[]   ")}catch(Q){console.error("[]   :",Q)}}}};return document.addEventListener("visibilitychange",N),()=>{document.removeEventListener("visibilitychange",N)}},[me,e]),D.useEffect(()=>{(async()=>{var Q,H,W,re;if(K.current)return;const R=new URLSearchParams(window.location.search),j=R.get("complete")||R.get("c");if(j){if(!l){console.log("[ ]   -  ");return}K.current=!0,console.log("[ ]  :",j),window.history.replaceState({},"","/payments"),Pe.current=!0,P("list"),Be("completed"),$t("all"),Ge(Y=>({...Y,project:""})),o(String(j),{status:"completed",completionDate:new Date}),se.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(j),{status:"completed"}),await e();const Y=Rl.getSocket();Y&&Y.emit("payment:refresh",{paymentId:j,status:"completed",updatedAt:new Date().toISOString()})}catch(Y){console.error("[ ]  :",Y),o(String(j),{status:"pending",completionDate:void 0}),Be("pending");let Z="  ";((Q=Y.response)==null?void 0:Q.status)===401?Z=" .  ":((H=Y.response)==null?void 0:H.status)===404?Z="     (ID: "+j+")":(re=(W=Y.response)==null?void 0:W.data)!=null&&re.error?Z=Y.response.data.error:Y.message&&(Z+=": "+Y.message),se.error(Z)}}})()},[e,i,o,l]),D.useEffect(()=>{if(ee.process){const N=new Set(s.filter(H=>{var W;return H.status==="completed"&&((W=H.bankInfo)==null?void 0:W.accountHolder)}).map(H=>H.bankInfo.accountHolder.trim().toLowerCase())),R=(H,W)=>{const re=H.toLowerCase(),Y=W.toLowerCase();if(re.includes(Y)||Y.includes(re))return!0;const Z=re.split("/").map(Je=>Je.trim()),he=Y.replace(/$/,"").trim();for(const Je of Z)if(Je===he||he.includes(Je)||Je.includes(he))return!0;return!1},Q=Te.filter(H=>{if(!R(ee.process,H.process))return!1;const re=H.accountNumber&&H.accountNumber.trim()!=="",Y=H.name.trim().toLowerCase(),Z=N.has(Y);return re||Z}).sort((H,W)=>{const re=H.accountNumber&&H.accountNumber.trim()!=="",Y=W.accountNumber&&W.accountNumber.trim()!=="";return re&&!Y?-1:!re&&Y?1:0});Wt(Q)}else Wt([])},[ee.process,Te,s]),D.useEffect(()=>{if(ee.process){const N=(Q,H)=>{if(!H)return!1;const W=Q.toLowerCase(),re=H.toLowerCase();if(W.includes(re)||re.includes(W))return!0;const Y=W.split("/").map(he=>he.trim()),Z=re.replace(/$/,"").trim();for(const he of Y)if(he===Z||Z.includes(he)||he.includes(Z))return!0;return!1},R=s.filter(Q=>{var H,W,re;return Q.status==="completed"&&Q.process&&N(ee.process,Q.process)&&((H=Q.bankInfo)==null?void 0:H.accountHolder)&&((W=Q.bankInfo)==null?void 0:W.bankName)&&((re=Q.bankInfo)==null?void 0:re.accountNumber)}),j=new Map;R.forEach(Q=>{const H=`${Q.bankInfo.accountHolder}_${Q.bankInfo.bankName}_${Q.bankInfo.accountNumber}`;j.has(H)||j.set(H,{accountHolder:Q.bankInfo.accountHolder,bankName:Q.bankInfo.bankName,accountNumber:Q.bankInfo.accountNumber,itemName:Q.itemName||"",amount:Q.amount||0})}),J(Array.from(j.values()))}else J([])},[ee.process,s]),D.useEffect(()=>{var R;const N=((R=ee.accountHolder)==null?void 0:R.trim())||"";if(N.length>=1&&fe){const j=[],Q=new Set;Te.filter(H=>H.accountNumber&&H.accountNumber.trim()!=="").forEach(H=>{const W=H.name.trim(),re=W.toLowerCase(),Y=N.toLowerCase();re.startsWith(Y)&&!Q.has(re)&&(Q.add(re),j.push({name:W,bankName:H.bankName||"",accountNumber:H.accountNumber||"",source:"contractor"}))}),s.filter(H=>{var W;return H.status==="completed"&&((W=H.bankInfo)==null?void 0:W.accountHolder)}).forEach(H=>{const W=H.bankInfo.accountHolder.trim(),re=W.toLowerCase(),Y=N.toLowerCase();re.startsWith(Y)&&!Q.has(re)&&(Q.add(re),j.push({name:W,bankName:H.bankInfo.bankName||"",accountNumber:H.bankInfo.accountNumber||"",source:"payment"}))}),ue(j)}else ue([])},[ee.accountHolder,fe,Te,s]);const Ut=N=>{const R=N.split(`
`).map(Y=>Y.trim()).filter(Y=>Y),j={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},Q=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],H=Y=>{const Z=["","","","","","","",""];for(const he of Z)if(Y.endsWith(he)&&Y.length>he.length+1)return Y.slice(0,-he.length);return Y},W=Y=>{if(!Y||Y.length<2||Y.length>5||!/^[-]{2,5}$/.test(Y)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Y)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Y))return!1;if(Y.length>=2){const Je=Y.charAt(0),pt=Y.substring(0,2);if(["","","","","","",""].includes(pt)||Q.includes(Je))return!0}return Y.length>=2&&Y.length<=4},re=R.some(Y=>Y.includes(" ")||Y.includes(""));if(R.forEach((Y,Z)=>{if(Y.includes("")&&Y.includes(":")){const he=Y.match(/\s*:\s*(.+)/);he&&(j.itemName=he[1].trim())}if(Y.includes("")&&Y.includes(":")){const he=Y.match(/\s*:\s*(.+)/);he&&(j.bankInfo.accountHolder=he[1].trim())}if(Y.includes("")&&Y.includes(":")){const he=Y.match(/\s*:\s*(.+)/);he&&(j.bankInfo.bankName=he[1].trim())}if(Y.includes("")&&Y.includes(":")){const he=Y.match(/\s*:\s*(.+)/);he&&(j.bankInfo.accountNumber=he[1].trim())}if(Y.includes("")&&Y.includes(":")){const he=Y.match(/\s*:\s*([\d,]+)?/);he&&(j.amounts.total=parseInt(he[1].replace(/,/g,"")))}}),!re){let Y=-1;if(R.forEach(Z=>{const he=Z.match(/\[([^\]]+)\]/);he&&!j.itemName&&(j.itemName=he[1].trim())}),R.forEach((Z,he)=>{if(Z.includes("")||Z.includes(" ")||Z.includes("()")){j.includeVat=!0;const qe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/),Ce=Z.match(/(\d+)\s*\s*?/),rt=Z.match(/([\d,]+)\s*/);if(qe){const at=parseInt(qe[1])*1e4+parseInt(qe[2])*1e3;j.amounts.total=at}else if(Ce){const at=parseInt(Ce[1])*1e4;j.amounts.total=at}else if(rt){const at=parseInt(rt[1].replace(/,/g,""));at>=1e3&&(j.amounts.total=at)}return}const pt=Z.match(/=\s*([\d,]+)\s*?/);let Ke=null;if(pt){const qe=parseInt(pt[1].replace(/,/g,""));qe>=1e3&&(j.amounts.total=qe)}else{const qe=Z.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(qe){const Ce=parseInt(qe[1])*1e4,rt=parseInt(qe[2])*1e3,at=Ce+rt;Z.includes("")||Z.includes("")?j.amounts.material=at:Z.includes("")||Z.includes("")?j.amounts.labor=at:j.amounts.total||(j.amounts.total=at),Z=Z.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Ke=qe}else if(Ke=Z.match(/(\d+)\s*\s*?/),Ke){const Ce=parseInt(Ke[1])*1e4;Z.includes("")||Z.includes("")?j.amounts.material=Ce:Z.includes("")||Z.includes("")?j.amounts.labor=Ce:j.amounts.total||(j.amounts.total=Ce),Z=Z.replace(/(\d+)\s*\s*?/g,"")}}Z.includes("/")&&Z.split("/").forEach(Ce=>{const rt=Ce.trim();rt.startsWith("[")||rt.endsWith("]")||(/^[\d\-]+$/.test(rt)&&rt.replace(/\-/g,"").length>=10?j.bankInfo.accountNumber||(j.bankInfo.accountNumber=rt):W(rt)&&!j.bankInfo.accountHolder&&(j.bankInfo.accountHolder=rt))});const _e=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let ot="",Hs=-1;for(const qe of _e){const Ce=Z.match(qe);if(Ce&&!j.bankInfo.accountNumber){ot=Ce[0],Hs=Ce.index||-1,j.bankInfo.accountNumber=Ce[0].trim().replace(/\s+/g,"-");const at=Z.substring(Hs+ot.length).trim().split(/\s+/);for(const dt of at){if(dt.startsWith("[")||dt.endsWith("]"))continue;const Ue=H(dt);if(W(Ue)){j.bankInfo.accountHolder=Ue;break}}if(!j.bankInfo.accountHolder&&he>0){const Ue=R[he-1].split(/\s+/);for(const tt of Ue){if(tt.startsWith("[")||tt.endsWith("]"))continue;const Rt=H(tt);if(W(Rt)){j.bankInfo.accountHolder=Rt;break}}}if(!j.bankInfo.accountHolder&&he+1<R.length){const dt=R[he+1],Ue=dt.split(/\s+/);for(const tt of Ue){if(tt.startsWith("[")||tt.endsWith("]"))continue;const Rt=H(tt);if(W(Rt)){j.bankInfo.accountHolder=Rt;break}}if(!j.bankInfo.accountHolder){const tt=dt.match(/^([-]{2,6})/);if(tt){const Rt=H(tt[1].trim());W(Rt)&&(j.bankInfo.accountHolder=Rt)}}}break}}const Ls=Z.match(/[\d,]+/g);if(Ls){const qe=ot?ot.split(/[\s\-]+/).filter(Ce=>Ce):[];Ls.forEach(Ce=>{const rt=parseInt(Ce.replace(/,/g,"")),at=Ce.replace(/,/g,""),dt=qe.some(Ue=>Ue===at);!j.bankInfo.accountNumber&&at.length>=10&&at.length<=20?(j.bankInfo.accountNumber=at,ot=at):rt>=1e3&&!Ke&&!dt&&(Z.includes("")||Z.includes("")?j.amounts.material=rt:Z.includes("")||Z.includes("")?j.amounts.labor=rt:j.amounts.total||(j.amounts.total=rt))})}const nn={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},ts=Object.keys(nn).sort((qe,Ce)=>Ce.length-qe.length);for(const qe of ts)if(Z.includes(qe)){const Ce=nn[qe];j.bankInfo.bankName=Ce,Y=he;const rt=new RegExp(`${qe}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),at=Z.match(rt);if(at){const dt=H(at[1]);dt&&!/^\d+$/.test(dt)&&dt!==""&&(j.bankInfo.accountHolder=dt)}break}if(!j.bankInfo.bankName){const qe=Z.match(/([-]+)(|)/);qe&&(j.bankInfo.bankName=qe[0])}const Ms=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const qe of Ms){const Ce=Z.match(qe);if(Ce&&!j.bankInfo.accountHolder){j.bankInfo.accountHolder=Ce[0].trim();break}}const ss=Z.match(/\(([-]{2,5})\)/);if(ss&&!j.bankInfo.accountHolder){const qe=ss[1];W(qe)&&!["","",""].includes(qe)&&(j.bankInfo.accountHolder=qe)}if(!j.bankInfo.accountHolder){const qe=/[-]{2,6}/g,Ce=Z.match(qe);if(Ce){const rt=Z.match(/\d{10,}/)||Z.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),at=Z.match(/||||/);Ce.forEach(dt=>{const Ue=H(dt),tt=N.split(`
`)[he];if(tt&&tt.includes(`[${dt}]`)||!W(Ue)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Ue))return;const Qe=Z.indexOf(dt);if(Qe>0){const hs=Z[Qe-1];if(/[-]/.test(hs))return}if(Qe+dt.length<Z.length){const hs=Z[Qe+dt.length];if(/[-]/.test(hs))return}if(!(ss&&Ue===ss[1])){if((rt||at)&&!j.bankInfo.accountHolder)j.bankInfo.accountHolder=Ue;else if(!j.bankInfo.accountHolder){const hs=/||||/,_n=/\d{6,}/;(he>0&&(_n.test(R[he-1])||hs.test(R[he-1]))||he<R.length-1&&(_n.test(R[he+1])||hs.test(R[he+1]))||hs.test(Z))&&(j.bankInfo.accountHolder=Ue)}}})}}const yt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[qe,Ce]of Object.entries(yt))if(Z.includes(qe)){j.vendor=Ce;break}if(he===0&&!j.itemName){const qe=Z.replace(/[\[\]{}()<>]/g,"").trim();qe&&!qe.includes(" ")&&(W(qe)||(j.itemName=qe.substring(0,50)))}}),Y>=0&&Y+1<R.length){const Z=R[Y+1],he=Z.trim();if(/^[-]{2,5}$/.test(he)&&W(he))j.bankInfo.accountHolder=he;else{const Je=Z.split(/\s+/);for(const pt of Je){const Ke=H(pt);if(W(Ke)){j.bankInfo.accountHolder=Ke;break}}}}}if(j.itemName&&j.itemName.includes("")&&(j.vendor=""),j.itemName){const Y=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],Z=j.itemName.toLowerCase(),he=Y.some(_e=>Z===_e.toLowerCase()||Z.startsWith(_e.toLowerCase()+" ")||Z.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Je=/^[\d\-\s]/.test(j.itemName),pt=/^\d{2,}[\s\-]?\d+/.test(j.itemName.replace(/[-]/g,"").trim()),Ke=j.bankInfo.accountHolder&&(j.itemName===j.bankInfo.accountHolder||j.itemName.includes(j.bankInfo.accountHolder));(he||Je||pt||Ke)&&(j.itemName=void 0)}return j},At=async()=>{var N,R,j,Q,H,W,re,Y,Z,he,Je;try{const pt=ee.quickText;if(!pt.trim())return;let Ke=s;s.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(Ce=>setTimeout(Ce,100)),Ke=or.getState().payments,console.log("payments  :",Ke.length,""));const _e=Ut(pt);console.log("  :",_e);const ot={project:ee.project,date:ee.date,quickText:ee.quickText,quickImages:ee.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};L(null),T(!1),oe(!1);let Hs=0;_e.amounts.material&&(Hs+=_e.amounts.material),_e.amounts.labor&&(Hs+=_e.amounts.labor),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&(Hs=_e.amounts.total),Hs>0&&(ot.amount=Hs),_e.bankInfo.bankName&&(ot.bankName=_e.bankInfo.bankName),_e.bankInfo.accountHolder&&(ot.accountHolder=_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&(ot.accountNumber=_e.bankInfo.accountNumber);const Ls=Ce=>Ce?Ce.replace(/[^0-9]/g,""):"",nn=(Ce,rt)=>{if(!Ce||!rt)return!1;const at=Ls(Ce),dt=Ls(rt);if(!at||!dt)return!1;const Ue=6;return at.length<Ue||dt.length<Ue?at===dt:dt.includes(at)||at.includes(dt)},ts=Ls(_e.bankInfo.accountNumber||""),Ms=_e.bankInfo.accountHolder||"";let ss=!1;console.log("===    ==="),console.log(" :",_e.bankInfo.accountNumber),console.log(" :",ts),console.log(" :",Ms),console.log(" :",Te.length),console.log("  :",Ke.filter(Ce=>Ce.status==="completed").length);let yt=Te.find(Ce=>{const rt=Ls(Ce.accountNumber||"");return rt&&rt===ts});if(!yt&&ts&&(yt=Te.find(Ce=>{const rt=Ls(Ce.accountNumber||"");return nn(ts,rt)})),yt&&(ss=!0),!yt&&Ms&&(yt=Te.find(Ce=>Ce.name===Ms),yt)){console.log("  :",yt.name);const Ce=((N=yt.accountNumber)==null?void 0:N.replace(/[-\s]/g,""))||"";ts&&!nn(ts,Ce)?(console.log("    ( ) -  "),ss=!1):ss=!0}if(yt&&(yt.name&&(ot.accountHolder=yt.name,console.log("  :",yt.name)),yt.bankName?ot.bankName=yt.bankName:_e.bankInfo.bankName&&(ot.bankName=_e.bankInfo.bankName),ss&&(ot.accountNumber=yt.accountNumber||_e.bankInfo.accountNumber),L(yt.id||yt._id||null),yt.process&&(ot.process=yt.process)),!yt){let Ce=!1;console.log("===     ==="),console.log("  payments :",Ke.length,""),console.log(" :",ts),console.log(" :",Ms);const rt=Ke.filter(tt=>tt.status==="completed");console.log(" :",rt.length);const at=[...new Set(rt.map(tt=>{var Rt;return(Rt=tt.bankInfo)==null?void 0:Rt.accountHolder}).filter(Boolean))];console.log("   ( 20):",at.slice(0,20)),console.log("  ():",ts);const dt=rt.filter(tt=>{var Rt;return(Rt=tt.bankInfo)==null?void 0:Rt.accountNumber}).map(tt=>{var Rt,Qe,hs;return{holder:(Rt=tt.bankInfo)==null?void 0:Rt.accountHolder,account:(Qe=tt.bankInfo)==null?void 0:Qe.accountNumber,clean:Ls(((hs=tt.bankInfo)==null?void 0:hs.accountNumber)||"")}}).filter(tt=>tt.clean.includes(ts.substring(0,6))||ts.includes(tt.clean.substring(0,6)));console.log("  :",dt);let Ue=Ke.find(tt=>{var hs;const Rt=Ls(((hs=tt.bankInfo)==null?void 0:hs.accountNumber)||"");return Rt&&Rt===ts&&tt.status==="completed"});if(Ue&&console.log("   :",(R=Ue.bankInfo)==null?void 0:R.accountHolder,Ue.process),!Ue&&ts&&(Ue=Ke.find(tt=>{var Qe;const Rt=Ls(((Qe=tt.bankInfo)==null?void 0:Qe.accountNumber)||"");return nn(ts,Rt)&&tt.status==="completed"}),Ue&&console.log("   :",(j=Ue.bankInfo)==null?void 0:j.accountHolder,Ue.process)),Ue&&(Ce=!0),!Ue&&Ms&&(Ue=Ke.find(tt=>{var Rt;return((Rt=tt.bankInfo)==null?void 0:Rt.accountHolder)===Ms&&tt.status==="completed"}),Ue)){console.log("    :",(Q=Ue.bankInfo)==null?void 0:Q.accountHolder,":",Ue.process);const tt=Ls(((H=Ue.bankInfo)==null?void 0:H.accountNumber)||"");ts&&!nn(ts,tt)?(console.log("    ( ) -  "),Ce=!1):Ce=!0}Ue?(console.log(" :",{accountHolder:(W=Ue.bankInfo)==null?void 0:W.accountHolder,accountNumber:(re=Ue.bankInfo)==null?void 0:re.accountNumber,bankName:(Y=Ue.bankInfo)==null?void 0:Y.bankName,process:Ue.process,status:Ue.status,paymentMatchedByAccountNumber:Ce}),(Z=Ue.bankInfo)!=null&&Z.accountHolder&&(ot.accountHolder=Ue.bankInfo.accountHolder,console.log("  :",Ue.bankInfo.accountHolder)),(he=Ue.bankInfo)!=null&&he.bankName?ot.bankName=Ue.bankInfo.bankName:_e.bankInfo.bankName&&(ot.bankName=_e.bankInfo.bankName),Ce&&(ot.accountNumber=((Je=Ue.bankInfo)==null?void 0:Je.accountNumber)||_e.bankInfo.accountNumber),Ue.process&&!ot.process?(ot.process=Ue.process,console.log("    :",Ue.process)):console.log("   - process:",Ue.process,"updatedFormData.process:",ot.process)):console.log("  ")}if(_e.vendor&&(ot.process=_e.vendor),!ot.process){const Ce=pt.toLowerCase();for(const rt of Xc)if(Ce.includes(rt.toLowerCase())){ot.process=rt;break}}_e.itemName&&(ot.itemName=_e.itemName),Ge(ot),_e.includeVat&&(T(!0),oe(!1));const qe=[];if(_e.amounts.material||_e.amounts.labor||_e.amounts.total){const Ce=[];_e.amounts.material&&Ce.push(`: ${_e.amounts.material.toLocaleString()}`),_e.amounts.labor&&Ce.push(`: ${_e.amounts.labor.toLocaleString()}`),_e.amounts.total&&!_e.amounts.material&&!_e.amounts.labor&&Ce.push(`: ${_e.amounts.total.toLocaleString()}`),qe.push(Ce.join(", "))}if(_e.bankInfo.bankName||_e.bankInfo.accountHolder){const Ce=[];_e.bankInfo.bankName&&Ce.push(_e.bankInfo.bankName),_e.bankInfo.accountHolder&&Ce.push(_e.bankInfo.accountHolder),_e.bankInfo.accountNumber&&Ce.push(_e.bankInfo.accountNumber),Ce.length>0&&qe.push(`: ${Ce.join(" ")}`)}_e.vendor&&qe.push(`: ${_e.vendor}`),_e.includeVat&&qe.push("  "),qe.length>0?se.success(`  !
${qe.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):se.info("  ...    .")}catch(pt){console.error(" :",pt),se.error("   .")}};D.useEffect(()=>{(async()=>{try{await zw();const R=await qw();et(R),Bs(!0)}catch(R){console.error("  :",R),Bs(!0)}})()},[]);const Qt=D.useRef({});D.useEffect(()=>{Ee&&(Object.entries(Oe).forEach(([N,R])=>{JSON.stringify(Qt.current[N])!==JSON.stringify(R)&&$w(N,R).catch(j=>{console.error("  :",j),se.error("  ")})}),Qt.current={...Oe})},[Oe,Ee]);const vt=D.useCallback(async N=>{var Q;const R=(Q=N.clipboardData)==null?void 0:Q.items;if(!R)return;let j=!1;for(let H=0;H<R.length;H++)if(R[H].type.indexOf("image")!==-1){j=!0;break}if(j){if(!f){const H=document.activeElement;(H==null?void 0:H.tagName)==="INPUT"||(H==null?void 0:H.tagName)==="TEXTAREA"||(H==null?void 0:H.classList.contains("form-input"))||se.error("  ");return}for(let H=0;H<R.length;H++)if(R[H].type.indexOf("image")!==-1){N.preventDefault();const W=R[H].getAsFile();if(W){const re=new FileReader;re.onload=async Y=>{var he;const Z=(he=Y.target)==null?void 0:he.result;if(Z)try{const Je=s.find(_e=>_e.id===f),Ke=[...(Je==null?void 0:Je.images)||Oe[f]||[],Z];await mn.updatePaymentImages(f,Ke),et(_e=>({..._e,[f]:Ke})),await e(),se.success(" ")}catch(Je){console.error("  :",Je),se.error("  ")}},re.readAsDataURL(W)}}}},[f,s,Oe,e]);D.useEffect(()=>(document.addEventListener("paste",vt),()=>document.removeEventListener("paste",vt)),[vt]);const zt=[...(l==null?void 0:l.name)===""?s.filter(N=>u.some(R=>R.name===N.project)):s].sort((N,R)=>new Date(R.requestDate).getTime()-new Date(N.requestDate).getTime()),ps=zt.filter(N=>{var W,re,Y;if(!N||!N.id)return!1;const R=m===""||((W=N.purpose)==null?void 0:W.toLowerCase().includes(m.toLowerCase()))||((re=N.itemName)==null?void 0:re.toLowerCase().includes(m.toLowerCase()))||((Y=N.process)==null?void 0:Y.toLowerCase().includes(m.toLowerCase())),j=ye==="pending"?N.status!=="completed":N.status==="completed",Q=gt==="all"||!gt||N.project===gt,H=!Ft||ye!=="completed"||N.requestedBy===(l==null?void 0:l.username);return R&&j&&Q&&H}).sort((N,R)=>!N&&!R?0:N?R?ye==="completed"?sl(R.completionDate)-sl(N.completionDate):sl(R.requestDate)-sl(N.requestDate):-1:1),gn=N=>{const R=N.id||N._id||null;if(mt===R){L(null);const W=document.querySelector('input[placeholder=" "]');W&&setTimeout(()=>{W.focus()},100);return}L(R);const j=Xo(N.name);let Q=N.bankName||"",H=N.accountNumber||"";if(H&&!Q){const W=H.trim().split(/\s+/);if(W.length>=2){const re=W[0];(re.includes("")||re.includes("")||re.includes("")||re.includes("")||re.includes(""))&&(Q=re,H=W.slice(1).join(""))}}Ge(W=>({...W,accountHolder:j,bankName:Q,accountNumber:H}))};ps.reduce((N,R)=>{const j=R.materialAmount||0,Q=R.laborAmount||0,H=R.amount||0;let W=j,re=Q,Y=0;return j===0&&Q===0&&H>0?R.includesVAT?(W=Math.round(H/1.1),Y=H-W):(W=H,Y=0):R.includesVAT?(j>0&&(W=Math.round(j/1.1)),Q>0&&(re=Math.round(Q/1.1)),Y=H-(W+re)):Y=0,N.material+=W,N.labor+=re,N.vat+=Y,N.total+=H,N},{material:0,labor:0,vat:0,total:0});const Js=async()=>{var R,j,Q;if(ft){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ee),!ee.project){se.error(" ");return}if(!ee.itemName){se.error(" ");return}const N=Number(ee.amount)||0;if(N===0){se.error(" ");return}us(!0);try{const H=q?Math.round(N*.967):N,W=new Date;if(y){const re={project:ee.project,requestDate:new Date(ee.date),purpose:ee.itemName,amount:H,category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:q,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,updatedAt:W};console.log(" Updating payment:",re),await i(y,re),se.success(" "),C(null)}else{const re=ee.project||"",Y={id:`payment_${Date.now()}`,project:re,requestDate:new Date(ee.date),requestedBy:(l==null?void 0:l.username)||"  ",purpose:ee.itemName,amount:H,status:"pending",category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:B,applyTaxDeduction:q,materialAmount:H,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,quickText:ee.quickText||"",images:ee.quickImages,attachments:[],createdAt:W,updatedAt:W};console.log(" Creating payment:",Y),console.log(" Images in payment:",((R=ee.quickImages)==null?void 0:R.length)||0,"");const Z=await n(Y);if(Fe.current=Z,setTimeout(()=>{Fe.current=null},1e4),se.success(" "),ee.accountHolder&&ee.bankName&&ee.accountNumber){const he=B||q?"01074088864":"01089423283";try{await mn.sendTossPaymentSms({recipientPhone:he,accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber,amount:H,projectName:re,itemName:ee.itemName,process:ee.process,paymentId:Z}),se.success("   ")}catch(Je){console.error("SMS  :",Je),se.error("  : "+(((Q=(j=Je.response)==null?void 0:j.data)==null?void 0:Q.error)||Je.message||"   "))}}}Ge(re=>({project:re.project,date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),oe(!1),L(null),window.innerWidth<768&&P("list")}catch(H){console.error(" Payment save error:",H),se.error("  : "+H.message)}finally{us(!1)}},yn=N=>{var R,j,Q,H;try{console.log("[handleEdit] Starting edit for payment:",N.id);const W=N.originalMaterialAmount!==void 0?N.originalMaterialAmount:N.materialAmount||0,re=N.originalLaborAmount!==void 0?N.originalLaborAmount:N.laborAmount||0,Y={project:N.project||"",date:N.requestDate?qt(new Date(N.requestDate),"yyyy-MM-dd"):qt(new Date,"yyyy-MM-dd"),process:N.process||"",itemName:N.itemName||N.purpose||"",materialCost:W>0?W.toString():"",laborCost:re>0?re.toString():"",amount:((R=N.amount)==null?void 0:R.toString())||"",accountHolder:((j=N.bankInfo)==null?void 0:j.accountHolder)||"",bankName:((Q=N.bankInfo)==null?void 0:Q.bankName)||"",accountNumber:((H=N.bankInfo)==null?void 0:H.accountNumber)||"",images:N.attachments||[],quickText:N.quickText||"",quickImages:N.images||[]};console.log("[handleEdit] Setting form data:",Y),Ge(Y),T(N.includesVAT||!1),oe(N.applyTaxDeduction||!1),h(N.id),C(N.id),S&&P("form"),console.log("[handleEdit] Edit setup complete"),se.success("  ")}catch(W){console.error("[handleEdit] Error:",W),se.error("     ")}},Gr=async N=>{var R,j,Q;try{const H=((R=N.bankInfo)==null?void 0:R.accountHolder)||N.accountHolder,W=((j=N.bankInfo)==null?void 0:j.bankName)||N.bank,re=((Q=N.bankInfo)==null?void 0:Q.accountNumber)||N.accountNumber;if(!H||!W||!re){se.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${W}
: ${re}
: ${N.amount.toLocaleString()}`))return;const Z=re.replace(/[-\s]/g,""),he=h1[W]||W,Je=p1[W]||"004",pt="",Ke=`supertoss://send?amount=${N.amount}&bankCode=${Je}&bank=${encodeURIComponent(he)}&accountNo=${Z}&receiverName=${encodeURIComponent(pt)}&toName=${encodeURIComponent(pt)}`;let _e=!1;try{window.location.href=Ke,_e=!0,se.success("  ...",{duration:3e3}),setTimeout(()=>{const ot=/iPhone|iPad|iPod/i.test(navigator.userAgent),Hs=/Android/i.test(navigator.userAgent);(ot||Hs)&&se(`      .

: 
: ${re}
: ${N.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(ot){console.error("   :",ot),se(`   .

: 
: ${W}
: ${re}
: ${N.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(H){console.error(" :",H),se.error(`   : ${H.message}`)}},jn=async N=>{const R=s.find(j=>j.id===N);if(R&&R.quickText){const j=localStorage.getItem("executionMemos"),Q=j?JSON.parse(j):{};Q[N]=R.quickText,localStorage.setItem("executionMemos",JSON.stringify(Q))}o(N,{status:"completed",completionDate:new Date}),de(!1),Be("completed"),se.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(N,{status:"completed"});const j=Rl.getSocket();j&&j.emit("payment:refresh",{paymentId:N,status:"completed",projectName:(R==null?void 0:R.project)||"",itemName:(R==null?void 0:R.itemName)||(R==null?void 0:R.purpose)||"",completedBy:(l==null?void 0:l.username)||""})}catch(j){console.error(" API :",j),o(N,{status:"pending",completionDate:void 0}),Be("pending"),se.error("   -  ")}},sn=async N=>{var Q;if(!f){se.error("  ");return}const j=Array.from(((Q=N.target)==null?void 0:Q.files)||[]).filter(H=>H.type.startsWith("image/"));if(j.length!==0){try{const H=await Promise.all(j.map(Z=>new Promise((he,Je)=>{const pt=new FileReader;pt.onload=Ke=>{var ot;const _e=(ot=Ke.target)==null?void 0:ot.result;_e?he(_e):Je(new Error("  "))},pt.onerror=()=>Je(new Error("FileReader ")),pt.readAsDataURL(Z)}))),W=s.find(Z=>Z.id===f),Y=[...(W==null?void 0:W.images)||Oe[f]||[],...H];await mn.updatePaymentImages(f,Y),et(Z=>({...Z,[f]:Y})),await e(),se.success(`${H.length}  `)}catch(H){console.error("  :",H),se.error("  ")}N.target.value=""}},Rn=async N=>{if(f)try{const R=s.find(H=>H.id===f),Q=((R==null?void 0:R.images)||Oe[f]||[]).filter((H,W)=>W!==N);await mn.updatePaymentImages(f,Q),et(H=>({...H,[f]:Q})),await e()}catch(R){console.error("  :",R),se.error("  ")}},Us=N=>{x(N),O(!0)},Ts=N=>{N.preventDefault(),V(!0)},I=N=>{N.preventDefault(),V(!1)},pe=async N=>{if(N.preventDefault(),V(!1),!f){se.error("  ");return}const j=Array.from(N.dataTransfer.files).filter(Q=>Q.type.startsWith("image/"));if(j.length!==0)try{const Q=await Promise.all(j.map(Y=>new Promise((Z,he)=>{const Je=new FileReader;Je.onload=pt=>{var _e;const Ke=(_e=pt.target)==null?void 0:_e.result;Ke?Z(Ke):he(new Error("  "))},Je.onerror=()=>he(new Error("FileReader ")),Je.readAsDataURL(Y)}))),H=s.find(Y=>Y.id===f),re=[...(H==null?void 0:H.images)||Oe[f]||[],...Q];await mn.updatePaymentImages(f,re),et(Y=>({...Y,[f]:re})),await e(),se.success(`${Q.length}  `)}catch(Q){console.error("  :",Q),se.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ee.project,onChange:N=>{Ge({...ee,project:N.target.value}),N.target.value&&localStorage.setItem("lastSelectedProject",N.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2526,columnNumber:35},void 0),u.filter(N=>N.status!=="completed").map(N=>a.jsxDEV("option",{value:N.name,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2528,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2516,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2515,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>P("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2537,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>P("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2547,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>P("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${A==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2536,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2535,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2534,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${A!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ee.project,onChange:N=>{Ge({...ee,project:N.target.value}),N.target.value&&localStorage.setItem("lastSelectedProject",N.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2592,columnNumber:43},void 0),u.filter(N=>N.status!=="completed").map(N=>a.jsxDEV("option",{value:N.name,children:N.name},N.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2594,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2582,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:N=>Ge({...ee,bankName:N.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2602,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2603,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2604,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2605,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2606,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2607,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2608,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2609,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2610,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2611,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2612,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2613,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2614,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2597,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2581,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2580,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ee.quickText,onChange:N=>Ge({...ee,quickText:N.target.value}),onPaste:N=>{var j;const R=(j=N.clipboardData)==null?void 0:j.items;if(R){for(let Q=0;Q<R.length;Q++)if(R[Q].type.indexOf("image")!==-1){N.preventDefault();const H=R[Q].getAsFile();if(H){const W=new FileReader;W.onload=re=>{var Z;const Y=(Z=re.target)==null?void 0:Z.result;Ge(he=>({...he,quickImages:[...he.quickImages,Y]}))},W.readAsDataURL(H)}break}}},onDragOver:N=>{N.preventDefault(),N.stopPropagation()},onDrop:N=>{N.preventDefault(),N.stopPropagation(),Array.from(N.dataTransfer.files).filter(Q=>Q.type.startsWith("image/")).forEach(Q=>{const H=new FileReader;H.onload=W=>{var Y;const re=(Y=W.target)==null?void 0:Y.result;Ge(Z=>({...Z,quickImages:[...Z.quickImages,re]}))},H.readAsDataURL(Q)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:S?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2621,columnNumber:15},void 0),ee.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ee.quickImages.map((N,R)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:N,alt:` ${R+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2676,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Ge(j=>({...j,quickImages:j.quickImages.filter((Q,H)=>H!==R)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2681,columnNumber:23},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2675,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2673,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:N=>{Array.from(N.target.files||[]).forEach(j=>{const Q=new FileReader;Q.onload=H=>{var re;const W=(re=H.target)==null?void 0:re.result;Ge(Y=>({...Y,quickImages:[...Y.quickImages,W]}))},Q.readAsDataURL(j)}),N.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2700,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2699,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:At,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2725,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2698,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2620,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ee.date&&`(${qt(new Date(ee.date),"E",{locale:xs})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2738,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ee.date,onChange:N=>Ge({...ee,date:N.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2741,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2737,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:17},void 0),a.jsxDEV("button",{ref:He,type:"button",onClick:()=>Ae(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ee.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2764,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2758,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2756,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2736,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2771,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ee.itemName,onChange:N=>Ge({...ee,itemName:N.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2772,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2770,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2783,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ee.amount?Number(ee.amount).toLocaleString():"",onChange:N=>{const R=N.target.value.replace(/[^0-9]/g,"");Ge({...ee,amount:R})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2785,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2796,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2784,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2782,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:N=>N.preventDefault(),onClick:()=>{B||oe(!1),T(!B)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${B?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:B&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2814,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2813,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2802,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:N=>N.preventDefault(),onClick:()=>{q||T(!1),oe(!q)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${q?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:q&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2832,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2831,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2834,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2820,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2801,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2781,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(Lt.length>0||F.length>0&&!mt)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${Lt.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2850,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:Lt.map(N=>{const R=N.id||N._id,j=mt===R;return a.jsxDEV("button",{type:"button",onClick:()=>gn(N),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${j?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Xo(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2866,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[N.bankName||""," ",N.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2869,columnNumber:29},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2856,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2847,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${F.length===0||mt?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2882,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:F.map((N,R)=>a.jsxDEV("button",{type:"button",onClick:()=>{Ge(j=>({...j,accountHolder:N.accountHolder,bankName:N.bankName,accountNumber:N.accountNumber})),J([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:N.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2899,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[N.bankName," ",N.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2902,columnNumber:27},void 0)]},R,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2885,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2883,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2879,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2845,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2914,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountHolder,onChange:N=>Ge({...ee,accountHolder:N.target.value}),onFocus:()=>we(!0),onBlur:()=>setTimeout(()=>we(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2915,columnNumber:17},void 0),fe&&xe.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:xe.map((N,R)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:j=>j.preventDefault(),onClick:()=>{let j=N.bankName||"",Q=N.accountNumber||"";const H=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],W={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const re of H)if(Q.includes(re)){j||(j=W[re]||re),Q=Q.replace(re,"").trim();break}for(const re of H)if(j.includes(re)){const Y=W[re]||re,Z=j.replace(re,"").trim();Z&&/\d/.test(Z)&&(Q=Z),j=Y;break}Q=Q.replace(/[^\d\-]/g,"").trim(),Ge({...ee,accountHolder:N.name,bankName:j||ee.bankName,accountNumber:Q||ee.accountNumber}),we(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:N.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3015,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:N.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3016,columnNumber:25},void 0)]},`${N.name}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2928,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2926,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2913,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:N=>Ge({...ee,bankName:N.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3034,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3038,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3039,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3040,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3041,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3042,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3043,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3044,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3045,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3046,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3047,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3048,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3049,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3050,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3051,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3052,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3053,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3054,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3055,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3028,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3060,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountNumber,onChange:N=>Ge({...ee,accountNumber:N.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3061,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3059,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3072,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(B||q)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",B&&" ",q&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3075,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const N=Number(ee.amount)||0;let R=N;return q&&(R=Math.round(N*.967)),R.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3079,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3073,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3071,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3070,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{C(null),Ge(N=>({project:N.project,date:qt(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),T(!1),oe(!1),L(null),se.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3098,columnNumber:19},void 0),a.jsxDEV("button",{onClick:N=>{console.log(" Payment button clicked!",N),console.log(" Button element:",N.currentTarget),console.log(" Form data:",ee),Js()},disabled:ft,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${ft?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:ft?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3127,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3096,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2842,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2578,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2575,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${A!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>Be("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ye==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ye==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:zt.filter(N=>N&&N.id&&N.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3166,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3157,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Be("completed"),Ge(N=>({...N,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${ye==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${ye==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:zt.filter(N=>N&&N.id&&N.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3172,columnNumber:17},void 0),ye==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ft,onChange:N=>{ae(N.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(N.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3194,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3193,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3156,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3155,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3154,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3209,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:ps.length>0?a.jsxDEV("div",{className:"space-y-4",children:ps.map(N=>{var re,Y,Z;const R=N.amount||0,j=((re=N.bankInfo)==null?void 0:re.accountHolder)||N.accountHolder||"",Q=((Y=N.bankInfo)==null?void 0:Y.bankName)||N.bank||"",H=((Z=N.bankInfo)==null?void 0:Z.accountNumber)||N.accountNumber||"",W=j&&Q&&H?`${j} | ${Q} ${H}`:" ";return a.jsxDEV("div",{onClick:()=>h(N.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===N.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[N.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",N.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3241,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:N.purpose||N.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3243,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3239,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:N.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3238,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[R.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[N.requestedBy||"-","  ",Wp(N.requestDate,"MM/dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3253,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3249,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3237,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(N.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3261,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3262,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(N.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3263,columnNumber:25},void 0),N.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3266,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3267,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3265,columnNumber:27},void 0),N.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3272,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3273,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3271,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3260,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:W},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3280,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:he=>{he.stopPropagation(),yn(N)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(LN,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3292,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3284,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async he=>{he.stopPropagation(),window.confirm("  ?")&&(await r(N.id),se.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ai,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3305,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3294,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3283,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3279,columnNumber:23},void 0),ye==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:he=>{if(he.stopPropagation(),N.status==="completed"){se.info("   ");return}Gr(N)},disabled:N.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${N.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:N.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3314,columnNumber:27},void 0),a.jsxDEV("button",{onClick:he=>{he.stopPropagation(),jn(N.id)},disabled:N.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${N.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:N.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:he=>{N.status!=="completed"&&(he.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:he=>{N.status!=="completed"&&(he.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3332,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3313,columnNumber:25},void 0)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3227,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3213,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3363,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3211,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3150,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${A!=="image"?"hidden lg:flex":""}`,onDragOver:Ts,onDragLeave:I,onDrop:pe,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:sn,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3379,columnNumber:11},void 0),S&&f&&A==="image"&&(()=>{const N=zt.find(R=>R.id===f);return N?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:N.purpose||N.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3396,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[N.process||"-","  ",Wp(N.requestDate,"yyyy.MM.dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3397,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3395,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(N.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3401,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3394,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3393,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:N=>{var j;const R=N.target;if(!R.closest("img")&&!R.closest("button")&&f){const Q=zt.find(Y=>Y.id===f),H=(Q==null?void 0:Q.images)||[],W=Oe[f]||[];(H.length>0?H:W).length>0&&((j=document.getElementById("image-file-input"))==null||j.click())}},children:f?(()=>{const N=zt.find(H=>H.id===f),R=(N==null?void 0:N.images)||[],j=Oe[f]||[],Q=R.length>0?R:j;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3437,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(N==null?void 0:N.quickText)||(N==null?void 0:N.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3438,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3436,columnNumber:19},void 0),Q.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:Q.map((H,W)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:H,alt:` ${W+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:re=>{re.stopPropagation(),Us(H)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3452,columnNumber:27},void 0),a.jsxDEV("button",{onClick:re=>{re.stopPropagation(),Rn(W)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(vs,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3468,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3461,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[W+1,"/",Q.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3470,columnNumber:27},void 0)]},W,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3451,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3449,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${Q.length>0?"":"flex-1"}`,onClick:H=>H.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${Q.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(tu,{className:`mx-auto text-gray-400 mb-1 ${Q.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3489,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:Q.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3490,columnNumber:23},void 0),Q.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3494,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3484,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3479,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3434,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(jo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3503,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3504,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3502,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3501,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3411,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3371,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2572,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3519,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ae(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3524,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3520,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3518,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Xc.map(N=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:N}),Ae(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ee.process===N?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3531,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3529,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),Ae(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3548,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3528,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3517,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3516,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>Ae(!1),children:a.jsxDEV("div",{onClick:N=>N.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:He.current?`${He.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:He.current?`${He.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3572,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Ae(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3577,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3573,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3571,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Xc.map(N=>a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:N}),Ae(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ee.process===N?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:N},N,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3584,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3582,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ge({...ee,process:""}),Ae(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3601,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3581,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3563,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3562,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:9},void 0),te&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>O(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:N=>{N.stopPropagation(),O(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(vs,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3630,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3623,columnNumber:13},void 0),a.jsxDEV("img",{src:E,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:N=>N.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3632,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3622,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3618,columnNumber:9},void 0),xt&&a.jsxDEV(Mw,{projectName:Tt,onClose:()=>it(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3644,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2513,columnNumber:5},void 0)},ei=s=>s?typeof s=="string"?s:s instanceof ve?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),bn={async getSpaces(s){const e=$e(ne,"finish_check_spaces");let t;s?t=_t(e,Rs("project_id","==",s)):t=_t(e);const r=(await St(t)).docs.sort((o,l)=>(o.data().display_order||0)-(l.data().display_order||0)),i=[];for(const o of r){const l=o.data(),u=$e(ne,"finish_check_items"),m=_t(u,Rs("space_id","==",o.id)),f=(await St(m)).docs.sort((y,C)=>(y.data().display_order||0)-(C.data().display_order||0)),h=[];for(const y of f){const C=y.data(),v=$e(ne,"finish_check_images"),V=_t(v,Rs("item_id","==",y.id)),T=(await St(V)).docs.map(q=>({id:q.id,item_id:y.id,filename:q.data().filename||null,created_at:ei(q.data().created_at)}));h.push({id:y.id,space_id:o.id,content:C.content||"",is_completed:C.is_completed||0,is_priority:C.is_priority||0,completed_at:C.completed_at?ei(C.completed_at):null,display_order:C.display_order||0,created_at:ei(C.created_at),updated_at:ei(C.updated_at),images:T})}i.push({id:o.id,name:l.name||"",project_id:l.project_id||null,display_order:l.display_order||0,created_at:ei(l.created_at),updated_at:ei(l.updated_at),items:h})}return i},async createSpace(s,e){const t=$e(ne,"finish_check_spaces"),n=_t(t,Rs("project_id","==",e)),i=(await St(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={name:s,project_id:e,display_order:i+1,created_at:is(),updated_at:is()};return{id:(await Qn(t,o)).id,name:s,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(s,e){const t=Le(ne,"finish_check_spaces",s);await Mt(t,{name:e,updated_at:is()})},async deleteSpace(s){const e=$e(ne,"finish_check_items"),t=_t(e,Rs("space_id","==",s)),n=await St(t);for(const r of n.docs){const i=$e(ne,"finish_check_images"),o=_t(i,Rs("item_id","==",r.id)),l=await St(o);for(const u of l.docs)await Fs(Le(ne,"finish_check_images",u.id));await Fs(Le(ne,"finish_check_items",r.id))}await Fs(Le(ne,"finish_check_spaces",s))},async createItem(s,e){const t=$e(ne,"finish_check_items"),n=_t(t,Rs("space_id","==",s)),i=(await St(n)).docs.reduce((u,m)=>Math.max(u,m.data().display_order||0),0),o={space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:is(),updated_at:is()};return{id:(await Qn(t,o)).id,space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(s,e){const t=Le(ne,"finish_check_items",s);await Mt(t,{content:e,updated_at:is()})},async deleteItem(s){const e=$e(ne,"finish_check_images"),t=_t(e,Rs("item_id","==",s)),n=await St(t);for(const r of n.docs)await Fs(Le(ne,"finish_check_images",r.id));await Fs(Le(ne,"finish_check_items",s))},async toggleItem(s){const e=Le(ne,"finish_check_items",s),t=await jt(e);if(!t.exists())throw new Error("   .");const n=t.data(),r=n.is_completed?0:1;return await Mt(e,{is_completed:r,completed_at:r?is():null,updated_at:is()}),{id:s,space_id:n.space_id,content:n.content,is_completed:r,is_priority:n.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:n.display_order||0,created_at:ei(n.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(s){const e=Le(ne,"finish_check_items",s),t=await jt(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await Mt(e,{is_priority:r,updated_at:is()}),{is_priority:r}},async getImageData(s){const e=Le(ne,"finish_check_images",s),t=await jt(e);if(!t.exists())return null;const n=t.data();return{image_data:n.image_url||n.image_data||""}},async uploadImage(s,e,t){const n=$e(ne,"finish_check_images"),r={item_id:s,image_data:"",image_url:"",filename:t,created_at:is()},i=await Qn(n,r);let o=e;if(to(e)){const l=await Yy("finish_check",i.id,e);await Mt(i,{image_url:l,image_data:""}),o=l}else await Mt(i,{image_data:e});return{id:i.id,item_id:s,image_data:o,filename:t,created_at:new Date().toISOString()}},async deleteImage(s){const e=Le(ne,"finish_check_images",s),t=await jt(e);if(t.exists()){const n=t.data();n.image_url&&await Gy(n.image_url)}await Fs(e)}},An={getSpaces:s=>bn.getSpaces(s),createSpace:(s,e)=>bn.createSpace(s,e),updateSpace:(s,e)=>bn.updateSpace(String(s),e),deleteSpace:s=>bn.deleteSpace(String(s)),createItem:(s,e)=>bn.createItem(String(s),e),updateItem:(s,e)=>bn.updateItem(String(s),e),deleteItem:s=>bn.deleteItem(String(s)),toggleItem:s=>bn.toggleItem(String(s)),togglePriority:s=>bn.togglePriority(String(s)),getImageData:s=>bn.getImageData(String(s)),uploadImage:(s,e,t)=>bn.uploadImage(String(s),e,t),deleteImage:s=>bn.deleteImage(String(s))},Qw=()=>{var ee,Ge;const{user:s}=qr(),{loadProjectsFromAPI:e,projects:t}=or(),n=dc(),[r,i]=D.useState([]),[o,l]=D.useState(!0),[u,m]=D.useState(null),[d,f]=D.useState([]),[h,y]=D.useState(!1),[C,v]=D.useState(""),[V,B]=D.useState(""),[T,q]=D.useState(null),[oe,te]=D.useState(null),[O,E]=D.useState(""),[x,A]=D.useState(null),[P,S]=D.useState(""),[w,k]=D.useState(null),[Ae,He]=D.useState(new Set),ye=D.useRef(null),[Be,gt]=D.useState(window.innerWidth<768),[$t,Ft]=D.useState(!1),[ae,Me]=D.useState(null),[de,Ie]=D.useState(new Set),[ze,xt]=D.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[it,Tt]=D.useState(!1),[nt,ft]=D.useState(!1),[us,K]=D.useState(new Set);D.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(ze))},[ze]),D.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const ge=()=>{gt(window.innerWidth<768)};return window.addEventListener("resize",ge),()=>window.removeEventListener("resize",ge)},[]),D.useEffect(()=>{o||Pe()},[n,o]),D.useEffect(()=>{u!==null&&Fe()},[u]),D.useEffect(()=>{u!==null&&(s!=null&&s.id)&&localStorage.setItem(`finishCheck_selectedProject_${s.id}`,u.toString())},[u,s==null?void 0:s.id]),D.useEffect(()=>{if(!Be&&w){const M=async ge=>{var je;const ke=(je=ge.clipboardData)==null?void 0:je.items;if(ke){for(let me=0;me<ke.length;me++)if(ke[me].type.indexOf("image")!==-1){ge.preventDefault();const Ut=ke[me].getAsFile();Ut&&await we(w,Ut)}}};return document.addEventListener("paste",M),()=>document.removeEventListener("paste",M)}},[w,Be]);const Pe=async()=>{try{const M=n.map(ke=>({id:ke.id,title:ke.name}));i(M);const ge=s!=null&&s.id?localStorage.getItem(`finishCheck_selectedProject_${s.id}`):null;ge&&M.some(ke=>ke.id===Number(ge))?m(Number(ge)):M.length>0&&m(M[0].id)}catch(M){console.error("Failed to load projects:",M),se.error("   ")}},Fe=async()=>{try{d.length===0&&y(!0);const ge=(await An.getSpaces(u||void 0)).map(ke=>({...ke,items:ke.items.map(je=>({...je,images:je.images||[]}))}));f(ge)}catch(M){console.error("Failed to load spaces:",M),se.error("   ")}finally{y(!1)}},Te=async M=>{if(us.has(Number(M)))return null;try{K(je=>new Set(je).add(Number(M)));const ge=await An.getImageData(M),ke=(ge==null?void 0:ge.image_data)||null;return f(je=>je.map(me=>({...me,items:me.items.map(Ut=>({...Ut,images:Ut.images.map(At=>String(At.id)===String(M)?{...At,image_data:ke}:At)}))}))),ke}catch(ge){return console.error("   :",ge),null}finally{K(ge=>{const ke=new Set(ge);return ke.delete(Number(M)),ke})}},Ye=async M=>{const ge=d.find(me=>me.items.some(Ut=>Ut.id===M)),ke=ge==null?void 0:ge.items.find(me=>me.id===M);if(!ke)return;const je=ke.images.filter(me=>!me.image_data);await Promise.all(je.map(me=>Te(me.id)))},Lt=async()=>{if(!nt){if(!C.trim()){se.error("  ");return}if(!u){se.error(" ");return}ft(!0);try{const M=await An.createSpace(C.trim(),u),ge={...M,items:M.items||[]};f([...d,ge]),v(""),Tt(!1),se.success(" ")}catch(M){console.error("Failed to add space:",M),se.error("  ")}finally{ft(!1)}}},Wt=async(M,ge)=>{if(!ge.trim()){se.error("  ");return}try{await An.updateSpace(M,ge.trim()),f(d.map(ke=>String(ke.id)===String(M)?{...ke,name:ge.trim()}:ke)),te(null),E(""),se.success("  ")}catch(ke){console.error("Failed to update space:",ke),se.error("  ")}},mt=M=>{Me(M),Ie(new Set)},L=async()=>{if(ae!==null){if(de.size===0){se.error("  ");return}try{await Promise.all(Array.from(de).map(M=>An.deleteItem(M))),f(d.map(M=>String(M.id)===String(ae)?{...M,items:M.items.filter(ge=>!de.has(ge.id))}:M)),se.success(`${de.size}  `),Me(null),Ie(new Set)}catch(M){console.error("Failed to delete items:",M),se.error("  ")}}},F=async()=>{if(ae===null)return;const M=d.find(ge=>String(ge.id)===String(ae));if(M&&confirm(`"${M.name}"  ?

        .`))try{await An.deleteSpace(ae),f(d.filter(ge=>String(ge.id)!==String(ae))),se.success(" "),Me(null),Ie(new Set)}catch(ge){console.error("Failed to delete space:",ge),se.error("  ")}},J=async M=>{if(!V.trim()){se.error("  ");return}const ge=-Date.now(),ke={id:ge,space_id:M,content:V.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(me=>String(me.id)===String(M)?{...me,items:[...me.items,ke]}:me));const je=V.trim();B(""),q(null);try{const me=await An.createItem(M,je);f(Ut=>Ut.map(At=>String(At.id)===String(M)?{...At,items:At.items.map(Qt=>Qt.id===ge?{...me,images:[]}:Qt)}:At))}catch(me){console.error("Failed to add item:",me),f(Ut=>Ut.map(At=>String(At.id)===String(M)?{...At,items:At.items.filter(Qt=>Qt.id!==ge)}:At)),se.error("  ")}},xe=async M=>{try{const ge=await An.toggleItem(M);f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(M)?{...je,...ge}:je)})))}catch(ge){console.error("Failed to toggle item:",ge),se.error("   ")}},ue=async M=>{try{const ge=await An.togglePriority(M);f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(M)?{...je,is_priority:ge.is_priority}:je)})))}catch(ge){console.error("Failed to toggle priority:",ge),se.error("  ")}},fe=M=>new Promise((ge,ke)=>{const je=new FileReader;je.readAsDataURL(M),je.onload=()=>ge(je.result),je.onerror=me=>ke(me)}),we=async(M,ge)=>{var me,Ut;if(!["image/jpeg","image/png","image/webp"].includes(ge.type)){se.error("JPEG, PNG, WebP    ");return}const je=5*1024*1024;if(ge.size>je){se.error("  5MB  ");return}try{He(vt=>new Set([...vt,Number(M)]));const At=await fe(ge),Qt=await An.uploadImage(M,At,ge.name);f(d.map(vt=>({...vt,items:vt.items.map(fs=>String(fs.id)===String(M)?{...fs,images:[...fs.images,Qt]}:fs)}))),se.success(" ")}catch(At){console.error("Failed to upload image:",At),se.error(((Ut=(me=At.response)==null?void 0:me.data)==null?void 0:Ut.error)||"  ")}finally{He(At=>{const Qt=new Set(At);return Qt.delete(Number(M)),Qt})}},Oe=async(M,ge)=>{const ke=ge.target.files;if(!(!ke||ke.length===0)){for(let je=0;je<ke.length;je++)await we(M,ke[je]);ye.current&&(ye.current.value="")}},et=async(M,ge)=>{if(confirm("  ?"))try{await An.deleteImage(ge),f(d.map(ke=>({...ke,items:ke.items.map(je=>String(je.id)===String(M)?{...je,images:je.images.filter(me=>String(me.id)!==String(ge))}:je)}))),se.success(" ")}catch(ke){console.error("Failed to delete image:",ke),se.error("  ")}},Ee=async(M,ge)=>{M.preventDefault(),M.stopPropagation();const ke=M.dataTransfer.files;if(!(!ke||ke.length===0))for(let je=0;je<ke.length;je++)ke[je].type.startsWith("image/")&&await we(ge,ke[je])},Bs=M=>{M.preventDefault(),M.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Bt=w?d.flatMap(M=>M.items).find(M=>M.id===w):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:ye,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:M=>{w&&Oe(w,M)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Be?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:M=>{const ge=M.target.value?Number(M.target.value):null;m(ge)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(M=>a.jsxDEV("option",{value:M.id,children:M.title},M.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>xt(!ze),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>Tt(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV(Wi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:M=>{const ge=M.target.value?Number(M.target.value):null;m(ge)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(M=>a.jsxDEV("option",{value:M.id,children:M.title},M.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:C,onChange:M=>v(M.target.value),onKeyPress:M=>{M.key==="Enter"&&Lt()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Lt,disabled:nt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV(Wi,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>xt(!ze),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${ze?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:ze?" ":" ",children:ze?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((M,ge)=>{const ke=M.items.filter(me=>!me.is_completed).sort((me,Ut)=>(Ut.is_priority||0)-(me.is_priority||0)),je=M.items.filter(me=>me.is_completed);return ze&&ke.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[oe===M.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:O,onChange:me=>E(me.target.value),onKeyPress:me=>{me.key==="Enter"?Wt(M.id,O):me.key==="Escape"&&(te(null),E(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Wt(M.id,O),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(Qp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{te(null),E("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:ge+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),M.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[je.length,"/",M.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{T===M.id?(q(null),B("")):q(M.id)},className:`p-1 transition-colors ${T===M.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV(Wi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{te(M.id),E(M.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>mt(M.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(ai,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),T===M.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:V,onChange:me=>B(me.target.value),onKeyPress:me=>{me.key==="Enter"&&V.trim()&&J(M.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>J(M.id),disabled:!V.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),ke.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:ke.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>xe(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Be&&w===me.id?"font-semibold":""}`,onClick:async()=>{Be||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:Be?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Be&&Ft(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Sd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!ze&&je.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:je.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>xe(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Be&&w===me.id?"font-semibold":""}`,onClick:async()=>{Be||(k(me.id),me.images&&me.images.length>0&&await Ye(me.id))},style:{cursor:Be?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Be&&Ft(!0),me.images&&me.images.length>0&&await Ye(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(Sd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!Be&&w&&Bt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Bt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var M;return(M=ye.current)==null?void 0:M.click()},disabled:Ae.has(w),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),Ae.has(w)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:M=>Ee(M,w),onDragOver:Bs,children:Bt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(jo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Bt.images.map(M=>a.jsxDEV("div",{className:"relative group",children:[M.image_data?a.jsxDEV("img",{src:M.image_data,alt:M.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>et(w,M.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Td,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),M.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:M.filename,children:M.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),Be&&$t&&w&&Bt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ft(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Bt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var M;return(M=ye.current)==null?void 0:M.click()},disabled:Ae.has(w),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),Ae.has(w)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Bt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(jo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Bt.images.map(M=>a.jsxDEV("div",{className:"relative",children:[M.image_data?a.jsxDEV("img",{src:M.image_data,alt:M.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>et(w,M.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Td,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),M.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:M.filename,children:M.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ee=d.find(M=>M.id===ae))==null?void 0:ee.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Me(null),Ie(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Ge=d.find(M=>M.id===ae))==null?void 0:Ge.items.map(M=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const ge=new Set(de);ge.has(M.id)?ge.delete(M.id):ge.add(M.id),Ie(ge)},children:[a.jsxDEV("input",{type:"checkbox",checked:de.has(M.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${M.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:M.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:L,disabled:de.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",de.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:F,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{Me(null),Ie(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),it&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Tt(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:C,onChange:M=>v(M.target.value),onKeyPress:M=>{M.key==="Enter"&&C.trim()&&Lt()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{Tt(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:Lt,disabled:!C.trim()||nt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:nt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function Yw(){const[s,e]=D.useState([]),[t,n]=D.useState(!1),[r,i]=D.useState(null),[o,l]=D.useState(!1),[u,m]=D.useState(null),[d,f]=D.useState(""),[h,y]=D.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[C,v]=D.useState(!1);D.useEffect(()=>{V()},[]),D.useEffect(()=>{const x=()=>{B()};return window.addEventListener("headerAddButtonClick",x),()=>window.removeEventListener("headerAddButtonClick",x)},[]);const V=async()=>{var x,A;try{s.length===0&&n(!0),i(null);const P=await rr.getAllContractors();e(P.map(S=>({id:S._id,rank:S.rank,companyName:S.companyName,name:S.name,position:S.position,process:S.process,contact:S.contact,accountNumber:S.accountNumber,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(P){console.error("Failed to load contractors:",P);const S=P instanceof Error&&((A=(x=P.response)==null?void 0:x.data)==null?void 0:A.message);i(S||"   .")}finally{n(!1)}},B=x=>{if(x){m(x);let A="",P=x.accountNumber||"";if(x.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const Ae of k)if(x.accountNumber.startsWith(Ae)){A=Ae,P=x.accountNumber.substring(Ae.length).trim();break}}let S=x.name,w=x.position||"";w||(w=Ya(x.name),S=Xo(x.name)),y({rank:x.rank||"",companyName:x.companyName||"",name:S,position:w,process:x.process,contact:x.contact||"",bankName:A,accountNumber:P,notes:x.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},T=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},q=async x=>{var P,S;if(x.preventDefault(),C)return;v(!0);const A=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const w={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:A,notes:h.notes};u?await rr.updateContractor(u.id,w):await rr.createContractor(w),await V(),T()}catch(w){console.error("Failed to save contractor:",w);const k=w instanceof Error&&((S=(P=w.response)==null?void 0:P.data)==null?void 0:S.message);alert(k||"  .")}finally{v(!1)}},oe=async x=>{var A,P;if(window.confirm("   ?"))try{await rr.deleteContractor(x),await V()}catch(S){console.error("Failed to delete contractor:",S);const w=S instanceof Error&&((P=(A=S.response)==null?void 0:A.data)==null?void 0:P.message);alert(w||"  .")}},te=()=>"border-gray-200 text-gray-600 bg-gray-50",O=x=>x?x==="1"?1:x==="1()"?2:x==="2"?3:x==="2()"?4:x==="3"?5:x==="3()"?6:x===""?100:x===""?200:999:999,E=s.filter(x=>x.name.toLowerCase().includes(d.toLowerCase())||x.process.toLowerCase().includes(d.toLowerCase())||x.accountNumber.toLowerCase().includes(d.toLowerCase())||x.contact&&x.contact.toLowerCase().includes(d.toLowerCase())||x.rank&&x.rank.toLowerCase().includes(d.toLowerCase())||x.companyName&&x.companyName.toLowerCase().includes(d.toLowerCase())).sort((x,A)=>{const P=O(x.rank)-O(A.rank);if(P!==0)return P;const S=x.process.localeCompare(A.process,"ko");return S!==0?S:x.name.localeCompare(A.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>B(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Gp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:x=>f(x.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:V,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):E.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):E.map(x=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${te(x.rank)}`,children:x.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:Xo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.position||Ya(x.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(ai,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:V,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):E.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):E.map(x=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[x.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${te(x.rank)}`,children:x.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:x.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),x.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:x.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Xo(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>B(x),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>oe(x.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(ai,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(x.position||Ya(x.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.position||Ya(x.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),x.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:x.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:x.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),x.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:x.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},x.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:T,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(vs,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:q,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:x=>y({...h,rank:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:x=>y({...h,companyName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:x=>y({...h,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:x=>y({...h,position:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:x=>y({...h,process:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:x=>y({...h,contact:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:x=>y({...h,bankName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:x=>y({...h,accountNumber:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:x=>y({...h,notes:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:C,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:C?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const Gw=()=>{const[s,e]=D.useState([]),[t,n]=D.useState(null),[r,i]=D.useState(!1),o=D.useRef(null);D.useEffect(()=>(o.current=pl.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{o.current&&o.current()}),[]);const l=async f=>{try{await pl.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{n(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await pl.deleteQuoteInquiry(f),(t==null?void 0:t.id)===f&&n(null),se.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),se.error("  ")}},d=s.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:s.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:qt(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(ai,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Ld,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>n(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:qt(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(PN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Ld,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(IN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(jN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(RN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},Xw=()=>{const{login:s}=qr(),[e,t]=D.useState(!1),{register:n,handleSubmit:r,setValue:i,formState:{errors:o}}=rd(),l=async m=>{t(!0);try{await s(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...n("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...n("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(BN,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},Jw=D.lazy(()=>Xn(()=>import("./Drawings-r98kK_a3.js"),__vite__mapDeps([0,1,2,3,4,5]))),Zw=D.lazy(()=>Xn(()=>import("./SiteLog-Te8ejAPf.js"),__vite__mapDeps([6,1,4,2,3,5]))),e2=D.lazy(()=>Xn(()=>import("./AfterService-C7OE_g4K.js"),__vite__mapDeps([7,1,2,4,3,5]))),t2=D.lazy(()=>Xn(()=>import("./AdditionalWork-uo_Q3Yx3.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),s2=D.lazy(()=>Xn(()=>import("./ConstructionPayment-Bq_JqbJk.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),n2=D.lazy(()=>Xn(()=>import("./WorkRequest-CrI5I5sr.js"),__vite__mapDeps([11,1,2,4,3,5]))),r2=D.lazy(()=>Xn(()=>import("./Specbook-ex4eaY73.js"),__vite__mapDeps([12,1,2,3,4,5]))),i2=D.lazy(()=>Xn(()=>import("./EstimatePreview-BYkkcMmJ.js"),__vite__mapDeps([13,1,2,3,4,5]))),o2=D.lazy(()=>Xn(()=>import("./ExecutionHistory-CjmLe6sX.js"),__vite__mapDeps([14,1,4,2,3,5]))),a2=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),l2=new DN({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function c2(){const[s,e]=D.useState(!1);return D.useEffect(()=>{const t=Bx({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),se.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{se.dismiss(),se.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});OC();const n=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(n,5e3);const r=setInterval(n,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Fo(u,{transports:["websocket","polling"]}),Rl.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;MC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(kN,{client:l2,children:a.jsxDEV(xN,{children:a.jsxDEV(QE,{children:[a.jsxDEV(D.Suspense,{fallback:a.jsxDEV(a2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(vN,{children:[a.jsxDEV(Vs,{path:"/login",element:a.jsxDEV(Xw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Vs,{path:"/",element:a.jsxDEV(BC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Vs,{index:!0,element:a.jsxDEV(Kp,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Vs,{path:"dashboard",element:a.jsxDEV(g1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Vs,{path:"projects",element:a.jsxDEV(D1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Vs,{path:"schedule",element:a.jsxDEV(Hw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Vs,{path:"drawings",element:a.jsxDEV(Jw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Vs,{path:"site-log",element:a.jsxDEV(Zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Vs,{path:"after-service",element:a.jsxDEV(e2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Vs,{path:"additional-work",element:a.jsxDEV(t2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Vs,{path:"construction-payment",element:a.jsxDEV(s2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Vs,{path:"contractors",element:a.jsxDEV(Yw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Vs,{path:"work-request",element:a.jsxDEV(n2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Vs,{path:"finish-check",element:a.jsxDEV(Qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Vs,{path:"specbook",element:a.jsxDEV(r2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Vs,{path:"estimate-preview",element:a.jsxDEV(i2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Vs,{path:"execution-history",element:a.jsxDEV(o2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Vs,{path:"payments",element:a.jsxDEV(Kw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Vs,{path:"quote-inquiry",element:a.jsxDEV(Gw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(q0,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(s){for(const e of s)e.update()});dh(document.getElementById("root")).render(a.jsxDEV(D.StrictMode,{children:a.jsxDEV(c2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{rd as A,xs as B,Mu as C,SC as D,Qc as E,KE as F,b2 as G,Ht as H,$w as I,mn as J,zw as K,qw as L,Xc as P,ve as T,ne as a,Fs as b,is as c,Le as d,Il as e,Bu as f,jt as g,qr as h,dc as i,a as j,$e as k,hn as l,St as m,Xy as n,as as o,to as p,_t as q,Pl as r,ui as s,jl as t,Ru as u,Mt as v,Rs as w,Qn as x,or as y,se as z};
