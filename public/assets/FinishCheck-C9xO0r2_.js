import{j as t}from"./vendor-data-DG_4MGb7.js";import{r as n}from"./vendor-react-D-r2Cqeg.js";import{u as Fe,z as i,a as p}from"./index-Dgd7wCS1.js";import{u as _e}from"./useFilteredProjects-BNZe-7y5.js";import{P as q,C as De,X as D,q as Ee,T as Pe,I as R,r as oe,U as ce,s as de}from"./vendor-ui-DTwhhNuH.js";import"./vendor-date-9Cl9d1sr.js";import"./dataStore-D-kob-RA.js";const Ke=()=>{var ne,ie;const{user:d}=Fe(),J=_e(),[V,me]=n.useState([]),[f,E]=n.useState(null),[m,x]=n.useState([]),[ge,H]=n.useState(!1),[w,C]=n.useState(""),[N,U]=n.useState(""),[W,B]=n.useState(null),[xe,P]=n.useState(null),[K,I]=n.useState(""),[$e,ze]=n.useState(null),[Ae,Me]=n.useState(""),[c,k]=n.useState(null),[$,Q]=n.useState(new Set),F=n.useRef(null),[h,he]=n.useState(window.innerWidth<768),[ue,G]=n.useState(!1),[y,_]=n.useState(null),[j,S]=n.useState(new Set),[u,Y]=n.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[fe,z]=n.useState(!1),[A,Z]=n.useState(!1),[pe,ee]=n.useState(new Set);n.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(u))},[u]),n.useEffect(()=>{const e=()=>{he(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),n.useEffect(()=>{ye()},[J]),n.useEffect(()=>{f!==null&&be()},[f]),n.useEffect(()=>{f!==null&&(d!=null&&d.id)&&localStorage.setItem(`finishCheck_selectedProject_${d.id}`,f.toString())},[f,d==null?void 0:d.id]),n.useEffect(()=>{if(!h&&c){const e=async r=>{var l;const a=(l=r.clipboardData)==null?void 0:l.items;if(a){for(let s=0;s<a.length;s++)if(a[s].type.indexOf("image")!==-1){r.preventDefault();const g=a[s].getAsFile();g&&await X(c,g)}}};return document.addEventListener("paste",e),()=>document.removeEventListener("paste",e)}},[c,h]);const ye=async()=>{try{const e=J.map(a=>({id:a.id,title:a.name}));me(e);const r=d!=null&&d.id?localStorage.getItem(`finishCheck_selectedProject_${d.id}`):null;r&&e.some(a=>a.id===Number(r))?E(Number(r)):e.length>0&&E(e[0].id)}catch(e){console.error("Failed to load projects:",e),i.error("프로젝트 목록을 불러오는데 실패했습니다")}},be=async()=>{try{m.length===0&&H(!0);const e=f?`/finish-check/spaces?project_id=${f}`:"/finish-check/spaces",a=(await p.get(e)).data.map(l=>({...l,items:l.items.map(s=>({...s,images:s.images||[]}))}));x(a)}catch(e){console.error("Failed to load spaces:",e),i.error("공간 목록을 불러오는데 실패했습니다")}finally{H(!1)}},je=async e=>{if(pe.has(e))return null;try{ee(l=>new Set(l).add(e));const a=(await p.get(`/finish-check/images/${e}`)).data.image_data;return x(l=>l.map(s=>({...s,items:s.items.map(g=>({...g,images:g.images.map(o=>o.id===e?{...o,image_data:a}:o)}))}))),a}catch(r){return console.error("이미지 데이터 로드 실패:",r),null}finally{ee(r=>{const a=new Set(r);return a.delete(e),a})}},M=async e=>{const r=m.find(s=>s.items.some(g=>g.id===e)),a=r==null?void 0:r.items.find(s=>s.id===e);if(!a)return;const l=a.images.filter(s=>!s.image_data);await Promise.all(l.map(s=>je(s.id)))},T=async()=>{if(!A){if(!w.trim()){i.error("공간 이름을 입력하세요");return}if(!f){i.error("프로젝트를 선택하세요");return}Z(!0);try{const e=await p.post("/finish-check/spaces",{name:w.trim(),project_id:f}),r={...e.data,items:e.data.items||[]};x([...m,r]),C(""),z(!1),i.success("공간이 추가되었습니다")}catch(e){console.error("Failed to add space:",e),i.error("공간 추가에 실패했습니다")}finally{Z(!1)}}},te=async(e,r)=>{if(!r.trim()){i.error("공간 이름을 입력하세요");return}try{await p.put(`/finish-check/spaces/${e}`,{name:r.trim()}),x(m.map(a=>a.id===e?{...a,name:r.trim()}:a)),P(null),I(""),i.success("공간 이름이 수정되었습니다")}catch(a){console.error("Failed to update space:",a),i.error("공간 수정에 실패했습니다")}},ve=e=>{_(e),S(new Set)},we=async()=>{if(y!==null){if(j.size===0){i.error("삭제할 항목을 선택하세요");return}try{await Promise.all(Array.from(j).map(e=>p.delete(`/finish-check/items/${e}`))),x(m.map(e=>e.id===y?{...e,items:e.items.filter(r=>!j.has(r.id))}:e)),i.success(`${j.size}개 항목이 삭제되었습니다`),_(null),S(new Set)}catch(e){console.error("Failed to delete items:",e),i.error("항목 삭제에 실패했습니다")}}},Ne=async()=>{if(y===null)return;const e=m.find(r=>r.id===y);if(e&&confirm(`"${e.name}" 공간을 삭제하시겠습니까?

삭제된 공간과 해당 공간의 모든 항목은 복구할 수 없습니다.`))try{await p.delete(`/finish-check/spaces/${y}`),x(m.filter(r=>r.id!==y)),i.success("공간이 삭제되었습니다"),_(null),S(new Set)}catch(r){console.error("Failed to delete space:",r),i.error("공간 삭제에 실패했습니다")}},se=async e=>{if(!N.trim()){i.error("항목 내용을 입력하세요");return}const r=-Date.now(),a={id:r,space_id:e,content:N.trim(),is_checked:!1,is_priority:!1,images:[]};x(m.map(s=>s.id===e?{...s,items:[...s.items,a]}:s));const l=N.trim();U(""),B(null);try{const s=await p.post("/finish-check/items",{space_id:e,content:l});x(g=>g.map(o=>o.id===e?{...o,items:o.items.map(b=>b.id===r?{...s.data,images:[]}:b)}:o))}catch(s){console.error("Failed to add item:",s),x(g=>g.map(o=>o.id===e?{...o,items:o.items.filter(b=>b.id!==r)}:o)),i.error("항목 추가에 실패했습니다")}},re=async e=>{try{const r=await p.put(`/finish-check/items/${e}/toggle`);x(m.map(a=>({...a,items:a.items.map(l=>l.id===e?{...l,...r.data}:l)})))}catch(r){console.error("Failed to toggle item:",r),i.error("항목 상태 변경에 실패했습니다")}},ae=async e=>{try{const r=await p.put(`/finish-check/items/${e}/toggle-priority`);x(m.map(a=>({...a,items:a.items.map(l=>l.id===e?{...l,is_priority:r.data.is_priority}:l)})))}catch(r){console.error("Failed to toggle priority:",r),i.error("우선순위 변경에 실패했습니다")}},ke=e=>new Promise((r,a)=>{const l=new FileReader;l.readAsDataURL(e),l.onload=()=>r(l.result),l.onerror=s=>a(s)}),X=async(e,r)=>{var s,g;if(!["image/jpeg","image/png","image/webp"].includes(r.type)){i.error("JPEG, PNG, WebP 형식의 이미지만 업로드 가능합니다");return}const l=5*1024*1024;if(r.size>l){i.error("이미지 크기는 5MB 이하여야 합니다");return}try{Q(L=>new Set([...L,e]));const o=await ke(r),b=await p.post(`/finish-check/items/${e}/images`,{image_data:o,filename:r.name});x(m.map(L=>({...L,items:L.items.map(O=>O.id===e?{...O,images:[...O.images,b.data]}:O)}))),i.success("이미지가 업로드되었습니다")}catch(o){console.error("Failed to upload image:",o),i.error(((g=(s=o.response)==null?void 0:s.data)==null?void 0:g.error)||"이미지 업로드에 실패했습니다")}finally{Q(o=>{const b=new Set(o);return b.delete(e),b})}},Se=async(e,r)=>{const a=r.target.files;if(!(!a||a.length===0)){for(let l=0;l<a.length;l++)await X(e,a[l]);F.current&&(F.current.value="")}},le=async(e,r)=>{if(confirm("이 이미지를 삭제하시겠습니까?"))try{await p.delete(`/finish-check/images/${r}`),x(m.map(a=>({...a,items:a.items.map(l=>l.id===e?{...l,images:l.images.filter(s=>s.id!==r)}:l)}))),i.success("이미지가 삭제되었습니다")}catch(a){console.error("Failed to delete image:",a),i.error("이미지 삭제에 실패했습니다")}},Ce=async(e,r)=>{e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.files;if(!(!a||a.length===0))for(let l=0;l<a.length;l++)a[l].type.startsWith("image/")&&await X(r,a[l])},Ie=e=>{e.preventDefault(),e.stopPropagation()};if(ge)return t.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:t.jsx("div",{className:"text-gray-500",children:"로딩 중..."})});const v=c?m.flatMap(e=>e.items).find(e=>e.id===c):null;return t.jsxs("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[t.jsx("input",{ref:F,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:e=>{c&&Se(c,e)}}),t.jsxs("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:h?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("select",{value:f||"",onChange:e=>{const r=e.target.value?Number(e.target.value):null;E(r)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(d==null?void 0:d.name)!=="안팀"&&t.jsx("option",{value:"",children:"프로젝트 선택"}),V.map(e=>t.jsx("option",{value:e.id,children:e.title},e.id))]})}),t.jsx("button",{onClick:()=>Y(!u),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${u?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:u?"전체 보기":"미완료만 보기",children:u?"미완료":"전체"}),t.jsx("button",{onClick:()=>z(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:"공간 추가",children:t.jsx(q,{className:"w-5 h-5"})})]}):t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"프로젝트"}),t.jsxs("select",{value:f||"",onChange:e=>{const r=e.target.value?Number(e.target.value):null;E(r)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(d==null?void 0:d.name)!=="안팀"&&t.jsx("option",{value:"",children:"프로젝트 선택"}),V.map(e=>t.jsx("option",{value:e.id,children:e.title},e.id))]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"공간 추가"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:w,onChange:e=>C(e.target.value),onKeyPress:e=>{e.key==="Enter"&&T()},placeholder:"공간 이름 입력",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"}),t.jsx("button",{onClick:T,disabled:A,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:"공간 추가",children:t.jsx(q,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:()=>Y(!u),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${u?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:u?"전체 보기":"미완료만 보기",children:u?"미완료만":"전체보기"})})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:m.length===0?t.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:"공간을 추가해주세요"}):t.jsx("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:m.map((e,r)=>{const a=e.items.filter(s=>!s.is_completed).sort((s,g)=>(g.is_priority||0)-(s.is_priority||0)),l=e.items.filter(s=>s.is_completed);return u&&a.length===0?null:t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[xe===e.id?t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("input",{type:"text",value:K,onChange:s=>I(s.target.value),onKeyPress:s=>{s.key==="Enter"?te(e.id,K):s.key==="Escape"&&(P(null),I(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0}),t.jsx("button",{onClick:()=>te(e.id,K),className:"p-1 text-green-600 hover:text-green-700",children:t.jsx(De,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{P(null),I("")},className:"p-1 text-gray-600 hover:text-gray-700",children:t.jsx(D,{className:"w-4 h-4"})})]}):t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:r+1}),e.name]}),t.jsxs("span",{className:"text-xs text-gray-500",children:[l.length,"/",e.items.length," 완료"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>{W===e.id?(B(null),U("")):B(e.id)},className:`p-1 transition-colors ${W===e.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:"항목 추가",children:t.jsx(q,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{P(e.id),I(e.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"수정",children:t.jsx(Ee,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ve(e.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"삭제",children:t.jsx(Pe,{className:"w-4 h-4"})})]})]}),W===e.id&&t.jsx("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:N,onChange:s=>U(s.target.value),onKeyPress:s=>{s.key==="Enter"&&N.trim()&&se(e.id)},placeholder:"마감 항목 입력",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0}),t.jsx("button",{onClick:()=>se(e.id),disabled:!N.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"추가"})]})}),a.length>0&&t.jsx("div",{className:"mb-4",children:t.jsx("div",{className:"space-y-2",children:a.map(s=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[t.jsx("input",{type:"checkbox",checked:!1,onChange:()=>re(s.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"}),t.jsxs("span",{className:`flex-1 text-sm text-gray-900 ${!h&&c===s.id?"font-semibold":""}`,onClick:async()=>{h||(k(s.id),s.images&&s.images.length>0&&await M(s.id))},style:{cursor:h?"default":"pointer"},children:[s.content,s.images&&s.images.length>0&&t.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",s.images.length,")"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:async()=>{k(s.id),h&&G(!0),s.images&&s.images.length>0&&await M(s.id)},className:`p-1 transition-colors ${s.images&&s.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"이미지",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ae(s.id),className:`p-1 transition-colors ${s.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"우선순위",children:t.jsx(oe,{className:`w-4 h-4 ${s.is_priority?"fill-current":""}`})})]})]},s.id))})}),!u&&l.length>0&&t.jsx("div",{children:t.jsx("div",{className:"space-y-2",children:l.map(s=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[t.jsx("input",{type:"checkbox",checked:!0,onChange:()=>re(s.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"}),t.jsxs("span",{className:`flex-1 text-sm text-gray-500 line-through ${!h&&c===s.id?"font-semibold":""}`,onClick:async()=>{h||(k(s.id),s.images&&s.images.length>0&&await M(s.id))},style:{cursor:h?"default":"pointer"},children:[s.content,s.images&&s.images.length>0&&t.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",s.images.length,")"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:async()=>{k(s.id),h&&G(!0),s.images&&s.images.length>0&&await M(s.id)},className:`p-1 transition-colors ${s.images&&s.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"이미지",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ae(s.id),className:`p-1 transition-colors ${s.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"우선순위",children:t.jsx(oe,{className:`w-4 h-4 ${s.is_priority?"fill-current":""}`})})]})]},s.id))})})]},e.id)})})})]}),!h&&c&&v&&t.jsxs("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"이미지"}),t.jsx("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"닫기",children:t.jsx(D,{className:"w-4 h-4"})})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:v.content}),t.jsxs("button",{onClick:()=>{var e;return(e=F.current)==null?void 0:e.click()},disabled:$.has(c),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(ce,{className:"w-4 h-4"}),$.has(c)?"업로드 중...":"이미지 업로드"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"클릭 또는 드래그 앤 드롭, Ctrl+V로 붙여넣기"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4",onDrop:e=>Ce(e,c),onDragOver:Ie,children:v.images.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[t.jsx(R,{className:"w-12 h-12 mb-2"}),t.jsx("p",{children:"이미지가 없습니다"})]}):t.jsx("div",{className:"grid grid-cols-2 gap-3",children:v.images.map(e=>t.jsxs("div",{className:"relative group",children:[e.image_data?t.jsx("img",{src:e.image_data,alt:e.filename||"이미지",className:"w-full h-32 object-cover rounded-lg border border-gray-200"}):t.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:t.jsx("span",{className:"text-gray-400 text-sm",children:"로딩 중..."})}),t.jsx("button",{onClick:()=>le(c,e.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"삭제",children:t.jsx(de,{className:"w-4 h-4"})}),e.filename&&t.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:e.filename,children:e.filename})]},e.id))})})]}),h&&ue&&c&&v&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"이미지"}),t.jsx("button",{onClick:()=>{G(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:t.jsx(D,{className:"w-5 h-5"})})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:v.content}),t.jsxs("button",{onClick:()=>{var e;return(e=F.current)==null?void 0:e.click()},disabled:$.has(c),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[t.jsx(ce,{className:"w-4 h-4"}),$.has(c)?"업로드 중...":"이미지 업로드"]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:v.images.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[t.jsx(R,{className:"w-16 h-16 mb-2"}),t.jsx("p",{className:"text-sm",children:"이미지가 없습니다"})]}):t.jsx("div",{className:"grid grid-cols-2 gap-3",children:v.images.map(e=>t.jsxs("div",{className:"relative",children:[e.image_data?t.jsx("img",{src:e.image_data,alt:e.filename||"이미지",className:"w-full h-40 object-cover rounded-lg border border-gray-200"}):t.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:t.jsx("span",{className:"text-gray-400 text-sm",children:"로딩 중..."})}),t.jsx("button",{onClick:()=>le(c,e.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:t.jsx(de,{className:"w-4 h-4"})}),e.filename&&t.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:e.filename,children:e.filename})]},e.id))})})]})}),y!==null&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[(ne=m.find(e=>e.id===y))==null?void 0:ne.name," - 삭제"]}),t.jsx("button",{onClick:()=>{_(null),S(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:t.jsx(D,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"삭제할 항목을 선택하세요. 선택하지 않은 항목은 유지됩니다."}),t.jsx("div",{className:"space-y-2",children:(ie=m.find(e=>e.id===y))==null?void 0:ie.items.map(e=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const r=new Set(j);r.has(e.id)?r.delete(e.id):r.add(e.id),S(r)},children:[t.jsx("input",{type:"checkbox",checked:j.has(e.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"}),t.jsx("span",{className:`flex-1 text-sm ${e.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:e.content})]},e.id))})]}),t.jsxs("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[t.jsxs("button",{onClick:we,disabled:j.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["선택 항목 삭제 (",j.size,")"]}),t.jsx("button",{onClick:Ne,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"공간 전체 삭제"}),t.jsx("button",{onClick:()=>{_(null),S(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:"취소"})]})]})}),fe&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"공간 추가"}),t.jsx("button",{onClick:()=>{z(!1),C("")},className:"p-1 text-gray-600 hover:text-gray-900",children:t.jsx(D,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"공간 이름"}),t.jsx("input",{type:"text",value:w,onChange:e=>C(e.target.value),onKeyPress:e=>{e.key==="Enter"&&w.trim()&&T()},placeholder:"공간 이름 입력",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{z(!1),C("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:"취소"}),t.jsx("button",{onClick:T,disabled:!w.trim()||A,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:A?"추가 중...":"추가"})]})]})]})})]})};export{Ke as default};
