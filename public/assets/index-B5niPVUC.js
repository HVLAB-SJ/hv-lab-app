const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Drawings-nKPPqlAF.js","assets/vendor-react-DN7YJcfR.js","assets/vendor-ui-D8A9iq7X.js","assets/vendor-data-DrLf5NIQ.js","assets/vendor-date-DbWJ9m7c.js","assets/vendor-calendar-DjAQlTCo.js","assets/SiteLog-D30omJbe.js","assets/AfterService-eRWEHwta.js","assets/AdditionalWork-criZPDf_.js","assets/additionalWorkService-DEouHS26.js","assets/ConstructionPayment-BpQRRh2j.js","assets/WorkRequest-WJMfFq-f.js","assets/Specbook-CNkhGBbo.js","assets/EstimatePreview-DNzu6mW_.js","assets/ExecutionHistory-BplEGnoB.js"])))=>i.map(i=>d[i]);
var mN=Object.defineProperty;var dN=(s,e,t)=>e in s?mN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Vd=(s,e,t)=>dN(s,typeof e!="symbol"?e+"":e,t);import{r as A,b as fN,u as $p,d as pN,N as Wp,e as wc,O as hN,R as ct,f as da,B as gN,h as yN,i as Vs}from"./vendor-react-DN7YJcfR.js";import{a as bN,c as Wu,Q as NN,b as xN}from"./vendor-data-DrLf5NIQ.js";import{B as Sc,X as vs,C as zp,T as oi,a as vN,b as Kp,W as _N,c as DN,d as Dn,P as $i,R as kN,e as AN,S as Qp,f as EN,g as CN,h as Yp,i as VN,U as tu,I as jo,j as su,k as wd,l as Sd,m as Td,n as wN,M as SN,o as TN,p as LN,L as PN}from"./vendor-ui-D8A9iq7X.js";import{k as Tc,l as No,m as xo,n as IN,o as jN,p as Ft,q as RN,r as Ld,s as BN,t as at}from"./vendor-date-DbWJ9m7c.js";import{c as UN,p as Gp,l as Hl,s as kn,i as HN,h as MN,q as zu,a as Ku,m as Qu,b as ON,d as Ml,o as yl,e as FN,f as bl,r as Yu,g as Gu,j as Xu,k as Ju,n as Zu,t as Xp,u as Jp,v as Zp,w as eh,x as th,y as sh,z as nh,A as rh,B as ih,C as oh,D as ah,E as lh,F as qN,G as $N,H as WN,I as zN,J as KN,K as QN,L as YN}from"./vendor-calendar-DjAQlTCo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var ch={exports:{}},nu={};/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var s=A,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),T=Symbol.iterator,v="@@iterator";function V(x){if(x===null||typeof x!="object")return null;var I=T&&x[T]||x[v];return typeof I=="function"?I:null}var R=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function L(x){{for(var I=arguments.length,U=new Array(I>1?I-1:0),G=1;G<I;G++)U[G-1]=arguments[G];q("error",x,U)}}function q(x,I,U){{var G=R.ReactDebugCurrentFrame,Q=G.getStackAddendum();Q!==""&&(I+="%s",U=U.concat([Q]));var J=U.map(function(se){return String(se)});J.unshift("Warning: "+I),Function.prototype.apply.call(console[x],console,J)}}var oe=!1,te=!1,O=!1,C=!1,N=!1,E;E=Symbol.for("react.module.reference");function j(x){return!!(typeof x=="string"||typeof x=="function"||x===n||x===i||N||x===r||x===m||x===d||C||x===y||oe||te||O||typeof x=="object"&&x!==null&&(x.$$typeof===h||x.$$typeof===f||x.$$typeof===o||x.$$typeof===l||x.$$typeof===u||x.$$typeof===E||x.getModuleId!==void 0))}function S(x,I,U){var G=x.displayName;if(G)return G;var Q=I.displayName||I.name||"";return Q!==""?U+"("+Q+")":U}function w(x){return x.displayName||"Context"}function k(x){if(x==null)return null;if(typeof x.tag=="number"&&L("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case n:return"Fragment";case t:return"Portal";case i:return"Profiler";case r:return"StrictMode";case m:return"Suspense";case d:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case l:var I=x;return w(I)+".Consumer";case o:var U=x;return w(U._context)+".Provider";case u:return S(x,x.render,"ForwardRef");case f:var G=x.displayName||null;return G!==null?G:k(x.type)||"Memo";case h:{var Q=x,J=Q._payload,se=Q._init;try{return k(se(J))}catch{return null}}}return null}var De=Object.assign,Me=0,he,Re,ft,qt,Ot,ae,Oe;function de(){}de.__reactDisabledLog=!0;function Ie(){{if(Me===0){he=console.log,Re=console.info,ft=console.warn,qt=console.error,Ot=console.group,ae=console.groupCollapsed,Oe=console.groupEnd;var x={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:x,log:x,warn:x,error:x,group:x,groupCollapsed:x,groupEnd:x})}Me++}}function Ke(){{if(Me--,Me===0){var x={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:De({},x,{value:he}),info:De({},x,{value:Re}),warn:De({},x,{value:ft}),error:De({},x,{value:qt}),group:De({},x,{value:Ot}),groupCollapsed:De({},x,{value:ae}),groupEnd:De({},x,{value:Oe})})}Me<0&&L("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bt=R.ReactCurrentDispatcher,ot;function wt(x,I,U){{if(ot===void 0)try{throw Error()}catch(Q){var G=Q.stack.trim().match(/\n( *(at )?)/);ot=G&&G[1]||""}return`
`+ot+x}}var rt=!1,mt;{var ds=typeof WeakMap=="function"?WeakMap:Map;mt=new ds}function z(x,I){if(!x||rt)return"";{var U=mt.get(x);if(U!==void 0)return U}var G;rt=!0;var Q=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var J;J=bt.current,bt.current=null,Ie();try{if(I){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(Bt){G=Bt}Reflect.construct(x,[],se)}else{try{se.call()}catch(Bt){G=Bt}x.call(se.prototype)}}else{try{throw Error()}catch(Bt){G=Bt}x()}}catch(Bt){if(Bt&&G&&typeof Bt.stack=="string"){for(var Ce=Bt.stack.split(`
`),Xe=G.stack.split(`
`),Ue=Ce.length-1,pe=Xe.length-1;Ue>=1&&pe>=0&&Ce[Ue]!==Xe[pe];)pe--;for(;Ue>=1&&pe>=0;Ue--,pe--)if(Ce[Ue]!==Xe[pe]){if(Ue!==1||pe!==1)do if(Ue--,pe--,pe<0||Ce[Ue]!==Xe[pe]){var We=`
`+Ce[Ue].replace(" at new "," at ");return x.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",x.displayName)),typeof x=="function"&&mt.set(x,We),We}while(Ue>=1&&pe>=0);break}}}finally{rt=!1,bt.current=J,Ke(),Error.prepareStackTrace=Q}var as=x?x.displayName||x.name:"",Wt=as?wt(as):"";return typeof x=="function"&&mt.set(x,Wt),Wt}function Le(x,I,U){return z(x,!1)}function Be(x){var I=x.prototype;return!!(I&&I.isReactComponent)}function Se(x,I,U){if(x==null)return"";if(typeof x=="function")return z(x,Be(x));if(typeof x=="string")return wt(x);switch(x){case m:return wt("Suspense");case d:return wt("SuspenseList")}if(typeof x=="object")switch(x.$$typeof){case u:return Le(x.render);case f:return Se(x.type,I,U);case h:{var G=x,Q=G._payload,J=G._init;try{return Se(J(Q),I,U)}catch{}}}return""}var Qe=Object.prototype.hasOwnProperty,St={},$t=R.ReactDebugCurrentFrame;function ut(x){if(x){var I=x._owner,U=Se(x.type,x._source,I?I.type:null);$t.setExtraStackFrame(U)}else $t.setExtraStackFrame(null)}function P(x,I,U,G,Q){{var J=Function.call.bind(Qe);for(var se in x)if(J(x,se)){var Ce=void 0;try{if(typeof x[se]!="function"){var Xe=Error((G||"React class")+": "+U+" type `"+se+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof x[se]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Xe.name="Invariant Violation",Xe}Ce=x[se](I,se,G,U,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Ue){Ce=Ue}Ce&&!(Ce instanceof Error)&&(ut(Q),L("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",G||"React class",U,se,typeof Ce),ut(null)),Ce instanceof Error&&!(Ce.message in St)&&(St[Ce.message]=!0,ut(Q),L("Failed %s type: %s",U,Ce.message),ut(null))}}}var F=Array.isArray;function Z(x){return F(x)}function be(x){{var I=typeof Symbol=="function"&&Symbol.toStringTag,U=I&&x[Symbol.toStringTag]||x.constructor.name||"Object";return U}}function ue(x){try{return fe(x),!1}catch{return!0}}function fe(x){return""+x}function Ve(x){if(ue(x))return L("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",be(x)),fe(x)}var Fe=R.ReactCurrentOwner,Ze={key:!0,ref:!0,__self:!0,__source:!0},ke,Rs,Rt;Rt={};function ee(x){if(Qe.call(x,"ref")){var I=Object.getOwnPropertyDescriptor(x,"ref").get;if(I&&I.isReactWarning)return!1}return x.ref!==void 0}function Ye(x){if(Qe.call(x,"key")){var I=Object.getOwnPropertyDescriptor(x,"key").get;if(I&&I.isReactWarning)return!1}return x.key!==void 0}function M(x,I){if(typeof x.ref=="string"&&Fe.current&&I&&Fe.current.stateNode!==I){var U=k(Fe.current.type);Rt[U]||(L('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',k(Fe.current.type),x.ref),Rt[U]=!0)}}function Ne(x,I){{var U=function(){ke||(ke=!0,L("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",I))};U.isReactWarning=!0,Object.defineProperty(x,"key",{get:U,configurable:!0})}}function _e(x,I){{var U=function(){Rs||(Rs=!0,L("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",I))};U.isReactWarning=!0,Object.defineProperty(x,"ref",{get:U,configurable:!0})}}var Pe=function(x,I,U,G,Q,J,se){var Ce={$$typeof:e,type:x,key:I,ref:U,props:se,_owner:J};return Ce._store={},Object.defineProperty(Ce._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Ce,"_self",{configurable:!1,enumerable:!1,writable:!1,value:G}),Object.defineProperty(Ce,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Q}),Object.freeze&&(Object.freeze(Ce.props),Object.freeze(Ce)),Ce};function me(x,I,U,G,Q){{var J,se={},Ce=null,Xe=null;U!==void 0&&(Ve(U),Ce=""+U),Ye(I)&&(Ve(I.key),Ce=""+I.key),ee(I)&&(Xe=I.ref,M(I,Q));for(J in I)Qe.call(I,J)&&!Ze.hasOwnProperty(J)&&(se[J]=I[J]);if(x&&x.defaultProps){var Ue=x.defaultProps;for(J in Ue)se[J]===void 0&&(se[J]=Ue[J])}if(Ce||Xe){var pe=typeof x=="function"?x.displayName||x.name||"Unknown":x;Ce&&Ne(se,pe),Xe&&_e(se,pe)}return Pe(x,Ce,Xe,Q,G,Fe.current,se)}}var _t=R.ReactCurrentOwner,yt=R.ReactDebugCurrentFrame;function Xt(x){if(x){var I=x._owner,U=Se(x.type,x._source,I?I.type:null);yt.setExtraStackFrame(U)}else yt.setExtraStackFrame(null)}var kt;kt=!1;function fs(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function ns(){{if(_t.current){var x=k(_t.current.type);if(x)return`

Check the render method of \``+x+"`."}return""}}function Ts(x){{if(x!==void 0){var I=x.fileName.replace(/^.*[\\\/]/,""),U=x.lineNumber;return`

Check your code at `+I+":"+U+"."}return""}}var fn={};function Ys(x){{var I=ns();if(!I){var U=typeof x=="string"?x:x.displayName||x.name;U&&(I=`

Check the top-level render call using <`+U+">.")}return I}}function pn(x,I){{if(!x._store||x._store.validated||x.key!=null)return;x._store.validated=!0;var U=Ys(I);if(fn[U])return;fn[U]=!0;var G="";x&&x._owner&&x._owner!==_t.current&&(G=" It was passed a child from "+k(x._owner.type)+"."),Xt(x),L('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',U,G),Xt(null)}}function Qr(x,I){{if(typeof x!="object")return;if(Z(x))for(var U=0;U<x.length;U++){var G=x[U];fs(G)&&pn(G,I)}else if(fs(x))x._store&&(x._store.validated=!0);else if(x){var Q=V(x);if(typeof Q=="function"&&Q!==x.entries)for(var J=Q.call(x),se;!(se=J.next()).done;)fs(se.value)&&pn(se.value,I)}}}function Tn(x){{var I=x.type;if(I==null||typeof I=="string")return;var U;if(typeof I=="function")U=I.propTypes;else if(typeof I=="object"&&(I.$$typeof===u||I.$$typeof===f))U=I.propTypes;else return;if(U){var G=k(I);P(U,x.props,"prop",G,x)}else if(I.PropTypes!==void 0&&!kt){kt=!0;var Q=k(I);L("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Q||"Unknown")}typeof I.getDefaultProps=="function"&&!I.getDefaultProps.isReactClassApproved&&L("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function en(x){{for(var I=Object.keys(x.props),U=0;U<I.length;U++){var G=I[U];if(G!=="children"&&G!=="key"){Xt(x),L("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",G),Xt(null);break}}x.ref!==null&&(Xt(x),L("Invalid attribute `ref` supplied to `React.Fragment`."),Xt(null))}}var _={};function K(x,I,U,G,Q,J){{var se=j(x);if(!se){var Ce="";(x===void 0||typeof x=="object"&&x!==null&&Object.keys(x).length===0)&&(Ce+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Xe=Ts(Q);Xe?Ce+=Xe:Ce+=ns();var Ue;x===null?Ue="null":Z(x)?Ue="array":x!==void 0&&x.$$typeof===e?(Ue="<"+(k(x.type)||"Unknown")+" />",Ce=" Did you accidentally export a JSX literal instead of a component?"):Ue=typeof x,L("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ue,Ce)}var pe=me(x,I,U,Q,J);if(pe==null)return pe;if(se){var We=I.children;if(We!==void 0)if(G)if(Z(We)){for(var as=0;as<We.length;as++)Qr(We[as],x);Object.freeze&&Object.freeze(We)}else L("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Qr(We,x)}if(Qe.call(I,"key")){var Wt=k(x),Bt=Object.keys(I).filter(function(qs){return qs!=="key"}),jt=Bt.length>0?"{key: someKey, "+Bt.join(": ..., ")+": ...}":"{key: someKey}";if(!_[Wt+jt]){var Bs=Bt.length>0?"{"+Bt.join(": ..., ")+": ...}":"{}";L(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,jt,Wt,Bs,Wt),_[Wt+jt]=!0}}return x===n?en(pe):Tn(pe),pe}}var B=K;nu.Fragment=n,nu.jsxDEV=B})();ch.exports=nu;var a=ch.exports,uh,Pd=fN;{var Id=Pd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;uh=function(s,e){Id.usingClientEntryPoint=!0;try{return Pd.createRoot(s,e)}finally{Id.usingClientEntryPoint=!1}}}const GN="modulepreload",XN=function(s){return"/"+s},jd={},Kn=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=XN(u),u in jd)return;jd[u]=!0;const m=u.endsWith(".css"),d=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":GN,m||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((h,y)=>{f.addEventListener("load",h),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let JN={data:""},ZN=s=>{if(typeof window=="object"){let e=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(s||document.head).appendChild(e),e.firstChild}return s||JN},e0=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,t0=/\/\*[^]*?\*\/|  +/g,Rd=/\n+/g,xr=(s,e)=>{let t="",n="",r="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?xr(o,i):i+"{"+xr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=xr(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=xr.p?xr.p(i,o):i+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+n},Qn={},mh=s=>{if(typeof s=="object"){let e="";for(let t in s)e+=t+mh(s[t]);return e}return s},s0=(s,e,t,n,r)=>{let i=mh(s),o=Qn[i]||(Qn[i]=(u=>{let m=0,d=11;for(;m<u.length;)d=101*d+u.charCodeAt(m++)>>>0;return"go"+d})(i));if(!Qn[o]){let u=i!==s?s:(m=>{let d,f,h=[{}];for(;d=e0.exec(m.replace(t0,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Rd," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Rd," ").trim();return h[0]})(s);Qn[o]=xr(r?{["@keyframes "+o]:u}:u,t?"":"."+o)}let l=t&&Qn.g?Qn.g:null;return t&&(Qn.g=Qn[o]),((u,m,d,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=d?u+m.data:m.data+u)})(Qn[o],e,n,l),o},n0=(s,e,t)=>s.reduce((n,r,i)=>{let o=e[i];if(o&&o.call){let l=o(t),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":xr(l,""):l===!1?"":l}return n+r+(o??"")},"");function Ol(s){let e=this||{},t=s.call?s(e.p):s;return s0(t.unshift?t.raw?n0(t,[].slice.call(arguments,1),e.p):t.reduce((n,r)=>Object.assign(n,r&&r.call?r(e.p):r),{}):t,ZN(e.target),e.g,e.o,e.k)}let dh,ru,iu;Ol.bind({g:1});let tr=Ol.bind({k:1});function r0(s,e,t,n){xr.p=e,dh=s,ru=t,iu=n}function Br(s,e){let t=this||{};return function(){let n=arguments;function r(i,o){let l=Object.assign({},i),u=l.className||r.className;t.p=Object.assign({theme:ru&&ru()},l),t.o=/ *go\d+/.test(u),l.className=Ol.apply(t,n)+(u?" "+u:"");let m=s;return s[0]&&(m=l.as||s,delete l.as),iu&&m[0]&&iu(l),dh(m,l)}return r}}var i0=s=>typeof s=="function",Nl=(s,e)=>i0(s)?s(e):s,o0=(()=>{let s=0;return()=>(++s).toString()})(),fh=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");s=!e||e.matches}return s}})(),a0=20,em="default",ph=(s,e)=>{let{toastLimit:t}=s.settings;switch(e.type){case 0:return{...s,toasts:[e.toast,...s.toasts].slice(0,t)};case 1:return{...s,toasts:s.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:n}=e;return ph(s,{type:s.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...s,toasts:s.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...s,pausedAt:e.time};case 6:let i=e.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},nl=[],hh={toasts:[],pausedAt:void 0,settings:{toastLimit:a0}},Bn={},gh=(s,e=em)=>{Bn[e]=ph(Bn[e]||hh,s),nl.forEach(([t,n])=>{t===e&&n(Bn[e])})},yh=s=>Object.keys(Bn).forEach(e=>gh(s,e)),l0=s=>Object.keys(Bn).find(e=>Bn[e].toasts.some(t=>t.id===s)),Fl=(s=em)=>e=>{gh(e,s)},c0={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},u0=(s={},e=em)=>{let[t,n]=A.useState(Bn[e]||hh),r=A.useRef(Bn[e]);A.useEffect(()=>(r.current!==Bn[e]&&n(Bn[e]),nl.push([e,n]),()=>{let o=nl.findIndex(([l])=>l===e);o>-1&&nl.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var l,u,m;return{...s,...s[o.type],...o,removeDelay:o.removeDelay||((l=s[o.type])==null?void 0:l.removeDelay)||(s==null?void 0:s.removeDelay),duration:o.duration||((u=s[o.type])==null?void 0:u.duration)||(s==null?void 0:s.duration)||c0[o.type],style:{...s.style,...(m=s[o.type])==null?void 0:m.style,...o.style}}});return{...t,toasts:i}},m0=(s,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...t,id:(t==null?void 0:t.id)||o0()}),fa=s=>(e,t)=>{let n=m0(e,s,t);return Fl(n.toasterId||l0(n.id))({type:2,toast:n}),n.id},ws=(s,e)=>fa("blank")(s,e);ws.error=fa("error");ws.success=fa("success");ws.loading=fa("loading");ws.custom=fa("custom");ws.dismiss=(s,e)=>{let t={type:3,toastId:s};e?Fl(e)(t):yh(t)};ws.dismissAll=s=>ws.dismiss(void 0,s);ws.remove=(s,e)=>{let t={type:4,toastId:s};e?Fl(e)(t):yh(t)};ws.removeAll=s=>ws.remove(void 0,s);ws.promise=(s,e,t)=>{let n=ws.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof s=="function"&&(s=s()),s.then(r=>{let i=e.success?Nl(e.success,r):void 0;return i?ws.success(i,{id:n,...t,...t==null?void 0:t.success}):ws.dismiss(n),r}).catch(r=>{let i=e.error?Nl(e.error,r):void 0;i?ws.error(i,{id:n,...t,...t==null?void 0:t.error}):ws.dismiss(n)}),s};var d0=1e3,f0=(s,e="default")=>{let{toasts:t,pausedAt:n}=u0(s,e),r=A.useRef(new Map).current,i=A.useCallback((f,h=d0)=>{if(r.has(f))return;let y=setTimeout(()=>{r.delete(f),o({type:4,toastId:f})},h);r.set(f,y)},[]);A.useEffect(()=>{if(n)return;let f=Date.now(),h=t.map(y=>{if(y.duration===1/0)return;let T=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(T<0){y.visible&&ws.dismiss(y.id);return}return setTimeout(()=>ws.dismiss(y.id,e),T)});return()=>{h.forEach(y=>y&&clearTimeout(y))}},[t,n,e]);let o=A.useCallback(Fl(e),[e]),l=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=A.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),m=A.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),d=A.useCallback((f,h)=>{let{reverseOrder:y=!1,gutter:T=8,defaultPosition:v}=h||{},V=t.filter(q=>(q.position||v)===(f.position||v)&&q.height),R=V.findIndex(q=>q.id===f.id),L=V.filter((q,oe)=>oe<R&&q.visible).length;return V.filter(q=>q.visible).slice(...y?[L+1]:[0,L]).reduce((q,oe)=>q+(oe.height||0)+T,0)},[t]);return A.useEffect(()=>{t.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=r.get(f.id);h&&(clearTimeout(h),r.delete(f.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:u,startPause:l,endPause:m,calculateOffset:d}}},p0=tr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,h0=tr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,g0=tr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,y0=Br("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${p0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${h0} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${g0} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,b0=tr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,N0=Br("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${b0} 1s linear infinite;
`,x0=tr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,v0=tr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_0=Br("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${x0} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${v0} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,D0=Br("div")`
  position: absolute;
`,k0=Br("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,A0=tr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,E0=Br("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${A0} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,C0=({toast:s})=>{let{icon:e,type:t,iconTheme:n}=s;return e!==void 0?typeof e=="string"?A.createElement(E0,null,e):e:t==="blank"?null:A.createElement(k0,null,A.createElement(N0,{...n}),t!=="loading"&&A.createElement(D0,null,t==="error"?A.createElement(y0,{...n}):A.createElement(_0,{...n})))},V0=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,w0=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,S0="0%{opacity:0;} 100%{opacity:1;}",T0="0%{opacity:1;} 100%{opacity:0;}",L0=Br("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,P0=Br("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,I0=(s,e)=>{let t=s.includes("top")?1:-1,[n,r]=fh()?[S0,T0]:[V0(t),w0(t)];return{animation:e?`${tr(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${tr(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},j0=A.memo(({toast:s,position:e,style:t,children:n})=>{let r=s.height?I0(s.position||e||"top-center",s.visible):{opacity:0},i=A.createElement(C0,{toast:s}),o=A.createElement(P0,{...s.ariaProps},Nl(s.message,s));return A.createElement(L0,{className:s.className,style:{...r,...t,...s.style}},typeof n=="function"?n({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});r0(A.createElement);var R0=({id:s,className:e,style:t,onHeightUpdate:n,children:r})=>{let i=A.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(s,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[s,n]);return A.createElement("div",{ref:i,className:e,style:t},r)},B0=(s,e)=>{let t=s.includes("top"),n=t?{top:0}:{bottom:0},r=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:fh()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...r}},U0=Ol`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ia=16,H0=({reverseOrder:s,position:e="top-center",toastOptions:t,gutter:n,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:u,handlers:m}=f0(t,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ia,left:Ia,right:Ia,bottom:Ia,pointerEvents:"none",...o},className:l,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(d=>{let f=d.position||e,h=m.calculateOffset(d,{reverseOrder:s,gutter:n,defaultPosition:e}),y=B0(f,h);return A.createElement(R0,{id:d.id,key:d.id,onHeightUpdate:m.updateHeight,className:d.visible?U0:"",style:y},d.type==="custom"?Nl(d.message,d):r?r(d):A.createElement(j0,{toast:d,position:f}))}))},ne=ws;const $n=Object.create(null);$n.open="0";$n.close="1";$n.ping="2";$n.pong="3";$n.message="4";$n.upgrade="5";$n.noop="6";const rl=Object.create(null);Object.keys($n).forEach(s=>{rl[$n[s]]=s});const ou={type:"error",data:"parser error"},bh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Nh=typeof ArrayBuffer=="function",xh=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,tm=({type:s,data:e},t,n)=>bh&&e instanceof Blob?t?n(e):Bd(e,n):Nh&&(e instanceof ArrayBuffer||xh(e))?t?n(e):Bd(new Blob([e]),n):n($n[s]+(e||"")),Bd=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Ud(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Lc;function M0(s,e){if(bh&&s.data instanceof Blob)return s.data.arrayBuffer().then(Ud).then(e);if(Nh&&(s.data instanceof ArrayBuffer||xh(s.data)))return e(Ud(s.data));tm(s,!1,t=>{Lc||(Lc=new TextEncoder),e(Lc.encode(t))})}const Hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ro=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Hd.length;s++)Ro[Hd.charCodeAt(s)]=s;const O0=s=>{let e=s.length*.75,t=s.length,n,r=0,i,o,l,u;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const m=new ArrayBuffer(e),d=new Uint8Array(m);for(n=0;n<t;n+=4)i=Ro[s.charCodeAt(n)],o=Ro[s.charCodeAt(n+1)],l=Ro[s.charCodeAt(n+2)],u=Ro[s.charCodeAt(n+3)],d[r++]=i<<2|o>>4,d[r++]=(o&15)<<4|l>>2,d[r++]=(l&3)<<6|u&63;return m},F0=typeof ArrayBuffer=="function",sm=(s,e)=>{if(typeof s!="string")return{type:"message",data:vh(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:q0(s.substring(1),e)}:rl[t]?s.length>1?{type:rl[t],data:s.substring(1)}:{type:rl[t]}:ou},q0=(s,e)=>{if(F0){const t=O0(s);return vh(t,e)}else return{base64:!0,data:s}},vh=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},_h="",$0=(s,e)=>{const t=s.length,n=new Array(t);let r=0;s.forEach((i,o)=>{tm(i,!1,l=>{n[o]=l,++r===t&&e(n.join(_h))})})},W0=(s,e)=>{const t=s.split(_h),n=[];for(let r=0;r<t.length;r++){const i=sm(t[r],e);if(n.push(i),i.type==="error")break}return n};function z0(){return new TransformStream({transform(s,e){M0(s,t=>{const n=t.length;let r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let Pc;function ja(s){return s.reduce((e,t)=>e+t.length,0)}function Ra(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let r=0;r<e;r++)t[r]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function K0(s,e){Pc||(Pc=new TextDecoder);const t=[];let n=0,r=-1,i=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(ja(t)<1)break;const u=Ra(t,1);i=(u[0]&128)===128,r=u[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(ja(t)<2)break;const u=Ra(t,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(ja(t)<8)break;const u=Ra(t,8),m=new DataView(u.buffer,u.byteOffset,u.length),d=m.getUint32(0);if(d>Math.pow(2,21)-1){l.enqueue(ou);break}r=d*Math.pow(2,32)+m.getUint32(4),n=3}else{if(ja(t)<r)break;const u=Ra(t,r);l.enqueue(sm(i?u:Pc.decode(u),e)),n=0}if(r===0||r>s){l.enqueue(ou);break}}}})}const Dh=4;function Ds(s){if(s)return Q0(s)}function Q0(s){for(var e in Ds.prototype)s[e]=Ds.prototype[e];return s}Ds.prototype.on=Ds.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Ds.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Ds.prototype.off=Ds.prototype.removeListener=Ds.prototype.removeAllListeners=Ds.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Ds.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};Ds.prototype.emitReserved=Ds.prototype.emit;Ds.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ds.prototype.hasListeners=function(s){return!!this.listeners(s).length};const ql=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),gn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Y0="arraybuffer";function kh(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const G0=gn.setTimeout,X0=gn.clearTimeout;function $l(s,e){e.useNativeTimers?(s.setTimeoutFn=G0.bind(gn),s.clearTimeoutFn=X0.bind(gn)):(s.setTimeoutFn=gn.setTimeout.bind(gn),s.clearTimeoutFn=gn.clearTimeout.bind(gn))}const J0=1.33;function Z0(s){return typeof s=="string"?ex(s):Math.ceil((s.byteLength||s.size)*J0)}function ex(s){let e=0,t=0;for(let n=0,r=s.length;n<r;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Ah(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function tx(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function sx(s){let e={},t=s.split("&");for(let n=0,r=t.length;n<r;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class nx extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class nm extends Ds{constructor(e){super(),this.writable=!1,$l(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new nx(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=sm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=tx(e);return t.length?"?"+t:""}}class rx extends nm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};W0(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,$0(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Ah()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Eh=!1;try{Eh=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ix=Eh;function ox(){}class ax extends rx{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}let Wi=class il extends Ds{constructor(e,t,n){super(),this.createRequest=e,$l(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=kh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var r;n.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=il.requestsCount++,il.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ox,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete il.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Wi.requestsCount=0;Wi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Md);else if(typeof addEventListener=="function"){const s="onpagehide"in gn?"pagehide":"unload";addEventListener(s,Md,!1)}}function Md(){for(let s in Wi.requests)Wi.requests.hasOwnProperty(s)&&Wi.requests[s].abort()}const lx=function(){const s=Ch({xdomain:!1});return s&&s.responseType!==null}();class cx extends ax{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=lx&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Wi(Ch,this.uri(),e)}}function Ch(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ix))return new XMLHttpRequest}catch{}if(!e)try{return new gn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Vh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class ux extends nm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Vh?{}:kh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;tm(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}r&&ql(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ah()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Ic=gn.WebSocket||gn.MozWebSocket;class mx extends ux{createSocket(e,t,n){return Vh?new Ic(e,t,n):t?new Ic(e,t):new Ic(e)}doWrite(e,t){this.ws.send(t)}}class dx extends nm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=K0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=z0();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(({done:l,value:u})=>{l||(this.onPacket(u),i())}).catch(l=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&ql(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const fx={websocket:mx,webtransport:dx,polling:cx},px=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function au(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let r=px.exec(s||""),i={},o=14;for(;o--;)i[hx[o]]=r[o]||"";return t!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=gx(i,i.path),i.queryKey=yx(i,i.query),i}function gx(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function yx(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,i){r&&(t[r]=i)}),t}const lu=typeof addEventListener=="function"&&typeof removeEventListener=="function",ol=[];lu&&addEventListener("offline",()=>{ol.forEach(s=>s())},!1);class kr extends Ds{constructor(e,t){if(super(),this.binaryType=Y0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=au(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=au(t.host).host);$l(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const r=n.prototype.name;this.transports.push(r),this._transportsByName[r]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=sx(this.opts.query)),lu&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ol.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Dh,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&kr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",kr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+=Z0(r)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ql(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if(typeof t=="function"&&(r=t,t=void 0),typeof n=="function"&&(r=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(kr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lu&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=ol.indexOf(this._offlineEventListener);n!==-1&&ol.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}kr.protocol=Dh;class bx extends kr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;kr.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;kr.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){n||(n=!0,d(),t.close(),t=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function u(){o("socket closed")}function m(f){t&&f.name!==t.name&&i()}const d=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",m)};t.once("open",r),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Nx=class extends bx{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>fx[r]).filter(r=>!!r)),super(e,n)}};function xx(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=au(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}const vx=typeof ArrayBuffer=="function",_x=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,wh=Object.prototype.toString,Dx=typeof Blob=="function"||typeof Blob<"u"&&wh.call(Blob)==="[object BlobConstructor]",kx=typeof File=="function"||typeof File<"u"&&wh.call(File)==="[object FileConstructor]";function rm(s){return vx&&(s instanceof ArrayBuffer||_x(s))||Dx&&s instanceof Blob||kx&&s instanceof File}function al(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(al(s[t]))return!0;return!1}if(rm(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return al(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&al(s[t]))return!0;return!1}function Ax(s){const e=[],t=s.data,n=s;return n.data=cu(t,e),n.attachments=e.length,{packet:n,buffers:e}}function cu(s,e){if(!s)return s;if(rm(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=cu(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=cu(s[n],e));return t}return s}function Ex(s,e){return s.data=uu(s.data,e),delete s.attachments,s}function uu(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=uu(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=uu(s[t],e));return s}const Cx=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Vx=5;var Dt;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(Dt||(Dt={}));class wx{constructor(e){this.replacer=e}encode(e){return(e.type===Dt.EVENT||e.type===Dt.ACK)&&al(e)?this.encodeAsBinary({type:e.type===Dt.EVENT?Dt.BINARY_EVENT:Dt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Dt.BINARY_EVENT||e.type===Dt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Ax(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function Od(s){return Object.prototype.toString.call(s)==="[object Object]"}class im extends Ds{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Dt.BINARY_EVENT;n||t.type===Dt.BINARY_ACK?(t.type=n?Dt.EVENT:Dt.ACK,this.reconstructor=new Sx(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(rm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(Dt[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Dt.BINARY_EVENT||n.type===Dt.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(i,t)}else n.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(im.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Dt.CONNECT:return Od(t);case Dt.DISCONNECT:return t===void 0;case Dt.CONNECT_ERROR:return typeof t=="string"||Od(t);case Dt.EVENT:case Dt.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Cx.indexOf(t[0])===-1);case Dt.ACK:case Dt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Sx{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Ex(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Tx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:im,Encoder:wx,get PacketType(){return Dt},protocol:Vx},Symbol.toStringTag,{value:"Module"}));function _n(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const Lx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Sh extends Ds{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_n(e,"open",this.onopen.bind(this)),_n(e,"packet",this.onpacket.bind(this)),_n(e,"error",this.onerror.bind(this)),_n(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,i;if(Lx.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:Dt.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,f=t.pop();this._registerAckCallback(d,f),o.id=d}const l=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),o=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{const i=(o,l)=>o?r(o):n(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Dt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Dt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Dt.EVENT:case Dt.BINARY_EVENT:this.onevent(e);break;case Dt.ACK:case Dt.BINARY_ACK:this.onack(e);break;case Dt.DISCONNECT:this.ondisconnect();break;case Dt.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:Dt.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Dt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function no(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}no.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};no.prototype.reset=function(){this.attempts=0};no.prototype.setMin=function(s){this.ms=s};no.prototype.setMax=function(s){this.max=s};no.prototype.setJitter=function(s){this.jitter=s};class mu extends Ds{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,$l(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new no({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Tx;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Nx(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=_n(t,"open",function(){n.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=_n(t,"error",i);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_n(e,"ping",this.onping.bind(this)),_n(e,"data",this.ondata.bind(this)),_n(e,"error",this.onerror.bind(this)),_n(e,"close",this.onclose.bind(this)),_n(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){ql(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Sh(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const vo={};function Fo(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=xx(s,e.path||"/socket.io"),n=t.source,r=t.id,i=t.path,o=vo[r]&&i in vo[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new mu(n,e):(vo[r]||(vo[r]=new mu(n,e)),u=vo[r]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Fo,{Manager:mu,Socket:Sh,io:Fo,connect:Fo});function Px(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s;let l,u,m;const d=async(h=!0)=>{await u,await(m==null?void 0:m())};async function f(){if("serviceWorker"in navigator){if(l=await Kn(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;m=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const y=()=>{h=!0,l==null||l.addEventListener("controlling",T=>{T.isUpdate&&window.location.reload()}),t==null||t()};l.addEventListener("installed",T=>{typeof T.isUpdate>"u"?typeof T.isExternal<"u"?T.isExternal?y():!h&&(n==null||n()):T.isExternal?window.location.reload():!h&&(n==null||n()):T.isUpdate||n==null||n()}),l.addEventListener("waiting",y),l.addEventListener("externalwaiting",y)}l.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return u=f(),d}const Ix=()=>{if(typeof window<"u"){const s=window.location.hostname;if(s==="hvlab.app"||s.includes("hv-lab-app")||s.includes("firebaseapp.com"))return"https://asia-northeast3-hv-lab-app.cloudfunctions.net/api"}return"/api"},jx=Ix(),zi=bN.create({baseURL:jx,headers:{"Content-Type":"application/json"}});zi.interceptors.request.use(s=>{const e=localStorage.getItem("token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));zi.interceptors.response.use(s=>s,s=>{var e,t,n;return((e=s.response)==null?void 0:e.status)===401&&!((n=(t=s.config)==null?void 0:t.url)!=null&&n.includes("/auth/me"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Rx=()=>{};var Fd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Bx=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const r=s[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=s[t++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=s[t++],o=s[t++],l=s[t++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=s[t++],o=s[t++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Lh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<s.length;r+=3){const i=s[r],o=r+1<s.length,l=o?s[r+1]:0,u=r+2<s.length,m=u?s[r+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let h=(l&15)<<2|m>>6,y=m&63;u||(y=64,o||(h=64)),n.push(t[d],t[f],t[h],t[y])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Th(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Bx(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<s.length;){const i=t[s.charAt(r++)],l=r<s.length?t[s.charAt(r)]:0;++r;const m=r<s.length?t[s.charAt(r)]:64;++r;const f=r<s.length?t[s.charAt(r)]:64;if(++r,i==null||l==null||m==null||f==null)throw new Ux;const h=i<<2|l>>4;if(n.push(h),m!==64){const y=l<<4&240|m>>2;if(n.push(y),f!==64){const T=m<<6&192|f;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Ux extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Hx=function(s){const e=Th(s);return Lh.encodeByteArray(e,!0)},xl=function(s){return Hx(s).replace(/\./g,"")},Mx=function(s){try{return Lh.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx=()=>Ox().__FIREBASE_DEFAULTS__,qx=()=>{if(typeof process>"u"||typeof Fd>"u")return;const s=Fd.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},$x=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Mx(s[1]);return e&&JSON.parse(e)},om=()=>{try{return Rx()||Fx()||qx()||$x()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Wx=s=>{var e,t;return(t=(e=om())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},Ph=s=>{const e=Wx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Ih=()=>{var s;return(s=om())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function jh(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=s.iat||0,i=s.sub||s.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...s};return[xl(JSON.stringify(t)),xl(JSON.stringify(o)),""].join(".")}const qo={};function Kx(){const s={prod:[],emulator:[]};for(const e of Object.keys(qo))qo[e]?s.emulator.push(e):s.prod.push(e);return s}function Qx(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let qd=!1;function Bh(s,e){if(typeof window>"u"||typeof document>"u"||!pa(window.location.host)||qo[s]===e||qo[s]||qd)return;qo[s]=e;function t(h){return`__firebase__banner__${h}`}const n="__firebase__banner",i=Kx().prod.length>0;function o(){const h=document.getElementById(n);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function u(h,y){h.setAttribute("width","24"),h.setAttribute("id",y),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function m(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{qd=!0,o()},h}function d(h,y){h.setAttribute("id",y),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=Qx(n),y=t("text"),T=document.getElementById(y)||document.createElement("span"),v=t("learnmore"),V=document.getElementById(v)||document.createElement("a"),R=t("preprendIcon"),L=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const q=h.element;l(q),d(V,v);const oe=m();u(L,R),q.append(L,T,V,oe),document.body.appendChild(q)}i?(T.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gx(){var e;const s=(e=om())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Xx(){return!Gx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jx(){try{return typeof indexedDB=="object"}catch{return!1}}function Zx(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="FirebaseError";class mi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ev,Object.setPrototypeOf(this,mi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Uh.prototype.create)}}class Uh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?tv(i,n):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new mi(r,l,n)}}function tv(s,e){return s.replace(sv,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const sv=/\{\$([^}]+)}/g;function vl(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const i=s[r],o=e[r];if($d(i)&&$d(o)){if(!vl(i,o))return!1}else if(i!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function $d(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(s){return s&&s._delegate?s._delegate:s}class Qi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new zx;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iv(e))try{this.getOrInitializeService({instanceIdentifier:Zr})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=Zr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zr){return this.instances.has(e)}getOptions(e=Zr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:rv(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Zr){return this.component?this.component.multipleInstances?e:Zr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rv(s){return s===Zr?void 0:s}function iv(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nv(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ct||(Ct={}));const av={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},lv=Ct.INFO,cv={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},uv=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),r=cv[e];if(r)console[r](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hh{constructor(e){this.name=e,this._logLevel=lv,this._logHandler=uv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?av[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const mv=(s,e)=>e.some(t=>s instanceof t);let Wd,zd;function dv(){return Wd||(Wd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fv(){return zd||(zd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Mh=new WeakMap,du=new WeakMap,Oh=new WeakMap,jc=new WeakMap,am=new WeakMap;function pv(s){const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("success",i),s.removeEventListener("error",o)},i=()=>{t(Ar(s.result)),r()},o=()=>{n(s.error),r()};s.addEventListener("success",i),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Mh.set(t,s)}).catch(()=>{}),am.set(e,s),e}function hv(s){if(du.has(s))return;const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("complete",i),s.removeEventListener("error",o),s.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",i),s.addEventListener("error",o),s.addEventListener("abort",o)});du.set(s,e)}let fu={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return du.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Oh.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ar(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function gv(s){fu=s(fu)}function yv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Rc(this),e,...t);return Oh.set(n,e.sort?e.sort():[e]),Ar(n)}:fv().includes(s)?function(...e){return s.apply(Rc(this),e),Ar(Mh.get(this))}:function(...e){return Ar(s.apply(Rc(this),e))}}function bv(s){return typeof s=="function"?yv(s):(s instanceof IDBTransaction&&hv(s),mv(s,dv())?new Proxy(s,fu):s)}function Ar(s){if(s instanceof IDBRequest)return pv(s);if(jc.has(s))return jc.get(s);const e=bv(s);return e!==s&&(jc.set(s,e),am.set(e,s)),e}const Rc=s=>am.get(s);function Nv(s,e,{blocked:t,upgrade:n,blocking:r,terminated:i}={}){const o=indexedDB.open(s,e),l=Ar(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Ar(o.result),u.oldVersion,u.newVersion,Ar(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),l}const xv=["get","getKey","getAll","getAllKeys","count"],vv=["put","add","delete","clear"],Bc=new Map;function Kd(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Bc.get(e))return Bc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=vv.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||xv.includes(t)))return;const i=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let m=u.store;return n&&(m=m.index(l.shift())),(await Promise.all([m[t](...l),r&&u.done]))[0]};return Bc.set(e,i),i}gv(s=>({...s,get:(e,t,n)=>Kd(e,t)||s.get(e,t,n),has:(e,t)=>!!Kd(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Dv(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Dv(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pu="@firebase/app",Qd="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new Hh("@firebase/app"),kv="@firebase/app-compat",Av="@firebase/analytics-compat",Ev="@firebase/analytics",Cv="@firebase/app-check-compat",Vv="@firebase/app-check",wv="@firebase/auth",Sv="@firebase/auth-compat",Tv="@firebase/database",Lv="@firebase/data-connect",Pv="@firebase/database-compat",Iv="@firebase/functions",jv="@firebase/functions-compat",Rv="@firebase/installations",Bv="@firebase/installations-compat",Uv="@firebase/messaging",Hv="@firebase/messaging-compat",Mv="@firebase/performance",Ov="@firebase/performance-compat",Fv="@firebase/remote-config",qv="@firebase/remote-config-compat",$v="@firebase/storage",Wv="@firebase/storage-compat",zv="@firebase/firestore",Kv="@firebase/ai",Qv="@firebase/firestore-compat",Yv="firebase",Gv="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="[DEFAULT]",Xv={[pu]:"fire-core",[kv]:"fire-core-compat",[Ev]:"fire-analytics",[Av]:"fire-analytics-compat",[Vv]:"fire-app-check",[Cv]:"fire-app-check-compat",[wv]:"fire-auth",[Sv]:"fire-auth-compat",[Tv]:"fire-rtdb",[Lv]:"fire-data-connect",[Pv]:"fire-rtdb-compat",[Iv]:"fire-fn",[jv]:"fire-fn-compat",[Rv]:"fire-iid",[Bv]:"fire-iid-compat",[Uv]:"fire-fcm",[Hv]:"fire-fcm-compat",[Mv]:"fire-perf",[Ov]:"fire-perf-compat",[Fv]:"fire-rc",[qv]:"fire-rc-compat",[$v]:"fire-gcs",[Wv]:"fire-gcs-compat",[zv]:"fire-fst",[Qv]:"fire-fst-compat",[Kv]:"fire-vertex","fire-js":"fire-js",[Yv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo=new Map,Jv=new Map,gu=new Map;function Yd(s,e){try{s.container.addComponent(e)}catch(t){sr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ea(s){const e=s.name;if(gu.has(e))return sr.debug(`There were multiple attempts to register component ${e}.`),!1;gu.set(e,s);for(const t of Zo.values())Yd(t,s);for(const t of Jv.values())Yd(t,s);return!0}function Fh(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function qh(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Er=new Uh("app","Firebase",Zv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Er.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=Gv;function Wh(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:hu,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw Er.create("bad-app-name",{appName:String(r)});if(t||(t=Ih()),!t)throw Er.create("no-options");const i=Zo.get(r);if(i){if(vl(t,i.options)&&vl(n,i.config))return i;throw Er.create("duplicate-app",{appName:r})}const o=new ov(r);for(const u of gu.values())o.addComponent(u);const l=new e_(t,n,o);return Zo.set(r,l),l}function zh(s=hu){const e=Zo.get(s);if(!e&&s===hu&&Ih())return Wh();if(!e)throw Er.create("no-app",{appName:s});return e}function Gd(){return Array.from(Zo.values())}function Cr(s,e,t){let n=Xv[s]??s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sr.warn(o.join(" "));return}ea(new Qi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="firebase-heartbeat-database",s_=1,ta="firebase-heartbeat-store";let Uc=null;function Kh(){return Uc||(Uc=Nv(t_,s_,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(ta)}catch(t){console.warn(t)}}}}).catch(s=>{throw Er.create("idb-open",{originalErrorMessage:s.message})})),Uc}async function n_(s){try{const t=(await Kh()).transaction(ta),n=await t.objectStore(ta).get(Qh(s));return await t.done,n}catch(e){if(e instanceof mi)sr.warn(e.message);else{const t=Er.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sr.warn(t.message)}}}async function Xd(s,e){try{const n=(await Kh()).transaction(ta,"readwrite");await n.objectStore(ta).put(e,Qh(s)),await n.done}catch(t){if(t instanceof mi)sr.warn(t.message);else{const n=Er.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});sr.warn(n.message)}}}function Qh(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=1024,i_=30;class o_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new l_(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Jd();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>i_){const o=c_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){sr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Jd(),{heartbeatsToSend:n,unsentEntries:r}=a_(this._heartbeatsCache.heartbeats),i=xl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return sr.warn(t),""}}}function Jd(){return new Date().toISOString().substring(0,10)}function a_(s,e=r_){const t=[];let n=s.slice();for(const r of s){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Zd(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Zd(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class l_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jx()?Zx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await n_(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Zd(s){return xl(JSON.stringify({version:2,heartbeats:s})).length}function c_(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(s){ea(new Qi("platform-logger",e=>new _v(e),"PRIVATE")),ea(new Qi("heartbeat",e=>new o_(e),"PRIVATE")),Cr(pu,Qd,s),Cr(pu,Qd,"esm2020"),Cr("fire-js","")}u_("");var m_="firebase",d_="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cr(m_,d_,"app");var ef=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vr,Yh;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,N){function E(){}E.prototype=N.prototype,C.F=N.prototype,C.prototype=new E,C.prototype.constructor=C,C.D=function(j,S,w){for(var k=Array(arguments.length-2),De=2;De<arguments.length;De++)k[De-2]=arguments[De];return N.prototype[S].apply(j,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,N,E){E||(E=0);const j=Array(16);if(typeof N=="string")for(var S=0;S<16;++S)j[S]=N.charCodeAt(E++)|N.charCodeAt(E++)<<8|N.charCodeAt(E++)<<16|N.charCodeAt(E++)<<24;else for(S=0;S<16;++S)j[S]=N[E++]|N[E++]<<8|N[E++]<<16|N[E++]<<24;N=C.g[0],E=C.g[1],S=C.g[2];let w=C.g[3],k;k=N+(w^E&(S^w))+j[0]+3614090360&4294967295,N=E+(k<<7&4294967295|k>>>25),k=w+(S^N&(E^S))+j[1]+3905402710&4294967295,w=N+(k<<12&4294967295|k>>>20),k=S+(E^w&(N^E))+j[2]+606105819&4294967295,S=w+(k<<17&4294967295|k>>>15),k=E+(N^S&(w^N))+j[3]+3250441966&4294967295,E=S+(k<<22&4294967295|k>>>10),k=N+(w^E&(S^w))+j[4]+4118548399&4294967295,N=E+(k<<7&4294967295|k>>>25),k=w+(S^N&(E^S))+j[5]+1200080426&4294967295,w=N+(k<<12&4294967295|k>>>20),k=S+(E^w&(N^E))+j[6]+2821735955&4294967295,S=w+(k<<17&4294967295|k>>>15),k=E+(N^S&(w^N))+j[7]+4249261313&4294967295,E=S+(k<<22&4294967295|k>>>10),k=N+(w^E&(S^w))+j[8]+1770035416&4294967295,N=E+(k<<7&4294967295|k>>>25),k=w+(S^N&(E^S))+j[9]+2336552879&4294967295,w=N+(k<<12&4294967295|k>>>20),k=S+(E^w&(N^E))+j[10]+4294925233&4294967295,S=w+(k<<17&4294967295|k>>>15),k=E+(N^S&(w^N))+j[11]+2304563134&4294967295,E=S+(k<<22&4294967295|k>>>10),k=N+(w^E&(S^w))+j[12]+1804603682&4294967295,N=E+(k<<7&4294967295|k>>>25),k=w+(S^N&(E^S))+j[13]+4254626195&4294967295,w=N+(k<<12&4294967295|k>>>20),k=S+(E^w&(N^E))+j[14]+2792965006&4294967295,S=w+(k<<17&4294967295|k>>>15),k=E+(N^S&(w^N))+j[15]+1236535329&4294967295,E=S+(k<<22&4294967295|k>>>10),k=N+(S^w&(E^S))+j[1]+4129170786&4294967295,N=E+(k<<5&4294967295|k>>>27),k=w+(E^S&(N^E))+j[6]+3225465664&4294967295,w=N+(k<<9&4294967295|k>>>23),k=S+(N^E&(w^N))+j[11]+643717713&4294967295,S=w+(k<<14&4294967295|k>>>18),k=E+(w^N&(S^w))+j[0]+3921069994&4294967295,E=S+(k<<20&4294967295|k>>>12),k=N+(S^w&(E^S))+j[5]+3593408605&4294967295,N=E+(k<<5&4294967295|k>>>27),k=w+(E^S&(N^E))+j[10]+38016083&4294967295,w=N+(k<<9&4294967295|k>>>23),k=S+(N^E&(w^N))+j[15]+3634488961&4294967295,S=w+(k<<14&4294967295|k>>>18),k=E+(w^N&(S^w))+j[4]+3889429448&4294967295,E=S+(k<<20&4294967295|k>>>12),k=N+(S^w&(E^S))+j[9]+568446438&4294967295,N=E+(k<<5&4294967295|k>>>27),k=w+(E^S&(N^E))+j[14]+3275163606&4294967295,w=N+(k<<9&4294967295|k>>>23),k=S+(N^E&(w^N))+j[3]+4107603335&4294967295,S=w+(k<<14&4294967295|k>>>18),k=E+(w^N&(S^w))+j[8]+1163531501&4294967295,E=S+(k<<20&4294967295|k>>>12),k=N+(S^w&(E^S))+j[13]+2850285829&4294967295,N=E+(k<<5&4294967295|k>>>27),k=w+(E^S&(N^E))+j[2]+4243563512&4294967295,w=N+(k<<9&4294967295|k>>>23),k=S+(N^E&(w^N))+j[7]+1735328473&4294967295,S=w+(k<<14&4294967295|k>>>18),k=E+(w^N&(S^w))+j[12]+2368359562&4294967295,E=S+(k<<20&4294967295|k>>>12),k=N+(E^S^w)+j[5]+4294588738&4294967295,N=E+(k<<4&4294967295|k>>>28),k=w+(N^E^S)+j[8]+2272392833&4294967295,w=N+(k<<11&4294967295|k>>>21),k=S+(w^N^E)+j[11]+1839030562&4294967295,S=w+(k<<16&4294967295|k>>>16),k=E+(S^w^N)+j[14]+4259657740&4294967295,E=S+(k<<23&4294967295|k>>>9),k=N+(E^S^w)+j[1]+2763975236&4294967295,N=E+(k<<4&4294967295|k>>>28),k=w+(N^E^S)+j[4]+1272893353&4294967295,w=N+(k<<11&4294967295|k>>>21),k=S+(w^N^E)+j[7]+4139469664&4294967295,S=w+(k<<16&4294967295|k>>>16),k=E+(S^w^N)+j[10]+3200236656&4294967295,E=S+(k<<23&4294967295|k>>>9),k=N+(E^S^w)+j[13]+681279174&4294967295,N=E+(k<<4&4294967295|k>>>28),k=w+(N^E^S)+j[0]+3936430074&4294967295,w=N+(k<<11&4294967295|k>>>21),k=S+(w^N^E)+j[3]+3572445317&4294967295,S=w+(k<<16&4294967295|k>>>16),k=E+(S^w^N)+j[6]+76029189&4294967295,E=S+(k<<23&4294967295|k>>>9),k=N+(E^S^w)+j[9]+3654602809&4294967295,N=E+(k<<4&4294967295|k>>>28),k=w+(N^E^S)+j[12]+3873151461&4294967295,w=N+(k<<11&4294967295|k>>>21),k=S+(w^N^E)+j[15]+530742520&4294967295,S=w+(k<<16&4294967295|k>>>16),k=E+(S^w^N)+j[2]+3299628645&4294967295,E=S+(k<<23&4294967295|k>>>9),k=N+(S^(E|~w))+j[0]+4096336452&4294967295,N=E+(k<<6&4294967295|k>>>26),k=w+(E^(N|~S))+j[7]+1126891415&4294967295,w=N+(k<<10&4294967295|k>>>22),k=S+(N^(w|~E))+j[14]+2878612391&4294967295,S=w+(k<<15&4294967295|k>>>17),k=E+(w^(S|~N))+j[5]+4237533241&4294967295,E=S+(k<<21&4294967295|k>>>11),k=N+(S^(E|~w))+j[12]+1700485571&4294967295,N=E+(k<<6&4294967295|k>>>26),k=w+(E^(N|~S))+j[3]+2399980690&4294967295,w=N+(k<<10&4294967295|k>>>22),k=S+(N^(w|~E))+j[10]+4293915773&4294967295,S=w+(k<<15&4294967295|k>>>17),k=E+(w^(S|~N))+j[1]+2240044497&4294967295,E=S+(k<<21&4294967295|k>>>11),k=N+(S^(E|~w))+j[8]+1873313359&4294967295,N=E+(k<<6&4294967295|k>>>26),k=w+(E^(N|~S))+j[15]+4264355552&4294967295,w=N+(k<<10&4294967295|k>>>22),k=S+(N^(w|~E))+j[6]+2734768916&4294967295,S=w+(k<<15&4294967295|k>>>17),k=E+(w^(S|~N))+j[13]+1309151649&4294967295,E=S+(k<<21&4294967295|k>>>11),k=N+(S^(E|~w))+j[4]+4149444226&4294967295,N=E+(k<<6&4294967295|k>>>26),k=w+(E^(N|~S))+j[11]+3174756917&4294967295,w=N+(k<<10&4294967295|k>>>22),k=S+(N^(w|~E))+j[2]+718787259&4294967295,S=w+(k<<15&4294967295|k>>>17),k=E+(w^(S|~N))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+N&4294967295,C.g[1]=C.g[1]+(S+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+S&4294967295,C.g[3]=C.g[3]+w&4294967295}n.prototype.v=function(C,N){N===void 0&&(N=C.length);const E=N-this.blockSize,j=this.C;let S=this.h,w=0;for(;w<N;){if(S==0)for(;w<=E;)r(this,C,w),w+=this.blockSize;if(typeof C=="string"){for(;w<N;)if(j[S++]=C.charCodeAt(w++),S==this.blockSize){r(this,j),S=0;break}}else for(;w<N;)if(j[S++]=C[w++],S==this.blockSize){r(this,j),S=0;break}}this.h=S,this.o+=N},n.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var N=1;N<C.length-8;++N)C[N]=0;N=this.o*8;for(var E=C.length-8;E<C.length;++E)C[E]=N&255,N/=256;for(this.v(C),C=Array(16),N=0,E=0;E<4;++E)for(let j=0;j<32;j+=8)C[N++]=this.g[E]>>>j&255;return C};function i(C,N){var E=l;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=N(C)}function o(C,N){this.h=N;const E=[];let j=!0;for(let S=C.length-1;S>=0;S--){const w=C[S]|0;j&&w==N||(E[S]=w,j=!1)}this.g=E}var l={};function u(C){return-128<=C&&C<128?i(C,function(N){return new o([N|0],N<0?-1:0)}):new o([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return f;if(C<0)return V(m(-C));const N=[];let E=1;for(let j=0;C>=E;j++)N[j]=C/E|0,E*=4294967296;return new o(N,0)}function d(C,N){if(C.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(C.charAt(0)=="-")return V(d(C.substring(1),N));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=m(Math.pow(N,8));let j=f;for(let w=0;w<C.length;w+=8){var S=Math.min(8,C.length-w);const k=parseInt(C.substring(w,w+S),N);S<8?(S=m(Math.pow(N,S)),j=j.j(S).add(m(k))):(j=j.j(E),j=j.add(m(k)))}return j}var f=u(0),h=u(1),y=u(16777216);s=o.prototype,s.m=function(){if(v(this))return-V(this).m();let C=0,N=1;for(let E=0;E<this.g.length;E++){const j=this.i(E);C+=(j>=0?j:4294967296+j)*N,N*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(T(this))return"0";if(v(this))return"-"+V(this).toString(C);const N=m(Math.pow(C,6));var E=this;let j="";for(;;){const S=oe(E,N).g;E=R(E,S.j(N));let w=((E.g.length>0?E.g[0]:E.h)>>>0).toString(C);if(E=S,T(E))return w+j;for(;w.length<6;)w="0"+w;j=w+j}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function T(C){if(C.h!=0)return!1;for(let N=0;N<C.g.length;N++)if(C.g[N]!=0)return!1;return!0}function v(C){return C.h==-1}s.l=function(C){return C=R(this,C),v(C)?-1:T(C)?0:1};function V(C){const N=C.g.length,E=[];for(let j=0;j<N;j++)E[j]=~C.g[j];return new o(E,~C.h).add(h)}s.abs=function(){return v(this)?V(this):this},s.add=function(C){const N=Math.max(this.g.length,C.g.length),E=[];let j=0;for(let S=0;S<=N;S++){let w=j+(this.i(S)&65535)+(C.i(S)&65535),k=(w>>>16)+(this.i(S)>>>16)+(C.i(S)>>>16);j=k>>>16,w&=65535,k&=65535,E[S]=k<<16|w}return new o(E,E[E.length-1]&-2147483648?-1:0)};function R(C,N){return C.add(V(N))}s.j=function(C){if(T(this)||T(C))return f;if(v(this))return v(C)?V(this).j(V(C)):V(V(this).j(C));if(v(C))return V(this.j(V(C)));if(this.l(y)<0&&C.l(y)<0)return m(this.m()*C.m());const N=this.g.length+C.g.length,E=[];for(var j=0;j<2*N;j++)E[j]=0;for(j=0;j<this.g.length;j++)for(let S=0;S<C.g.length;S++){const w=this.i(j)>>>16,k=this.i(j)&65535,De=C.i(S)>>>16,Me=C.i(S)&65535;E[2*j+2*S]+=k*Me,L(E,2*j+2*S),E[2*j+2*S+1]+=w*Me,L(E,2*j+2*S+1),E[2*j+2*S+1]+=k*De,L(E,2*j+2*S+1),E[2*j+2*S+2]+=w*De,L(E,2*j+2*S+2)}for(C=0;C<N;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=N;C<2*N;C++)E[C]=0;return new o(E,0)};function L(C,N){for(;(C[N]&65535)!=C[N];)C[N+1]+=C[N]>>>16,C[N]&=65535,N++}function q(C,N){this.g=C,this.h=N}function oe(C,N){if(T(N))throw Error("division by zero");if(T(C))return new q(f,f);if(v(C))return N=oe(V(C),N),new q(V(N.g),V(N.h));if(v(N))return N=oe(C,V(N)),new q(V(N.g),N.h);if(C.g.length>30){if(v(C)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var E=h,j=N;j.l(C)<=0;)E=te(E),j=te(j);var S=O(E,1),w=O(j,1);for(j=O(j,2),E=O(E,2);!T(j);){var k=w.add(j);k.l(C)<=0&&(S=S.add(E),w=k),j=O(j,1),E=O(E,1)}return N=R(C,S.j(N)),new q(S,N)}for(S=f;C.l(N)>=0;){for(E=Math.max(1,Math.floor(C.m()/N.m())),j=Math.ceil(Math.log(E)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),w=m(E),k=w.j(N);v(k)||k.l(C)>0;)E-=j,w=m(E),k=w.j(N);T(w)&&(w=h),S=S.add(w),C=R(C,k)}return new q(S,C)}s.B=function(C){return oe(this,C).h},s.and=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<N;j++)E[j]=this.i(j)&C.i(j);return new o(E,this.h&C.h)},s.or=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<N;j++)E[j]=this.i(j)|C.i(j);return new o(E,this.h|C.h)},s.xor=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let j=0;j<N;j++)E[j]=this.i(j)^C.i(j);return new o(E,this.h^C.h)};function te(C){const N=C.g.length+1,E=[];for(let j=0;j<N;j++)E[j]=C.i(j)<<1|C.i(j-1)>>>31;return new o(E,C.h)}function O(C,N){const E=N>>5;N%=32;const j=C.g.length-E,S=[];for(let w=0;w<j;w++)S[w]=N>0?C.i(w+E)>>>N|C.i(w+E+1)<<32-N:C.i(w+E);return new o(S,C.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Yh=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=d,Vr=o}).apply(typeof ef<"u"?ef:typeof self<"u"?self:typeof window<"u"?window:{});var Ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gh,Bo,Xh,ll,yu,Jh,Zh,eg;(function(){var s,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ba=="object"&&Ba];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=t(this);function r(c,p){if(p)e:{var g=n;c=c.split(".");for(var D=0;D<c.length-1;D++){var $=c[D];if(!($ in g))break e;g=g[$]}c=c[c.length-1],D=g[c],p=p(D),p!=D&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(p){var g=[],D;for(D in p)Object.prototype.hasOwnProperty.call(p,D)&&g.push([D,p[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function u(c,p,g){return c.call.apply(c.bind,arguments)}function m(c,p,g){return m=u,m.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),c.apply(this,D)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(D,$,X){for(var ve=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)ve[dt-2]=arguments[dt];return p.prototype[$].apply(D,ve)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let D=0;D<p;D++)g[D]=c[D];return g}return[]}function T(c,p){for(let D=1;D<arguments.length;D++){const $=arguments[D];var g=typeof $;if(g=g!="object"?g:$?Array.isArray($)?"array":g:"null",g=="array"||g=="object"&&typeof $.length=="number"){g=c.length||0;const X=$.length||0;c.length=g+X;for(let ve=0;ve<X;ve++)c[g+ve]=$[ve]}else c.push($)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function V(c){o.setTimeout(()=>{throw c},0)}function R(){var c=C;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class L{constructor(){this.h=this.g=null}add(p,g){const D=q.get();D.set(p,g),this.h?this.h.next=D:this.g=D,this.h=D}}var q=new v(()=>new oe,c=>c.reset());class oe{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let te,O=!1,C=new L,N=()=>{const c=Promise.resolve(void 0);te=()=>{c.then(E)}};function E(){for(var c;c=R();){try{c.h.call(c.g)}catch(g){V(g)}var p=q;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}O=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var w=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function De(c,p){S.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(De,S),De.prototype.init=function(c,p){const g=this.type=c.type,D=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Me="closure_listenable_"+(Math.random()*1e6|0),he=0;function Re(c,p,g,D,$){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!D,this.ha=$,this.key=++he,this.da=this.fa=!1}function ft(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function qt(c,p,g){for(const D in c)p.call(g,c[D],D,c)}function Ot(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function ae(c){const p={};for(const g in c)p[g]=c[g];return p}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(c,p){let g,D;for(let $=1;$<arguments.length;$++){D=arguments[$];for(g in D)c[g]=D[g];for(let X=0;X<Oe.length;X++)g=Oe[X],Object.prototype.hasOwnProperty.call(D,g)&&(c[g]=D[g])}}function Ie(c){this.src=c,this.g={},this.h=0}Ie.prototype.add=function(c,p,g,D,$){const X=c.toString();c=this.g[X],c||(c=this.g[X]=[],this.h++);const ve=bt(c,p,D,$);return ve>-1?(p=c[ve],g||(p.fa=!1)):(p=new Re(p,this.src,X,!!D,$),p.fa=g,c.push(p)),p};function Ke(c,p){const g=p.type;if(g in c.g){var D=c.g[g],$=Array.prototype.indexOf.call(D,p,void 0),X;(X=$>=0)&&Array.prototype.splice.call(D,$,1),X&&(ft(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function bt(c,p,g,D){for(let $=0;$<c.length;++$){const X=c[$];if(!X.da&&X.listener==p&&X.capture==!!g&&X.ha==D)return $}return-1}var ot="closure_lm_"+(Math.random()*1e6|0),wt={};function rt(c,p,g,D,$){if(Array.isArray(p)){for(let X=0;X<p.length;X++)rt(c,p[X],g,D,$);return null}return g=$t(g),c&&c[Me]?c.J(p,g,l(D)?!!D.capture:!1,$):mt(c,p,g,!1,D,$)}function mt(c,p,g,D,$,X){if(!p)throw Error("Invalid event type");const ve=l($)?!!$.capture:!!$;let dt=Qe(c);if(dt||(c[ot]=dt=new Ie(c)),g=dt.add(p,g,D,ve,X),g.proxy)return g;if(D=ds(),g.proxy=D,D.src=c,D.listener=g,c.addEventListener)w||($=ve),$===void 0&&($=!1),c.addEventListener(p.toString(),D,$);else if(c.attachEvent)c.attachEvent(Be(p.toString()),D);else if(c.addListener&&c.removeListener)c.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ds(){function c(g){return p.call(c.src,c.listener,g)}const p=Se;return c}function z(c,p,g,D,$){if(Array.isArray(p))for(var X=0;X<p.length;X++)z(c,p[X],g,D,$);else D=l(D)?!!D.capture:!!D,g=$t(g),c&&c[Me]?(c=c.i,X=String(p).toString(),X in c.g&&(p=c.g[X],g=bt(p,g,D,$),g>-1&&(ft(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[X],c.h--)))):c&&(c=Qe(c))&&(p=c.g[p.toString()],c=-1,p&&(c=bt(p,g,D,$)),(g=c>-1?p[c]:null)&&Le(g))}function Le(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Me])Ke(p.i,c);else{var g=c.type,D=c.proxy;p.removeEventListener?p.removeEventListener(g,D,c.capture):p.detachEvent?p.detachEvent(Be(g),D):p.addListener&&p.removeListener&&p.removeListener(D),(g=Qe(p))?(Ke(g,c),g.h==0&&(g.src=null,p[ot]=null)):ft(c)}}}function Be(c){return c in wt?wt[c]:wt[c]="on"+c}function Se(c,p){if(c.da)c=!0;else{p=new De(p,this);const g=c.listener,D=c.ha||c.src;c.fa&&Le(c),c=g.call(D,p)}return c}function Qe(c){return c=c[ot],c instanceof Ie?c:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(c){return typeof c=="function"?c:(c[St]||(c[St]=function(p){return c.handleEvent(p)}),c[St])}function ut(){j.call(this),this.i=new Ie(this),this.M=this,this.G=null}f(ut,j),ut.prototype[Me]=!0,ut.prototype.removeEventListener=function(c,p,g,D){z(this,c,p,g,D)};function P(c,p){var g,D=c.G;if(D)for(g=[];D;D=D.G)g.push(D);if(c=c.M,D=p.type||p,typeof p=="string")p=new S(p,c);else if(p instanceof S)p.target=p.target||c;else{var $=p;p=new S(D,c),de(p,$)}$=!0;let X,ve;if(g)for(ve=g.length-1;ve>=0;ve--)X=p.g=g[ve],$=F(X,D,!0,p)&&$;if(X=p.g=c,$=F(X,D,!0,p)&&$,$=F(X,D,!1,p)&&$,g)for(ve=0;ve<g.length;ve++)X=p.g=g[ve],$=F(X,D,!1,p)&&$}ut.prototype.N=function(){if(ut.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let D=0;D<g.length;D++)ft(g[D]);delete c.g[p],c.h--}}this.G=null},ut.prototype.J=function(c,p,g,D){return this.i.add(String(c),p,!1,g,D)},ut.prototype.K=function(c,p,g,D){return this.i.add(String(c),p,!0,g,D)};function F(c,p,g,D){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let $=!0;for(let X=0;X<p.length;++X){const ve=p[X];if(ve&&!ve.da&&ve.capture==g){const dt=ve.listener,Cs=ve.ha||ve.src;ve.fa&&Ke(c.i,ve),$=dt.call(Cs,D)!==!1&&$}}return $&&!D.defaultPrevented}function Z(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function be(c){c.g=Z(()=>{c.g=null,c.i&&(c.i=!1,be(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ue extends j{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:be(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(c){j.call(this),this.h=c,this.g={}}f(fe,j);var Ve=[];function Fe(c){qt(c.g,function(p,g){this.g.hasOwnProperty(g)&&Le(p)},c),c.g={}}fe.prototype.N=function(){fe.Z.N.call(this),Fe(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ze=o.JSON.stringify,ke=o.JSON.parse,Rs=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Rt(){}function ee(){}var Ye={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function M(){S.call(this,"d")}f(M,S);function Ne(){S.call(this,"c")}f(Ne,S);var _e={},Pe=null;function me(){return Pe=Pe||new ut}_e.Ia="serverreachability";function _t(c){S.call(this,_e.Ia,c)}f(_t,S);function yt(c){const p=me();P(p,new _t(p))}_e.STAT_EVENT="statevent";function Xt(c,p){S.call(this,_e.STAT_EVENT,c),this.stat=p}f(Xt,S);function kt(c){const p=me();P(p,new Xt(p,c))}_e.Ja="timingevent";function fs(c,p){S.call(this,_e.Ja,c),this.size=p}f(fs,S);function ns(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function Ts(){this.g=!0}Ts.prototype.ua=function(){this.g=!1};function fn(c,p,g,D,$,X){c.info(function(){if(c.g)if(X){var ve="",dt=X.split("&");for(let Yt=0;Yt<dt.length;Yt++){var Cs=dt[Yt].split("=");if(Cs.length>1){const Ls=Cs[0];Cs=Cs[1];const Pn=Ls.split("_");ve=Pn.length>=2&&Pn[1]=="type"?ve+(Ls+"="+Cs+"&"):ve+(Ls+"=redacted&")}}}else ve=null;else ve=X;return"XMLHTTP REQ ("+D+") [attempt "+$+"]: "+p+`
`+g+`
`+ve})}function Ys(c,p,g,D,$,X,ve){c.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+$+"]: "+p+`
`+g+`
`+X+" "+ve})}function pn(c,p,g,D){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Tn(c,g)+(D?" "+D:"")})}function Qr(c,p){c.info(function(){return"TIMEOUT: "+p})}Ts.prototype.info=function(){};function Tn(c,p){if(!c.g)return p;if(!p)return null;try{const X=JSON.parse(p);if(X){for(c=0;c<X.length;c++)if(Array.isArray(X[c])){var g=X[c];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var $=D[0];if($!="noop"&&$!="stop"&&$!="close")for(let ve=1;ve<D.length;ve++)D[ve]=""}}}}return Ze(X)}catch{return p}}var en={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},K;function B(){}f(B,Rt),B.prototype.g=function(){return new XMLHttpRequest},K=new B;function x(c){return encodeURIComponent(String(c))}function I(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function U(c,p,g,D){this.j=c,this.i=p,this.l=g,this.S=D||1,this.V=new fe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new G}function G(){this.i=null,this.g="",this.h=!1}var Q={},J={};function se(c,p,g){c.M=1,c.A=bi(Jt(p)),c.u=g,c.R=!0,Ce(c,null)}function Ce(c,p){c.F=Date.now(),We(c),c.B=Jt(c.A);var g=c.B,D=c.S;Array.isArray(D)||(D=[String(D)]),le(g.i,"t",D),c.C=0,g=c.j.L,c.h=new G,c.g=kd(c.j,g?p:null,!c.u),c.P>0&&(c.O=new ue(m(c.Y,c,c.g),c.P)),p=c.V,g=c.g,D=c.ba;var $="readystatechange";Array.isArray($)||($&&(Ve[0]=$.toString()),$=Ve);for(let X=0;X<$.length;X++){const ve=rt(g,$[X],D||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=c.J?ae(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),yt(),fn(c.i,c.v,c.B,c.l,c.S,c.u)}U.prototype.ba=function(c){c=c.target;const p=this.O;p&&xn(c)==3?p.j():this.Y(c)},U.prototype.Y=function(c){try{if(c==this.g)e:{const dt=xn(this.g),Cs=this.g.ya(),Yt=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||fd(this.g)))){this.K||dt!=4||Cs==7||(Cs==8||Yt<=0?yt(3):yt(2)),Wt(this);var p=this.g.ca();this.X=p;var g=Xe(this);if(this.o=p==200,Ys(this.i,this.v,this.B,this.l,this.S,dt,p),this.o){if(this.U&&!this.L){t:{if(this.g){var D,$=this.g;if((D=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(D)){var X=D;break t}}X=null}if(c=X)pn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Bs(this,c);else{this.o=!1,this.m=3,kt(12),jt(this),Bt(this);break e}}if(this.R){c=!0;let Ls;for(;!this.K&&this.C<g.length;)if(Ls=pe(this,g),Ls==J){dt==4&&(this.m=4,kt(14),c=!1),pn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ls==Q){this.m=4,kt(15),pn(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else pn(this.i,this.l,Ls,null),Bs(this,Ls);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||g.length!=0||this.h.h||(this.m=1,kt(16),c=!1),this.o=this.o&&c,!c)pn(this.i,this.l,g,"[Invalid Chunked Response]"),jt(this),Bt(this);else if(g.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Cc(ve),ve.P=!0,kt(11))}}else pn(this.i,this.l,g,null),Bs(this,g);dt==4&&jt(this),this.o&&!this.K&&(dt==4?xd(this.j,this):(this.o=!1,We(this)))}else cN(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,kt(12)):(this.m=0,kt(13)),jt(this),Bt(this)}}}catch{}finally{}};function Xe(c){if(!Ue(c))return c.g.la();const p=fd(c.g);if(p==="")return"";let g="";const D=p.length,$=xn(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return jt(c),Bt(c),"";c.h.i=new o.TextDecoder}for(let X=0;X<D;X++)c.h.h=!0,g+=c.h.i.decode(p[X],{stream:!($&&X==D-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function Ue(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function pe(c,p){var g=c.C,D=p.indexOf(`
`,g);return D==-1?J:(g=Number(p.substring(g,D)),isNaN(g)?Q:(D+=1,D+g>p.length?J:(p=p.slice(D,D+g),c.C=D+g,p)))}U.prototype.cancel=function(){this.K=!0,jt(this)};function We(c){c.T=Date.now()+c.H,as(c,c.H)}function as(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ns(m(c.aa,c),p)}function Wt(c){c.D&&(o.clearTimeout(c.D),c.D=null)}U.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Qr(this.i,this.B),this.M!=2&&(yt(),kt(17)),jt(this),this.m=2,Bt(this)):as(this,this.T-c)};function Bt(c){c.j.I==0||c.K||xd(c.j,c)}function jt(c){Wt(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Fe(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Bs(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||Je(g.h,c))){if(!c.L&&Je(g.h,c)&&g.I==3){try{var D=g.Ba.g.parse(p)}catch{D=null}if(Array.isArray(D)&&D.length==3){var $=D;if($[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Ta(g),wa(g);else break e;Ec(g),kt(18)}}else g.xa=$[1],0<g.xa-g.K&&$[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ns(m(g.Va,g),6e3));Ae(g.h)<=1&&g.ta&&(g.ta=void 0)}else Yr(g,11)}else if((c.L||g.g==c)&&Ta(g),!k(p))for($=g.Ba.g.parse(p),p=0;p<$.length;p++){let Yt=$[p];const Ls=Yt[0];if(!(Ls<=g.K))if(g.K=Ls,Yt=Yt[1],g.I==2)if(Yt[0]=="c"){g.M=Yt[1],g.ba=Yt[2];const Pn=Yt[3];Pn!=null&&(g.ka=Pn,g.j.info("VER="+g.ka));const Gr=Yt[4];Gr!=null&&(g.za=Gr,g.j.info("SVER="+g.za));const mr=Yt[5];mr!=null&&typeof mr=="number"&&mr>0&&(D=1.5*mr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const dr=c.g;if(dr){const Pa=dr.g?dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pa){var X=D.h;X.g||Pa.indexOf("spdy")==-1&&Pa.indexOf("quic")==-1&&Pa.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(et(X,X.h),X.h=null))}if(D.G){const Vc=dr.g?dr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vc&&(D.wa=Vc,gt(D.J,D.G,Vc))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var ve=c;if(D.na=Dd(D,D.L?D.ba:null,D.W),ve.L){tt(D.h,ve);var dt=ve,Cs=D.O;Cs&&(dt.H=Cs),dt.D&&(Wt(dt),We(dt)),D.g=ve}else bd(D);g.i.length>0&&Sa(g)}else Yt[0]!="stop"&&Yt[0]!="close"||Yr(g,7);else g.I==3&&(Yt[0]=="stop"||Yt[0]=="close"?Yt[0]=="stop"?Yr(g,7):Ac(g):Yt[0]!="noop"&&g.l&&g.l.qa(Yt),g.A=0)}}yt(4)}catch{}}var qs=class{constructor(c,p){this.g=c,this.map=p}};function zt(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ze(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ae(c){return c.h?1:c.g?c.g.size:0}function Je(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function et(c,p){c.g?c.g.add(p):c.h=p}function tt(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}zt.prototype.cancel=function(){if(this.i=He(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function He(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Tt(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const D=c[g].indexOf("=");let $,X=null;D>=0?($=c[g].substring(0,D),X=c[g].substring(D+1)):$=c[g],p($,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function rs(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof rs?(this.l=c.l,bn(this,c.j),this.o=c.o,this.g=c.g,ar(this,c.u),this.h=c.h,ho(this,ye(c.i)),this.m=c.m):c&&(p=String(c).match(st))?(this.l=!1,bn(this,p[1]||"",!0),this.o=lr(p[2]||""),this.g=lr(p[3]||"",!0),ar(this,p[4]),this.h=lr(p[5]||"",!0),ho(this,p[6]||"",!0),this.m=lr(p[7]||"")):(this.l=!1,this.i=new ur(null,this.l))}rs.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(cr(p,go,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(cr(p,go,!0),"@"),c.push(x(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(cr(g,g.charAt(0)=="/"?vc:Va,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",cr(g,Dc)),c.join("")},rs.prototype.resolve=function(c){const p=Jt(this);let g=!!c.j;g?bn(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var D=c.h;if(g)ar(p,c.u);else if(g=!!c.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var $=p.h.lastIndexOf("/");$!=-1&&(D=p.h.slice(0,$+1)+D)}if($=D,$==".."||$==".")D="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){D=$.lastIndexOf("/",0)==0,$=$.split("/");const X=[];for(let ve=0;ve<$.length;){const dt=$[ve++];dt=="."?D&&ve==$.length&&X.push(""):dt==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),D&&ve==$.length&&X.push("")):(X.push(dt),D=!0)}D=X.join("/")}else D=$}return g?p.h=D:g=c.i.toString()!=="",g?ho(p,ye(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Jt(c){return new rs(c)}function bn(c,p,g){c.j=g?lr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ar(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function ho(c,p,g){p instanceof ur?(c.i=p,lt(c.i,c.l)):(g||(p=cr(p,_c)),c.i=new ur(p,c.l))}function gt(c,p,g){c.i.set(p,g)}function bi(c){return gt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function lr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function cr(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,Ca),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ca(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var go=/[#\/\?@]/g,Va=/[#\?:]/g,vc=/[#\?]/g,_c=/[#\?@]/g,Dc=/#/g;function ur(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function b(c){c.g||(c.g=new Map,c.h=0,c.i&&Tt(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}s=ur.prototype,s.add=function(c,p){b(this),this.i=null,c=ge(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function H(c,p){b(c),p=ge(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y(c,p){return b(c),p=ge(c,p),c.g.has(p)}s.forEach=function(c,p){b(this),this.g.forEach(function(g,D){g.forEach(function($){c.call(p,$,D,this)},this)},this)};function W(c,p){b(c);let g=[];if(typeof p=="string")Y(c,p)&&(g=g.concat(c.g.get(ge(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}s.set=function(c,p){return b(this),this.i=null,c=ge(this,c),Y(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},s.get=function(c,p){return c?(c=W(this,c),c.length>0?String(c[0]):p):p};function le(c,p,g){H(c,p),g.length>0&&(c.i=null,c.g.set(ge(c,p),y(g)),c.h+=g.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let D=0;D<p.length;D++){var g=p[D];const $=x(g);g=W(this,g);for(let X=0;X<g.length;X++){let ve=$;g[X]!==""&&(ve+="="+x(g[X])),c.push(ve)}}return this.i=c.join("&")};function ye(c){const p=new ur;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ge(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function lt(c,p){p&&!c.j&&(b(c),c.i=null,c.g.forEach(function(g,D){const $=D.toLowerCase();D!=$&&(H(this,D),le(this,$,g))},c)),c.j=p}function pt(c,p){const g=new Ts;if(o.Image){const D=new Image;D.onload=d(Lt,g,"TestLoadImage: loaded",!0,p,D),D.onerror=d(Lt,g,"TestLoadImage: error",!1,p,D),D.onabort=d(Lt,g,"TestLoadImage: abort",!1,p,D),D.ontimeout=d(Lt,g,"TestLoadImage: timeout",!1,p,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=c}else p(!1)}function gs(c,p){const g=new Ts,D=new AbortController,$=setTimeout(()=>{D.abort(),Lt(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:D.signal}).then(X=>{clearTimeout($),X.ok?Lt(g,"TestPingServer: ok",!0,p):Lt(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout($),Lt(g,"TestPingServer: error",!1,p)})}function Lt(c,p,g,D,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),D(g)}catch{}}function Pt(){this.g=new Rs}function is(c){this.i=c.Sb||null,this.h=c.ab||!1}f(is,Rt),is.prototype.g=function(){return new Es(this.i,this.h)};function Es(c,p){ut.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Es,ut),s=Es.prototype,s.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ps(this)},s.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ts(this)),this.readyState=0},s.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;At(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function At(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}s.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?ts(this):ps(this),this.readyState==3&&At(this)}},s.Oa=function(c){this.g&&(this.response=this.responseText=c,ts(this))},s.Na=function(c){this.g&&(this.response=c,ts(this))},s.ga=function(){this.g&&ts(this)};function ts(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ps(c)}s.setRequestHeader=function(c,p){this.A.append(c,p)},s.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function ps(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Kt(c){let p="";return qt(c,function(g,D){p+=D,p+=":",p+=g,p+=`\r
`}),p}function Qt(c,p,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=Kt(g),typeof c=="string"?g!=null&&x(g):gt(c,p,g))}function ht(c){ut.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ht,ut);var es=/^https?$/i,Nn=["POST","PUT"];s=ht.prototype,s.Fa=function(c){this.H=c},s.ea=function(c,p,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():K.g(),this.g.onreadystatechange=h(m(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(X){Ln(this,X);return}if(c=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var $ in D)g.set($,D[$]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const X of D.keys())g.set(X,D.get(X));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(X=>X.toLowerCase()=="content-type"),$=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Nn,p,void 0)>=0)||D||$||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ve]of g)this.g.setRequestHeader(X,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(X){Ln(this,X)}};function Ln(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,Ni(c),xi(c)}function Ni(c){c.A||(c.A=!0,P(c,"complete"),P(c,"error"))}s.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,P(this,"complete"),P(this,"abort"),xi(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xi(this,!0)),ht.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kc(this):this.Xa())},s.Xa=function(){kc(this)};function kc(c){if(c.h&&typeof i<"u"){if(c.v&&xn(c)==4)setTimeout(c.Ca.bind(c),0);else if(P(c,"readystatechange"),xn(c)==4){c.h=!1;try{const X=c.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var D;if(D=X===0){let ve=String(c.D).match(st)[1]||null;!ve&&o.self&&o.self.location&&(ve=o.self.location.protocol.slice(0,-1)),D=!es.test(ve?ve.toLowerCase():"")}g=D}if(g)P(c,"complete"),P(c,"success");else{c.o=6;try{var $=xn(c)>2?c.g.statusText:""}catch{$=""}c.l=$+" ["+c.ca()+"]",Ni(c)}}finally{xi(c)}}}}function xi(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||P(c,"ready");try{g.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function xn(c){return c.g?c.g.readyState:0}s.ca=function(){try{return xn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),ke(p)}};function fd(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function cN(c){const p={};c=(c.g&&xn(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<c.length;D++){if(k(c[D]))continue;var g=I(c[D]);const $=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const X=p[$]||[];p[$]=X,X.push(g)}Ot(p,function(D){return D.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yo(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function pd(c){this.za=0,this.i=[],this.j=new Ts,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yo("baseRetryDelayMs",5e3,c),this.Za=yo("retryDelaySeedMs",1e4,c),this.Ta=yo("forwardChannelMaxRetries",2,c),this.va=yo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new zt(c&&c.concurrentRequestLimit),this.Ba=new Pt,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=pd.prototype,s.ka=8,s.I=1,s.connect=function(c,p,g,D){kt(0),this.W=c,this.H=p||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=Dd(this,null,this.W),Sa(this)};function Ac(c){if(hd(c),c.I==3){var p=c.V++,g=Jt(c.J);if(gt(g,"SID",c.M),gt(g,"RID",p),gt(g,"TYPE","terminate"),bo(c,g),p=new U(c,c.j,p),p.M=2,p.A=bi(Jt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=kd(p.j,null),p.g.ea(p.A)),p.F=Date.now(),We(p)}_d(c)}function wa(c){c.g&&(Cc(c),c.g.cancel(),c.g=null)}function hd(c){wa(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ta(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Sa(c){if(!ze(c.h)&&!c.m){c.m=!0;var p=c.Ea;te||N(),O||(te(),O=!0),C.add(p,c),c.D=0}}function uN(c,p){return Ae(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ns(m(c.Ea,c,p),vd(c,c.D)),c.D++,!0)}s.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const $=new U(this,this.j,c);let X=this.o;if(this.U&&(X?(X=ae(X),de(X,this.U)):X=this.U),this.u!==null||this.R||($.J=X,X=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(p+=D,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=yd(this,$,p),g=Jt(this.J),gt(g,"RID",c),gt(g,"CVER",22),this.G&&gt(g,"X-HTTP-Session-Id",this.G),bo(this,g),X&&(this.R?p="headers="+x(Kt(X))+"&"+p:this.u&&Qt(g,this.u,X)),et(this.h,$),this.Ra&&gt(g,"TYPE","init"),this.S?(gt(g,"$req",p),gt(g,"SID","null"),$.U=!0,se($,g,null)):se($,g,p),this.I=2}}else this.I==3&&(c?gd(this,c):this.i.length==0||ze(this.h)||gd(this))};function gd(c,p){var g;p?g=p.l:g=c.V++;const D=Jt(c.J);gt(D,"SID",c.M),gt(D,"RID",g),gt(D,"AID",c.K),bo(c,D),c.u&&c.o&&Qt(D,c.u,c.o),g=new U(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=yd(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),et(c.h,g),se(g,D,p)}function bo(c,p){c.H&&qt(c.H,function(g,D){gt(p,D,g)}),c.l&&qt({},function(g,D){gt(p,D,g)})}function yd(c,p,g){g=Math.min(c.i.length,g);const D=c.l?m(c.l.Ka,c.l,c):null;e:{var $=c.i;let dt=-1;for(;;){const Cs=["count="+g];dt==-1?g>0?(dt=$[0].g,Cs.push("ofs="+dt)):dt=0:Cs.push("ofs="+dt);let Yt=!0;for(let Ls=0;Ls<g;Ls++){var X=$[Ls].g;const Pn=$[Ls].map;if(X-=dt,X<0)dt=Math.max(0,$[Ls].g-100),Yt=!1;else try{X="req"+X+"_"||"";try{var ve=Pn instanceof Map?Pn:Object.entries(Pn);for(const[Gr,mr]of ve){let dr=mr;l(mr)&&(dr=Ze(mr)),Cs.push(X+Gr+"="+encodeURIComponent(dr))}}catch(Gr){throw Cs.push(X+"type="+encodeURIComponent("_badmap")),Gr}}catch{D&&D(Pn)}}if(Yt){ve=Cs.join("&");break e}}ve=void 0}return c=c.i.splice(0,g),p.G=c,ve}function bd(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;te||N(),O||(te(),O=!0),C.add(p,c),c.A=0}}function Ec(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ns(m(c.Da,c),vd(c,c.A)),c.A++,!0)}s.Da=function(){if(this.v=null,Nd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ns(m(this.Wa,this),c)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,kt(10),wa(this),Nd(this))};function Cc(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Nd(c){c.g=new U(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Jt(c.na);gt(p,"RID","rpc"),gt(p,"SID",c.M),gt(p,"AID",c.K),gt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&gt(p,"TO",c.ia),gt(p,"TYPE","xmlhttp"),bo(c,p),c.u&&c.o&&Qt(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=bi(Jt(p)),g.u=null,g.R=!0,Ce(g,c)}s.Va=function(){this.C!=null&&(this.C=null,wa(this),Ec(this),kt(19))};function Ta(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function xd(c,p){var g=null;if(c.g==p){Ta(c),Cc(c),c.g=null;var D=2}else if(Je(c.h,p))g=p.G,tt(c.h,p),D=1;else return;if(c.I!=0){if(p.o)if(D==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var $=c.D;D=me(),P(D,new fs(D,g)),Sa(c)}else bd(c);else if($=p.m,$==3||$==0&&p.X>0||!(D==1&&uN(c,p)||D==2&&Ec(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),$){case 1:Yr(c,5);break;case 4:Yr(c,10);break;case 3:Yr(c,6);break;default:Yr(c,2)}}}function vd(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Yr(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.bb,c),D=c.Ua;const $=!D;D=new rs(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||bn(D,"https"),bi(D),$?pt(D.toString(),g):gs(D.toString(),g)}else kt(2);c.I=0,c.l&&c.l.pa(p),_d(c),hd(c)}s.bb=function(c){c?(this.j.info("Successfully pinged google.com"),kt(2)):(this.j.info("Failed to ping google.com"),kt(1))};function _d(c){if(c.I=0,c.ja=[],c.l){const p=He(c.h);(p.length!=0||c.i.length!=0)&&(T(c.ja,p),T(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function Dd(c,p,g){var D=g instanceof rs?Jt(g):new rs(g);if(D.g!="")p&&(D.g=p+"."+D.g),ar(D,D.u);else{var $=o.location;D=$.protocol,p=p?p+"."+$.hostname:$.hostname,$=+$.port;const X=new rs(null);D&&bn(X,D),p&&(X.g=p),$&&ar(X,$),g&&(X.h=g),D=X}return g=c.G,p=c.wa,g&&p&&gt(D,g,p),gt(D,"VER",c.ka),bo(c,D),D}function kd(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new ht(new is({ab:g})):new ht(c.ma),p.Fa(c.L),p}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ad(){}s=Ad.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function La(){}La.prototype.g=function(c,p){return new an(c,p)};function an(c,p){ut.call(this),this.g=new pd(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new vi(this)}f(an,ut),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Ac(this.g)},an.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Ze(c),c=g);p.i.push(new qs(p.Ya++,c)),p.I==3&&Sa(p)},an.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,an.Z.N.call(this)};function Ed(c){M.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Ed,M);function Cd(){Ne.call(this),this.status=1}f(Cd,Ne);function vi(c){this.g=c}f(vi,Ad),vi.prototype.ra=function(){P(this.g,"a")},vi.prototype.qa=function(c){P(this.g,new Ed(c))},vi.prototype.pa=function(c){P(this.g,new Cd)},vi.prototype.oa=function(){P(this.g,"b")},La.prototype.createWebChannel=La.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,eg=function(){return new La},Zh=function(){return me()},Jh=_e,yu={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,ll=en,_.COMPLETE="complete",Xh=_,ee.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",ut.prototype.listen=ut.prototype.J,Bo=ee,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,Gh=ht}).apply(typeof Ba<"u"?Ba:typeof self<"u"?self:typeof window<"u"?window:{});const tf="@firebase/firestore",sf="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zs.UNAUTHENTICATED=new zs(null),zs.GOOGLE_CREDENTIALS=new zs("google-credentials-uid"),zs.FIRST_PARTY=new zs("first-party-uid"),zs.MOCK_USER=new zs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ro="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=new Hh("@firebase/firestore");function Bi(){return ai.logLevel}function we(s,...e){if(ai.logLevel<=Ct.DEBUG){const t=e.map(lm);ai.debug(`Firestore (${ro}): ${s}`,...t)}}function nr(s,...e){if(ai.logLevel<=Ct.ERROR){const t=e.map(lm);ai.error(`Firestore (${ro}): ${s}`,...t)}}function Yi(s,...e){if(ai.logLevel<=Ct.WARN){const t=e.map(lm);ai.warn(`Firestore (${ro}): ${s}`,...t)}}function lm(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,tg(s,n,t)}function tg(s,e,t){let n=`FIRESTORE (${ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw nr(n),new Error(n)}function Mt(s,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,s||tg(e,r,n)}function it(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends mi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class f_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(zs.UNAUTHENTICATED))}shutdown(){}}class p_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class h_{constructor(e){this.t=e,this.currentUser=zs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Mt(this.o===void 0,42304);let n=this.i;const r=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let i=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zn,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Mt(typeof n.accessToken=="string",31837,{l:n}),new sg(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mt(e===null||typeof e=="string",2055,{h:e}),new zs(e)}}class g_{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=zs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class y_{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new g_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(zs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b_{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Mt(this.o===void 0,3512);const n=i=>{i.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,we("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const r=i=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nf(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Mt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=N_(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function xt(s,e){return s<e?-1:s>e?1:0}function bu(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const r=s.charAt(n),i=e.charAt(n);if(r!==i)return Hc(r)===Hc(i)?xt(r,i):Hc(r)?1:-1}return xt(s.length,e.length)}const x_=55296,v_=57343;function Hc(s){const e=s.charCodeAt(0);return e>=x_&&e<=v_}function Gi(s,e,t){return s.length===e.length&&s.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf="__name__";class jn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ge(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ge(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return jn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof jn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const i=jn.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return xt(e.length,t.length)}static compareSegments(e,t){const n=jn.isNumericId(e),r=jn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?jn.extractNumericId(e).compare(jn.extractNumericId(t)):bu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vr.fromString(e.substring(4,e.length-2))}}class Zt extends jn{construct(e,t,n){return new Zt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Zt(t)}static emptyPath(){return new Zt([])}}const __=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ms extends jn{construct(e,t,n){return new Ms(e,t,n)}static isValidIdentifier(e){return __.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ms.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rf}static keyField(){return new Ms([rf])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ee(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ee(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(n+=l,r++):(i(),r++)}if(i(),o)throw new Ee(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ms(t)}static emptyPath(){return new Ms([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Zt.fromString(e))}static fromName(e){return new $e(Zt.fromString(e).popFirst(5))}static empty(){return new $e(Zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Zt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(s,e,t){if(!t)throw new Ee(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function D_(s,e,t,n){if(e===!0&&n===!0)throw new Ee(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function of(s){if(!$e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function af(s){if($e.isDocumentKey(s))throw new Ee(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function rg(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Wl(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ge(12329,{type:typeof s})}function Js(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ee(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Wl(s);throw new Ee(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function ha(s,e){if(!rg(s))throw new Ee(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const o=s[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new Ee(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=-62135596800,cf=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*cf);return new xe(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lf)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cf}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ha(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:ks("string",xe._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{static fromTimestamp(e){return new nt(e)}static min(){return new nt(new xe(0,0))}static max(){return new nt(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa=-1;function k_(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,r=nt.fromTimestamp(n===1e9?new xe(t+1,0):new xe(t,n));return new Sr(r,$e.empty(),e)}function A_(s){return new Sr(s.readTime,s.key,sa)}class Sr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Sr(nt.min(),$e.empty(),sa)}static max(){return new Sr(nt.max(),$e.empty(),sa)}}function E_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=$e.comparator(s.documentKey,e.documentKey),t!==0?t:xt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==C_)throw s;we("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&t()},u=>n(u))}),o=!0,i===r&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(r=>r?ce.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,i)=>{n.push(t.call(this,r,i))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,r)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const m=u;t(e[m]).next(d=>{o[m]=d,++l,l===i&&n(o)},d=>r(d))}})}static doWhile(e,t){return new ce((n,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):n()};i()})}}function w_(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oo(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=-1;function Kl(s){return s==null}function _l(s){return s===0&&1/s==-1/0}function S_(s){return typeof s=="number"&&Number.isInteger(s)&&!_l(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="";function T_(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=uf(e)),e=L_(s.get(t),e);return uf(e)}function L_(s,e){let t=e;const n=s.length;for(let r=0;r<n;r++){const i=s.charAt(r);switch(i){case"\0":t+="";break;case ig:t+="";break;default:t+=i}}return t}function uf(s){return s+ig+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Ur(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function og(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,t){this.comparator=e,this.root=t||Us.EMPTY}insert(e,t){return new os(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Us.BLACK,null,null))}remove(e){return new os(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Us.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ua(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ua(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ua(this.root,e,this.comparator,!0)}}class Ua{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Us{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??Us.RED,this.left=r??Us.EMPTY,this.right=i??Us.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Us(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Us.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Us.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Us.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Us.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ge(27949);return e+(this.isRed()?0:1)}}Us.EMPTY=null,Us.RED=!0,Us.BLACK=!1;Us.EMPTY=new class{constructor(){this.size=0}get key(){throw Ge(57766)}get value(){throw Ge(16141)}get color(){throw Ge(16727)}get left(){throw Ge(29726)}get right(){throw Ge(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Us(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.comparator=e,this.data=new os(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new df(this.data.getIterator())}getIteratorFrom(e){return new df(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ss(this.comparator);return t.data=e,t}}class df{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Ms.comparator)}static empty(){return new un([])}unionWith(e){let t=new Ss(Ms.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new ag("Invalid base64 string: "+i):i}}(e);return new Fs(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const P_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tr(s){if(Mt(!!s,39018),typeof s=="string"){let e=0;const t=P_.exec(s);if(Mt(!!t,46558,{timestamp:s}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Lr(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="server_timestamp",cg="__type__",ug="__previous_value__",mg="__local_write_time__";function mm(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[cg])==null?void 0:n.stringValue)===lg}function Ql(s){const e=s.mapValue.fields[ug];return mm(e)?Ql(e):e}function na(s){const e=Tr(s.mapValue.fields[mg].timestampValue);return new xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,t,n,r,i,o,l,u,m,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=m,this.isUsingEmulator=d}}const Dl="(default)";class ra{constructor(e,t){this.projectId=e,this.database=t||Dl}static empty(){return new ra("","")}get isDefaultDatabase(){return this.database===Dl}isEqual(e){return e instanceof ra&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="__type__",j_="__max__",Ha={mapValue:{}},fg="__vector__",kl="value";function Pr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?mm(s)?4:B_(s)?9007199254740991:R_(s)?10:11:Ge(28295,{value:s})}function Wn(s,e){if(s===e)return!0;const t=Pr(s);if(t!==Pr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return na(s).isEqual(na(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Tr(r.timestampValue),l=Tr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(r,i){return Lr(r.bytesValue).isEqual(Lr(i.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(r,i){return hs(r.geoPointValue.latitude)===hs(i.geoPointValue.latitude)&&hs(r.geoPointValue.longitude)===hs(i.geoPointValue.longitude)}(s,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return hs(r.integerValue)===hs(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=hs(r.doubleValue),l=hs(i.doubleValue);return o===l?_l(o)===_l(l):isNaN(o)&&isNaN(l)}return!1}(s,e);case 9:return Gi(s.arrayValue.values||[],e.arrayValue.values||[],Wn);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(mf(o)!==mf(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Wn(o[u],l[u])))return!1;return!0}(s,e);default:return Ge(52216,{left:s})}}function ia(s,e){return(s.values||[]).find(t=>Wn(t,e))!==void 0}function Xi(s,e){if(s===e)return 0;const t=Pr(s),n=Pr(e);if(t!==n)return xt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return xt(s.booleanValue,e.booleanValue);case 2:return function(i,o){const l=hs(i.integerValue||i.doubleValue),u=hs(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(s,e);case 3:return ff(s.timestampValue,e.timestampValue);case 4:return ff(na(s),na(e));case 5:return bu(s.stringValue,e.stringValue);case 6:return function(i,o){const l=Lr(i),u=Lr(o);return l.compareTo(u)}(s.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let m=0;m<l.length&&m<u.length;m++){const d=xt(l[m],u[m]);if(d!==0)return d}return xt(l.length,u.length)}(s.referenceValue,e.referenceValue);case 8:return function(i,o){const l=xt(hs(i.latitude),hs(o.latitude));return l!==0?l:xt(hs(i.longitude),hs(o.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return pf(s.arrayValue,e.arrayValue);case 10:return function(i,o){var h,y,T,v;const l=i.fields||{},u=o.fields||{},m=(h=l[kl])==null?void 0:h.arrayValue,d=(y=u[kl])==null?void 0:y.arrayValue,f=xt(((T=m==null?void 0:m.values)==null?void 0:T.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:pf(m,d)}(s.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ha.mapValue&&o===Ha.mapValue)return 0;if(i===Ha.mapValue)return 1;if(o===Ha.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),m=o.fields||{},d=Object.keys(m);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const h=bu(u[f],d[f]);if(h!==0)return h;const y=Xi(l[u[f]],m[d[f]]);if(y!==0)return y}return xt(u.length,d.length)}(s.mapValue,e.mapValue);default:throw Ge(23264,{he:t})}}function ff(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return xt(s,e);const t=Tr(s),n=Tr(e),r=xt(t.seconds,n.seconds);return r!==0?r:xt(t.nanos,n.nanos)}function pf(s,e){const t=s.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const i=Xi(t[r],n[r]);if(i)return i}return xt(t.length,n.length)}function Ji(s){return Nu(s)}function Nu(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const n=Tr(t);return`time(${n.seconds},${n.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Lr(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return $e.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=Nu(i);return n+"]"}(s.arrayValue):"mapValue"in s?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of n)i?i=!1:r+=",",r+=`${o}:${Nu(t.fields[o])}`;return r+"}"}(s.mapValue):Ge(61005,{value:s})}function cl(s){switch(Pr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ql(s);return e?16+cl(e):16;case 5:return 2*s.stringValue.length;case 6:return Lr(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+cl(i),0)}(s.arrayValue);case 10:case 11:return function(n){let r=0;return Ur(n.fields,(i,o)=>{r+=i.length+cl(o)}),r}(s.mapValue);default:throw Ge(13486,{value:s})}}function hf(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function xu(s){return!!s&&"integerValue"in s}function dm(s){return!!s&&"arrayValue"in s}function gf(s){return!!s&&"nullValue"in s}function yf(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function ul(s){return!!s&&"mapValue"in s}function R_(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[dg])==null?void 0:n.stringValue)===fg}function $o(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Ur(s.mapValue.fields,(t,n)=>e.mapValue.fields[t]=$o(n)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$o(s.arrayValue.values[t]);return e}return{...s}}function B_(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===j_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ul(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$o(t)}setAll(e){let t=Ms.emptyPath(),n={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,n,r),n={},r=[],t=l.popLast()}o?n[l.lastSegment()]=$o(o):r.push(l.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());ul(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ul(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ur(t,(r,i)=>e[r]=i);for(const r of n)delete e[r]}clone(){return new on($o(this.value))}}function pg(s){const e=[];return Ur(s.fields,(t,n)=>{const r=new Ms([t]);if(ul(n)){const i=pg(n.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,t,n,r,i,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Ks(e,0,nt.min(),nt.min(),nt.min(),on.empty(),0)}static newFoundDocument(e,t,n,r){return new Ks(e,1,t,nt.min(),n,r,0)}static newNoDocument(e,t){return new Ks(e,2,t,nt.min(),nt.min(),on.empty(),0)}static newUnknownDocument(e,t){return new Ks(e,3,t,nt.min(),nt.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ks&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ks(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.position=e,this.inclusive=t}}function bf(s,e,t){let n=0;for(let r=0;r<s.position.length;r++){const i=e[r],o=s.position[r];if(i.field.isKeyField()?n=$e.comparator($e.fromName(o.referenceValue),t.key):n=Xi(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Nf(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Wn(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,t="asc"){this.field=e,this.dir=t}}function U_(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{}class _s extends hg{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new M_(e,t,n):t==="array-contains"?new q_(e,n):t==="in"?new $_(e,n):t==="not-in"?new W_(e,n):t==="array-contains-any"?new z_(e,n):new _s(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new O_(e,n):new F_(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xi(t,this.value)):t!==null&&Pr(this.value)===Pr(t)&&this.matchesComparison(Xi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vn extends hg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Vn(e,t)}matches(e){return gg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gg(s){return s.op==="and"}function yg(s){return H_(s)&&gg(s)}function H_(s){for(const e of s.filters)if(e instanceof Vn)return!1;return!0}function vu(s){if(s instanceof _s)return s.field.canonicalString()+s.op.toString()+Ji(s.value);if(yg(s))return s.filters.map(e=>vu(e)).join(",");{const e=s.filters.map(t=>vu(t)).join(",");return`${s.op}(${e})`}}function bg(s,e){return s instanceof _s?function(n,r){return r instanceof _s&&n.op===r.op&&n.field.isEqual(r.field)&&Wn(n.value,r.value)}(s,e):s instanceof Vn?function(n,r){return r instanceof Vn&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,o,l)=>i&&bg(o,r.filters[l]),!0):!1}(s,e):void Ge(19439)}function Ng(s){return s instanceof _s?function(t){return`${t.field.canonicalString()} ${t.op} ${Ji(t.value)}`}(s):s instanceof Vn?function(t){return t.op.toString()+" {"+t.getFilters().map(Ng).join(" ,")+"}"}(s):"Filter"}class M_ extends _s{constructor(e,t,n){super(e,t,n),this.key=$e.fromName(n.referenceValue)}matches(e){const t=$e.comparator(e.key,this.key);return this.matchesComparison(t)}}class O_ extends _s{constructor(e,t){super(e,"in",t),this.keys=xg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class F_ extends _s{constructor(e,t){super(e,"not-in",t),this.keys=xg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xg(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(n=>$e.fromName(n.referenceValue))}class q_ extends _s{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dm(t)&&ia(t.arrayValue,this.value)}}class $_ extends _s{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ia(this.value.arrayValue,t)}}class W_ extends _s{constructor(e,t){super(e,"not-in",t)}matches(e){if(ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ia(this.value.arrayValue,t)}}class z_ extends _s{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ia(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t=null,n=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function xf(s,e=null,t=[],n=[],r=null,i=null,o=null){return new K_(s,e,t,n,r,i,o)}function fm(s){const e=it(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Kl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ji(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ji(n)).join(",")),e.Te=t}return e.Te}function pm(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!U_(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!bg(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Nf(s.startAt,e.startAt)&&Nf(s.endAt,e.endAt)}function _u(s){return $e.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t=null,n=[],r=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Q_(s,e,t,n,r,i,o,l){return new ao(s,e,t,n,r,i,o,l)}function Yl(s){return new ao(s)}function vf(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function vg(s){return s.collectionGroup!==null}function Wo(s){const e=it(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ss(Ms.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(m=>{m.isInequality()&&(l=l.add(m.field))})}),l})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new oa(i,n))}),t.has(Ms.keyField().canonicalString())||e.Ie.push(new oa(Ms.keyField(),n))}return e.Ie}function Hn(s){const e=it(s);return e.Ee||(e.Ee=Y_(e,Wo(s))),e.Ee}function Y_(s,e){if(s.limitType==="F")return xf(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new oa(r.field,i)});const t=s.endAt?new Al(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new Al(s.startAt.position,s.startAt.inclusive):null;return xf(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Du(s,e){const t=s.filters.concat([e]);return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ku(s,e,t){return new ao(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Gl(s,e){return pm(Hn(s),Hn(e))&&s.limitType===e.limitType}function _g(s){return`${fm(Hn(s))}|lt:${s.limitType}`}function Ui(s){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>Ng(r)).join(", ")}]`),Kl(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Ji(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Ji(r)).join(",")),`Target(${n})`}(Hn(s))}; limitType=${s.limitType})`}function Xl(s,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):$e.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(s,e)&&function(n,r){for(const i of Wo(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(s,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(s,e)&&function(n,r){return!(n.startAt&&!function(o,l,u){const m=bf(o,l,u);return o.inclusive?m<=0:m<0}(n.startAt,Wo(n),r)||n.endAt&&!function(o,l,u){const m=bf(o,l,u);return o.inclusive?m>=0:m>0}(n.endAt,Wo(n),r))}(s,e)}function G_(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Dg(s){return(e,t)=>{let n=!1;for(const r of Wo(s)){const i=X_(r,e,t);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function X_(s,e,t){const n=s.field.isKeyField()?$e.comparator(e.key,t.key):function(i,o,l){const u=o.data.field(i),m=l.data.field(i);return u!==null&&m!==null?Xi(u,m):Ge(42886)}(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return Ge(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ur(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return og(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_=new os($e.comparator);function rr(){return J_}const kg=new os($e.comparator);function Uo(...s){let e=kg;for(const t of s)e=e.insert(t.key,t);return e}function Ag(s){let e=kg;return s.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function ei(){return zo()}function Eg(){return zo()}function zo(){return new di(s=>s.toString(),(s,e)=>s.isEqual(e))}const Z_=new os($e.comparator),eD=new Ss($e.comparator);function vt(...s){let e=eD;for(const t of s)e=e.add(t);return e}const tD=new Ss(xt);function sD(){return tD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_l(e)?"-0":e}}function Cg(s){return{integerValue:""+s}}function nD(s,e){return S_(e)?Cg(e):hm(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(){this._=void 0}}function rD(s,e,t){return s instanceof aa?function(r,i){const o={fields:{[cg]:{stringValue:lg},[mg]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&mm(i)&&(i=Ql(i)),i&&(o.fields[ug]=i),{mapValue:o}}(t,e):s instanceof la?wg(s,e):s instanceof ca?Sg(s,e):function(r,i){const o=Vg(r,i),l=_f(o)+_f(r.Ae);return xu(o)&&xu(r.Ae)?Cg(l):hm(r.serializer,l)}(s,e)}function iD(s,e,t){return s instanceof la?wg(s,e):s instanceof ca?Sg(s,e):t}function Vg(s,e){return s instanceof El?function(n){return xu(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class aa extends Jl{}class la extends Jl{constructor(e){super(),this.elements=e}}function wg(s,e){const t=Tg(e);for(const n of s.elements)t.some(r=>Wn(r,n))||t.push(n);return{arrayValue:{values:t}}}class ca extends Jl{constructor(e){super(),this.elements=e}}function Sg(s,e){let t=Tg(e);for(const n of s.elements)t=t.filter(r=>!Wn(r,n));return{arrayValue:{values:t}}}class El extends Jl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function _f(s){return hs(s.integerValue||s.doubleValue)}function Tg(s){return dm(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,t){this.field=e,this.transform=t}}function aD(s,e){return s.field.isEqual(e.field)&&function(n,r){return n instanceof la&&r instanceof la||n instanceof ca&&r instanceof ca?Gi(n.elements,r.elements,Wn):n instanceof El&&r instanceof El?Wn(n.Ae,r.Ae):n instanceof aa&&r instanceof aa}(s.transform,e.transform)}class lD{constructor(e,t){this.version=e,this.transformResults=t}}class Zs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zs}static exists(e){return new Zs(void 0,e)}static updateTime(e){return new Zs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ml(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Zl{}function Lg(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new ec(s.key,Zs.none()):new ga(s.key,s.data,Zs.none());{const t=s.data,n=on.empty();let r=new Ss(Ms.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),r=r.add(i)}return new Hr(s.key,n,new un(r.toArray()),Zs.none())}}function cD(s,e,t){s instanceof ga?function(r,i,o){const l=r.value.clone(),u=kf(r.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(s,e,t):s instanceof Hr?function(r,i,o){if(!ml(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=kf(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Pg(r)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(s,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ko(s,e,t,n){return s instanceof ga?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=i.value.clone(),d=Af(i.fieldTransforms,u,o);return m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null}(s,e,t,n):s instanceof Hr?function(i,o,l,u){if(!ml(i.precondition,o))return l;const m=Af(i.fieldTransforms,u,o),d=o.data;return d.setAll(Pg(i)),d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(s,e,t,n):function(i,o,l){return ml(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(s,e,t)}function uD(s,e){let t=null;for(const n of s.fieldTransforms){const r=e.data.field(n.field),i=Vg(n.transform,r||null);i!=null&&(t===null&&(t=on.empty()),t.set(n.field,i))}return t||null}function Df(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Gi(n,r,(i,o)=>aD(i,o))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class ga extends Zl{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Hr extends Zl{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Pg(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}}),e}function kf(s,e,t){const n=new Map;Mt(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let r=0;r<t.length;r++){const i=s[r],o=i.transform,l=e.data.field(i.field);n.set(i.field,iD(o,l,t[r]))}return n}function Af(s,e,t){const n=new Map;for(const r of s){const i=r.transform,o=t.data.field(r.field);n.set(r.field,rD(i,o,e))}return n}class ec extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mD extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&cD(i,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ko(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Eg();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const u=Lg(o,l);u!==null&&n.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(nt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),vt())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(t,n)=>Df(t,n))&&Gi(this.baseMutations,e.baseMutations,(t,n)=>Df(t,n))}}class gm{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Mt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return Z_}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new gm(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs,Et;function hD(s){switch(s){case ie.OK:return Ge(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ge(15467,{code:s})}}function Ig(s){if(s===void 0)return nr("GRPC error has no .code"),ie.UNKNOWN;switch(s){case bs.OK:return ie.OK;case bs.CANCELLED:return ie.CANCELLED;case bs.UNKNOWN:return ie.UNKNOWN;case bs.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case bs.INTERNAL:return ie.INTERNAL;case bs.UNAVAILABLE:return ie.UNAVAILABLE;case bs.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case bs.NOT_FOUND:return ie.NOT_FOUND;case bs.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case bs.ABORTED:return ie.ABORTED;case bs.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case bs.DATA_LOSS:return ie.DATA_LOSS;default:return Ge(39323,{code:s})}}(Et=bs||(bs={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=new Vr([4294967295,4294967295],0);function Ef(s){const e=gD().encode(s),t=new Yh;return t.update(e),new Uint8Array(t.digest())}function Cf(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Vr([t,n],0),new Vr([r,i],0)]}class ym{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ho(`Invalid padding: ${t}`);if(n<0)throw new Ho(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ho(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ho(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Vr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Vr.fromNumber(n)));return r.compare(yD)===1&&(r=new Vr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ef(e),[n,r]=Cf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ym(i,r,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const t=Ef(e),[n,r]=Cf(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ho extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ya.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new tc(nt.min(),r,new os(xt),rr(),vt())}}class ya{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ya(n,t,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class jg{constructor(e,t){this.targetId=e,this.Ce=t}}class Rg{constructor(e,t,n=Fs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Vf{constructor(){this.ve=0,this.Fe=wf(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=vt(),t=vt(),n=vt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ge(38017,{changeType:i})}}),new ya(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=wf()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Mt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bD{constructor(e){this.Ge=e,this.ze=new Map,this.je=rr(),this.Je=Ma(),this.He=Ma(),this.Ye=new os(xt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ge(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(_u(i))if(n===0){const o=new $e(i.path);this.et(t,o,Ks.newNoDocument(o,nt.min()))}else Mt(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(t);const m=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=Lr(n).toUint8Array()}catch(u){if(u instanceof ag)return Yi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ym(o,r,i)}catch(u){return Yi(u instanceof Ho?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&_u(l.target)){const u=new $e(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Ks.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=vt();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const m=this.ot(u);return!m||m.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new tc(e,t,this.Ye,this.je,n);return this.je=rr(),this.Je=Ma(),this.He=Ma(),this.Ye=new os(xt),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Vf,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ss(xt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ss(xt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vf),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ma(){return new os($e.comparator)}function wf(){return new os($e.comparator)}const ND={asc:"ASCENDING",desc:"DESCENDING"},xD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vD={and:"AND",or:"OR"};class _D{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Au(s,e){return s.useProto3Json||Kl(e)?e:{value:e}}function Cl(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bg(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function DD(s,e){return Cl(s,e.toTimestamp())}function Mn(s){return Mt(!!s,49232),nt.fromTimestamp(function(t){const n=Tr(t);return new xe(n.seconds,n.nanos)}(s))}function bm(s,e){return Eu(s,e).canonicalString()}function Eu(s,e){const t=function(r){return new Zt(["projects",r.projectId,"databases",r.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Ug(s){const e=Zt.fromString(s);return Mt(qg(e),10190,{key:e.toString()}),e}function Cu(s,e){return bm(s.databaseId,e.path)}function Mc(s,e){const t=Ug(e);if(t.get(1)!==s.databaseId.projectId)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new $e(Mg(t))}function Hg(s,e){return bm(s.databaseId,e)}function kD(s){const e=Ug(s);return e.length===4?Zt.emptyPath():Mg(e)}function Vu(s){return new Zt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Mg(s){return Mt(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Sf(s,e,t){return{name:Cu(s,e),fields:t.value.mapValue.fields}}function AD(s,e){let t;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ge(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(m,d){return m.useProto3Json?(Mt(d===void 0||typeof d=="string",58123),Fs.fromBase64String(d||"")):(Mt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Fs.fromUint8Array(d||new Uint8Array))}(s,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(m){const d=m.code===void 0?ie.UNKNOWN:Ig(m.code);return new Ee(d,m.message||"")}(o);t=new Rg(n,r,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Mc(s,n.document.name),i=Mn(n.document.updateTime),o=n.document.createTime?Mn(n.document.createTime):nt.min(),l=new on({mapValue:{fields:n.document.fields}}),u=Ks.newFoundDocument(r,i,o,l),m=n.targetIds||[],d=n.removedTargetIds||[];t=new dl(m,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Mc(s,n.document),i=n.readTime?Mn(n.readTime):nt.min(),o=Ks.newNoDocument(r,i),l=n.removedTargetIds||[];t=new dl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Mc(s,n.document),i=n.removedTargetIds||[];t=new dl([],i,r,null)}else{if(!("filter"in e))return Ge(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,o=new pD(r,i),l=n.targetId;t=new jg(l,o)}}return t}function ED(s,e){let t;if(e instanceof ga)t={update:Sf(s,e.key,e.value)};else if(e instanceof ec)t={delete:Cu(s,e.key)};else if(e instanceof Hr)t={update:Sf(s,e.key,e.data),updateMask:jD(e.fieldMask)};else{if(!(e instanceof mD))return Ge(16599,{Vt:e.type});t={verify:Cu(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof aa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof la)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ca)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof El)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ge(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:DD(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ge(27497)}(s,e.precondition)),t}function CD(s,e){return s&&s.length>0?(Mt(e!==void 0,14353),s.map(t=>function(r,i){let o=r.updateTime?Mn(r.updateTime):Mn(i);return o.isEqual(nt.min())&&(o=Mn(i)),new lD(o,r.transformResults||[])}(t,e))):[]}function VD(s,e){return{documents:[Hg(s,e.path)]}}function wD(s,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Hg(s,r);const i=function(m){if(m.length!==0)return Fg(Vn.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(m){if(m.length!==0)return m.map(d=>function(h){return{field:Hi(h.field),direction:LD(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Au(s,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:r}}function SD(s){let e=kD(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Mt(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const h=Og(f);return h instanceof Vn&&yg(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(h=>function(T){return new oa(Mi(T.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(h))}(t.orderBy));let l=null;t.limit&&(l=function(f){let h;return h=typeof f=="object"?f.value:f,Kl(h)?null:h}(t.limit));let u=null;t.startAt&&(u=function(f){const h=!!f.before,y=f.values||[];return new Al(y,h)}(t.startAt));let m=null;return t.endAt&&(m=function(f){const h=!f.before,y=f.values||[];return new Al(y,h)}(t.endAt)),Q_(e,r,o,i,l,"F",u,m)}function TD(s,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ge(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Og(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Mi(t.unaryFilter.field);return _s.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Mi(t.unaryFilter.field);return _s.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Mi(t.unaryFilter.field);return _s.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mi(t.unaryFilter.field);return _s.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ge(61313);default:return Ge(60726)}}(s):s.fieldFilter!==void 0?function(t){return _s.create(Mi(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ge(58110);default:return Ge(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Vn.create(t.compositeFilter.filters.map(n=>Og(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ge(1026)}}(t.compositeFilter.op))}(s):Ge(30097,{filter:s})}function LD(s){return ND[s]}function PD(s){return xD[s]}function ID(s){return vD[s]}function Hi(s){return{fieldPath:s.canonicalString()}}function Mi(s){return Ms.fromServerFormat(s.fieldPath)}function Fg(s){return s instanceof _s?function(t){if(t.op==="=="){if(yf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NAN"}};if(gf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NAN"}};if(gf(t.value))return{unaryFilter:{field:Hi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hi(t.field),op:PD(t.op),value:t.value}}}(s):s instanceof Vn?function(t){const n=t.getFilters().map(r=>Fg(r));return n.length===1?n[0]:{compositeFilter:{op:ID(t.op),filters:n}}}(s):Ge(54877,{filter:s})}function jD(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qg(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,t,n,r,i=nt.min(),o=nt.min(),l=Fs.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Dr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Dr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.yt=e}}function BD(s){const e=SD({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ku(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this.Cn=new HD}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Sr.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Sr.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class HD{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ss(Zt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ss(Zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$g=41943040;class nn{static withCacheSize(e){return new nn(e,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn.DEFAULT_COLLECTION_PERCENTILE=10,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nn.DEFAULT=new nn($g,nn.DEFAULT_COLLECTION_PERCENTILE,nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nn.DISABLED=new nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zi(0)}static cr(){return new Zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="LruGarbageCollector",MD=1048576;function Pf([s,e],[t,n]){const r=xt(s,t);return r===0?xt(e,n):r}class OD{constructor(e){this.Ir=e,this.buffer=new Ss(Pf),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Pf(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){we(Lf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oo(t)?we(Lf,"Ignoring IndexedDB error during garbage collection: ",t):await io(t)}await this.Vr(3e5)})}}class qD{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(zl.ce);const n=new OD(t);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Tf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,l,u,m;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,t))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(m=Date.now(),Bi()<=Ct.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${f} documents in `+(m-u)+`ms
Total Duration: ${m-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function $D(s,e){return new qD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.changes=new di(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ks.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Ko(n.mutation,r,un.empty(),xe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,vt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=vt()){const r=ei();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(i=>{let o=Uo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=ei();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,vt()))}populateOverlays(e,t,n){const r=[];return n.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,r){let i=rr();const o=zo(),l=function(){return zo()}();return t.forEach((u,m)=>{const d=n.get(m.key);r.has(m.key)&&(d===void 0||d.mutation instanceof Hr)?i=i.insert(m.key,m):d!==void 0?(o.set(m.key,d.mutation.getFieldMask()),Ko(d.mutation,m,d.mutation.getFieldMask(),xe.now())):o.set(m.key,un.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((m,d)=>o.set(m,d)),t.forEach((m,d)=>l.set(m,new zD(d,o.get(m)??null))),l))}recalculateAndSaveOverlays(e,t){const n=zo();let r=new os((o,l)=>o-l),i=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const m=t.get(u);if(m===null)return;let d=n.get(u)||un.empty();d=l.applyToLocalView(m,d),n.set(u,d);const f=(r.get(l.batchId)||vt()).add(u);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),m=u.key,d=u.value,f=Eg();d.forEach(h=>{if(!i.has(h)){const y=Lg(t.get(h),n.get(h));y!==null&&f.set(h,y),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,m,f))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return $e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ce.resolve(ei());let l=sa,u=i;return o.next(m=>ce.forEach(m,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{u=u.insert(d,h)}))).next(()=>this.populateOverlays(e,m,i)).next(()=>this.computeViews(e,u,m,vt())).next(d=>({batchId:l,changes:Ag(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $e(t)).next(n=>{let r=Uo();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=Uo();return this.indexManager.getCollectionParents(e,i).next(l=>ce.forEach(l,u=>{const m=function(f,h){return new ao(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,m,n,r).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(o=>{i.forEach((u,m)=>{const d=m.getKey();o.get(d)===null&&(o=o.insert(d,Ks.newInvalidDocument(d)))});let l=Uo();return o.forEach((u,m)=>{const d=i.get(u);d!==void 0&&Ko(d.mutation,m,un.empty(),xe.now()),Xl(t,m)&&(l=l.insert(u,m))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Mn(r.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:BD(r.bundledQuery),readTime:Mn(r.readTime)}}(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(){this.overlays=new os($e.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ei();return ce.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&n.set(r,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,i)=>{this.St(e,t,i)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const r=ei(),i=t.length+1,o=new $e(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,m=u.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new os((m,d)=>m-d);const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let d=i.get(m.largestBatchId);d===null&&(d=ei(),i=i.insert(m.largestBatchId,d)),d.set(m.getKey(),m)}}const l=ei(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((m,d)=>l.set(m,d)),!(l.size()>=r)););return ce.resolve(l)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new fD(t,n));let i=this.qr.get(t);i===void 0&&(i=vt(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.Qr=new Ss(Is.$r),this.Ur=new Ss(Is.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Is(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Is(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new $e(new Zt([])),n=new Is(t,e),r=new Is(t,e+1),i=[];return this.Ur.forEachInRange([n,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new $e(new Zt([])),n=new Is(t,e),r=new Is(t,e+1);let i=vt();return this.Ur.forEachInRange([n,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Is(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Is{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return $e.comparator(e.key,t.key)||xt(e.Yr,t.Yr)}static Kr(e,t){return xt(e.Yr,t.Yr)||$e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ss(Is.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dD(i,t,n,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new Is(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?um:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Is(t,0),r=new Is(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],o=>{const l=this.Xr(o.Yr);i.push(l)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ss(xt);return t.forEach(r=>{const i=new Is(r,0),o=new Is(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{n=n.add(l.Yr)})}),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;$e.isDocumentKey(i)||(i=i.child(""));const o=new Is(new $e(i),0);let l=new Ss(xt);return this.Zr.forEachWhile(u=>{const m=u.key.path;return!!n.isPrefixOf(m)&&(m.length===r&&(l=l.add(u.Yr)),!0)},o),ce.resolve(this.ti(l))}ti(e){const t=[];return e.forEach(n=>{const r=this.Xr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Mt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,r=>{const i=new Is(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Is(t,0),r=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.ri=e,this.docs=function(){return new os($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():Ks.newInvalidDocument(t))}getEntries(e,t){let n=rr();return t.forEach(r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():Ks.newInvalidDocument(r))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=rr();const o=t.path,l=new $e(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:m,value:{document:d}}=u.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||E_(A_(d),n)<=0||(r.has(d.key)||Xl(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ge(9500)}ii(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new ZD(this)}getSize(e){return ce.resolve(this.size)}}class ZD extends WD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.persistence=e,this.si=new di(t=>fm(t),pm),this.lastRemoteSnapshotVersion=nt.min(),this.highestTargetId=0,this.oi=0,this._i=new Nm,this.targetCount=0,this.ai=Zi.ur()}forEachTarget(e,t){return this.si.forEach((n,r)=>t(r)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Zi(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),ce.waitFor(i).next(()=>r)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.ui={},this.overlays={},this.ci=new zl(0),this.li=!1,this.li=!0,this.hi=new GD,this.referenceDelegate=e(this),this.Pi=new ek(this),this.indexManager=new UD,this.remoteDocumentCache=function(r){return new JD(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new RD(t),this.Ii=new QD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new XD(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){we("MemoryPersistence","Starting transaction:",e);const r=new tk(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,t){return ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class tk extends V_{constructor(e){super(),this.currentSequenceNumber=e}}class xm{constructor(e){this.persistence=e,this.Ri=new Nm,this.Vi=null}static mi(e){return new xm(e)}get fi(){if(this.Vi)return this.Vi;throw Ge(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,n=>{const r=$e.fromPath(n);return this.gi(e,r).next(i=>{i||t.removeEntry(r,nt.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vl{constructor(e,t){this.persistence=e,this.pi=new di(n=>T_(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=$D(this,t)}static mi(e,t){return new Vl(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(i=>i?ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(l=>{l||(n++,i.removeEntry(o,nt.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=cl(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return ce.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=vt(),r=vt();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new vm(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Xx()?8:w_(Yx())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new sk;return this.Ss(e,t,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Bi()<=Ct.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",Ui(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Bi()<=Ct.DEBUG&&we("QueryEngine","Query:",Ui(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Bi()<=Ct.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",Ui(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):ce.resolve())}ys(e,t){if(vf(t))return ce.resolve(null);let n=Hn(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=ku(t,null,"F"),n=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=vt(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const m=this.Ds(t,l);return this.Cs(t,m,o,u.readTime)?this.ys(e,ku(t,null,"F")):this.vs(e,m,t,u)}))})))}ws(e,t,n,r){return vf(t)||r.isEqual(nt.min())?ce.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?ce.resolve(null):(Bi()<=Ct.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ui(t)),this.vs(e,o,t,k_(r,sa)).next(l=>l))})}Ds(e,t){let n=new Ss(Dg(e));return t.forEach((r,i)=>{Xl(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Bi()<=Ct.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",Ui(t)),this.ps.getDocumentsMatchingQuery(e,t,Sr.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="LocalStore",rk=3e8;class ik{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new os(xt),this.xs=new di(i=>fm(i),pm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function ok(s,e,t,n){return new ik(s,e,t,n)}async function zg(s,e){const t=it(s);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let u=vt();for(const m of r){o.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}for(const m of i){l.push(m.batchId);for(const d of m.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(m=>({Ls:m,removedBatchIds:o,addedBatchIds:l}))})})}function ak(s,e){const t=it(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,m,d){const f=m.batch,h=f.keys();let y=ce.resolve();return h.forEach(T=>{y=y.next(()=>d.getEntry(u,T)).next(v=>{const V=m.docVersions.get(T);Mt(V!==null,48541),v.version.compareTo(V)<0&&(f.applyToRemoteDocument(v,m),v.isValidDocument()&&(v.setReadTime(m.commitVersion),d.addEntry(v)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=vt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(u=u.add(l.batch.mutations[m].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Kg(s){const e=it(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function lk(s,e){const t=it(s),n=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach((d,f)=>{const h=r.get(f);if(!h)return;l.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Pi.addMatchingKeys(i,d.addedDocuments,f)));let y=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Fs.EMPTY_BYTE_STRING,nt.min()).withLastLimboFreeSnapshotVersion(nt.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,n)),r=r.insert(f,y),function(v,V,R){return v.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=rk?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(h,y,d)&&l.push(t.Pi.updateTargetData(i,y))});let u=rr(),m=vt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(ck(i,o,e.documentUpdates).next(d=>{u=d.ks,m=d.qs})),!n.isEqual(nt.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next(f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return ce.waitFor(l).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,m)).next(()=>u)}).then(i=>(t.Ms=r,i))}function ck(s,e,t){let n=vt(),r=vt();return t.forEach(i=>n=n.add(i)),e.getEntries(s,n).next(i=>{let o=rr();return t.forEach((l,u)=>{const m=i.get(l);u.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(nt.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!m.isValidDocument()||u.version.compareTo(m.version)>0||u.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):we(_m,"Ignoring outdated watch update for ",l,". Current version:",m.version," Watch version:",u.version)}),{ks:o,qs:r}})}function uk(s,e){const t=it(s);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=um),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function mk(s,e){const t=it(s);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Pi.getTargetData(n,e).next(i=>i?(r=i,ce.resolve(r)):t.Pi.allocateTargetId(n).next(o=>(r=new Dr(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function wu(s,e,t){const n=it(s),r=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!oo(o))throw o;we(_m,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function If(s,e,t){const n=it(s);let r=nt.min(),i=vt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,m,d){const f=it(u),h=f.xs.get(d);return h!==void 0?ce.resolve(f.Ms.get(h)):f.Pi.getTargetData(m,d)}(n,o,Hn(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?r:nt.min(),t?i:vt())).next(l=>(dk(n,G_(e),l),{documents:l,Qs:i})))}function dk(s,e,t){let n=s.Os.get(e)||nt.min();t.forEach((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),s.Os.set(e,n)}class jf{constructor(){this.activeTargetIds=sD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fk{constructor(){this.Mo=new jf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf="ConnectivityMonitor";class Bf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){we(Rf,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){we(Rf,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa=null;function Su(){return Oa===null?Oa=function(){return 268435456+Math.round(2147483648*Math.random())}():Oa++,"0x"+Oa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc="RestConnection",hk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Dl?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const o=Su(),l=this.zo(e,t.toUriEncodedString());we(Oc,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,i);const{host:m}=new URL(l),d=pa(m);return this.Jo(e,l,u,n,d).then(f=>(we(Oc,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Yi(Oc,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",n),f})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ro}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),n&&n.headers.forEach((r,i)=>e[i]=r)}zo(e,t){const n=hk[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="WebChannelConnection";class bk extends gk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=Su();return new Promise((l,u)=>{const m=new Gh;m.setWithCredentials(!0),m.listenOnce(Xh.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case ll.NO_ERROR:const f=m.getResponseJson();we($s,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case ll.TIMEOUT:we($s,`RPC '${e}' ${o} timed out`),u(new Ee(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ll.HTTP_ERROR:const h=m.getStatus();if(we($s,`RPC '${e}' ${o} failed with status:`,h,"response text:",m.getResponseText()),h>0){let y=m.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y==null?void 0:y.error;if(T&&T.status&&T.message){const v=function(R){const L=R.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(L)>=0?L:ie.UNKNOWN}(T.status);u(new Ee(v,T.message))}else u(new Ee(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else u(new Ee(ie.UNAVAILABLE,"Connection failed."));break;default:Ge(9055,{l_:e,streamId:o,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{we($s,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);we($s,`RPC '${e}' ${o} sending request:`,r),m.send(t,"POST",d,n,15)})}T_(e,t,n){const r=Su(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eg(),l=Zh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(u.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=i.join("");we($s,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=o.createWebChannel(d,u);this.I_(f);let h=!1,y=!1;const T=new yk({Yo:V=>{y?we($s,`Not sending because RPC '${e}' stream ${r} is closed:`,V):(h||(we($s,`Opening RPC '${e}' stream ${r} transport.`),f.open(),h=!0),we($s,`RPC '${e}' stream ${r} sending:`,V),f.send(V))},Zo:()=>f.close()}),v=(V,R,L)=>{V.listen(R,q=>{try{L(q)}catch(oe){setTimeout(()=>{throw oe},0)}})};return v(f,Bo.EventType.OPEN,()=>{y||(we($s,`RPC '${e}' stream ${r} transport opened.`),T.o_())}),v(f,Bo.EventType.CLOSE,()=>{y||(y=!0,we($s,`RPC '${e}' stream ${r} transport closed`),T.a_(),this.E_(f))}),v(f,Bo.EventType.ERROR,V=>{y||(y=!0,Yi($s,`RPC '${e}' stream ${r} transport errored. Name:`,V.name,"Message:",V.message),T.a_(new Ee(ie.UNAVAILABLE,"The operation could not be completed")))}),v(f,Bo.EventType.MESSAGE,V=>{var R;if(!y){const L=V.data[0];Mt(!!L,16349);const q=L,oe=(q==null?void 0:q.error)||((R=q[0])==null?void 0:R.error);if(oe){we($s,`RPC '${e}' stream ${r} received error:`,oe);const te=oe.status;let O=function(E){const j=bs[E];if(j!==void 0)return Ig(j)}(te),C=oe.message;O===void 0&&(O=ie.INTERNAL,C="Unknown error status: "+te+" with message "+oe.message),y=!0,T.a_(new Ee(O,C)),f.close()}else we($s,`RPC '${e}' stream ${r} received:`,L),T.u_(L)}}),v(l,Jh.STAT_EVENT,V=>{V.stat===yu.PROXY?we($s,`RPC '${e}' stream ${r} detected buffering proxy`):V.stat===yu.NOPROXY&&we($s,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Fc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(s){return new _D(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="PersistentStream";class Yg{constructor(e,t,n,r,i,o,l,u){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Qg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(nr(t.toString()),nr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===t&&this.G_(n,r)},n=>{e(()=>{const r=new Ee(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return we(Uf,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(we(Uf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Nk extends Yg{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AD(this.serializer,e),n=function(i){if(!("targetChange"in i))return nt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?nt.min():o.readTime?Mn(o.readTime):nt.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Vu(this.serializer),t.addTarget=function(i,o){let l;const u=o.target;if(l=_u(u)?{documents:VD(i,u)}:{query:wD(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Bg(i,o.resumeToken);const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}else if(o.snapshotVersion.compareTo(nt.min())>0){l.readTime=Cl(i,o.snapshotVersion.toTimestamp());const m=Au(i,o.expectedCount);m!==null&&(l.expectedCount=m)}return l}(this.serializer,e);const n=TD(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Vu(this.serializer),t.removeTarget=e,this.q_(t)}}class xk extends Yg{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CD(e.writeResults,e.commitTime),n=Mn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Vu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>ED(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{}class _k extends vk{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Eu(t,n),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(ie.UNKNOWN,i.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,Eu(t,n),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(ie.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Dk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nr(t),this.aa=!1):we("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="RemoteStore";class kk{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{fi(this)&&(we(li,"Restarting streams for network reachability change."),await async function(u){const m=it(u);m.Ea.add(4),await ba(m),m.Ra.set("Unknown"),m.Ea.delete(4),await nc(m)}(this))})}),this.Ra=new Dk(n,r)}}async function nc(s){if(fi(s))for(const e of s.da)await e(!0)}async function ba(s){for(const e of s.da)await e(!1)}function Gg(s,e){const t=it(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Em(t)?Am(t):lo(t).O_()&&km(t,e))}function Dm(s,e){const t=it(s),n=lo(t);t.Ia.delete(e),n.O_()&&Xg(t,e),t.Ia.size===0&&(n.O_()?n.L_():fi(t)&&t.Ra.set("Unknown"))}function km(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(nt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}lo(s).Y_(e)}function Xg(s,e){s.Va.Ue(e),lo(s).Z_(e)}function Am(s){s.Va=new bD({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),lo(s).start(),s.Ra.ua()}function Em(s){return fi(s)&&!lo(s).x_()&&s.Ia.size>0}function fi(s){return it(s).Ea.size===0}function Jg(s){s.Va=void 0}async function Ak(s){s.Ra.set("Online")}async function Ek(s){s.Ia.forEach((e,t)=>{km(s,e)})}async function Ck(s,e){Jg(s),Em(s)?(s.Ra.ha(e),Am(s)):s.Ra.set("Unknown")}async function Vk(s,e,t){if(s.Ra.set("Online"),e instanceof Rg&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))}(s,e)}catch(n){we(li,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wl(s,n)}else if(e instanceof dl?s.Va.Ze(e):e instanceof jg?s.Va.st(e):s.Va.tt(e),!t.isEqual(nt.min()))try{const n=await Kg(s.localStore);t.compareTo(n)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,m)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(m);d&&i.Ia.set(m,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,m)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Fs.EMPTY_BYTE_STRING,d.snapshotVersion)),Xg(i,u);const f=new Dr(d.target,u,m,d.sequenceNumber);km(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(s,t)}catch(n){we(li,"Failed to raise snapshot:",n),await wl(s,n)}}async function wl(s,e,t){if(!oo(e))throw e;s.Ea.add(1),await ba(s),s.Ra.set("Offline"),t||(t=()=>Kg(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{we(li,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await nc(s)})}function Zg(s,e){return e().catch(t=>wl(s,t,e))}async function rc(s){const e=it(s),t=Ir(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:um;for(;wk(e);)try{const r=await uk(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,Sk(e,r)}catch(r){await wl(e,r)}ey(e)&&ty(e)}function wk(s){return fi(s)&&s.Ta.length<10}function Sk(s,e){s.Ta.push(e);const t=Ir(s);t.O_()&&t.X_&&t.ea(e.mutations)}function ey(s){return fi(s)&&!Ir(s).x_()&&s.Ta.length>0}function ty(s){Ir(s).start()}async function Tk(s){Ir(s).ra()}async function Lk(s){const e=Ir(s);for(const t of s.Ta)e.ea(t.mutations)}async function Pk(s,e,t){const n=s.Ta.shift(),r=gm.from(n,e,t);await Zg(s,()=>s.remoteSyncer.applySuccessfulWrite(r)),await rc(s)}async function Ik(s,e){e&&Ir(s).X_&&await async function(n,r){if(function(o){return hD(o)&&o!==ie.ABORTED}(r.code)){const i=n.Ta.shift();Ir(n).B_(),await Zg(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await rc(n)}}(s,e),ey(s)&&ty(s)}async function Hf(s,e){const t=it(s);t.asyncQueue.verifyOperationInProgress(),we(li,"RemoteStore received new credentials");const n=fi(t);t.Ea.add(3),await ba(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nc(t)}async function jk(s,e){const t=it(s);e?(t.Ea.delete(2),await nc(t)):e||(t.Ea.add(2),await ba(t),t.Ra.set("Unknown"))}function lo(s){return s.ma||(s.ma=function(t,n,r){const i=it(t);return i.sa(),new Nk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:Ak.bind(null,s),t_:Ek.bind(null,s),r_:Ck.bind(null,s),H_:Vk.bind(null,s)}),s.da.push(async e=>{e?(s.ma.B_(),Em(s)?Am(s):s.Ra.set("Unknown")):(await s.ma.stop(),Jg(s))})),s.ma}function Ir(s){return s.fa||(s.fa=function(t,n,r){const i=it(t);return i.sa(),new xk(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:Tk.bind(null,s),r_:Ik.bind(null,s),ta:Lk.bind(null,s),na:Pk.bind(null,s)}),s.da.push(async e=>{e?(s.fa.B_(),await rc(s)):(await s.fa.stop(),s.Ta.length>0&&(we(li,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))})),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,l=new Cm(e,t,o,r,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vm(s,e){if(nr("AsyncQueue",`${e}: ${s}`),oo(s))return new Ee(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{static emptySet(e){return new Ki(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||$e.comparator(t.key,n.key):(t,n)=>$e.comparator(t.key,n.key),this.keyedMap=Uo(),this.sortedSet=new os(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ki)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ki;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(){this.ga=new os($e.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ge(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class eo{constructor(e,t,n,r,i,o,l,u,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new eo(e,t,Ki.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Bk{constructor(){this.queries=Of(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=it(t),i=r.queries;r.queries=Of(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new Ee(ie.ABORTED,"Firestore shutting down"))}}function Of(){return new di(s=>_g(s),Gl)}async function wm(s,e){const t=it(s);let n=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(n=2):(i=new Rk,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=Vm(o,`Initialization of query '${Ui(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Tm(t)}async function Sm(s,e){const t=it(s),n=e.query;let r=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function Uk(s,e){const t=it(s);let n=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(n=!0);o.wa=r}}n&&Tm(t)}function Hk(s,e,t){const n=it(s),r=n.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);n.queries.delete(e)}function Tm(s){s.Ca.forEach(e=>{e.next()})}var Tu,Ff;(Ff=Tu||(Tu={})).Ma="default",Ff.Cache="cache";class Lm{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new eo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e){this.key=e}}class ny{constructor(e){this.key=e}}class Mk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=vt(),this.mutatedKeys=vt(),this.eu=Dg(e),this.tu=new Ki(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Mf,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const h=r.get(d),y=Xl(this.query,f)?f:null,T=!!h&&this.mutatedKeys.has(h.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let V=!1;h&&y?h.data.isEqual(y.data)?T!==v&&(n.track({type:3,doc:y}),V=!0):this.su(h,y)||(n.track({type:2,doc:y}),V=!0,(u&&this.eu(y,u)>0||m&&this.eu(y,m)<0)&&(l=!0)):!h&&y?(n.track({type:0,doc:y}),V=!0):h&&!y&&(n.track({type:1,doc:h}),V=!0,(u||m)&&(l=!0)),V&&(y?(o=o.add(y),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(y,T){const v=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ge(20277,{Rt:V})}};return v(y)-v(T)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(n),r=r??!1;const l=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,m=u!==this.Za;return this.Za=u,o.length!==0||m?{snapshot:new eo(this.query,e.tu,i,o,e.mutatedKeys,u===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Mf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=vt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new ny(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new sy(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=vt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return eo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pm="SyncEngine";class Ok{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Fk{constructor(e){this.key=e,this.hu=!1}}class qk{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new di(l=>_g(l),Gl),this.Iu=new Map,this.Eu=new Set,this.du=new os($e.comparator),this.Au=new Map,this.Ru=new Nm,this.Vu={},this.mu=new Map,this.fu=Zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $k(s,e,t=!0){const n=cy(s);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await ry(n,e,t,!0),r}async function Wk(s,e){const t=cy(s);await ry(t,e,!0,!1)}async function ry(s,e,t,n){const r=await mk(s.localStore,Hn(e)),i=r.targetId,o=s.sharedClientState.addLocalQueryTarget(i,t);let l;return n&&(l=await zk(s,e,i,o==="current",r.resumeToken)),s.isPrimaryClient&&t&&Gg(s.remoteStore,r),l}async function zk(s,e,t,n,r){s.pu=(f,h,y)=>async function(v,V,R,L){let q=V.view.ru(R);q.Cs&&(q=await If(v.localStore,V.query,!1).then(({documents:C})=>V.view.ru(C,q)));const oe=L&&L.targetChanges.get(V.targetId),te=L&&L.targetMismatches.get(V.targetId)!=null,O=V.view.applyChanges(q,v.isPrimaryClient,oe,te);return $f(v,V.targetId,O.au),O.snapshot}(s,f,h,y);const i=await If(s.localStore,e,!0),o=new Mk(e,i.Qs),l=o.ru(i.documents),u=ya.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",r),m=o.applyChanges(l,s.isPrimaryClient,u);$f(s,t,m.au);const d=new Ok(e,t,o);return s.Tu.set(e,d),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function Kk(s,e,t){const n=it(s),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter(o=>!Gl(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await wu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Dm(n.remoteStore,r.targetId),Lu(n,r.targetId)}).catch(io)):(Lu(n,r.targetId),await wu(n.localStore,r.targetId,!0))}async function Qk(s,e){const t=it(s),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Dm(t.remoteStore,n.targetId))}async function Yk(s,e,t){const n=sA(s);try{const r=await function(o,l){const u=it(o),m=xe.now(),d=l.reduce((y,T)=>y.add(T.key),vt());let f,h;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=rr(),v=vt();return u.Ns.getEntries(y,d).next(V=>{T=V,T.forEach((R,L)=>{L.isValidDocument()||(v=v.add(R))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,T)).next(V=>{f=V;const R=[];for(const L of l){const q=uD(L,f.get(L.key).overlayedDocument);q!=null&&R.push(new Hr(L.key,q,pg(q.value.mapValue),Zs.exists(!0)))}return u.mutationQueue.addMutationBatch(y,m,R,l)}).next(V=>{h=V;const R=V.applyToLocalDocumentSet(f,v);return u.documentOverlayCache.saveOverlays(y,V.batchId,R)})}).then(()=>({batchId:h.batchId,changes:Ag(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,l,u){let m=o.Vu[o.currentUser.toKey()];m||(m=new os(xt)),m=m.insert(l,u),o.Vu[o.currentUser.toKey()]=m}(n,r.batchId,t),await Na(n,r.changes),await rc(n.remoteStore)}catch(r){const i=Vm(r,"Failed to persist write");t.reject(i)}}async function iy(s,e){const t=it(s);try{const n=await lk(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.Au.get(i);o&&(Mt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Mt(o.hu,14607):r.removedDocuments.size>0&&(Mt(o.hu,42227),o.hu=!1))}),await Na(t,n,e)}catch(n){await io(n)}}function qf(s,e,t){const n=it(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const u=it(o);u.onlineState=l;let m=!1;u.queries.forEach((d,f)=>{for(const h of f.Sa)h.va(l)&&(m=!0)}),m&&Tm(u)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Gk(s,e,t){const n=it(s);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),i=r&&r.key;if(i){let o=new os($e.comparator);o=o.insert(i,Ks.newNoDocument(i,nt.min()));const l=vt().add(i),u=new tc(nt.min(),new Map,new os(xt),o,l);await iy(n,u),n.du=n.du.remove(i),n.Au.delete(e),Im(n)}else await wu(n.localStore,e,!1).then(()=>Lu(n,e,t)).catch(io)}async function Xk(s,e){const t=it(s),n=e.batch.batchId;try{const r=await ak(t.localStore,e);ay(t,n,null),oy(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Na(t,r)}catch(r){await io(r)}}async function Jk(s,e,t){const n=it(s);try{const r=await function(o,l){const u=it(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let d;return u.mutationQueue.lookupMutationBatch(m,l).next(f=>(Mt(f!==null,37113),d=f.keys(),u.mutationQueue.removeMutationBatch(m,f))).next(()=>u.mutationQueue.performConsistencyCheck(m)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(m,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,d)).next(()=>u.localDocuments.getDocuments(m,d))})}(n.localStore,e);ay(n,e,t),oy(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Na(n,r)}catch(r){await io(r)}}function oy(s,e){(s.mu.get(e)||[]).forEach(t=>{t.resolve()}),s.mu.delete(e)}function ay(s,e,t){const n=it(s);let r=n.Vu[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function Lu(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach(n=>{s.Ru.containsKey(n)||ly(s,n)})}function ly(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Dm(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),Im(s))}function $f(s,e,t){for(const n of t)n instanceof sy?(s.Ru.addReference(n.key,e),Zk(s,n)):n instanceof ny?(we(Pm,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||ly(s,n.key)):Ge(19791,{wu:n})}function Zk(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(we(Pm,"New document in limbo: "+t),s.Eu.add(n),Im(s))}function Im(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new $e(Zt.fromString(e)),n=s.fu.next();s.Au.set(n,new Fk(t)),s.du=s.du.insert(t,n),Gg(s.remoteStore,new Dr(Hn(Yl(t.path)),n,"TargetPurposeLimboResolution",zl.ce))}}async function Na(s,e,t){const n=it(s),r=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((l,u)=>{o.push(n.pu(u,e,t).then(m=>{var d;if((m||t)&&n.isPrimaryClient){const f=m?!m.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(m){r.push(m);const f=vm.As(u.targetId,m);i.push(f)}}))}),await Promise.all(o),n.Pu.H_(r),await async function(u,m){const d=it(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ce.forEach(m,h=>ce.forEach(h.Es,y=>d.persistence.referenceDelegate.addReference(f,h.targetId,y)).next(()=>ce.forEach(h.ds,y=>d.persistence.referenceDelegate.removeReference(f,h.targetId,y)))))}catch(f){if(!oo(f))throw f;we(_m,"Failed to update sequence numbers: "+f)}for(const f of m){const h=f.targetId;if(!f.fromCache){const y=d.Ms.get(h),T=y.snapshotVersion,v=y.withLastLimboFreeSnapshotVersion(T);d.Ms=d.Ms.insert(h,v)}}}(n.localStore,i))}async function eA(s,e){const t=it(s);if(!t.currentUser.isEqual(e)){we(Pm,"User change. New user:",e.toKey());const n=await zg(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new Ee(ie.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Na(t,n.Ls)}}function tA(s,e){const t=it(s),n=t.Au.get(e);if(n&&n.hu)return vt().add(n.key);{let r=vt();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function cy(s){const e=it(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=iy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gk.bind(null,e),e.Pu.H_=Uk.bind(null,e.eventManager),e.Pu.yu=Hk.bind(null,e.eventManager),e}function sA(s){const e=it(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Xk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Jk.bind(null,e),e}class Sl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ok(this.persistence,new nk,e.initialUser,this.serializer)}Cu(e){return new Wg(xm.mi,this.serializer)}Du(e){return new fk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sl.provider={build:()=>new Sl};class nA extends Sl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Mt(this.persistence.referenceDelegate instanceof Vl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new FD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?nn.withCacheSize(this.cacheSizeBytes):nn.DEFAULT;return new Wg(n=>Vl.mi(n,t),this.serializer)}}class Pu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>qf(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=eA.bind(null,this.syncEngine),await jk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Bk}()}createDatastore(e){const t=sc(e.databaseInfo.databaseId),n=function(i){return new bk(i)}(e.databaseInfo);return function(i,o,l,u){return new _k(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,i,o,l){return new kk(n,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>qf(this.syncEngine,t,0),function(){return Bf.v()?new Bf:new pk}())}createSyncEngine(e,t){return function(r,i,o,l,u,m,d){const f=new qk(r,i,o,l,u,m);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=it(r);we(li,"RemoteStore shutting down."),i.Ea.add(5),await ba(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Pu.provider={build:()=>new Pu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr="FirestoreClient";class rA{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=zs.UNAUTHENTICATED,this.clientId=cm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{we(jr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(we(jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Vm(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qc(s,e){s.asyncQueue.verifyOperationInProgress(),we(jr,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener(async r=>{n.isEqual(r)||(await zg(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function Wf(s,e){s.asyncQueue.verifyOperationInProgress();const t=await iA(s);we(jr,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(n=>Hf(e.remoteStore,n)),s.setAppCheckTokenChangeListener((n,r)=>Hf(e.remoteStore,r)),s._onlineComponents=e}async function iA(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){we(jr,"Using user provided OfflineComponentProvider");try{await qc(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===ie.FAILED_PRECONDITION||r.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Yi("Error using user provided cache. Falling back to memory cache: "+t),await qc(s,new Sl)}}else we(jr,"Using default OfflineComponentProvider"),await qc(s,new nA(void 0));return s._offlineComponents}async function uy(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(we(jr,"Using user provided OnlineComponentProvider"),await Wf(s,s._uninitializedComponentsProvider._online)):(we(jr,"Using default OnlineComponentProvider"),await Wf(s,new Pu))),s._onlineComponents}function oA(s){return uy(s).then(e=>e.syncEngine)}async function Tl(s){const e=await uy(s),t=e.eventManager;return t.onListen=$k.bind(null,e.syncEngine),t.onUnlisten=Kk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Wk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Qk.bind(null,e.syncEngine),t}function aA(s,e,t={}){const n=new Zn;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f));const y=h.docs.has(l);!y&&h.fromCache?m.reject(new Ee(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&h.fromCache&&u&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(Yl(l.path),d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}function lA(s,e,t={}){const n=new Zn;return s.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,m){const d=new jm({next:h=>{d.Nu(),o.enqueueAndForget(()=>Sm(i,f)),h.fromCache&&u.source==="server"?m.reject(new Ee(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(h)},error:h=>m.reject(h)}),f=new Lm(l,d,{includeMetadataChanges:!0,qa:!0});return wm(i,f)}(await Tl(s),s.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy="firestore.googleapis.com",Kf=!0;class Qf{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dy,this.ssl=Kf}else this.host=e.host,this.ssl=e.ssl??Kf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$g;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<MD)throw new Ee(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}D_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=my(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ic{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new f_;switch(n.type){case"firstParty":return new y_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ee(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=zf.get(t);n&&(we("ComponentProvider","Removing Datastore"),zf.delete(t),n.terminate())}(this),Promise.resolve()}}function cA(s,e,t,n={}){var m;s=Js(s,ic);const r=pa(e),i=s._getSettings(),o={...i,emulatorOptions:s._getEmulatorOptions()},l=`${e}:${t}`;r&&(jh(`https://${l}`),Bh("Firestore",!0)),i.host!==dy&&i.host!==l&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:r,emulatorOptions:n};if(!vl(u,o)&&(s._setSettings(u),n.mockUserToken)){let d,f;if(typeof n.mockUserToken=="string")d=n.mockUserToken,f=zs.MOCK_USER;else{d=Rh(n.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Ee(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new zs(h)}s._authCredentials=new p_(new sg(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Mr(this.firestore,e,this._query)}}class cs{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(ha(t,cs._jsonSchema))return new cs(e,n||null,new $e(Zt.fromString(t.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:ks("string",cs._jsonSchemaVersion),referencePath:ks("string")};class wr extends Mr{constructor(e,t,n){super(e,t,Yl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new $e(e))}withConverter(e){return new wr(this.firestore,e,this._path)}}function qe(s,e,...t){if(s=Os(s),ng("collection","path",e),s instanceof ic){const n=Zt.fromString(e,...t);return af(n),new wr(s,null,n)}{if(!(s instanceof cs||s instanceof wr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Zt.fromString(e,...t));return af(n),new wr(s.firestore,null,n)}}function Te(s,e,...t){if(s=Os(s),arguments.length===1&&(e=cm.newId()),ng("doc","path",e),s instanceof ic){const n=Zt.fromString(e,...t);return of(n),new cs(s,null,new $e(n))}{if(!(s instanceof cs||s instanceof wr))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Zt.fromString(e,...t));return of(n),new cs(s.firestore,s instanceof wr?s.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="AsyncQueue";class Gf{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Qg(this,"async_queue_retry"),this._c=()=>{const n=Fc();n&&we(Yf,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Fc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Zn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;we(Yf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,nr("INTERNAL UNHANDLED ERROR: ",Xf(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cm.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Ge(47125,{Pc:Xf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Xf(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(s){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(s,["next","error","complete"])}class zn extends ic{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Gf,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gf(e),this._firestoreClient=void 0,await e}}}function uA(s,e){const t=typeof s=="object"?s:zh(),n=typeof s=="string"?s:Dl,r=Fh(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=Ph("firestore");i&&cA(r,...i)}return r}function xa(s){if(s._terminated)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||mA(s),s._firestoreClient}function mA(s){var n,r,i;const e=s._freezeSettings(),t=function(l,u,m,d){return new I_(l,u,m,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,my(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,e);s._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new rA(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(Fs.fromBase64String(e))}catch(t){throw new Ee(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yn(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ha(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:ks("string",yn._jsonSchemaVersion),bytes:ks("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ms(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:On._jsonSchemaVersion}}static fromJSON(e){if(ha(e,On._jsonSchema))return new On(e.latitude,e.longitude)}}On._jsonSchemaVersion="firestore/geoPoint/1.0",On._jsonSchema={type:ks("string",On._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ha(e,Fn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Fn(e.vectorValues);throw new Ee(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fn._jsonSchemaVersion="firestore/vectorValue/1.0",Fn._jsonSchema={type:ks("string",Fn._jsonSchemaVersion),vectorValues:ks("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=/^__.*__$/;class fA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Hr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ga(e,this.data,t,this.fieldTransforms)}}class fy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Hr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function py(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ge(40011,{Ac:s})}}class Rm{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Rm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ll(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(py(this.Ac)&&dA.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pA{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sc(e)}Cc(e,t,n,r=!1){return new Rm({Ac:e,methodName:t,Dc:n,path:Ms.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _a(s){const e=s._freezeSettings(),t=sc(s._databaseId);return new pA(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Bm(s,e,t,n,r,i={}){const o=s.Cc(i.merge||i.mergeFields?2:0,e,t,r);Hm("Data must be an object, but it was:",o,n);const l=yy(n,o);let u,m;if(i.merge)u=new un(o.fieldMask),m=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const h=Iu(e,f,t);if(!o.contains(h))throw new Ee(ie.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Ny(d,h)||d.push(h)}u=new un(d),m=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,m=o.fieldTransforms;return new fA(new on(l),u,m)}class ac extends oc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ac}}class Um extends oc{_toFieldTransform(e){return new oD(e.path,new aa)}isEqual(e){return e instanceof Um}}function hy(s,e,t,n){const r=s.Cc(1,e,t);Hm("Data must be an object, but it was:",r,n);const i=[],o=on.empty();Ur(n,(u,m)=>{const d=Mm(e,u,t);m=Os(m);const f=r.yc(d);if(m instanceof ac)i.push(d);else{const h=Da(m,f);h!=null&&(i.push(d),o.set(d,h))}});const l=new un(i);return new fy(o,l,r.fieldTransforms)}function gy(s,e,t,n,r,i){const o=s.Cc(1,e,t),l=[Iu(e,n,t)],u=[r];if(i.length%2!=0)throw new Ee(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Iu(e,i[h])),u.push(i[h+1]);const m=[],d=on.empty();for(let h=l.length-1;h>=0;--h)if(!Ny(m,l[h])){const y=l[h];let T=u[h];T=Os(T);const v=o.yc(y);if(T instanceof ac)m.push(y);else{const V=Da(T,v);V!=null&&(m.push(y),d.set(y,V))}}const f=new un(m);return new fy(d,f,o.fieldTransforms)}function hA(s,e,t,n=!1){return Da(t,s.Cc(n?4:3,e))}function Da(s,e){if(by(s=Os(s)))return Hm("Unsupported field value:",e,s),yy(s,e);if(s instanceof oc)return function(n,r){if(!py(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let o=0;for(const l of n){let u=Da(l,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(s,e)}return function(n,r){if((n=Os(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return nD(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xe.fromDate(n);return{timestampValue:Cl(r.serializer,i)}}if(n instanceof xe){const i=new xe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Cl(r.serializer,i)}}if(n instanceof On)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yn)return{bytesValue:Bg(r.serializer,n._byteString)};if(n instanceof cs){const i=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bm(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Fn)return function(o,l){return{mapValue:{fields:{[dg]:{stringValue:fg},[kl]:{arrayValue:{values:o.toArray().map(m=>{if(typeof m!="number")throw l.Sc("VectorValues must only contain numeric values.");return hm(l.serializer,m)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${Wl(n)}`)}(s,e)}function yy(s,e){const t={};return og(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ur(s,(n,r)=>{const i=Da(r,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function by(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof xe||s instanceof On||s instanceof yn||s instanceof cs||s instanceof oc||s instanceof Fn)}function Hm(s,e,t){if(!by(t)||!rg(t)){const n=Wl(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function Iu(s,e,t){if((e=Os(e))instanceof va)return e._internalPath;if(typeof e=="string")return Mm(s,e);throw Ll("Field path arguments must be of type string or ",s,!1,void 0,t)}const gA=new RegExp("[~\\*/\\[\\]]");function Mm(s,e,t){if(e.search(gA)>=0)throw Ll(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new va(...e.split("."))._internalPath}catch{throw Ll(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Ll(s,e,t,n,r){const i=n&&!n.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${r}`),u+=")"),new Ee(ie.INVALID_ARGUMENT,l+s+u)}function Ny(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class yA extends xy{data(){return super.data()}}function lc(s,e){return typeof e=="string"?Mm(s,e):e instanceof va?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ee(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Om{}class _y extends Om{}function Nt(s,e,...t){let n=[];e instanceof Om&&n.push(e),n=n.concat(t),function(i){const o=i.filter(u=>u instanceof Fm).length,l=i.filter(u=>u instanceof cc).length;if(o>1||o>0&&l>0)throw new Ee(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)s=r._apply(s);return s}class cc extends _y{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cc(e,t,n)}_apply(e){const t=this._parse(e);return Dy(e._query,t),new Mr(e.firestore,e.converter,Du(e._query,t))}_parse(e){const t=_a(e.firestore);return function(i,o,l,u,m,d,f){let h;if(m.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ep(f,d);const T=[];for(const v of f)T.push(Zf(u,i,v));h={arrayValue:{values:T}}}else h=Zf(u,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ep(f,d),h=hA(l,o,f,d==="in"||d==="not-in");return _s.create(m,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function js(s,e,t){const n=e,r=lc("where",s);return cc._create(r,n,t)}class Fm extends Om{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fm(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:Vn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const u of l)Dy(o,u),o=Du(o,u)}(e._query,t),new Mr(e.firestore,e.converter,Du(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class qm extends _y{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qm(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new oa(i,o)}(e._query,this._field,this._direction);return new Mr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new ao(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Gt(s,e="asc"){const t=e,n=lc("orderBy",s);return qm._create(n,t)}function Zf(s,e,t){if(typeof(t=Os(t))=="string"){if(t==="")throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vg(e)&&t.indexOf("/")!==-1)throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Zt.fromString(t));if(!$e.isDocumentKey(n))throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hf(s,new $e(n))}if(t instanceof cs)return hf(s,t._key);throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wl(t)}.`)}function ep(s,e){if(!Array.isArray(s)||s.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Dy(s,e){const t=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(s.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class bA{convertValue(e,t="none"){switch(Pr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ur(e,(r,i)=>{n[r]=this.convertValue(i,t)}),n}convertVectorValue(e){var n,r,i;const t=(i=(r=(n=e.fields)==null?void 0:n[kl].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>hs(o.doubleValue));return new Fn(t)}convertGeoPoint(e){return new On(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ql(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(na(e));default:return null}}convertTimestamp(e){const t=Tr(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Zt.fromString(e);Mt(qg(n),9688,{name:e});const r=new ra(n.get(1),n.get(3)),i=new $e(n.popFirst(5));return r.isEqual(t)||nr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class Mo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class si extends xy{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(lc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=si._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}si._jsonSchemaVersion="firestore/documentSnapshot/1.0",si._jsonSchema={type:ks("string",si._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class fl extends si{data(e={}){return super.data(e)}}class ni{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Mo(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new fl(this._firestore,this._userDataWriter,n.key,n,new Mo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new fl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Mo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,d=-1;return l.type!==0&&(m=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:NA(l.type),doc:u,oldIndex:m,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ni._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NA(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ge(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(s){s=Js(s,cs);const e=Js(s.firestore,zn);return aA(xa(e),s._key).then(t=>ky(e,s,t))}ni._jsonSchemaVersion="firestore/querySnapshot/1.0",ni._jsonSchema={type:ks("string",ni._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class Wm extends bA{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cs(this.firestore,null,t)}}function Vt(s){s=Js(s,Mr);const e=Js(s.firestore,zn),t=xa(e),n=new Wm(e);return vy(s._query),lA(t,s._query).then(r=>new ni(e,n,s,r))}function ci(s,e,t){s=Js(s,cs);const n=Js(s.firestore,zn),r=$m(s.converter,e,t);return ka(n,[Bm(_a(n),"setDoc",s._key,r,s.converter!==null,t).toMutation(s._key,Zs.none())])}function Ht(s,e,t,...n){s=Js(s,cs);const r=Js(s.firestore,zn),i=_a(r);let o;return o=typeof(e=Os(e))=="string"||e instanceof va?gy(i,"updateDoc",s._key,e,t,n):hy(i,"updateDoc",s._key,e),ka(r,[o.toMutation(s._key,Zs.exists(!0))])}function Hs(s){return ka(Js(s.firestore,zn),[new ec(s._key,Zs.none())])}function qn(s,e){const t=Js(s.firestore,zn),n=Te(s),r=$m(s.converter,e);return ka(t,[Bm(_a(s.firestore),"addDoc",n._key,r,s.converter!==null,{}).toMutation(n._key,Zs.exists(!1))]).then(()=>n)}function dn(s,...e){var u,m,d;s=Os(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Jf(e[n])||(t=e[n++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Jf(e[n])){const f=e[n];e[n]=(u=f.next)==null?void 0:u.bind(f),e[n+1]=(m=f.error)==null?void 0:m.bind(f),e[n+2]=(d=f.complete)==null?void 0:d.bind(f)}let i,o,l;if(s instanceof cs)o=Js(s.firestore,zn),l=Yl(s._key.path),i={next:f=>{e[n]&&e[n](ky(o,s,f))},error:e[n+1],complete:e[n+2]};else{const f=Js(s,Mr);o=Js(f.firestore,zn),l=f._query;const h=new Wm(o);i={next:y=>{e[n]&&e[n](new ni(o,h,f,y))},error:e[n+1],complete:e[n+2]},vy(s._query)}return function(h,y,T,v){const V=new jm(v),R=new Lm(y,V,T);return h.asyncQueue.enqueueAndForget(async()=>wm(await Tl(h),R)),()=>{V.Nu(),h.asyncQueue.enqueueAndForget(async()=>Sm(await Tl(h),R))}}(xa(o),l,r,i)}function ka(s,e){return function(n,r){const i=new Zn;return n.asyncQueue.enqueueAndForget(async()=>Yk(await oA(n),r,i)),i.promise}(xa(s),e)}function ky(s,e,t){const n=t.docs.get(e._key),r=new Wm(s);return new si(s,r,e._key,n,new Mo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=_a(e)}set(e,t,n){this._verifyNotCommitted();const r=$c(e,this._firestore),i=$m(r.converter,t,n),o=Bm(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,Zs.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=$c(e,this._firestore);let o;return o=typeof(t=Os(t))=="string"||t instanceof va?gy(this._dataReader,"WriteBatch.update",i._key,t,n,r):hy(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,Zs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=$c(e,this._firestore);return this._mutations=this._mutations.concat(new ec(t._key,Zs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ee(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $c(s,e){if((s=Os(s)).firestore!==e)throw new Ee(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function ls(){return new Um("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(s){return xa(s=Js(s,zn)),new xA(s,e=>ka(s,e))}(function(e,t=!0){(function(r){ro=r})($h),ea(new Qi("firestore",(n,{instanceIdentifier:r,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new zn(new h_(n.getProvider("auth-internal")),new b_(o,n.getProvider("app-check-internal")),function(m,d){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ee(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ra(m.options.projectId,d)}(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Cr(tf,sf,e),Cr(tf,sf,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="firebasestorage.googleapis.com",Ey="storageBucket",_A=2*60*1e3,DA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms extends mi{constructor(e,t,n=0){super(Wc(e),`Firebase Storage: ${t} (${Wc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ms.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var us;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(us||(us={}));function Wc(s){return"storage/"+s}function zm(){const s="An unknown error occurred, please check the error payload for server response.";return new ms(us.UNKNOWN,s)}function kA(s){return new ms(us.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function AA(s){return new ms(us.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function EA(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ms(us.UNAUTHENTICATED,s)}function CA(){return new ms(us.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VA(s){return new ms(us.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function wA(){return new ms(us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function SA(){return new ms(us.CANCELED,"User canceled the upload/download.")}function TA(s){return new ms(us.INVALID_URL,"Invalid URL '"+s+"'.")}function LA(s){return new ms(us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function PA(){return new ms(us.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ey+"' property when initializing the app?")}function IA(){return new ms(us.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jA(){return new ms(us.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function RA(s){return new ms(us.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ju(s){return new ms(us.INVALID_ARGUMENT,s)}function Cy(){return new ms(us.APP_DELETED,"The Firebase app was deleted.")}function BA(s){return new ms(us.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Qo(s,e){return new ms(us.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function _o(s){throw new ms(us.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=mn.makeFromUrl(e,t)}catch{return new mn(e,"")}if(n.path==="")return n;throw LA(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(oe){oe.path.charAt(oe.path.length-1)==="/"&&(oe.path_=oe.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function m(oe){oe.path_=decodeURIComponent(oe.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${r}/o${h}`,"i"),T={bucket:1,path:3},v=t===Ay?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",R=new RegExp(`^https?://${v}/${r}/${V}`,"i"),q=[{regex:l,indices:u,postModify:i},{regex:y,indices:T,postModify:m},{regex:R,indices:{bucket:1,path:2},postModify:m}];for(let oe=0;oe<q.length;oe++){const te=q[oe],O=te.regex.exec(e);if(O){const C=O[te.indices.bucket];let N=O[te.indices.path];N||(N=""),n=new mn(C,N),te.postModify(n);break}}if(n==null)throw TA(e);return n}}class UA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(s,e,t){let n=1,r=null,i=null,o=!1,l=0;function u(){return l===2}let m=!1;function d(...V){m||(m=!0,e.apply(null,V))}function f(V){r=setTimeout(()=>{r=null,s(y,u())},V)}function h(){i&&clearTimeout(i)}function y(V,...R){if(m){h();return}if(V){h(),d.call(null,V,...R);return}if(u()||o){h(),d.call(null,V,...R);return}n<64&&(n*=2);let q;l===1?(l=2,q=0):q=(n+Math.random())*1e3,f(q)}let T=!1;function v(V){T||(T=!0,h(),!m&&(r!==null?(V||(l=2),clearTimeout(r),f(0)):V||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function MA(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(s){return s!==void 0}function FA(s){return typeof s=="object"&&!Array.isArray(s)}function Km(s){return typeof s=="string"||s instanceof String}function tp(s){return Qm()&&s instanceof Blob}function Qm(){return typeof Blob<"u"}function sp(s,e,t,n){if(n<e)throw ju(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw ju(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function Vy(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const r=e(n)+"="+e(s[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var ri;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ri||(ri={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(s,e){const t=s>=500&&s<600,r=[408,429].indexOf(s)!==-1,i=e.indexOf(s)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t,n,r,i,o,l,u,m,d,f,h=!0,y=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=m,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,v)=>{this.resolve_=T,this.reject_=v,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Fa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,m=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,m)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===ri.NO_ERROR,u=i.getStatus();if(!l||qA(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ri.ABORT;n(!1,new Fa(!1,null,d));return}const m=this.successCodes_.indexOf(u)!==-1;n(!0,new Fa(m,i))})},t=(n,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());OA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=zm();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?Cy():SA();o(u)}else{const u=wA();o(u)}};this.canceled_?t(!1,new Fa(!1,null,!0)):this.backoffId_=HA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&MA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Fa{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function WA(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function zA(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KA(s,e){e&&(s["X-Firebase-GMPID"]=e)}function QA(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function YA(s,e,t,n,r,i,o=!0,l=!1){const u=Vy(s.urlParams),m=s.url+u,d=Object.assign({},s.headers);return KA(d,e),WA(d,t),zA(d,i),QA(d,n),new $A(m,s.method,d,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,r,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function XA(...s){const e=GA();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(Qm())return new Blob(s);throw new ms(us.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function JA(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(s){if(typeof atob>"u")throw RA("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zc{constructor(e,t){this.data=e,this.contentType=t||null}}function eE(s,e){switch(s){case Un.RAW:return new zc(wy(e));case Un.BASE64:case Un.BASE64URL:return new zc(Sy(s,e));case Un.DATA_URL:return new zc(sE(e),nE(e))}throw zm()}function wy(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=s.charCodeAt(++t);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function tE(s){let e;try{e=decodeURIComponent(s)}catch{throw Qo(Un.DATA_URL,"Malformed data URL.")}return wy(e)}function Sy(s,e){switch(s){case Un.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Un.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Qo(s,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=ZA(e)}catch(r){throw r.message.includes("polyfill")?r:Qo(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class Ty{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Qo(Un.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=rE(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function sE(s){const e=new Ty(s);return e.base64?Sy(Un.BASE64,e.rest):tE(e.rest)}function nE(s){return new Ty(s).contentType}function rE(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,t){let n=0,r="";tp(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(tp(this.data_)){const n=this.data_,r=JA(n,e,t);return r===null?null:new vr(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new vr(n,!0)}}static getBlob(...e){if(Qm()){const t=e.map(n=>n instanceof vr?n.data_:n);return new vr(XA.apply(null,t))}else{const t=e.map(o=>Km(o)?eE(Un.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let i=0;return t.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new vr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(s){let e;try{e=JSON.parse(s)}catch{return null}return FA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function oE(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function Py(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(s,e){return e}class Gs{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||aE}}let qa=null;function lE(s){return!Km(s)||s.length<2?s:Py(s)}function Iy(){if(qa)return qa;const s=[];s.push(new Gs("bucket")),s.push(new Gs("generation")),s.push(new Gs("metageneration")),s.push(new Gs("name","fullPath",!0));function e(i,o){return lE(o)}const t=new Gs("name");t.xform=e,s.push(t);function n(i,o){return o!==void 0?Number(o):o}const r=new Gs("size");return r.xform=n,s.push(r),s.push(new Gs("timeCreated")),s.push(new Gs("updated")),s.push(new Gs("md5Hash",null,!0)),s.push(new Gs("cacheControl",null,!0)),s.push(new Gs("contentDisposition",null,!0)),s.push(new Gs("contentEncoding",null,!0)),s.push(new Gs("contentLanguage",null,!0)),s.push(new Gs("contentType",null,!0)),s.push(new Gs("metadata","customMetadata",!0)),qa=s,qa}function cE(s,e){function t(){const n=s.bucket,r=s.fullPath,i=new mn(n,r);return e._makeStorageReference(i)}Object.defineProperty(s,"ref",{get:t})}function uE(s,e,t){const n={};n.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];n[o.local]=o.xform(n,e[o.server])}return cE(n,s),n}function jy(s,e,t){const n=Ly(e);return n===null?null:uE(s,n,t)}function mE(s,e,t,n){const r=Ly(e);if(r===null||!Km(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(m=>{const d=s.bucket,f=s.fullPath,h="/b/"+o(d)+"/o/"+o(f),y=uc(h,t,n),T=Vy({alt:"media",token:m});return y+T})[0]}function dE(s,e){const t={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(t[i.server]=s[i.local])}return JSON.stringify(t)}class Ym{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(s){if(!s)throw zm()}function fE(s,e){function t(n,r){const i=jy(s,r,e);return Ry(i!==null),i}return t}function pE(s,e){function t(n,r){const i=jy(s,r,e);return Ry(i!==null),mE(i,r,s.host,s._protocol)}return t}function By(s){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=CA():r=EA():t.getStatus()===402?r=AA(s.bucket):t.getStatus()===403?r=VA(s.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Uy(s){const e=By(s);function t(n,r){let i=e(n,r);return n.getStatus()===404&&(i=kA(s.path)),i.serverResponse=r.serverResponse,i}return t}function hE(s,e,t){const n=e.fullServerUrl(),r=uc(n,s.host,s._protocol),i="GET",o=s.maxOperationRetryTime,l=new Ym(r,i,pE(s,t),o);return l.errorHandler=Uy(e),l}function gE(s,e){const t=e.fullServerUrl(),n=uc(t,s.host,s._protocol),r="DELETE",i=s.maxOperationRetryTime;function o(u,m){}const l=new Ym(n,r,o,i);return l.successCodes=[200,204],l.errorHandler=Uy(e),l}function yE(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function bE(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=yE(null,e)),n}function NE(s,e,t,n,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let q="";for(let oe=0;oe<2;oe++)q=q+Math.random().toString().slice(2);return q}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const m=bE(e,n,r),d=dE(m,t),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+m.contentType+`\r
\r
`,h=`\r
--`+u+"--",y=vr.getBlob(f,n,h);if(y===null)throw IA();const T={name:m.fullPath},v=uc(i,s.host,s._protocol),V="POST",R=s.maxUploadRetryTime,L=new Ym(v,V,fE(s,t),R);return L.urlParams=T,L.headers=o,L.body=y.uploadData(),L.errorHandler=By(e),L}class xE{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ri.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ri.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ri.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,i){if(this.sent_)throw _o("cannot .send() more than once");if(pa(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _o("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _o("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw _o("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _o("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class vE extends xE{initXhr(){this.xhr_.responseType="text"}}function Gm(){return new vE}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t){this._service=e,t instanceof mn?this._location=t:this._location=mn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ui(e,t)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Py(this._location.path)}get storage(){return this._service}get parent(){const e=iE(this._location.path);if(e===null)return null;const t=new mn(this._location.bucket,e);return new ui(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw BA(e)}}function _E(s,e,t){s._throwIfRoot("uploadBytes");const n=NE(s.storage,s._location,Iy(),new vr(e,!0),t);return s.storage.makeRequestWithTokens(n,Gm).then(r=>({metadata:r,ref:s}))}function DE(s){s._throwIfRoot("getDownloadURL");const e=hE(s.storage,s._location,Iy());return s.storage.makeRequestWithTokens(e,Gm).then(t=>{if(t===null)throw jA();return t})}function kE(s){s._throwIfRoot("deleteObject");const e=gE(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Gm)}function AE(s,e){const t=oE(s._location.path,e),n=new mn(s._location.bucket,t);return new ui(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(s){return/^[A-Za-z]+:\/\//.test(s)}function CE(s,e){return new ui(s,e)}function Hy(s,e){if(s instanceof Xm){const t=s;if(t._bucket==null)throw PA();const n=new ui(t,t._bucket);return e!=null?Hy(n,e):n}else return e!==void 0?AE(s,e):s}function VE(s,e){if(e&&EE(e)){if(s instanceof Xm)return CE(s,e);throw ju("To use ref(service, url), the first argument must be a Storage instance.")}else return Hy(s,e)}function np(s,e){const t=e==null?void 0:e[Ey];return t==null?null:mn.makeFromBucketSpec(t,s)}function wE(s,e,t,n={}){s.host=`${e}:${t}`;const r=pa(e);r&&(jh(`https://${s.host}/b`),Bh("Storage",!0)),s._isUsingEmulator=!0,s._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(s._overrideAuthToken=typeof i=="string"?i:Rh(i,s.app.options.projectId))}class Xm{constructor(e,t,n,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=Ay,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_A,this._maxUploadRetryTime=DA,this._requests=new Set,r!=null?this._bucket=mn.makeFromBucketSpec(r,this._host):this._bucket=np(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=np(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qh(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ui(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new UA(Cy());{const o=YA(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const rp="@firebase/storage",ip="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="storage";function Ru(s,e,t){return s=Os(s),_E(s,e,t)}function Bu(s){return s=Os(s),DE(s)}function SE(s){return s=Os(s),kE(s)}function Pl(s,e){return s=Os(s),VE(s,e)}function TE(s=zh(),e){s=Os(s);const n=Fh(s,My).getImmediate({identifier:e}),r=Ph("storage");return r&&LE(n,...r),n}function LE(s,e,t,n={}){wE(s,e,t,n)}function PE(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),r=s.getProvider("app-check-internal");return new Xm(t,n,r,e,$h)}function IE(){ea(new Qi(My,PE,"PUBLIC").setMultipleInstances(!0)),Cr(rp,ip,""),Cr(rp,ip,"esm2020")}IE();const jE={apiKey:"AIzaSyAkeHQVa-AH_SFFqxmau_UPWAR1oPOSDl0",authDomain:"hv-lab-app.firebaseapp.com",projectId:"hv-lab-app",storageBucket:"hv-lab-app.firebasestorage.app",messagingSenderId:"268116248842",appId:"1:268116248842:web:3415b6668e854e99ab92f3"},Oy=Gd().length===0?Wh(jE):Gd()[0],re=uA(Oy),Il=TE(Oy),$a=async s=>{const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")},RE=s=>{const t=new TextEncoder().encode(s);let n="";return t.forEach(r=>n+=String.fromCharCode(r)),btoa(n)},BE=s=>{const e=atob(s),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new TextDecoder().decode(t)},op=s=>{const e={id:s.id,username:s.username,role:s.role,iat:Date.now(),exp:Date.now()+2592e6};return RE(JSON.stringify(e))},ap=s=>{try{if(s.startsWith("eyJ"))return console.log("[Auth]  Railway JWT   - "),null;const e=JSON.parse(BE(s));return e.exp<Date.now()?null:{id:e.id,username:e.username,role:e.role}}catch{return null}},lp={:{user:{id:"user_sangjun",username:"",name:"",role:"admin"},password:"0109"},:{user:{id:"user_sinae",username:"",name:"",role:"manager"},password:"0109"},:{user:{id:"user_jaecheon",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_mingi",username:"",name:"",role:"fieldManager"},password:"0109"},:{user:{id:"user_jaesung",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_jaehyun",username:"",name:"",role:"worker"},password:"0109"},:{user:{id:"user_anteam",username:"",name:"",role:"worker"},password:"0000"}},Kc={async login(s){console.time("[Auth]   ");const e=lp[s.username];if(e){if(s.password!==e.password)throw new Error("  .");const d=e.user,f=op(d);return Vt(Nt(qe(re,"users"),js("username","==",s.username))).then(h=>{h.empty||Ht(Te(re,"users",h.docs[0].id),{lastLogin:ls()}).catch(y=>console.error("lastLogin  :",y))}).catch(h=>console.error("Firestore  :",h)),console.timeEnd("[Auth]   "),{success:!0,token:f,user:d}}console.time("[Auth] Firestore ");const t=qe(re,"users"),n=Nt(t,js("username","==",s.username)),r=await Vt(n);if(console.timeEnd("[Auth] Firestore "),r.empty)throw new Error("   .");const i=r.docs[0],o=i.data(),l=await $a(s.password);if(o.passwordHash){if(o.passwordHash!==l)throw new Error("  .")}else if(o.password){if(o.password.startsWith("$2b$")||o.password.startsWith("$2a$")){if(s.password!=="1234")throw new Error("  .")}else if(o.password!==s.password&&s.password!=="1234")throw new Error("  .")}else if(s.password!=="1234")throw new Error("  .");const u={id:i.id,username:o.username,name:o.name,email:o.email,role:o.role||"user",phone:o.phone,department:o.department,position:o.position,avatar:o.avatar},m=op(u);return Ht(Te(re,"users",i.id),{lastLogin:ls()}).catch(d=>console.error("lastLogin  :",d)),console.timeEnd("[Auth]   "),{success:!0,token:m,user:u}},async getCurrentUser(s){const e=ap(s);if(!e)return null;const t=lp[e.username];if(t)return t.user;try{const n=await It(Te(re,"users",e.id));if(!n.exists())return null;const r=n.data();return{id:n.id,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}}catch(n){return console.error("Firestore getCurrentUser error:",n),null}},async getUserById(s){const e=await It(Te(re,"users",s));if(!e.exists())return null;const t=e.data();return{id:e.id,username:t.username,name:t.name,email:t.email,role:t.role||"user",phone:t.phone,department:t.department,position:t.position,avatar:t.avatar}},async getUserByUsername(s){const e=qe(re,"users"),t=Nt(e,js("username","==",s)),n=await Vt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return{id:r.id,username:i.username,name:i.name,email:i.email,role:i.role||"user",phone:i.phone,department:i.department,position:i.position,avatar:i.avatar}},async getAllUsers(){const s=qe(re,"users");return(await Vt(s)).docs.map(t=>{const n=t.data();return{id:t.id,username:n.username,name:n.name,email:n.email,role:n.role||"user",phone:n.phone,department:n.department,position:n.position,avatar:n.avatar}})},async createUser(s){const{password:e,...t}=s,n=await $a(e),r=qe(re,"users"),i=Te(r),o={...t,passwordHash:n,createdAt:ls(),updatedAt:ls()};return await ci(i,o),{id:i.id,...t}},async updateUser(s,e){const t=Te(re,"users",s);await Ht(t,{...e,updatedAt:ls()});const r=(await It(t)).data();return{id:s,username:r.username,name:r.name,email:r.email,role:r.role||"user",phone:r.phone,department:r.department,position:r.position,avatar:r.avatar}},async changePassword(s,e,t){const n=await It(Te(re,"users",s));if(!n.exists())throw new Error("   .");const r=n.data(),i=await $a(e);if(r.passwordHash&&r.passwordHash!==i)throw new Error("   .");const o=await $a(t);return await Ht(Te(re,"users",s),{passwordHash:o,updatedAt:ls()}),!0},verifyToken:ap};class UE{async login(e){const t=await Kc.login(e);return t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}async getCurrentUser(){const e=this.getToken();if(!e)return null;try{const t=await Kc.getCurrentUser(e);return t?(localStorage.setItem("user",JSON.stringify(t)),t):(console.log("Token invalid or expired, clearing..."),this.logout(),null)}catch(t){console.error("Get current user error:",t);const n=this.getUser();return n?(console.log("Using cached user data due to error"),n):null}}logout(){localStorage.removeItem("token"),localStorage.removeItem("user")}getToken(){return localStorage.getItem("token")}getUser(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch{return null}}isAuthenticated(){return!!this.getToken()}async getAllUsers(){return Kc.getAllUsers()}}const cp=new UE,_i=(s,e)=>({id:parseInt(s)||0,name:e.name||"",category:e.category||"",brand:e.brand||"",price:e.price||"",image_url:e.image_url||null,sub_images:e.sub_images,description:e.description||"",project_id:e.project_id||null,is_library:e.is_library||1,display_order:e.display_order,grade:e.grade,created_at:e.created_at||new Date().toISOString(),updated_at:e.updated_at||new Date().toISOString()}),Qc={async getLibraryMeta(){const s=qe(re,"specbook_items"),e=Nt(s,js("is_library","==",1),Gt("category"),Gt("name"));return(await Vt(e)).docs.map(n=>_i(n.id,n.data()))},async getCategories(){const s=await this.getLibraryMeta();return[...new Set(s.map(t=>t.category))].sort()},async getProjectMeta(s){const e=qe(re,"specbook_items"),t=Nt(e,js("project_id","==",s),Gt("display_order"));return(await Vt(t)).docs.map(r=>_i(r.id,r.data()))},async getItemById(s){const e=Te(re,"specbook_items",s),t=await It(e);return t.exists()?_i(t.id,t.data()):null},async getItemImage(s){const e=Te(re,"specbook_items",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{image_url:n.image_url||null,sub_images:n.sub_images||[]}},subscribeToLibraryItems(s){const e=qe(re,"specbook_items"),t=Nt(e,js("is_library","==",1));return dn(t,r=>{const i=r.docs.map(o=>_i(o.id,o.data()));i.sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name)),s(i)})},subscribeToProjectItems(s,e){const t=qe(re,"specbook_items"),n=Nt(t,js("project_id","==",s));return dn(n,i=>{const o=i.docs.map(l=>_i(l.id,l.data()));o.sort((l,u)=>(l.display_order||0)-(u.display_order||0)),e(o)})},async updateCategories(s){const e=Te(re,"specbook_settings","categories");await ci(e,{categories:s,updatedAt:ls()},{merge:!0}),console.log(" [Firestore]   ")},async createItemBase64(s){try{const e=qe(re,"specbook_items"),t=await Vt(e);let n=0;t.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>n&&(n=m)});const r=n+1;let i=null;if(s.image&&s.image.startsWith("data:")){const u=s.image.split(",")[1],m=s.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),y=new Array(h.length);for(let L=0;L<h.length;L++)y[L]=h.charCodeAt(L);const T=new Uint8Array(y),v=new Blob([T],{type:d}),V=`specbook/${r}-${Date.now()}.${f}`,R=Pl(Il,V);await Ru(R,v),i=await Bu(R)}const o=new Date().toISOString(),l=Te(re,"specbook_items",String(r));return await ci(l,{name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade||null,created_at:o,updated_at:o}),console.log(" [Firestore]    :",r),{id:r,name:s.name,category:s.category,brand:s.brand||"",price:s.price||"",description:s.description||"",image_url:i,sub_images:s.sub_images||[],project_id:s.project_id||null,is_library:s.is_library??1,display_order:s.display_order||0,grade:s.grade,created_at:o,updated_at:o}}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateItemBase64(s,e){try{const t=Te(re,"specbook_items",String(s)),n=await It(t);if(!n.exists())throw new Error("   .");const r=n.data();let i=r.image_url;if(e.image&&e.image.startsWith("data:")){const u=e.image.split(",")[1],m=e.image.match(/data:([^;]+);/),d=m?m[1]:"image/jpeg",f=d.split("/")[1]||"jpg",h=atob(u),y=new Array(h.length);for(let L=0;L<h.length;L++)y[L]=h.charCodeAt(L);const T=new Uint8Array(y),v=new Blob([T],{type:d}),V=`specbook/${s}-${Date.now()}.${f}`,R=Pl(Il,V);await Ru(R,v),i=await Bu(R)}const l={updated_at:new Date().toISOString()};return e.name!==void 0&&(l.name=e.name),e.category!==void 0&&(l.category=e.category),e.brand!==void 0&&(l.brand=e.brand),e.price!==void 0&&(l.price=e.price),e.description!==void 0&&(l.description=e.description),i!==r.image_url&&(l.image_url=i),e.sub_images!==void 0&&(l.sub_images=e.sub_images),e.project_id!==void 0&&(l.project_id=e.project_id),e.is_library!==void 0&&(l.is_library=e.is_library),e.display_order!==void 0&&(l.display_order=e.display_order),e.grade!==void 0&&(l.grade=e.grade),await Ht(t,l),console.log(" [Firestore]    :",s),_i(String(s),{...r,...l,image_url:i})}catch(t){throw console.error("[Firestore]    :",t),new Error(`  : ${t.message||"   "}`)}},async deleteItem(s){try{const e=Te(re,"specbook_items",String(s));await Hs(e),console.log(" [Firestore]    :",s)}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},async updateSubImages(s,e){try{const t=Te(re,"specbook_items",String(s));await Ht(t,{sub_images:e,updated_at:new Date().toISOString()}),console.log(" [Firestore]    :",s)}catch(t){throw console.error("[Firestore]    :",t),new Error(`   : ${t.message||"   "}`)}},async reorderItems(s){try{const e=vA(re);s.forEach(t=>{const n=Te(re,"specbook_items",String(t.id));e.update(n,{display_order:t.display_order,updated_at:new Date().toISOString()})}),await e.commit(),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}}},HE=10*60*1e3,ME=Wu((s,e)=>({libraryItems:[],libraryLoaded:!1,libraryLoading:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map,preloadLibrary:async()=>{const t=e();if(!t.libraryLoading){if(t.libraryLoaded&&t.libraryLoadedAt&&Date.now()-t.libraryLoadedAt<HE){console.log("[SpecbookStore]   , ");return}s({libraryLoading:!0});try{console.log("[SpecbookStore]    ...");const n=await Qc.getLibraryMeta();s({libraryItems:n,libraryLoaded:!0,libraryLoading:!1,libraryLoadedAt:Date.now()}),console.log("[SpecbookStore]   :",n.length," ")}catch(n){console.error("[SpecbookStore]   :",n),s({libraryLoading:!1})}}},preloadCategories:async()=>{if(!e().categoriesLoaded)try{const n=await Qc.getCategories();s({categories:n,categoriesLoaded:!0}),console.log("[SpecbookStore]   :",n.length,"")}catch(n){console.error("[SpecbookStore]   :",n)}},preloadAll:async()=>{const{preloadLibrary:t,preloadCategories:n}=e();await Promise.all([t(),n()])},getLibraryItems:(t,n)=>{const{libraryItems:r}=e();let i=r;return t&&t!==""&&(i=i.filter(o=>o.category===t)),n&&n.length>0&&(i=i.filter(o=>{if(!o.grade)return!1;const l=o.grade.split(",").map(u=>u.trim());return n.some(u=>l.includes(u))})),i=[...i].sort((o,l)=>{var d,f;const u=parseInt(((d=o.price)==null?void 0:d.replace(/[^0-9]/g,""))||"0",10);return parseInt(((f=l.price)==null?void 0:f.replace(/[^0-9]/g,""))||"0",10)-u}),i},getProjectItems:t=>{const{projectItemsCache:n}=e();return n.get(t)||null},loadProjectItems:async t=>{const r=e().projectItemsCache.get(t);if(r)return r;try{const i=await Qc.getProjectMeta(t);return s(o=>{const l=new Map(o.projectItemsCache);return l.set(t,i),{projectItemsCache:l}}),i}catch(i){return console.error("[SpecbookStore]    :",i),[]}},invalidateLibrary:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null})},invalidateProject:t=>{s(n=>{const r=new Map(n.projectItemsCache);return r.delete(t),{projectItemsCache:r}})},invalidateAll:()=>{s({libraryItems:[],libraryLoaded:!1,libraryLoadedAt:null,categories:[],categoriesLoaded:!1,projectItemsCache:new Map})},addItemToCache:t=>{t.is_library?s(n=>({libraryItems:[t,...n.libraryItems]})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id)||[];return r.set(t.project_id,[t,...i]),{projectItemsCache:r}})},updateItemInCache:t=>{t.is_library?s(n=>({libraryItems:n.libraryItems.map(r=>r.id===t.id?t:r)})):t.project_id&&s(n=>{const r=new Map(n.projectItemsCache),i=r.get(t.project_id);return i&&r.set(t.project_id,i.map(o=>o.id===t.id?t:o)),{projectItemsCache:r}})},removeItemFromCache:(t,n,r)=>{n?s(i=>({libraryItems:i.libraryItems.filter(o=>o.id!==t)})):r&&s(i=>{const o=new Map(i.projectItemsCache),l=o.get(r);return l&&o.set(r,l.filter(u=>u.id!==t)),{projectItemsCache:o}})}})),Fy=A.createContext(void 0);function OE({children:s}){const[e,t]=A.useState(null),[n,r]=A.useState(!0),i=$p(),o=ME(f=>f.preloadAll);A.useEffect(()=>{l()},[]);const l=async()=>{var f;try{if(!localStorage.getItem("token")){r(!1);return}const y=await cp.getCurrentUser();y&&(t(y),o())}catch(h){if(((f=h.response)==null?void 0:f.status)===401)localStorage.removeItem("token"),delete zi.defaults.headers.common.Authorization;else{const T=localStorage.getItem("user");if(T)try{t(JSON.parse(T))}catch{}}}finally{r(!1)}},u=async(f,h)=>{var y,T;try{const v=await cp.login({username:f,password:h}),V=v.token,R=v.user;localStorage.setItem("token",V),localStorage.setItem("user",JSON.stringify(R)),zi.defaults.headers.common.Authorization=`Bearer ${V}`,t(R),o(),ne.success(`${R.name}, !`);const L=sessionStorage.getItem("redirectAfterLogin");L?(sessionStorage.removeItem("redirectAfterLogin"),i(L)):i("/")}catch(v){const V=v;throw ne.error(((T=(y=V.response)==null?void 0:y.data)==null?void 0:T.message)||" "),v}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete zi.defaults.headers.common.Authorization,t(null),i("/login"),ne.success("")},d=f=>{t(f)};return a.jsxDEV(Fy.Provider,{value:{user:e,loading:n,login:u,logout:m,updateUser:d},children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/contexts/AuthContext.tsx",lineNumber:125,columnNumber:5},this)}function Or(){const s=A.useContext(Fy);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const FE={};function qE(s,e){let t;try{t=s()}catch{return}return{getItem:r=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const ua=s=>e=>{try{const t=s(e);return t instanceof Promise?t:{then(n){return ua(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return ua(n)(t)}}}},$E=(s,e)=>(t,n,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:V=>V,version:0,merge:(V,R)=>({...R,...V}),...e},o=!1;const l=new Set,u=new Set;let m;try{m=i.getStorage()}catch{}if(!m)return s((...V)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...V)},n,r);const d=ua(i.serialize),f=()=>{const V=i.partialize({...n()});let R;const L=d({state:V,version:i.version}).then(q=>m.setItem(i.name,q)).catch(q=>{R=q});if(R)throw R;return L},h=r.setState;r.setState=(V,R)=>{h(V,R),f()};const y=s((...V)=>{t(...V),f()},n,r);let T;const v=()=>{var V;if(!m)return;o=!1,l.forEach(L=>L(n()));const R=((V=i.onRehydrateStorage)==null?void 0:V.call(i,n()))||void 0;return ua(m.getItem.bind(m))(i.name).then(L=>{if(L)return i.deserialize(L)}).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return i.migrate(L.state,L.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return L.state}).then(L=>{var q;return T=i.merge(L,(q=n())!=null?q:y),t(T,!0),f()}).then(()=>{R==null||R(T,void 0),o=!0,u.forEach(L=>L(T))}).catch(L=>{R==null||R(void 0,L)})};return r.persist={setOptions:V=>{i={...i,...V},V.getStorage&&(m=V.getStorage())},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:V=>(l.add(V),()=>{l.delete(V)}),onFinishHydration:V=>(u.add(V),()=>{u.delete(V)})},v(),T||y},WE=(s,e)=>(t,n,r)=>{let i={storage:qE(()=>localStorage),partialize:v=>v,version:0,merge:(v,V)=>({...V,...v}),...e},o=!1;const l=new Set,u=new Set;let m=i.storage;if(!m)return s((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},n,r);const d=()=>{const v=i.partialize({...n()});return m.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,V)=>{f(v,V),d()};const h=s((...v)=>{t(...v),d()},n,r);r.getInitialState=()=>h;let y;const T=()=>{var v,V;if(!m)return;o=!1,l.forEach(L=>{var q;return L((q=n())!=null?q:h)});const R=((V=i.onRehydrateStorage)==null?void 0:V.call(i,(v=n())!=null?v:h))||void 0;return ua(m.getItem.bind(m))(i.name).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return[!0,i.migrate(L.state,L.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,L.state];return[!1,void 0]}).then(L=>{var q;const[oe,te]=L;if(y=i.merge(te,(q=n())!=null?q:h),t(y,!0),oe)return d()}).then(()=>{R==null||R(y,void 0),y=n(),o=!0,u.forEach(L=>L(y))}).catch(L=>{R==null||R(void 0,L)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(m=v.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},i.skipHydration||T(),y||h},zE=(s,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((FE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),$E(s,e)):WE(s,e),qy=zE,$y=Wu()(qy((s,e)=>({notifications:[],unreadCount:0,addNotification:t=>{const n={...t,id:Date.now().toString()+Math.random().toString(36).substr(2,9),read:!1,createdAt:new Date};s(r=>({notifications:[n,...r.notifications].slice(0,50),unreadCount:r.unreadCount+1}))},markAsRead:t=>{s(n=>({notifications:n.notifications.map(r=>r.id===t?{...r,read:!0}:r),unreadCount:Math.max(0,n.unreadCount-1)}))},markAllAsRead:()=>{s(t=>({notifications:t.notifications.map(n=>({...n,read:!0})),unreadCount:0}))},deleteNotification:t=>{s(n=>{const r=n.notifications.find(o=>o.id===t),i=r&&!r.read;return{notifications:n.notifications.filter(o=>o.id!==t),unreadCount:i?Math.max(0,n.unreadCount-1):n.unreadCount}})},clearAll:()=>{s({notifications:[],unreadCount:0})},getUnreadCount:()=>e().unreadCount}),{name:"notification-storage",partialize:s=>({notifications:s.notifications,unreadCount:s.unreadCount})}));var KE={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},QE=function(e,t,n){var r,i=KE[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+" ":r+" ":r},YE={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},GE={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},XE={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},JE={date:Tc({formats:YE,defaultWidth:"full"}),time:Tc({formats:GE,defaultWidth:"full"}),dateTime:Tc({formats:XE,defaultWidth:"full"})},ZE={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},eC=function(e,t,n,r){return ZE[e]},tC={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},sC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},nC={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},rC={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},iC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},oC={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},aC=function(e,t){var n=Number(e),r=String(t==null?void 0:t.unit);switch(r){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},lC={ordinalNumber:aC,era:No({values:tC,defaultWidth:"wide"}),quarter:No({values:sC,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:No({values:nC,defaultWidth:"wide"}),day:No({values:rC,defaultWidth:"wide"}),dayPeriod:No({values:iC,defaultWidth:"wide",formattingValues:oC,defaultFormattingWidth:"wide"})},cC=/^(\d+)(|)?/i,uC=/\d+/i,mC={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},dC={any:[/^(bc|)/i,/^(ad|)/i]},fC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},pC={any:[/1/i,/2/i,/3/i,/4/i]},hC={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},gC={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},yC={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},bC={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},NC={any:/^(am|pm|||||||)/i},xC={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},vC={ordinalNumber:IN({matchPattern:cC,parsePattern:uC,valueCallback:function(e){return parseInt(e,10)}}),era:xo({matchPatterns:mC,defaultMatchWidth:"wide",parsePatterns:dC,defaultParseWidth:"any"}),quarter:xo({matchPatterns:fC,defaultMatchWidth:"wide",parsePatterns:pC,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:xo({matchPatterns:hC,defaultMatchWidth:"wide",parsePatterns:gC,defaultParseWidth:"any"}),day:xo({matchPatterns:yC,defaultMatchWidth:"wide",parsePatterns:bC,defaultParseWidth:"any"}),dayPeriod:xo({matchPatterns:NC,defaultMatchWidth:"any",parsePatterns:xC,defaultParseWidth:"any"})},xs={code:"ko",formatDistance:QE,formatLong:JE,formatRelative:eC,localize:lC,match:vC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const _C=({isOpen:s,onClose:e})=>{const t=$p(),{notifications:n,unreadCount:r,markAsRead:i,markAllAsRead:o,deleteNotification:l,clearAll:u}=$y();if(!s)return null;const m=h=>{switch(h){case"payment":return a.jsxDEV(DN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:21,columnNumber:16},void 0);case"as_request":return a.jsxDEV(_N,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:23,columnNumber:16},void 0);case"schedule":return a.jsxDEV(Kp,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:25,columnNumber:16},void 0);case"work_request":return a.jsxDEV(vN,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:27,columnNumber:16},void 0);default:return a.jsxDEV(Sc,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:29,columnNumber:16},void 0)}},d=h=>{switch(h){case"payment":return"text-green-600 bg-green-50";case"as_request":return"text-yellow-600 bg-yellow-50";case"schedule":return"text-blue-600 bg-blue-50";case"work_request":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{i(h.id),h.link&&(t(h.link),e())};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:59,columnNumber:7},void 0),a.jsxDEV("div",{className:"fixed right-0 top-16 h-[calc(100vh-4rem)] w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV(Sc,{className:"h-5 w-5 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:69,columnNumber:13},void 0),a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:70,columnNumber:13},void 0),r>0&&a.jsxDEV("span",{className:"px-2 py-0.5 bg-gray-900 text-white text-xs font-bold rounded-full",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:72,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:68,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:67,columnNumber:9},void 0),n.length>0&&a.jsxDEV("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 border-b border-gray-200",children:[r>0&&a.jsxDEV("button",{onClick:o,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-900",children:[a.jsxDEV(zp,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:93,columnNumber:17},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:89,columnNumber:15},void 0),a.jsxDEV("button",{onClick:u,className:"flex items-center gap-1 text-xs text-gray-600 hover:text-red-600 ml-auto",children:[a.jsxDEV(oi,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:101,columnNumber:15},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:87,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:n.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsxDEV(Sc,{className:"h-12 w-12 text-gray-300 mb-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:111,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:112,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:110,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-100",children:n.map(h=>a.jsxDEV("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${h.read?"":"bg-blue-50"}`,onClick:()=>f(h),children:a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${d(h.type)}`,children:m(h.type)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:126,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-start justify-between gap-2",children:[a.jsxDEV("p",{className:`text-sm font-semibold ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:133,columnNumber:25},void 0),!h.read&&a.jsxDEV("span",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mt-1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:137,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:132,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:140,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:jN(new Date(h.createdAt),{addSuffix:!0,locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:143,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:131,columnNumber:21},void 0),a.jsxDEV("button",{onClick:y=>{y.stopPropagation(),l(h.id)},className:"flex-shrink-0 p-1 hover:bg-gray-200 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:159,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:152,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:124,columnNumber:19},void 0)},h.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:117,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:115,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/NotificationPanel.tsx",lineNumber:57,columnNumber:5},void 0)},Di="work_requests",Do=s=>{const e=s.data();return{_id:s.id,project:e.project||"",requestType:e.requestType||"",description:e.description||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",dueDate:e.dueDate instanceof xe?e.dueDate.toDate().toISOString():e.dueDate||"",requestedBy:e.requestedBy||"",assignedTo:e.assignedTo||"",status:e.status||"pending",priority:e.priority||"medium",notes:e.notes||"",completedDate:e.completedDate instanceof xe?e.completedDate.toDate().toISOString():e.completedDate,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},ki={getAllWorkRequests:async()=>{const s=Nt(qe(re,Di),Gt("createdAt","desc"));return(await Vt(s)).docs.map(Do)},getWorkRequestById:async s=>{const e=Te(re,Di,s),t=await It(e);return t.exists()?Do(t):null},createWorkRequest:async s=>{const e=xe.now(),t={project:s.project,requestType:s.requestType,description:s.description,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,dueDate:s.dueDate instanceof Date?xe.fromDate(s.dueDate):s.dueDate,requestedBy:s.requestedBy,assignedTo:s.assignedTo,status:s.status||"pending",priority:s.priority||"medium",notes:s.notes||"",createdAt:e,updatedAt:e},n=await qn(qe(re,Di),t),r=await It(n);return Do(r)},updateWorkRequest:async(s,e)=>{const t=Te(re,Di,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.requestType!==void 0&&(n.requestType=e.requestType),e.description!==void 0&&(n.description=e.description),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.dueDate!==void 0&&(n.dueDate=e.dueDate instanceof Date?xe.fromDate(e.dueDate):e.dueDate),e.requestedBy!==void 0&&(n.requestedBy=e.requestedBy),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.status!==void 0&&(n.status=e.status),e.priority!==void 0&&(n.priority=e.priority),e.notes!==void 0&&(n.notes=e.notes),e.completedDate!==void 0&&(n.completedDate=e.completedDate instanceof Date?xe.fromDate(e.completedDate):e.completedDate),await Ht(t,n);const r=await It(t);return Do(r)},deleteWorkRequest:async s=>{const e=Te(re,Di,s);await Hs(e)},subscribeToWorkRequests:s=>{const e=Nt(qe(re,Di),Gt("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Do);s(n)})}},DC={getAllWorkRequests:()=>ki.getAllWorkRequests(),getWorkRequestById:async s=>{const e=await ki.getWorkRequestById(s);if(!e)throw new Error("Work request not found");return e},createWorkRequest:s=>ki.createWorkRequest(s),updateWorkRequest:(s,e)=>ki.updateWorkRequest(s,e),deleteWorkRequest:s=>ki.deleteWorkRequest(s),subscribeToWorkRequests:ki.subscribeToWorkRequests},Ut={PROJECTS:"projects",PAYMENTS:"payments",EXECUTION_RECORDS:"execution_records",USERS:"users",SPECBOOK_ITEMS:"specbook_items",SPECBOOK_CATEGORIES:"specbook_categories"};async function m2(s,e){const t=qe(re,s);return(await qn(t,{...e,createdAt:xe.now(),updatedAt:xe.now()})).id}function to(s){return!s||typeof s!="string"||s.startsWith("http://")||s.startsWith("https://")?!1:!!(s.startsWith("data:image")||s.length>1e3)}function kC(s){if(s.startsWith("data:")){const e=s.match(/data:([^;]+);/);if(e)return e[1]}return"image/jpeg"}function AC(s){return{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf"}[s]||"jpg"}function EC(s){let e=s,t="image/jpeg";if(s.includes(",")){const o=s.split(",");e=o[1];const l=o[0].match(/data:([^;]+);/);l&&(t=l[1])}const n=atob(e),r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);const i=new Uint8Array(r);return new Blob([i],{type:t})}async function Wy(s,e,t,n){if(!to(t))return t;const r=kC(t),i=AC(r),o=n!==void 0?`image_${n}.${i}`:`main.${i}`,l=`${s}/${e}/${o}`,u=Pl(Il,l),m=EC(t);return await Ru(u,m,{contentType:r}),await Bu(u)}async function jl(s,e,t){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=await Wy(s,e,i,r);n.push(o)}return n}async function zy(s){if(s.includes("firebasestorage.googleapis.com"))try{const e=s.match(/\/o\/(.+)\?/);if(e){const t=decodeURIComponent(e[1]),n=Pl(Il,t);await SE(n)}}catch(e){console.warn("  :",e)}}async function Ky(s){await Promise.all(s.map(e=>zy(e)))}let ii=new Map,Oi=null;async function fr(){if(!(ii.size>0))return Oi||(Oi=(async()=>{try{const s=qe(re,Ut.PROJECTS);(await Vt(s)).docs.forEach(t=>{const n=t.data();ii.set(t.id,{name:n.name||"",color:n.color||"#4A90E2"})}),console.log("[paymentFirestoreService]    :",ii.size,"")}catch(s){throw console.error("[paymentFirestoreService]    :",s),Oi=null,s}})(),Oi)}function ko(s){const e=ii.get(String(s.projectId))||{name:"",color:"#4A90E2"};return!e.name&&s.status==="pending"&&console.warn("[convertToPaymentResponse]  !",{paymentId:s.id,projectId:s.projectId,cacheSize:ii.size,cacheKeys:Array.from(ii.keys()).slice(0,5),vendorName:s.vendorName}),{id:s.id,project_id:s.projectId,project_name:e.name,project_color:e.color,user_id:s.userId||0,requester_name:"",approved_by:s.approvedBy||void 0,request_type:s.requestType||"material",vendor_name:s.vendorName||"",description:s.description||"",amount:s.amount||0,account_holder:s.accountHolder||"",bank_name:s.bankName||"",account_number:s.accountNumber||"",item_name:s.itemName||"",material_amount:s.materialAmount||0,labor_amount:s.laborAmount||0,original_material_amount:s.originalMaterialAmount||0,original_labor_amount:s.originalLaborAmount||0,apply_tax_deduction:s.applyTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,quick_text:s.quickText||"",images:s.images?JSON.stringify(s.images):"[]",notes:s.notes||"",status:s.status||"pending",created_at:s.createdAt||"",updated_at:s.updatedAt||"",paid_at:s.paidAt||void 0}}function up(s){const e={};return s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.request_type!==void 0&&(e.requestType=s.request_type),s.category!==void 0&&(e.requestType=s.category),s.vendor_name!==void 0&&(e.vendorName=s.vendor_name),s.process!==void 0&&(e.vendorName=s.process),s.description!==void 0&&(e.description=s.description),s.purpose!==void 0&&(e.description=s.purpose),s.amount!==void 0&&(e.amount=s.amount),s.account_holder!==void 0&&(e.accountHolder=s.account_holder),s.bank_name!==void 0&&(e.bankName=s.bank_name),s.account_number!==void 0&&(e.accountNumber=s.account_number),s.notes!==void 0&&(e.notes=s.notes),s.itemName!==void 0&&(e.itemName=s.itemName),s.item_name!==void 0&&(e.itemName=s.item_name),s.materialAmount!==void 0&&(e.materialAmount=s.materialAmount),s.laborAmount!==void 0&&(e.laborAmount=s.laborAmount),s.originalMaterialAmount!==void 0&&(e.originalMaterialAmount=s.originalMaterialAmount),s.originalLaborAmount!==void 0&&(e.originalLaborAmount=s.originalLaborAmount),s.applyTaxDeduction!==void 0&&(e.applyTaxDeduction=s.applyTaxDeduction),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),s.quickText!==void 0&&(e.quickText=s.quickText),s.images!==void 0&&(e.images=Array.isArray(s.images)?s.images:[]),s.status!==void 0&&(e.status=s.status),e}const tn={getAllPayments:async()=>{await fr();const s=qe(re,Ut.PAYMENTS),e=Nt(s,Gt("id","desc"));return(await Vt(e)).docs.map(n=>{const r=n.data();return ko({...r,id:parseInt(n.id)||r.id})})},getPaymentById:async s=>{await fr();const e=Te(re,Ut.PAYMENTS,s),t=await It(e);if(t.exists()){const n=t.data();return ko({...n,id:parseInt(t.id)||n.id})}return null},createPayment:async s=>{await fr();const e=qe(re,Ut.PAYMENTS),t=await Vt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=n+1,i=up(s),o=new Date().toISOString(),l={id:r,projectId:i.projectId||0,userId:1,requestType:i.requestType||"material",vendorName:i.vendorName||"",description:i.description||"",amount:i.amount||0,accountHolder:i.accountHolder||"",bankName:i.bankName||"",accountNumber:i.accountNumber||"",status:"pending",approvedBy:null,paidAt:null,receiptUrl:null,notes:i.notes||"",createdAt:o,updatedAt:o,applyTaxDeduction:i.applyTaxDeduction||!1,materialAmount:i.materialAmount||i.amount||0,laborAmount:i.laborAmount||0,originalMaterialAmount:i.originalMaterialAmount||0,originalLaborAmount:i.originalLaborAmount||0,itemName:i.itemName||"",includesVAT:i.includesVAT||!1,quickText:i.quickText||"",images:[],imageCount:0},u=Te(re,Ut.PAYMENTS,String(r));if(await ci(u,l),i.images&&i.images.length>0)if(i.images.some(d=>to(d))){const d=await jl("payments",String(r),i.images);await Ht(u,{images:d,imageCount:d.length}),l.images=d,l.imageCount=d.length}else await Ht(u,{images:i.images,imageCount:i.images.length}),l.images=i.images,l.imageCount=i.images.length;return ko(l)},updatePayment:async(s,e)=>{await fr();const t=Te(re,Ut.PAYMENTS,s),n=up(e);await Ht(t,{...n,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentStatus:async(s,e)=>{await fr();const t=Te(re,Ut.PAYMENTS,s),n=new Date().toISOString(),r={status:e,updatedAt:n};e==="completed"&&(r.paidAt=n),await Ht(t,r);const i=await tn.getPaymentById(s);if(!i)throw new Error("Payment not found after update");return i},updatePaymentAmounts:async(s,e,t)=>{await fr();const n=Te(re,Ut.PAYMENTS,s);await Ht(n,{materialAmount:e,laborAmount:t,updatedAt:new Date().toISOString()});const r=await tn.getPaymentById(s);if(!r)throw new Error("Payment not found after update");return r},updatePaymentImages:async(s,e)=>{const t=Te(re,Ut.PAYMENTS,s);let n=e;return e.length>0&&e.some(i=>to(i))&&(n=await jl("payments",s,e)),await Ht(t,{images:n,imageCount:n.length,updatedAt:new Date().toISOString()}),{message:"Images updated successfully",images:n}},deletePayment:async s=>{const e=Te(re,Ut.PAYMENTS,s),t=await It(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Ky(n.images)}await Hs(e)},subscribeToPayments:s=>{let e=null;return fr().then(()=>{const t=qe(re,Ut.PAYMENTS),n=Nt(t,Gt("id","desc"));e=dn(n,r=>{const i=r.docs.map(o=>{const l=o.data();return ko({...l,id:parseInt(o.id)||l.id})});s(i)})}).catch(t=>{console.error("[paymentFirestoreService]       :",t)}),()=>{e&&e()}},getPaymentsByProject:async s=>{await fr();const e=qe(re,Ut.PAYMENTS),t=Nt(e,js("projectId","==",s),Gt("id","desc"));return(await Vt(t)).docs.map(r=>{const i=r.data();return ko({...i,id:parseInt(r.id)||i.id})})},clearProjectsCache:()=>{ii.clear(),Oi=null}},ln={getAllPayments:()=>tn.getAllPayments(),getPaymentById:async s=>{const e=await tn.getPaymentById(s);if(!e)throw new Error("Payment not found");return e},createPayment:s=>tn.createPayment(s),updatePayment:(s,e)=>tn.updatePayment(s,e),updatePaymentStatus:(s,e)=>tn.updatePaymentStatus(s,e),updatePaymentAmounts:(s,e,t)=>tn.updatePaymentAmounts(s,e,t),updatePaymentImages:(s,e)=>tn.updatePaymentImages(s,e),deletePayment:s=>tn.deletePayment(s),sendTossPaymentSms:async s=>(await zi.post("/payments/send-toss-payment-sms",s)).data,subscribeToPayments:tn.subscribeToPayments,getPaymentsByProject:tn.getPaymentsByProject,clearProjectsCache:tn.clearProjectsCache},Ai="as_requests",Ao=s=>{const e=s.data();return{_id:s.id,project:e.project||"",client:e.client||"",requestDate:e.requestDate instanceof xe?e.requestDate.toDate().toISOString():e.requestDate||"",siteAddress:e.siteAddress||"",entrancePassword:e.entrancePassword||"",description:e.description||"",scheduledVisitDate:e.scheduledVisitDate instanceof xe?e.scheduledVisitDate.toDate().toISOString():e.scheduledVisitDate,scheduledVisitTime:e.scheduledVisitTime||"",assignedTo:e.assignedTo||"",completionDate:e.completionDate instanceof xe?e.completionDate.toDate().toISOString():e.completionDate,notes:e.notes||"",status:e.status||"pending",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Ei={getAllASRequests:async()=>{const s=Nt(qe(re,Ai),Gt("createdAt","desc"));return(await Vt(s)).docs.map(Ao)},getASRequestById:async s=>{const e=Te(re,Ai,s),t=await It(e);return t.exists()?Ao(t):null},createASRequest:async s=>{const e=xe.now(),t={project:s.project,client:s.client,requestDate:s.requestDate instanceof Date?xe.fromDate(s.requestDate):s.requestDate,siteAddress:s.siteAddress,entrancePassword:s.entrancePassword,description:s.description,status:s.status||"pending",notes:s.notes||"",createdAt:e,updatedAt:e};s.scheduledVisitDate&&(t.scheduledVisitDate=s.scheduledVisitDate instanceof Date?xe.fromDate(s.scheduledVisitDate):s.scheduledVisitDate),s.scheduledVisitTime&&(t.scheduledVisitTime=s.scheduledVisitTime),s.assignedTo&&(t.assignedTo=s.assignedTo);const n=await qn(qe(re,Ai),t),r=await It(n);return Ao(r)},updateASRequest:async(s,e)=>{const t=Te(re,Ai,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.requestDate!==void 0&&(n.requestDate=e.requestDate instanceof Date?xe.fromDate(e.requestDate):e.requestDate),e.siteAddress!==void 0&&(n.siteAddress=e.siteAddress),e.entrancePassword!==void 0&&(n.entrancePassword=e.entrancePassword),e.description!==void 0&&(n.description=e.description),e.scheduledVisitDate!==void 0&&(n.scheduledVisitDate=e.scheduledVisitDate instanceof Date?xe.fromDate(e.scheduledVisitDate):e.scheduledVisitDate),e.scheduledVisitTime!==void 0&&(n.scheduledVisitTime=e.scheduledVisitTime),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.completionDate!==void 0&&(n.completionDate=e.completionDate instanceof Date?xe.fromDate(e.completionDate):e.completionDate),e.notes!==void 0&&(n.notes=e.notes),e.status!==void 0&&(n.status=e.status),await Ht(t,n);const r=await It(t);return Ao(r)},deleteASRequest:async s=>{const e=Te(re,Ai,s);await Hs(e)},subscribeToASRequests:s=>{const e=Nt(qe(re,Ai),Gt("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(Ao);s(n)})}},Oo={getAllASRequests:()=>Ei.getAllASRequests(),getASRequestById:async s=>{const e=await Ei.getASRequestById(s);if(!e)throw new Error("AS Request not found");return e},createASRequest:s=>Ei.createASRequest(s),updateASRequest:(s,e)=>Ei.updateASRequest(s,e),deleteASRequest:s=>Ei.deleteASRequest(s),subscribeToASRequests:Ei.subscribeToASRequests};function Eo(s){const e={planning:"planning","in-progress":"inProgress",completed:"completed","on-hold":"onHold"};return{_id:s.id,id:parseInt(s.id)||0,name:s.name,client:{name:s.client||"",phone:"",address:s.address||""},location:{address:s.address||""},startDate:s.startDate||"",endDate:s.endDate||"",status:e[s.status]||"planning",budget:0,actualCost:0,manager:{_id:String(s.managerId||""),name:s.managerName||s.manager||"",username:s.managerUsername||""},fieldManagers:[],workers:[],colorCode:s.color||"#4A90E2",progress:0,description:s.description||"",attachments:[],createdBy:{_id:"",name:"",username:""},createdAt:s.createdAt||"",updatedAt:s.updatedAt||"",meetingNotes:s.meetingNotes||[],customerRequests:s.customerRequests||[],entrancePassword:s.entrancePassword||"",sitePassword:s.sitePassword||""}}function mp(s){var t,n,r,i,o,l,u,m;const e={};if(s.name!==void 0&&(e.name=s.name),s.client!==void 0&&(e.client=typeof s.client=="string"?s.client:((t=s.client)==null?void 0:t.name)||""),s.location!==void 0&&(e.address=typeof s.location=="string"?s.location:((n=s.location)==null?void 0:n.address)||""),s.address!==void 0&&(e.address=s.address),s.startDate!==void 0&&(e.startDate=typeof s.startDate=="string"?s.startDate:((o=(i=(r=s.startDate)==null?void 0:r.toISOString)==null?void 0:i.call(r))==null?void 0:o.split("T")[0])||null),s.endDate!==void 0&&(e.endDate=typeof s.endDate=="string"?s.endDate:((m=(u=(l=s.endDate)==null?void 0:l.toISOString)==null?void 0:u.call(l))==null?void 0:m.split("T")[0])||null),s.status!==void 0){const d={planning:"planning",inProgress:"in-progress","in-progress":"in-progress",completed:"completed",onHold:"on-hold","on-hold":"on-hold"};e.status=d[s.status]||"planning"}return s.description!==void 0&&(e.description=s.description),s.manager!==void 0&&(e.manager=s.manager),s.meetingNotes!==void 0&&(e.meetingNotes=s.meetingNotes),s.customerRequests!==void 0&&(e.customerRequests=s.customerRequests),s.entrancePassword!==void 0&&(e.entrancePassword=s.entrancePassword),s.sitePassword!==void 0&&(e.sitePassword=s.sitePassword),s.color!==void 0&&(e.color=s.color),s.colorCode!==void 0&&(e.color=s.colorCode),e}const yr={getAllProjects:async()=>{const s=qe(re,Ut.PROJECTS);return(await Vt(s)).docs.map(n=>{const r=n.data();return Eo({...r,id:n.id})}).sort((n,r)=>(r.id||0)-(n.id||0))},getProjectById:async s=>{const e=Te(re,Ut.PROJECTS,s),t=await It(e);if(t.exists()){const n=t.data();return Eo({...n,id:t.id})}return null},createProject:async s=>{const e=qe(re,Ut.PROJECTS),t=await Vt(e);let n=0;t.docs.forEach(m=>{const d=parseInt(m.id);!isNaN(d)&&d>n&&(n=d)});const r=String(n+1),i=mp(s),o=new Date().toISOString(),l={id:r,name:i.name||"",client:i.client||"",address:i.address||"",startDate:i.startDate||null,endDate:i.endDate||null,status:i.status||"planning",color:i.color||"#4A90E2",managerId:null,manager:i.manager||"",managerName:"",managerUsername:"",description:i.description||"",meetingNotes:i.meetingNotes||[],customerRequests:i.customerRequests||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||"",createdAt:o,updatedAt:o},u=Te(re,Ut.PROJECTS,r);return await ci(u,l),Eo(l)},updateProject:async(s,e)=>{const t=Te(re,Ut.PROJECTS,s),n=mp(e);await Ht(t,{...n,updatedAt:new Date().toISOString()});const r=await yr.getProjectById(s);if(!r)throw new Error("Project not found after update");return r},deleteProject:async s=>{const e=Te(re,Ut.PROJECTS,s);await Hs(e)},subscribeToProjects:s=>{const e=qe(re,Ut.PROJECTS);return dn(e,t=>{const n=t.docs.map(r=>{const i=r.data();return Eo({...i,id:r.id})});n.sort((r,i)=>(i.id||0)-(r.id||0)),s(n)})},subscribeToProject:(s,e)=>{const t=Te(re,Ut.PROJECTS,s);return dn(t,n=>{if(n.exists()){const r=n.data();e(Eo({...r,id:n.id}))}else e(null)})}},qi={getAllProjects:()=>yr.getAllProjects(),getProjectById:async s=>{const e=await yr.getProjectById(s);if(!e)throw new Error("Project not found");return e},createProject:s=>yr.createProject(s),updateProject:(s,e)=>yr.updateProject(s,e),deleteProject:s=>yr.deleteProject(s),subscribeToProjects:yr.subscribeToProjects,subscribeToProject:yr.subscribeToProject},Yc=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),Wa={async getAllQuoteInquiries(){const s=qe(re,"quote_inquiries"),e=Nt(s,Gt("createdAt","desc"));return(await Vt(e)).docs.map(n=>{const r=n.data();return{id:n.id,name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address,projectType:r.projectType,budget:r.budget,message:r.message||"",createdAt:Yc(r.createdAt),isRead:r.isRead||!1}})},async getQuoteInquiryById(s){const e=Te(re,"quote_inquiries",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{id:t.id,name:n.name||"",phone:n.phone||"",email:n.email||"",address:n.address,projectType:n.projectType,budget:n.budget,message:n.message||"",createdAt:Yc(n.createdAt),isRead:n.isRead||!1}},async createQuoteInquiry(s){const e=qe(re,"quote_inquiries"),t={...s,isRead:!1,createdAt:ls()};return{id:(await qn(e,t)).id,...s,createdAt:new Date().toISOString(),isRead:!1}},async markAsRead(s){const e=Te(re,"quote_inquiries",s);await Ht(e,{isRead:!0,updatedAt:ls()})},async deleteQuoteInquiry(s){const e=Te(re,"quote_inquiries",s);await Hs(e)},async getUnreadCount(){return(await this.getAllQuoteInquiries()).filter(e=>!e.isRead).length},subscribeToQuoteInquiries(s){const e=qe(re,"quote_inquiries"),t=Nt(e,Gt("createdAt","desc"));return dn(t,r=>{const i=r.docs.map(o=>{const l=o.data();return{id:o.id,name:l.name||"",phone:l.phone||"",email:l.email||"",address:l.address,projectType:l.projectType,budget:l.budget,message:l.message||"",createdAt:Yc(l.createdAt),isRead:l.isRead||!1}});s(i)})}},pl={getAllQuoteInquiries:()=>Wa.getAllQuoteInquiries(),markAsRead:s=>Wa.markAsRead(s),deleteQuoteInquiry:s=>Wa.deleteQuoteInquiry(s),subscribeToQuoteInquiries:Wa.subscribeToQuoteInquiries},CC=()=>typeof window<"u"?window.location.origin:"",VC=CC();class wC{constructor(){Vd(this,"socket",null)}connect(e){return this.socket=Fo(VC,{auth:{token:e},transports:["websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{console.log(" Socket connected")}),this.socket.on("disconnect",()=>{console.log(" Socket disconnected")}),this.socket.on("connect_error",t=>{console.error("Socket connection error:",t)}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}joinProject(e){var t;(t=this.socket)==null||t.emit("join:project",e)}leaveProject(e){var t;(t=this.socket)==null||t.emit("leave:project",e)}emitScheduleUpdate(e){var t;(t=this.socket)==null||t.emit("schedule:update",e)}onScheduleUpdated(e){var t;(t=this.socket)==null||t.on("schedule:updated",e)}emitPaymentRequest(e){var t;(t=this.socket)==null||t.emit("payment:request",e)}onNewPayment(e){var t;(t=this.socket)==null||t.on("payment:new",e)}emitPaymentStatusUpdate(e){var t;(t=this.socket)==null||t.emit("payment:statusUpdate",e)}onPaymentStatusChanged(e){var t;(t=this.socket)==null||t.on("payment:statusChanged",e)}onPaymentUpdate(e){var t;(t=this.socket)==null||t.on("payment:update",e)}sendMessage(e){var t;(t=this.socket)==null||t.emit("message:send",e)}onMessageReceive(e){var t;(t=this.socket)==null||t.on("message:receive",e)}sendNotification(e){var t;(t=this.socket)==null||t.emit("notification:send",e)}onNotificationReceive(e){var t;(t=this.socket)==null||t.on("notification:receive",e)}onActiveUsers(e){var t;(t=this.socket)==null||t.on("users:active",e)}on(e,t){var n;(n=this.socket)==null||n.on(e,t)}emit(e,t){var n;(n=this.socket)==null||n.emit(e,t)}off(e,t){var n;(n=this.socket)==null||n.off(e,t)}getSocket(){return this.socket}setSocket(e){this.socket=e}}const Nr=new wC,SC=()=>{var ae,Oe;const{user:s,logout:e,loading:t}=Or(),[n,r]=A.useState(!1),[i,o]=A.useState(!1),[l,u]=A.useState(!1),m=pN(),{unreadCount:d}=$y(),[f,h]=A.useState(0),[y,T]=A.useState(0),[v,V]=A.useState(0),[R,L]=A.useState(0),[q,oe]=A.useState(!1),[te,O]=A.useState(0),[C,N]=A.useState(!1),E=A.useRef(0),j=A.useRef(null),S=80,w=A.useCallback(de=>{if(window.scrollY>0)return!1;let Ie=de;for(;Ie&&Ie!==document.body;){const bt=window.getComputedStyle(Ie).overflowY;if((bt==="auto"||bt==="scroll")&&Ie.scrollTop>0)return!1;Ie=Ie.parentElement}return!0},[]),k=A.useCallback(de=>{if(window.innerWidth>=768)return;const Ie=de.target;w(Ie)&&(E.current=de.touches[0].clientY,oe(!0))},[w]),De=A.useCallback(de=>{if(!q||C)return;const Ie=de.target;if(!w(Ie)){oe(!1),O(0);return}const bt=de.touches[0].clientY-E.current;if(bt>0){const ot=Math.min(bt*.5,120);O(ot)}else oe(!1),O(0)},[q,C,w]),Me=A.useCallback(()=>{q&&(te>=S&&!C?(N(!0),O(50),setTimeout(()=>{window.location.reload()},300)):O(0),oe(!1))},[q,te,C]);if(A.useEffect(()=>{u(!1)},[m.pathname]),A.useEffect(()=>{const de=Ie=>{u(Ie.detail.isOpen)};return window.addEventListener("mobileFormStateChange",de),()=>window.removeEventListener("mobileFormStateChange",de)},[]),A.useEffect(()=>{const de=()=>{L(Ie=>Math.max(0,Ie-1))};return window.addEventListener("quoteInquiryRead",de),()=>window.removeEventListener("quoteInquiryRead",de)},[]),A.useEffect(()=>{const de=()=>{T(Ie=>Math.max(0,Ie-1))};return window.addEventListener("paymentCompleted",de),()=>window.removeEventListener("paymentCompleted",de)},[]),A.useEffect(()=>{const de=Nr.getSocket();if(!de||!s)return;const Ie=async()=>{try{const[Ke,bt]=await Promise.all([ln.getAllPayments(),qi.getAllProjects()]);let ot=Ke;if(s.name===""){const wt=bt.map(rt=>rt.name);ot=Ke.filter(rt=>wt.includes(rt.project))}T(ot.filter(wt=>wt.status==="pending").length)}catch(Ke){console.error("Failed to refresh payment count:",Ke)}};return de.on("payment:refresh",Ie),()=>{de.off("payment:refresh",Ie)}},[s]),A.useEffect(()=>{if(!s)return;const de=async()=>{try{const[Ke,bt,ot,wt]=await Promise.all([DC.getAllWorkRequests(),ln.getAllPayments(),Oo.getAllASRequests(),qi.getAllProjects()]);h(Ke.filter(mt=>mt.assignedTo===s.name&&mt.status==="pending").length);let rt=bt;if(s.name===""){const mt=wt.map(ds=>ds.name);rt=bt.filter(ds=>mt.includes(ds.project))}if(T(rt.filter(mt=>mt.status==="pending").length),V(ot.filter(mt=>mt.status==="in-progress").length),s.role==="admin"||s.role==="manager")try{const ds=(await pl.getAllQuoteInquiries()).filter(z=>!z.isRead).length;L(ds)}catch(mt){console.error("Failed to load quote inquiry count:",mt)}}catch(Ke){console.error("Failed to load badge counts:",Ke)}};de();const Ie=setInterval(de,3e4);return()=>clearInterval(Ie)},[s]),t)return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxDEV("div",{className:"text-center",children:[a.jsxDEV("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:247,columnNumber:11},void 0),a.jsxDEV("p",{className:"mt-4 text-gray-600",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:248,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:245,columnNumber:7},void 0);if(!s){const de=window.location.pathname+window.location.search;return de&&de!=="/login"&&de!=="/"&&sessionStorage.setItem("redirectAfterLogin",de),a.jsxDEV(Wp,{to:"/login",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:261,columnNumber:12},void 0)}const he=[{name:"",href:"/dashboard"},{name:"",href:"/projects"},{name:"",href:"/schedule"},{name:"",href:"/drawings"},{name:"",href:"/site-log"},{name:"",href:"/additional-work"},{name:"",href:"/construction-payment",roles:["admin","manager"]},{name:"",href:"/work-request",...f>0&&{badge:f}},{name:"",href:"/specbook"},{name:"",href:"/finish-check"},{name:"",href:"/execution-history"},{name:"",href:"/payments",...y>0&&{badge:y}},{name:"AS ",href:"/after-service",...v>0&&{badge:v}},{name:"",href:"/estimate-preview",roles:["admin","manager"]},{name:"",href:"/quote-inquiry",roles:["admin","manager"],...R>0&&{badge:R}},{name:"",href:"/contractors"}],Re=he.filter(de=>!de.roles||de.roles.includes((s==null?void 0:s.role)||"")),ft=((ae=he.find(de=>de.href===m.pathname))==null?void 0:ae.name)||"",Ot=(()=>{const de=m.pathname;return["/projects","/schedule","/after-service","/additional-work","/construction-payment","/contractors","/work-request","/execution-history"].includes(de)?()=>{const Ke=new CustomEvent("headerAddButtonClick");window.dispatchEvent(Ke)}:null})();return a.jsxDEV("div",{className:"min-h-screen bg-gray-50",children:[a.jsxDEV("div",{className:Dn("fixed inset-0 z-40 lg:hidden",n?"block":"hidden"),children:[a.jsxDEV("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50",onClick:()=>r(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:329,columnNumber:9},void 0),a.jsxDEV("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[a.jsxDEV("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:335,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>r(!1),className:"text-sm text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:334,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Re.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Dn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),onClick:()=>{r(!1)},children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:362,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:364,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:361,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:345,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:343,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:373,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:372,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:323,columnNumber:7},void 0),a.jsxDEV("div",{className:"desktop-sidebar hidden lg:fixed lg:inset-y-0 lg:flex lg:w-56 lg:flex-col",children:a.jsxDEV("div",{className:"flex flex-col bg-white border-r border-gray-200",children:[a.jsxDEV("div",{className:"flex h-16 items-center px-6 border-b border-gray-200",children:a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:387,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:386,columnNumber:11},void 0),a.jsxDEV("nav",{className:"flex-1 space-y-1 px-4 py-4",children:Re.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Dn("block px-4 py-3 text-sm font-medium border-l-2 transition-colors relative",Ie?"border-gray-900 bg-gray-50 text-gray-900":"border-transparent text-gray-600 hover:border-gray-400 hover:bg-gray-50"),children:a.jsxDEV("span",{className:"flex items-center justify-between",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:404,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:406,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:403,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:391,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:389,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-4 py-4",children:a.jsxDEV("button",{onClick:e,className:"w-full px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 text-left",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:415,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:414,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:385,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:384,columnNumber:7},void 0),a.jsxDEV("div",{className:"main-content lg:pl-56",children:[a.jsxDEV("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200 print-hide",children:a.jsxDEV("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6 lg:px-8",children:[a.jsxDEV("div",{className:"flex items-center space-x-3",children:[a.jsxDEV("button",{onClick:()=>r(!0),className:"lg:hidden p-2 text-gray-600 hover:text-gray-900 -ml-2","aria-label":" ",children:a.jsxDEV("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:438,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:437,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:432,columnNumber:15},void 0),ft&&a.jsxDEV("h1",{className:"text-lg font-bold text-gray-900",children:ft},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:442,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:431,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2 sm:space-x-6 ml-auto",children:[Ot&&a.jsxDEV("button",{onClick:Ot,className:"lg:hidden p-2 text-gray-900 hover:text-gray-700","aria-label":l?"":"",children:l?a.jsxDEV(vs,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:37},void 0):a.jsxDEV($i,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:455,columnNumber:65},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>o(!i),className:"hidden sm:block relative p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"",children:[a.jsxDEV("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:465,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:464,columnNumber:17},void 0),d>0&&a.jsxDEV("span",{className:"absolute top-1 right-1 flex items-center justify-center h-4 w-4 bg-red-600 text-white text-[10px] font-bold rounded-full",children:d>9?"9+":d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:468,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:459,columnNumber:15},void 0),a.jsxDEV("div",{className:"hidden sm:flex items-center space-x-2 sm:space-x-3",children:[a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("p",{className:"text-sm font-medium text-gray-900",children:s==null?void 0:s.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:475,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500",children:s==null?void 0:s.role},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:474,columnNumber:17},void 0),a.jsxDEV("div",{className:"h-8 w-8 sm:h-9 sm:w-9 bg-gray-900 text-white flex items-center justify-center text-xs font-bold rounded-full",children:(Oe=s==null?void 0:s.name)==null?void 0:Oe.substring(0,1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:447,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:429,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:428,columnNumber:9},void 0),a.jsxDEV("div",{className:"portrait-top-nav hidden",children:a.jsxDEV("div",{className:"flex items-center gap-1 px-2 py-2 bg-white border-b border-gray-200 overflow-x-auto",children:Re.map(de=>a.jsxDEV(wc,{to:de.href,className:({isActive:Ie})=>Dn("px-3 py-1.5 text-sm font-medium rounded-full whitespace-nowrap transition-colors relative",Ie?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-100"),children:a.jsxDEV("span",{className:"flex items-center gap-1",children:[a.jsxDEV("span",{children:de.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:503,columnNumber:19},void 0),de.badge&&de.badge>0&&a.jsxDEV("span",{className:"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full",children:de.badge>99?"99+":de.badge},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:502,columnNumber:17},void 0)},de.name,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:490,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:488,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:487,columnNumber:9},void 0),a.jsxDEV("main",{ref:j,className:"py-[10px] md:py-6 lg:py-8",onTouchStart:k,onTouchMove:De,onTouchEnd:Me,children:[te>0&&a.jsxDEV("div",{className:"md:hidden fixed left-0 right-0 flex items-center justify-center z-50 pointer-events-none",style:{top:56,height:te,transition:q?"none":"height 0.2s ease-out"},children:a.jsxDEV("div",{className:Dn("flex items-center justify-center w-10 h-10 bg-white rounded-full shadow-lg border",C&&"animate-spin"),style:{transform:`rotate(${C?0:te*2}deg)`,opacity:Math.min(te/S,1)},children:a.jsxDEV(kN,{className:Dn("w-5 h-5",te>=S?"text-blue-600":"text-gray-400")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:543,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:533,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:525,columnNumber:13},void 0),a.jsxDEV("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8",style:{transform:te>0?`translateY(${te}px)`:"none",transition:q?"none":"transform 0.2s ease-out"},children:a.jsxDEV(hN,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:560,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:516,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:426,columnNumber:7},void 0),a.jsxDEV(_C,{isOpen:i,onClose:()=>o(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:566,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/Layout.tsx",lineNumber:321,columnNumber:5},void 0)},TC=s=>{try{const e=window.AudioContext||window.webkitAudioContext,t=new e,n=s==="emergency"?5:3;let r=0;const i=()=>{if(r>=n)return;const o=t.createOscillator(),l=t.createGain();o.connect(l),l.connect(t.destination),o.frequency.value=s==="emergency"?1e3:800,o.type="sine",l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),o.start(t.currentTime),o.stop(t.currentTime+.5),r++,r<n&&setTimeout(i,700)};i()}catch(e){console.error("  :",e)}},LC=s=>{if("vibrate"in navigator){const e=s==="emergency"?[200,200,200,200,200,200,200,200,200,200]:[200,200,200,200,200,200];navigator.vibrate(e)}},PC=(s,e)=>{TC(s),LC(s),"Notification"in window&&Notification.permission==="granted"&&new Notification("  ",{body:e,icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"urgent-payment",requireInteraction:!0})},IC=async()=>"Notification"in window&&Notification.permission==="default"?await Notification.requestPermission()==="granted":Notification.permission==="granted",Ci="schedules",Co=s=>{const e=s.data();return{_id:s.id,project:e.project||{_id:"",name:""},title:e.title||"",type:e.type||"other",phase:e.phase||"",startDate:e.startDate instanceof xe?e.startDate.toDate().toISOString():e.startDate||"",endDate:e.endDate instanceof xe?e.endDate.toDate().toISOString():e.endDate||"",allDay:e.allDay??!0,assignedTo:e.assignedTo||[],assigneeNames:e.assigneeNames||[],description:e.description||"",location:e.location||"",priority:e.priority||"medium",progress:e.progress??0,isCompleted:e.isCompleted??!1,completedAt:e.completedAt instanceof xe?e.completedAt.toDate().toISOString():e.completedAt,createdBy:e.createdBy||{_id:"",name:"",username:""},createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||"",time:e.time||""}},Vi={getAllSchedules:async()=>{const s=Nt(qe(re,Ci),Gt("startDate","desc"));return(await Vt(s)).docs.map(Co)},getScheduleById:async s=>{const e=Te(re,Ci,s),t=await It(e);return t.exists()?Co(t):null},createSchedule:async s=>{const e=xe.now(),t={project:typeof s.project=="string"?{_id:s.project,name:s.project}:s.project,title:s.title,type:s.type||"other",phase:s.phase||"",startDate:s.startDate instanceof Date?xe.fromDate(s.startDate):s.startDate,endDate:s.endDate instanceof Date?xe.fromDate(s.endDate):s.endDate,allDay:s.allDay??!0,assignedTo:s.assignedTo||[],description:s.description||"",location:s.location||"",priority:s.priority||"medium",progress:s.progress??0,isCompleted:s.isCompleted??!1,time:s.time||"",asRequestId:s.asRequestId||null,createdAt:e,updatedAt:e},n=await qn(qe(re,Ci),t),r=await It(n);return Co(r)},updateSchedule:async(s,e)=>{const t=Te(re,Ci,s),n={updatedAt:xe.now()};e.project!==void 0&&(n.project=typeof e.project=="string"?{_id:e.project,name:e.project}:e.project),e.title!==void 0&&(n.title=e.title),e.type!==void 0&&(n.type=e.type),e.phase!==void 0&&(n.phase=e.phase),e.startDate!==void 0&&(n.startDate=e.startDate instanceof Date?xe.fromDate(e.startDate):e.startDate),e.endDate!==void 0&&(n.endDate=e.endDate instanceof Date?xe.fromDate(e.endDate):e.endDate),e.allDay!==void 0&&(n.allDay=e.allDay),e.assignedTo!==void 0&&(n.assignedTo=e.assignedTo),e.description!==void 0&&(n.description=e.description),e.location!==void 0&&(n.location=e.location),e.priority!==void 0&&(n.priority=e.priority),e.progress!==void 0&&(n.progress=e.progress),e.isCompleted!==void 0&&(n.isCompleted=e.isCompleted,e.isCompleted&&(n.completedAt=xe.now())),e.time!==void 0&&(n.time=e.time),await Ht(t,n);const r=await It(t);return Co(r)},deleteSchedule:async s=>{const e=Te(re,Ci,s);await Hs(e)},subscribeToSchedules:s=>{const e=Nt(qe(re,Ci),Gt("startDate","desc"));return dn(e,t=>{const n=t.docs.map(Co);s(n)})}},za={getAllSchedules:()=>Vi.getAllSchedules(),getScheduleById:async s=>{const e=await Vi.getScheduleById(s);if(!e)throw new Error("Schedule not found");return e},createSchedule:s=>Vi.createSchedule(s),updateSchedule:(s,e)=>Vi.updateSchedule(s,e),deleteSchedule:s=>Vi.deleteSchedule(s),subscribeToSchedules:Vi.subscribeToSchedules},wi="contractors",Vo=s=>{const e=s.data();return{_id:s.id,rank:e.rank||"",companyName:e.companyName||"",name:e.name||"",position:e.position||"",process:e.process||"",contact:e.contact||"",accountNumber:e.accountNumber||"",notes:e.notes||"",createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Si={getAllContractors:async()=>{const s=Nt(qe(re,wi),Gt("name","asc"));return(await Vt(s)).docs.map(Vo)},getContractorById:async s=>{const e=Te(re,wi,s),t=await It(e);return t.exists()?Vo(t):null},createContractor:async s=>{const e=xe.now(),t={rank:s.rank||"",companyName:s.companyName||"",name:s.name,position:s.position||"",process:s.process,contact:s.contact||"",accountNumber:s.accountNumber,notes:s.notes||"",createdAt:e,updatedAt:e},n=await qn(qe(re,wi),t),r=await It(n);return Vo(r)},updateContractor:async(s,e)=>{const t=Te(re,wi,s),n={updatedAt:xe.now()};e.rank!==void 0&&(n.rank=e.rank),e.companyName!==void 0&&(n.companyName=e.companyName),e.name!==void 0&&(n.name=e.name),e.position!==void 0&&(n.position=e.position),e.process!==void 0&&(n.process=e.process),e.contact!==void 0&&(n.contact=e.contact),e.accountNumber!==void 0&&(n.accountNumber=e.accountNumber),e.notes!==void 0&&(n.notes=e.notes),await Ht(t,n);const r=await It(t);return Vo(r)},deleteContractor:async s=>{const e=Te(re,wi,s);await Hs(e)},subscribeToContractors:s=>{const e=Nt(qe(re,wi),Gt("name","asc"));return dn(e,t=>{const n=t.docs.map(Vo);s(n)})}},Jn={getAllContractors:()=>Si.getAllContractors(),getContractorById:async s=>{const e=await Si.getContractorById(s);if(!e)throw new Error("Contractor not found");return e},createContractor:s=>Si.createContractor(s),updateContractor:(s,e)=>Si.updateContractor(s,e),deleteContractor:s=>Si.deleteContractor(s),subscribeToContractors:Si.subscribeToContractors},Ti="construction_payments",wo=s=>{const e=s.data();let t=e.payments||[];if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}Array.isArray(t)||(t=[]);const n=t.map(i=>{let o=i.types||[];if(typeof o=="string")try{o=JSON.parse(o)}catch{o=[o]}return Array.isArray(o)||(o=[]),{types:o,type:o[0]||i.type||"",amount:i.amount||0,date:i.date instanceof xe?i.date.toDate().toISOString():i.date||"",method:i.method||"",notes:i.notes||""}}),r={};return e.expectedPaymentDates&&(e.expectedPaymentDates.contract&&(r.contract=e.expectedPaymentDates.contract instanceof xe?e.expectedPaymentDates.contract.toDate().toISOString():e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(r.start=e.expectedPaymentDates.start instanceof xe?e.expectedPaymentDates.start.toDate().toISOString():e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(r.middle=e.expectedPaymentDates.middle instanceof xe?e.expectedPaymentDates.middle.toDate().toISOString():e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(r.final=e.expectedPaymentDates.final instanceof xe?e.expectedPaymentDates.final.toDate().toISOString():e.expectedPaymentDates.final)),{_id:s.id,project:e.project||"",client:e.client||"",totalAmount:e.totalAmount||0,vatType:e.vatType||"percentage",vatPercentage:e.vatPercentage||0,vatAmount:e.vatAmount||0,payments:n,expectedPaymentDates:r,createdAt:e.createdAt instanceof xe?e.createdAt.toDate().toISOString():e.createdAt||"",updatedAt:e.updatedAt instanceof xe?e.updatedAt.toDate().toISOString():e.updatedAt||""}},Li={getAllConstructionPayments:async()=>{console.log("[ConstructionPayment] Firestore  ...");try{const s=await Vt(qe(re,Ti));console.log("[ConstructionPayment] Firestore :",s.size," ");const e=s.docs.map(wo).filter(t=>t.project&&t.totalAmount);return console.log("[ConstructionPayment] Firestore  :",e.length,""),e}catch(s){return console.error("[ConstructionPayment] Firestore  :",s),[]}},getConstructionPaymentById:async s=>{const e=Te(re,Ti,s),t=await It(e);return t.exists()?wo(t):null},createConstructionPayment:async s=>{const e=xe.now(),t=(s.payments||[]).map(l=>({types:l.types,amount:l.amount,date:l.date instanceof Date?xe.fromDate(l.date):l.date,method:l.method,notes:l.notes||""})),n={};s.expectedPaymentDates&&(s.expectedPaymentDates.contract&&(n.contract=s.expectedPaymentDates.contract instanceof Date?xe.fromDate(s.expectedPaymentDates.contract):s.expectedPaymentDates.contract),s.expectedPaymentDates.start&&(n.start=s.expectedPaymentDates.start instanceof Date?xe.fromDate(s.expectedPaymentDates.start):s.expectedPaymentDates.start),s.expectedPaymentDates.middle&&(n.middle=s.expectedPaymentDates.middle instanceof Date?xe.fromDate(s.expectedPaymentDates.middle):s.expectedPaymentDates.middle),s.expectedPaymentDates.final&&(n.final=s.expectedPaymentDates.final instanceof Date?xe.fromDate(s.expectedPaymentDates.final):s.expectedPaymentDates.final));const r={project:s.project,client:s.client,totalAmount:s.totalAmount,vatType:s.vatType,vatPercentage:s.vatPercentage,vatAmount:s.vatAmount,payments:t,expectedPaymentDates:n,createdAt:e,updatedAt:e},i=await qn(qe(re,Ti),r),o=await It(i);return wo(o)},updateConstructionPayment:async(s,e)=>{const t=Te(re,Ti,s),n={updatedAt:xe.now()};if(e.project!==void 0&&(n.project=e.project),e.client!==void 0&&(n.client=e.client),e.totalAmount!==void 0&&(n.totalAmount=e.totalAmount),e.vatType!==void 0&&(n.vatType=e.vatType),e.vatPercentage!==void 0&&(n.vatPercentage=e.vatPercentage),e.vatAmount!==void 0&&(n.vatAmount=e.vatAmount),e.payments!==void 0&&(n.payments=e.payments.map(i=>({types:i.types,amount:i.amount,date:i.date instanceof Date?xe.fromDate(i.date):i.date,method:i.method,notes:i.notes||""}))),e.expectedPaymentDates!==void 0){const i={};e.expectedPaymentDates.contract&&(i.contract=e.expectedPaymentDates.contract instanceof Date?xe.fromDate(e.expectedPaymentDates.contract):e.expectedPaymentDates.contract),e.expectedPaymentDates.start&&(i.start=e.expectedPaymentDates.start instanceof Date?xe.fromDate(e.expectedPaymentDates.start):e.expectedPaymentDates.start),e.expectedPaymentDates.middle&&(i.middle=e.expectedPaymentDates.middle instanceof Date?xe.fromDate(e.expectedPaymentDates.middle):e.expectedPaymentDates.middle),e.expectedPaymentDates.final&&(i.final=e.expectedPaymentDates.final instanceof Date?xe.fromDate(e.expectedPaymentDates.final):e.expectedPaymentDates.final),n.expectedPaymentDates=i}await Ht(t,n);const r=await It(t);return wo(r)},deleteConstructionPayment:async s=>{const e=Te(re,Ti,s);await Hs(e)},subscribeToConstructionPayments:s=>{const e=Nt(qe(re,Ti),Gt("createdAt","desc"));return dn(e,t=>{const n=t.docs.map(wo);s(n)})}},Ka={getAllConstructionPayments:()=>Li.getAllConstructionPayments(),getConstructionPaymentById:async s=>{const e=await Li.getConstructionPaymentById(s);if(!e)throw new Error("Construction payment not found");return e},createConstructionPayment:s=>Li.createConstructionPayment(s),updateConstructionPayment:(s,e)=>Li.updateConstructionPayment(s,e),deleteConstructionPayment:s=>Li.deleteConstructionPayment(s),subscribeToConstructionPayments:Li.subscribeToConstructionPayments};let hl=new Map,So=null;async function jC(){if(!(hl.size>0))return So||(So=(async()=>{try{const s=qe(re,Ut.PROJECTS);(await Vt(s)).docs.forEach(t=>{const n=t.data(),r=parseInt(t.id);!isNaN(r)&&n.name&&hl.set(n.name,r)}),console.log("[executionRecordFirestoreService]    :",hl.size,"")}catch(s){throw console.error("[executionRecordFirestoreService]    :",s),So=null,s}})(),So)}function Pi(s){return{id:s.id,project_id:s.projectId,project_name:s.projectName||"",author:s.author||"",date:s.date||"",process:s.process||"",item_name:s.itemName||"",material_cost:s.materialCost||0,labor_cost:s.laborCost||0,vat_amount:s.vatAmount||0,total_amount:s.totalAmount||0,notes:s.notes||"",images:s.images||[],payment_id:s.paymentId,includes_tax_deduction:s.includesTaxDeduction?1:0,includes_vat:s.includesVAT?1:0,created_at:s.createdAt||"",updated_at:s.updatedAt||""}}function dp(s){const e={};return s.project_id!==void 0&&(e.projectId=s.project_id),s.projectId!==void 0&&(e.projectId=s.projectId),s.project_name!==void 0&&(e.projectName=s.project_name),s.projectName!==void 0&&(e.projectName=s.projectName),s.author!==void 0&&(e.author=s.author),s.date!==void 0&&(e.date=s.date),s.process!==void 0&&(e.process=s.process),s.item_name!==void 0&&(e.itemName=s.item_name),s.itemName!==void 0&&(e.itemName=s.itemName),s.material_cost!==void 0&&(e.materialCost=s.material_cost),s.materialCost!==void 0&&(e.materialCost=s.materialCost),s.labor_cost!==void 0&&(e.laborCost=s.labor_cost),s.laborCost!==void 0&&(e.laborCost=s.laborCost),s.vat_amount!==void 0&&(e.vatAmount=s.vat_amount),s.vatAmount!==void 0&&(e.vatAmount=s.vatAmount),s.total_amount!==void 0&&(e.totalAmount=s.total_amount),s.totalAmount!==void 0&&(e.totalAmount=s.totalAmount),s.notes!==void 0&&(e.notes=s.notes),s.images!==void 0&&(e.images=s.images),s.payment_id!==void 0&&(e.paymentId=s.payment_id),s.paymentId!==void 0&&(e.paymentId=s.paymentId),s.includes_tax_deduction!==void 0&&(e.includesTaxDeduction=s.includes_tax_deduction===!0||s.includes_tax_deduction===1),s.includesTaxDeduction!==void 0&&(e.includesTaxDeduction=s.includesTaxDeduction),s.includes_vat!==void 0&&(e.includesVAT=s.includes_vat===!0||s.includes_vat===1),s.includesVAT!==void 0&&(e.includesVAT=s.includesVAT),e}const Xn={getAllRecords:async()=>{const s=qe(re,Ut.EXECUTION_RECORDS),e=Nt(s,Gt("id","desc"));return(await Vt(e)).docs.map(n=>{const r=n.data();return Pi({...r,id:parseInt(n.id)||r.id})})},getRecordById:async s=>{const e=Te(re,Ut.EXECUTION_RECORDS,s),t=await It(e);if(t.exists()){const n=t.data();return Pi({...n,id:parseInt(t.id)||n.id})}return null},createRecord:async s=>{await jC();const e=qe(re,Ut.EXECUTION_RECORDS),t=await Vt(e);let n=0;t.docs.forEach(f=>{const h=parseInt(f.id);!isNaN(h)&&h>n&&(n=h)});const r=n+1,i=dp(s),o=new Date().toISOString();let l=i.projectId||0;const u=i.projectName||"";if((!l||l===0)&&u){const f=hl.get(u);f?(l=f,console.log("[executionRecordFirestoreService]  ID :",u,"->",l)):console.warn("[executionRecordFirestoreService]   ID   :",u)}const m={id:r,projectId:l,projectName:u,author:i.author||"",date:i.date||o.split("T")[0],process:i.process||"",itemName:i.itemName||"",materialCost:i.materialCost||0,laborCost:i.laborCost||0,vatAmount:i.vatAmount||0,totalAmount:i.totalAmount||0,notes:i.notes||"",paymentId:i.paymentId||null,includesTaxDeduction:i.includesTaxDeduction||!1,includesVAT:i.includesVAT||!1,createdAt:o,updatedAt:o,images:[],imageCount:0},d=Te(re,Ut.EXECUTION_RECORDS,String(r));if(await ci(d,m),i.images&&i.images.length>0)if(i.images.some(h=>to(h))){const h=await jl("execution_records",String(r),i.images);await Ht(d,{images:h,imageCount:h.length}),m.images=h,m.imageCount=h.length}else await Ht(d,{images:i.images,imageCount:i.images.length}),m.images=i.images,m.imageCount=i.images.length;return Pi(m)},updateRecord:async(s,e)=>{const t=Te(re,Ut.EXECUTION_RECORDS,s),n=dp(e);n.images!==void 0&&(n.images.some(o=>to(o))&&(n.images=await jl("execution_records",s,n.images)),n.imageCount=n.images.length),await Ht(t,{...n,updatedAt:new Date().toISOString()});const r=await Xn.getRecordById(s);if(!r)throw new Error("Execution record not found after update");return r},deleteRecord:async s=>{const e=Te(re,Ut.EXECUTION_RECORDS,s),t=await It(e);if(t.exists()){const n=t.data();n.images&&n.images.length>0&&await Ky(n.images)}await Hs(e)},subscribeToRecords:s=>{const e=qe(re,Ut.EXECUTION_RECORDS),t=Nt(e,Gt("id","desc"));return dn(t,n=>{const r=n.docs.map(i=>{const o=i.data();return Pi({...o,id:parseInt(i.id)||o.id})});s(r)})},getRecordsByProject:async s=>{const e=qe(re,Ut.EXECUTION_RECORDS),t=Nt(e,js("projectId","==",s),Gt("id","desc"));return(await Vt(t)).docs.map(r=>{const i=r.data();return Pi({...i,id:parseInt(r.id)||i.id})})},getRecordByPaymentId:async s=>{const e=qe(re,Ut.EXECUTION_RECORDS),t=Nt(e,js("paymentId","==",s)),n=await Vt(t);if(n.empty)return null;const r=n.docs[0],i=r.data();return Pi({...i,id:parseInt(r.id)||i.id})}},Qa={getAllRecords:()=>Xn.getAllRecords(),getRecordById:async s=>{const e=await Xn.getRecordById(s);if(!e)throw new Error("Execution record not found");return e},createRecord:s=>Xn.createRecord(s),updateRecord:(s,e)=>Xn.updateRecord(s,e),deleteRecord:s=>Xn.deleteRecord(s),subscribeToRecords:Xn.subscribeToRecords,getRecordsByProject:Xn.getRecordsByProject,getRecordByPaymentId:Xn.getRecordByPaymentId},er=Wu()(qy((s,e)=>({projects:[],schedules:[],payments:[],contractors:[],constructionPayments:[],asRequests:[],executionRecords:[],setProjects:t=>s({projects:t}),addProject:t=>s(n=>{const r={id:t.id,project:t.name,client:t.client,totalAmount:t.contractAmount,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]};return{projects:[t,...n.projects],constructionPayments:[r,...n.constructionPayments]}}),updateProject:(t,n)=>s(r=>({projects:r.projects.map(i=>i.id===t?{...i,...n}:i)})),deleteProject:t=>s(n=>({projects:n.projects.filter(r=>r.id!==t),constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setSchedules:t=>s({schedules:t}),addSchedule:t=>s(n=>({schedules:[t,...n.schedules]})),updateSchedule:(t,n)=>s(r=>({schedules:r.schedules.map(i=>i.id===t?{...i,...n}:i)})),deleteSchedule:t=>s(n=>({schedules:n.schedules.filter(r=>r.id!==t)})),setPayments:t=>s({payments:t}),addPayment:t=>s(n=>({payments:[t,...n.payments]})),updatePayment:(t,n)=>s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)})),deletePayment:t=>s(n=>({payments:n.payments.filter(r=>r.id!==t)})),setContractors:t=>s({contractors:t}),addContractor:t=>s(n=>({contractors:[t,...n.contractors]})),updateContractor:(t,n)=>s(r=>({contractors:r.contractors.map(i=>i.id===t?{...i,...n}:i)})),deleteContractor:t=>s(n=>({contractors:n.contractors.filter(r=>r.id!==t)})),setConstructionPayments:t=>s({constructionPayments:t}),addConstructionPayment:t=>s(n=>({constructionPayments:[t,...n.constructionPayments]})),updateConstructionPayment:(t,n)=>s(r=>({constructionPayments:r.constructionPayments.map(i=>i.id===t?{...i,...n}:i)})),deleteConstructionPayment:t=>s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)})),setASRequests:t=>s({asRequests:t}),addASRequest:t=>s(n=>({asRequests:[t,...n.asRequests]})),updateASRequest:(t,n)=>s(r=>({asRequests:r.asRequests.map(i=>i.id===t?{...i,...n}:i)})),deleteASRequest:t=>s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)})),setExecutionRecords:t=>s({executionRecords:t}),addExecutionRecord:t=>{console.log("[dataStore]  :",t.id,t.itemName),s(n=>{const r=[t,...n.executionRecords];return console.log("[dataStore]   :",r.length),{executionRecords:r}})},updateExecutionRecord:(t,n)=>s(r=>({executionRecords:r.executionRecords.map(i=>i.id===t?{...i,...n}:i)})),deleteExecutionRecord:t=>s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)})),loadPaymentsFromAPI:async()=>{try{const t=await ln.getAllPayments();console.log("[loadPaymentsFromAPI] Raw API response sample:",t[0]);const n=t.map(d=>{var f;return{id:String(d.id),project:typeof d.project=="object"&&((f=d.project)!=null&&f.name)?d.project.name:d.project_name||"",purpose:d.description,process:d.vendor_name,itemName:d.item_name||"",amount:d.amount,materialAmount:d.material_amount||0,laborAmount:d.labor_amount||0,originalMaterialAmount:d.original_material_amount||0,originalLaborAmount:d.original_labor_amount||0,applyTaxDeduction:d.apply_tax_deduction===1,includesVAT:d.includes_vat===1,quickText:d.quick_text||"",images:(()=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{const h=JSON.parse(d.images);return Array.isArray(h)?h:[]}catch(h){return console.error("  :",h),[]}})(),category:d.request_type,status:d.status,urgency:"normal",requestedBy:d.requester_name,requestDate:new Date(d.created_at),approvalDate:d.approved_at?new Date(d.approved_at):void 0,bankInfo:{accountHolder:d.account_holder||"",bankName:d.bank_name||"",accountNumber:d.account_number||""},attachments:[],notes:d.notes||"",completionDate:d.completionDate?new Date(d.completionDate):void 0}}),r=e().payments,i=new Map(r.map(d=>[d.id,d]));n.forEach(d=>{if(!d.completionDate&&d.status==="completed"){const f=i.get(d.id);f!=null&&f.completionDate?d.completionDate=f.completionDate:d.completionDate=new Date}});const o=new Set(n.map(d=>d.id)),l=3e4,u=Date.now();console.log("[loadPaymentsFromAPI] ===    ==="),console.log("[loadPaymentsFromAPI] API  :",n.length),console.log("[loadPaymentsFromAPI]   :",r.length),console.log("[loadPaymentsFromAPI]   ID :",r.map(d=>d.id));const m=r.filter(d=>{if(d.id.startsWith("temp_"))return console.log("[loadPaymentsFromAPI]     (temp ID):",d.id),!0;if(o.has(d.id))return!1;const f=d._addedAt;return f&&u-f<l?(console.log("[loadPaymentsFromAPI]    :",d.id,"",(u-f)/1e3,""),!0):(console.log("[loadPaymentsFromAPI]   (  _addedAt ):",d.id),!1)});if(console.log("[loadPaymentsFromAPI]   :",m.length),console.log("[loadPaymentsFromAPI]   ID:",m.map(d=>d.id)),m.length>0){console.log(`[loadPaymentsFromAPI]  ${m.length}  `);const d=new Set(m.map(T=>T.id)),f=n.filter(T=>!d.has(T.id)),y=[...m.map(T=>({...T,_addedAt:Date.now()})),...f];console.log("[loadPaymentsFromAPI]   :",y.length),s({payments:y})}else console.log("[loadPaymentsFromAPI]    - API  "),s({payments:n})}catch(t){throw console.error("Failed to load payments from API:",t),t}},addPaymentToAPI:async t=>{const n=`temp_${Date.now()}`,r={...t,id:n,_addedAt:Date.now(),_tempId:n};s(i=>({payments:[r,...i.payments]})),console.log("[addPaymentToAPI]   - temp ID:",n);try{const o=e().projects.find(f=>f.name===t.project),u={projectId:o?o.id:t.project,purpose:t.purpose,process:t.process,itemName:t.itemName,amount:t.amount,status:t.status||"pending",category:t.category,urgency:t.urgency,requestedBy:t.requestedBy,bankInfo:t.bankInfo,notes:t.notes,attachments:[],materialAmount:t.materialAmount||0,laborAmount:t.laborAmount||0,originalMaterialAmount:t.originalMaterialAmount||0,originalLaborAmount:t.originalLaborAmount||0,applyTaxDeduction:t.applyTaxDeduction||!1,includesVAT:t.includesVAT||!1,quickText:t.quickText||"",images:t.images||[]};console.log("[addPaymentToAPI] Sending payment data:",u);const m=await ln.createPayment(u),d=String(m.id);return s(f=>({payments:f.payments.map(h=>h._tempId===n?{...h,id:d,_addedAt:Date.now()}:h)})),console.log("[addPaymentToAPI]   -  ID:",d),d}catch(i){throw console.error("Failed to add payment to API:",i),s(o=>({payments:o.payments.filter(l=>l._tempId!==n)})),i}},updatePaymentInAPI:async(t,n)=>{try{if(n.status&&Object.keys(n).length===1)await ln.updatePaymentStatus(t,n.status);else{let r=n.project;if(n.project){const o=e().projects.find(l=>l.name===n.project);r=o?o.id:n.project}await ln.updatePayment(t,{projectId:r,purpose:n.purpose,process:n.process,itemName:n.itemName,amount:n.amount,materialAmount:n.materialAmount,laborAmount:n.laborAmount,originalMaterialAmount:n.originalMaterialAmount,originalLaborAmount:n.originalLaborAmount,category:n.category,urgency:n.urgency,bankInfo:n.bankInfo,notes:n.notes,requestDate:n.requestDate,includesVAT:n.includesVAT,applyTaxDeduction:n.applyTaxDeduction})}s(r=>({payments:r.payments.map(i=>i.id===t?{...i,...n}:i)}))}catch(r){throw console.error("Failed to update payment in API:",r),r}},deletePaymentFromAPI:async t=>{try{await ln.deletePayment(t),s(n=>({payments:n.payments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete payment from API:",n),n}},loadSchedulesFromAPI:async()=>{try{const t=await za.getAllSchedules();console.log(" LOAD SCHEDULES - Raw API response sample:",t[0]);const n=t.map(r=>{var o;console.log(" Processing schedule:",{id:r._id,title:r.title,assigneeNames:r.assigneeNames,assignedTo:r.assignedTo,assignedToType:typeof r.assignedTo,assignedToLength:Array.isArray(r.assignedTo)?r.assignedTo.length:"not array"});const i=Array.isArray(r.assigneeNames)?r.assigneeNames:r.assigneeNames?typeof r.assigneeNames=="string"?r.assigneeNames.split(",").map(l=>l.trim()):[r.assigneeNames]:((o=r.assignedTo)==null?void 0:o.map(l=>typeof l=="object"?l.name:l))||[];return console.log(" Final attendees:",i),{id:r._id,title:r.title,start:new Date(r.startDate),end:new Date(r.endDate),type:r.type,project:typeof r.project=="object"?r.project.name:r.project,location:r.location,attendees:i,description:r.description,time:r.time}});n.sort((r,i)=>{const o=parseInt(r.id)||0,l=parseInt(i.id)||0;return o-l}),s({schedules:n})}catch(t){throw console.error("Failed to load schedules from API:",t),t}},addScheduleToAPI:async t=>{var i,o;const n=(i=t.id)!=null&&i.startsWith("temp_")?t.id:`temp_${Date.now()}`,r={...t,id:n};s(l=>({schedules:[...l.schedules,r]}));try{const l=await za.createSchedule({project:t.project||"",title:t.title,type:t.type,startDate:t.start,endDate:t.end,allDay:!t.time||t.time==="-",location:t.location,assignedTo:t.attendees||[],description:t.description,asRequestId:t.asRequestId,time:t.time}),u=t.attendees||[];let m=l.assigneeNames||((o=l.assignedTo)==null?void 0:o.map(f=>typeof f=="object"?f.name:f))||[];u.length>0&&m.length>u.length&&(m=u);const d={id:l._id,title:l.title,start:new Date(l.startDate),end:new Date(l.endDate),type:l.type,project:typeof l.project=="object"?l.project.name:l.project,location:l.location,attendees:m,description:l.description,time:l.time};s(f=>({schedules:f.schedules.map(h=>h.id===n?d:h)}))}catch(l){throw console.error("Failed to add schedule to API:",l),s(u=>({schedules:u.schedules.filter(m=>m.id!==n)})),l}},updateScheduleInAPI:async(t,n)=>{var r,i,o;try{console.log(" updateScheduleInAPI called with:",{id:t,updatedSchedule:n});const l={};n.project!==void 0&&(l.project=n.project),n.title!==void 0&&(l.title=n.title),n.type!==void 0&&(l.type=n.type),n.start!==void 0&&(l.startDate=n.start),n.end!==void 0&&(l.endDate=n.end),n.location!==void 0&&(l.location=n.location),n.description!==void 0&&(l.description=n.description),n.attendees!==void 0&&(l.assignedTo=n.attendees),n.time!==void 0&&(l.time=n.time),console.log(" Sending update data:",l);const u=await za.updateSchedule(t,l);console.log(" updateScheduleInAPI response:",u);const m={id:u._id,title:u.title,start:new Date(u.startDate),end:new Date(u.endDate),type:u.type,project:typeof u.project=="object"?u.project.name:u.project,location:u.location,attendees:u.assigneeNames||((r=u.assignedTo)==null?void 0:r.map(d=>typeof d=="object"?d.name:d))||[],description:u.description,time:u.time};s(d=>({schedules:d.schedules.map(f=>f.id===t?m:f)}))}catch(l){throw console.error("Failed to update schedule in API:",l),console.error("Error details:",{message:l instanceof Error?l.message:"Unknown error",response:l&&typeof l=="object"&&"response"in l?(i=l.response)==null?void 0:i.data:void 0,status:l&&typeof l=="object"&&"response"in l?(o=l.response)==null?void 0:o.status:void 0}),l}},deleteScheduleFromAPI:async t=>{var i;const{schedules:n}=e(),r=n.find(o=>o.id===t);if(r){s(o=>({schedules:o.schedules.filter(l=>l.id!==t)}));try{t.startsWith("temp_")||await za.deleteSchedule(t)}catch(o){const l=o,u=(i=l==null?void 0:l.response)==null?void 0:i.status;if(u===404||u===502||u===503||u===504){console.log("Schedule delete - ignoring error (status:",u,"):",t);return}throw console.error("Failed to delete schedule from API:",o),r&&s(m=>({schedules:[...m.schedules,r]})),o}}},loadProjectsFromAPI:async()=>{try{const n=(await qi.getAllProjects()).map(r=>{var i,o;return{id:r._id||r.id,name:r.name,client:typeof r.client=="object"?r.client.name:r.client||"",location:typeof r.location=="object"?r.location.address:r.location||r.address||"",status:r.status==="inProgress"?"in-progress":r.status==="onHold"?"on-hold":r.status,progress:r.progress||0,startDate:r.startDate||r.start_date?new Date(r.startDate||r.start_date):void 0,endDate:r.endDate||r.end_date?new Date(r.endDate||r.end_date):void 0,contractAmount:r.budget||r.contractAmount||0,spent:r.actualCost||r.spent||0,manager:typeof r.manager=="object"&&r.manager!==null?r.manager.name||"":r.manager||"",team:[],description:r.description||"",meetingNotes:((i=r.meetingNotes)==null?void 0:i.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((o=r.customerRequests)==null?void 0:o.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:r.entrancePassword||"",sitePassword:r.sitePassword||""}});s({projects:n})}catch(t){throw console.error("Failed to load projects from API:",t),t}},addProjectToAPI:async t=>{var n,r;try{const i=await qi.createProject({name:t.name,client:t.client,location:t.location,startDate:t.startDate,endDate:t.endDate,status:t.status,contractAmount:t.contractAmount,spent:t.spent,manager:t.manager,team:t.team,progress:t.progress,description:t.description}),o={id:i._id||i.id,name:i.name,client:typeof i.client=="object"?i.client.name:i.client||"",location:typeof i.location=="object"?i.location.address:i.location||i.address||"",status:i.status==="inProgress"?"in-progress":i.status==="onHold"?"on-hold":i.status,progress:i.progress||0,startDate:i.startDate||i.start_date?new Date(i.startDate||i.start_date):void 0,endDate:i.endDate||i.end_date?new Date(i.endDate||i.end_date):void 0,contractAmount:i.budget||i.contractAmount||0,spent:i.actualCost||i.spent||0,manager:typeof i.manager=="object"&&i.manager!==null?i.manager.name||"":i.manager||"",team:[],description:i.description||"",meetingNotes:((n=i.meetingNotes)==null?void 0:n.map(l=>({id:l.id,content:l.content,date:new Date(l.date)})))||[],customerRequests:((r=i.customerRequests)==null?void 0:r.map(l=>({id:l.id,content:l.content,completed:l.completed,createdAt:new Date(l.createdAt)})))||[],entrancePassword:i.entrancePassword||"",sitePassword:i.sitePassword||""};s(l=>({projects:[o,...l.projects]}))}catch(i){throw console.error("Failed to add project to API:",i),i}},updateProjectInAPI:async(t,n)=>{var r,i;try{const o=await qi.updateProject(t,n),l={id:o._id||o.id,name:o.name,client:typeof o.client=="object"?o.client.name:o.client||"",location:typeof o.location=="object"?o.location.address:o.location||o.address||"",status:o.status==="inProgress"?"in-progress":o.status==="onHold"?"on-hold":o.status,progress:o.progress||0,startDate:o.startDate||o.start_date?new Date(o.startDate||o.start_date):void 0,endDate:o.endDate||o.end_date?new Date(o.endDate||o.end_date):void 0,contractAmount:o.budget||o.contractAmount||0,spent:o.actualCost||o.spent||0,manager:typeof o.manager=="object"&&o.manager!==null?o.manager.name||"":o.manager||"",team:[],description:o.description||"",meetingNotes:((r=o.meetingNotes)==null?void 0:r.map(u=>({id:u.id,content:u.content,date:new Date(u.date)})))||[],customerRequests:((i=o.customerRequests)==null?void 0:i.map(u=>({id:u.id,content:u.content,completed:u.completed,createdAt:new Date(u.createdAt)})))||[],entrancePassword:o.entrancePassword||"",sitePassword:o.sitePassword||""};s(u=>({projects:u.projects.map(m=>m.id===t?l:m)}))}catch(o){throw console.error("Failed to update project in API:",o),o}},deleteProjectFromAPI:async t=>{try{await qi.deleteProject(t),s(n=>({projects:n.projects.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete project from API:",n),n}},loadContractorsFromAPI:async()=>{try{const n=(await Jn.getAllContractors()).map(r=>({id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));s({contractors:n})}catch(t){throw console.error("Failed to load contractors from API:",t),t}},addContractorToAPI:async t=>{try{const n=await Jn.createContractor({rank:t.rank,companyName:t.companyName,name:t.name,process:t.process,contact:t.contact,accountNumber:t.accountNumber,notes:t.notes}),r={id:n._id,rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)};s(i=>({contractors:[r,...i.contractors]}))}catch(n){throw console.error("Failed to add contractor to API:",n),n}},updateContractorInAPI:async(t,n)=>{try{const r=await Jn.updateContractor(t,{rank:n.rank,companyName:n.companyName,name:n.name,process:n.process,contact:n.contact,accountNumber:n.accountNumber,notes:n.notes}),i={id:r._id,rank:r.rank,companyName:r.companyName,name:r.name,process:r.process,contact:r.contact,accountNumber:r.accountNumber,notes:r.notes,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)};s(o=>({contractors:o.contractors.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update contractor in API:",r),r}},deleteContractorFromAPI:async t=>{try{await Jn.deleteContractor(t),s(n=>({contractors:n.contractors.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete contractor from API:",n),n}},loadConstructionPaymentsFromAPI:async()=>{try{const n=(await Ka.getAllConstructionPayments()).map(r=>{var o;let i;return r.expectedPaymentDates&&(i={contract:r.expectedPaymentDates.contract?new Date(r.expectedPaymentDates.contract):void 0,start:r.expectedPaymentDates.start?new Date(r.expectedPaymentDates.start):void 0,middle:r.expectedPaymentDates.middle?new Date(r.expectedPaymentDates.middle):void 0,final:r.expectedPaymentDates.final?new Date(r.expectedPaymentDates.final):void 0}),{id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,expectedPaymentDates:i,payments:((o=r.payments)==null?void 0:o.map(l=>{var d;const u=l.date?new Date(l.date):new Date,m=isNaN(u.getTime())?new Date:u;return{type:l.type||((d=l.types)==null?void 0:d[0])||"",amount:l.amount,date:m,method:l.method,notes:l.notes}}))||[]}});s({constructionPayments:n})}catch(t){throw console.error("Failed to load construction payments from API:",t),t}},addConstructionPaymentToAPI:async t=>{var n;try{const r=await Ka.createConstructionPayment(t),i={id:r._id,project:r.project,client:r.client,totalAmount:r.totalAmount,vatType:r.vatType,vatPercentage:r.vatPercentage,vatAmount:r.vatAmount,payments:((n=r.payments)==null?void 0:n.map(o=>{var m;const l=o.date?new Date(o.date):new Date,u=isNaN(l.getTime())?new Date:l;return{type:o.type||((m=o.types)==null?void 0:m[0])||"",amount:o.amount,date:u,method:o.method,notes:o.notes}}))||[]};s(o=>({constructionPayments:[i,...o.constructionPayments]}))}catch(r){throw console.error("Failed to add construction payment to API:",r),r}},updateConstructionPaymentInAPI:async(t,n)=>{var r;try{const i=await Ka.updateConstructionPayment(t,n);let o;i.expectedPaymentDates&&(o={contract:i.expectedPaymentDates.contract?new Date(i.expectedPaymentDates.contract):void 0,start:i.expectedPaymentDates.start?new Date(i.expectedPaymentDates.start):void 0,middle:i.expectedPaymentDates.middle?new Date(i.expectedPaymentDates.middle):void 0,final:i.expectedPaymentDates.final?new Date(i.expectedPaymentDates.final):void 0});const l={id:i._id,project:i.project,client:i.client,totalAmount:i.totalAmount,vatType:i.vatType,vatPercentage:i.vatPercentage,vatAmount:i.vatAmount,expectedPaymentDates:o,payments:((r=i.payments)==null?void 0:r.map(u=>{var m;return{type:u.type||((m=u.types)==null?void 0:m[0])||"",amount:u.amount,date:new Date(u.date),method:u.method,notes:u.notes}}))||[]};s(u=>({constructionPayments:u.constructionPayments.map(m=>m.id===t?l:m)}))}catch(i){throw console.error("Failed to update construction payment in API:",i),i}},deleteConstructionPaymentFromAPI:async t=>{try{await Ka.deleteConstructionPayment(t),s(n=>({constructionPayments:n.constructionPayments.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete construction payment from API:",n),n}},loadASRequestsFromAPI:async()=>{try{const n=(await Oo.getAllASRequests()).map(r=>({id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:r.assignedTo?Array.isArray(r.assignedTo)?r.assignedTo:[r.assignedTo]:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"}));s({asRequests:n})}catch(t){throw console.error("Failed to load AS requests from API:",t),t}},addASRequestToAPI:async t=>{try{const n=await Oo.createASRequest(t),r={id:n._id,project:n.project,client:n.client,requestDate:new Date(n.requestDate),siteAddress:n.siteAddress,entrancePassword:n.entrancePassword,description:n.description,scheduledVisitDate:n.scheduledVisitDate?new Date(n.scheduledVisitDate):void 0,scheduledVisitTime:n.scheduledVisitTime,assignedTo:Array.isArray(n.assignedTo)?n.assignedTo:[],completionDate:n.completionDate?new Date(n.completionDate):void 0,notes:n.notes};return s(i=>({asRequests:[r,...i.asRequests]})),r}catch(n){throw console.error("Failed to add AS request to API:",n),n}},updateASRequestInAPI:async(t,n)=>{try{const r=await Oo.updateASRequest(t,n),i={id:r._id,project:r.project,client:r.client,requestDate:new Date(r.requestDate),siteAddress:r.siteAddress,entrancePassword:r.entrancePassword,description:r.description,scheduledVisitDate:r.scheduledVisitDate?new Date(r.scheduledVisitDate):void 0,scheduledVisitTime:r.scheduledVisitTime,assignedTo:Array.isArray(r.assignedTo)?r.assignedTo:[],completionDate:r.completionDate?new Date(r.completionDate):void 0,notes:r.notes,status:r.status||"pending"};s(o=>({asRequests:o.asRequests.map(l=>l.id===t?i:l)}))}catch(r){throw console.error("Failed to update AS request in API:",r),r}},deleteASRequestFromAPI:async t=>{try{await Oo.deleteASRequest(t),s(n=>({asRequests:n.asRequests.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete AS request from API:",n),n}},loadExecutionRecordsFromAPI:async()=>{try{const t=await Qa.getAllRecords();console.log("[loadExecutionRecordsFromAPI] Loaded",t.length,"records");const n=t.map(r=>({id:String(r.id),project:r.project_name,author:r.author||void 0,date:new Date(r.date),process:r.process||void 0,itemName:r.item_name,materialCost:r.material_cost||0,laborCost:r.labor_cost||0,vatAmount:r.vat_amount||0,totalAmount:r.total_amount||0,notes:r.notes||void 0,images:r.images||[],paymentId:r.payment_id?String(r.payment_id):void 0,includesTaxDeduction:r.includes_tax_deduction===1,includesVat:r.includes_vat===1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}));s({executionRecords:n})}catch(t){throw console.error("Failed to load execution records from API:",t),t}},addExecutionRecordToAPI:async t=>{try{console.log("[addExecutionRecordToAPI] Adding:",t.itemName,"includesTaxDeduction:",t.includesTaxDeduction,"includesVat:",t.includesVat);const n=await Qa.createRecord({project_name:t.project,author:t.author,date:t.date.toISOString().split("T")[0],process:t.process,item_name:t.itemName,material_cost:t.materialCost,labor_cost:t.laborCost,vat_amount:t.vatAmount,total_amount:t.totalAmount,notes:t.notes,payment_id:t.paymentId,includes_tax_deduction:t.includesTaxDeduction,includes_vat:t.includesVat}),r={id:String(n.id),project:n.project_name,author:n.author||void 0,date:new Date(n.date),process:n.process||void 0,itemName:n.item_name,materialCost:n.material_cost||0,laborCost:n.labor_cost||0,vatAmount:n.vat_amount||0,totalAmount:n.total_amount||0,notes:n.notes||void 0,paymentId:n.payment_id?String(n.payment_id):void 0,includesTaxDeduction:n.includes_tax_deduction===1,includesVat:n.includes_vat===1,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)};return console.log("[addExecutionRecordToAPI] newRecord includesVat:",r.includesVat,"from API:",n.includes_vat),s(i=>({executionRecords:[r,...i.executionRecords]})),console.log("[addExecutionRecordToAPI] Added with ID:",r.id),r}catch(n){throw console.error("Failed to add execution record to API:",n),n}},updateExecutionRecordInAPI:async(t,n)=>{console.log("[updateExecutionRecordInAPI] Called with id:",t,"record:",n);try{let r;if(n.date){const i=n.date instanceof Date?n.date:new Date(n.date);console.log("[updateExecutionRecordInAPI] Date conversion:",{original:n.date,converted:i,isValid:!isNaN(i.getTime())}),isNaN(i.getTime())||(r=i.toISOString().split("T")[0])}console.log("[updateExecutionRecordInAPI] Calling API with dateStr:",r,"includesTaxDeduction:",n.includesTaxDeduction,"includesVat:",n.includesVat),await Qa.updateRecord(t,{project_name:n.project,author:n.author,date:r,process:n.process,item_name:n.itemName,material_cost:n.materialCost,labor_cost:n.laborCost,vat_amount:n.vatAmount,total_amount:n.totalAmount,notes:n.notes,payment_id:n.paymentId,images:n.images,includes_tax_deduction:n.includesTaxDeduction,includes_vat:n.includesVat}),s(i=>({executionRecords:i.executionRecords.map(o=>o.id===t?{...o,...n,updatedAt:new Date}:o)}))}catch(r){throw console.error("Failed to update execution record in API:",r),r}},deleteExecutionRecordFromAPI:async t=>{try{await Qa.deleteRecord(t),s(n=>({executionRecords:n.executionRecords.filter(r=>r.id!==t)}))}catch(n){throw console.error("Failed to delete execution record from API:",n),n}}}),{name:"interior-management-storage",partialize:s=>({...s,payments:s.payments.map(e=>{const{images:t,...n}=e;return n}),executionRecords:s.executionRecords.map(e=>{const{images:t,...n}=e;return n})}),storage:{getItem:s=>{var u,m,d,f,h,y,T;const e=localStorage.getItem(s);if(!e)return null;const{state:t}=JSON.parse(e),n=((u=t.projects)==null?void 0:u.map(v=>({...v,startDate:v.startDate?new Date(v.startDate):void 0,endDate:v.endDate?new Date(v.endDate):void 0,contractAmount:v.contractAmount!==void 0?v.contractAmount:v.budget||0})))||[],r=((m=t.constructionPayments)==null?void 0:m.map(v=>{var V;return{...v,vatType:v.vatType||"percentage",vatPercentage:v.vatPercentage??100,vatAmount:v.vatAmount??0,payments:((V=v.payments)==null?void 0:V.map(R=>({...R,date:new Date(R.date)})))||[]}}))||[],i=new Set(r.map(v=>v.id)),o=n.filter(v=>!i.has(v.id)).map(v=>({id:v.id,project:v.name,client:v.client,totalAmount:v.contractAmount||0,vatType:"percentage",vatPercentage:100,vatAmount:0,payments:[]})),l=[...r,...o];return{state:{...t,projects:n,schedules:((d=t.schedules)==null?void 0:d.map(v=>({...v,start:new Date(v.start),end:new Date(v.end)})))||[],payments:((f=t.payments)==null?void 0:f.map(v=>({...v,requestDate:new Date(v.requestDate),approvalDate:v.approvalDate?new Date(v.approvalDate):void 0})))||[],contractors:((h=t.contractors)==null?void 0:h.map(v=>({...v,createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[],constructionPayments:l,asRequests:((y=t.asRequests)==null?void 0:y.map(v=>({...v,requestDate:new Date(v.requestDate),scheduledVisitDate:v.scheduledVisitDate?new Date(v.scheduledVisitDate):void 0,completionDate:v.completionDate?new Date(v.completionDate):void 0})))||[],executionRecords:((T=t.executionRecords)==null?void 0:T.map(v=>({...v,date:new Date(v.date),createdAt:new Date(v.createdAt),updatedAt:new Date(v.updatedAt)})))||[]}}},setItem:(s,e)=>{try{const t=JSON.stringify(e);localStorage.setItem(s,t)}catch(t){console.error("[dataStore] localStorage  :",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("[dataStore] localStorage   -    ")}},removeItem:s=>localStorage.removeItem(s)}}));var Aa=s=>s.type==="checkbox",ti=s=>s instanceof Date,Xs=s=>s==null;const Qy=s=>typeof s=="object";var As=s=>!Xs(s)&&!Array.isArray(s)&&Qy(s)&&!ti(s),RC=s=>As(s)&&s.target?Aa(s.target)?s.target.checked:s.target.value:s,BC=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,UC=(s,e)=>s.has(BC(e)),HC=s=>{const e=s.constructor&&s.constructor.prototype;return As(e)&&e.hasOwnProperty("isPrototypeOf")},Jm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ps(s){let e;const t=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)e=new Date(s);else if(!(Jm&&(s instanceof Blob||n))&&(t||As(s)))if(e=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!HC(s))e=s;else for(const r in s)s.hasOwnProperty(r)&&(e[r]=Ps(s[r]));else return s;return e}var mc=s=>/^\w*$/.test(s),Ns=s=>s===void 0,Zm=s=>Array.isArray(s)?s.filter(Boolean):[],ed=s=>Zm(s.replace(/["|']|\]/g,"").split(/\.|\[/)),je=(s,e,t)=>{if(!e||!As(s))return t;const n=(mc(e)?[e]:ed(e)).reduce((r,i)=>Xs(r)?r:r[i],s);return Ns(n)||n===s?Ns(s[e])?t:s[e]:n},Rn=s=>typeof s=="boolean",ss=(s,e,t)=>{let n=-1;const r=mc(e)?[e]:ed(e),i=r.length,o=i-1;for(;++n<i;){const l=r[n];let u=t;if(n!==o){const m=s[l];u=As(m)||Array.isArray(m)?m:isNaN(+r[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;s[l]=u,s=s[l]}};const fp={BLUR:"blur",FOCUS_OUT:"focusout"},An={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Yn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},MC=ct.createContext(null);MC.displayName="HookFormContext";var OC=(s,e,t,n=!0)=>{const r={defaultValues:e._defaultValues};for(const i in s)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==An.all&&(e._proxyFormState[o]=!n||An.all),s[o]}});return r};const FC=typeof window<"u"?ct.useLayoutEffect:ct.useEffect;var cn=s=>typeof s=="string",qC=(s,e,t,n,r)=>cn(s)?(n&&e.watch.add(s),je(t,s,r)):Array.isArray(s)?s.map(i=>(n&&e.watch.add(i),je(t,i))):(n&&(e.watchAll=!0),t),Uu=s=>Xs(s)||!Qy(s);function _r(s,e,t=new WeakSet){if(Uu(s)||Uu(e))return s===e;if(ti(s)&&ti(e))return s.getTime()===e.getTime();const n=Object.keys(s),r=Object.keys(e);if(n.length!==r.length)return!1;if(t.has(s)||t.has(e))return!0;t.add(s),t.add(e);for(const i of n){const o=s[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(ti(o)&&ti(l)||As(o)&&As(l)||Array.isArray(o)&&Array.isArray(l)?!_r(o,l,t):o!==l)return!1}}return!0}var $C=(s,e,t,n,r)=>e?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[n]:r||!0}}:{},Yo=s=>Array.isArray(s)?s:[s],pp=()=>{let s=[];return{get observers(){return s},next:r=>{for(const i of s)i.next&&i.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(i=>i!==r)}}),unsubscribe:()=>{s=[]}}};function Yy(s,e){const t={};for(const n in s)if(s.hasOwnProperty(n)){const r=s[n],i=e[n];if(r&&As(r)&&i){const o=Yy(r,i);As(o)&&(t[n]=o)}else s[n]&&(t[n]=i)}return t}var sn=s=>As(s)&&!Object.keys(s).length,td=s=>s.type==="file",En=s=>typeof s=="function",Rl=s=>{if(!Jm)return!1;const e=s?s.ownerDocument:0;return s instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Gy=s=>s.type==="select-multiple",sd=s=>s.type==="radio",WC=s=>sd(s)||Aa(s),Gc=s=>Rl(s)&&s.isConnected;function zC(s,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)s=Ns(s)?n++:s[e[n++]];return s}function KC(s){for(const e in s)if(s.hasOwnProperty(e)&&!Ns(s[e]))return!1;return!0}function ys(s,e){const t=Array.isArray(e)?e:mc(e)?[e]:ed(e),n=t.length===1?s:zC(s,t),r=t.length-1,i=t[r];return n&&delete n[i],r!==0&&(As(n)&&sn(n)||Array.isArray(n)&&KC(n))&&ys(s,t.slice(0,-1)),s}var QC=s=>{for(const e in s)if(En(s[e]))return!0;return!1};function Xy(s){return Array.isArray(s)||As(s)&&!QC(s)}function Hu(s,e={}){for(const t in s)Xy(s[t])?(e[t]=Array.isArray(s[t])?[]:{},Hu(s[t],e[t])):Xs(s[t])||(e[t]=!0);return e}function Fi(s,e,t){t||(t=Hu(e));for(const n in s)Xy(s[n])?Ns(e)||Uu(t[n])?t[n]=Hu(s[n],Array.isArray(s[n])?[]:{}):Fi(s[n],Xs(e)?{}:e[n],t[n]):t[n]=!_r(s[n],e[n]);return t}const hp={value:!1,isValid:!1},gp={value:!0,isValid:!0};var Jy=s=>{if(Array.isArray(s)){if(s.length>1){const e=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Ns(s[0].attributes.value)?Ns(s[0].value)||s[0].value===""?gp:{value:s[0].value,isValid:!0}:gp:hp}return hp},Zy=(s,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>Ns(s)?s:e?s===""?NaN:s&&+s:t&&cn(s)?new Date(s):n?n(s):s;const yp={isValid:!1,value:null};var eb=s=>Array.isArray(s)?s.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,yp):yp;function bp(s){const e=s.ref;return td(e)?e.files:sd(e)?eb(s.refs).value:Gy(e)?[...e.selectedOptions].map(({value:t})=>t):Aa(e)?Jy(s.refs).value:Zy(Ns(e.value)?s.ref.value:e.value,s)}var YC=(s,e,t,n)=>{const r={};for(const i of s){const o=je(e,i);o&&ss(r,i,o._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:n}},Bl=s=>s instanceof RegExp,To=s=>Ns(s)?s:Bl(s)?s.source:As(s)?Bl(s.value)?s.value.source:s.value:s,Np=s=>({isOnSubmit:!s||s===An.onSubmit,isOnBlur:s===An.onBlur,isOnChange:s===An.onChange,isOnAll:s===An.all,isOnTouch:s===An.onTouched});const xp="AsyncFunction";var GC=s=>!!s&&!!s.validate&&!!(En(s.validate)&&s.validate.constructor.name===xp||As(s.validate)&&Object.values(s.validate).find(e=>e.constructor.name===xp)),XC=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),vp=(s,e,t)=>!t&&(e.watchAll||e.watch.has(s)||[...e.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const Go=(s,e,t,n)=>{for(const r of t||Object.keys(s)){const i=je(s,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!n)return!0;if(o.ref&&e(o.ref,o.name)&&!n)return!0;if(Go(l,e))break}else if(As(l)&&Go(l,e))break}}};function _p(s,e,t){const n=je(s,t);if(n||mc(t))return{error:n,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=je(e,i),l=je(s,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var JC=(s,e,t,n)=>{t(s);const{name:r,...i}=s;return sn(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!n||An.all))},ZC=(s,e,t)=>!s||!e||s===e||Yo(s).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),e1=(s,e,t,n,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||s):(t?n.isOnBlur:r.isOnBlur)?!s:(t?n.isOnChange:r.isOnChange)?s:!0,t1=(s,e)=>!Zm(je(s,e)).length&&ys(s,e),s1=(s,e,t)=>{const n=Yo(je(s,t));return ss(n,"root",e[t]),ss(s,t,n),s};function Dp(s,e,t="validate"){if(cn(s)||Array.isArray(s)&&s.every(cn)||Rn(s)&&!s)return{type:t,message:cn(s)?s:"",ref:e}}var Ii=s=>As(s)&&!Bl(s)?s:{value:s,message:""},kp=async(s,e,t,n,r,i)=>{const{ref:o,refs:l,required:u,maxLength:m,minLength:d,min:f,max:h,pattern:y,validate:T,name:v,valueAsNumber:V,mount:R}=s._f,L=je(t,v);if(!R||e.has(v))return{};const q=l?l[0]:o,oe=w=>{r&&q.reportValidity&&(q.setCustomValidity(Rn(w)?"":w||""),q.reportValidity())},te={},O=sd(o),C=Aa(o),N=O||C,E=(V||td(o))&&Ns(o.value)&&Ns(L)||Rl(o)&&o.value===""||L===""||Array.isArray(L)&&!L.length,j=$C.bind(null,v,n,te),S=(w,k,De,Me=Yn.maxLength,he=Yn.minLength)=>{const Re=w?k:De;te[v]={type:w?Me:he,message:Re,ref:o,...j(w?Me:he,Re)}};if(i?!Array.isArray(L)||!L.length:u&&(!N&&(E||Xs(L))||Rn(L)&&!L||C&&!Jy(l).isValid||O&&!eb(l).isValid)){const{value:w,message:k}=cn(u)?{value:!!u,message:u}:Ii(u);if(w&&(te[v]={type:Yn.required,message:k,ref:q,...j(Yn.required,k)},!n))return oe(k),te}if(!E&&(!Xs(f)||!Xs(h))){let w,k;const De=Ii(h),Me=Ii(f);if(!Xs(L)&&!isNaN(L)){const he=o.valueAsNumber||L&&+L;Xs(De.value)||(w=he>De.value),Xs(Me.value)||(k=he<Me.value)}else{const he=o.valueAsDate||new Date(L),Re=Ot=>new Date(new Date().toDateString()+" "+Ot),ft=o.type=="time",qt=o.type=="week";cn(De.value)&&L&&(w=ft?Re(L)>Re(De.value):qt?L>De.value:he>new Date(De.value)),cn(Me.value)&&L&&(k=ft?Re(L)<Re(Me.value):qt?L<Me.value:he<new Date(Me.value))}if((w||k)&&(S(!!w,De.message,Me.message,Yn.max,Yn.min),!n))return oe(te[v].message),te}if((m||d)&&!E&&(cn(L)||i&&Array.isArray(L))){const w=Ii(m),k=Ii(d),De=!Xs(w.value)&&L.length>+w.value,Me=!Xs(k.value)&&L.length<+k.value;if((De||Me)&&(S(De,w.message,k.message),!n))return oe(te[v].message),te}if(y&&!E&&cn(L)){const{value:w,message:k}=Ii(y);if(Bl(w)&&!L.match(w)&&(te[v]={type:Yn.pattern,message:k,ref:o,...j(Yn.pattern,k)},!n))return oe(k),te}if(T){if(En(T)){const w=await T(L,t),k=Dp(w,q);if(k&&(te[v]={...k,...j(Yn.validate,k.message)},!n))return oe(k.message),te}else if(As(T)){let w={};for(const k in T){if(!sn(w)&&!n)break;const De=Dp(await T[k](L,t),q,k);De&&(w={...De,...j(k,De.message)},oe(De.message),n&&(te[v]=w))}if(!sn(w)&&(te[v]={ref:q,...w},!n))return te}}return oe(!0),te};const n1={mode:An.onSubmit,reValidateMode:An.onChange,shouldFocusError:!0};function r1(s={}){let e={...n1,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:En(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},r=As(e.defaultValues)||As(e.values)?Ps(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Ps(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const h={array:pp(),state:pp()},y=e.criteriaMode===An.all,T=P=>F=>{clearTimeout(m),m=setTimeout(P,F)},v=async P=>{if(!e.disabled&&(d.isValid||f.isValid||P)){const F=e.resolver?sn((await C()).errors):await E(n,!0);F!==t.isValid&&h.state.next({isValid:F})}},V=(P,F)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((P||Array.from(l.mount)).forEach(Z=>{Z&&(F?ss(t.validatingFields,Z,F):ys(t.validatingFields,Z))}),h.state.next({validatingFields:t.validatingFields,isValidating:!sn(t.validatingFields)}))},R=(P,F=[],Z,be,ue=!0,fe=!0)=>{if(be&&Z&&!e.disabled){if(o.action=!0,fe&&Array.isArray(je(n,P))){const Ve=Z(je(n,P),be.argA,be.argB);ue&&ss(n,P,Ve)}if(fe&&Array.isArray(je(t.errors,P))){const Ve=Z(je(t.errors,P),be.argA,be.argB);ue&&ss(t.errors,P,Ve),t1(t.errors,P)}if((d.touchedFields||f.touchedFields)&&fe&&Array.isArray(je(t.touchedFields,P))){const Ve=Z(je(t.touchedFields,P),be.argA,be.argB);ue&&ss(t.touchedFields,P,Ve)}(d.dirtyFields||f.dirtyFields)&&(t.dirtyFields=Fi(r,i)),h.state.next({name:P,isDirty:S(P,F),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ss(i,P,F)},L=(P,F)=>{ss(t.errors,P,F),h.state.next({errors:t.errors})},q=P=>{t.errors=P,h.state.next({errors:t.errors,isValid:!1})},oe=(P,F,Z,be)=>{const ue=je(n,P);if(ue){const fe=je(i,P,Ns(Z)?je(r,P):Z);Ns(fe)||be&&be.defaultChecked||F?ss(i,P,F?fe:bp(ue._f)):De(P,fe),o.mount&&v()}},te=(P,F,Z,be,ue)=>{let fe=!1,Ve=!1;const Fe={name:P};if(!e.disabled){if(!Z||be){(d.isDirty||f.isDirty)&&(Ve=t.isDirty,t.isDirty=Fe.isDirty=S(),fe=Ve!==Fe.isDirty);const Ze=_r(je(r,P),F);Ve=!!je(t.dirtyFields,P),Ze?ys(t.dirtyFields,P):ss(t.dirtyFields,P,!0),Fe.dirtyFields=t.dirtyFields,fe=fe||(d.dirtyFields||f.dirtyFields)&&Ve!==!Ze}if(Z){const Ze=je(t.touchedFields,P);Ze||(ss(t.touchedFields,P,Z),Fe.touchedFields=t.touchedFields,fe=fe||(d.touchedFields||f.touchedFields)&&Ze!==Z)}fe&&ue&&h.state.next(Fe)}return fe?Fe:{}},O=(P,F,Z,be)=>{const ue=je(t.errors,P),fe=(d.isValid||f.isValid)&&Rn(F)&&t.isValid!==F;if(e.delayError&&Z?(u=T(()=>L(P,Z)),u(e.delayError)):(clearTimeout(m),u=null,Z?ss(t.errors,P,Z):ys(t.errors,P)),(Z?!_r(ue,Z):ue)||!sn(be)||fe){const Ve={...be,...fe&&Rn(F)?{isValid:F}:{},errors:t.errors,name:P};t={...t,...Ve},h.state.next(Ve)}},C=async P=>{V(P,!0);const F=await e.resolver(i,e.context,YC(P||l.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return V(P),F},N=async P=>{const{errors:F}=await C(P);if(P)for(const Z of P){const be=je(F,Z);be?ss(t.errors,Z,be):ys(t.errors,Z)}else t.errors=F;return F},E=async(P,F,Z={valid:!0})=>{for(const be in P){const ue=P[be];if(ue){const{_f:fe,...Ve}=ue;if(fe){const Fe=l.array.has(fe.name),Ze=ue._f&&GC(ue._f);Ze&&d.validatingFields&&V([fe.name],!0);const ke=await kp(ue,l.disabled,i,y,e.shouldUseNativeValidation&&!F,Fe);if(Ze&&d.validatingFields&&V([fe.name]),ke[fe.name]&&(Z.valid=!1,F))break;!F&&(je(ke,fe.name)?Fe?s1(t.errors,ke,fe.name):ss(t.errors,fe.name,ke[fe.name]):ys(t.errors,fe.name))}!sn(Ve)&&await E(Ve,F,Z)}}return Z.valid},j=()=>{for(const P of l.unMount){const F=je(n,P);F&&(F._f.refs?F._f.refs.every(Z=>!Gc(Z)):!Gc(F._f.ref))&&ot(P)}l.unMount=new Set},S=(P,F)=>!e.disabled&&(P&&F&&ss(i,P,F),!_r(Ot(),r)),w=(P,F,Z)=>qC(P,l,{...o.mount?i:Ns(F)?r:cn(P)?{[P]:F}:F},Z,F),k=P=>Zm(je(o.mount?i:r,P,e.shouldUnregister?je(r,P,[]):[])),De=(P,F,Z={})=>{const be=je(n,P);let ue=F;if(be){const fe=be._f;fe&&(!fe.disabled&&ss(i,P,Zy(F,fe)),ue=Rl(fe.ref)&&Xs(F)?"":F,Gy(fe.ref)?[...fe.ref.options].forEach(Ve=>Ve.selected=ue.includes(Ve.value)):fe.refs?Aa(fe.ref)?fe.refs.forEach(Ve=>{(!Ve.defaultChecked||!Ve.disabled)&&(Array.isArray(ue)?Ve.checked=!!ue.find(Fe=>Fe===Ve.value):Ve.checked=ue===Ve.value||!!ue)}):fe.refs.forEach(Ve=>Ve.checked=Ve.value===ue):td(fe.ref)?fe.ref.value="":(fe.ref.value=ue,fe.ref.type||h.state.next({name:P,values:Ps(i)})))}(Z.shouldDirty||Z.shouldTouch)&&te(P,ue,Z.shouldTouch,Z.shouldDirty,!0),Z.shouldValidate&&qt(P)},Me=(P,F,Z)=>{for(const be in F){if(!F.hasOwnProperty(be))return;const ue=F[be],fe=P+"."+be,Ve=je(n,fe);(l.array.has(P)||As(ue)||Ve&&!Ve._f)&&!ti(ue)?Me(fe,ue,Z):De(fe,ue,Z)}},he=(P,F,Z={})=>{const be=je(n,P),ue=l.array.has(P),fe=Ps(F);ss(i,P,fe),ue?(h.array.next({name:P,values:Ps(i)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&Z.shouldDirty&&h.state.next({name:P,dirtyFields:Fi(r,i),isDirty:S(P,fe)})):be&&!be._f&&!Xs(fe)?Me(P,fe,Z):De(P,fe,Z),vp(P,l)&&h.state.next({...t,name:P}),h.state.next({name:o.mount?P:void 0,values:Ps(i)})},Re=async P=>{o.mount=!0;const F=P.target;let Z=F.name,be=!0;const ue=je(n,Z),fe=Ze=>{be=Number.isNaN(Ze)||ti(Ze)&&isNaN(Ze.getTime())||_r(Ze,je(i,Z,Ze))},Ve=Np(e.mode),Fe=Np(e.reValidateMode);if(ue){let Ze,ke;const Rs=F.type?bp(ue._f):RC(P),Rt=P.type===fp.BLUR||P.type===fp.FOCUS_OUT,ee=!XC(ue._f)&&!e.resolver&&!je(t.errors,Z)&&!ue._f.deps||e1(Rt,je(t.touchedFields,Z),t.isSubmitted,Fe,Ve),Ye=vp(Z,l,Rt);ss(i,Z,Rs),Rt?(!F||!F.readOnly)&&(ue._f.onBlur&&ue._f.onBlur(P),u&&u(0)):ue._f.onChange&&ue._f.onChange(P);const M=te(Z,Rs,Rt),Ne=!sn(M)||Ye;if(!Rt&&h.state.next({name:Z,type:P.type,values:Ps(i)}),ee)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?Rt&&v():Rt||v()),Ne&&h.state.next({name:Z,...Ye?{}:M});if(!Rt&&Ye&&h.state.next({...t}),e.resolver){const{errors:_e}=await C([Z]);if(fe(Rs),be){const Pe=_p(t.errors,n,Z),me=_p(_e,n,Pe.name||Z);Ze=me.error,Z=me.name,ke=sn(_e)}}else V([Z],!0),Ze=(await kp(ue,l.disabled,i,y,e.shouldUseNativeValidation))[Z],V([Z]),fe(Rs),be&&(Ze?ke=!1:(d.isValid||f.isValid)&&(ke=await E(n,!0)));be&&(ue._f.deps&&(!Array.isArray(ue._f.deps)||ue._f.deps.length>0)&&qt(ue._f.deps),O(Z,ke,Ze,M))}},ft=(P,F)=>{if(je(t.errors,F)&&P.focus)return P.focus(),1},qt=async(P,F={})=>{let Z,be;const ue=Yo(P);if(e.resolver){const fe=await N(Ns(P)?P:ue);Z=sn(fe),be=P?!ue.some(Ve=>je(fe,Ve)):Z}else P?(be=(await Promise.all(ue.map(async fe=>{const Ve=je(n,fe);return await E(Ve&&Ve._f?{[fe]:Ve}:Ve)}))).every(Boolean),!(!be&&!t.isValid)&&v()):be=Z=await E(n);return h.state.next({...!cn(P)||(d.isValid||f.isValid)&&Z!==t.isValid?{}:{name:P},...e.resolver||!P?{isValid:Z}:{},errors:t.errors}),F.shouldFocus&&!be&&Go(n,ft,P?ue:l.mount),be},Ot=(P,F)=>{let Z={...o.mount?i:r};return F&&(Z=Yy(F.dirtyFields?t.dirtyFields:t.touchedFields,Z)),Ns(P)?Z:cn(P)?je(Z,P):P.map(be=>je(Z,be))},ae=(P,F)=>({invalid:!!je((F||t).errors,P),isDirty:!!je((F||t).dirtyFields,P),error:je((F||t).errors,P),isValidating:!!je(t.validatingFields,P),isTouched:!!je((F||t).touchedFields,P)}),Oe=P=>{P&&Yo(P).forEach(F=>ys(t.errors,F)),h.state.next({errors:P?t.errors:{}})},de=(P,F,Z)=>{const be=(je(n,P,{_f:{}})._f||{}).ref,ue=je(t.errors,P)||{},{ref:fe,message:Ve,type:Fe,...Ze}=ue;ss(t.errors,P,{...Ze,...F,ref:be}),h.state.next({name:P,errors:t.errors,isValid:!1}),Z&&Z.shouldFocus&&be&&be.focus&&be.focus()},Ie=(P,F)=>En(P)?h.state.subscribe({next:Z=>"values"in Z&&P(w(void 0,F),Z)}):w(P,F,!0),Ke=P=>h.state.subscribe({next:F=>{ZC(P.name,F.name,P.exact)&&JC(F,P.formState||d,St,P.reRenderRoot)&&P.callback({values:{...i},...t,...F,defaultValues:r})}}).unsubscribe,bt=P=>(o.mount=!0,f={...f,...P.formState},Ke({...P,formState:f})),ot=(P,F={})=>{for(const Z of P?Yo(P):l.mount)l.mount.delete(Z),l.array.delete(Z),F.keepValue||(ys(n,Z),ys(i,Z)),!F.keepError&&ys(t.errors,Z),!F.keepDirty&&ys(t.dirtyFields,Z),!F.keepTouched&&ys(t.touchedFields,Z),!F.keepIsValidating&&ys(t.validatingFields,Z),!e.shouldUnregister&&!F.keepDefaultValue&&ys(r,Z);h.state.next({values:Ps(i)}),h.state.next({...t,...F.keepDirty?{isDirty:S()}:{}}),!F.keepIsValid&&v()},wt=({disabled:P,name:F})=>{(Rn(P)&&o.mount||P||l.disabled.has(F))&&(P?l.disabled.add(F):l.disabled.delete(F))},rt=(P,F={})=>{let Z=je(n,P);const be=Rn(F.disabled)||Rn(e.disabled);return ss(n,P,{...Z||{},_f:{...Z&&Z._f?Z._f:{ref:{name:P}},name:P,mount:!0,...F}}),l.mount.add(P),Z?wt({disabled:Rn(F.disabled)?F.disabled:e.disabled,name:P}):oe(P,!0,F.value),{...be?{disabled:F.disabled||e.disabled}:{},...e.progressive?{required:!!F.required,min:To(F.min),max:To(F.max),minLength:To(F.minLength),maxLength:To(F.maxLength),pattern:To(F.pattern)}:{},name:P,onChange:Re,onBlur:Re,ref:ue=>{if(ue){rt(P,F),Z=je(n,P);const fe=Ns(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,Ve=WC(fe),Fe=Z._f.refs||[];if(Ve?Fe.find(Ze=>Ze===fe):fe===Z._f.ref)return;ss(n,P,{_f:{...Z._f,...Ve?{refs:[...Fe.filter(Gc),fe,...Array.isArray(je(r,P))?[{}]:[]],ref:{type:fe.type,name:P}}:{ref:fe}}}),oe(P,!1,void 0,fe)}else Z=je(n,P,{}),Z._f&&(Z._f.mount=!1),(e.shouldUnregister||F.shouldUnregister)&&!(UC(l.array,P)&&o.action)&&l.unMount.add(P)}}},mt=()=>e.shouldFocusError&&Go(n,ft,l.mount),ds=P=>{Rn(P)&&(h.state.next({disabled:P}),Go(n,(F,Z)=>{const be=je(n,Z);be&&(F.disabled=be._f.disabled||P,Array.isArray(be._f.refs)&&be._f.refs.forEach(ue=>{ue.disabled=be._f.disabled||P}))},0,!1))},z=(P,F)=>async Z=>{let be;Z&&(Z.preventDefault&&Z.preventDefault(),Z.persist&&Z.persist());let ue=Ps(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:fe,values:Ve}=await C();t.errors=fe,ue=Ps(Ve)}else await E(n);if(l.disabled.size)for(const fe of l.disabled)ys(ue,fe);if(ys(t.errors,"root"),sn(t.errors)){h.state.next({errors:{}});try{await P(ue,Z)}catch(fe){be=fe}}else F&&await F({...t.errors},Z),mt(),setTimeout(mt);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:sn(t.errors)&&!be,submitCount:t.submitCount+1,errors:t.errors}),be)throw be},Le=(P,F={})=>{je(n,P)&&(Ns(F.defaultValue)?he(P,Ps(je(r,P))):(he(P,F.defaultValue),ss(r,P,Ps(F.defaultValue))),F.keepTouched||ys(t.touchedFields,P),F.keepDirty||(ys(t.dirtyFields,P),t.isDirty=F.defaultValue?S(P,Ps(je(r,P))):S()),F.keepError||(ys(t.errors,P),d.isValid&&v()),h.state.next({...t}))},Be=(P,F={})=>{const Z=P?Ps(P):r,be=Ps(Z),ue=sn(P),fe=ue?r:be;if(F.keepDefaultValues||(r=Z),!F.keepValues){if(F.keepDirtyValues){const Ve=new Set([...l.mount,...Object.keys(Fi(r,i))]);for(const Fe of Array.from(Ve))je(t.dirtyFields,Fe)?ss(fe,Fe,je(i,Fe)):he(Fe,je(fe,Fe))}else{if(Jm&&Ns(P))for(const Ve of l.mount){const Fe=je(n,Ve);if(Fe&&Fe._f){const Ze=Array.isArray(Fe._f.refs)?Fe._f.refs[0]:Fe._f.ref;if(Rl(Ze)){const ke=Ze.closest("form");if(ke){ke.reset();break}}}}if(F.keepFieldsRef)for(const Ve of l.mount)he(Ve,je(fe,Ve));else n={}}i=e.shouldUnregister?F.keepDefaultValues?Ps(r):{}:Ps(fe),h.array.next({values:{...fe}}),h.state.next({values:{...fe}})}l={mount:F.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!F.keepIsValid||!!F.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:F.keepSubmitCount?t.submitCount:0,isDirty:ue?!1:F.keepDirty?t.isDirty:!!(F.keepDefaultValues&&!_r(P,r)),isSubmitted:F.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ue?{}:F.keepDirtyValues?F.keepDefaultValues&&i?Fi(r,i):t.dirtyFields:F.keepDefaultValues&&P?Fi(r,P):F.keepDirty?t.dirtyFields:{},touchedFields:F.keepTouched?t.touchedFields:{},errors:F.keepErrors?t.errors:{},isSubmitSuccessful:F.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Se=(P,F)=>Be(En(P)?P(i):P,F),Qe=(P,F={})=>{const Z=je(n,P),be=Z&&Z._f;if(be){const ue=be.refs?be.refs[0]:be.ref;ue.focus&&(ue.focus(),F.shouldSelect&&En(ue.select)&&ue.select())}},St=P=>{t={...t,...P}},ut={control:{register:rt,unregister:ot,getFieldState:ae,handleSubmit:z,setError:de,_subscribe:Ke,_runSchema:C,_focusError:mt,_getWatch:w,_getDirty:S,_setValid:v,_setFieldArray:R,_setDisabledField:wt,_setErrors:q,_getFieldArray:k,_reset:Be,_resetDefaultValues:()=>En(e.defaultValues)&&e.defaultValues().then(P=>{Se(P,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:ds,_subjects:h,_proxyFormState:d,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(P){o=P},get _defaultValues(){return r},get _names(){return l},set _names(P){l=P},get _formState(){return t},get _options(){return e},set _options(P){e={...e,...P}}},subscribe:bt,trigger:qt,register:rt,handleSubmit:z,watch:Ie,setValue:he,getValues:Ot,reset:Se,resetField:Le,clearErrors:Oe,unregister:ot,setError:de,setFocus:Qe,getFieldState:ae};return{...ut,formControl:ut}}function nd(s={}){const e=ct.useRef(void 0),t=ct.useRef(void 0),[n,r]=ct.useState({isDirty:!1,isValidating:!1,isLoading:En(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:En(s.defaultValues)?void 0:s.defaultValues});if(!e.current)if(s.formControl)e.current={...s.formControl,formState:n},s.defaultValues&&!En(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...l}=r1(s);e.current={...l,formState:n}}const i=e.current.control;return i._options=s,FC(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),ct.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),ct.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),ct.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),ct.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),ct.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),ct.useEffect(()=>{s.values&&!_r(s.values,t.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=s.values,r(o=>({...o}))):i._resetDefaultValues()},[i,s.values]),ct.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=OC(n,i),e.current}const Ap=["","","","","","",""],tb=({event:s,slotInfo:e,defaultProjectName:t,onClose:n,onSave:r,onDelete:i})=>{const[o,l]=A.useState(!1),{register:u,handleSubmit:m,setValue:d,watch:f,formState:{errors:h},reset:y}=nd({defaultValues:{projectId:"",title:"",date:"",description:""}}),{projects:T}=er(),[v,V]=A.useState([]),[R,L]=A.useState(""),[q,oe]=A.useState(!1),[te,O]=A.useState(""),[C,N]=A.useState(9),[E,j]=A.useState(0),[S,w]=A.useState(""),k=f("projectId");A.useEffect(()=>{if(k){const ae=T.find(Oe=>Oe.id===k||Oe.id===parseInt(k)||Oe.id.toString()===k.toString());console.log(" Selected project:",ae==null?void 0:ae.name),console.log(" Project team:",ae==null?void 0:ae.team),console.log(" Current selectedMembers:",v)}},[k,T,v]),A.useEffect(()=>{console.log(" Modal mount - initializing states"),V([]),w(""),L("")},[]),A.useEffect(()=>{if(console.log(" ScheduleModal useEffect triggered:",{hasEvent:!!s,eventId:s==null?void 0:s.id,hasSlotInfo:!!e,hasMergedEvents:!!(s!=null&&s.mergedEventIds)}),s&&s.id){console.log(" ScheduleModal processing event:",{title:s.title,projectId:s.projectId,projectName:s.projectName,start:s.start,assignedTo:s.assignedTo,time:s.time});const ae=s.originalTitle||s.title,Oe=/ - (|) \d{1,2}$/,de=ae.replace(Oe,"");if(d("title",de,{shouldValidate:!1,shouldDirty:!1}),d("date",Ft(s.start,"yyyy-MM-dd"),{shouldValidate:!1,shouldDirty:!1}),d("description",s.description||"",{shouldValidate:!1,shouldDirty:!1}),s.projectId&&s.projectId!==""&&s.projectId!=="undefined")console.log(" Setting projectId from event:",s.projectId),d("projectId",s.projectId,{shouldValidate:!1,shouldDirty:!1}),w("");else if(s.projectName){const Ke=T.find(bt=>bt.name===s.projectName);console.log(" Finding project by name:",s.projectName,"found:",Ke),Ke?(console.log(" Setting projectId from found project:",Ke.id),d("projectId",Ke.id,{shouldValidate:!1,shouldDirty:!1}),w("")):(console.log(" Project not found, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),w(""))}else console.log(" No project info, leaving empty"),d("projectId","",{shouldValidate:!1,shouldDirty:!1}),w("");const Ie=s.assignedTo||s.attendees||[];if(console.log(" Setting selectedMembers to:",Ie),V(Array.isArray(Ie)?Ie:[]),s.time&&s.time!=="-"){console.log(" Setting time from event:",{eventTime:s.time,parsedHours:s.time.split(":")[0],parsedMinutes:s.time.split(":")[1]}),oe(!0);const[Ke,bt]=s.time.split(":"),ot=parseInt(Ke,10),wt=parseInt(bt,10);ot>=12?(O(""),N(ot===12?12:ot-12)):(O(""),N(ot===0?12:ot)),j(wt),console.log(" Time state set:",{hasTime:!0,period:ot>=12?"":"",hour:ot>=12?ot===12?12:ot-12:ot===0?12:ot,minute:wt})}else console.log(" No time in event, setting hasTime to false"),oe(!1),O(""),N(9),j(0)}else if(e&&!s&&(console.log(" New schedule from slot:",e),y({projectId:"",title:"",date:Ft(e.start,"yyyy-MM-dd"),description:""}),console.log(" New schedule - resetting selectedMembers to empty array"),V([]),w(""),t)){const ae=T.find(Oe=>Oe.name===t);ae&&d("projectId",ae.id,{shouldValidate:!1,shouldDirty:!1})}},[s==null?void 0:s.id]);const De=ae=>{console.log(" toggleMember called with:",ae),console.log(" Current selectedMembers before toggle:",v),V(Oe=>{console.log(" Previous members in setState:",Oe);const de=Oe.includes(ae)?Oe.filter(Ie=>Ie!==ae):[...Oe,ae];return console.log(" Updated members after toggle:",de),de})},Me=()=>{const ae="HV LAB";v.includes(ae)?V(Oe=>Oe.filter(de=>de!==ae)):V(Oe=>[...Oe.filter(de=>de!==""),ae])},he=()=>{const ae="";v.includes(ae)?V(Oe=>Oe.filter(de=>de!==ae)):V(Oe=>[...Oe,ae])},Re=()=>{const ae="";v.includes(ae)?V(Oe=>Oe.filter(de=>de!==ae)):V(Oe=>[...Oe,ae])},ft=()=>{R.trim()&&!v.includes(R.trim())&&(V(ae=>[...ae,R.trim()]),L(""))},qt=ae=>{V(Oe=>Oe.filter(de=>de!==ae))},Ot=async ae=>{console.log(" Form onSubmit called with data:",ae),console.log(" selectedMembers:",v),console.log(" hasTime state:",q),console.log(" timePeriod:",te,"timeHour:",C,"timeMinute:",E),console.log(" Available projects:",T.map(rt=>({id:rt.id,name:rt.name,idType:typeof rt.id}))),console.log(" Merged event IDs:",s==null?void 0:s.mergedEventIds);const Oe=/ - (|) \d{1,2}$/,de=ae.title.replace(Oe,"").trim();let Ie="",Ke="";if(ae.projectId){const rt=T.find(mt=>mt.id===ae.projectId||mt.id===parseInt(ae.projectId)||mt.id.toString()===ae.projectId.toString());console.log(" Looking for project with id:",ae.projectId,"type:",typeof ae.projectId),console.log(" Found project:",rt),Ie=(rt==null?void 0:rt.name)||"",Ke=ae.projectId}else Ie="",Ke="";console.log(" Final projectId:",Ke,"projectName:",Ie,"cleanedTitle:",de);const bt=new Date(ae.date);let ot="-";if(q){let rt=C;te===""&&C!==12?rt=C+12:te===""&&C===12&&(rt=0),ot=`${rt.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`,console.log(" Time calculated:",ot)}else console.log(" No time set (hasTime is false)");const wt={...s,title:de,start:bt,end:bt,projectId:Ke,projectName:Ie,assignedTo:v,description:ae.description||"",time:ot,mergedEventIds:s==null?void 0:s.mergedEventIds};if(!o){l(!0),console.log(" Calling onSave with newEvent:",wt);try{await r(wt),console.log(" onSave completed successfully")}catch(rt){throw console.error(" onSave failed:",rt),rt}finally{l(!1)}}};return console.log(" Rendering ScheduleModal with selectedMembers:",v),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:382,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:385,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:381,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:m(Ot),className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:397,columnNumber:13},void 0),a.jsxDEV("select",{...u("projectId"),className:"input w-full",children:[a.jsxDEV("option",{value:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:404,columnNumber:15},void 0),T.filter(ae=>s!=null&&s.isASVisit?!0:ae.status!=="completed").map(ae=>a.jsxDEV("option",{value:ae.id,children:ae.name},ae.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:414,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:400,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:396,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:423,columnNumber:13},void 0),a.jsxDEV("input",{...u("title",{required:" "}),type:"text",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:426,columnNumber:13},void 0),h.title&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.title.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:422,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:438,columnNumber:13},void 0),a.jsxDEV("input",{...u("date",{required:" "}),type:"date",className:"input w-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:441,columnNumber:13},void 0),h.date&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(h.date.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:447,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:437,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:453,columnNumber:13},void 0),a.jsxDEV("div",{className:"mb-2",children:a.jsxDEV("button",{type:"button",onClick:()=>oe(!q),className:`px-3 py-1.5 text-xs rounded border transition-colors ${q?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:q?" ":"  (-)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:459,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:458,columnNumber:13},void 0),q&&a.jsxDEV("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxDEV("div",{className:"flex gap-1",children:[a.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:477,columnNumber:19},void 0),a.jsxDEV("button",{type:"button",onClick:()=>O(""),className:`px-3 py-1.5 text-xs rounded border transition-colors ${te===""?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:488,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:476,columnNumber:17},void 0),a.jsxDEV("select",{value:C,onChange:ae=>N(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[12,1,2,3,4,5,6,7,8,9,10,11].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:508,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:502,columnNumber:17},void 0),a.jsxDEV("select",{value:E,onChange:ae=>j(parseInt(ae.target.value)),className:"flex-1 min-w-[80px] max-w-[120px] px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",children:[0,10,20,30,40,50].map(ae=>a.jsxDEV("option",{value:ae,children:[ae,""]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:521,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:452,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:532,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[a.jsxDEV("button",{type:"button",onClick:Me,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("HV LAB")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:539,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:he,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:552,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:Re,className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes("")?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:565,columnNumber:15},void 0),Ap.map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>De(ae),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${v.includes(ae)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:ae},ae,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:579,columnNumber:17},void 0)),v.filter(ae=>!Ap.includes(ae)&&ae!=="HV LAB"&&ae!==""&&ae!=="").map(ae=>a.jsxDEV("button",{type:"button",onClick:()=>qt(ae),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[ae," "]},ae,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:597,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:537,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:R,onChange:ae=>L(ae.target.value),onKeyPress:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ft())},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:611,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:ft,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:623,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:610,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:531,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:635,columnNumber:13},void 0),a.jsxDEV("textarea",{...u("description"),rows:2,className:"input w-full text-sm md:text-base"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:638,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:634,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2 sm:gap-0 pt-4 border-t",children:[a.jsxDEV("div",{children:s&&a.jsxDEV("button",{type:"button",onClick:()=>{window.confirm("  ?")&&i(s.id)},className:"btn btn-outline text-red-600 hover:bg-red-50 flex items-center w-full sm:w-auto justify-center text-sm md:text-base",children:[a.jsxDEV(oi,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:658,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:649,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:647,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2 sm:space-x-3",children:[a.jsxDEV("button",{type:"button",onClick:n,className:"btn btn-outline flex-1 sm:flex-none text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:664,columnNumber:15},void 0),a.jsxDEV("button",{type:"submit",disabled:o,className:"btn btn-primary flex-1 sm:flex-none text-sm md:text-base disabled:opacity-50",children:o?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:663,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:394,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:379,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ScheduleModal.tsx",lineNumber:378,columnNumber:5},void 0)},Mu=s=>{if(!s||s==="-")return"";const[e,t]=s.split(":"),n=parseInt(e,10),r=parseInt(t,10),i=n>=12?"":"",o=n%12||12;return r>0?`${i} ${o} ${r}`:`${i} ${o}`},Ul=["","","","","","","","","","","","","","","","","","","","","","","","","","",""],Xo=s=>{if(!s)return s;const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Ul)if(n===r)return t.slice(0,-1).join(" ").trim()}for(const n of Ul)if(e.endsWith(n))return e.substring(0,e.length-n.length).trim()||e;return e},Ya=s=>{const e=s.replace(/$/g,"").trim(),t=e.split(" ");if(t.length>=2){const n=t[t.length-1];for(const r of Ul)if(n===r)return r}for(const n of Ul)if(e.endsWith(n))return n;return""},i1=["","","","","","",""],o1=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","/","","","","","","","",""],Xc=["","","/","","","","","","","","","","","","",""],a1={KB:"004",:"004",:"088",:"020",:"081",IBK:"003",:"003",NH:"011",:"011",SC:"023",:"023",:"027",:"027",:"045",:"048",:"071",KDB:"002",:"002",:"007",:"031",:"032",:"039",:"034",:"037",:"035",:"090",:"089",K:"089",:"092"},l1={KB:"KB",:"KB",IBK:"",:"",NH:"",:"",SC:"SC",:"SC",:"",:"",KDB:"",:"",:"K"},Ep=i1,c1=()=>{const{schedules:s,loadSchedulesFromAPI:e,addScheduleToAPI:t,deleteScheduleFromAPI:n}=er(),{user:r}=Or(),[i,o]=A.useState(!1);A.useEffect(()=>{e().catch(d=>{console.error("Failed to load schedules:",d)})},[e]);const l=r!=null&&r.name?r.name.slice(-2):null,u=(r==null?void 0:r.name)===""?[""]:l?[l,...Ep.filter(d=>d!==l)]:Ep,m=d=>{const f=s.filter(v=>v.attendees?!!(v.attendees.includes(d)||v.attendees.includes("HV LAB")&&d!==""||v.attendees.includes("")&&["",""].includes(d)||v.attendees.includes("")&&["","",""].includes(d)):!1),h=v=>{const V=new Set;return v.filter(R=>{const q=`${Ft(new Date(R.start),"yyyy-MM-dd")}|${R.project}|${R.title}`;return V.has(q)?!1:(V.add(q),!0)})},y=h(f.filter(v=>Ld(new Date(v.start)))),T=h(f.filter(v=>BN(new Date(v.start))&&!Ld(new Date(v.start))).sort((v,V)=>new Date(v.start).getTime()-new Date(V.start).getTime())).slice(0,3);return{todaySchedules:y,upcomingSchedules:T,member:d}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-5 lg:space-y-4",children:[a.jsxDEV("div",{children:a.jsxDEV("div",{className:"dashboard-grid grid grid-cols-1 sm:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-4 lg:gap-4",children:u.map(d=>{const{todaySchedules:f,upcomingSchedules:h}=m(d),y=f.length+h.length,T=d===l;return a.jsxDEV("div",{className:`card p-3 sm:p-4 md:p-5 lg:p-4 ${T?"ring-1 ring-gray-300":""}`,children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"font-bold text-lg md:text-lg text-gray-900",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:120,columnNumber:21},void 0),T&&a.jsxDEV("span",{className:"text-xs px-2 py-0.5 bg-gray-200 text-gray-600 rounded font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:122,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[T&&a.jsxDEV("button",{onClick:()=>o(!0),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:" ",children:a.jsxDEV($i,{className:"h-4 w-4 text-gray-700"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:23},void 0),a.jsxDEV("span",{className:`text-xs px-2.5 py-1 ${T&&f.length>0?"bg-amber-100 text-gray-900":"bg-gray-100 text-gray-900"} rounded-full font-semibold whitespace-nowrap`,children:[f.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:135,columnNumber:21},void 0),a.jsxDEV("span",{className:"text-xs px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full font-semibold whitespace-nowrap",children:[h.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:125,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:17},void 0),f.length>0&&a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(Kp,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:148,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-900 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:149,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:147,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=f.reduce((V,R)=>{const L=R.project||"-";return V[L]||(V[L]=[]),V[L].push(R),V},{});return Object.entries(v).map(([V,R])=>{const L=d===l;return a.jsxDEV("div",{className:`border-l-3 ${L?"border-gray-400":"border-gray-900"} ${L?"bg-amber-50":"bg-gray-50"} rounded-r overflow-hidden`,children:[a.jsxDEV("div",{className:`px-3 py-1 ${L?"bg-amber-100":"bg-gray-100"} border-b ${L?"border-amber-200":"border-gray-200"}`,children:a.jsxDEV("span",{className:"text-xs font-semibold text-gray-900",children:V},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:171,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:170,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:R.map(q=>{const oe=q.time&&q.time!=="-"?` - ${Mu(q.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",q.title,oe]},q.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:177,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:173,columnNumber:31},void 0)]},V,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:166,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:146,columnNumber:19},void 0),h.length>0&&a.jsxDEV("div",{children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsxDEV(AN,{className:"h-4 w-4 text-gray-600"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:195,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:196,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:194,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-2",children:(()=>{const v=h.reduce((V,R)=>{const L=Ft(new Date(R.start),"MM.dd",{locale:xs}),q=R.project||"-",oe=`${L}|${q}`;return V[oe]||(V[oe]={date:L,project:q,schedules:[]}),V[oe].schedules.push(R),V},{});return Object.values(v).map(({date:V,project:R,schedules:L})=>{const oe=L.length>0&&RN(new Date(L[0].start))?`${V} ()`:V;return a.jsxDEV("div",{className:"border-l-3 border-gray-400 bg-gray-50 rounded-r overflow-hidden",children:[a.jsxDEV("div",{className:"px-3 py-1 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700",children:R},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:218,columnNumber:33},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500 font-medium",children:oe},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:219,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:217,columnNumber:31},void 0),a.jsxDEV("div",{className:"px-3 py-1.5 space-y-0.5",children:L.map(te=>{const O=te.time&&te.time!=="-"?` - ${Mu(te.time)}`:"";return a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm leading-snug",children:[" ",te.title,O]},te.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:225,columnNumber:37},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:221,columnNumber:31},void 0)]},`${V}-${R}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:216,columnNumber:29},void 0)})})()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:198,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:193,columnNumber:19},void 0),y===0&&a.jsxDEV("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:241,columnNumber:19},void 0)]},d,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:107,columnNumber:7},void 0),i&&a.jsxDEV(tb,{event:null,slotInfo:{start:new Date,end:new Date},onClose:()=>o(!1),onSave:async d=>{try{console.log("Dashboard: Adding schedule...",d),await t({id:Date.now().toString(),title:d.title||"",start:d.start||new Date,end:d.end||new Date,type:"other",project:d.projectId||d.projectName||"",location:"",attendees:d.assignedTo||[],description:d.description||"",time:d.time}),console.log("Dashboard: Schedule added successfully"),await e(),console.log("Dashboard: Schedules fetched, closing modal"),o(!1)}catch(f){console.error("Failed to add schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}},onDelete:async d=>{try{await n(d),await e(),o(!1)}catch(f){console.error("Failed to delete schedule:",f),alert("  : "+(f instanceof Error?f.message:"   "))}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:253,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Dashboard.tsx",lineNumber:105,columnNumber:5},void 0)},dc=()=>{const{user:s}=Or(),{projects:e}=er();return A.useMemo(()=>s?s.name===""?e.filter(n=>{const i=(n.manager?n.manager.split(",").map(l=>l.trim()):[]).includes(""),o=n.team&&Array.isArray(n.team)&&n.team.includes("");return i||o}):e:[],[s,e])},u1=({value:s,detailValue:e="",onChange:t,onDetailChange:n,placeholder:r=" ",error:i})=>{const[o,l]=A.useState(!1),[u,m]=A.useState(s),[d,f]=A.useState(e),h=A.useRef(null);A.useEffect(()=>{const R=L=>{h.current&&!h.current.contains(L.target)&&l(!1)};return o&&document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[o]),A.useEffect(()=>{m(s)},[s]),A.useEffect(()=>{f(e)},[e]);const y=()=>new Promise((R,L)=>{if(window.daum&&window.daum.Postcode){R(!0);return}const q=document.createElement("script");q.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",q.async=!0,q.onload=()=>R(!0),q.onerror=()=>L(new Error("Kakao Postcode   ")),document.head.appendChild(q)}),T=R=>{const L=R.roadAddr||R.jibunAddr;m(L),t(L,d),l(!1)},v=R=>{const L=R.target.value;f(L),n&&n(L),u&&t(u,L)},V=async()=>{try{(!window.daum||!window.daum.Postcode)&&await y(),window.daum&&new window.daum.Postcode({oncomplete:function(R){const L={roadAddr:R.roadAddress,jibunAddr:R.jibunAddress||R.autoJibunAddress||"",zipNo:R.zonecode,bdNm:R.buildingName,siNm:R.sido,sggNm:R.sigungu,emdNm:R.bname,rn:R.roadname};T(L)}}).open()}catch(R){console.error("  :",R),alert("     .  .")}};return a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("div",{className:"relative flex-1",children:[a.jsxDEV("input",{type:"text",value:u,onClick:()=>V(),onChange:R=>{m(R.target.value),t(R.target.value,d)},placeholder:r,className:`input pr-8 cursor-pointer ${i?"border-red-500":""}`,readOnly:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:172,columnNumber:13},void 0),a.jsxDEV(Qp,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:184,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:171,columnNumber:11},void 0),a.jsxDEV("button",{type:"button",onClick:V,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:188,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:170,columnNumber:9},void 0),i&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:169,columnNumber:7},void 0),a.jsxDEV("div",{children:a.jsxDEV("input",{type:"text",value:d,onChange:v,placeholder:" (/ )",className:"input",disabled:!u},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:203,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:202,columnNumber:7},void 0),u&&a.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxDEV("p",{className:"text-sm text-gray-600",children:[a.jsxDEV("span",{className:"font-medium",children:" :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:217,columnNumber:13},void 0)," ",u,d&&`, ${d}`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:215,columnNumber:9},void 0),a.jsxDEV("div",{id:"address-search-container",style:{display:"none",width:"100%",height:"400px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:225,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/AddressSearch.tsx",lineNumber:167,columnNumber:5},void 0)},Cp=["","","","","","",""],m1=({project:s,onClose:e,onSave:t})=>{const{register:n,handleSubmit:r,setValue:i,reset:o,formState:{errors:l}}=nd({defaultValues:{name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}}),[u,m]=A.useState([]),[d,f]=A.useState(""),[h,y]=A.useState(""),[T,v]=A.useState(""),[V,R]=A.useState(!1);A.useEffect(()=>{var O;if(s){const C=s.location?s.location.split(","):["",""],N=((O=C[0])==null?void 0:O.trim())||s.location||"",E=C.length>1?C.slice(1).join(",").trim():"";o({name:s.name,client:s.client||"",location:N,detailLocation:E,startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:""}),y(N),v(E);const j=s.manager?s.manager.split(",").map(S=>S.trim()).filter(S=>S&&S!==""):[];m(j)}else o({name:"",client:"",location:"",detailLocation:"",startDate:"",endDate:""}),y(""),v(""),m([])},[s,o]);const L=O=>{m(C=>C.includes(O)?C.filter(N=>N!==O):[...C,O])},q=()=>{d.trim()&&!u.includes(d.trim())&&(m(O=>[...O,d.trim()]),f(""))},oe=O=>{m(C=>C.filter(N=>N!==O))},te=async O=>{if(V)return;R(!0),console.log(" ProjectModal onSubmit - Raw form data:",O);const C=h&&T?`${h}, ${T}`:h||O.location,N={name:O.name,client:O.client,location:C,manager:u.join(", "),contractAmount:(s==null?void 0:s.contractAmount)??0,spent:(s==null?void 0:s.spent)??0,status:(s==null?void 0:s.status)??"planning",progress:(s==null?void 0:s.progress)??0,description:(s==null?void 0:s.description)??"",meetingNotes:(s==null?void 0:s.meetingNotes)??[],customerRequests:(s==null?void 0:s.customerRequests)??[],entrancePassword:(s==null?void 0:s.entrancePassword)??"",sitePassword:(s==null?void 0:s.sitePassword)??""};if(O.startDate&&O.startDate!=="")N.startDate=O.startDate,console.log(" Setting startDate from form:",O.startDate);else if(s!=null&&s.startDate){const E=typeof s.startDate=="string"&&s.startDate.includes("T")?s.startDate.split("T")[0]:s.startDate;N.startDate=E,console.log(" Keeping existing startDate:",N.startDate)}if(O.endDate&&O.endDate!=="")N.endDate=O.endDate,console.log(" Setting endDate from form:",O.endDate);else if(s!=null&&s.endDate){const E=typeof s.endDate=="string"&&s.endDate.includes("T")?s.endDate.split("T")[0]:s.endDate;N.endDate=E,console.log(" Keeping existing endDate:",N.endDate)}console.log(" ProjectModal onSubmit - Final formData:",N);try{await t(N)}catch(E){throw R(!1),E}};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 md:p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 md:p-6 border-b sticky top-0 bg-white z-10",children:[a.jsxDEV("h2",{className:"text-lg md:text-xl font-semibold",children:s?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:186,columnNumber:11},void 0),a.jsxDEV("button",{onClick:e,className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:193,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:185,columnNumber:9},void 0),a.jsxDEV("form",{onSubmit:r(te),className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:202,columnNumber:15},void 0),a.jsxDEV("input",{...n("name",{required:" "}),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:205,columnNumber:15},void 0),l.name&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:String(l.name.message)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:211,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:201,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:216,columnNumber:15},void 0),a.jsxDEV("input",{...n("client"),type:"text",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:215,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:200,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:229,columnNumber:13},void 0),a.jsxDEV(u1,{value:h,detailValue:T,onChange:(O,C)=>{y(O),v(C||""),i("location",O),i("detailLocation",C||"")},onDetailChange:O=>{v(O),i("detailLocation",O)},placeholder:"  ",required:!0,error:l.location?String(l.location.message):void 0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:228,columnNumber:11},void 0),a.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:255,columnNumber:15},void 0),a.jsxDEV("input",{...n("startDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:258,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:254,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:266,columnNumber:15},void 0),a.jsxDEV("input",{...n("endDate"),type:"date",className:"input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:269,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:265,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:253,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (  )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:279,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[Cp.map(O=>a.jsxDEV("button",{type:"button",onClick:()=>L(O),className:`px-2.5 py-1.5 rounded border transition-colors text-sm ${u.includes(O)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:O},O,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:287,columnNumber:17},void 0)),u.filter(O=>!Cp.includes(O)).map(O=>a.jsxDEV("button",{type:"button",onClick:()=>oe(O),className:"px-2.5 py-1.5 rounded border transition-colors text-sm bg-gray-900 text-white border-gray-900 hover:bg-gray-800",children:[O," "]},O,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:305,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:284,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:d,onChange:O=>f(O.target.value),onKeyPress:O=>{O.key==="Enter"&&(O.preventDefault(),q())},placeholder:"   ",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:319,columnNumber:15},void 0),a.jsxDEV("button",{type:"button",onClick:q,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:332,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:278,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex justify-end space-x-2 md:space-x-3 pt-4 border-t",children:[a.jsxDEV("button",{type:"button",onClick:e,className:"btn btn-outline text-sm md:text-base",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:345,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:V,className:"btn btn-primary text-sm md:text-base disabled:opacity-50",children:V?" ...":s?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:352,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:344,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:198,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:183,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/ProjectModal.tsx",lineNumber:182,columnNumber:5},void 0)},d1=({projectName:s,meetingNotes:e,onClose:t,onSave:n,onDelete:r})=>{const[i,o]=A.useState(""),[l,u]=A.useState(new Date().toISOString().split("T")[0]),[m,d]=A.useState(!1),[f,h]=A.useState(!1),y=()=>{d(!0),o(""),u(new Date().toISOString().split("T")[0])},T=async()=>{if(!f){if(!i.trim()){alert(" ");return}if(!l){alert(" ");return}h(!0);try{await n(i.trim(),new Date(l)),o(""),u(new Date().toISOString().split("T")[0]),d(!1)}finally{h(!1)}}},v=()=>{o(""),u(new Date().toISOString().split("T")[0]),d(!1)},V=R=>{window.confirm("   ?")&&r(R)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:R=>R.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:83,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:82,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:90,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:81,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!m&&a.jsxDEV("button",{onClick:y,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:98,columnNumber:13},void 0),m&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:110,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:l,onChange:R=>u(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:113,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:121,columnNumber:17},void 0),a.jsxDEV("textarea",{value:i,onChange:R=>o(R.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:4},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:124,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:120,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:T,disabled:f,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:133,columnNumber:17},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:140,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:132,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-3",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:154,columnNumber:15},void 0):e.map(R=>a.jsxDEV("div",{className:"p-4 bg-white border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start justify-between gap-3",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-2",children:Ft(new Date(R.date),"yyyy.MM.dd (eee)",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:165,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:R.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:168,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:164,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>V(R.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:172,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:163,columnNumber:19},void 0)},R.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:159,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:152,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:76,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/MeetingNotesModal.tsx",lineNumber:72,columnNumber:5},void 0)},f1=({projectName:s,customerRequests:e,onClose:t,onSave:n,onToggleComplete:r,onDelete:i})=>{const[o,l]=A.useState(""),[u,m]=A.useState(new Date().toISOString().split("T")[0]),[d,f]=A.useState(!1),[h,y]=A.useState(!1),T=()=>{f(!0),l(""),m(new Date().toISOString().split("T")[0])},v=async()=>{if(!h){if(!o.trim()){alert(" ");return}if(!u){alert(" ");return}y(!0);try{await n(o.trim(),new Date(u)),l(""),m(new Date().toISOString().split("T")[0]),f(!1)}finally{y(!1)}}},V=()=>{l(""),m(new Date().toISOString().split("T")[0]),f(!1)},R=te=>{window.confirm("  ?")&&i(te)},L=te=>{r(te)},q=e.filter(te=>!te.completed),oe=e.filter(te=>te.completed);return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col shadow-xl",onClick:te=>te.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:93,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:92,columnNumber:11},void 0),a.jsxDEV("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:96,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:91,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6",children:[!d&&a.jsxDEV("button",{onClick:T,className:"w-full mb-4 px-4 py-2.5 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"+ "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:108,columnNumber:13},void 0),d&&a.jsxDEV("div",{className:"mb-4 p-4 bg-gray-50 rounded border border-gray-200",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:120,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:u,onChange:te=>m(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:119,columnNumber:15},void 0),a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:131,columnNumber:17},void 0),a.jsxDEV("textarea",{value:o,onChange:te=>l(te.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900 resize-none",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:134,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:v,disabled:h,className:"px-4 py-1.5 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:h?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:143,columnNumber:17},void 0),a.jsxDEV("button",{onClick:V,disabled:h,className:"px-4 py-1.5 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:150,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:142,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:118,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2",children:e.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-400 text-sm",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:164,columnNumber:15},void 0):a.jsxDEV(a.Fragment,{children:[q.map(te=>a.jsxDEV("div",{className:"p-3 bg-white border border-gray-300 rounded hover:border-gray-400 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>L(te.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(EN,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:180,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:176,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:183,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:Ft(new Date(te.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:186,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:182,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:175,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:171,columnNumber:19},void 0)),oe.map(te=>a.jsxDEV("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded hover:border-gray-300 transition-colors group",children:a.jsxDEV("div",{className:"flex items-start gap-3",children:[a.jsxDEV("button",{onClick:()=>L(te.id),className:"mt-0.5 flex-shrink-0",children:a.jsxDEV(CN,{className:"h-4 w-4 text-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:211,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:207,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("p",{className:"text-sm text-gray-500 line-through whitespace-pre-wrap break-words",children:te.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:214,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:Ft(new Date(te.createdAt),"yyyy.MM.dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:217,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:213,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>R(te.id),className:"opacity-0 group-hover:opacity-100 px-2 py-1 text-xs text-gray-500 hover:text-red-600 transition-all",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:206,columnNumber:21},void 0)},te.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:202,columnNumber:19},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:168,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:162,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:105,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:86,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CustomerRequestsModal.tsx",lineNumber:82,columnNumber:5},void 0)},p1=({projectName:s,entrancePassword:e,sitePassword:t,onClose:n,onSave:r})=>{const[i,o]=A.useState(e||""),[l,u]=A.useState(t||""),[m,d]=A.useState(!1),[f,h]=A.useState(!1),y=()=>{d(!0)},T=async()=>{if(!f){h(!0);try{await r(i,l),d(!1)}finally{h(!1)}}},v=()=>{o(e||""),u(t||""),d(!1)};return a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full shadow-xl",onClick:V=>V.stopPropagation(),children:[a.jsxDEV("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[a.jsxDEV("div",{children:[a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:57,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 mt-0.5",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:56,columnNumber:11},void 0),a.jsxDEV("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded transition-colors",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:55,columnNumber:9},void 0),a.jsxDEV("div",{className:"p-6 space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:72,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:i,onChange:V=>o(V.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:76,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:i?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:86,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:88,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:84,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:71,columnNumber:11},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:96,columnNumber:13},void 0),m?a.jsxDEV("input",{type:"text",value:l,onChange:V=>u(V.target.value),placeholder:"  ",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:100,columnNumber:15},void 0):a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded",children:l?a.jsxDEV("span",{className:"text-sm font-mono text-gray-900",children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:110,columnNumber:19},void 0):a.jsxDEV("span",{className:"text-sm text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:112,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:108,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:95,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:69,columnNumber:9},void 0),a.jsxDEV("div",{className:"border-t border-gray-200 px-6 py-4 flex gap-2",children:m?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:T,disabled:f,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:123,columnNumber:15},void 0),a.jsxDEV("button",{onClick:v,disabled:f,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors disabled:opacity-50",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:122,columnNumber:13},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("button",{onClick:y,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-900 text-white text-sm rounded hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:146,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:139,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:120,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:50,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/SitePasswordModal.tsx",lineNumber:46,columnNumber:5},void 0)},h1=({projectName:s,onClose:e})=>{var o;const[t,n]=A.useState({clientName:"",phoneNumber:"",address:"",startDate:"",endDate:"",area:"",designFee:"",bankAccount:" 487102-01-264798 ",companyAddress:"  277  109",representative:"  "}),r=()=>{window.print()},i=l=>{const u=Number(l.replace(/,/g,""));return isNaN(u)?"":u.toLocaleString()};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:40,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:45,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:39,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:52,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.clientName,onChange:l=>n({...t,clientName:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:53,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:51,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:63,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.phoneNumber,onChange:l=>n({...t,phoneNumber:l.target.value}),placeholder:"010-0000-0000",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:64,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:62,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:74,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.address,onChange:l=>n({...t,address:l.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:75,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:73,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:86,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.startDate,onChange:l=>n({...t,startDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:87,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:85,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:95,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:t.endDate,onChange:l=>n({...t,endDate:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:96,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:94,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:84,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:106,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.area,onChange:l=>n({...t,area:l.target.value}),placeholder:": 21.9(72.37m2)",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:107,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:105,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:117,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:i(t.designFee),onChange:l=>{const u=l.target.value.replace(/,/g,"");/^\d*$/.test(u)&&n({...t,designFee:u})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:118,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:116,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:133,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:t.bankAccount,onChange:l=>n({...t,bankAccount:l.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:134,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:132,columnNumber:13},void 0),a.jsxDEV("button",{onClick:r,disabled:!t.clientName||!t.phoneNumber||!t.address,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:147,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:50,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-16",children:a.jsxDEV("div",{className:"space-y-16",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:156,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-8 text-base leading-relaxed",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"1.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:161,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.clientName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:162,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:160,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"2.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:166,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.phoneNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:167,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:165,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:171,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:172,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:170,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"3.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:176,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.startDate&&t.endDate?a.jsxDEV(a.Fragment,{children:[Ft(new Date(t.startDate),"yyyy",{locale:xs}),"",Ft(new Date(t.startDate),"MM",{locale:xs}),"",Ft(new Date(t.startDate),"dd",{locale:xs})," ~ ",Ft(new Date(t.endDate),"yyyy",{locale:xs}),"",Ft(new Date(t.endDate),"MM",{locale:xs}),"",Ft(new Date(t.endDate),"dd",{locale:xs})," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:179,columnNumber:23},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:175,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"5.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:187,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:t.area},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:186,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex flex-col",children:[a.jsxDEV("div",{className:"flex items-baseline",children:[a.jsxDEV("span",{className:"w-48",children:"6.  :"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:193,columnNumber:21},void 0),a.jsxDEV("span",{className:"flex-1",children:[t.designFee?`${i(t.designFee)}`:""," ()"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:194,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:192,columnNumber:19},void 0),t.bankAccount&&a.jsxDEV("div",{className:"ml-48 mt-2 text-center",children:t.bankAccount},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:191,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:159,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-20 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:206,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.address]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:208,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",(o=t.clientName)==null?void 0:o.split("").join("    ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:210,columnNumber:21},void 0),a.jsxDEV("span",{className:"ml-8",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:211,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:209,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:207,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:205,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 space-y-3",children:[a.jsxDEV("div",{className:"text-base font-bold",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:218,columnNumber:17},void 0),a.jsxDEV("div",{className:"ml-8 space-y-2 text-base",children:[a.jsxDEV("div",{children:[" : ",t.companyAddress]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:220,columnNumber:19},void 0),a.jsxDEV("div",{children:" : HV LAB ()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:221,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{children:[" : ",t.representative]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:223,columnNumber:21},void 0),a.jsxDEV("div",{className:"ml-8 inline-flex items-center justify-center w-14 h-14 border-2 border-red-600",children:a.jsxDEV("span",{className:"text-red-600 text-xs font-bold leading-tight text-center",children:["",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:226,columnNumber:28},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:225,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:224,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:219,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:217,columnNumber:15},void 0),a.jsxDEV("div",{className:"border-t-[3px] border-gray-900 mt-32 pt-12 flex justify-between items-end",children:[a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("span",{className:"text-4xl font-bold",children:"H"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:236,columnNumber:19},void 0),a.jsxDEV("span",{className:"inline-block w-12 h-1 bg-gray-900 mx-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:237,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:235,columnNumber:17},void 0),a.jsxDEV("div",{className:"text-right",children:[a.jsxDEV("div",{className:"text-xs tracking-widest mb-1",children:"ARCHITECTURE & INTERIOR"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:240,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-3xl font-bold",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:241,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:239,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:154,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:36,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 0;
          }
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:relative {
            position: relative !important;
            background: white !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:250,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/DesignContractModal.tsx",lineNumber:35,columnNumber:5},void 0)},g1=()=>{const{loadProjectsFromAPI:s,addProjectToAPI:e,updateProjectInAPI:t,deleteProjectFromAPI:n}=er(),{user:r}=Or(),i=dc(),[o,l]=A.useState("in-progress"),[u,m]=A.useState("grid"),[d,f]=A.useState(!1),[h,y]=A.useState(null),[T,v]=A.useState(!1),[V,R]=A.useState(!1),[L,q]=A.useState(!1),[oe,te]=A.useState(!1),[O,C]=A.useState(null),N=(z,Le)=>`lastViewed_${r==null?void 0:r.id}_${z}_${Le}`,E=(z,Le)=>{const Be=N(z,Le),Se=localStorage.getItem(Be);return Se?parseInt(Se,10):0},j=(z,Le)=>{const Be=N(z,Le);localStorage.setItem(Be,Date.now().toString())},S=(z,Le)=>{const Be=E(z.id,Le);return Le==="meeting"?(z.meetingNotes||[]).some(Qe=>(Qe.createdAt?new Date(Qe.createdAt).getTime():new Date(Qe.date).getTime())>Be):(z.customerRequests||[]).some(Qe=>!Qe.completed)};A.useEffect(()=>{s().catch(z=>{console.error("Failed to load projects:",z),ne.error("   ")})},[s]),A.useEffect(()=>{const z=()=>{y(null),f(!0)};return window.addEventListener("headerAddButtonClick",z),()=>window.removeEventListener("headerAddButtonClick",z)},[]);const w=(z,Le)=>{if(!z||!Le)return 0;const Be=new Date,Se=new Date(z),Qe=new Date(Le);if(Be<Se)return 0;if(Be>Qe)return 100;const St=Math.ceil((Qe.getTime()-Se.getTime())/(1e3*60*60*24)),$t=Math.ceil((Be.getTime()-Se.getTime())/(1e3*60*60*24)),ut=Math.round($t/St*100);return Math.min(100,Math.max(0,ut))},k=z=>{y(z),f(!0)},De=async(z,Le)=>{if(window.confirm(`"${Le}"  ?

    .`))try{await n(z),ne.success(" ")}catch(Be){console.error("Failed to delete project:",Be),ne.error("  ")}},Me=async z=>{try{if(h)await t(h.id,z),ne.success(" ");else{const Le={id:"",...z,team:z.team||[]};await e(Le),ne.success(" "),l(z.status||"planning")}f(!1),y(null)}catch(Le){console.error("Failed to save project:",Le),ne.error("  ")}},he=async(z,Le)=>{try{await t(z,{status:Le}),ne.success(" ")}catch(Be){console.error("Failed to update project status:",Be),ne.error("  ")}},Re=z=>{C(z),v(!0),j(z.id,"meeting")},ft=z=>{C(z),R(!0),j(z.id,"request")},qt=z=>{C(z),q(!0)},Ot=z=>{C(z),te(!0)},ae=async(z,Le)=>{if(!O)return;const Be=O.entrancePassword,Se=O.sitePassword;C({...O,entrancePassword:z,sitePassword:Le});try{await t(O.id,{entrancePassword:z,sitePassword:Le}),ne.success(" ")}catch(Qe){console.error("Failed to save passwords:",Qe),ne.error("  "),C({...O,entrancePassword:Be,sitePassword:Se})}},Oe=async(z,Le)=>{if(!O)return;const Be={id:Date.now().toString(),content:z,date:Le,createdAt:new Date},Se=[...O.meetingNotes||[],Be];C({...O,meetingNotes:Se});try{await t(O.id,{meetingNotes:Se}),ne.success("  ")}catch(Qe){console.error("Failed to save meeting note:",Qe),ne.error("   "),C({...O,meetingNotes:O.meetingNotes||[]})}},de=async(z,Le)=>{if(!O)return;const Be={id:Date.now().toString(),content:z,completed:!1,createdAt:Le},Se=[...O.customerRequests||[],Be];C({...O,customerRequests:Se});try{await t(O.id,{customerRequests:Se}),ne.success("  ")}catch(Qe){console.error("Failed to save customer request:",Qe),ne.error("   "),C({...O,customerRequests:O.customerRequests||[]})}},Ie=async z=>{if(!O)return;const Le=O.customerRequests||[],Be=Le.map(Se=>Se.id===z?{...Se,completed:!Se.completed}:Se);C({...O,customerRequests:Be});try{await t(O.id,{customerRequests:Be}),ne.success("  ")}catch(Se){console.error("Failed to toggle request:",Se),ne.error("  "),C({...O,customerRequests:Le})}},Ke=async z=>{if(!O)return;const Le=O.meetingNotes||[],Be=Le.filter(Se=>Se.id!==z);C({...O,meetingNotes:Be});try{await t(O.id,{meetingNotes:Be}),ne.success("  ")}catch(Se){console.error("Failed to delete meeting note:",Se),ne.error(" "),C({...O,meetingNotes:Le})}},bt=async z=>{if(!O)return;const Le=O.customerRequests||[],Be=Le.filter(Se=>Se.id!==z);C({...O,customerRequests:Be});try{await t(O.id,{customerRequests:Be}),ne.success("  ")}catch(Se){console.error("Failed to delete customer request:",Se),ne.error(" "),C({...O,customerRequests:Le})}},ot=({project:z})=>{const Be={planning:{label:"",color:"bg-white text-gray-700 border-gray-300"},"in-progress":{label:"",color:"bg-white text-gray-900 border-gray-300"},completed:{label:"",color:"bg-gray-900 text-white border-gray-900"},"on-hold":{label:"",color:"bg-white text-gray-600 border-gray-300"}}[z.status];return a.jsxDEV("select",{value:z.status,onChange:Se=>he(z.id,Se.target.value),className:Dn("px-2 py-1 text-xs font-medium border rounded cursor-pointer","focus:outline-none focus:ring-2 focus:ring-gray-500",Be.color),onClick:Se=>Se.stopPropagation(),children:[a.jsxDEV("option",{value:"planning",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:395,columnNumber:9},void 0),a.jsxDEV("option",{value:"in-progress",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:396,columnNumber:9},void 0),a.jsxDEV("option",{value:"completed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:397,columnNumber:9},void 0),a.jsxDEV("option",{value:"on-hold",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:398,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:385,columnNumber:7},void 0)},rt=(()=>{let z=i;return o!=="all"&&(z=z.filter(Le=>Le.status===o)),r!=null&&r.name&&(z=[...z].sort((Le,Be)=>{var St,$t;const Se=Le.manager===r.name||((St=Le.team)==null?void 0:St.includes(r.name)),Qe=Be.manager===r.name||(($t=Be.team)==null?void 0:$t.includes(r.name));return Se&&!Qe?-1:!Se&&Qe?1:0})),z})(),mt={planning:i.filter(z=>z.status==="planning").length,inProgress:i.filter(z=>z.status==="in-progress").length,completed:i.filter(z=>z.status==="completed").length,onHold:i.filter(z=>z.status==="on-hold").length},ds=({project:z})=>{var Be,Se,Qe;const Le=w(z.startDate,z.endDate);return a.jsxDEV("div",{className:"card p-3 md:p-4 hover:border-gray-400 transition-colors",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("h3",{className:"font-bold text-base md:text-lg text-gray-900",children:z.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:444,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[z.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:445,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:443,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex flex-col items-end gap-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[z.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ot(z),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:450,columnNumber:17},void 0),a.jsxDEV(ot,{project:z},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:457,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:448,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>k(z),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:459,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:447,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:442,columnNumber:9},void 0),a.jsxDEV("div",{className:"space-y-1.5 md:space-y-2 mb-3 md:mb-4 text-xs md:text-sm",children:[a.jsxDEV("div",{className:"text-gray-600",children:[": ",z.location]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:469,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",z.startDate&&z.endDate?`${Ft(z.startDate,"MM.dd (eee)",{locale:xs})} - ${Ft(z.endDate,"MM.dd (eee)",{locale:xs})}`:""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:472,columnNumber:11},void 0),a.jsxDEV("div",{className:"text-gray-600",children:[": ",z.manager]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:477,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:468,columnNumber:9},void 0),a.jsxDEV("div",{className:"mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end mb-2",children:a.jsxDEV("button",{onClick:()=>qt(z),className:"px-2.5 py-1 text-[10px] md:text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:485,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:484,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-1.5 md:mb-2",children:[a.jsxDEV("span",{className:"text-[10px] md:text-xs text-gray-600",children:" ( )"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:493,columnNumber:13},void 0),a.jsxDEV("span",{className:"text-xs md:text-sm font-medium text-gray-900",children:[Le,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:494,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:492,columnNumber:11},void 0),a.jsxDEV("div",{className:"w-full bg-gray-200 h-1",children:a.jsxDEV("div",{className:"bg-gray-900 h-1 transition-all",style:{width:`${Le}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:497,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:496,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:482,columnNumber:9},void 0),a.jsxDEV("div",{className:"pt-3 border-t border-gray-200 space-y-2",children:[a.jsxDEV("div",{onClick:()=>Re(z),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",(((Be=z.meetingNotes)==null?void 0:Be.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=z.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:515,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:512,columnNumber:15},void 0),S(z,"meeting")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:519,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:511,columnNumber:13},void 0),z.meetingNotes&&z.meetingNotes.length>0?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:((Qe=z.meetingNotes[z.meetingNotes.length-1])==null?void 0:Qe.content)||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:523,columnNumber:15},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"+   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:507,columnNumber:11},void 0),(()=>{var ut;const St=((ut=z.customerRequests)==null?void 0:ut.filter(P=>!P.completed))||[],$t=St[St.length-1];return a.jsxDEV("div",{onClick:()=>ft(z),className:"relative p-2.5 bg-gray-50 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors border border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-1",children:[a.jsxDEV("span",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["",St.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",St.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:544,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:541,columnNumber:19},void 0),S(z,"request")&&a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded-full",children:"NEW"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:548,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:540,columnNumber:17},void 0),$t?a.jsxDEV("p",{className:"text-xs text-gray-600 line-clamp-1",children:$t.content||" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:552,columnNumber:19},void 0):a.jsxDEV("p",{className:"text-xs text-gray-400 italic",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:556,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:536,columnNumber:15},void 0)})(),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("div",{className:"flex justify-end pt-1",children:a.jsxDEV("button",{onClick:()=>De(z.id,z.name),className:"text-xs text-rose-500 hover:text-rose-600",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:564,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:563,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:505,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:441,columnNumber:7},void 0)};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("nav",{className:"flex space-x-4 md:space-x-8 overflow-x-auto",children:[{id:"planning",label:"",count:mt.planning,color:"text-gray-700"},{id:"in-progress",label:"",count:mt.inProgress,color:"text-gray-700"},{id:"completed",label:"",count:mt.completed,color:"text-gray-700"},{id:"all",label:"",count:i.length,color:"text-gray-600"}].map(z=>a.jsxDEV("button",{onClick:()=>l(z.id),className:Dn("py-3 md:py-4 px-1 border-b-2 font-medium text-xs md:text-sm transition-colors whitespace-nowrap",o===z.id?`border-gray-700 ${z.color}`:"border-transparent text-gray-400 hover:text-gray-700 hover:border-gray-300"),children:[z.label,a.jsxDEV("span",{className:Dn("ml-1 md:ml-2 py-0.5 px-1.5 md:px-2 rounded-full text-[10px] md:text-xs font-semibold",o===z.id?"bg-gray-700 text-white":"bg-gray-200 text-gray-600"),children:z.count},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:601,columnNumber:17},void 0)]},z.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:590,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:583,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center gap-6 mb-3 md:mb-4",children:[a.jsxDEV("div",{className:"hidden sm:flex border border-gray-300 overflow-hidden rounded",children:[a.jsxDEV("button",{onClick:()=>m("grid"),className:Dn("px-3 md:px-4 py-2 text-xs md:text-sm",u==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:615,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>m("list"),className:Dn("px-3 md:px-4 py-2 text-xs md:text-sm border-l border-gray-300",u==="list"?"bg-gray-100":"hover:bg-gray-50"),children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:614,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{y(null),f(!0)},className:"hidden lg:inline-flex btn btn-primary portrait:px-2 landscape:px-4 py-2 items-center gap-1",children:[a.jsxDEV($i,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:642,columnNumber:15},void 0),a.jsxDEV("span",{className:"portrait:hidden landscape:inline",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:643,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:635,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:612,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:581,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:580,columnNumber:7},void 0),u==="grid"||window.innerWidth<768?a.jsxDEV("div",{className:"projects-grid grid grid-cols-1 md:grid-cols-2 ipad:grid-cols-2 ipad-lg:grid-cols-2 ipad-xl:grid-cols-3 ipad-2xl:grid-cols-3 2xl:grid-cols-4 gap-3 md:gap-6",children:rt.map(z=>a.jsxDEV(ds,{project:z},z.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:652,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:650,columnNumber:9},void 0):a.jsxDEV("div",{className:"bg-white border border-gray-200 overflow-hidden",children:a.jsxDEV("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsxDEV("thead",{className:"bg-gray-50",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:660,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:663,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:666,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:669,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:672,columnNumber:17},void 0),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:675,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:659,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:658,columnNumber:13},void 0),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:rt.map(z=>{var Be,Se,Qe,St;const Le=w(z.startDate,z.endDate);return a.jsxDEV("tr",{className:"hover:bg-gray-50",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{children:[a.jsxDEV("p",{className:"font-medium",children:z.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:687,columnNumber:25},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500",children:z.location},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:688,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:686,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:685,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("p",{className:"text-sm",children:[z.client,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:692,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:691,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:z.startDate&&z.endDate?a.jsxDEV(a.Fragment,{children:[Ft(z.startDate,"yyyy.MM.dd (eee)",{locale:xs})," -",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:698,columnNumber:27},void 0),Ft(z.endDate,"yyyy.MM.dd (eee)",{locale:xs})]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:696,columnNumber:25},void 0):""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:694,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[z.status==="planning"&&a.jsxDEV("button",{onClick:()=>Ot(z),className:"px-2 py-1 text-xs font-medium text-white bg-gray-700 hover:bg-gray-800 rounded transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:706,columnNumber:27},void 0),a.jsxDEV(ot,{project:z},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:713,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:704,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:703,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("button",{onClick:()=>qt(z),className:"px-2.5 py-1 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded border border-gray-300 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:718,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center",children:[a.jsxDEV("div",{className:"w-24 bg-gray-200 h-1 mr-2",children:a.jsxDEV("div",{className:"bg-gray-900 h-1",style:{width:`${Le}%`}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:726,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:725,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-sm",children:[Le,"%"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:731,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:724,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:717,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:716,columnNumber:21},void 0),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"flex flex-col gap-1.5 min-w-[280px]",children:[a.jsxDEV("div",{onClick:()=>Re(z),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",(((Be=z.meetingNotes)==null?void 0:Be.length)||0)>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",(Se=z.meetingNotes)==null?void 0:Se.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:745,columnNumber:31},void 0),S(z,"meeting")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:748,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:742,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:(Qe=z.meetingNotes)!=null&&Qe.length?((St=z.meetingNotes[z.meetingNotes.length-1])==null?void 0:St.content)||"-":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:751,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:738,columnNumber:25},void 0),(()=>{var P;const $t=((P=z.customerRequests)==null?void 0:P.filter(F=>!F.completed))||[],ut=$t[$t.length-1];return a.jsxDEV("div",{onClick:()=>ft(z),className:"flex items-center gap-2 p-2 bg-gray-50 hover:bg-gray-100 rounded cursor-pointer transition-colors",children:[a.jsxDEV("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap flex items-center gap-1",children:["",$t.length>0&&a.jsxDEV("span",{className:"text-gray-500",children:["(",$t.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:767,columnNumber:35},void 0),S(z,"request")&&a.jsxDEV("span",{className:"px-1 py-0.5 text-[9px] font-bold text-white bg-red-500 rounded",children:"N"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:770,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:764,columnNumber:31},void 0),a.jsxDEV("span",{className:"text-xs text-gray-600 truncate flex-1",children:ut?ut.content||"-":"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:773,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:760,columnNumber:29},void 0)})(),a.jsxDEV("div",{className:"flex space-x-2 pt-1",children:[a.jsxDEV("button",{onClick:()=>k(z),className:"text-xs text-gray-600 hover:text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:781,columnNumber:27},void 0),((r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager")&&a.jsxDEV("button",{onClick:()=>De(z.id,z.name),className:"text-xs text-rose-600 hover:text-rose-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:788,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:780,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:736,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:735,columnNumber:21},void 0)]},z.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:684,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:680,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:657,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:656,columnNumber:9},void 0),d&&a.jsxDEV(m1,{project:h,onClose:()=>{f(!1),y(null)},onSave:Me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:807,columnNumber:9},void 0),T&&O&&a.jsxDEV(d1,{projectName:O.name,meetingNotes:O.meetingNotes||[],onClose:()=>{v(!1),C(null)},onSave:Oe,onDelete:Ke},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:818,columnNumber:9},void 0),V&&O&&a.jsxDEV(f1,{projectName:O.name,customerRequests:O.customerRequests||[],onClose:()=>{R(!1),C(null)},onSave:de,onToggleComplete:Ie,onDelete:bt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:831,columnNumber:9},void 0),L&&O&&a.jsxDEV(p1,{projectName:O.name,entrancePassword:O.entrancePassword||"",sitePassword:O.sitePassword||"",onClose:()=>{q(!1),C(null)},onSave:ae},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:845,columnNumber:9},void 0),oe&&O&&a.jsxDEV(h1,{projectName:O.name,onClose:()=>{te(!1),C(null)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:858,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Projects.tsx",lineNumber:578,columnNumber:5},void 0)};var rd={},sb={exports:{}};(function(s){function e(t){return t&&t.__esModule?t:{default:t}}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(sb);var Qs=sb.exports,id={},nb={exports:{}},rb={exports:{}},ib={exports:{}},ob={exports:{}};(function(s){function e(t){"@babel/helpers - typeof";return s.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(ob);var co=ob.exports,ab={exports:{}};(function(s){var e=co.default;function t(n,r){if(e(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var o=i.call(n,r||"default");if(e(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(ab);var y1=ab.exports;(function(s){var e=co.default,t=y1;function n(r){var i=t(r,"string");return e(i)=="symbol"?i:i+""}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(ib);var lb=ib.exports;(function(s){var e=lb;function t(n,r,i){return(r=e(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(rb);var cb=rb.exports;(function(s){var e=cb;function t(r,i){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),o.push.apply(o,l)}return o}function n(r){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?t(Object(o),!0).forEach(function(l){e(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(nb);var Fr=nb.exports,ub={exports:{}},mb={exports:{}};(function(s){function e(t,n){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(n.indexOf(i)!==-1)continue;r[i]=t[i]}return r}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(mb);var b1=mb.exports;(function(s){var e=b1;function t(n,r){if(n==null)return{};var i,o,l=e(n,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)i=u[o],r.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(l[i]=n[i])}return l}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(ub);var od=ub.exports,db={exports:{}};(function(s){function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(db);var pi=db.exports,fb={exports:{}};(function(s){var e=lb;function t(r,i){for(var o=0;o<i.length;o++){var l=i[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,e(l.key),l)}}function n(r,i,o){return i&&t(r.prototype,i),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(fb);var hi=fb.exports,pb={exports:{}},hb={exports:{}};(function(s){function e(t){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s.exports.__esModule=!0,s.exports.default=s.exports,e(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(hb);var N1=hb.exports,gb={exports:{}};(function(s){function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s.exports=e=function(){return!!t},s.exports.__esModule=!0,s.exports.default=s.exports)()}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(gb);var x1=gb.exports,yb={exports:{}},bb={exports:{}};(function(s){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(bb);var v1=bb.exports;(function(s){var e=co.default,t=v1;function n(r,i){if(i&&(e(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(r)}s.exports=n,s.exports.__esModule=!0,s.exports.default=s.exports})(yb);var _1=yb.exports;(function(s){var e=N1,t=x1,n=_1;function r(i,o,l){return o=e(o),n(i,t()?Reflect.construct(o,l||[],e(i).constructor):o.apply(i,l))}s.exports=r,s.exports.__esModule=!0,s.exports.default=s.exports})(pb);var uo=pb.exports,Nb={exports:{}},xb={exports:{}};(function(s){function e(t,n){return s.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},s.exports.__esModule=!0,s.exports.default=s.exports,e(t,n)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(xb);var D1=xb.exports;(function(s){var e=D1;function t(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&e(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Nb);var mo=Nb.exports;const Ea=da(UN);var Cn={},so={};Object.defineProperty(so,"__esModule",{value:!0});so.views=so.navigate=void 0;so.navigate={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"};so.views={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"};var k1=Qs.default;Object.defineProperty(Cn,"__esModule",{value:!0});Cn.views=Cn.dateRangeFormat=Cn.dateFormat=Cn.accessor=Cn.DayLayoutAlgorithmPropType=void 0;var rn=k1(Gp),Vp=so,wp=Object.keys(Vp.views).map(function(s){return Vp.views[s]});Cn.accessor=rn.default.oneOfType([rn.default.string,rn.default.func]);Cn.dateFormat=rn.default.any;Cn.dateRangeFormat=rn.default.func;Cn.views=rn.default.oneOfType([rn.default.arrayOf(rn.default.oneOf(wp)),rn.default.objectOf(function(s,e){var t=wp.indexOf(e)!==-1&&typeof s[e]=="boolean";if(t)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return rn.default.elementType.apply(rn.default,[s,e].concat(r))})]);Cn.DayLayoutAlgorithmPropType=rn.default.oneOfType([rn.default.oneOf(["overlap","no-overlap"]),rn.default.func]);var fc={},fo={},A1=Qs.default;Object.defineProperty(fo,"__esModule",{value:!0});fo.accessor=vb;fo.wrapAccessor=void 0;var E1=A1(co);function vb(s,e){var t=null;return typeof e=="function"?t=e(s):typeof e=="string"&&(0,E1.default)(s)==="object"&&s!=null&&e in s&&(t=s[e]),t}fo.wrapAccessor=function(e){return function(t){return vb(t,e)}};var gi={},C1=Qs.default;Object.defineProperty(gi,"__esModule",{value:!0});gi.DnDContext=void 0;var V1=C1(A);gi.DnDContext=V1.default.createContext();var yi=Qs.default;Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var w1=yi(Fr),S1=yi(pi),T1=yi(hi),L1=yi(uo),P1=yi(mo),ji=yi(A),Sp=yi(Ea),Tp=fo,I1=gi,_b=function(s){function e(){var t;(0,S1.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,L1.default)(this,e,[].concat(r)),t.handleResizeUp=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","UP")},t.handleResizeDown=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","DOWN")},t.handleResizeLeft=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","LEFT")},t.handleResizeRight=function(o){o.button===0&&t.context.draggable.onBeginAction(t.props.event,"resize","RIGHT")},t.handleStartDragging=function(o){var l;if(o.button===0){var u=(l=o.target.getAttribute("class"))===null||l===void 0?void 0:l.includes("rbc-addons-dnd-resize");if(!u){var m=(0,w1.default)({},t.props.event);m.sourceResource=t.props.resource,t.context.draggable.onBeginAction(t.props.event,"move")}}},t}return(0,P1.default)(e,s),(0,T1.default)(e,[{key:"renderAnchor",value:function(n){var r=n==="Up"||n==="Down"?"ns":"ew";return ji.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-anchor"),onMouseDown:this["handleResize".concat(n)]},ji.default.createElement("div",{className:"rbc-addons-dnd-resize-".concat(r,"-icon")}))}},{key:"render",value:function(){var n=this.props,r=n.event,i=n.type,o=n.continuesPrior,l=n.continuesAfter,u=n.resizable,m=this.props.children;if(r.__isPreview)return ji.default.cloneElement(m,{className:(0,Sp.default)(m.props.className,"rbc-addons-dnd-drag-preview")});var d=this.context.draggable,f=d.draggableAccessor,h=d.resizableAccessor,y=f?!!(0,Tp.accessor)(r,f):!0;if(!y)return m;var T=u&&(h?!!(0,Tp.accessor)(r,h):!0);if(T||y){var v={onMouseDown:this.handleStartDragging,onTouchStart:this.handleStartDragging};if(T){var V=null,R=null;i==="date"?(V=!o&&this.renderAnchor("Left"),R=!l&&this.renderAnchor("Right")):(V=!o&&this.renderAnchor("Up"),R=!l&&this.renderAnchor("Down")),v.children=ji.default.createElement("div",{className:"rbc-addons-dnd-resizable"},V,m.props.children,R)}d.dragAndDropAction.interacting&&d.dragAndDropAction.event===r&&(v.className=(0,Sp.default)(m.props.className,"rbc-addons-dnd-dragged-event")),m=ji.default.cloneElement(m,v)}return m}}])}(ji.default.Component);_b.contextType=I1.DnDContext;fc.default=_b;var pc={},Db={exports:{}};(function(s){var e=co.default;function t(n,r){if(typeof WeakMap=="function")var i=new WeakMap,o=new WeakMap;return(s.exports=t=function(u,m){if(!m&&u&&u.__esModule)return u;var d,f,h={__proto__:null,default:u};if(u===null||e(u)!="object"&&typeof u!="function")return h;if(d=m?o:i){if(d.has(u))return d.get(u);d.set(u,h)}for(var y in u)y!=="default"&&{}.hasOwnProperty.call(u,y)&&((f=(d=Object.defineProperty)&&Object.getOwnPropertyDescriptor(u,y))&&(f.get||f.set)?d(h,y,f):h[y]=u[y]);return h},s.exports.__esModule=!0,s.exports.default=s.exports)(n,r)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Db);var kb=Db.exports;function ad(s,e,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!0),s){var r=document.createEvent("HTMLEvents");r.initEvent(e,t,n),s.dispatchEvent(r)}}function j1(s){var e=kn(s,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function R1(s,e,t){t===void 0&&(t=5);var n=!1,r=setTimeout(function(){n||ad(s,"transitionend",!0)},e+t),i=Hl(s,"transitionend",function(){n=!0},{once:!0});return function(){clearTimeout(r),i()}}function ld(s,e,t,n){t==null&&(t=j1(s)||0);var r=R1(s,t,n),i=Hl(s,"transitionend",e);return function(){r(),i()}}var Lp={transition:"","transition-duration":"","transition-delay":"","transition-timing-function":""};function Pp(s){var e=s.node,t=s.properties,n=s.duration,r=n===void 0?200:n,i=s.easing,o=s.callback,l=[],u={},m="";Object.keys(t).forEach(function(h){var y=t[h];HN(h)?m+=h+"("+y+") ":(u[h]=y,l.push(MN(h)))}),m&&(u.transform=m,l.push("transform"));function d(h){h.target===h.currentTarget&&(kn(e,Lp),o&&o.call(this,h))}r>0&&(u.transition=l.join(", "),u["transition-duration"]=r/1e3+"s",u["transition-delay"]="0s",u["transition-timing-function"]=i||"linear");var f=ld(e,d,r);return e.clientLeft,kn(e,u),{cancel:function(){f(),kn(e,Lp)}}}function Ab(s,e,t,n,r){if(!("nodeType"in s))return Pp(s);if(!e)throw new Error("must include properties to animate");return typeof n=="function"&&(r=n,n=""),Pp({node:s,properties:e,duration:t,easing:n,callback:r})}function Eb(s,e,t){if(s){if(typeof t>"u")return s.getAttribute(e);!t&&t!==""?s.removeAttribute(e):s.setAttribute(e,String(t))}}function Cb(s){return s?Array.from(s.children):[]}function Vb(s){if(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}return null}var B1=Function.prototype.bind.call(Function.prototype.call,[].slice);function wb(s){return s?B1(s.childNodes):[]}function Sb(s,e){return function(n){var r=n.currentTarget,i=n.target,o=zu(r,s);o.some(function(l){return Ku(l,i)})&&e.call(this,n)}}function Tb(s,e){return s&&e&&e.parentNode?(e.nextSibling?e.parentNode.insertBefore(s,e.nextSibling):e.parentNode.appendChild(s),s):null}var U1=/^(?:input|select|textarea|button)$/i;function Lb(s){return s?U1.test(s.nodeName):!1}function Pb(s){return s?!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length):!1}function Ib(s,e,t){e===void 0&&(e=null),t===void 0&&(t=null);for(var n=[];s;s=s.nextElementSibling)if(s!==e){if(t&&Qu(s,t))break;n.push(s)}return n}function jb(s,e){return Ib(s,s,e)}function H1(s,e){var t=null,n=[];for(t=s?s[e]:null;t&&t.nodeType!==9;)n.push(t),t=t[e]||null;return n}function Rb(s){return H1(s,"parentElement")}function Bb(s,e){return s&&e?(e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s),s):null}function Ub(s){return s&&s.parentNode?(s.parentNode.removeChild(s),s):null}function cd(s,e){var t=kn(s,"position"),n=t==="absolute",r=s.ownerDocument;if(t==="fixed")return r||document;for(;(s=s.parentNode)&&!ON(s);){var i=n&&kn(s,"position")==="static",o=(kn(s,"overflow")||"")+(kn(s,"overflow-y")||"")+kn(s,"overflow-x");if(!i&&/(auto|scroll)/.test(o)&&(e||Ml(s)<s.scrollHeight))return s}return r||document}function Hb(s,e){var t=yl(s),n={top:0,left:0};if(s){var r=e||cd(s),i=FN(r),o=bl(r),l=Ml(r,!0);i||(n=yl(r)),t={top:t.top-n.top,left:t.left-n.left,height:t.height,width:t.width};var u=t.height,m=t.top+(i?0:o),d=m+u;o=o>m?m:d>o+l?d-l:o;var f=Yu(function(){return bl(r,o)});return function(){return Gu(f)}}}function Mb(s){return Ib(s&&s.parentElement?s.parentElement.firstElementChild:null,s)}var M1=/&nbsp;/gi,O1=/\xA0/g,F1=/\s+([^\s])/gm;function Ob(s,e,t){e===void 0&&(e=!0),t===void 0&&(t=!0);var n="";return s&&(n=(s.textContent||"").replace(M1," ").replace(O1," "),e&&(n=n.trim()),t&&(n=n.replace(F1," $1"))),n}function Fb(s,e){s.classList?s.classList.toggle(e):Xu(s,e)?Ju(s,e):Zu(s,e)}const q1={addEventListener:lh,removeEventListener:ah,triggerEvent:ad,animate:Ab,filter:Sb,listen:Hl,style:kn,getComputedStyle:oh,attribute:Eb,activeElement:ih,ownerDocument:rh,ownerWindow:nh,requestAnimationFrame:Yu,cancelAnimationFrame:Gu,matches:Qu,height:Ml,width:sh,offset:yl,offsetParent:th,position:eh,contains:Ku,scrollbarSize:Zp,scrollLeft:Jp,scrollParent:cd,scrollTo:Hb,scrollTop:bl,querySelectorAll:zu,closest:Xp,addClass:Zu,removeClass:Ju,hasClass:Xu,toggleClass:Fb,transitionEnd:ld,childNodes:wb,childElements:Cb,nextUntil:jb,parents:Rb,siblings:Mb,clear:Vb,insertAfter:Tb,isInput:Lb,isVisible:Pb,prepend:Bb,remove:Ub,text:Ob},$1=Object.freeze(Object.defineProperty({__proto__:null,activeElement:ih,addClass:Zu,addEventListener:lh,animate:Ab,attribute:Eb,cancelAnimationFrame:Gu,childElements:Cb,childNodes:wb,clear:Vb,closest:Xp,contains:Ku,default:q1,filter:Sb,getComputedStyle:oh,hasClass:Xu,height:Ml,insertAfter:Tb,isInput:Lb,isVisible:Pb,listen:Hl,matches:Qu,nextUntil:jb,offset:yl,offsetParent:th,ownerDocument:rh,ownerWindow:nh,parents:Rb,position:eh,prepend:Bb,querySelectorAll:zu,remove:Ub,removeClass:Ju,removeEventListener:ah,requestAnimationFrame:Yu,scrollLeft:Jp,scrollParent:cd,scrollTo:Hb,scrollTop:bl,scrollbarSize:Zp,siblings:Mb,style:kn,text:Ob,toggleClass:Fb,transitionEnd:ld,triggerEvent:ad,width:sh},Symbol.toStringTag,{value:"Module"})),W1=da($1);var Ou={exports:{}};(function(s,e){e.__esModule=!0,e.default=n;var t=Function.prototype.bind.call(Function.prototype.call,[].slice);function n(r,i){return t(r.querySelectorAll(i))}s.exports=e.default})(Ou,Ou.exports);var z1=Ou.exports,wn={};const K1=da(qN),Q1=da($N),Y1=da(WN);var po=Qs.default;Object.defineProperty(wn,"__esModule",{value:!0});wn.default=void 0;wn.getBoundsForNode=ma;wn.getEventNodeFromPoint=$b;wn.getShowMoreNodeFromPoint=Wb;wn.isEvent=tV;wn.isShowMore=sV;wn.objectsCollide=qu;var G1=po(co),X1=po(pi),J1=po(hi),Fu=po(K1),qb=po(Q1),Z1=po(Y1);function Ws(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return(0,Z1.default)(t,s,e,{passive:!1})}function eV(s,e,t){return!s||(0,Fu.default)(s,document.elementFromPoint(e,t))}function $b(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,qb.default)(r,".rbc-event",s)}function Wb(s,e){var t=e.clientX,n=e.clientY,r=document.elementFromPoint(t,n);return(0,qb.default)(r,".rbc-show-more",s)}function tV(s,e){return!!$b(s,e)}function sV(s,e){return!!Wb(s,e)}function Lo(s){var e=s;return s.touches&&s.touches.length&&(e=s.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var Ip=5,nV=250,rV=function(){function s(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.global,r=n===void 0?!1:n,i=t.longPressThreshold,o=i===void 0?250:i,l=t.validContainers,u=l===void 0?[]:l;(0,X1.default)(this,s),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||r,this.longPressThreshold=o,this.validContainers=u,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Ws("touchmove",function(){},window),this._removeKeyDownListener=Ws("keydown",this._keyListener),this._removeKeyUpListener=Ws("keyup",this._keyListener),this._removeDropFromOutsideListener=Ws("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Ws("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return(0,J1.default)(s,[{key:"on",value:function(t,n){var r=this._listeners[t]||(this._listeners[t]=[]);return r.push(n),{remove:function(){var o=r.indexOf(n);o!==-1&&r.splice(o,1)}}}},{key:"emit",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o,l=this._listeners[t]||[];return l.forEach(function(u){o===void 0&&(o=u.apply(void 0,r))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var n=this._selectRect;return!n||!this.selecting?!1:qu(n,ma(t))}},{key:"filter",value:function(t){var n=this._selectRect;return!n||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,n){var r=this,i=null,o=null,l=null,u=function(h){i=setTimeout(function(){d(),t(h)},r.longPressThreshold),o=Ws("touchmove",function(){return d()}),l=Ws("touchend",function(){return d()})},m=Ws("touchstart",u),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&u(n),function(){d(),m()}}},{key:"_addInitialEventListener",value:function(){var t=this,n=Ws("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Ws("mousedown",t._handleInitialEvent)}),r=Ws("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),r()}}},{key:"_dropFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:r,y:i,clientX:o,clientY:l}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var n=Lo(t),r=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,u=this.container(),m,d;if(!(t.which===3||t.button===2||!eV(u,r,i))){if(!this.globalMouse&&u&&!(0,Fu.default)(u,t.target)){var f=iV(0),h=f.top,y=f.left,T=f.bottom,v=f.right;if(d=ma(u),m=qu({top:d.top-h,left:d.left-y,bottom:d.bottom+T,right:d.right+v},{top:l,left:o}),!m)return}var V=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:o,y:l,clientX:r,clientY:i});if(V!==!1)switch(t.type){case"mousedown":this._removeEndListener=Ws("mouseup",this._handleTerminatingEvent),this._onEscListener=Ws("keydown",this._handleTerminatingEvent),this._removeMoveListener=Ws("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Ws("touchend",this._handleTerminatingEvent),this._removeMoveListener=Ws("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var n=t.target,r=this.validContainers;return!r||!r.length||!n?!0:r.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var n=this.selecting,r=this._selectRect;if(!n&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||(0,Fu.default)(this.container(),t.target),o=this._isWithinValidContainer(t);return t.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(t):n?this.emit("select",r):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var n=Lo(t),r=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,u=new Date().getTime();return this._lastClickData&&u-this._lastClickData.timestamp<nV?(this._lastClickData=null,this.emit("doubleClick",{x:r,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:u},this.emit("click",{x:r,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,r=n.x,i=n.y,o=Lo(t),l=o.pageX,u=o.pageY,m=Math.abs(r-l),d=Math.abs(i-u),f=Math.min(l,r),h=Math.min(u,i),y=this.selecting,T=this.isClick(l,u);T&&!y&&!(m||d)||(!y&&!T&&this.emit("selectStart",this._initialEventData),T||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:u,right:f+m,bottom:h+d},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,n){var r=this._initialEventData,i=r.x,o=r.y,l=r.isTouch;return!l&&Math.abs(t-i)<=Ip&&Math.abs(n-o)<=Ip}}])}();function iV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(0,G1.default)(s)!=="object"&&(s={top:s,left:s,right:s,bottom:s}),s}function qu(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=ma(s),r=n.top,i=n.left,o=n.right,l=o===void 0?i:o,u=n.bottom,m=u===void 0?r:u,d=ma(e),f=d.top,h=d.left,y=d.right,T=y===void 0?h:y,v=d.bottom,V=v===void 0?f:v;return!(m-t<f||r+t>V||l-t<h||i+t>T)}function ma(s){if(!s.getBoundingClientRect)return s;var e=s.getBoundingClientRect(),t=e.left+jp("left"),n=e.top+jp("top");return{top:n,left:t,right:(s.offsetWidth||0)+t,bottom:(s.offsetHeight||0)+n}}function jp(s){if(s==="left")return window.pageXOffset||document.body.scrollLeft||0;if(s==="top")return window.pageYOffset||document.body.scrollTop||0}wn.default=rV;var hc={},gc=Qs.default;Object.defineProperty(hc,"__esModule",{value:!0});hc.default=void 0;var oV=gc(cb),Rp=gc(Fr),aV=gc(Ea),Po=gc(A);function Ga(s){return typeof s=="string"?s:s+"%"}function lV(s){var e=s.style,t=s.className,n=s.event,r=s.accessors,i=s.rtl,o=s.selected,l=s.label,u=s.continuesPrior,m=s.continuesAfter,d=s.getters,f=s.onClick,h=s.onDoubleClick,y=s.isBackgroundEvent,T=s.onKeyPress,v=s.components,V=v.event,R=v.eventWrapper,L=r.title(n),q=r.tooltip(n),oe=r.end(n),te=r.start(n),O=d.eventProp(n,te,oe,o),C=[Po.default.createElement("div",{key:"1",className:"rbc-event-label"},l),Po.default.createElement("div",{key:"2",className:"rbc-event-content"},V?Po.default.createElement(V,{event:n,title:L}):L)],N=e.height,E=e.top,j=e.width,S=e.xOffset,w=(0,Rp.default)((0,Rp.default)({},O.style),{},(0,oV.default)({top:Ga(E),height:Ga(N),width:Ga(j)},i?"right":"left",Ga(S)));return Po.default.createElement(R,Object.assign({type:"time"},s),Po.default.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:w,onKeyDown:T,title:q?(typeof l=="string"?l+": ":"")+q:void 0,className:(0,aV.default)(y?"rbc-background-event":"rbc-event",t,O.className,{"rbc-selected":o,"rbc-event-continues-earlier":u,"rbc-event-continues-later":m})},C))}hc.default=lV;var ir={},zb=Qs.default;Object.defineProperty(ir,"__esModule",{value:!0});ir.dragAccessors=void 0;ir.eventTimes=gV;ir.mergeComponents=pV;ir.pointInColumn=hV;var cV=zb(Fr),uV=zb(od),Bp=fo,mV=A,dV=["children"];ir.dragAccessors={start:(0,Bp.wrapAccessor)(function(s){return s.start}),end:(0,Bp.wrapAccessor)(function(s){return s.end})};function fV(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];var n=function(i){var o=i.children,l=(0,uV.default)(i,dV);return e.filter(Boolean).reduceRight(function(u,m){return(0,mV.createElement)(m,l,u)},o)};return n}function pV(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,t=Object.keys(e),n=(0,cV.default)({},s);return t.forEach(function(r){n[r]=s[r]?fV(s[r],e[r]):e[r]}),n}function hV(s,e){var t=s.left,n=s.right,r=s.top,i=e.x,o=e.y;return i<n+10&&i>t&&o>r}function gV(s,e,t){var n=e.start(s),r=e.end(s),i=t.eq(n,r,"minutes")&&t.diff(n,r,"minutes")===0;i&&(r=t.add(r,1,"day"));var o=t.diff(n,r,"milliseconds");return{start:n,end:r,duration:o}}var yV=kb.default,qr=Qs.default;Object.defineProperty(pc,"__esModule",{value:!0});pc.default=void 0;var pr=qr(Fr),bV=qr(pi),NV=qr(hi),xV=qr(uo),vV=qr(mo),Jc=W1,_V=qr(z1),Xr=qr(A),DV=gi,hr=yV(wn),kV=qr(hc),Gn=ir,Kb=function(s){function e(){var t;(0,bV.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,xV.default)(this,e,[].concat(r)),t.handleMove=function(o,l){if(!(0,Gn.pointInColumn)(l,o))return t.reset();var u=t.context.draggable.dragAndDropAction.event,m=t.props,d=m.accessors,f=m.slotMetrics,h=f.closestSlotFromPoint({y:o.y-t.eventOffsetTop,x:o.x},l),y=(0,Gn.eventTimes)(u,d,t.props.localizer),T=y.duration,v=t.props.localizer.add(h,T,"milliseconds");t.update(u,f.getRange(h,v,!1,!0))},t.handleDropFromOutside=function(o,l){var u=t.props,m=u.slotMetrics,d=u.resource,f=m.closestSlotFromPoint({y:o.y,x:o.x},l),h=t._calculateDnDEnd(f);t.context.draggable.onDropFromOutside({start:f,end:h,allDay:!1,resource:d}),t.reset()},t.handleDragOverFromOutside=function(o,l){var u=t.props.slotMetrics,m=u.closestSlotFromPoint({y:o.y,x:o.x},l),d=t._calculateDnDEnd(m),f=t.context.draggable.dragFromOutsideItem();t.update(f,u.getRange(m,d,!1,!0))},t._calculateDnDEnd=function(o){var l=t.props,u=l.accessors,m=l.slotMetrics,d=l.localizer,f=t.context.draggable.dragFromOutsideItem(),h=(0,Gn.eventTimes)(f,u,d),y=h.duration,T=m.nextSlot(o),v=!isNaN(y);if(v){var V=d.add(o,y,"milliseconds");T=new Date(Math.max(V,T))}return T},t.updateParentScroll=function(o,l){setTimeout(function(){var u=(0,_V.default)(l,".rbc-addons-dnd-drag-preview")[0];u&&(u.offsetTop<o.scrollTop?(0,Jc.scrollTop)(o,Math.max(u.offsetTop,0)):u.offsetTop+u.offsetHeight>o.scrollTop+o.clientHeight&&(0,Jc.scrollTop)(o,Math.min(u.offsetTop-o.offsetHeight+u.offsetHeight,o.scrollHeight)))})},t._selectable=function(){var o=t.ref.current,l=o.children[0],u=!1,m=t._selector=new hr.default(function(){return o.closest(".rbc-time-view")}),d=(0,Jc.scrollParent)(o);m.on("beforeSelect",function(f){var h=t.context.draggable.dragAndDropAction;if(!h.action)return!1;if(h.action==="resize")return(0,Gn.pointInColumn)((0,hr.getBoundsForNode)(l),f);var y=(0,hr.getEventNodeFromPoint)(l,f);if(!y)return!1;t.eventOffsetTop=f.y-(0,hr.getBoundsForNode)(y).top}),m.on("selecting",function(f){var h=(0,hr.getBoundsForNode)(l),y=t.context.draggable.dragAndDropAction;y.action==="move"&&(t.updateParentScroll(d,l),t.handleMove(f,h)),y.action==="resize"&&(t.updateParentScroll(d,l),t.handleResize(f,h))}),m.on("dropFromOutside",function(f){if(t.context.draggable.onDropFromOutside){var h=(0,hr.getBoundsForNode)(l);(0,Gn.pointInColumn)(h,f)&&t.handleDropFromOutside(f,h)}}),m.on("dragOverFromOutside",function(f){var h=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;if(h){var y=(0,hr.getBoundsForNode)(l);if(!(0,Gn.pointInColumn)(y,f))return t.reset();t.handleDragOverFromOutside(f,y)}}),m.on("selectStart",function(){u=!0,t.context.draggable.onStart()}),m.on("select",function(f){var h=(0,hr.getBoundsForNode)(l);u=!1;var y=t.context.draggable.dragAndDropAction;if(y.action==="resize")t.handleInteractionEnd();else{if(!t.state.event||!(0,Gn.pointInColumn)(h,f))return;t.handleInteractionEnd()}}),m.on("click",function(){u&&t.reset(),t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props.resource,l=t.state.event;t.reset(),t.context.draggable.onEnd({start:l.start,end:l.end,resourceId:o})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Xr.default.createRef(),t}return(0,vV.default)(e,s),(0,NV.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.event&&this.setState({event:null,top:null,height:null})}},{key:"update",value:function(n,r){var i=r.startDate,o=r.endDate,l=r.top,u=r.height,m=this.state.event;m&&i===m.start&&o===m.end||this.setState({top:l,height:u,event:(0,pr.default)((0,pr.default)({},n),{},{start:i,end:o})})}},{key:"handleResize",value:function(n,r){var i=this.props,o=i.accessors,l=i.slotMetrics,u=i.localizer,m=this.context.draggable.dragAndDropAction,d=m.event,f=m.direction,h=l.closestSlotFromPoint(n,r),y=(0,Gn.eventTimes)(d,o,u),T=y.start,v=y.end,V;if(f==="UP"){var R=u.min(h,l.closestSlotFromDate(v,-1));V=l.getRange(R,v),V=(0,pr.default)((0,pr.default)({},V),{},{endDate:v})}else if(f==="DOWN"){var L=u.max(h,l.closestSlotFromDate(T));V=l.getRange(T,L),V=(0,pr.default)((0,pr.default)({},V),{},{startDate:T})}this.update(d,V)}},{key:"renderContent",value:function(){var n=this.props,r=n.children,i=n.accessors,o=n.components,l=n.getters,u=n.slotMetrics,m=n.localizer,d=this.state,f=d.event,h=d.top,y=d.height;if(!f)return r;var T=r.props.children,v=f.start,V=f.end,R,L="eventTimeRangeFormat",q=u.startsBeforeDay(v),oe=u.startsAfterDay(V);return q?L="eventTimeRangeEndFormat":oe&&(L="eventTimeRangeStartFormat"),q&&oe?R=m.messages.allDay:R=m.format({start:v,end:V},L),Xr.default.cloneElement(r,{children:Xr.default.createElement(Xr.default.Fragment,null,T,f&&Xr.default.createElement(kV.default,{event:f,label:R,className:"rbc-addons-dnd-drag-preview",style:{top:h,height:y,width:100},getters:l,components:o,accessors:(0,pr.default)((0,pr.default)({},i),Gn.dragAccessors),continuesPrior:q,continuesAfter:oe}))})}},{key:"render",value:function(){return Xr.default.createElement("div",{ref:this.ref},this.renderContent())}}])}(Xr.default.Component);Kb.contextType=DV.DnDContext;pc.default=Kb;var yc={},Qb={exports:{}},Yb={exports:{}},Gb={exports:{}};(function(s){function e(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Gb);var Xb=Gb.exports;(function(s){var e=Xb;function t(n){if(Array.isArray(n))return e(n)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Yb);var AV=Yb.exports,Jb={exports:{}};(function(s){function e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(Jb);var EV=Jb.exports,Zb={exports:{}};(function(s){var e=Xb;function t(n,r){if(n){if(typeof n=="string")return e(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,r):void 0}}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(Zb);var CV=Zb.exports,eN={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.__esModule=!0,s.exports.default=s.exports})(eN);var VV=eN.exports;(function(s){var e=AV,t=EV,n=CV,r=VV;function i(o){return e(o)||t(o)||n(o)||r()}s.exports=i,s.exports.__esModule=!0,s.exports.default=s.exports})(Qb);var tN=Qb.exports,bc={},Nc={},xc={},$r=Qs.default;Object.defineProperty(xc,"__esModule",{value:!0});xc.default=void 0;var Up=$r(Fr),wV=$r(od),SV=$r(pi),TV=$r(hi),LV=$r(uo),PV=$r(mo),Io=$r(A),IV=$r(Ea),jV=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],RV=function(s){function e(){return(0,SV.default)(this,e),(0,LV.default)(this,e,arguments)}return(0,PV.default)(e,s),(0,TV.default)(e,[{key:"render",value:function(){var n=this.props,r=n.style,i=n.className,o=n.event,l=n.selected,u=n.isAllDay,m=n.onSelect,d=n.onDoubleClick,f=n.onKeyPress,h=n.localizer,y=n.continuesPrior,T=n.continuesAfter,v=n.accessors,V=n.getters,R=n.children,L=n.components,q=L.event,oe=L.eventWrapper,te=n.slotStart,O=n.slotEnd,C=(0,wV.default)(n,jV);delete C.resizable;var N=v.title(o),E=v.tooltip(o),j=v.end(o),S=v.start(o),w=v.allDay(o),k=u||w||h.diff(S,h.ceil(j,"day"),"day")>1,De=V.eventProp(o,S,j,l),Me=Io.default.createElement("div",{className:"rbc-event-content",title:E||void 0},q?Io.default.createElement(q,{event:o,continuesPrior:y,continuesAfter:T,title:N,isAllDay:w,localizer:h,slotStart:te,slotEnd:O}):N);return Io.default.createElement(oe,Object.assign({},this.props,{type:"date"}),Io.default.createElement("div",Object.assign({},C,{style:(0,Up.default)((0,Up.default)({},De.style),r),className:(0,IV.default)("rbc-event",i,De.className,{"rbc-selected":l,"rbc-event-allday":k,"rbc-event-continues-prior":y,"rbc-event-continues-after":T}),onClick:function(Re){return m&&m(o,Re)},onDoubleClick:function(Re){return d&&d(o,Re)},onKeyDown:function(Re){return f&&f(o,Re)}}),typeof R=="function"?R(Me):Me))}}])}(Io.default.Component);xc.default=RV;var Wr={},BV=Qs.default;Object.defineProperty(Wr,"__esModule",{value:!0});Wr.dateCellSelection=OV;Wr.getSlotAtX=sN;Wr.isSelected=HV;Wr.pointInBox=MV;Wr.slotWidth=ud;var UV=BV(zN);function HV(s,e){return!s||e==null?!1:(0,UV.default)(s,e)}function ud(s,e){var t=s.right-s.left,n=t/e;return n}function sN(s,e,t,n){var r=ud(s,n);return t?n-1-Math.floor((e-s.left)/r):Math.floor((e-s.left)/r)}function MV(s,e){var t=e.x,n=e.y;return n>=s.top&&n<=s.bottom&&t>=s.left&&t<=s.right}function OV(s,e,t,n,r){var i=-1,o=-1,l=n-1,u=ud(e,n),m=sN(e,t.x,r,n),d=e.top<t.y&&e.bottom>t.y,f=e.top<s.y&&e.bottom>s.y,h=s.y>e.bottom,y=e.top>s.y,T=t.top<e.top&&t.bottom>e.bottom;return T&&(i=0,o=l),d&&(y?(i=0,o=m):h&&(i=m,o=l)),f&&(i=o=r?l-Math.floor((s.x-e.left)/u):Math.floor((s.x-e.left)/u),d?m<i?i=m:o=m:s.y<t.y?o=l:i=0),{startIdx:i,endIdx:o}}var md=Qs.default;Object.defineProperty(Nc,"__esModule",{value:!0});Nc.default=void 0;var In=md(Gp),Hp=md(A),FV=md(xc),qV=Wr;Nc.default={propTypes:{slotMetrics:In.default.object.isRequired,selected:In.default.object,isAllDay:In.default.bool,accessors:In.default.object.isRequired,localizer:In.default.object.isRequired,components:In.default.object.isRequired,getters:In.default.object.isRequired,onSelect:In.default.func,onDoubleClick:In.default.func,onKeyPress:In.default.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var n=e.selected;e.isAllDay;var r=e.accessors,i=e.getters,o=e.onSelect,l=e.onDoubleClick,u=e.onKeyPress,m=e.localizer,d=e.slotMetrics,f=e.components,h=e.resizable,y=d.continuesPrior(t),T=d.continuesAfter(t);return Hp.default.createElement(FV.default,{event:t,getters:i,localizer:m,accessors:r,components:f,onSelect:o,onDoubleClick:l,onKeyPress:u,continuesPrior:y,continuesAfter:T,slotStart:d.first,slotEnd:d.last,selected:(0,qV.isSelected)(t,n),resizable:h})},renderSpan:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return Hp.default.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},r)}};var zr=Qs.default;Object.defineProperty(bc,"__esModule",{value:!0});bc.default=void 0;var $V=zr(Fr),WV=zr(pi),zV=zr(hi),KV=zr(uo),QV=zr(mo),YV=zr(Ea),Mp=zr(A),gl=zr(Nc),nN=function(s){function e(){return(0,WV.default)(this,e),(0,KV.default)(this,e,arguments)}return(0,QV.default)(e,s),(0,zV.default)(e,[{key:"render",value:function(){var n=this,r=this.props,i=r.segments,o=r.slotMetrics.slots,l=r.className,u=1;return Mp.default.createElement("div",{className:(0,YV.default)(l,"rbc-row")},i.reduce(function(m,d,f){var h=d.event,y=d.left,T=d.right,v=d.span,V="_lvl_"+f,R=y-u,L=gl.default.renderEvent(n.props,h);return R&&m.push(gl.default.renderSpan(o,R,"".concat(V,"_gap"))),m.push(gl.default.renderSpan(o,v,V,L)),u=T+1,m},[]))}}])}(Mp.default.Component);nN.defaultProps=(0,$V.default)({},gl.default.defaultProps);bc.default=nN;var or={},rN=Qs.default;Object.defineProperty(or,"__esModule",{value:!0});or.endOfRange=iN;or.eventLevels=JV;or.eventSegments=XV;or.inRange=ZV;or.segsOverlap=oN;or.sortEvents=$u;or.sortWeekEvents=ew;var Zc=rN(tN),GV=rN(KN);function iN(s){var e=s.dateRange,t=s.unit,n=t===void 0?"day":t,r=s.localizer;return{first:e[0],last:r.add(e[e.length-1],1,n)}}function XV(s,e,t,n){var r=iN({dateRange:e,localizer:n}),i=r.first,o=r.last,l=n.diff(i,o,"day"),u=n.max(n.startOf(t.start(s),"day"),i),m=n.min(n.ceil(t.end(s),"day"),o),d=(0,GV.default)(e,function(h){return n.isSameDate(h,u)}),f=n.diff(u,m,"day");return f=Math.min(f,l),f=Math.max(f-n.segmentOffset,1),{event:s,span:f,left:d+1,right:Math.max(d+f,1)}}function JV(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,n,r,i=[],o=[];for(t=0;t<s.length;t++){for(r=s[t],n=0;n<i.length&&oN(r,i[n]);n++);n>=e?o.push(r):(i[n]||(i[n]=[])).push(r)}for(t=0;t<i.length;t++)i[t].sort(function(l,u){return l.left-u.left});return{levels:i,extra:o}}function ZV(s,e,t,n,r){var i={start:n.start(s),end:n.end(s)},o={start:e,end:t};return r.inEventRange({event:i,range:o})}function oN(s,e){return e.some(function(t){return t.left<=s.right&&t.right>=s.left})}function ew(s,e,t){var n=(0,Zc.default)(s),r=[],i=[];n.forEach(function(u){var m=e.start(u),d=e.end(u);t.daySpan(m,d)>1?r.push(u):i.push(u)});var o=r.sort(function(u,m){return $u(u,m,e,t)}),l=i.sort(function(u,m){return $u(u,m,e,t)});return[].concat((0,Zc.default)(o),(0,Zc.default)(l))}function $u(s,e,t,n){var r={start:t.start(s),end:t.end(s),allDay:t.allDay(s)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return n.sortEvents({evtA:r,evtB:i})}var tw=kb.default,Kr=Qs.default;Object.defineProperty(yc,"__esModule",{value:!0});yc.default=void 0;var Xa=Kr(Fr),sw=Kr(tN),nw=Kr(pi),rw=Kr(hi),iw=Kr(uo),ow=Kr(mo),Ja=Kr(A),aw=Kr(bc),Ri=tw(wn),lw=or,gr=Wr,Za=ir,cw=gi,aN=function(s){function e(){var t;(0,nw.default)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=(0,iw.default)(this,e,[].concat(r)),t.handleMove=function(o,l,u){if(!(0,gr.pointInBox)(l,o))return t.reset();var m=t.context.draggable.dragAndDropAction.event||u,d=t.props,f=d.accessors,h=d.slotMetrics,y=d.rtl,T=d.localizer,v=(0,gr.getSlotAtX)(l,o.x,y,h.slots),V=h.getDateForSlot(v),R=(0,Za.eventTimes)(m,f,T),L=R.start,q=R.duration;L=T.merge(V,L);var oe=T.add(L,q,"milliseconds");t.update(m,L,oe)},t.handleDropFromOutside=function(o,l){if(t.context.draggable.onDropFromOutside){var u=t.props,m=u.slotMetrics,d=u.rtl,f=u.localizer,h=(0,gr.getSlotAtX)(l,o.x,d,m.slots),y=m.getDateForSlot(h);t.context.draggable.onDropFromOutside({start:y,end:f.add(y,1,"day"),allDay:!1})}},t.handleDragOverFromOutside=function(o,l){var u=t.context.draggable.dragFromOutsideItem?t.context.draggable.dragFromOutsideItem():null;u&&t.handleMove(o,l,u)},t._selectable=function(){var o=t.ref.current.closest(".rbc-month-row, .rbc-allday-cell"),l=o.closest(".rbc-month-view, .rbc-time-view"),u=o.classList.contains("rbc-month-row"),m=t._selector=new Ri.default(function(){return l},{validContainers:(0,sw.default)(u?[]:[".rbc-day-slot",".rbc-allday-cell"])});m.on("beforeSelect",function(d){var f=t.props.isAllDay,h=t.context.draggable.dragAndDropAction.action,y=(0,Ri.getBoundsForNode)(o),T=(0,gr.pointInBox)(y,d);return h==="move"||h==="resize"&&(!f||T)}),m.on("selecting",function(d){var f=(0,Ri.getBoundsForNode)(o),h=t.context.draggable.dragAndDropAction;h.action==="move"&&t.handleMove(d,f),h.action==="resize"&&t.handleResize(d,f)}),m.on("selectStart",function(){return t.context.draggable.onStart()}),m.on("select",function(d){var f=(0,Ri.getBoundsForNode)(o);t.state.segment&&((0,gr.pointInBox)(f,d)?t.handleInteractionEnd():t.reset())}),m.on("dropFromOutside",function(d){if(t.context.draggable.onDropFromOutside){var f=(0,Ri.getBoundsForNode)(o);(0,gr.pointInBox)(f,d)&&t.handleDropFromOutside(d,f)}}),m.on("dragOverFromOutside",function(d){if(t.context.draggable.dragFromOutsideItem){var f=(0,Ri.getBoundsForNode)(o);t.handleDragOverFromOutside(d,f)}}),m.on("click",function(){return t.context.draggable.onEnd(null)}),m.on("reset",function(){t.reset(),t.context.draggable.onEnd(null)})},t.handleInteractionEnd=function(){var o=t.props,l=o.resourceId,u=o.isAllDay,m=t.state.segment.event;t.reset(),t.context.draggable.onEnd({start:m.start,end:m.end,resourceId:l,isAllDay:u})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t.state={},t.ref=Ja.default.createRef(),t}return(0,ow.default)(e,s),(0,rw.default)(e,[{key:"componentDidMount",value:function(){this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"reset",value:function(){this.state.segment&&this.setState({segment:null})}},{key:"update",value:function(n,r,i){var o=(0,lw.eventSegments)((0,Xa.default)((0,Xa.default)({},n),{},{end:i,start:r,__isPreview:!0}),this.props.slotMetrics.range,Za.dragAccessors,this.props.localizer),l=this.state.segment;l&&o.span===l.span&&o.left===l.left&&o.right===l.right||this.setState({segment:o})}},{key:"handleResize",value:function(n,r){var i=this.context.draggable.dragAndDropAction,o=i.event,l=i.direction,u=this.props,m=u.accessors,d=u.slotMetrics,f=u.rtl,h=u.localizer,y=(0,Za.eventTimes)(o,m,h),T=y.start,v=y.end,V=(0,gr.getSlotAtX)(r,n.x,f,d.slots),R=d.getDateForSlot(V),L=(0,gr.pointInBox)(r,n);if(l==="RIGHT"){if(L){if(d.last<T)return this.reset();h.eq(h.startOf(v,"day"),v)?v=h.add(R,1,"day"):v=R}else if(h.inRange(T,d.first,d.last)||r.bottom<n.y&&+d.first>+T)v=h.add(d.last,1,"milliseconds");else{this.setState({segment:null});return}var q=m.end(o);v=h.merge(v,q),h.lt(v,T)&&(v=q)}else if(l==="LEFT"){if(L){if(d.first>v)return this.reset();T=R}else if(h.inRange(v,d.first,d.last)||r.top>n.y&&h.lt(d.last,v))T=h.add(d.first,-1,"milliseconds");else{this.reset();return}var oe=m.start(o);T=h.merge(T,oe),h.gt(T,v)&&(T=oe)}this.update(o,T,v)}},{key:"render",value:function(){var n=this.props,r=n.children,i=n.accessors,o=this.state.segment;return Ja.default.createElement("div",{ref:this.ref,className:"rbc-addons-dnd-row-body"},r,o&&Ja.default.createElement(aw.default,Object.assign({},this.props,{selected:null,className:"rbc-addons-dnd-drag-row",segments:[o],accessors:(0,Xa.default)((0,Xa.default)({},i),Za.dragAccessors)})))}}])}(Ja.default.Component);aN.contextType=cw.DnDContext;yc.default=aN;var Sn=Qs.default;Object.defineProperty(id,"__esModule",{value:!0});id.default=_w;var el=Sn(Fr),uw=Sn(od),mw=Sn(pi),dw=Sn(hi),fw=Sn(uo),pw=Sn(mo),eu=Sn(A),hw=Sn(Ea),gw=Sn(fc),yw=Sn(pc),bw=Sn(yc),Nw=ir,xw=gi,vw=["selectable","elementProps","components"];function _w(s){var e=function(t){function n(){var r;(0,mw.default)(this,n);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=(0,fw.default)(this,n,[].concat(o)),r.defaultOnDragOver=function(u){u.preventDefault()},r.handleBeginAction=function(u,m,d){r.setState({event:u,action:m,direction:d});var f=r.props.onDragStart;f&&f({event:u,action:m,direction:d})},r.handleInteractionStart=function(){r.state.interacting===!1&&r.setState({interacting:!0})},r.handleInteractionEnd=function(u){var m=r.state,d=m.action,f=m.event;if(d&&(r.setState({action:null,event:null,interacting:!1,direction:null}),u!=null)){u.event=f;var h=r.props,y=h.onEventDrop,T=h.onEventResize;d==="move"&&y&&y(u),d==="resize"&&T&&T(u)}},r.state={interacting:!1},r}return(0,pw.default)(n,t),(0,dw.default)(n,[{key:"getDnDContextValue",value:function(){return{draggable:{onStart:this.handleInteractionStart,onEnd:this.handleInteractionEnd,onBeginAction:this.handleBeginAction,onDropFromOutside:this.props.onDropFromOutside,dragFromOutsideItem:this.props.dragFromOutsideItem,draggableAccessor:this.props.draggableAccessor,resizableAccessor:this.props.resizableAccessor,dragAndDropAction:this.state}}}},{key:"render",value:function(){var i=this.props,o=i.selectable,l=i.elementProps,u=i.components,m=(0,uw.default)(i,vw),d=this.state.interacting;delete m.onEventDrop,delete m.onEventResize,m.selectable=o?"ignoreEvents":!1,this.components=(0,Nw.mergeComponents)(u,{eventWrapper:gw.default,eventContainerWrapper:yw.default,weekWrapper:bw.default});var f=this.props.onDropFromOutside?(0,el.default)((0,el.default)({},l),{},{onDragOver:this.props.onDragOver||this.defaultOnDragOver}):l;m.className=(0,hw.default)(m.className,"rbc-addons-dnd",!!d&&"rbc-addons-dnd-is-dragging");var h=this.getDnDContextValue();return eu.default.createElement(xw.DnDContext.Provider,{value:h},eu.default.createElement(s,Object.assign({},m,{elementProps:f,components:this.components})))}}])}(eu.default.Component);return e.defaultProps=(0,el.default)((0,el.default)({},s.defaultProps),{},{draggableAccessor:null,resizableAccessor:null,resizable:!0}),e}var Dw=Qs.default;Object.defineProperty(rd,"__esModule",{value:!0});var lN=rd.default=void 0,kw=Dw(id);lN=rd.default=kw.default;const br={async getAllProcesses(){try{const s=qe(re,"processes"),e=Nt(s,Gt("order","asc")),t=await Vt(e);return t.empty?this.getDefaultProcesses():t.docs.map(n=>{const r=n.data();return{id:parseInt(n.id)||0,name:r.name||"",order:r.order||0,isDefault:r.isDefault||!1,createdAt:r.createdAt,updatedAt:r.updatedAt}})}catch(s){return console.error("[Firestore]    :",s),this.getDefaultProcesses()}},getDefaultProcesses(){return["","","","","","","","","","","","","","","",""].map((e,t)=>({id:t+1,name:e,order:t,isDefault:!0}))},async createProcess(s,e){try{const t=qe(re,"processes"),n=await Vt(t);let r=0;n.docs.forEach(u=>{const m=parseInt(u.id);!isNaN(m)&&m>r&&(r=m)});const i=r+1,o=Te(re,"processes",String(i)),l=new Date().toISOString();return await ci(o,{name:s,order:e,isDefault:!1,createdAt:l,updatedAt:ls()}),console.log(" [Firestore]   :",i),{id:i,name:s,order:e,isDefault:!1,createdAt:l}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async updateProcess(s,e){try{const t=Te(re,"processes",String(s)),n=await It(t);if(!n.exists())throw new Error("   .");const r=n.data(),i={updatedAt:ls()};return e.name!==void 0&&(i.name=e.name),e.order!==void 0&&(i.order=e.order),await Ht(t,i),console.log(" [Firestore]   :",s),{id:s,name:e.name??r.name,order:e.order??r.order,isDefault:r.isDefault}}catch(t){throw console.error("[Firestore]   :",t),new Error(`  : ${t.message||"   "}`)}},async deleteProcess(s){try{const e=Te(re,"processes",String(s));await Hs(e),console.log(" [Firestore]   :",s)}catch(e){throw console.error("[Firestore]   :",e),new Error(`  : ${e.message||"   "}`)}},async reorderProcesses(s){try{const e=s.map((t,n)=>{const r=Te(re,"processes",String(t));return Ht(r,{order:n,updatedAt:ls()})});await Promise.all(e),console.log(" [Firestore]    ")}catch(e){throw console.error("[Firestore]    :",e),new Error(`  : ${e.message||"   "}`)}},subscribeToProcesses(s){const e=qe(re,"processes"),t=Nt(e,Gt("order","asc"));return dn(t,r=>{if(r.empty){s(br.getDefaultProcesses());return}const i=r.docs.map(o=>{const l=o.data();return{id:parseInt(o.id)||0,name:l.name||"",order:l.order||0,isDefault:l.isDefault||!1}});s(i)})}},Aw={getAllProcesses:()=>br.getAllProcesses(),createProcess:(s,e)=>br.createProcess(s,e),updateProcess:(s,e)=>br.updateProcess(s,e),deleteProcess:s=>br.deleteProcess(s),reorderProcesses:s=>br.reorderProcesses(s),subscribeToProcesses:br.subscribeToProcesses,getDefaultProcesses:br.getDefaultProcesses},Ew=lN(QN),Cw=o1;at.updateLocale("ko",{months:["1","2","3","4","5","6","7","8","9","10","11","12"],monthsShort:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdays:["","","","","","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm"},meridiem:s=>s<12?"":"",week:{dow:0,doy:1}});at.locale("ko");const Vw=YN(at),Op=["#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6","#F3F4F6"],ww=ct.memo(({onSave:s,onCancel:e,processList:t})=>{const[n,r]=A.useState(""),i=()=>{const m=window.innerWidth,d=window.innerHeight;return m>=768&&m<1024||m>=1024&&d>m},[o,l]=A.useState(i);A.useEffect(()=>{const m=()=>l(i());return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const u=o?"16px":"18px";return a.jsxDEV("div",{className:"w-full",onClick:m=>m.stopPropagation(),style:{padding:o?"2px 3px":"6px 0",minHeight:o?"28px":"32px"},children:[a.jsxDEV("input",{type:"text",list:"process-suggestions",value:n,onChange:m=>r(m.target.value),onBlur:()=>{n.trim()?s(n.trim()):e()},onKeyDown:m=>{m.stopPropagation(),m.key==="Enter"?n.trim()?s(n.trim()):e():m.key==="Escape"&&e()},onClick:m=>m.stopPropagation(),placeholder:"",className:"w-full bg-transparent border-none outline-none focus:outline-none focus:ring-0",autoFocus:!0,style:{fontSize:u,fontWeight:500,color:"#374151",padding:0,margin:0,lineHeight:"1.3",caretColor:"#374151"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:133,columnNumber:7},void 0),t&&a.jsxDEV("datalist",{id:"process-suggestions",children:t.map(m=>a.jsxDEV("option",{value:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:174,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:172,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:128,columnNumber:5},void 0)}),Fp=s=>s,Jo={"2025-01-01":"","2025-01-28":" ","2025-01-29":"","2025-01-30":" ","2025-03-01":"","2025-03-03":"","2025-05-05":"","2025-05-06":"","2025-06-06":"","2025-08-15":"","2025-10-03":"","2025-10-05":" ","2025-10-06":"","2025-10-07":" ","2025-10-08":"","2025-10-09":"","2025-12-25":"","2026-01-01":"","2026-02-16":" ","2026-02-17":"","2026-02-18":" ","2026-03-01":"","2026-03-02":"","2026-05-05":"","2026-05-24":"","2026-06-06":"","2026-08-15":"","2026-08-17":"","2026-09-24":" ","2026-09-25":"","2026-09-26":" ","2026-10-03":"","2026-10-05":"","2026-10-09":"","2026-12-25":""},Sw=ct.memo(({date:s,label:e,filteredEvents:t,selectedDate:n,user:r,isMobileView:i})=>{const o=at(s).format("YYYY-MM-DD"),l=Jo[o],u=!!Jo[o],m=n&&at(s).isSame(n,"day"),d=t.filter(O=>at(O.start).isSame(s,"day")),f=d.length,h=d.filter(O=>O.assignedTo&&O.assignedTo.includes((r==null?void 0:r.name)||"")).length,y=f-h,T=e.replace(/^0/,""),v=s.getDay()===0,V=s.getDay()===6;let R="#000000";u||v?R="#dc2626":V&&(R="#3b82f6");const L=at(s).isSame(at(),"day");let q="#d1d5db";u||v?q="#fecaca":V&&(q="#bfdbfe");const oe=T.length===2,te=i?{backgroundColor:"transparent",color:R,borderRadius:"50%",width:"30px",height:"30px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:L?"700":"400",border:m?"1px solid #1f2937":"1px solid transparent",boxSizing:"border-box",gap:"1px"}:{color:R,fontWeight:L?"700":"400",paddingLeft:oe?"0px":"4px",...L&&{backgroundColor:q,borderRadius:"50%",width:"21px",height:"21px",display:"inline-flex",alignItems:"center",justifyContent:"center",paddingLeft:"0px"}};return a.jsxDEV("div",{className:i?"flex flex-col items-center":"flex items-center gap-2",style:{overflow:"visible",position:"relative",zIndex:10},children:i?a.jsxDEV("span",{style:te,children:[a.jsxDEV("span",{style:{fontSize:"13px",lineHeight:"1"},children:T},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:335,columnNumber:11},void 0),f>0&&a.jsxDEV("div",{className:"flex gap-0.5",style:{minHeight:"4px",marginTop:"1px"},children:[Array.from({length:h}).map((O,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#66BB6A",flexShrink:0}},`user-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:341,columnNumber:17},void 0)),Array.from({length:y}).map((O,C)=>a.jsxDEV("div",{style:{width:"4px",height:"4px",borderRadius:"50%",backgroundColor:"#757575",flexShrink:0}},`other-${C}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:354,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:338,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:334,columnNumber:9},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{style:te,children:T},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:371,columnNumber:11},void 0),l&&a.jsxDEV("span",{className:"text-xs font-medium",style:{color:"#ef4444"},children:l},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:370,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:328,columnNumber:5},void 0)}),Tw=ct.memo(({event:s,user:e,filterProject:t,isEditing:n,editTitle:r,onEditTitleChange:i,onEditSave:o,onEditDelete:l,onEditCancel:u,onHoverDelete:m,onDeleteAction:d,processList:f})=>{const h=t&&t!=="all",y=s.assignedTo||[],[T,v]=A.useState(!1),V=ct.useRef(null),R=()=>{const he=window.innerWidth,Re=window.innerHeight;return he>=768&&he<1024||he>=1024&&Re>he},[L,q]=A.useState(R),[oe,te]=A.useState(!1);ct.useRef(null),ct.useRef(!1);const[O,C]=A.useState(r||""),N=ct.useRef(n);A.useEffect(()=>{n&&!N.current&&r!==void 0&&C(r),N.current=n},[n,r]);const E=e!=null&&e.name?e.name.slice(-2):null,j=E&&["",""].includes(E),S=E&&["","",""].includes(E),w=(e==null?void 0:e.name)&&(y.includes(e.name)||y.includes("HV LAB")||y.includes("")&&S||y.includes("")&&j);A.useEffect(()=>{const he=()=>{q(R())};return window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)},[]);const k=he=>{C(he)},De=()=>{O!=null&&O.trim()&&o&&(i&&i(O),o()),u&&u()},Me=he=>{he.stopPropagation(),(he.key==="Enter"||he.key==="Escape")&&he.currentTarget.blur()};return L?a.jsxDEV("div",{className:"w-full relative block",onMouseEnter:()=>{te(!0),v(!0)},onMouseLeave:()=>{te(!1),v(!1)},style:{padding:h?"2px 3px":"1px 3px",minHeight:h?"28px":"30px",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[T&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-0 right-0 z-20",style:{padding:"4px"},children:a.jsxDEV("button",{ref:V,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:512,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex items-center justify-between w-full",style:{fontSize:h?"13px":"10px",opacity:.8,marginBottom:"1px",lineHeight:"1.2"},children:[!h&&!s.isASVisit&&s.projectName?a.jsxDEV("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"60%",flexShrink:0},children:["[",Fp(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:533,columnNumber:13},void 0):a.jsxDEV("span",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:543,columnNumber:13},void 0),!h&&y.length>0&&a.jsxDEV("span",{style:{flexShrink:0,fontSize:"10px",marginLeft:"auto"},children:y.map((he,Re)=>{const ft=he==="HV LAB"||he===""&&j||he===""&&S||he===(e==null?void 0:e.name);return a.jsxDEV(ct.Fragment,{children:[a.jsxDEV("span",{style:{fontWeight:ft?"bold":"normal"},children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:554,columnNumber:21},void 0),Re<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:553,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:546,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:531,columnNumber:9},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:he=>k(he.target.value),onBlur:De,onKeyDown:Me,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"w-full bg-transparent border-none outline-none",style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",color:"inherit",padding:0,margin:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:567,columnNumber:11},void 0):a.jsxDEV("div",{style:{fontWeight:500,fontSize:h?"16px":"11px",lineHeight:"1.3",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"keep-all",textOverflow:"ellipsis",textDecoration:w?"underline":"none",textDecorationColor:w?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},title:s.title,children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:587,columnNumber:11},void 0),oe&&a.jsxDEV("div",{className:"absolute z-50 bg-gray-900 text-white text-xs rounded p-2 shadow-lg",style:{bottom:"100%",left:"0",marginBottom:"4px",minWidth:"200px",maxWidth:"300px"},children:[a.jsxDEV("div",{className:"font-semibold mb-1",children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:621,columnNumber:13},void 0),s.projectName&&a.jsxDEV("div",{className:"opacity-90",children:[": ",s.projectName]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:623,columnNumber:15},void 0),y.length>0&&a.jsxDEV("div",{className:"opacity-90 mt-1",children:[": ",y.join(", ")]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:626,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:611,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:497,columnNumber:7},void 0):a.jsxDEV("div",{className:"flex items-center justify-between w-full gap-1.5 overflow-hidden relative",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:{minHeight:h?"32px":"18px",padding:h?"6px 0":"0"},children:[a.jsxDEV("div",{className:"flex items-center gap-1.5 overflow-hidden flex-1",children:[!h&&!s.isASVisit&&s.projectName&&a.jsxDEV("span",{className:"text-xs opacity-70 flex-shrink-0",children:["[",Fp(s.projectName),"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:648,columnNumber:11},void 0),n?a.jsxDEV("input",{type:"text",list:"process-suggestions-edit",value:O,onChange:he=>k(he.target.value),onBlur:De,onKeyDown:Me,onClick:he=>he.stopPropagation(),autoFocus:!0,className:"font-medium bg-transparent border-none outline-none flex-1",style:{fontSize:h?"18px":"12px",color:"inherit",padding:0,margin:0,minWidth:0}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:653,columnNumber:11},void 0):a.jsxDEV("span",{className:"font-medium truncate",style:{fontSize:h?"18px":"12px",textDecoration:w?"underline":"none",textDecorationColor:w?"#e57373":"transparent",textDecorationThickness:"2px",textUnderlineOffset:"2px"},children:s.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:672,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:645,columnNumber:7},void 0),!h&&y.length>0&&a.jsxDEV("span",{className:"opacity-80 flex-shrink-0 ml-auto",style:{fontSize:"11px"},children:y.map((he,Re)=>{const ft=he==="HV LAB"||he===""&&j||he===""&&S||he===(e==null?void 0:e.name);return a.jsxDEV(ct.Fragment,{children:[a.jsxDEV("span",{className:ft?"font-bold":"",children:he},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:699,columnNumber:17},void 0),Re<y.length-1&&""]},he,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:698,columnNumber:15},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:688,columnNumber:9},void 0),T&&h&&m&&!s.isASVisit&&!s.isExpectedPayment&&a.jsxDEV("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",style:{padding:"2px"},children:a.jsxDEV("button",{ref:V,onMouseDown:he=>{he.stopPropagation(),he.preventDefault(),d&&d(),m()},className:"p-1 text-gray-500 hover:text-red-500",style:{fontSize:"14px",lineHeight:1},title:" (Ctrl+Z )",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:711,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:710,columnNumber:9},void 0),f&&n&&a.jsxDEV("datalist",{id:"process-suggestions-edit",children:f.map(he=>a.jsxDEV("option",{value:he},he,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:733,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:731,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:636,columnNumber:5},void 0)}),Lw=()=>{const{schedules:s,setSchedules:e,addSchedule:t,deleteSchedule:n,loadSchedulesFromAPI:r,addScheduleToAPI:i,updateScheduleInAPI:o,deleteScheduleFromAPI:l,asRequests:u,updateASRequestInAPI:m,loadASRequestsFromAPI:d,constructionPayments:f,updateConstructionPaymentInAPI:h}=er(),{user:y}=Or(),T=dc(),[v,V]=A.useState(!1);A.useEffect(()=>{const b=()=>{const H=window.innerHeight>window.innerWidth&&window.innerWidth>=1024;V(H)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const R=b=>!b||b==="-"?"":v?b:Mu(b),L=y!=null&&y.name?y.name.slice(-2):null;console.log(" Current user:",y==null?void 0:y.name,"Short name:",L);const q=ct.useRef(!1);A.useEffect(()=>{q.current||(q.current=!0,r().catch(b=>{console.error("Failed to load schedules:",b),ne.error("  ")}))},[r]);const[oe,te]=A.useState([]);A.useEffect(()=>{const b=async H=>{if((H.ctrlKey||H.metaKey)&&H.key==="z"){const Y=H.target;if(Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable)return;if(oe.length>0){H.preventDefault();const W=oe[oe.length-1];try{const le=W.type==="as_visit"||W.type==="expected_payment"?"other":W.type;await i({id:"",title:W.originalTitle||W.title,start:W.start,end:W.end,type:le,project:W.originalProjectName||W.projectName,attendees:W.assignedTo||[],time:W.time,description:W.description}),te(ye=>ye.slice(0,-1)),ne.success(" ")}catch(le){console.error("  :",le),ne.error("  ")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[oe,i]);const[O,C]=A.useState([]),[N,E]=A.useState(!1),[j,S]=A.useState(""),[w,k]=A.useState(null),[De,Me]=A.useState(""),[he,Re]=A.useState(!1),[ft,qt]=A.useState(null),[Ot,ae]=A.useState(null),Oe=A.useCallback(async()=>{Re(!0);try{const b=await Aw.getAllProcesses();C(b)}catch(b){console.error("   :",b),C([])}finally{Re(!1)}},[]);A.useEffect(()=>{Oe()},[Oe]);const de=A.useMemo(()=>O.length>0?O.map(b=>b.name):Cw,[O]),Ie=async()=>{if(j.trim())try{const b=await fetch("/api/processes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.trim()})});if(b.ok)S(""),Oe(),ne.success(" ");else{const H=await b.json();ne.error(H.error||"  ")}}catch(b){console.error("  :",b),ne.error("  ")}},Ke=async()=>{if(!(!w||!De.trim()))try{const b=await fetch(`/api/processes/${w.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:De.trim()})});if(b.ok)k(null),Me(""),Oe(),ne.success(" ");else{const H=await b.json();ne.error(H.error||"  ")}}catch(b){console.error("  :",b),ne.error("  ")}},bt=async b=>{if(confirm("   ?"))try{const H=await fetch(`/api/processes/${b}`,{method:"DELETE"});if(H.ok)Oe(),ne.success(" ");else{const Y=await H.json();ne.error(Y.error||"  ")}}catch(H){console.error("  :",H),ne.error("  ")}},ot=b=>{qt(b)},wt=(b,H)=>{b.preventDefault(),ft!==null&&ft!==H&&ae(H)},rt=async()=>{if(ft!==null&&Ot!==null&&ft!==Ot){const b=[...O],[H]=b.splice(ft,1);b.splice(Ot,0,H),C(b);try{(await fetch("/api/processes/reorder/bulk",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:b.map(W=>({id:W.id}))})})).ok||(Oe(),ne.error("  "))}catch(Y){console.error("  :",Y),Oe(),ne.error("  ")}}qt(null),ae(null)},mt=b=>{const H=T.findIndex(Y=>Y.name===b);return H>=0?Op[H%Op.length]:"#e8e2ea"},ds=T.map(b=>b.name),z=s.filter(b=>!b.asRequestId).filter(b=>(y==null?void 0:y.name)===""?b.project===""||ds.includes(b.project):!0).map(b=>{const H=T.find(ge=>ge.name===b.project);let Y=b.project===""?"[]":b.project;if(H&&b.project!==""){const ge=H.name.length>2?H.name.substring(0,2):H.name,pt=(H.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";Y=gs?`${ge}_${gs}`:ge}const W=b.time,le=W&&W!=="-"?` - ${R(W)}`:"",ye=b.attendees||[];return{id:b.id,title:b.title+le,originalTitle:b.title,start:b.start,end:b.end,projectId:(H==null?void 0:H.id)||"",projectName:Y||"",originalProjectName:b.project||"",type:b.type||"other",phase:"",assignedTo:ye,priority:"medium",allDay:!W||W==="-",color:mt(b.project||""),isASVisit:!1,time:W,description:b.description}}),Le=u.filter(b=>b.scheduledVisitDate).filter(b=>(y==null?void 0:y.name)===""?ds.includes(b.project):!0).map(b=>{const H=b.scheduledVisitTime,Y=H&&H!=="-"?` - ${R(H)}`:"",W=T.find(ge=>ge.name===b.project);let le=b.project;if(W){const ge=W.name.length>2?W.name.substring(0,2):W.name,pt=(W.location||"").match(/([A-Za-z]?\d+)/),gs=pt?pt[1]:"";le=gs?`${ge}_${gs}`:ge}const ye=`[AS] ${le}`;return{id:`as-${b.id}`,title:ye+Y,originalTitle:ye,start:b.scheduledVisitDate,end:b.scheduledVisitDate,projectId:(W==null?void 0:W.id)||"",projectName:le,originalProjectName:b.project,type:"as_visit",phase:"",assignedTo:b.assignedTo?Array.isArray(b.assignedTo)?b.assignedTo:b.assignedTo.split(",").map(ge=>ge.trim()):[],priority:"high",allDay:!H||H==="-",color:"#FEF3C7",isASVisit:!0,time:H,description:b.description}}),Be=(y==null?void 0:y.role)==="manager"?f.flatMap(b=>{var ye,ge,lt,pt,gs,Lt,Pt,is;const H=T.find(Es=>Es.name===b.project);if(!H){const Es=[],At=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),ts=new Set(b.payments.flatMap(ps=>{var Kt;return((Kt=ps.type)==null?void 0:Kt.split(", ").map(Qt=>Qt.trim()))||[]}));return!ts.has("")&&((ye=b.expectedPaymentDates)!=null&&ye.contract)&&Es.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(At*.1).toLocaleString()}`}),!ts.has("")&&((ge=b.expectedPaymentDates)!=null&&ge.start)&&Es.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(At*.4).toLocaleString()}`}),!ts.has("")&&((lt=b.expectedPaymentDates)!=null&&lt.middle)&&Es.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(At*.4).toLocaleString()}`}),!ts.has("")&&((pt=b.expectedPaymentDates)!=null&&pt.final)&&Es.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(At*.1).toLocaleString()}`}),Es}if(!H.startDate||!H.endDate)return[];const Y=b.totalAmount+(b.vatType==="percentage"?b.totalAmount*(b.vatPercentage/100):b.vatAmount),W=new Set(b.payments.flatMap(Es=>{var At;return((At=Es.type)==null?void 0:At.split(", ").map(ts=>ts.trim()))||[]})),le=[];return!W.has("")&&((gs=b.expectedPaymentDates)!=null&&gs.contract)&&le.push({id:`payment-${b.id}-contract`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.contract),end:new Date(b.expectedPaymentDates.contract),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),!W.has("")&&((Lt=b.expectedPaymentDates)!=null&&Lt.start)&&le.push({id:`payment-${b.id}-start`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.start),end:new Date(b.expectedPaymentDates.start),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((Pt=b.expectedPaymentDates)!=null&&Pt.middle)&&le.push({id:`payment-${b.id}-middle`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.middle),end:new Date(b.expectedPaymentDates.middle),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (40%): ${Math.round(Y*.4).toLocaleString()}`}),!W.has("")&&((is=b.expectedPaymentDates)!=null&&is.final)&&le.push({id:`payment-${b.id}-final`,title:"[] ",originalTitle:"[] ",start:new Date(b.expectedPaymentDates.final),end:new Date(b.expectedPaymentDates.final),projectId:H.id||"",projectName:b.project,type:"expected_payment",phase:"",assignedTo:[],priority:"medium",allDay:!0,color:"#DBEAFE",isExpectedPayment:!0,description:` (10%): ${Math.round(Y*.1).toLocaleString()}`}),le}):[],Se=[...z,...Le,...Be],Qe=A.useCallback(b=>{if(!(y!=null&&y.name))return!1;const H=b.assignedTo||[],Y=y.name.slice(-2),W=["",""].includes(Y),le=["","",""].includes(Y);return H.includes(y.name)||H.includes("HV LAB")||H.includes("")&&le||H.includes("")&&W},[y==null?void 0:y.name]),St=(b,H)=>{if(!H)return[...b].sort((le,ye)=>{const ge=Qe(le),lt=Qe(ye);return ge&&!lt?-1:!ge&&lt?1:le.start.getTime()-ye.start.getTime()});const Y=new Map;b.forEach(le=>{const ye=le.time&&le.time!=="-"&&le.time.trim()!=="";if(le.isASVisit||le.isExpectedPayment||ye){const ge=`single_${le.id}`;Y.set(ge,[le])}else{const ge=le.start.toISOString().split("T")[0],lt=[...le.assignedTo].sort().join(","),pt=`${ge}_${le.projectName}_${lt}`;Y.has(pt)||Y.set(pt,[]),Y.get(pt).push(le)}});const W=[];return Y.forEach(le=>{if(le.length===1)W.push(le[0]);else{const ye=le[0],ge=le.map(Pt=>Pt.originalTitle||Pt.title),lt=[...new Set(ge)],pt=le.map(Pt=>{const is=Pt.originalTitle||Pt.title;return is.startsWith(ye.projectName+" - ")?is.substring(ye.projectName.length+3):is}),gs=[...new Set(pt)],Lt={...ye,id:le[0].id,title:gs.join(", "),originalTitle:lt.join(", "),description:le.map(Pt=>Pt.description||Pt.originalTitle||Pt.title).join(`
`),assignedTo:[...new Set(le.flatMap(Pt=>Pt.assignedTo))],mergedEventIds:le.map(Pt=>Pt.id)};W.push(Lt)}}),W.sort((le,ye)=>{const ge=Qe(le),lt=Qe(ye);return ge&&!lt?-1:!ge&&lt?1:le.start.getTime()-ye.start.getTime()})},[$t,ut]=A.useState("month"),[P,F]=A.useState(new Date),[Z,be]=A.useState(!1),[ue,fe]=A.useState(null),[Ve,Fe]=A.useState(null),Ze=`schedule_filterProject_${(y==null?void 0:y.id)||"guest"}`,[ke,Rs]=A.useState(()=>{const b=localStorage.getItem(Ze);return b||((y==null?void 0:y.name)===""&&T.length>0?T[0].name:"all")});A.useEffect(()=>{localStorage.setItem(Ze,ke)},[ke,Ze]),A.useCallback(()=>{document.body.classList.add("printing-schedule");const b=ke==="all"?" ":ke,H=at(P).format("YYYY MM"),Y=document.title;document.title=`${b} - ${H} `,setTimeout(()=>{window.print(),document.body.classList.remove("printing-schedule"),document.title=Y},100)},[ke,P]);const Rt=St(Se,ke==="all"),[ee,Ye]=A.useState(window.innerWidth<768?new Date:null),[M,Ne]=A.useState(null),_e=ct.useRef(null),Pe=ct.useRef(!1),[me,_t]=A.useState(null),yt=ct.useRef(!1),Xt=ct.useRef(!1);A.useEffect(()=>{const b=W=>{W.key==="Control"&&(Xt.current=!0)},H=W=>{W.key==="Control"&&(Xt.current=!1)},Y=()=>{Xt.current=!1};return window.addEventListener("keydown",b),window.addEventListener("keyup",H),window.addEventListener("blur",Y),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",H),window.removeEventListener("blur",Y)}},[]),A.useEffect(()=>{if(!M)return;let b=null;const H=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy")},Y=ye=>{ye.preventDefault(),ye.dataTransfer&&(ye.dataTransfer.dropEffect="copy");const lt=ye.target.closest(".rbc-day-bg");b&&b!==lt&&(b.style.backgroundColor=""),lt&&(lt.style.backgroundColor="rgba(59, 130, 246, 0.15)",b=lt)},W=()=>{b&&(b.style.backgroundColor="",b=null)},le=ye=>{ye.preventDefault(),b&&(b.style.backgroundColor="",b=null)};return document.addEventListener("dragenter",H),document.addEventListener("dragover",Y),document.addEventListener("dragend",W),document.addEventListener("drop",le),()=>{document.removeEventListener("dragenter",H),document.removeEventListener("dragover",Y),document.removeEventListener("dragend",W),document.removeEventListener("drop",le),b&&(b.style.backgroundColor="")}},[M]);const[kt,fs]=A.useState(null),[ns,Ts]=A.useState(null),[fn,Ys]=A.useState(""),[pn,Qr]=A.useState(!1),[Tn,en]=A.useState(null),[_,K]=A.useState(!1),[B,x]=A.useState(""),[I,U]=A.useState(null),[G,Q]=A.useState({x:0,y:0}),[J,se]=A.useState({x:0,y:0}),[Ce,Xe]=A.useState(!1),Ue=8;A.useEffect(()=>{if(!I)return;const b=Y=>{Q({x:Y.clientX,y:Y.clientY});const W=Math.abs(Y.clientX-J.x),le=Math.abs(Y.clientY-J.y);(W>Ue||le>Ue)&&Xe(!0)},H=()=>{U(null),Xe(!1)};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",H)}},[I,J]);const pe=ct.useRef(!1),We=A.useCallback(async({event:b,start:H,end:Y})=>{if(b.isASVisit||b.isExpectedPayment){ne.error("    ");return}const W=H instanceof Date?H:new Date(H),le=Y instanceof Date?Y:new Date(Y);if(Xt.current)try{const ge=b.mergedEventIds||[b.id],lt=s.filter(pt=>ge.includes(pt.id));for(const pt of lt)await i({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:pt.title,start:W,end:le,project:pt.project,attendees:pt.attendees||[],time:pt.time,priority:pt.priority||"medium"});ne.success(" ")}catch(ge){console.error("  :",ge),ne.error("  ")}else{const ge=b.mergedEventIds||[b.id];try{for(const lt of ge)await o(lt,{start:W,end:le})}catch(lt){console.error("  :",lt),ne.error("  "),r()}}},[s,o,i,r]),as=A.useCallback(({event:b,action:H})=>{var W;if(b.isASVisit||b.isExpectedPayment||b.id==="__inline_add__")return;const Y=document.querySelectorAll(".rbc-event");for(const le of Y)if((W=le.textContent)!=null&&W.includes(b.originalTitle||b.title)){const ye=le.getBoundingClientRect();se({x:ye.left,y:ye.top}),Q({x:ye.left,y:ye.top});break}Xe(!1),U(b)},[]),Wt=A.useCallback(async(b,H,Y=!1)=>{if(ke==="all"){ne.error("  ");return}const W={id:"",title:b,start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(W)}catch(le){console.error("  :",le),ne.error("  ")}},[ke,i,y]),Bt=A.useCallback(({start:b})=>{const H=M||_e.current;H&&ke!=="all"&&(Pe.current=!0,yt.current=!0,requestAnimationFrame(()=>{yt.current=!1}),fs(null),Ts(null),Ys(""),Wt(H,b),requestAnimationFrame(()=>{Ne(null),_e.current=null,Pe.current=!1}))},[M,ke,Wt]),jt=A.useCallback(()=>{const b=M||_e.current;return b?{title:b}:null},[M]),Bs=A.useCallback(async b=>{if(!b.trim()||!kt||ke==="all"){fs(null);return}const H=kt;fs(null);const Y={id:"",title:b.trim(),start:H,end:H,type:"construction",project:ke,location:"",attendees:y!=null&&y.name?[y.name]:[],description:""};try{await i(Y)}catch(W){console.error("  :",W),ne.error("  ")}},[kt,ke,i,y]),qs=A.useCallback(()=>{fs(null)},[]),zt=A.useCallback(async()=>{var b;if(!ns||!fn.trim()){Ts(null),Ys("");return}try{const H=((b=ns.mergedEventIds)==null?void 0:b[0])||ns.id;await o(H,{title:fn.trim()})}catch(H){console.error("  :",H),ne.error("  ")}Ts(null),Ys("")},[ns,fn,o]),ze=A.useCallback(async b=>{te(Y=>[...Y,b]);const H=b.mergedEventIds||[b.id];ne.success(" (Ctrl+Z )",{duration:2e3});try{await Promise.all(H.map(Y=>l(Y)))}catch(Y){console.error("  :",Y),ne.error("  "),te(W=>W.slice(0,-1))}Ts(null),Ys("")},[l]),Ae=ke==="all"?Rt:Rt.filter(b=>(b.originalProjectName||b.projectName)===ke),Je=ct.useMemo(()=>{const b=ke!=="all",H=new Map;Ae.forEach(W=>{const le=at(W.start).format("YYYY-MM-DD");H.has(le)||H.set(le,[]),H.get(le).push(W)});const Y=[];return H.forEach(W=>{if(b)W.forEach((le,ye)=>{const ge=at(le.start).startOf("day").add(ye,"milliseconds").toDate();Y.push({...le,start:ge,allDay:!1})});else{const le=[],ye=[];W.forEach(ge=>{Qe(ge)?le.push(ge):ye.push(ge)}),le.forEach((ge,lt)=>{const pt=at(ge.start).startOf("day").add(lt,"milliseconds").toDate();Y.push({...ge,start:pt,allDay:!1})}),ye.forEach((ge,lt)=>{const pt=at(ge.start).startOf("day").add(1e3+lt,"milliseconds").toDate();Y.push({...ge,start:pt,allDay:!1})})}}),Y.sort((W,le)=>W.start.getTime()-le.start.getTime())},[Ae,Qe,ke]),et=ct.useMemo(()=>{if(kt&&ke!=="all"){const b=at(kt).format("YYYY-MM-DD"),H=Je.filter(ye=>at(ye.start).format("YYYY-MM-DD")===b),Y=H.length>0?Math.max(...H.map(ye=>ye.start.getTime())):at(kt).startOf("day").valueOf(),W=new Date(Y+1),le={id:"__inline_add__",title:"",start:W,end:W,projectId:"",projectName:ke,type:"other",phase:"",assignedTo:[],priority:"medium",allDay:!1};return[...Je,le]}return Je},[Je,kt,ke]);A.useEffect(()=>{(y==null?void 0:y.name)===""&&T.length>0&&(ke==="all"||!T.find(b=>b.name===ke))&&Rs(T[0].name)},[T,y]),A.useEffect(()=>{const b=()=>{document.querySelectorAll(".rbc-show-more, .rbc-button-link").forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.pointerEvents="none"}),document.querySelectorAll('.rbc-overlay, .rbc-overlay-header, .rbc-popup, [class*="rbc-overlay"]').forEach(ge=>{ge.style.display="none",ge.style.visibility="hidden",ge.style.opacity="0",ge.style.pointerEvents="none",ge.style.position="absolute",ge.style.left="-9999px",ge.style.top="-9999px",ge.style.zIndex="-1"})};b();const H=new MutationObserver(b),Y=document.querySelector(".rbc-calendar");Y&&H.observe(Y,{childList:!0,subtree:!0});const W=new MutationObserver(b);return W.observe(document.body,{childList:!0,subtree:!0}),()=>{H.disconnect(),W.disconnect()}},[$t,P]);const[tt,He]=A.useState({date:null,projectId:"",title:""}),st=ct.useRef(!1),Tt=ct.useRef(null),rs=b=>{if(pe.current){pe.current=!1;return}if(b.id==="__inline_add__")return;st.current=!0,Tt.current&&clearTimeout(Tt.current);const H=ke!=="all",Y=window.innerWidth<768;if(H&&!Y&&!b.isASVisit&&!b.isExpectedPayment)fs(null),Ts(b),Ys(b.originalTitle||b.title);else{const W={...b,title:b.originalTitle||b.title};Fe(null),fe(W),be(!0)}Tt.current=setTimeout(()=>{st.current=!1,Tt.current=null},300)},Jt=b=>{const H=window.innerWidth,Y=H<768,W=H>=768&&H<1024,le=ke==="all";if(yt.current)return;if(Y){if(b.start){Ye(b.start);const ge=document.querySelector(".md\\:hidden.mt-3.bg-white");ge&&ge.scrollIntoView({behavior:"smooth",block:"nearest"})}return}const ye=b.action==="click"||b.action==="select";if(!(W&&!ye)){if(le){st.current=!1,Ts(null),Ys(""),fs(null),Fe(b),fe(null),be(!0);return}if(!st.current){if(me){Wt(me,b.start,!0);return}Ts(null),Ys(""),fs(b.start)}}},bn=async()=>{if(!tt.projectId||!tt.title.trim()){alert("  ");return}const b=T.find(H=>H.id===tt.projectId);if(!(!b||!tt.date))try{await i({id:Date.now().toString(),title:tt.title,start:tt.date,end:tt.date,type:"other",project:b.name,location:"",attendees:[],description:""}),He({date:null,projectId:"",title:""}),Ye(null)}catch(H){console.error("Failed to add schedule:",H),ne.error("  ")}},ar=b=>{if(b.id==="__inline_add__")return{style:{backgroundColor:"#ffffff",borderRadius:"6px",color:"#1f2937",border:"1px solid #d1d5db",display:"block",fontSize:"0.8125rem",padding:"0",fontWeight:"400",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"visible"}};let H=b.color||"#E0E7FF",Y="#1f2937";if(b.isASVisit)H="#E8F5E9",Y="#1f2937";else{const W=b.assignedTo&&b.assignedTo.includes("HV LAB"),le=b.assignedTo&&b.assignedTo.includes("")&&L&&["",""].includes(L),ye=b.assignedTo&&b.assignedTo.includes("")&&L&&["","",""].includes(L);b.assignedTo&&b.assignedTo.includes((y==null?void 0:y.name)||"")||W||le||ye?(H="#FEF3C7",Y="#1f2937"):b.color||(H="#e8e2ea")}return{style:{backgroundColor:H,"--event-bg-color":H,borderRadius:"6px",color:Y,border:"none",display:"block",fontSize:"0.8125rem",padding:"4px 8px",fontWeight:"500",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",overflow:"hidden"}}},ho=ct.useCallback(b=>{const H=at(b).format("YYYY-MM-DD"),Y=!!Jo[H],W=ee&&at(b).isSame(ee,"day"),le=window.innerWidth<768;let ye="";W&&(ye+="selected-date "),Y&&(ye+="holiday-date ");const ge=le?{backgroundColor:"transparent",background:"transparent"}:{};return{className:ye.trim(),style:ge}},[ee]),[gt,bi]=A.useState(window.innerWidth<768);A.useEffect(()=>{const b=()=>{bi(window.innerWidth<768)};return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),A.useEffect(()=>{const b=()=>{const H=ee||new Date;Fe({start:H,end:H}),fe(null),be(!0)};return window.addEventListener("headerAddButtonClick",b),()=>window.removeEventListener("headerAddButtonClick",b)},[ee]);const lr=ct.useCallback(({date:b,label:H})=>a.jsxDEV(Sw,{date:b,label:H,filteredEvents:et,selectedDate:ee,user:y,isMobileView:gt},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2331,columnNumber:7},void 0),[et,ee,y,gt]),cr=ct.useRef(fn);cr.current=fn;const Ca=ct.useCallback(b=>{Ys(b)},[]),go=ct.useCallback(()=>{Ts(null),Ys("")},[]),Va=ct.useCallback(({event:b})=>{if(b.id==="__inline_add__")return a.jsxDEV(ww,{onSave:Bs,onCancel:qs,processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2361,columnNumber:9},void 0);const H=(ns==null?void 0:ns.id)===b.id||(ns==null?void 0:ns.mergedEventIds)&&ns.mergedEventIds.includes(b.id);return a.jsxDEV(Tw,{event:b,user:y,filterProject:ke,isEditing:H,editTitle:H?cr.current:void 0,onEditTitleChange:H?Ca:void 0,onEditSave:H?zt:void 0,onEditDelete:H?()=>ze(b):void 0,onEditCancel:H?go:void 0,onHoverDelete:()=>ze(b),onDeleteAction:()=>{pe.current=!0},processList:de},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2374,columnNumber:7},void 0)},[y,ke,ns,zt,ze,Bs,qs,Ca,go,de]),vc=({onNavigate:b})=>{const[H,Y]=ct.useState(!1),[W,le]=ct.useState(at(P).year()),[ye,ge]=ct.useState(at(P).month()),lt=window.innerWidth<768,pt=()=>{le(at(P).year()),ge(at(P).month()),Y(!0)},gs=()=>{F(at().year(W).month(ye).toDate()),Y(!1)};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:`calendar-toolbar flex flex-col bg-white border-b border-gray-200 ${lt?"px-2 py-1":"px-3 md:px-5 py-2"}`,children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("div",{className:"flex items-center space-x-1",children:[a.jsxDEV("button",{onClick:()=>b("PREV"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2417,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-base md:text-lg font-bold text-gray-900 hover:bg-gray-50 px-2 md:px-3 py-1 rounded-lg transition-colors cursor-pointer print-title",onClick:pt,children:[a.jsxDEV("span",{children:at(P).format("YYYY MM")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2427,columnNumber:17},void 0),a.jsxDEV("span",{className:"print-project-name hidden",children:[" - ",ke==="all"?" ":ke]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2429,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2423,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>b("NEXT"),className:"px-2 py-1.5 text-2xl md:text-3xl text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-bold print-hide",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2431,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2416,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex items-center space-x-2",children:a.jsxDEV("select",{className:"px-3 md:px-4 py-1.5 md:py-2 bg-white text-gray-700 rounded-lg text-xs md:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 border border-gray-300 print-hide",value:ke,onChange:Lt=>{Rs(Lt.target.value),_t(null)},style:{appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",backgroundSize:"1.25rem",paddingRight:"2.5rem"},children:[(y==null?void 0:y.name)!==""&&a.jsxDEV("option",{value:"all",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2458,columnNumber:41},void 0),T.filter(Lt=>Lt.status!=="completed").map(Lt=>a.jsxDEV("option",{value:Lt.name,children:Lt.name},Lt.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2462,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2441,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2415,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2413,columnNumber:9},void 0),H&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-sm shadow-xl",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2477,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2483,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2482,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2478,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2476,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("button",{onClick:()=>le(W-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2496,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2495,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2491,columnNumber:19},void 0),a.jsxDEV("span",{className:"text-xl font-bold text-gray-900",children:[W,""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2499,columnNumber:19},void 0),a.jsxDEV("button",{onClick:()=>le(W+1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2507,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2506,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2502,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2490,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2489,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4",children:a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(Lt=>{const Pt=ye===Lt-1,is=at().year()===W&&at().month()===Lt-1;return a.jsxDEV("button",{onClick:()=>ge(Lt-1),className:`py-3 px-4 rounded-lg text-sm font-medium transition-colors ${Pt?"bg-gray-900 text-white":is?"bg-gray-100 text-gray-900 border-2 border-gray-900":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[Lt,""]},Lt,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2520,columnNumber:23},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2515,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2514,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{F(new Date),Y(!1)},className:"flex-1 py-2 px-4 bg-gray-100 text-gray-900 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2540,columnNumber:17},void 0),a.jsxDEV("button",{onClick:gs,className:"flex-1 py-2 px-4 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2474,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2473,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2412,columnNumber:7},void 0)},_c=()=>null,Dc=A.useMemo(()=>({toolbar:vc,event:Va,month:{dateHeader:lr,showMore:_c}}),[lr,Va]),ur=ct.useMemo(()=>{if(!ee)return[];let b;if(gt)b=et.filter(Y=>at(Y.start).isSame(ee,"day"));else{const Y=at(ee).startOf("week"),W=at(ee).endOf("week");b=et.filter(le=>{const ye=at(le.start);return ye.isSameOrAfter(Y,"day")&&ye.isSameOrBefore(W,"day")})}const H=[...b].sort((Y,W)=>{const le=Y.assignedTo&&Y.assignedTo.includes("HV LAB"),ye=Y.assignedTo&&Y.assignedTo.includes("")&&L&&["",""].includes(L),ge=Y.assignedTo&&Y.assignedTo.includes("")&&L&&["","",""].includes(L),lt=Y.assignedTo&&L&&Y.assignedTo.includes(L)||Y.assignedTo&&(y==null?void 0:y.name)&&Y.assignedTo.includes(y.name)||le||ye||ge,pt=W.assignedTo&&W.assignedTo.includes("HV LAB"),gs=W.assignedTo&&W.assignedTo.includes("")&&L&&["",""].includes(L),Lt=W.assignedTo&&W.assignedTo.includes("")&&L&&["","",""].includes(L),Pt=W.assignedTo&&L&&W.assignedTo.includes(L)||W.assignedTo&&(y==null?void 0:y.name)&&W.assignedTo.includes(y.name)||pt||gs||Lt;return lt&&!Pt?-1:!lt&&Pt?1:new Date(Y.start).getTime()-new Date(W.start).getTime()});return console.log("Sorted events:",H.map(Y=>({title:Y.title,assignedTo:Y.assignedTo,user:y==null?void 0:y.name,userShort:L}))),H},[ee,et,y,L,gt]);return A.useEffect(()=>{const H=setTimeout(()=>{const Y=gt?document.querySelectorAll(".rbc-month-view td.rbc-date-cell"):document.querySelectorAll(".rbc-date-cell"),W=document.querySelectorAll(".rbc-month-row"),le=[];W.forEach((At,ts)=>{const ps=At.querySelectorAll(".rbc-date-cell");let Kt=0;ps.forEach(Qt=>{const ht=Qt.querySelector("button");let es=ht==null?void 0:ht.textContent;if(!es){const Nn=Qt.querySelector("span");es=Nn==null?void 0:Nn.textContent}if(es&&!isNaN(parseInt(es))){const Nn=at(P).date(parseInt(es)),Ln=et.filter(Ni=>at(Ni.start).isSame(Nn,"day"));Kt=Math.max(Kt,Ln.length)}}),le.push(Kt)});const ye=ke&&ke!=="all",ge=100,lt=ye?60:18,pt=25,gs=Math.floor((ge-pt)/lt),Lt=le.length,Pt=ge*Lt,is=le.map(At=>At<=gs?ge:pt+At*lt+10),Es=is.reduce((At,ts)=>At+ts,0);if(Es>Pt){const At=is.map((Kt,Qt)=>({index:Qt,height:Kt,overflow:Kt>ge})),ts=At.filter(Kt=>Kt.overflow).reduce((Kt,Qt)=>Kt+(Qt.height-ge),0),ps=At.filter(Kt=>!Kt.overflow);if(ps.length>0){const Kt=Pt-ts-ps.length*ge,Qt=Math.max(50,ge+Kt/ps.length);W.forEach((ht,es)=>{const Ln=is[es]>ge?is[es]:Qt;ht.style.height=`${Ln}px`,ht.style.minHeight=`${Ln}px`})}else{const Kt=Pt/Es;W.forEach((Qt,ht)=>{const es=Math.max(80,is[ht]*Kt);Qt.style.height=`${es}px`,Qt.style.minHeight=`${es}px`})}}else{const At=is.reduce((Qt,ht)=>Qt+(ht>ge?ht:0),0),ts=is.filter(Qt=>Qt<=ge).length,ps=Pt-At,Kt=ts>0?ps/ts:ge;W.forEach((Qt,ht)=>{const es=is[ht]>ge?is[ht]:Kt;Qt.style.height=`${es}px`,Qt.style.minHeight=`${es}px`})}Y.forEach(At=>{const ts=At.querySelector("button");let ps=ts==null?void 0:ts.textContent;if(!ps){const es=At.querySelector("span");ps=es==null?void 0:es.textContent}if(!ps||isNaN(parseInt(ps)))return;const Kt=at(P).date(parseInt(ps)),Qt=et.filter(es=>at(es.start).isSame(Kt,"day"));Qt.length>0?At.setAttribute("data-event-count",Qt.length.toString()):At.removeAttribute("data-event-count");const ht=Kt.clone().toDate();if(ee&&at(ht).isSame(ee,"day")?At.classList.add("selected-date"):At.classList.remove("selected-date"),gt){const es=At,Nn=es._mobileClickHandler;Nn&&At.removeEventListener("click",Nn);const Ln=Ni=>{if(Ni.target.closest(".rbc-event"))return;const xi=Kt.clone().toDate();Ye(xi);const xn=document.querySelector(".md\\:hidden.mt-3.bg-white");xn&&xn.scrollIntoView({behavior:"smooth",block:"nearest"})};es._mobileClickHandler=Ln,At.addEventListener("click",Ln,!0),At.style.cursor="pointer",At.style.touchAction="manipulation"}})},200);return()=>{clearTimeout(H),gt&&document.querySelectorAll(".rbc-month-view td.rbc-date-cell").forEach(W=>{const le=W,ye=le._mobileClickHandler;ye&&(W.removeEventListener("click",ye),delete le._mobileClickHandler)})}},[et,P,gt,ee,ke]),a.jsxDEV("div",{className:"schedule-container space-y-3 md:space-y-2",children:[tt.date&&a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm",children:a.jsxDEV("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 md:gap-3",children:[a.jsxDEV("div",{className:"text-xs md:text-sm font-semibold text-gray-900 md:min-w-[80px]",children:at(tt.date).format("MM DD")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2838,columnNumber:15},void 0),a.jsxDEV("select",{value:tt.projectId,onChange:b=>He({...tt,projectId:b.target.value}),className:"px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",children:T.filter(b=>b.status!=="completed").map(b=>a.jsxDEV("option",{value:b.id,children:b.name},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2849,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2841,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:tt.title,onChange:b=>He({...tt,title:b.target.value}),onKeyPress:b=>{b.key==="Enter"&&bn()},placeholder:"  ...",className:"flex-1 px-3 md:px-4 py-2 border border-gray-300 rounded-lg text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2854,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:bn,className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-gray-900 text-white text-xs md:text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2868,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{He({date:null,projectId:"",title:""}),Ye(null)},className:"flex-1 md:flex-none px-4 md:px-5 py-2 bg-white border border-gray-300 text-gray-700 text-xs md:text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2874,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2867,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2837,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2836,columnNumber:11},void 0),a.jsxDEV("div",{className:"schedule-main flex flex-col md:block",children:[a.jsxDEV("div",{className:"flex gap-3",children:[ke!=="all"&&!gt&&a.jsxDEV("div",{className:"hidden md:block flex-shrink-0 print-hide",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-2 sticky top-4",children:[a.jsxDEV("button",{onClick:()=>E(!0),className:"w-full mb-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[a.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsxDEV("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2901,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2900,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2896,columnNumber:19},void 0),me&&a.jsxDEV("div",{className:"mb-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded text-center",children:[a.jsxDEV("span",{className:"font-medium",children:me},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2908,columnNumber:23},void 0)," ",a.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2909,columnNumber:23},void 0),a.jsxDEV("span",{className:"text-blue-600",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2910,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2907,columnNumber:21},void 0),a.jsxDEV("div",{className:"flex flex-col gap-0.5",children:de.map(b=>a.jsxDEV("div",{draggable:!0,onClick:()=>{_t(me===b?null:b)},onDragStart:H=>{Pe.current=!1,_t(null),Ne(b),_e.current=b,H.dataTransfer.setData("text/plain",b),H.dataTransfer.effectAllowed="copy"},onDragEnd:()=>{Pe.current||(Ne(null),_e.current=null)},className:`px-3 py-1 text-xs rounded cursor-pointer transition-colors text-center font-medium whitespace-nowrap ${me===b?"bg-blue-500 text-white ring-2 ring-blue-300":M===b?"bg-blue-100 text-blue-800":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2915,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2913,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2894,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2893,columnNumber:15},void 0),a.jsxDEV("div",{className:`schedule-calendar bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm calendar-container flex-1 ${ke!=="all"?"specific-project-view":""}`,style:{paddingBottom:0},children:a.jsxDEV(Ew,{localizer:Vw,events:et,startAccessor:"start",endAccessor:"end",view:$t,onView:ut,date:P,onNavigate:F,onSelectEvent:rs,onSelectSlot:Jt,onEventDrop:ke!=="all"?We:void 0,onDragStart:ke!=="all"?as:void 0,onDropFromOutside:ke!=="all"?Bt:void 0,dragFromOutsideItem:ke!=="all"?jt:void 0,draggableAccessor:b=>ke!=="all"&&b.id!=="__inline_add__",resizable:!1,selectable:!0,longPressThreshold:1,eventPropGetter:ar,dayPropGetter:ho,components:Dc,popup:!1,doShowMoreDrillDown:!1,onShowMore:()=>{},showAllEvents:!0,messages:{today:"",previous:"",next:"",month:"",week:"",day:"",agenda:"",date:"",time:"",event:"",noEventsInRange:"   ",showMore:b=>`+${b} `}},`calendar-${ke}-${(ee==null?void 0:ee.getTime())||"no-selection"}`,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2965,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2961,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2890,columnNumber:11},void 0),ee&&a.jsxDEV("div",{className:"schedule-events-list desktop:hidden mt-3 bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900",children:gt?at(ee).format("MM DD (ddd)"):`${at(ee).startOf("week").format("MM DD")} - ${at(ee).endOf("week").format("MM DD")}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3016,columnNumber:19},void 0),Jo[at(ee).format("YYYY-MM-DD")]&&a.jsxDEV("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-red-50 text-red-600",children:Jo[at(ee).format("YYYY-MM-DD")]},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3024,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3015,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[ke!=="all"&&a.jsxDEV("button",{onClick:()=>K(!0),className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"+"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3032,columnNumber:21},void 0),a.jsxDEV("button",{onClick:()=>{Ye(null),en(null),K(!1),x("")},className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:a.jsxDEV("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3049,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3048,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3039,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3029,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3014,columnNumber:15},void 0),a.jsxDEV("div",{children:ur.length===0?a.jsxDEV("div",{className:"p-4",children:ke!=="all"&&_?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&B.trim()){const H=ee||new Date,Y={id:"",title:B.trim(),start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{K(!1),x("")}).catch(W=>{console.error("  :",W),ne.error("  ")})}else b.key==="Escape"&&(K(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3062,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{if(B.trim()){const b=ee||new Date,H={id:"",title:B.trim(),start:b,end:b,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{K(!1),x("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3095,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{K(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3130,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3129,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3122,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3061,columnNumber:23},void 0):a.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3135,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3058,columnNumber:19},void 0):a.jsxDEV("div",{children:[(()=>{const b=ur.reduce((Y,W)=>{const le=at(W.start).format("YYYY-MM-DD");return Y[le]||(Y[le]=[]),Y[le].push(W),Y},{});return Object.keys(b).sort().map(Y=>a.jsxDEV("div",{className:"border-b border-gray-100 last:border-b-0",children:[!gt&&a.jsxDEV("div",{className:"px-3 py-2 bg-gray-50 sticky top-0 z-10",children:a.jsxDEV("p",{className:"text-xs font-semibold text-gray-700",children:at(Y).format("MM DD (ddd)")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3159,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3158,columnNumber:29},void 0),a.jsxDEV("div",{className:"divide-y divide-gray-100",children:b[Y].map(W=>{const le=W.assignedTo&&W.assignedTo.includes("HV LAB"),ye=W.assignedTo&&W.assignedTo.includes("")&&L&&["",""].includes(L),ge=W.assignedTo&&W.assignedTo.includes("")&&L&&["","",""].includes(L),pt=W.assignedTo&&(W.assignedTo.includes((y==null?void 0:y.name)||"")||L&&W.assignedTo.includes(L))||le||ye||ge,gs=!W.color&&!pt,Lt=!W.isASVisit&&!W.isExpectedPayment;return a.jsxDEV("div",{onClick:()=>{const Pt={...W,title:W.originalTitle||W.title};rs(Pt)},className:`p-3 cursor-pointer ${pt?"bg-yellow-50":""}`,style:gs?{backgroundColor:"#f3f0f5"}:void 0,children:a.jsxDEV("div",{className:"flex items-start gap-2",children:[a.jsxDEV("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:pt?"#FEF3C7":W.color||"#e8e2ea",minHeight:"28px"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3205,columnNumber:27},void 0),a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-center justify-between gap-2",children:[a.jsxDEV("p",{className:"text-sm font-semibold text-gray-900 truncate",children:W.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3216,columnNumber:31},void 0),W.assignedTo&&W.assignedTo.length>0&&a.jsxDEV("p",{className:"text-xs text-gray-500 flex-shrink-0",children:["","",""].every(Es=>W.assignedTo.includes(Es))?"":W.assignedTo.join(", ")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3221,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3215,columnNumber:29},void 0),W.projectName&&ke==="all"&&a.jsxDEV("p",{className:"text-xs text-gray-600 mt-0.5",children:W.projectName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3233,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3214,columnNumber:27},void 0),Lt?a.jsxDEV("button",{onClick:Pt=>{Pt.stopPropagation(),en(W)},className:"p-0.5 text-gray-400 hover:text-red-500 flex-shrink-0 active:text-red-600",children:a.jsxDEV("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3248,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3247,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3240,columnNumber:29},void 0):a.jsxDEV("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3253,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3204,columnNumber:25},void 0)},W.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3187,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3165,columnNumber:27},void 0)]},Y,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3155,columnNumber:25},void 0))})(),ke!=="all"&&_&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100",children:a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("input",{type:"text",value:B,onChange:b=>x(b.target.value),onKeyDown:b=>{if(b.key==="Enter"&&B.trim()){const H=ee||new Date,Y={id:"",title:B.trim(),start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(Y).then(()=>{K(!1),x("")}).catch(W=>{console.error("  :",W),ne.error("  ")})}else b.key==="Escape"&&(K(!1),x(""))},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3268,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{if(B.trim()){const b=ee||new Date,H={id:"",title:B.trim(),start:b,end:b,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};i(H).then(()=>{K(!1),x("")}).catch(Y=>{console.error("  :",Y),ne.error("  ")})}},className:"px-3 py-2 text-sm font-medium text-white bg-gray-700 rounded-lg hover:bg-gray-800 active:bg-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3301,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{K(!1),x("")},className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3336,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3335,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3328,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3267,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3266,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3139,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3056,columnNumber:15},void 0),gt&&ke!=="all"&&a.jsxDEV("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[a.jsxDEV("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3349,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex flex-wrap gap-1.5",children:de.map(b=>a.jsxDEV("button",{onClick:async()=>{const H=ee||new Date;if(ke!=="all"){const Y={id:"",title:b,start:H,end:H,project:ke,attendees:y!=null&&y.name?[y.name]:[],type:"construction"};try{await i(Y)}catch(W){console.error("  :",W),ne.error("  ")}}},className:"px-2.5 py-1.5 text-xs rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors font-medium",children:b},b,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3352,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3350,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3348,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3012,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2889,columnNumber:9},void 0),Z&&a.jsxDEV(tb,{event:ue,slotInfo:Ve,defaultProjectName:ke!=="all"?ke:void 0,onClose:()=>{be(!1),fe(null),Fe(null)},onSave:async b=>{console.log(" Schedule.tsx onSave called with newEvent:",b);try{if(ue)if(ue.id.startsWith("as-")){const H=ue.id.replace("as-","");let Y="";b.assignedTo&&Array.isArray(b.assignedTo)&&b.assignedTo.length>0?Y=b.assignedTo.join(", "):ue.assignedTo&&Array.isArray(ue.assignedTo)?Y=ue.assignedTo.join(", "):typeof ue.assignedTo=="string"&&(Y=ue.assignedTo),await m(H,{project:b.title||ue.title,assignedTo:Y,scheduledVisitDate:b.start,scheduledVisitTime:b.time||ue.time}),await d(),be(!1)}else if(ue.id.startsWith("payment-")){const H=ue.id.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};ye[W]=b.start,await h(Y,{expectedPaymentDates:ye})}}else{console.log(" Updating schedule with projectId:",b.projectId,"projectName:",b.projectName);let H=b.title;const Y=/ - (|) \d{1,2}( \d{1,2})?$/;if(H=H.replace(Y,""),ue.mergedEventIds&&ue.mergedEventIds.length>0){console.log(" Updating merged schedules:",ue.mergedEventIds);const W=(ue.originalTitle||ue.title).split(", "),le=H.split(", ");for(let ye=0;ye<ue.mergedEventIds.length;ye++){const ge=ue.mergedEventIds[ye],lt=le[ye]||W[ye]||H;await o(ge,{title:lt.trim(),start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}}else await o(ue.id,{title:H,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName,location:"",attendees:b.assignedTo||[],description:b.description,time:b.time})}else{console.log(" Adding schedule with projectId:",b.projectId,"projectName:",b.projectName);const H={id:Date.now().toString(),title:b.title,start:b.start,end:b.end,type:"other",project:b.projectId||b.projectName||"",location:"",attendees:b.assignedTo||[],description:b.description||"",time:b.time||"-"};await i(H)}be(!1)}catch(H){console.error("Failed to save schedule:",H),ne.error("  ")}},onDelete:async b=>{try{if(b.startsWith("payment-")){const H=b.split("-"),Y=H[1],W=H[2],le=f.find(ye=>ye.id===Y);if(le){const ye={...le.expectedPaymentDates};delete ye[W],await h(Y,{expectedPaymentDates:ye})}}else if(b.startsWith("as-")){const H=b.replace("as-","");await m(H,{scheduledVisitDate:null,scheduledVisitTime:null})}else{const H=Rt.find(Y=>Y.id===b);if(H!=null&&H.mergedEventIds&&H.mergedEventIds.length>0){console.log("Deleting merged schedules:",H.mergedEventIds);for(const Y of H.mergedEventIds)await l(Y)}else await l(b)}be(!1)}catch(H){console.error("Failed to delete schedule:",H),ne.error("  ")}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3390,columnNumber:11},void 0),I&&Ce&&a.jsxDEV("div",{className:"fixed pointer-events-none z-[9999]",style:{left:G.x-50,top:G.y-15,backgroundColor:I.color||"#F3F4F6",borderRadius:"6px",color:"#1f2937",padding:"4px 8px",fontWeight:500,fontSize:"16px",maxWidth:"250px"},children:I.originalTitle||I.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3578,columnNumber:11},void 0),Tn&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>en(null),children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-[280px] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 text-center",children:[a.jsxDEV("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:a.jsxDEV("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3609,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3608,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3607,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-base font-semibold text-gray-900 mb-1",children:" ?"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3612,columnNumber:17},void 0),a.jsxDEV("p",{className:"text-sm text-gray-500 truncate",children:Tn.title},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3606,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex border-t border-gray-100",children:[a.jsxDEV("button",{onClick:()=>en(null),className:"flex-1 py-3 text-sm font-medium text-gray-600 hover:bg-gray-50 active:bg-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3616,columnNumber:17},void 0),a.jsxDEV("button",{onClick:async()=>{try{const b=Tn.mergedEventIds||[Tn.id];await Promise.all(b.map(H=>l(H)))}catch(b){console.error("  :",b),ne.error(" ")}en(null)},className:"flex-1 py-3 text-sm font-medium text-red-600 hover:bg-red-50 active:bg-red-100 border-l border-gray-100 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3622,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3615,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3602,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3598,columnNumber:11},void 0),N&&a.jsxDEV("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999]",onClick:()=>{E(!1),k(null),S("")},children:a.jsxDEV("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden mx-4",onClick:b=>b.stopPropagation(),children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-800",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3660,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{E(!1),k(null),S("")},className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3661,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3659,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[a.jsxDEV("label",{className:"block text-xs text-gray-500 mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3675,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:j,onChange:b=>S(b.target.value),onKeyDown:b=>b.key==="Enter"&&Ie(),placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400 bg-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3677,columnNumber:19},void 0),a.jsxDEV("button",{onClick:Ie,disabled:!j.trim(),className:"px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3685,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3676,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3674,columnNumber:15},void 0),a.jsxDEV("div",{className:"overflow-y-auto max-h-[50vh]",children:he?a.jsxDEV("div",{className:"p-8 text-center text-gray-500",children:[a.jsxDEV("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3699,columnNumber:21},void 0),a.jsxDEV("p",{children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3700,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3698,columnNumber:19},void 0):O.length===0?a.jsxDEV("div",{className:"p-8 text-center text-gray-400",children:[a.jsxDEV("p",{className:"mb-2",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3704,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-xs",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3705,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3703,columnNumber:19},void 0):a.jsxDEV("div",{className:"divide-y divide-gray-50",children:O.map((b,H)=>a.jsxDEV("div",{draggable:(w==null?void 0:w.id)!==b.id,onDragStart:()=>ot(H),onDragOver:Y=>wt(Y,H),onDragEnd:rt,onDragLeave:()=>ae(null),className:`flex items-center gap-3 px-4 py-3 hover:bg-gray-50 group transition-all ${ft===H?"opacity-50 bg-gray-100":""} ${Ot===H?"border-t-2 border-gray-400":""} ${(w==null?void 0:w.id)!==b.id?"cursor-grab active:cursor-grabbing":""}`,children:(w==null?void 0:w.id)===b.id?a.jsxDEV(a.Fragment,{children:[a.jsxDEV("input",{type:"text",value:De,onChange:Y=>Me(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Ke(),Y.key==="Escape"&&(k(null),Me(""))},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-gray-300 focus:border-gray-400",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3727,columnNumber:29},void 0),a.jsxDEV("button",{onClick:Ke,className:"px-3 py-1.5 bg-gray-800 text-white text-xs rounded-lg hover:bg-gray-700",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3741,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(null),Me("")},className:"px-3 py-1.5 bg-gray-100 text-gray-600 text-xs rounded-lg hover:bg-gray-200",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3747,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3726,columnNumber:27},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300 text-xs select-none",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3759,columnNumber:29},void 0),a.jsxDEV("span",{className:"text-gray-300 text-xs w-5 text-right select-none",children:H+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3760,columnNumber:29},void 0),a.jsxDEV("span",{className:"flex-1 text-sm text-gray-700 select-none",children:b.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3761,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>{k(b),Me(b.name)},className:"px-2 py-1 text-gray-400 hover:text-gray-700 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3762,columnNumber:29},void 0),a.jsxDEV("button",{onClick:()=>bt(b.id),className:"px-2 py-1 text-gray-400 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3771,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3758,columnNumber:27},void 0)},b.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3710,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3708,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3696,columnNumber:15},void 0),O.length>0&&a.jsxDEV("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center text-xs text-gray-400",children:"     /"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3654,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:3646,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Schedule.tsx",lineNumber:2833,columnNumber:7},void 0)},Pw=({projectName:s,onClose:e,type:t="cash"})=>{const n=t==="cash",r=n?"":"",i=n?"      .":"      .",[o,l]=A.useState({receiptDate:Ft(new Date,"yyyy-MM-dd"),customerName:"",amount:"",purpose:" ",receivedBy:""}),u=()=>{window.print()},m=f=>{const h=Number(f.replace(/,/g,""));return isNaN(h)?"":h.toLocaleString()},d=f=>{if(f===0)return"";const h=["","","",""],y=["","","",""],T=["","","","","","","","","",""];let v="",V=0;for(;f>0;){const R=f%1e4;if(R>0){let L="",q=R,oe=0;for(;q>0;){const te=q%10;te>0&&(L=T[te]+y[oe]+L),q=Math.floor(q/10),oe++}v=L+h[V]+v}f=Math.floor(f/1e4),V++}return v+""};return a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 print:relative print:bg-white",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto print:max-h-none print:mx-0 print:rounded-none",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b print:hidden",children:[a.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:76,columnNumber:13},void 0),a.jsxDEV("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-5 w-5 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:81,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:77,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:75,columnNumber:11},void 0),a.jsxDEV("div",{className:"p-6 space-y-4 print:hidden",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:88,columnNumber:15},void 0),a.jsxDEV("input",{type:"date",value:o.receiptDate,onChange:f=>l({...o,receiptDate:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:87,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:98,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.customerName,onChange:f=>l({...o,customerName:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:99,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:97,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:109,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:m(o.amount),onChange:f=>{const h=f.target.value.replace(/,/g,"");/^\d*$/.test(h)&&l({...o,amount:h})},placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:110,columnNumber:15},void 0),o.amount&&a.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:108,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:130,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.purpose,onChange:f=>l({...o,purpose:f.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:131,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:129,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:140,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:o.receivedBy,onChange:f=>l({...o,receivedBy:f.target.value}),placeholder:" ",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:141,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:139,columnNumber:13},void 0),a.jsxDEV("button",{onClick:u,disabled:!o.customerName||!o.amount||!o.receivedBy,className:"w-full py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsxDEV(Yp,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:155,columnNumber:15},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:86,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden print:block p-12",children:a.jsxDEV("div",{className:"border-4 border-double border-gray-900 p-8",children:[a.jsxDEV("h1",{className:"text-center text-3xl font-bold mb-8",children:n?"    ":"    "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:163,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-6 text-lg",children:[a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:169,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:168,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:174,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.customerName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:173,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:s},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:180,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:178,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:184,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1 font-bold receipt-amount",children:["",Number(o.amount).toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:185,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:183,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:"():"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:191,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:d(Number(o.amount))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:192,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:190,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex items-baseline border-b border-gray-300 pb-2",children:[a.jsxDEV("span",{className:"font-medium w-32",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:196,columnNumber:19},void 0),a.jsxDEV("span",{className:"flex-1",children:o.purpose},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:195,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:167,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-12 text-center",children:[a.jsxDEV("p",{className:"text-lg mb-8",children:i},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:202,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-2",children:[a.jsxDEV("p",{className:"text-lg receipt-date",children:Ft(new Date(o.receiptDate),"yyyy MM dd",{locale:xs})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:205,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-xl font-medium mt-8",children:[": ",o.receivedBy," ",a.jsxDEV("span",{className:"ml-4",children:"()"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:207,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:206,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:201,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:73,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:72,columnNumber:7},void 0),a.jsxDEV("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print\\:block, .print\\:block * {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:217,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/components/CashReceiptModal.tsx",lineNumber:71,columnNumber:5},void 0)},Iw="HVLabImageDB",jw=1,Rr="paymentRecordImages";let tl=null;const dd=()=>new Promise((s,e)=>{if(tl){s(tl);return}const t=indexedDB.open(Iw,jw);t.onerror=()=>{console.error("IndexedDB  :",t.error),e(t.error)},t.onsuccess=()=>{tl=t.result,s(tl)},t.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains(Rr)||r.createObjectStore(Rr,{keyPath:"id"})}}),Rw=async()=>{try{const s=await dd();return new Promise((e,t)=>{const i=s.transaction(Rr,"readonly").objectStore(Rr).getAll();i.onsuccess=()=>{const o={};i.result.forEach(l=>{o[l.id]=l.images}),e(o)},i.onerror=()=>{console.error("  :",i.error),t(i.error)}})}catch(s){console.error("IndexedDB , localStorage :",s);const e=localStorage.getItem("paymentRecordImages");return e?JSON.parse(e):{}}},Bw=async(s,e)=>{try{const t=await dd();return new Promise((n,r)=>{const l=t.transaction(Rr,"readwrite").objectStore(Rr).put({id:s,images:e});l.onsuccess=()=>n(),l.onerror=()=>{console.error("  :",l.error),r(l.error)}})}catch(t){throw console.error("IndexedDB  :",t),t}},Uw=async s=>{try{const e=await dd();return new Promise((t,n)=>{const r=e.transaction(Rr,"readwrite"),i=r.objectStore(Rr);i.clear(),Object.entries(s).forEach(([o,l])=>{i.put({id:o,images:l})}),r.oncomplete=()=>t(),r.onerror=()=>{console.error("  :",r.error),n(r.error)}})}catch(e){throw console.error("IndexedDB   :",e),e}},Hw=async()=>{try{const s=localStorage.getItem("paymentRecordImages");if(s){const e=JSON.parse(s);Object.keys(e).length>0&&(await Uw(e),localStorage.removeItem("paymentRecordImages"),console.log("localStorage IndexedDB  "))}}catch(s){console.error(" :",s)}},sl=s=>{if(!s)return 0;try{const t=new Date(s).getTime();return isNaN(t)?0:t}catch{return 0}},qp=(s,e,t)=>{if(!s)return null;try{const n=new Date(s);return isNaN(n.getTime())?null:Ft(n,e,t)}catch{return null}},Mw=()=>{const{payments:s,loadPaymentsFromAPI:e,loadProjectsFromAPI:t,addPaymentToAPI:n,deletePaymentFromAPI:r,updatePaymentInAPI:i,updatePayment:o}=er(),{user:l}=Or(),u=dc(),[m,d]=A.useState(""),[f,h]=A.useState(null),[y,T]=A.useState(null),[v,V]=A.useState(!1),[R,L]=A.useState(!1),[q,oe]=A.useState(!1),[te,O]=A.useState(!1),[C,N]=A.useState(""),[E,j]=A.useState("form"),[S,w]=A.useState(!1),[k,De]=A.useState(!1),Me=A.useRef(null),[he,Re]=A.useState("pending"),[ft,qt]=A.useState("all"),[Ot,ae]=A.useState(()=>localStorage.getItem("payments_showMyRequestsOnly")==="true"),[Oe,de]=A.useState(!1),[Ie,Ke]=A.useState(null),[bt,ot]=A.useState(!1),[wt,rt]=A.useState(""),[mt,ds]=A.useState(!1),z=A.useRef(!1),Le=A.useRef(!1),Be=A.useRef(null),[Se,Qe]=A.useState([]),[St,$t]=A.useState([]),[ut,P]=A.useState(null),[F,Z]=A.useState([]),[be,ue]=A.useState([]),[fe,Ve]=A.useState(!1),[Fe,Ze]=A.useState({}),[ke,Rs]=A.useState(!1),Rt=()=>{const _=localStorage.getItem("lastSelectedProject"),K=u.filter(B=>B.status!=="completed");return _&&K.some(B=>B.name===_)?_:K.length>0?K[0].name:""},[ee,Ye]=A.useState({project:"",date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]});A.useEffect(()=>{(async()=>{try{const K=await Jn.getAllContractors();Qe(K.map(B=>({id:B._id||B.id,rank:B.rank,companyName:B.companyName,name:B.name,process:B.process,contact:B.contact,accountNumber:B.accountNumber,bankName:B.bankName,notes:B.notes,createdAt:new Date(B.createdAt),updatedAt:new Date(B.updatedAt)})))}catch(K){console.error("Failed to load contractors:",K)}})()},[]),A.useEffect(()=>{qt("all"),t().catch(K=>{console.error("Failed to load projects:",K)}),e().catch(K=>{console.error("Failed to load payments:",K)});const _=()=>{w(window.innerWidth<1024)};if(_(),window.addEventListener("resize",_),u.length>0&&!ee.project&&!Le.current){const K=Rt();K&&(Ye(B=>({...B,project:K})),localStorage.setItem("lastSelectedProject",K))}return()=>window.removeEventListener("resize",_)},[]),A.useEffect(()=>{console.log("[ ] Firestore  ...");const _=ln.subscribeToPayments(K=>{console.log("[ ]  :",K.length,"");const B=K.map(x=>({id:String(x.id),project:x.project_name||"",purpose:x.description,process:x.vendor_name,itemName:x.item_name||"",amount:x.amount,materialAmount:x.material_amount||0,laborAmount:x.labor_amount||0,originalMaterialAmount:x.original_material_amount||0,originalLaborAmount:x.original_labor_amount||0,applyTaxDeduction:x.apply_tax_deduction===1,includesVAT:x.includes_vat===1,quickText:x.quick_text||"",images:(()=>{if(!x.images)return[];if(Array.isArray(x.images))return x.images;try{const I=JSON.parse(x.images);return Array.isArray(I)?I:[]}catch{return[]}})(),category:x.request_type,status:x.status,urgency:"normal",requestedBy:x.requester_name,requestDate:new Date(x.created_at),approvalDate:x.approved_at?new Date(x.approved_at):void 0,bankInfo:{accountHolder:x.account_holder||"",bankName:x.bank_name||"",accountNumber:x.account_number||""},attachments:[],notes:x.notes||"",completionDate:x.completionDate?new Date(x.completionDate):void 0}));Be.current||er.setState({payments:B})});return()=>{console.log("[ ] Firestore  "),_()}},[]),A.useEffect(()=>{const _=()=>{if(document.visibilityState==="visible"){if(Be.current){console.log("[ ]     - ");return}console.log("[ ]   -    ..."),e().catch(K=>{console.error("[ ] :",K)})}};return document.addEventListener("visibilitychange",_),()=>{document.removeEventListener("visibilitychange",_)}},[e]),A.useEffect(()=>{let _=Nr.getSocket(),K=0,B=null;const x=U=>{if(console.log(" [ ]    :",U),Be.current&&String(U.paymentId)===Be.current){console.log(" [ ]    -  ");return}console.log(" [ ] loadPaymentsFromAPI  (  )"),e().catch(G=>{console.error("[ ]  :",G)})},I=()=>(_=Nr.getSocket(),_?(console.log(" [Payments] Socket  , payment:refresh  "),_.on("payment:refresh",x),B&&(clearInterval(B),B=null),!0):!1);return I()||(console.log(" [Payments] Socket  ..."),B=setInterval(()=>{K++,(I()||K>=10)&&(B&&(clearInterval(B),B=null),K>=10&&!Nr.getSocket()&&console.warn(" [Payments] Socket   -   "))},500)),()=>{B&&clearInterval(B);const U=Nr.getSocket();U&&U.off("payment:refresh",x)}},[e]),A.useEffect(()=>{(async()=>{var x,I,U,G;if(z.current)return;const K=new URLSearchParams(window.location.search),B=K.get("complete")||K.get("c");if(B){if(!l){console.log("[ ]   -  ");return}z.current=!0,console.log("[ ]  :",B),window.history.replaceState({},"","/payments"),Le.current=!0,j("list"),Re("completed"),qt("all"),Ye(Q=>({...Q,project:""})),o(String(B),{status:"completed",completionDate:new Date}),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(String(B),{status:"completed"}),await e();const Q=Nr.getSocket();Q&&Q.emit("payment:refresh",{paymentId:B,status:"completed",updatedAt:new Date().toISOString()})}catch(Q){console.error("[ ]  :",Q),o(String(B),{status:"pending",completionDate:void 0}),Re("pending");let J="  ";((x=Q.response)==null?void 0:x.status)===401?J=" .  ":((I=Q.response)==null?void 0:I.status)===404?J="     (ID: "+B+")":(G=(U=Q.response)==null?void 0:U.data)!=null&&G.error?J=Q.response.data.error:Q.message&&(J+=": "+Q.message),ne.error(J)}}})()},[e,i,o,l]),A.useEffect(()=>{if(ee.process){const _=new Set(s.filter(I=>{var U;return I.status==="completed"&&((U=I.bankInfo)==null?void 0:U.accountHolder)}).map(I=>I.bankInfo.accountHolder.trim().toLowerCase())),K=(I,U)=>{const G=I.toLowerCase(),Q=U.toLowerCase();if(G.includes(Q)||Q.includes(G))return!0;const J=G.split("/").map(Ce=>Ce.trim()),se=Q.replace(/$/,"").trim();for(const Ce of J)if(Ce===se||se.includes(Ce)||Ce.includes(se))return!0;return!1},x=Se.filter(I=>{if(!K(ee.process,I.process))return!1;const G=I.accountNumber&&I.accountNumber.trim()!=="",Q=I.name.trim().toLowerCase(),J=_.has(Q);return G||J}).sort((I,U)=>{const G=I.accountNumber&&I.accountNumber.trim()!=="",Q=U.accountNumber&&U.accountNumber.trim()!=="";return G&&!Q?-1:!G&&Q?1:0});$t(x)}else $t([])},[ee.process,Se,s]),A.useEffect(()=>{if(ee.process){const _=(x,I)=>{if(!I)return!1;const U=x.toLowerCase(),G=I.toLowerCase();if(U.includes(G)||G.includes(U))return!0;const Q=U.split("/").map(se=>se.trim()),J=G.replace(/$/,"").trim();for(const se of Q)if(se===J||J.includes(se)||se.includes(J))return!0;return!1},K=s.filter(x=>{var I,U,G;return x.status==="completed"&&x.process&&_(ee.process,x.process)&&((I=x.bankInfo)==null?void 0:I.accountHolder)&&((U=x.bankInfo)==null?void 0:U.bankName)&&((G=x.bankInfo)==null?void 0:G.accountNumber)}),B=new Map;K.forEach(x=>{const I=`${x.bankInfo.accountHolder}_${x.bankInfo.bankName}_${x.bankInfo.accountNumber}`;B.has(I)||B.set(I,{accountHolder:x.bankInfo.accountHolder,bankName:x.bankInfo.bankName,accountNumber:x.bankInfo.accountNumber,itemName:x.itemName||"",amount:x.amount||0})}),Z(Array.from(B.values()))}else Z([])},[ee.process,s]),A.useEffect(()=>{var K;const _=((K=ee.accountHolder)==null?void 0:K.trim())||"";if(_.length>=1&&fe){const B=[],x=new Set;Se.filter(I=>I.accountNumber&&I.accountNumber.trim()!=="").forEach(I=>{const U=I.name.trim(),G=U.toLowerCase(),Q=_.toLowerCase();G.startsWith(Q)&&!x.has(G)&&(x.add(G),B.push({name:U,bankName:I.bankName||"",accountNumber:I.accountNumber||"",source:"contractor"}))}),s.filter(I=>{var U;return I.status==="completed"&&((U=I.bankInfo)==null?void 0:U.accountHolder)}).forEach(I=>{const U=I.bankInfo.accountHolder.trim(),G=U.toLowerCase(),Q=_.toLowerCase();G.startsWith(Q)&&!x.has(G)&&(x.add(G),B.push({name:U,bankName:I.bankInfo.bankName||"",accountNumber:I.bankInfo.accountNumber||"",source:"payment"}))}),ue(B)}else ue([])},[ee.accountHolder,fe,Se,s]);const M=_=>{const K=_.split(`
`).map(Q=>Q.trim()).filter(Q=>Q),B={amounts:{},bankInfo:{},vendor:null,itemName:void 0,includeVat:!1},x=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],I=Q=>{const J=["","","","","","","",""];for(const se of J)if(Q.endsWith(se)&&Q.length>se.length+1)return Q.slice(0,-se.length);return Q},U=Q=>{if(!Q||Q.length<2||Q.length>5||!/^[-]{2,5}$/.test(Q)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Q)||["","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(Q))return!1;if(Q.length>=2){const Ce=Q.charAt(0),Xe=Q.substring(0,2);if(["","","","","","",""].includes(Xe)||x.includes(Ce))return!0}return Q.length>=2&&Q.length<=4},G=K.some(Q=>Q.includes(" ")||Q.includes(""));if(K.forEach((Q,J)=>{if(Q.includes("")&&Q.includes(":")){const se=Q.match(/\s*:\s*(.+)/);se&&(B.itemName=se[1].trim())}if(Q.includes("")&&Q.includes(":")){const se=Q.match(/\s*:\s*(.+)/);se&&(B.bankInfo.accountHolder=se[1].trim())}if(Q.includes("")&&Q.includes(":")){const se=Q.match(/\s*:\s*(.+)/);se&&(B.bankInfo.bankName=se[1].trim())}if(Q.includes("")&&Q.includes(":")){const se=Q.match(/\s*:\s*(.+)/);se&&(B.bankInfo.accountNumber=se[1].trim())}if(Q.includes("")&&Q.includes(":")){const se=Q.match(/\s*:\s*([\d,]+)?/);se&&(B.amounts.total=parseInt(se[1].replace(/,/g,"")))}}),!G){let Q=-1;if(K.forEach(J=>{const se=J.match(/\[([^\]]+)\]/);se&&!B.itemName&&(B.itemName=se[1].trim())}),K.forEach((J,se)=>{if(J.includes("")||J.includes(" ")||J.includes("()")){B.includeVat=!0;const ze=J.match(/(\d+)\s*\s*(\d+)\s*\s*?/),Ae=J.match(/(\d+)\s*\s*?/),Je=J.match(/([\d,]+)\s*/);if(ze){const et=parseInt(ze[1])*1e4+parseInt(ze[2])*1e3;B.amounts.total=et}else if(Ae){const et=parseInt(Ae[1])*1e4;B.amounts.total=et}else if(Je){const et=parseInt(Je[1].replace(/,/g,""));et>=1e3&&(B.amounts.total=et)}return}const Xe=J.match(/=\s*([\d,]+)\s*?/);let Ue=null;if(Xe){const ze=parseInt(Xe[1].replace(/,/g,""));ze>=1e3&&(B.amounts.total=ze)}else{const ze=J.match(/(\d+)\s*\s*(\d+)\s*\s*?/);if(ze){const Ae=parseInt(ze[1])*1e4,Je=parseInt(ze[2])*1e3,et=Ae+Je;J.includes("")||J.includes("")?B.amounts.material=et:J.includes("")||J.includes("")?B.amounts.labor=et:B.amounts.total||(B.amounts.total=et),J=J.replace(/(\d+)\s*\s*(\d+)\s*\s*?/g,""),Ue=ze}else if(Ue=J.match(/(\d+)\s*\s*?/),Ue){const Ae=parseInt(Ue[1])*1e4;J.includes("")||J.includes("")?B.amounts.material=Ae:J.includes("")||J.includes("")?B.amounts.labor=Ae:B.amounts.total||(B.amounts.total=Ae),J=J.replace(/(\d+)\s*\s*?/g,"")}}J.includes("/")&&J.split("/").forEach(Ae=>{const Je=Ae.trim();Je.startsWith("[")||Je.endsWith("]")||(/^[\d\-]+$/.test(Je)&&Je.replace(/\-/g,"").length>=10?B.bankInfo.accountNumber||(B.bankInfo.accountNumber=Je):U(Je)&&!B.bankInfo.accountHolder&&(B.bankInfo.accountHolder=Je))});const pe=[/\d{6}[\s\-]+\d{8}/,/\d{6}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{5,7}[\s\-]+\d{2}[\s\-]+\d{5,7}/,/\d{4}[\s\-]+\d{3}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{4}[\s\-]+\d{2}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{2}[\s\-]+\d{5,6}/,/\d{2,4}[\s\-]+\d{2,5}[\s\-]+\d{2,4}[\s\-]+\d{2,6}/,/\d{3}[\s\-]+\d{2}[\s\-]+\d{6}/,/\d{3}[\s\-]+\d{4}[\s\-]+\d{7}/,/\d{4}[\s\-]+\d{4}[\s\-]+\d{5}/,/\d{3,4}[\s\-]+\d{2,6}[\s\-]+\d{4,7}/,/\d{5,6}[\s\-]+\d{6,8}/,/\d{10,}/];let We="",as=-1;for(const ze of pe){const Ae=J.match(ze);if(Ae&&!B.bankInfo.accountNumber){We=Ae[0],as=Ae.index||-1,B.bankInfo.accountNumber=Ae[0].trim().replace(/\s+/g,"-");const et=J.substring(as+We.length).trim().split(/\s+/);for(const tt of et){if(tt.startsWith("[")||tt.endsWith("]"))continue;const He=I(tt);if(U(He)){B.bankInfo.accountHolder=He;break}}if(!B.bankInfo.accountHolder&&se>0){const He=K[se-1].split(/\s+/);for(const st of He){if(st.startsWith("[")||st.endsWith("]"))continue;const Tt=I(st);if(U(Tt)){B.bankInfo.accountHolder=Tt;break}}}if(!B.bankInfo.accountHolder&&se+1<K.length){const tt=K[se+1],He=tt.split(/\s+/);for(const st of He){if(st.startsWith("[")||st.endsWith("]"))continue;const Tt=I(st);if(U(Tt)){B.bankInfo.accountHolder=Tt;break}}if(!B.bankInfo.accountHolder){const st=tt.match(/^([-]{2,6})/);if(st){const Tt=I(st[1].trim());U(Tt)&&(B.bankInfo.accountHolder=Tt)}}}break}}const Wt=J.match(/[\d,]+/g);if(Wt){const ze=We?We.split(/[\s\-]+/).filter(Ae=>Ae):[];Wt.forEach(Ae=>{const Je=parseInt(Ae.replace(/,/g,"")),et=Ae.replace(/,/g,""),tt=ze.some(He=>He===et);!B.bankInfo.accountNumber&&et.length>=10&&et.length<=20?(B.bankInfo.accountNumber=et,We=et):Je>=1e3&&!Ue&&!tt&&(J.includes("")||J.includes("")?B.amounts.material=Je:J.includes("")||J.includes("")?B.amounts.labor=Je:B.amounts.total||(B.amounts.total=Je))})}const Bt={:"KB",KB:"KB",:"",:"",:"",:"IBK",IBK:"IBK",:"NH",NH:"NH",:"",:"",:"",:"",K:"",:"KDB",KDB:"KDB",:"",:"",:"",:"",:"",:"",SC:"SC",SC:"SC",:"SC",SC:"SC",:"",:"",:"",:""},jt=Object.keys(Bt).sort((ze,Ae)=>Ae.length-ze.length);for(const ze of jt)if(J.includes(ze)){const Ae=Bt[ze];B.bankInfo.bankName=Ae,Q=se;const Je=new RegExp(`${ze}(?:|)?\\s+([-a-zA-Z0-9]{2,10})`),et=J.match(Je);if(et){const tt=I(et[1]);tt&&!/^\d+$/.test(tt)&&tt!==""&&(B.bankInfo.accountHolder=tt)}break}if(!B.bankInfo.bankName){const ze=J.match(/([-]+)(|)/);ze&&(B.bankInfo.bankName=ze[0])}const Bs=[/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\(\)[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/,/\s*[-a-zA-Z0-9]+/];for(const ze of Bs){const Ae=J.match(ze);if(Ae&&!B.bankInfo.accountHolder){B.bankInfo.accountHolder=Ae[0].trim();break}}const qs=J.match(/\(([-]{2,5})\)/);if(qs&&!B.bankInfo.accountHolder){const ze=qs[1];U(ze)&&!["","",""].includes(ze)&&(B.bankInfo.accountHolder=ze)}if(!B.bankInfo.accountHolder){const ze=/[-]{2,6}/g,Ae=J.match(ze);if(Ae){const Je=J.match(/\d{10,}/)||J.match(/\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}[\s\-]+\d{3,4}/),et=J.match(/||||/);Ae.forEach(tt=>{const He=I(tt),st=_.split(`
`)[se];if(st&&st.includes(`[${tt}]`)||!U(He)||["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].includes(He))return;const rs=J.indexOf(tt);if(rs>0){const Jt=J[rs-1];if(/[-]/.test(Jt))return}if(rs+tt.length<J.length){const Jt=J[rs+tt.length];if(/[-]/.test(Jt))return}if(!(qs&&He===qs[1])){if((Je||et)&&!B.bankInfo.accountHolder)B.bankInfo.accountHolder=He;else if(!B.bankInfo.accountHolder){const Jt=/||||/,bn=/\d{6,}/;(se>0&&(bn.test(K[se-1])||Jt.test(K[se-1]))||se<K.length-1&&(bn.test(K[se+1])||Jt.test(K[se+1]))||Jt.test(J))&&(B.bankInfo.accountHolder=He)}}})}}const zt={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};for(const[ze,Ae]of Object.entries(zt))if(J.includes(ze)){B.vendor=Ae;break}if(se===0&&!B.itemName){const ze=J.replace(/[\[\]{}()<>]/g,"").trim();ze&&!ze.includes(" ")&&(U(ze)||(B.itemName=ze.substring(0,50)))}}),Q>=0&&Q+1<K.length){const J=K[Q+1],se=J.trim();if(/^[-]{2,5}$/.test(se)&&U(se))B.bankInfo.accountHolder=se;else{const Ce=J.split(/\s+/);for(const Xe of Ce){const Ue=I(Xe);if(U(Ue)){B.bankInfo.accountHolder=Ue;break}}}}}if(B.itemName&&B.itemName.includes("")&&(B.vendor=""),B.itemName){const Q=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","KB","NH","IBK","SC","","",""],J=B.itemName.toLowerCase(),se=Q.some(pe=>J===pe.toLowerCase()||J.startsWith(pe.toLowerCase()+" ")||J.replace(/\s+/g,"").match(/^[\d\-\s]+$/)),Ce=/^[\d\-\s]/.test(B.itemName),Xe=/^\d{2,}[\s\-]?\d+/.test(B.itemName.replace(/[-]/g,"").trim()),Ue=B.bankInfo.accountHolder&&(B.itemName===B.bankInfo.accountHolder||B.itemName.includes(B.bankInfo.accountHolder));(se||Ce||Xe||Ue)&&(B.itemName=void 0)}return B},Ne=async()=>{var _,K,B,x,I,U,G,Q,J,se,Ce;try{const Xe=ee.quickText;if(!Xe.trim())return;let Ue=s;s.length===0&&(console.log("payments  ,  ..."),await e(),await new Promise(Ae=>setTimeout(Ae,100)),Ue=er.getState().payments,console.log("payments  :",Ue.length,""));const pe=M(Xe);console.log("  :",pe);const We={project:ee.project,date:ee.date,quickText:ee.quickText,quickImages:ee.quickImages||[],process:"",itemName:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[]};P(null),L(!1),oe(!1);let as=0;pe.amounts.material&&(as+=pe.amounts.material),pe.amounts.labor&&(as+=pe.amounts.labor),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&(as=pe.amounts.total),as>0&&(We.amount=as),pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),pe.bankInfo.accountHolder&&(We.accountHolder=pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&(We.accountNumber=pe.bankInfo.accountNumber);const Wt=Ae=>Ae?Ae.replace(/[^0-9]/g,""):"",Bt=(Ae,Je)=>{if(!Ae||!Je)return!1;const et=Wt(Ae),tt=Wt(Je);if(!et||!tt)return!1;const He=6;return et.length<He||tt.length<He?et===tt:tt.includes(et)||et.includes(tt)},jt=Wt(pe.bankInfo.accountNumber||""),Bs=pe.bankInfo.accountHolder||"";let qs=!1;console.log("===    ==="),console.log(" :",pe.bankInfo.accountNumber),console.log(" :",jt),console.log(" :",Bs),console.log(" :",Se.length),console.log("  :",Ue.filter(Ae=>Ae.status==="completed").length);let zt=Se.find(Ae=>{const Je=Wt(Ae.accountNumber||"");return Je&&Je===jt});if(!zt&&jt&&(zt=Se.find(Ae=>{const Je=Wt(Ae.accountNumber||"");return Bt(jt,Je)})),zt&&(qs=!0),!zt&&Bs&&(zt=Se.find(Ae=>Ae.name===Bs),zt)){console.log("  :",zt.name);const Ae=((_=zt.accountNumber)==null?void 0:_.replace(/[-\s]/g,""))||"";jt&&!Bt(jt,Ae)?(console.log("    ( ) -  "),qs=!1):qs=!0}if(zt&&(zt.name&&(We.accountHolder=zt.name,console.log("  :",zt.name)),zt.bankName?We.bankName=zt.bankName:pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),qs&&(We.accountNumber=zt.accountNumber||pe.bankInfo.accountNumber),P(zt.id||zt._id||null),zt.process&&(We.process=zt.process)),!zt){let Ae=!1;console.log("===     ==="),console.log("  payments :",Ue.length,""),console.log(" :",jt),console.log(" :",Bs);const Je=Ue.filter(st=>st.status==="completed");console.log(" :",Je.length);const et=[...new Set(Je.map(st=>{var Tt;return(Tt=st.bankInfo)==null?void 0:Tt.accountHolder}).filter(Boolean))];console.log("   ( 20):",et.slice(0,20)),console.log("  ():",jt);const tt=Je.filter(st=>{var Tt;return(Tt=st.bankInfo)==null?void 0:Tt.accountNumber}).map(st=>{var Tt,rs,Jt;return{holder:(Tt=st.bankInfo)==null?void 0:Tt.accountHolder,account:(rs=st.bankInfo)==null?void 0:rs.accountNumber,clean:Wt(((Jt=st.bankInfo)==null?void 0:Jt.accountNumber)||"")}}).filter(st=>st.clean.includes(jt.substring(0,6))||jt.includes(st.clean.substring(0,6)));console.log("  :",tt);let He=Ue.find(st=>{var Jt;const Tt=Wt(((Jt=st.bankInfo)==null?void 0:Jt.accountNumber)||"");return Tt&&Tt===jt&&st.status==="completed"});if(He&&console.log("   :",(K=He.bankInfo)==null?void 0:K.accountHolder,He.process),!He&&jt&&(He=Ue.find(st=>{var rs;const Tt=Wt(((rs=st.bankInfo)==null?void 0:rs.accountNumber)||"");return Bt(jt,Tt)&&st.status==="completed"}),He&&console.log("   :",(B=He.bankInfo)==null?void 0:B.accountHolder,He.process)),He&&(Ae=!0),!He&&Bs&&(He=Ue.find(st=>{var Tt;return((Tt=st.bankInfo)==null?void 0:Tt.accountHolder)===Bs&&st.status==="completed"}),He)){console.log("    :",(x=He.bankInfo)==null?void 0:x.accountHolder,":",He.process);const st=Wt(((I=He.bankInfo)==null?void 0:I.accountNumber)||"");jt&&!Bt(jt,st)?(console.log("    ( ) -  "),Ae=!1):Ae=!0}He?(console.log(" :",{accountHolder:(U=He.bankInfo)==null?void 0:U.accountHolder,accountNumber:(G=He.bankInfo)==null?void 0:G.accountNumber,bankName:(Q=He.bankInfo)==null?void 0:Q.bankName,process:He.process,status:He.status,paymentMatchedByAccountNumber:Ae}),(J=He.bankInfo)!=null&&J.accountHolder&&(We.accountHolder=He.bankInfo.accountHolder,console.log("  :",He.bankInfo.accountHolder)),(se=He.bankInfo)!=null&&se.bankName?We.bankName=He.bankInfo.bankName:pe.bankInfo.bankName&&(We.bankName=pe.bankInfo.bankName),Ae&&(We.accountNumber=((Ce=He.bankInfo)==null?void 0:Ce.accountNumber)||pe.bankInfo.accountNumber),He.process&&!We.process?(We.process=He.process,console.log("    :",He.process)):console.log("   - process:",He.process,"updatedFormData.process:",We.process)):console.log("  ")}if(pe.vendor&&(We.process=pe.vendor),!We.process){const Ae=Xe.toLowerCase();for(const Je of Xc)if(Ae.includes(Je.toLowerCase())){We.process=Je;break}}pe.itemName&&(We.itemName=pe.itemName),Ye(We),pe.includeVat&&(L(!0),oe(!1));const ze=[];if(pe.amounts.material||pe.amounts.labor||pe.amounts.total){const Ae=[];pe.amounts.material&&Ae.push(`: ${pe.amounts.material.toLocaleString()}`),pe.amounts.labor&&Ae.push(`: ${pe.amounts.labor.toLocaleString()}`),pe.amounts.total&&!pe.amounts.material&&!pe.amounts.labor&&Ae.push(`: ${pe.amounts.total.toLocaleString()}`),ze.push(Ae.join(", "))}if(pe.bankInfo.bankName||pe.bankInfo.accountHolder){const Ae=[];pe.bankInfo.bankName&&Ae.push(pe.bankInfo.bankName),pe.bankInfo.accountHolder&&Ae.push(pe.bankInfo.accountHolder),pe.bankInfo.accountNumber&&Ae.push(pe.bankInfo.accountNumber),Ae.length>0&&ze.push(`: ${Ae.join(" ")}`)}pe.vendor&&ze.push(`: ${pe.vendor}`),pe.includeVat&&ze.push("  "),ze.length>0?ne.success(`  !
${ze.join(`
`)}`,{duration:4e3,style:{whiteSpace:"pre-line"}}):ne.info("  ...    .")}catch(Xe){console.error(" :",Xe),ne.error("   .")}};A.useEffect(()=>{(async()=>{try{await Hw();const K=await Rw();Ze(K),Rs(!0)}catch(K){console.error("  :",K),Rs(!0)}})()},[]);const _e=A.useRef({});A.useEffect(()=>{ke&&(Object.entries(Fe).forEach(([_,K])=>{JSON.stringify(_e.current[_])!==JSON.stringify(K)&&Bw(_,K).catch(B=>{console.error("  :",B),ne.error("  ")})}),_e.current={...Fe})},[Fe,ke]);const Pe=A.useCallback(async _=>{var x;const K=(x=_.clipboardData)==null?void 0:x.items;if(!K)return;let B=!1;for(let I=0;I<K.length;I++)if(K[I].type.indexOf("image")!==-1){B=!0;break}if(B){if(!f){const I=document.activeElement;(I==null?void 0:I.tagName)==="INPUT"||(I==null?void 0:I.tagName)==="TEXTAREA"||(I==null?void 0:I.classList.contains("form-input"))||ne.error("  ");return}for(let I=0;I<K.length;I++)if(K[I].type.indexOf("image")!==-1){_.preventDefault();const U=K[I].getAsFile();if(U){const G=new FileReader;G.onload=async Q=>{var se;const J=(se=Q.target)==null?void 0:se.result;if(J)try{const Ce=s.find(pe=>pe.id===f),Ue=[...(Ce==null?void 0:Ce.images)||Fe[f]||[],J];await ln.updatePaymentImages(f,Ue),Ze(pe=>({...pe,[f]:Ue})),await e(),ne.success(" ")}catch(Ce){console.error("  :",Ce),ne.error("  ")}},G.readAsDataURL(U)}}}},[f,s,Fe,e]);A.useEffect(()=>(document.addEventListener("paste",Pe),()=>document.removeEventListener("paste",Pe)),[Pe]);const _t=[...(l==null?void 0:l.name)===""?s.filter(_=>u.some(K=>K.name===_.project)):s].sort((_,K)=>new Date(K.requestDate).getTime()-new Date(_.requestDate).getTime()),yt=_t.filter(_=>{var U,G,Q;if(!_||!_.id)return!1;const K=m===""||((U=_.purpose)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((G=_.itemName)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((Q=_.process)==null?void 0:Q.toLowerCase().includes(m.toLowerCase())),B=he==="pending"?_.status!=="completed":_.status==="completed",x=ft==="all"||!ft||_.project===ft,I=!Ot||he!=="completed"||_.requestedBy===(l==null?void 0:l.name);return K&&B&&x&&I}).sort((_,K)=>!_&&!K?0:_?K?he==="completed"?sl(K.completionDate)-sl(_.completionDate):sl(K.requestDate)-sl(_.requestDate):-1:1),Xt=_=>{const K=_.id||_._id||null;if(ut===K){P(null);const U=document.querySelector('input[placeholder=" "]');U&&setTimeout(()=>{U.focus()},100);return}P(K);const B=Xo(_.name);let x=_.bankName||"",I=_.accountNumber||"";if(I&&!x){const U=I.trim().split(/\s+/);if(U.length>=2){const G=U[0];(G.includes("")||G.includes("")||G.includes("")||G.includes("")||G.includes(""))&&(x=G,I=U.slice(1).join(""))}}Ye(U=>({...U,accountHolder:B,bankName:x,accountNumber:I}))};yt.reduce((_,K)=>{const B=K.materialAmount||0,x=K.laborAmount||0,I=K.amount||0;let U=B,G=x,Q=0;return B===0&&x===0&&I>0?K.includesVAT?(U=Math.round(I/1.1),Q=I-U):(U=I,Q=0):K.includesVAT?(B>0&&(U=Math.round(B/1.1)),x>0&&(G=Math.round(x/1.1)),Q=I-(U+G)):Q=0,_.material+=U,_.labor+=G,_.vat+=Q,_.total+=I,_},{material:0,labor:0,vat:0,total:0});const kt=async()=>{var K;if(mt){console.log(" Already submitting, ignoring click");return}if(console.log(" handleSave called"),console.log(" Current user:",l),console.log(" Form data:",ee),!ee.project){ne.error(" ");return}if(!ee.itemName){ne.error(" ");return}const _=Number(ee.amount)||0;if(_===0){ne.error(" ");return}ds(!0);try{const B=q?Math.round(_*.967):_,x=new Date;if(y){const I={project:ee.project,requestDate:new Date(ee.date),purpose:ee.itemName,amount:B,category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:R,applyTaxDeduction:q,materialAmount:B,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,updatedAt:x};console.log(" Updating payment:",I),await i(y,I),ne.success(" "),T(null)}else{const I=ee.project||"",U={id:`payment_${Date.now()}`,project:I,requestDate:new Date(ee.date),requestedBy:(l==null?void 0:l.name)||"  ",purpose:ee.itemName,amount:B,status:"pending",category:"material",urgency:"normal",process:ee.process,itemName:ee.itemName,includesVAT:R,applyTaxDeduction:q,materialAmount:B,laborAmount:0,originalLaborAmount:0,accountHolder:ee.accountHolder,bank:ee.bankName,accountNumber:ee.accountNumber,bankInfo:ee.accountHolder||ee.bankName||ee.accountNumber?{accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber}:void 0,quickText:ee.quickText||"",images:ee.quickImages,attachments:[],createdAt:x,updatedAt:x};console.log(" Creating payment:",U),console.log(" Images in payment:",((K=ee.quickImages)==null?void 0:K.length)||0,"");const G=await n(U);if(Be.current=G,setTimeout(()=>{Be.current=null},1e4),ne.success(" "),ee.accountHolder&&ee.bankName&&ee.accountNumber){const Q=R||q?"01074088864":"01089423283";try{await ln.sendTossPaymentSms({recipientPhone:Q,accountHolder:ee.accountHolder,bankName:ee.bankName,accountNumber:ee.accountNumber,amount:B,projectName:I,itemName:ee.itemName,process:ee.process,paymentId:G}),ne.success("   ")}catch(J){console.error("SMS  :",J)}}}Ye(I=>({project:I.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),L(!1),oe(!1),P(null),window.innerWidth<768&&j("list")}catch(B){console.error(" Payment save error:",B),ne.error("  : "+B.message)}finally{ds(!1)}},fs=_=>{var K,B,x,I;try{console.log("[handleEdit] Starting edit for payment:",_.id);const U=_.originalMaterialAmount!==void 0?_.originalMaterialAmount:_.materialAmount||0,G=_.originalLaborAmount!==void 0?_.originalLaborAmount:_.laborAmount||0,Q={project:_.project||"",date:_.requestDate?Ft(new Date(_.requestDate),"yyyy-MM-dd"):Ft(new Date,"yyyy-MM-dd"),process:_.process||"",itemName:_.itemName||_.purpose||"",materialCost:U>0?U.toString():"",laborCost:G>0?G.toString():"",amount:((K=_.amount)==null?void 0:K.toString())||"",accountHolder:((B=_.bankInfo)==null?void 0:B.accountHolder)||"",bankName:((x=_.bankInfo)==null?void 0:x.bankName)||"",accountNumber:((I=_.bankInfo)==null?void 0:I.accountNumber)||"",images:_.attachments||[],quickText:_.quickText||"",quickImages:_.images||[]};console.log("[handleEdit] Setting form data:",Q),Ye(Q),L(_.includesVAT||!1),oe(_.applyTaxDeduction||!1),h(_.id),T(_.id),S&&j("form"),console.log("[handleEdit] Edit setup complete"),ne.success("  ")}catch(U){console.error("[handleEdit] Error:",U),ne.error("     ")}},ns=async _=>{var K,B,x;try{const I=((K=_.bankInfo)==null?void 0:K.accountHolder)||_.accountHolder,U=((B=_.bankInfo)==null?void 0:B.bankName)||_.bank,G=((x=_.bankInfo)==null?void 0:x.accountNumber)||_.accountNumber;if(!I||!U||!G){ne.error("  .    .");return}if(!window.confirm(`  ?

: 
: ${U}
: ${G}
: ${_.amount.toLocaleString()}`))return;const J=G.replace(/[-\s]/g,""),se=l1[U]||U,Ce=a1[U]||"004",Xe="",Ue=`supertoss://send?amount=${_.amount}&bankCode=${Ce}&bank=${encodeURIComponent(se)}&accountNo=${J}&receiverName=${encodeURIComponent(Xe)}&toName=${encodeURIComponent(Xe)}`;let pe=!1;try{window.location.href=Ue,pe=!0,ne.success("  ...",{duration:3e3}),setTimeout(()=>{const We=/iPhone|iPad|iPod/i.test(navigator.userAgent),as=/Android/i.test(navigator.userAgent);(We||as)&&ne(`      .

: 
: ${G}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:8e3})},2e3)}catch(We){console.error("   :",We),ne(`   .

: 
: ${U}
: ${G}
: ${_.amount.toLocaleString()}

    .`,{icon:"",duration:1e4})}}catch(I){console.error(" :",I),ne.error(`   : ${I.message}`)}},Ts=async _=>{const K=s.find(B=>B.id===_);if(K&&K.quickText){const B=localStorage.getItem("executionMemos"),x=B?JSON.parse(B):{};x[_]=K.quickText,localStorage.setItem("executionMemos",JSON.stringify(x))}o(_,{status:"completed",completionDate:new Date}),de(!1),Re("completed"),ne.success(" "),window.dispatchEvent(new CustomEvent("paymentCompleted"));try{await i(_,{status:"completed"});const B=Nr.getSocket();B&&B.emit("payment:refresh",{paymentId:_,status:"completed"})}catch(B){console.error(" API :",B),o(_,{status:"pending",completionDate:void 0}),Re("pending"),ne.error("   -  ")}},fn=async _=>{var x;if(!f){ne.error("  ");return}const B=Array.from(((x=_.target)==null?void 0:x.files)||[]).filter(I=>I.type.startsWith("image/"));if(B.length!==0){try{const I=await Promise.all(B.map(J=>new Promise((se,Ce)=>{const Xe=new FileReader;Xe.onload=Ue=>{var We;const pe=(We=Ue.target)==null?void 0:We.result;pe?se(pe):Ce(new Error("  "))},Xe.onerror=()=>Ce(new Error("FileReader ")),Xe.readAsDataURL(J)}))),U=s.find(J=>J.id===f),Q=[...(U==null?void 0:U.images)||Fe[f]||[],...I];await ln.updatePaymentImages(f,Q),Ze(J=>({...J,[f]:Q})),await e(),ne.success(`${I.length}  `)}catch(I){console.error("  :",I),ne.error("  ")}_.target.value=""}},Ys=async _=>{if(f)try{const K=s.find(I=>I.id===f),x=((K==null?void 0:K.images)||Fe[f]||[]).filter((I,U)=>U!==_);await ln.updatePaymentImages(f,x),Ze(I=>({...I,[f]:x})),await e()}catch(K){console.error("  :",K),ne.error("  ")}},pn=_=>{N(_),O(!0)},Qr=_=>{_.preventDefault(),V(!0)},Tn=_=>{_.preventDefault(),V(!1)},en=async _=>{if(_.preventDefault(),V(!1),!f){ne.error("  ");return}const B=Array.from(_.dataTransfer.files).filter(x=>x.type.startsWith("image/"));if(B.length!==0)try{const x=await Promise.all(B.map(Q=>new Promise((J,se)=>{const Ce=new FileReader;Ce.onload=Xe=>{var pe;const Ue=(pe=Xe.target)==null?void 0:pe.result;Ue?J(Ue):se(new Error("  "))},Ce.onerror=()=>se(new Error("FileReader ")),Ce.readAsDataURL(Q)}))),I=s.find(Q=>Q.id===f),G=[...(I==null?void 0:I.images)||Fe[f]||[],...x];await ln.updatePaymentImages(f,G),Ze(Q=>({...Q,[f]:G})),await e(),ne.success(`${x.length}  `)}catch(x){console.error("  :",x),ne.error("  ")}};return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"lg:hidden mb-4",children:a.jsxDEV("select",{value:ee.project,onChange:_=>{Ye({...ee,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"w-full px-3 py-2.5 md:py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2511,columnNumber:35},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2513,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2501,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2500,columnNumber:7},void 0),a.jsxDEV("div",{className:"lg:hidden border-b border-gray-200 mb-4",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:a.jsxDEV("nav",{className:"flex space-x-4",children:[a.jsxDEV("button",{onClick:()=>j("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="form"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2522,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="list"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2532,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>j("image"),className:`py-2 px-1 border-b-2 font-medium text-sm ${E==="image"?"border-gray-900 text-gray-900":"border-transparent text-gray-500"}`,children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2542,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2521,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2520,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2519,columnNumber:7},void 0),a.jsxDEV("div",{className:"payment-container grid grid-cols-1 md:grid-cols-6 ipad:grid-cols-6 ipad-lg:grid-cols-6 ipad-xl:grid-cols-12 ipad-2xl:grid-cols-12 gap-3 md:gap-4",children:[a.jsxDEV("div",{className:`payment-form md:col-span-2 ipad:col-span-2 ipad-lg:col-span-2 ipad-xl:col-span-2 ipad-2xl:col-span-2 bg-white rounded-lg border p-3 md:p-4 overflow-y-auto h-[calc(100vh-180px)] ${E!=="form"?"hidden md:block":""}`,children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("div",{className:"hidden lg:block payment-project-row",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("select",{value:ee.project,onChange:_=>{Ye({...ee,project:_.target.value}),_.target.value&&localStorage.setItem("lastSelectedProject",_.target.value)},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(l==null?void 0:l.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2577,columnNumber:43},void 0),u.filter(_=>_.status!=="completed").map(_=>a.jsxDEV("option",{value:_.name,children:_.name},_.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2579,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2567,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:_=>Ye({...ee,bankName:_.target.value}),className:"payment-bank-select hidden px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-8",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2587,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2588,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2589,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2590,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2591,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2592,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2593,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2594,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2595,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2596,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2597,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2598,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2599,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2582,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2566,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2565,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("textarea",{value:ee.quickText,onChange:_=>Ye({...ee,quickText:_.target.value}),onPaste:_=>{var B;const K=(B=_.clipboardData)==null?void 0:B.items;if(K){for(let x=0;x<K.length;x++)if(K[x].type.indexOf("image")!==-1){_.preventDefault();const I=K[x].getAsFile();if(I){const U=new FileReader;U.onload=G=>{var J;const Q=(J=G.target)==null?void 0:J.result;Ye(se=>({...se,quickImages:[...se.quickImages,Q]}))},U.readAsDataURL(I)}break}}},onDragOver:_=>{_.preventDefault(),_.stopPropagation()},onDrop:_=>{_.preventDefault(),_.stopPropagation(),Array.from(_.dataTransfer.files).filter(x=>x.type.startsWith("image/")).forEach(x=>{const I=new FileReader;I.onload=U=>{var Q;const G=(Q=U.target)==null?void 0:Q.result;Ye(J=>({...J,quickImages:[...J.quickImages,G]}))},I.readAsDataURL(x)})},rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:S?"  ":"   (   Ctrl+V)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2606,columnNumber:15},void 0),ee.quickImages.length>0&&a.jsxDEV("div",{className:"mt-2 mb-2 grid grid-cols-3 gap-2",children:ee.quickImages.map((_,K)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:_,alt:` ${K+1}`,className:"w-full h-20 object-cover rounded-lg border"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2661,columnNumber:23},void 0),a.jsxDEV("button",{type:"button",onClick:()=>{Ye(B=>({...B,quickImages:B.quickImages.filter((x,I)=>I!==K)}))},className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2666,columnNumber:23},void 0)]},K,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2660,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2658,columnNumber:17},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxDEV("label",{className:"cursor-pointer",children:[a.jsxDEV("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_=>{Array.from(_.target.files||[]).forEach(B=>{const x=new FileReader;x.onload=I=>{var G;const U=(G=I.target)==null?void 0:G.result;Ye(Q=>({...Q,quickImages:[...Q.quickImages,U]}))},x.readAsDataURL(B)}),_.target.value=""}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2685,columnNumber:19},void 0),a.jsxDEV("div",{className:"w-full h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium border border-gray-300",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2706,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2684,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",onClick:Ne,className:"h-10 flex items-center justify-center bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition-colors text-sm font-medium",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2710,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2683,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2605,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",ee.date&&`(${Ft(new Date(ee.date),"E",{locale:xs})})`]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2723,columnNumber:17},void 0),a.jsxDEV("input",{type:"date",value:ee.date,onChange:_=>Ye({...ee,date:_.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 cursor-pointer text-gray-900",style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundColor:"white",backgroundImage:"none"}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2726,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2722,columnNumber:15},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2742,columnNumber:17},void 0),a.jsxDEV("button",{ref:Me,type:"button",onClick:()=>De(!0),className:"w-full px-3 py-2 border rounded-lg text-left bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500",children:ee.process||a.jsxDEV("span",{className:"text-gray-400",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2749,columnNumber:40},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2743,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2741,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2721,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2756,columnNumber:15},void 0),a.jsxDEV("input",{type:"text",value:ee.itemName,onChange:_=>Ye({...ee,itemName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2757,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2755,columnNumber:13},void 0),a.jsxDEV("div",{className:"space-y-2 payment-amount-section",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2768,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("input",{type:"text",value:ee.amount?Number(ee.amount).toLocaleString():"",onChange:_=>{const K=_.target.value.replace(/[^0-9]/g,"");Ye({...ee,amount:K})},className:"w-full px-3 py-2 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2770,columnNumber:19},void 0),a.jsxDEV("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2781,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2769,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2767,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-center gap-4",children:[a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{R||oe(!1),L(!R)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${R?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:R&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2799,columnNumber:36},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2798,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"  (10%)"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2801,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2787,columnNumber:17},void 0),a.jsxDEV("button",{type:"button",className:"flex items-center cursor-pointer",onMouseDown:_=>_.preventDefault(),onClick:()=>{q||L(!1),oe(!q)},children:[a.jsxDEV("div",{className:`h-4 w-4 border rounded flex items-center justify-center ${q?"bg-gray-600 border-gray-600":"border-gray-300"}`,children:q&&a.jsxDEV("span",{className:"text-white text-xs",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2817,columnNumber:45},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2816,columnNumber:19},void 0),a.jsxDEV("span",{className:"ml-2 text-sm text-gray-700",children:"3.3% "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2819,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2805,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2786,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2766,columnNumber:13},void 0),a.jsxDEV("div",{className:"payment-account-section border-t pt-3 space-y-2",children:[(St.length>0||F.length>0&&!ut)&&a.jsxDEV("div",{className:"payment-suggestions-row grid grid-cols-2 gap-2",children:[a.jsxDEV("div",{className:`payment-contractor-suggestions bg-amber-50 border border-amber-200 rounded-lg p-2 ${St.length===0?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-amber-900 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2835,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:St.map(_=>{const K=_.id||_._id,B=ut===K;return a.jsxDEV("button",{type:"button",onClick:()=>Xt(_),className:`w-full text-left px-2 py-1.5 rounded border transition-colors ${B?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}`,children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:Xo(_.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2851,columnNumber:29},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName||""," ",_.accountNumber||""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2854,columnNumber:29},void 0)]},K,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2841,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2836,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2832,columnNumber:19},void 0),a.jsxDEV("div",{className:`payment-history-suggestions bg-blue-50 border border-blue-200 rounded-lg p-2 ${F.length===0||ut?"hidden":""}`,children:[a.jsxDEV("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2867,columnNumber:21},void 0),a.jsxDEV("div",{className:"space-y-1 max-h-56 overflow-y-auto",children:F.map((_,K)=>a.jsxDEV("button",{type:"button",onClick:()=>{Ye(B=>({...B,accountHolder:_.accountHolder,bankName:_.bankName,accountNumber:_.accountNumber})),Z([])},className:"w-full text-left px-2 py-1.5 rounded border border-blue-200 bg-white hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[a.jsxDEV("div",{className:"font-medium text-xs text-gray-900",children:_.accountHolder},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2884,columnNumber:27},void 0),a.jsxDEV("div",{className:"text-[10px] text-gray-500 truncate",children:[_.bankName," ",_.accountNumber]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2887,columnNumber:27},void 0)]},K,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2870,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2868,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2864,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2830,columnNumber:17},void 0),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2899,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountHolder,onChange:_=>Ye({...ee,accountHolder:_.target.value}),onFocus:()=>Ve(!0),onBlur:()=>setTimeout(()=>Ve(!1),150),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2900,columnNumber:17},void 0),fe&&be.length>0&&a.jsxDEV("div",{className:"absolute z-20 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:be.map((_,K)=>a.jsxDEV("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-100 border-b last:border-b-0 flex justify-between items-center",onMouseDown:B=>B.preventDefault(),onClick:()=>{let B=_.bankName||"",x=_.accountNumber||"";const I=["KB","","","","","","","","","NH","","","IBK","","","SC","","","","","","","","","","","","","KDB","","","","","","","","",""],U={:"KB",:"KB",:"",:"",:"",:"NH",:"NH",:"IBK",:"IBK",:"SC",:"",:"",:"",:"",:"KDB",:""};for(const G of I)if(x.includes(G)){B||(B=U[G]||G),x=x.replace(G,"").trim();break}for(const G of I)if(B.includes(G)){const Q=U[G]||G,J=B.replace(G,"").trim();J&&/\d/.test(J)&&(x=J),B=Q;break}x=x.replace(/[^\d\-]/g,"").trim(),Ye({...ee,accountHolder:_.name,bankName:B||ee.bankName,accountNumber:x||ee.accountNumber}),Ve(!1)},children:[a.jsxDEV("span",{className:"font-medium",children:_.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3e3,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:_.source==="contractor"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3001,columnNumber:25},void 0)]},`${_.name}-${K}`,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2913,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2911,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2898,columnNumber:15},void 0),a.jsxDEV("div",{className:"payment-bank-field",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3012,columnNumber:17},void 0),a.jsxDEV("select",{value:ee.bankName,onChange:_=>Ye({...ee,bankName:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",children:[a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3018,columnNumber:19},void 0),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3019,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3020,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3021,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3022,columnNumber:19},void 0),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3023,columnNumber:19},void 0),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3024,columnNumber:19},void 0),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3025,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3026,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3027,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3028,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3029,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3030,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3031,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3032,columnNumber:19},void 0),a.jsxDEV("option",{value:"KDB",children:"KDB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3033,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3034,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3035,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3036,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3037,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3038,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3039,columnNumber:19},void 0),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3040,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3013,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3011,columnNumber:15},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3045,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:ee.accountNumber,onChange:_=>Ye({...ee,accountNumber:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",placeholder:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3046,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3044,columnNumber:15},void 0),a.jsxDEV("div",{className:"pt-2 border-t",children:a.jsxDEV("div",{className:"flex justify-between items-baseline",children:[a.jsxDEV("span",{className:"font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3057,columnNumber:19},void 0),a.jsxDEV("div",{className:"text-right",children:[(R||q)&&a.jsxDEV("span",{className:"text-xs text-gray-500 mr-2",children:["(",R&&" ",q&&"3.3% ",")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3060,columnNumber:23},void 0),a.jsxDEV("span",{className:"font-semibold",children:[(()=>{const _=Number(ee.amount)||0;let K=_;return q&&(K=Math.round(_*.967)),K.toLocaleString()})(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3064,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3058,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3056,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3055,columnNumber:15},void 0),a.jsxDEV("div",{className:"mt-6 lg:my-[50px]",children:[y&&a.jsxDEV("button",{onClick:()=>{T(null),Ye(_=>({project:_.project,date:Ft(new Date,"yyyy-MM-dd"),process:"",itemName:"",materialCost:"",laborCost:"",amount:"",accountHolder:"",bankName:"",accountNumber:"",images:[],quickText:"",quickImages:[]})),L(!1),oe(!1),P(null),ne.info(" ")},className:"w-full py-2 mb-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 touch-manipulation",style:{minHeight:"48px"},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3083,columnNumber:19},void 0),a.jsxDEV("button",{onClick:_=>{console.log(" Payment button clicked!",_),console.log(" Button element:",_.currentTarget),console.log(" Form data:",ee),kt()},disabled:mt,className:`w-full py-3 rounded-lg touch-manipulation font-medium text-base ${mt?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800 active:bg-gray-950"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent"},children:mt?"...":y?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3112,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3081,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2827,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2563,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2560,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-list md:col-span-4 ipad:col-span-4 ipad-lg:col-span-4 ipad-xl:col-span-4 ipad-2xl:col-span-4 bg-white rounded-lg border overflow-hidden flex flex-col h-[calc(100vh-180px)] ${E!=="list"?"hidden md:flex":""}`,children:[a.jsxDEV("div",{className:"bg-gray-50 px-4 pt-3 pb-0 flex-shrink-0",children:a.jsxDEV("div",{className:"flex items-center justify-between gap-4",children:a.jsxDEV("nav",{className:"flex gap-2 overflow-x-auto flex-1",children:[a.jsxDEV("button",{onClick:()=>Re("pending"),className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="pending"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="pending"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:_t.filter(_=>_&&_.id&&_.status!=="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3151,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3142,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Re("completed"),Ye(_=>({..._,project:""}))},className:`px-4 py-2.5 rounded-t-lg font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${he==="completed"?"bg-white text-gray-900 shadow-sm border-b-2 border-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:["",a.jsxDEV("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${he==="completed"?"bg-gray-900 text-white":"bg-gray-300 text-gray-600"}`,children:_t.filter(_=>_&&_.id&&_.status==="completed").length},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3170,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3157,columnNumber:17},void 0),he==="completed"&&a.jsxDEV("label",{className:"ml-3 flex items-center gap-1.5 cursor-pointer text-xs text-gray-600",children:[a.jsxDEV("input",{type:"checkbox",checked:Ot,onChange:_=>{ae(_.target.checked),localStorage.setItem("payments_showMyRequestsOnly",String(_.target.checked))},className:"w-3.5 h-3.5 rounded border-gray-300 text-gray-600 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3179,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3178,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3141,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3140,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3139,columnNumber:11},void 0),a.jsxDEV("div",{className:"border-b border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3194,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-auto p-4",children:yt.length>0?a.jsxDEV("div",{className:"space-y-4",children:yt.map(_=>{var G,Q,J;const K=_.amount||0,B=((G=_.bankInfo)==null?void 0:G.accountHolder)||_.accountHolder||"",x=((Q=_.bankInfo)==null?void 0:Q.bankName)||_.bank||"",I=((J=_.bankInfo)==null?void 0:J.accountNumber)||_.accountNumber||"",U=B&&x&&I?`${B} | ${x} ${I}`:" ";return a.jsxDEV("div",{onClick:()=>h(_.id),className:`border rounded-lg p-3 cursor-pointer transition-colors ${f===_.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-400"}`,children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2.5",children:[a.jsxDEV("div",{className:"flex-1 min-w-0",children:[a.jsxDEV("div",{className:"flex items-baseline gap-2",children:[_.process&&a.jsxDEV("span",{className:"text-xs text-gray-500 shrink-0",children:["[",_.process,"]"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3226,columnNumber:31},void 0),a.jsxDEV("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:_.purpose||_.itemName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3228,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3224,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:_.project||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3232,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3223,columnNumber:25},void 0),a.jsxDEV("div",{className:"text-right ml-3 shrink-0",children:[a.jsxDEV("p",{className:"text-base font-bold text-gray-900",children:[K.toLocaleString(),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3235,columnNumber:27},void 0),a.jsxDEV("p",{className:"text-[10px] text-gray-400",children:[_.requestedBy||"-","  ",qp(_.requestDate,"MM/dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3238,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3234,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3222,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 mb-2.5 text-xs",children:[a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.materialAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3246,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3247,columnNumber:25},void 0),a.jsxDEV("span",{className:"text-gray-400",children:[" ",(_.laborAmount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3248,columnNumber:25},void 0),_.includesVAT&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3251,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-700 text-[10px] rounded",children:"VAT"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3250,columnNumber:27},void 0),_.applyTaxDeduction&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("span",{className:"text-gray-300",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3257,columnNumber:29},void 0),a.jsxDEV("span",{className:"px-1.5 py-0.5 bg-purple-50 text-purple-700 text-[10px] rounded",children:"3.3%"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3258,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3256,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3245,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsxDEV("div",{className:"text-xs text-gray-500 truncate flex-1",children:U},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3265,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[a.jsxDEV("button",{onClick:se=>{se.stopPropagation(),fs(_)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"",children:a.jsxDEV(VN,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3277,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3269,columnNumber:27},void 0),a.jsxDEV("button",{onClick:async se=>{se.stopPropagation(),window.confirm("  ?")&&(await r(_.id),ne.success(""))},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(oi,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3290,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3279,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3268,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3264,columnNumber:23},void 0),he==="pending"&&(l==null?void 0:l.role)&&["manager","admin"].includes(l.role)&&a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("button",{onClick:se=>{if(se.stopPropagation(),_.status==="completed"){ne.info("   ");return}ns(_)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 rounded text-xs font-medium transition-colors ${_.status==="completed"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-800"}`,children:_.status==="completed"?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3299,columnNumber:27},void 0),a.jsxDEV("button",{onClick:se=>{se.stopPropagation(),Ts(_.id)},disabled:_.status==="completed",className:`flex-1 py-1.5 px-2 text-white rounded text-xs font-medium transition-colors ${_.status==="completed"?"opacity-50 cursor-not-allowed":""}`,style:{backgroundColor:_.status==="completed"?"#9ca3af":"#5f81a5"},onMouseEnter:se=>{_.status!=="completed"&&(se.currentTarget.style.backgroundColor="#4a6b8a")},onMouseLeave:se=>{_.status!=="completed"&&(se.currentTarget.style.backgroundColor="#5f81a5")},children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3317,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3298,columnNumber:25},void 0)]},_.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3212,columnNumber:21},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3198,columnNumber:15},void 0):a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3348,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3196,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3135,columnNumber:9},void 0),a.jsxDEV("div",{className:`payment-images md:col-span-6 ipad:col-span-6 ipad-lg:col-span-6 ipad-xl:col-span-6 ipad-2xl:col-span-6 bg-white rounded-lg border flex flex-col overflow-hidden h-[calc(100vh-180px)] ${E!=="image"?"hidden lg:flex":""}`,onDragOver:Qr,onDragLeave:Tn,onDrop:en,children:[a.jsxDEV("input",{type:"file",multiple:!0,accept:"image/*",onChange:fn,className:"hidden",id:"image-file-input"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3364,columnNumber:11},void 0),S&&f&&E==="image"&&(()=>{const _=_t.find(K=>K.id===f);return _?a.jsxDEV("div",{className:"border-b bg-gray-50 p-3",children:a.jsxDEV("div",{className:"flex justify-between items-start",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("p",{className:"font-medium text-gray-900 text-sm",children:_.purpose||_.itemName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3381,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-0.5",children:[_.process||"-","  ",qp(_.requestDate,"yyyy.MM.dd",{locale:xs})||"-"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3382,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3380,columnNumber:21},void 0),a.jsxDEV("p",{className:"text-sm font-bold text-gray-900",children:["",(_.amount||0).toLocaleString()]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3386,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3379,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3378,columnNumber:17},void 0):null})(),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 relative",onClick:_=>{var B;const K=_.target;if(!K.closest("img")&&!K.closest("button")&&f){const x=_t.find(Q=>Q.id===f),I=(x==null?void 0:x.images)||[],U=Fe[f]||[];(I.length>0?I:U).length>0&&((B=document.getElementById("image-file-input"))==null||B.click())}},children:f?(()=>{const _=_t.find(I=>I.id===f),K=(_==null?void 0:_.images)||[],B=Fe[f]||[],x=K.length>0?K:B;return a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"mb-3",children:[a.jsxDEV("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3422,columnNumber:21},void 0),a.jsxDEV("textarea",{value:(_==null?void 0:_.quickText)||(_==null?void 0:_.notes)||"",readOnly:!0,placeholder:" ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50 resize-none",rows:8},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3423,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3421,columnNumber:19},void 0),x.length>0&&a.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:x.map((I,U)=>a.jsxDEV("div",{className:"relative group",children:[a.jsxDEV("img",{src:I,alt:` ${U+1}`,className:"w-full aspect-square object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity border bg-gray-100",onClick:G=>{G.stopPropagation(),pn(I)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3437,columnNumber:27},void 0),a.jsxDEV("button",{onClick:G=>{G.stopPropagation(),Ys(U)},className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:a.jsxDEV(vs,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3453,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3446,columnNumber:27},void 0),a.jsxDEV("div",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1.5 py-0.5 rounded",children:[U+1,"/",x.length]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3455,columnNumber:27},void 0)]},U,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3436,columnNumber:25},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3434,columnNumber:21},void 0),a.jsxDEV("label",{htmlFor:"image-file-input",className:`block cursor-pointer ${x.length>0?"":"flex-1"}`,onClick:I=>I.stopPropagation(),children:a.jsxDEV("div",{className:`w-full border-2 border-dashed rounded-lg p-4 text-center transition-colors flex flex-col items-center justify-center ${v?"border-gray-500 bg-gray-50":"border-gray-300 hover:border-gray-400"} ${x.length>0?"min-h-[80px]":"min-h-[200px]"}`,children:[a.jsxDEV(tu,{className:`mx-auto text-gray-400 mb-1 ${x.length>0?"h-6 w-6":"h-10 w-10 mb-2"}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3474,columnNumber:23},void 0),a.jsxDEV("p",{className:"text-sm font-medium text-gray-700",children:x.length>0?" ":" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3475,columnNumber:23},void 0),x.length===0&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"   Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3479,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3469,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3464,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3419,columnNumber:17},void 0)})():a.jsxDEV("div",{className:"h-full flex items-center justify-center min-h-[200px]",children:a.jsxDEV("div",{className:"text-center text-gray-400",children:[a.jsxDEV(jo,{className:"h-12 w-12 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3488,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3489,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3487,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3486,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3396,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3356,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2557,columnNumber:7},void 0),k&&a.jsxDEV(a.Fragment,{children:[a.jsxDEV("div",{className:"lg:hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[a.jsxDEV("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsxDEV("h2",{className:"text-base font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3504,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-4 w-4 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3509,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3505,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3503,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-3 overflow-y-auto max-h-[calc(80vh-100px)]",children:[a.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2",children:Xc.map(_=>a.jsxDEV("button",{onClick:()=>{Ye({...ee,process:_}),De(!1)},className:`p-2 text-sm text-center border rounded-lg transition-all ${ee.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3516,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3514,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ye({...ee,process:""}),De(!1)},className:"w-full p-2 text-sm text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3533,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3513,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3502,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3501,columnNumber:11},void 0),a.jsxDEV("div",{className:"hidden lg:block fixed inset-0 z-40",onClick:()=>De(!1),children:a.jsxDEV("div",{onClick:_=>_.stopPropagation(),className:"absolute bg-white rounded-lg shadow-xl border border-gray-200",style:{top:Me.current?`${Me.current.getBoundingClientRect().bottom+window.scrollY+4}px`:"50%",left:Me.current?`${Me.current.getBoundingClientRect().left+window.scrollX}px`:"50%"},children:[a.jsxDEV("div",{className:"flex items-center justify-between p-2 border-b",children:[a.jsxDEV("h2",{className:"text-sm font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3557,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>De(!1),className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsxDEV(vs,{className:"h-3 w-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3562,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3558,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3556,columnNumber:15},void 0),a.jsxDEV("div",{className:"p-2",children:[a.jsxDEV("div",{className:"grid grid-cols-4 gap-1.5 mb-2",children:Xc.map(_=>a.jsxDEV("button",{onClick:()=>{Ye({...ee,process:_}),De(!1)},className:`p-1.5 text-xs text-center border rounded-lg transition-all whitespace-nowrap ${ee.process===_?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,children:_},_,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3569,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3567,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ye({...ee,process:""}),De(!1)},className:"w-full p-1.5 text-xs text-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3586,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3566,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3548,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3547,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3499,columnNumber:9},void 0),te&&a.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",onClick:()=>O(!1),children:a.jsxDEV("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[a.jsxDEV("button",{onClick:_=>{_.stopPropagation(),O(!1)},className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors",children:a.jsxDEV(vs,{className:"h-8 w-8"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3615,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3608,columnNumber:13},void 0),a.jsxDEV("img",{src:C,alt:" ",className:"max-w-full max-h-[90vh] object-contain",onClick:_=>_.stopPropagation()},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3617,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3607,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3603,columnNumber:9},void 0),bt&&a.jsxDEV(Pw,{projectName:wt,onClose:()=>ot(!1)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:3629,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Payments.tsx",lineNumber:2498,columnNumber:5},void 0)},Jr=s=>s?typeof s=="string"?s:s instanceof xe?s.toDate().toISOString():new Date().toISOString():new Date().toISOString(),hn={async getSpaces(s){const e=qe(re,"finish_check_spaces");let t;s?t=Nt(e,js("project_id","==",s),Gt("display_order")):t=Nt(e,Gt("display_order"));const n=await Vt(t),r=[];for(const i of n.docs){const o=i.data(),l=qe(re,"finish_check_items"),u=Nt(l,js("space_id","==",i.id),Gt("display_order")),m=await Vt(u),d=[];for(const f of m.docs){const h=f.data(),y=qe(re,"finish_check_images"),T=Nt(y,js("item_id","==",f.id)),V=(await Vt(T)).docs.map(R=>({id:R.id,item_id:f.id,filename:R.data().filename||null,created_at:Jr(R.data().created_at)}));d.push({id:f.id,space_id:i.id,content:h.content||"",is_completed:h.is_completed||0,is_priority:h.is_priority||0,completed_at:h.completed_at?Jr(h.completed_at):null,display_order:h.display_order||0,created_at:Jr(h.created_at),updated_at:Jr(h.updated_at),images:V})}r.push({id:i.id,name:o.name||"",project_id:o.project_id||null,display_order:o.display_order||0,created_at:Jr(o.created_at),updated_at:Jr(o.updated_at),items:d})}return r},async createSpace(s,e){const t=qe(re,"finish_check_spaces"),n=Nt(t,js("project_id","==",e),Gt("display_order","desc")),r=await Vt(n),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={name:s,project_id:e,display_order:i+1,created_at:ls(),updated_at:ls()};return{id:(await qn(t,o)).id,name:s,project_id:e,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}},async updateSpace(s,e){const t=Te(re,"finish_check_spaces",s);await Ht(t,{name:e,updated_at:ls()})},async deleteSpace(s){const e=qe(re,"finish_check_items"),t=Nt(e,js("space_id","==",s)),n=await Vt(t);for(const r of n.docs){const i=qe(re,"finish_check_images"),o=Nt(i,js("item_id","==",r.id)),l=await Vt(o);for(const u of l.docs)await Hs(Te(re,"finish_check_images",u.id));await Hs(Te(re,"finish_check_items",r.id))}await Hs(Te(re,"finish_check_spaces",s))},async createItem(s,e){const t=qe(re,"finish_check_items"),n=Nt(t,js("space_id","==",s),Gt("display_order","desc")),r=await Vt(n),i=r.docs.length>0&&r.docs[0].data().display_order||0,o={space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:ls(),updated_at:ls()};return{id:(await qn(t,o)).id,space_id:s,content:e,is_completed:0,is_priority:0,completed_at:null,display_order:i+1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[]}},async updateItem(s,e){const t=Te(re,"finish_check_items",s);await Ht(t,{content:e,updated_at:ls()})},async deleteItem(s){const e=qe(re,"finish_check_images"),t=Nt(e,js("item_id","==",s)),n=await Vt(t);for(const r of n.docs)await Hs(Te(re,"finish_check_images",r.id));await Hs(Te(re,"finish_check_items",s))},async toggleItem(s){const e=Te(re,"finish_check_items",s),t=await It(e);if(!t.exists())throw new Error("   .");const n=t.data(),r=n.is_completed?0:1;return await Ht(e,{is_completed:r,completed_at:r?ls():null,updated_at:ls()}),{id:s,space_id:n.space_id,content:n.content,is_completed:r,is_priority:n.is_priority||0,completed_at:r?new Date().toISOString():null,display_order:n.display_order||0,created_at:Jr(n.created_at),updated_at:new Date().toISOString(),images:[]}},async togglePriority(s){const e=Te(re,"finish_check_items",s),t=await It(e);if(!t.exists())throw new Error("   .");const r=t.data().is_priority||0?0:1;return await Ht(e,{is_priority:r,updated_at:ls()}),{is_priority:r}},async getImageData(s){const e=Te(re,"finish_check_images",s),t=await It(e);if(!t.exists())return null;const n=t.data();return{image_data:n.image_url||n.image_data||""}},async uploadImage(s,e,t){const n=qe(re,"finish_check_images"),r={item_id:s,image_data:"",image_url:"",filename:t,created_at:ls()},i=await qn(n,r);let o=e;if(to(e)){const l=await Wy("finish_check",i.id,e);await Ht(i,{image_url:l,image_data:""}),o=l}else await Ht(i,{image_data:e});return{id:i.id,item_id:s,image_data:o,filename:t,created_at:new Date().toISOString()}},async deleteImage(s){const e=Te(re,"finish_check_images",s),t=await It(e);if(t.exists()){const n=t.data();n.image_url&&await zy(n.image_url)}await Hs(e)}},vn={getSpaces:s=>hn.getSpaces(s),createSpace:(s,e)=>hn.createSpace(s,e),updateSpace:(s,e)=>hn.updateSpace(String(s),e),deleteSpace:s=>hn.deleteSpace(String(s)),createItem:(s,e)=>hn.createItem(String(s),e),updateItem:(s,e)=>hn.updateItem(String(s),e),deleteItem:s=>hn.deleteItem(String(s)),toggleItem:s=>hn.toggleItem(String(s)),togglePriority:s=>hn.togglePriority(String(s)),getImageData:s=>hn.getImageData(String(s)),uploadImage:(s,e,t)=>hn.uploadImage(String(s),e,t),deleteImage:s=>hn.deleteImage(String(s))},Ow=()=>{var ee,Ye;const{user:s}=Or(),{loadProjectsFromAPI:e,projects:t}=er(),n=dc(),[r,i]=A.useState([]),[o,l]=A.useState(!0),[u,m]=A.useState(null),[d,f]=A.useState([]),[h,y]=A.useState(!1),[T,v]=A.useState(""),[V,R]=A.useState(""),[L,q]=A.useState(null),[oe,te]=A.useState(null),[O,C]=A.useState(""),[N,E]=A.useState(null),[j,S]=A.useState(""),[w,k]=A.useState(null),[De,Me]=A.useState(new Set),he=A.useRef(null),[Re,ft]=A.useState(window.innerWidth<768),[qt,Ot]=A.useState(!1),[ae,Oe]=A.useState(null),[de,Ie]=A.useState(new Set),[Ke,bt]=A.useState(()=>localStorage.getItem("finishCheck_showOnlyIncomplete")==="true"),[ot,wt]=A.useState(!1),[rt,mt]=A.useState(!1),[ds,z]=A.useState(new Set);A.useEffect(()=>{localStorage.setItem("finishCheck_showOnlyIncomplete",String(Ke))},[Ke]),A.useEffect(()=>{(async()=>{t.length===0&&await e(),l(!1)})();const Ne=()=>{ft(window.innerWidth<768)};return window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]),A.useEffect(()=>{o||Le()},[n,o]),A.useEffect(()=>{u!==null&&Be()},[u]),A.useEffect(()=>{u!==null&&(s!=null&&s.id)&&localStorage.setItem(`finishCheck_selectedProject_${s.id}`,u.toString())},[u,s==null?void 0:s.id]),A.useEffect(()=>{if(!Re&&w){const M=async Ne=>{var Pe;const _e=(Pe=Ne.clipboardData)==null?void 0:Pe.items;if(_e){for(let me=0;me<_e.length;me++)if(_e[me].type.indexOf("image")!==-1){Ne.preventDefault();const _t=_e[me].getAsFile();_t&&await Ve(w,_t)}}};return document.addEventListener("paste",M),()=>document.removeEventListener("paste",M)}},[w,Re]);const Le=async()=>{try{const M=n.map(_e=>({id:_e.id,title:_e.name}));i(M);const Ne=s!=null&&s.id?localStorage.getItem(`finishCheck_selectedProject_${s.id}`):null;Ne&&M.some(_e=>_e.id===Number(Ne))?m(Number(Ne)):M.length>0&&m(M[0].id)}catch(M){console.error("Failed to load projects:",M),ne.error("   ")}},Be=async()=>{try{d.length===0&&y(!0);const Ne=(await vn.getSpaces(u||void 0)).map(_e=>({..._e,items:_e.items.map(Pe=>({...Pe,images:Pe.images||[]}))}));f(Ne)}catch(M){console.error("Failed to load spaces:",M),ne.error("   ")}finally{y(!1)}},Se=async M=>{if(ds.has(Number(M)))return null;try{z(Pe=>new Set(Pe).add(Number(M)));const Ne=await vn.getImageData(M),_e=(Ne==null?void 0:Ne.image_data)||null;return f(Pe=>Pe.map(me=>({...me,items:me.items.map(_t=>({..._t,images:_t.images.map(yt=>String(yt.id)===String(M)?{...yt,image_data:_e}:yt)}))}))),_e}catch(Ne){return console.error("   :",Ne),null}finally{z(Ne=>{const _e=new Set(Ne);return _e.delete(Number(M)),_e})}},Qe=async M=>{const Ne=d.find(me=>me.items.some(_t=>_t.id===M)),_e=Ne==null?void 0:Ne.items.find(me=>me.id===M);if(!_e)return;const Pe=_e.images.filter(me=>!me.image_data);await Promise.all(Pe.map(me=>Se(me.id)))},St=async()=>{if(!rt){if(!T.trim()){ne.error("  ");return}if(!u){ne.error(" ");return}mt(!0);try{const M=await vn.createSpace(T.trim(),u),Ne={...M,items:M.items||[]};f([...d,Ne]),v(""),wt(!1),ne.success(" ")}catch(M){console.error("Failed to add space:",M),ne.error("  ")}finally{mt(!1)}}},$t=async(M,Ne)=>{if(!Ne.trim()){ne.error("  ");return}try{await vn.updateSpace(M,Ne.trim()),f(d.map(_e=>String(_e.id)===String(M)?{..._e,name:Ne.trim()}:_e)),te(null),C(""),ne.success("  ")}catch(_e){console.error("Failed to update space:",_e),ne.error("  ")}},ut=M=>{Oe(M),Ie(new Set)},P=async()=>{if(ae!==null){if(de.size===0){ne.error("  ");return}try{await Promise.all(Array.from(de).map(M=>vn.deleteItem(M))),f(d.map(M=>String(M.id)===String(ae)?{...M,items:M.items.filter(Ne=>!de.has(Ne.id))}:M)),ne.success(`${de.size}  `),Oe(null),Ie(new Set)}catch(M){console.error("Failed to delete items:",M),ne.error("  ")}}},F=async()=>{if(ae===null)return;const M=d.find(Ne=>String(Ne.id)===String(ae));if(M&&confirm(`"${M.name}"  ?

        .`))try{await vn.deleteSpace(ae),f(d.filter(Ne=>String(Ne.id)!==String(ae))),ne.success(" "),Oe(null),Ie(new Set)}catch(Ne){console.error("Failed to delete space:",Ne),ne.error("  ")}},Z=async M=>{if(!V.trim()){ne.error("  ");return}const Ne=-Date.now(),_e={id:Ne,space_id:M,content:V.trim(),is_checked:!1,is_priority:!1,images:[]};f(d.map(me=>String(me.id)===String(M)?{...me,items:[...me.items,_e]}:me));const Pe=V.trim();R(""),q(null);try{const me=await vn.createItem(M,Pe);f(_t=>_t.map(yt=>String(yt.id)===String(M)?{...yt,items:yt.items.map(Xt=>Xt.id===Ne?{...me,images:[]}:Xt)}:yt))}catch(me){console.error("Failed to add item:",me),f(_t=>_t.map(yt=>String(yt.id)===String(M)?{...yt,items:yt.items.filter(Xt=>Xt.id!==Ne)}:yt)),ne.error("  ")}},be=async M=>{try{const Ne=await vn.toggleItem(M);f(d.map(_e=>({..._e,items:_e.items.map(Pe=>String(Pe.id)===String(M)?{...Pe,...Ne}:Pe)})))}catch(Ne){console.error("Failed to toggle item:",Ne),ne.error("   ")}},ue=async M=>{try{const Ne=await vn.togglePriority(M);f(d.map(_e=>({..._e,items:_e.items.map(Pe=>String(Pe.id)===String(M)?{...Pe,is_priority:Ne.is_priority}:Pe)})))}catch(Ne){console.error("Failed to toggle priority:",Ne),ne.error("  ")}},fe=M=>new Promise((Ne,_e)=>{const Pe=new FileReader;Pe.readAsDataURL(M),Pe.onload=()=>Ne(Pe.result),Pe.onerror=me=>_e(me)}),Ve=async(M,Ne)=>{var me,_t;if(!["image/jpeg","image/png","image/webp"].includes(Ne.type)){ne.error("JPEG, PNG, WebP    ");return}const Pe=5*1024*1024;if(Ne.size>Pe){ne.error("  5MB  ");return}try{Me(kt=>new Set([...kt,Number(M)]));const yt=await fe(Ne),Xt=await vn.uploadImage(M,yt,Ne.name);f(d.map(kt=>({...kt,items:kt.items.map(fs=>String(fs.id)===String(M)?{...fs,images:[...fs.images,Xt]}:fs)}))),ne.success(" ")}catch(yt){console.error("Failed to upload image:",yt),ne.error(((_t=(me=yt.response)==null?void 0:me.data)==null?void 0:_t.error)||"  ")}finally{Me(yt=>{const Xt=new Set(yt);return Xt.delete(Number(M)),Xt})}},Fe=async(M,Ne)=>{const _e=Ne.target.files;if(!(!_e||_e.length===0)){for(let Pe=0;Pe<_e.length;Pe++)await Ve(M,_e[Pe]);he.current&&(he.current.value="")}},Ze=async(M,Ne)=>{if(confirm("  ?"))try{await vn.deleteImage(Ne),f(d.map(_e=>({..._e,items:_e.items.map(Pe=>String(Pe.id)===String(M)?{...Pe,images:Pe.images.filter(me=>String(me.id)!==String(Ne))}:Pe)}))),ne.success(" ")}catch(_e){console.error("Failed to delete image:",_e),ne.error("  ")}},ke=async(M,Ne)=>{M.preventDefault(),M.stopPropagation();const _e=M.dataTransfer.files;if(!(!_e||_e.length===0))for(let Pe=0;Pe<_e.length;Pe++)_e[Pe].type.startsWith("image/")&&await Ve(Ne,_e[Pe])},Rs=M=>{M.preventDefault(),M.stopPropagation()};if(h)return a.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-120px)]",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:570,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:569,columnNumber:7},void 0);const Rt=w?d.flatMap(M=>M.items).find(M=>M.id===w):null;return a.jsxDEV("div",{className:"h-[calc(100vh-120px)] flex flex-col md:flex-row gap-4 overflow-hidden",children:[a.jsxDEV("input",{ref:he,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,className:"hidden",onChange:M=>{w&&Fe(w,M)}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:582,columnNumber:7},void 0),a.jsxDEV("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:Re?a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("div",{className:"flex-1",children:a.jsxDEV("select",{value:u||"",onChange:M=>{const Ne=M.target.value?Number(M.target.value):null;m(Ne)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:612,columnNumber:43},void 0),r.map(M=>a.jsxDEV("option",{value:M.id,children:M.title},M.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:614,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:604,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:603,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-3 py-2.5 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:622,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>wt(!0),className:"p-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center",title:" ",children:a.jsxDEV($i,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:640,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:635,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:601,columnNumber:13},void 0):a.jsxDEV("div",{className:"flex gap-3",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:648,columnNumber:17},void 0),a.jsxDEV("select",{value:u||"",onChange:M=>{const Ne=M.target.value?Number(M.target.value):null;m(Ne)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 bg-white cursor-pointer hover:border-gray-400 transition-colors appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22M6%208l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')] bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10",children:[(s==null?void 0:s.name)!==""&&a.jsxDEV("option",{value:"",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:657,columnNumber:43},void 0),r.map(M=>a.jsxDEV("option",{value:M.id,children:M.title},M.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:659,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:647,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:668,columnNumber:17},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:T,onChange:M=>v(M.target.value),onKeyPress:M=>{M.key==="Enter"&&St()},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:670,columnNumber:19},void 0),a.jsxDEV("button",{onClick:St,disabled:rt,className:"p-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors flex items-center justify-center min-w-[44px] disabled:opacity-50",title:" ",children:a.jsxDEV($i,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:688,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:682,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:669,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:667,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>bt(!Ke),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${Ke?"bg-gray-800 text-white hover:bg-gray-900":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:Ke?" ":" ",children:Ke?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:695,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:694,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:645,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:598,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?a.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:714,columnNumber:13},void 0):a.jsxDEV("div",{className:"columns-1 portrait:md:columns-2 landscape:md:columns-3 desktop:columns-4 column-gap-4",children:d.map((M,Ne)=>{const _e=M.items.filter(me=>!me.is_completed).sort((me,_t)=>(_t.is_priority||0)-(me.is_priority||0)),Pe=M.items.filter(me=>me.is_completed);return Ke&&_e.length===0?null:a.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 mb-4 break-inside-avoid",children:[oe===M.id?a.jsxDEV("div",{className:"flex gap-2 mb-4",children:[a.jsxDEV("input",{type:"text",value:O,onChange:me=>C(me.target.value),onKeyPress:me=>{me.key==="Enter"?$t(M.id,O):me.key==="Escape"&&(te(null),C(""))},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:733,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>$t(M.id,O),className:"p-1 text-green-600 hover:text-green-700",children:a.jsxDEV(zp,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:752,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:748,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>{te(null),C("")},className:"p-1 text-gray-600 hover:text-gray-700",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:761,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:754,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:732,columnNumber:23},void 0):a.jsxDEV("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-gray-300",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[a.jsxDEV("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-gray-800 text-white text-xs font-bold rounded-full",children:Ne+1},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:768,columnNumber:29},void 0),M.name]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:767,columnNumber:27},void 0),a.jsxDEV("span",{className:"text-xs text-gray-500",children:[Pe.length,"/",M.items.length," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:773,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:766,columnNumber:25},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:()=>{L===M.id?(q(null),R("")):q(M.id)},className:`p-1 transition-colors ${L===M.id?"text-gray-900 bg-gray-100 rounded":"text-gray-600 hover:text-gray-800"}`,title:" ",children:a.jsxDEV($i,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:794,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:778,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>{te(M.id),C(M.name)},className:"p-1 text-gray-600 hover:text-gray-800 transition-colors",title:"",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:804,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:796,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>ut(M.id),className:"p-1 text-red-500 hover:text-red-700 transition-colors",title:"",children:a.jsxDEV(oi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:811,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:806,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:777,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:765,columnNumber:23},void 0),L===M.id&&a.jsxDEV("div",{className:"mb-4 p-3 bg-white border border-gray-300 rounded-lg",children:a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("input",{type:"text",value:V,onChange:me=>R(me.target.value),onKeyPress:me=>{me.key==="Enter"&&V.trim()&&Z(M.id)},placeholder:"  ",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:821,columnNumber:27},void 0),a.jsxDEV("button",{onClick:()=>Z(M.id),disabled:!V.trim(),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:834,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:820,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:819,columnNumber:23},void 0),_e.length>0&&a.jsxDEV("div",{className:"mb-4",children:a.jsxDEV("div",{className:"space-y-2",children:_e.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg",children:[a.jsxDEV("input",{type:"checkbox",checked:!1,onChange:()=>be(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:854,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-900 ${!Re&&w===me.id?"font-semibold":""}`,onClick:async()=>{Re||(k(me.id),me.images&&me.images.length>0&&await Qe(me.id))},style:{cursor:Re?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:875,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:861,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Re&&Ot(!0),me.images&&me.images.length>0&&await Qe(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:899,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:881,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(wd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:910,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:901,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:880,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:850,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:848,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:847,columnNumber:23},void 0),!Ke&&Pe.length>0&&a.jsxDEV("div",{children:a.jsxDEV("div",{className:"space-y-2",children:Pe.map(me=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-white border border-gray-200 rounded-lg opacity-40",children:[a.jsxDEV("input",{type:"checkbox",checked:!0,onChange:()=>be(me.id),className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:928,columnNumber:31},void 0),a.jsxDEV("span",{className:`flex-1 text-sm text-gray-500 line-through ${!Re&&w===me.id?"font-semibold":""}`,onClick:async()=>{Re||(k(me.id),me.images&&me.images.length>0&&await Qe(me.id))},style:{cursor:Re?"default":"pointer"},children:[me.content,me.images&&me.images.length>0&&a.jsxDEV("span",{className:"ml-2 text-xs text-gray-500",children:["(",me.images.length,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:949,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:935,columnNumber:31},void 0),a.jsxDEV("div",{className:"flex items-center gap-1",children:[a.jsxDEV("button",{onClick:async()=>{k(me.id),Re&&Ot(!0),me.images&&me.images.length>0&&await Qe(me.id)},className:`p-1 transition-colors ${me.images&&me.images.length>0?"text-blue-600 hover:text-blue-800":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(jo,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:973,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:955,columnNumber:33},void 0),a.jsxDEV("button",{onClick:()=>ue(me.id),className:`p-1 transition-colors ${me.is_priority?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,title:"",children:a.jsxDEV(wd,{className:`w-4 h-4 ${me.is_priority?"fill-current":""}`},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:984,columnNumber:35},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:975,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:954,columnNumber:31},void 0)]},me.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:924,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:922,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:921,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:729,columnNumber:19},void 0)})},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:718,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:712,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:596,columnNumber:7},void 0),!Re&&w&&Rt&&a.jsxDEV("div",{className:"w-80 bg-white border border-gray-200 rounded-lg overflow-hidden flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1005,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>k(null),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",title:"",children:a.jsxDEV(vs,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1011,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1006,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1004,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Rt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1014,columnNumber:13},void 0),a.jsxDEV("button",{onClick:()=>{var M;return(M=he.current)==null?void 0:M.click()},disabled:De.has(w),className:"w-full px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1020,columnNumber:15},void 0),De.has(w)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1015,columnNumber:13},void 0),a.jsxDEV("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"    , Ctrl+V "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1023,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1003,columnNumber:11},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",onDrop:M=>ke(M,w),onDragOver:Rs,children:Rt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 text-sm",children:[a.jsxDEV(jo,{className:"w-12 h-12 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1035,columnNumber:17},void 0),a.jsxDEV("p",{children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1036,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1034,columnNumber:15},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Rt.images.map(M=>a.jsxDEV("div",{className:"relative group",children:[M.image_data?a.jsxDEV("img",{src:M.image_data,alt:M.filename||"",className:"w-full h-32 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1043,columnNumber:23},void 0):a.jsxDEV("div",{className:"w-full h-32 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1050,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1049,columnNumber:23},void 0),a.jsxDEV("button",{onClick:()=>Ze(w,M.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",title:"",children:a.jsxDEV(Sd,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1058,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1053,columnNumber:21},void 0),M.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:M.filename,children:M.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1061,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1041,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1039,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1028,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1002,columnNumber:9},void 0),Re&&qt&&w&&Rt&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl w-full max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"font-semibold text-gray-900",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1079,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Ot(!1),k(null)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1087,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1080,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1078,columnNumber:15},void 0),a.jsxDEV("p",{className:"text-sm text-gray-600 mb-3",children:Rt.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1090,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{var M;return(M=he.current)==null?void 0:M.click()},disabled:De.has(w),className:"w-full px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50",children:[a.jsxDEV(tu,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1096,columnNumber:17},void 0),De.has(w)?" ...":" "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1091,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1077,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:Rt.images.length===0?a.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsxDEV(jo,{className:"w-16 h-16 mb-2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1104,columnNumber:19},void 0),a.jsxDEV("p",{className:"text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1103,columnNumber:17},void 0):a.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:Rt.images.map(M=>a.jsxDEV("div",{className:"relative",children:[M.image_data?a.jsxDEV("img",{src:M.image_data,alt:M.filename||"",className:"w-full h-40 object-cover rounded-lg border border-gray-200"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1112,columnNumber:25},void 0):a.jsxDEV("div",{className:"w-full h-40 bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center",children:a.jsxDEV("span",{className:"text-gray-400 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1119,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1118,columnNumber:25},void 0),a.jsxDEV("button",{onClick:()=>Ze(w,M.id),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsxDEV(Sd,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1126,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1122,columnNumber:23},void 0),M.filename&&a.jsxDEV("p",{className:"text-xs text-gray-500 mt-1 truncate",title:M.filename,children:M.filename},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1129,columnNumber:25},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1110,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1108,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1101,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1076,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1075,columnNumber:9},void 0),ae!==null&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxDEV("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:[(ee=d.find(M=>M.id===ae))==null?void 0:ee.name," - "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1148,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{Oe(null),Ie(new Set)},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1158,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1151,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1147,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1146,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"  .    ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1164,columnNumber:15},void 0),a.jsxDEV("div",{className:"space-y-2",children:(Ye=d.find(M=>M.id===ae))==null?void 0:Ye.items.map(M=>a.jsxDEV("div",{className:"flex items-start gap-3 p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>{const Ne=new Set(de);Ne.has(M.id)?Ne.delete(M.id):Ne.add(M.id),Ie(Ne)},children:[a.jsxDEV("input",{type:"checkbox",checked:de.has(M.id),onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-gray-300 text-gray-800 focus:ring-gray-500 cursor-pointer"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1184,columnNumber:23},void 0),a.jsxDEV("span",{className:`flex-1 text-sm ${M.is_completed?"text-gray-500 line-through":"text-gray-900"}`,children:M.content},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1190,columnNumber:23},void 0)]},M.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1171,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1167,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1163,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4 border-t border-gray-200 flex gap-2",children:[a.jsxDEV("button",{onClick:P,disabled:de.size===0,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["   (",de.size,")"]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1199,columnNumber:15},void 0),a.jsxDEV("button",{onClick:F,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1206,columnNumber:15},void 0),a.jsxDEV("button",{onClick:()=>{Oe(null),Ie(new Set)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1212,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1198,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1145,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1144,columnNumber:9},void 0),ot&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white rounded-t-2xl md:rounded-lg w-full md:max-w-md",children:[a.jsxDEV("div",{className:"p-4 border-b border-gray-200",children:a.jsxDEV("div",{className:"flex items-center justify-between",children:[a.jsxDEV("h3",{className:"text-lg font-bold text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1232,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>{wt(!1),v("")},className:"p-1 text-gray-600 hover:text-gray-900",children:a.jsxDEV(vs,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1240,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1233,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1231,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1230,columnNumber:13},void 0),a.jsxDEV("div",{className:"p-4",children:[a.jsxDEV("div",{className:"mb-4",children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1247,columnNumber:17},void 0),a.jsxDEV("input",{type:"text",value:T,onChange:M=>v(M.target.value),onKeyPress:M=>{M.key==="Enter"&&T.trim()&&St()},placeholder:"  ",className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1248,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1246,columnNumber:15},void 0),a.jsxDEV("div",{className:"flex gap-2",children:[a.jsxDEV("button",{onClick:()=>{wt(!1),v("")},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1264,columnNumber:17},void 0),a.jsxDEV("button",{onClick:St,disabled:!T.trim()||rt,className:"flex-1 px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:rt?" ...":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1273,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1229,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:1228,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/FinishCheck.tsx",lineNumber:580,columnNumber:5},void 0)};function Fw(){const[s,e]=A.useState([]),[t,n]=A.useState(!1),[r,i]=A.useState(null),[o,l]=A.useState(!1),[u,m]=A.useState(null),[d,f]=A.useState(""),[h,y]=A.useState({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""}),[T,v]=A.useState(!1);A.useEffect(()=>{V()},[]),A.useEffect(()=>{const N=()=>{R()};return window.addEventListener("headerAddButtonClick",N),()=>window.removeEventListener("headerAddButtonClick",N)},[]);const V=async()=>{var N,E;try{s.length===0&&n(!0),i(null);const j=await Jn.getAllContractors();e(j.map(S=>({id:S._id,rank:S.rank,companyName:S.companyName,name:S.name,position:S.position,process:S.process,contact:S.contact,accountNumber:S.accountNumber,notes:S.notes,createdAt:new Date(S.createdAt),updatedAt:new Date(S.updatedAt)})))}catch(j){console.error("Failed to load contractors:",j);const S=j instanceof Error&&((E=(N=j.response)==null?void 0:N.data)==null?void 0:E.message);i(S||"   .")}finally{n(!1)}},R=N=>{if(N){m(N);let E="",j=N.accountNumber||"";if(N.accountNumber){const k=["KB","","","","NH","IBK","KEB","SC","","","","","","","","","","","","","","","","","NH","","","","","KB","",""];for(const De of k)if(N.accountNumber.startsWith(De)){E=De,j=N.accountNumber.substring(De.length).trim();break}}let S=N.name,w=N.position||"";w||(w=Ya(N.name),S=Xo(N.name)),y({rank:N.rank||"",companyName:N.companyName||"",name:S,position:w,process:N.process,contact:N.contact||"",bankName:E,accountNumber:j,notes:N.notes||""})}else m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""});l(!0)},L=()=>{l(!1),m(null),y({rank:"",companyName:"",name:"",position:"",process:"",contact:"",bankName:"",accountNumber:"",notes:""})},q=async N=>{var j,S;if(N.preventDefault(),T)return;v(!0);const E=h.bankName&&h.accountNumber?`${h.bankName} ${h.accountNumber}`:h.accountNumber;try{const w={rank:h.rank,companyName:h.companyName,name:h.name,position:h.position,process:h.process,contact:h.contact,accountNumber:E,notes:h.notes};u?await Jn.updateContractor(u.id,w):await Jn.createContractor(w),await V(),L()}catch(w){console.error("Failed to save contractor:",w);const k=w instanceof Error&&((S=(j=w.response)==null?void 0:j.data)==null?void 0:S.message);alert(k||"  .")}finally{v(!1)}},oe=async N=>{var E,j;if(window.confirm("   ?"))try{await Jn.deleteContractor(N),await V()}catch(S){console.error("Failed to delete contractor:",S);const w=S instanceof Error&&((j=(E=S.response)==null?void 0:E.data)==null?void 0:j.message);alert(w||"  .")}},te=()=>"border-gray-200 text-gray-600 bg-gray-50",O=N=>N?N==="1"?1:N==="1()"?2:N==="2"?3:N==="2()"?4:N==="3"?5:N==="3()"?6:N===""?100:N===""?200:999:999,C=s.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())||N.process.toLowerCase().includes(d.toLowerCase())||N.accountNumber.toLowerCase().includes(d.toLowerCase())||N.contact&&N.contact.toLowerCase().includes(d.toLowerCase())||N.rank&&N.rank.toLowerCase().includes(d.toLowerCase())||N.companyName&&N.companyName.toLowerCase().includes(d.toLowerCase())).sort((N,E)=>{const j=O(N.rank)-O(E.rank);if(j!==0)return j;const S=N.process.localeCompare(E.process,"ko");return S!==0?S:N.name.localeCompare(E.name,"ko")});return a.jsxDEV("div",{className:"space-y-3 md:space-y-4",children:[a.jsxDEV("div",{className:"flex items-center justify-end",children:a.jsxDEV("button",{onClick:()=>R(),className:"hidden md:inline-flex btn btn-primary px-3 md:px-4 py-2",children:"+  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:290,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:289,columnNumber:7},this),a.jsxDEV("div",{className:"relative",children:[a.jsxDEV(Qp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:300,columnNumber:9},this),a.jsxDEV("input",{type:"text",placeholder:", ,  ...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-9 md:pl-10 pr-4 py-2 text-sm md:text-base border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:301,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:299,columnNumber:7},this),a.jsxDEV("div",{className:"contractors-table hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsxDEV("div",{className:"overflow-x-auto",children:a.jsxDEV("table",{className:"w-full",children:[a.jsxDEV("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxDEV("tr",{children:[a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:316,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:319,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:322,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:325,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:328,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:331,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:334,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:337,columnNumber:17},this),a.jsxDEV("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:340,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:314,columnNumber:13},this),a.jsxDEV("tbody",{className:"bg-white divide-y divide-gray-200",children:t?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:349,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:348,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:347,columnNumber:17},this):r?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("div",{className:"space-y-4",children:[a.jsxDEV("p",{className:"text-red-500",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:356,columnNumber:23},this),a.jsxDEV("button",{onClick:V,className:"inline-block px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:357,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:355,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:354,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:353,columnNumber:17},this):C.length===0?a.jsxDEV("tr",{children:a.jsxDEV("td",{colSpan:9,className:"px-6 py-12 text-center",children:a.jsxDEV("p",{className:"text-gray-500",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:369,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:368,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:367,columnNumber:17},this):C.map(N=>a.jsxDEV("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:`px-2 py-1 text-xs font-medium border rounded ${te(N.rank)}`,children:N.rank||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:378,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:377,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("span",{className:"text-xs font-medium text-gray-700",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:383,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:382,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.companyName||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:388,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:387,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"font-medium text-gray-900",children:Xo(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:391,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:390,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.position||Ya(N.name)||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:394,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:393,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.contact||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:397,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:396,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxDEV("div",{className:"text-sm text-gray-900",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:400,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:399,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4",children:a.jsxDEV("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:N.notes||"-"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:403,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:402,columnNumber:21},this),a.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"text-gray-600 hover:text-gray-900 mr-3",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:412,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:408,columnNumber:23},this),a.jsxDEV("button",{onClick:()=>oe(N.id),className:"text-red-600 hover:text-red-900",children:a.jsxDEV(oi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:418,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:414,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:407,columnNumber:21},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:376,columnNumber:19},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:345,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:313,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:312,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:311,columnNumber:7},this),a.jsxDEV("div",{className:"md:hidden space-y-3",children:t?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:432,columnNumber:11},this):r?a.jsxDEV("div",{className:"text-center py-12 space-y-4",children:[a.jsxDEV("p",{className:"text-red-500 text-sm",children:r},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:435,columnNumber:13},this),a.jsxDEV("button",{onClick:V,className:"inline-block px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors text-sm",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:436,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:434,columnNumber:11},this):C.length===0?a.jsxDEV("div",{className:"text-center py-12 text-gray-500 text-sm",children:d?"  .":"  ."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:444,columnNumber:11},this):C.map(N=>a.jsxDEV("div",{className:"card p-3 space-y-2",children:[a.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[a.jsxDEV("div",{className:"flex-1",children:[a.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[N.rank&&a.jsxDEV("span",{className:`px-1.5 py-0.5 text-[10px] font-medium border rounded ${te(N.rank)}`,children:N.rank},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:455,columnNumber:23},this),a.jsxDEV("span",{className:"px-1.5 py-0.5 text-[10px] font-medium text-gray-700 bg-gray-100 rounded",children:N.process},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:459,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:453,columnNumber:19},this),N.companyName&&a.jsxDEV("p",{className:"text-xs text-gray-600 mb-0.5",children:N.companyName},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:464,columnNumber:21},this),a.jsxDEV("p",{className:"font-semibold text-gray-900 text-sm",children:Xo(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:466,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:452,columnNumber:17},this),a.jsxDEV("div",{className:"flex items-center gap-2 ml-2",children:[a.jsxDEV("button",{onClick:()=>R(N),className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",children:a.jsxDEV(su,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:473,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:469,columnNumber:19},this),a.jsxDEV("button",{onClick:()=>oe(N.id),className:"p-1.5 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",children:a.jsxDEV(oi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:479,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:475,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:451,columnNumber:15},this),a.jsxDEV("div",{className:"space-y-1 text-xs",children:[(N.position||Ya(N.name))&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:488,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.position||Ya(N.name)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:489,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:487,columnNumber:19},this),N.contact&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:494,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-900",children:N.contact},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:495,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:493,columnNumber:19},this),a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:499,columnNumber:19},this),a.jsxDEV("span",{className:"text-gray-900 break-all",children:N.accountNumber},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:500,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:498,columnNumber:17},this),N.notes&&a.jsxDEV("div",{className:"flex items-start",children:[a.jsxDEV("span",{className:"text-gray-500 w-14 flex-shrink-0",children:":"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:504,columnNumber:21},this),a.jsxDEV("span",{className:"text-gray-600",children:N.notes},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:505,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:485,columnNumber:15},this)]},N.id,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:449,columnNumber:13},this))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:430,columnNumber:7},this),o&&a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxDEV("div",{className:"p-6",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[a.jsxDEV("h2",{className:"text-xl font-bold text-gray-900",children:u?" ":"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:520,columnNumber:17},this),a.jsxDEV("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:a.jsxDEV(vs,{className:"w-6 h-6"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:527,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:523,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:519,columnNumber:15},this),a.jsxDEV("form",{onSubmit:q,className:"space-y-4",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:533,columnNumber:19},this),a.jsxDEV("select",{value:h.rank,onChange:N=>y({...h,rank:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:541,columnNumber:21},this),a.jsxDEV("option",{value:"1",children:"1"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:542,columnNumber:21},this),a.jsxDEV("option",{value:"2",children:"2"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:543,columnNumber:21},this),a.jsxDEV("option",{value:"3",children:"3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:544,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:532,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:549,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.companyName,onChange:N=>y({...h,companyName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:552,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:548,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:562,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:561,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.name,onChange:N=>y({...h,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:564,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:560,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:574,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.position,onChange:N=>y({...h,position:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:577,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:573,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",a.jsxDEV("span",{className:"text-red-500",children:"*"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:587,columnNumber:24},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:586,columnNumber:19},this),a.jsxDEV("input",{type:"text",required:!0,value:h.process,onChange:N=>y({...h,process:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:589,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:585,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:599,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.contact,onChange:N=>y({...h,contact:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:602,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:598,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:611,columnNumber:19},this),a.jsxDEV("select",{value:h.bankName,onChange:N=>y({...h,bankName:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:619,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:621,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:622,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:623,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:624,columnNumber:23},this),a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:625,columnNumber:23},this),a.jsxDEV("option",{value:"IBK",children:"IBK"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:626,columnNumber:23},this),a.jsxDEV("option",{value:"KEB",children:"KEB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:627,columnNumber:23},this),a.jsxDEV("option",{value:"SC",children:"SC"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:628,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:629,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:620,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:632,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:633,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:634,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:635,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:636,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:637,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:631,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:640,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:641,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:642,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:643,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:644,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:645,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:639,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:648,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:649,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:650,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:647,columnNumber:21},this),a.jsxDEV("optgroup",{label:"",children:[a.jsxDEV("option",{value:"NH",children:"NH"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:653,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:654,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:655,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:656,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:657,columnNumber:23},this),a.jsxDEV("option",{value:"KB",children:"KB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:658,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:659,columnNumber:23},this),a.jsxDEV("option",{value:"",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:660,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:652,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:614,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:610,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:666,columnNumber:19},this),a.jsxDEV("input",{type:"text",value:h.accountNumber,onChange:N=>y({...h,accountNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:669,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:665,columnNumber:17},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:678,columnNumber:19},this),a.jsxDEV("textarea",{value:h.notes,onChange:N=>y({...h,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent",rows:3},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:681,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:677,columnNumber:17},this),a.jsxDEV("div",{className:"flex space-x-3 pt-4",children:[a.jsxDEV("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:690,columnNumber:19},this),a.jsxDEV("button",{type:"submit",disabled:T,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:T?" ...":u?"":""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:697,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:689,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:531,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:518,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:517,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:516,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Contractors.tsx",lineNumber:287,columnNumber:5},this)}const qw=()=>{const[s,e]=A.useState([]),[t,n]=A.useState(null),[r,i]=A.useState(!1),o=A.useRef(null);A.useEffect(()=>(o.current=pl.subscribeToQuoteInquiries(f=>{e(f),i(!1)}),i(!0),()=>{o.current&&o.current()}),[]);const l=async f=>{try{await pl.markAsRead(f),window.dispatchEvent(new CustomEvent("quoteInquiryRead"))}catch(h){console.error("Failed to mark as read:",h)}},u=f=>{n(f),f.isRead||l(f.id)},m=async(f,h)=>{if(h.stopPropagation(),!!confirm("  ?"))try{await pl.deleteQuoteInquiry(f),(t==null?void 0:t.id)===f&&n(null),ne.success(" ")}catch(y){console.error("Failed to delete inquiry:",y),ne.error("  ")}},d=s.filter(f=>!f.isRead).length;return r?a.jsxDEV("div",{className:"flex items-center justify-center h-full",children:a.jsxDEV("div",{className:"text-gray-500",children:" ..."},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:74,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:73,columnNumber:7},void 0):a.jsxDEV("div",{className:"h-full flex flex-col md:flex-row gap-4 p-4",children:[a.jsxDEV("div",{className:`w-full md:w-1/3 bg-white rounded-lg shadow overflow-hidden flex flex-col ${t?"hidden md:flex":"flex"}`,children:[a.jsxDEV("div",{className:"p-4 border-b bg-gray-50",children:a.jsxDEV("h2",{className:"text-lg font-semibold text-gray-900",children:[" ",d>0&&a.jsxDEV("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:d},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:87,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:84,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:83,columnNumber:9},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:s.length===0?a.jsxDEV("div",{className:"p-4 text-center text-gray-500",children:"  "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:96,columnNumber:13},void 0):a.jsxDEV("div",{className:"divide-y",children:s.map(f=>a.jsxDEV("div",{className:`relative group ${(t==null?void 0:t.id)===f.id?"bg-blue-50 border-l-4 border-blue-500":""} ${f.isRead?"":"bg-yellow-50"}`,children:a.jsxDEV("button",{onClick:()=>u(f),className:"w-full p-4 text-left hover:bg-gray-50 transition-colors",children:[a.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"font-medium text-gray-900",children:f.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:114,columnNumber:25},void 0),!f.isRead&&a.jsxDEV("span",{className:"w-2 h-2 bg-red-500 rounded-full"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:116,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:113,columnNumber:23},void 0),a.jsxDEV("div",{className:"flex items-center gap-2",children:[a.jsxDEV("span",{className:"text-xs text-gray-500",children:Ft(new Date(f.createdAt),"MM/dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:120,columnNumber:25},void 0),a.jsxDEV("button",{onClick:h=>m(f.id,h),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:a.jsxDEV(oi,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:128,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:123,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:119,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:112,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-600 flex items-center gap-1 mb-1",children:[a.jsxDEV(Td,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:134,columnNumber:23},void 0),f.phone]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:133,columnNumber:21},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500 line-clamp-2",children:f.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:138,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:108,columnNumber:19},void 0)},f.id,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:102,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:100,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:82,columnNumber:7},void 0),a.jsxDEV("div",{className:`flex-1 bg-white rounded-lg shadow overflow-hidden ${t?"flex flex-col":"hidden md:flex md:flex-col"}`,children:t?a.jsxDEV("div",{className:"h-full flex flex-col",children:[a.jsxDEV("div",{className:"p-6 border-b bg-gray-50",children:[a.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[a.jsxDEV("h3",{className:"text-xl font-semibold text-gray-900",children:t.name},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:155,columnNumber:17},void 0),a.jsxDEV("button",{onClick:()=>n(null),className:"md:hidden px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded transition-colors",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:159,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:154,columnNumber:15},void 0),a.jsxDEV("div",{className:"text-sm text-gray-500",children:Ft(new Date(t.createdAt),"yyyy MM dd HH:mm")},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:166,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:153,columnNumber:13},void 0),a.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(wN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:175,columnNumber:19},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:174,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(Td,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:180,columnNumber:21},void 0),a.jsxDEV("span",{children:t.phone},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:181,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:179,columnNumber:19},void 0),a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(SN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:184,columnNumber:21},void 0),a.jsxDEV("span",{children:t.email},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:185,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:183,columnNumber:19},void 0),t.address&&a.jsxDEV("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsxDEV(TN,{className:"w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:189,columnNumber:23},void 0),a.jsxDEV("span",{children:t.address},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:190,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:188,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:173,columnNumber:15},void 0),(t.projectType||t.budget)&&a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsxDEV(LN,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:200,columnNumber:21},void 0)," "]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:199,columnNumber:19},void 0),a.jsxDEV("div",{className:"pl-6 space-y-2",children:[t.projectType&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:" : "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:206,columnNumber:25},void 0),t.projectType]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:205,columnNumber:23},void 0),t.budget&&a.jsxDEV("div",{className:"text-gray-700",children:[a.jsxDEV("span",{className:"text-gray-500",children:": "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:212,columnNumber:25},void 0),t.budget]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:211,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:203,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:198,columnNumber:17},void 0),a.jsxDEV("div",{className:"space-y-3",children:[a.jsxDEV("h4",{className:"font-medium text-gray-900",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:222,columnNumber:17},void 0),a.jsxDEV("div",{className:"pl-6 text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:223,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:221,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:152,columnNumber:11},void 0):a.jsxDEV("div",{className:"h-full flex items-center justify-center text-gray-500",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:230,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:150,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/QuoteInquiry.tsx",lineNumber:80,columnNumber:5},void 0)},$w=()=>{const{login:s}=Or(),[e,t]=A.useState(!1),{register:n,handleSubmit:r,setValue:i,formState:{errors:o}}=nd(),l=async m=>{t(!0);try{await s(m.username,m.password)}finally{t(!1)}},u=m=>{i("username",m)};return a.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxDEV("div",{className:"max-w-md w-full",children:a.jsxDEV("div",{className:"bg-white border border-gray-200 rounded-lg p-8",children:[a.jsxDEV("div",{className:"text-center mb-8",children:[a.jsxDEV("h2",{className:"text-3xl font-bold text-gray-900",children:"HV LAB"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:39,columnNumber:13},void 0),a.jsxDEV("p",{className:"mt-2 text-sm text-gray-600",children:"   "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:38,columnNumber:11},void 0),a.jsxDEV("form",{onSubmit:r(l),className:"space-y-6",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:47,columnNumber:15},void 0),a.jsxDEV("input",{...n("username",{required:" "}),type:"text",className:"input",placeholder:" ",autoFocus:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:50,columnNumber:15},void 0),o.username&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.username.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:60,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:46,columnNumber:13},void 0),a.jsxDEV("div",{children:[a.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:65,columnNumber:15},void 0),a.jsxDEV("input",{...n("password",{required:" "}),type:"password",className:"input",placeholder:""},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:68,columnNumber:15},void 0),o.password&&a.jsxDEV("p",{className:"mt-1 text-sm text-red-600",children:o.password.message},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:77,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:64,columnNumber:13},void 0),a.jsxDEV("button",{type:"submit",disabled:e,className:"w-full btn btn-primary flex items-center justify-center",children:e?a.jsxDEV("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:87,columnNumber:17},void 0):a.jsxDEV(a.Fragment,{children:[a.jsxDEV(PN,{className:"mr-2 h-5 w-5"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:90,columnNumber:19},void 0),""]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:89,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:45,columnNumber:11},void 0),a.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[a.jsxDEV("p",{className:"text-sm text-gray-600 text-center mb-4",children:" "},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:98,columnNumber:13},void 0),a.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:["","","","","","",""].map(m=>a.jsxDEV("button",{onClick:()=>u(m),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",type:"button",children:m},m,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:101,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:99,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:97,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:37,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:36,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/pages/Login.tsx",lineNumber:35,columnNumber:5},void 0)},Ww=A.lazy(()=>Kn(()=>import("./Drawings-nKPPqlAF.js"),__vite__mapDeps([0,1,2,3,4,5]))),zw=A.lazy(()=>Kn(()=>import("./SiteLog-D30omJbe.js"),__vite__mapDeps([6,1,4,2,3,5]))),Kw=A.lazy(()=>Kn(()=>import("./AfterService-eRWEHwta.js"),__vite__mapDeps([7,1,2,4,3,5]))),Qw=A.lazy(()=>Kn(()=>import("./AdditionalWork-criZPDf_.js"),__vite__mapDeps([8,1,2,9,4,3,5]))),Yw=A.lazy(()=>Kn(()=>import("./ConstructionPayment-BpQRRh2j.js"),__vite__mapDeps([10,1,9,4,2,3,5]))),Gw=A.lazy(()=>Kn(()=>import("./WorkRequest-WJMfFq-f.js"),__vite__mapDeps([11,1,2,4,3,5]))),Xw=A.lazy(()=>Kn(()=>import("./Specbook-CNkhGBbo.js"),__vite__mapDeps([12,1,2,3,4,5]))),Jw=A.lazy(()=>Kn(()=>import("./EstimatePreview-DNzu6mW_.js"),__vite__mapDeps([13,1,2,3,4,5]))),Zw=A.lazy(()=>Kn(()=>import("./ExecutionHistory-BplEGnoB.js"),__vite__mapDeps([14,1,4,2,3,5]))),e2=()=>a.jsxDEV("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:37,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:36,columnNumber:3},void 0),t2=new NN({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});function s2(){const[s,e]=A.useState(!1);return A.useEffect(()=>{const t=Px({immediate:!0,onNeedRefresh(){console.log("   ."),e(!0),ne.loading("   ...",{duration:2e3}),setTimeout(()=>{t(!0).then(()=>{ne.dismiss(),ne.success(" !",{duration:2e3,icon:""}),setTimeout(()=>{window.location.reload()},1e3)})},1500)},onOfflineReady(){console.log("    ")},onRegisteredSW(u,m){console.log(" Service Worker :",u),m&&setInterval(()=>{console.log("   ..."),m.update()},6e4)},onRegisterError(u){console.error(" Service Worker  :",u)}});IC();const n=async()=>{try{const m=await(await fetch("/version.json?t="+Date.now())).json(),d=localStorage.getItem("app_version");d&&d!==m.version?(console.log("   :",m.version),localStorage.setItem("app_version",m.version),"serviceWorker"in navigator&&(await navigator.serviceWorker.ready).update()):d||localStorage.setItem("app_version",m.version)}catch(u){console.error("  :",u)}};setTimeout(n,5e3);const r=setInterval(n,3e4),i=window.location.hostname,o=i==="hvlab.app"||i.includes("hv-lab-app")||i.includes("firebaseapp.com");let l=null;if(o)console.log("  : Socket.IO  (HTTP  )");else{const u=window.location.origin;l=Fo(u,{transports:["websocket","polling"]}),Nr.setSocket(l),l.on("connect",()=>{console.log(" Socket.IO ")}),l.on("urgent-payment",m=>{console.log("    :",m);const d=`${m.project}  ${m.amount.toLocaleString()}  `;PC(m.urgency,d)}),l.on("disconnect",()=>{console.log(" Socket.IO  ")})}return()=>{l&&l.disconnect(),clearInterval(r)}},[]),a.jsxDEV(xN,{client:t2,children:a.jsxDEV(gN,{children:a.jsxDEV(OE,{children:[a.jsxDEV(A.Suspense,{fallback:a.jsxDEV(e2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:31},this),children:a.jsxDEV(yN,{children:[a.jsxDEV(Vs,{path:"/login",element:a.jsxDEV($w,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:181,columnNumber:15},this),a.jsxDEV(Vs,{path:"/",element:a.jsxDEV(SC,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:40},this),children:[a.jsxDEV(Vs,{index:!0,element:a.jsxDEV(Wp,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:183,columnNumber:17},this),a.jsxDEV(Vs,{path:"dashboard",element:a.jsxDEV(c1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:184,columnNumber:17},this),a.jsxDEV(Vs,{path:"projects",element:a.jsxDEV(g1,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:185,columnNumber:17},this),a.jsxDEV(Vs,{path:"schedule",element:a.jsxDEV(Lw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:186,columnNumber:17},this),a.jsxDEV(Vs,{path:"drawings",element:a.jsxDEV(Ww,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:187,columnNumber:17},this),a.jsxDEV(Vs,{path:"site-log",element:a.jsxDEV(zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:188,columnNumber:17},this),a.jsxDEV(Vs,{path:"after-service",element:a.jsxDEV(Kw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:189,columnNumber:17},this),a.jsxDEV(Vs,{path:"additional-work",element:a.jsxDEV(Qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:56},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:190,columnNumber:17},this),a.jsxDEV(Vs,{path:"construction-payment",element:a.jsxDEV(Yw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:61},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:191,columnNumber:17},this),a.jsxDEV(Vs,{path:"contractors",element:a.jsxDEV(Fw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:192,columnNumber:17},this),a.jsxDEV(Vs,{path:"work-request",element:a.jsxDEV(Gw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:193,columnNumber:17},this),a.jsxDEV(Vs,{path:"finish-check",element:a.jsxDEV(Ow,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:53},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:194,columnNumber:17},this),a.jsxDEV(Vs,{path:"specbook",element:a.jsxDEV(Xw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:195,columnNumber:17},this),a.jsxDEV(Vs,{path:"estimate-preview",element:a.jsxDEV(Jw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:57},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:196,columnNumber:17},this),a.jsxDEV(Vs,{path:"execution-history",element:a.jsxDEV(Zw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:197,columnNumber:17},this),a.jsxDEV(Vs,{path:"payments",element:a.jsxDEV(Mw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:49},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:198,columnNumber:17},this),a.jsxDEV(Vs,{path:"quote-inquiry",element:a.jsxDEV(qw,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:54},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:199,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:182,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:180,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:179,columnNumber:11},this),a.jsxDEV(H0,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",border:"1px solid #e5e5e5"}}},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:203,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:178,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:177,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/App.tsx",lineNumber:176,columnNumber:5},this)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(s){for(const e of s)e.update()});uh(document.getElementById("root")).render(a.jsxDEV(A.StrictMode,{children:a.jsxDEV(s2,{},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:18,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/kim_s/Desktop/HV LAB app/interior-management-system/frontend/src/main.tsx",lineNumber:17,columnNumber:3},void 0));export{nd as A,xs as B,Mu as C,DC as D,Qc as E,ME as F,m2 as G,Ut as H,Bw as I,ln as J,Hw as K,Rw as L,Xc as P,xe as T,re as a,Hs as b,ls as c,Te as d,Il as e,Bu as f,It as g,Or as h,dc as i,a as j,qe as k,dn as l,Vt as m,Ky as n,Gt as o,to as p,Nt as q,Pl as r,ci as s,jl as t,Ru as u,Ht as v,js as w,qn as x,er as y,ne as z};
